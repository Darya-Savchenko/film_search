"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[62069],{809752:(e,t,r)=>{if(r.d(t,{zF:()=>d,db:()=>h,mM:()=>f,kh:()=>p}),40179==r.j)var o=r(231191);if(40179==r.j)var i=r(69226);if(40179==r.j)var n=r(854084);if(40179==r.j)var s=r(20204);if(40179==r.j)var a=r(709167);if(40179==r.j)var c=r(648062);if(40179==r.j)var l=r(316058);if(40179==r.j)var u=r(923036);const d=(e,t)=>{let r;if(t){const o=s.Jt.getAllOfType("User").filter((e=>e.profile.tid===t&&e.type!==i.Ch.Anonymous));if(o.length>1){const t=s.Jt.getValue(a.Jl.globalUser);if(r=!!e&&o.find((t=>t.id===e))||o.find((e=>e.id===t.id)),r)return r;throw{message:"Multiple users found in cache with same tenantId",errorCode:c.SM.MultipleUsersPresentWithSpecifiedIdentifier}}return o[0]}if(e){const t=s.Jt.getAllOfType("User");r=null==t?void 0:t.filter((t=>t.id===e))[0]}else r=s.Jt.getValue(a.Jl.globalUser);return r},h=e=>{if(!e)return[];return s.Jt.getAllOfType("User").filter((t=>t.id!==e&&t.homeAccountId===e))||[]},f=(e,t)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){null==t||t.addScenarioMark("auth_get_encryption_key_start");const r=s.Jt.getValue(a.Jl.encryptionKey);if("object"==typeof r)return null==t||t.addScenarioMark("auth_get_encryption_key_stop"),r;null==t||t.addScenarioMark("auth_get_exported_key_start");const o=s.Jt.getValue(a.Jl.exportedEncryptionKey);if(!o)return null==t||t.addScenarioMark("auth_get_exported_key_stop",{reason:"No exported encryption key."}),void(null==t||t.addScenarioMark("auth_get_encryption_key_stop"));let i;try{i=yield e.crypto.subtle.importKey("jwk",o.exportedKey,{name:"AES-CBC"},!0,["encrypt","decrypt"]),s.Jt.put(a.Jl.encryptionKey,i),null==t||t.addScenarioMark("auth_get_exported_key_stop")}catch(e){null==t||t.addScenarioMark("auth_get_exported_key_stop",{error:e}),i=null}return null==t||t.addScenarioMark("auth_get_encryption_key_stop"),i})),p=(e,t,r)=>{const o=i.JE[n.j[e]],c=d(t,void 0);if(!c)return void l.q.warn(`[AuthState] Account ${t} not found when attempting to write userAuthState`);const h={tenantId:c.profile.tid,oid:c.profile.oid,accountType:c.type,userName:c.userName,id:c.id},f=(0,u.u4)(null==r?void 0:r.reason)||o;s.Jt.put((0,a.VF)(h).userAuthState,{state:o,reason:f,customError:r?{errorCode:r.errorCode||r.code,message:r.message,isExpected:r.isExpected,context:r.context,subContext:r.subContext,correlationId:r.correlationId}:null}),r?l.q.warn(`[AuthState] UserAuthState updated - ${t} : ${o} errorCode: ${r.errorCode} isExpected: ${r.isExpected} correlationId: ${r.correlationId}`):l.q.log(`[AuthState] UserAuthState updated - ${t} : ${o}`)}},20204:(e,t,r)=>{if(r.d(t,{Jt:()=>d,ky:()=>y}),40179==r.j)var o=r(231191);var i=r(648062);if(40179==r.j)var n=r(316058);if(40179==r.j)var s=r(923036);if(40179==r.j)var a=r(272097);if(40179==r.j)var c=r(709167);const l=[i.aw,i.ZU,i.Fz],u={KeyVersion:"v1",UseAccountIdKey:!1};let d;const h=e=>u.UseAccountIdKey?(null==e?void 0:e.id)||"":e?JSON.stringify({tenantId:e.tenantId,oid:e.oid,accountType:e.accountType,userName:e.userName}):JSON.stringify(void 0),f=(e,t,r)=>`tmp.auth.${u.KeyVersion}.${e}.${t}.${r}`,p=e=>{const{typeName:t,user:r}=e;return{user:e.user?h(r):"GLOBAL",typeName:t,key:e.key?e.key.toUpperCase():t}},v=(e,t)=>({storageKey:u.UseAccountIdKey?f(t.user,t.typeName,t.key):`$[${t.user}][${t.typeName}][${t.key}]`,loggingKey:f(e.user?`${e.user.id}`:t.user,t.typeName,t.key)});class g{constructor(e){this._expireOffsetSeconds=i.rF.SECONDS_FIVE_MINUTES,this._expireOffsetSecondsMin=i.rF.SECONDS_PER_MINUTE,this.internalCache={GLOBAL:{User:{},Token:{},MsalAccount:{}}},this._initializeCacheForCacheItem=(e,t)=>{void 0===this.internalCache[t]?(this.internalCache[t]={},this.internalCache[t][e]={}):void 0===this.internalCache[t][e]&&(this.internalCache[t][e]={})},this._addToExternalCache=(e,t)=>(0,o.__awaiter)(this,void 0,void 0,(function*(){let r=t;t.item.encryptedToken&&(r=this._deepCopyEncryptedToken(t));const o=p(e),{storageKey:i,loggingKey:a}=v(e,o);try{if(this._storage.setItem(i,(0,s.u4)(r)),"LogoutState"===e.typeName){const{storageKey:t}=((e,t)=>({storageKey:u.UseAccountIdKey?`$[${t.user}][${t.typeName}][${t.key}]`:f(t.user,t.typeName,t.key),loggingKey:f(e.user?`${e.user.id}`:t.user,t.typeName,t.key)}))(e,o);this._storage.setItem(t,(0,s.u4)(r))}}catch(e){n.q.error(`error in putting key [${a}] in storage, error - [${(0,s.VK)(e)}]`)}})),this._deepCopyEncryptedToken=e=>{const t=e.item,r=Object.assign({},t);return r.skypeToken?r.skypeToken="":r.token="",{item:r,hitCount:e.hitCount,shouldRefresh:e.shouldRefresh}},this._deleteFromExternalCache=e=>(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=p(e),{storageKey:r,loggingKey:o}=v(e,t);try{this._storage.removeItem(r)}catch(e){n.q.error(`error in deleting key [${o}] in storage, error - [${(0,s.VK)(e)}]`)}})),this._flushExternalCache=e=>(0,o.__awaiter)(this,void 0,void 0,(function*(){try{const t={};Object.keys(this._storage).forEach((r=>{l.forEach((e=>{if(-1!==r.indexOf(e)){const e=this._storage.getItem(r);e&&(t[r]=e)}})),(!e&&0===r.indexOf("$[")||!e&&0===r.indexOf("tmp.auth")||e&&(-1!==r.indexOf(e.oid)||e.id&&-1!==r.indexOf(e.id)))&&this._storage.removeItem(r)})),Object.keys(t).forEach((e=>{this._storage.setItem(e,t[e])}))}catch(e){n.q.error(`error in clearing storage, error - [${(0,s.VK)(e)}]`)}})),this._isGlobalUser=e=>{var t,r;let o=null===(r=null===(t=this.internalCache.GLOBAL)||void 0===t?void 0:t.User)||void 0===r?void 0:r.User;return o||(o=this.get(c.Jl.globalUser)),o&&(0,a.FG)((0,a.Xx)(o.item),e)},this._putGlobalUserInCache=(e,t)=>{var r,o;if((null===(o=null===(r=this.internalCache.GLOBAL)||void 0===r?void 0:r.User)||void 0===o?void 0:o.User)&&e.user&&!this._isGlobalUser(e.user))return;const i=e.user?"GLOBAL":h((0,a.Xx)(t.item));this._initializeCacheForCacheItem("User",i),this.internalCache[i].User.User=t;const n=u.UseAccountIdKey?f(i,"User","User"):`$[${i}][User][User]`;this._storage.setItem(n,JSON.stringify(t))},this._validateValue=(e,t)=>{var r,o;if(!("Token"!==e.typeName||"object"==typeof t&&t.token&&t.expires))throw new Error("Invalid value for Token.");if(!("Discover"!==e.typeName||e.key!==i.rz||"object"==typeof t&&t.skypeToken&&t.expiration))throw new Error("Invalid value for Skype token.");if("User"!==e.typeName)return;const n=t;if(!(n.userName&&n.type&&n.role&&n.profile&&void 0!==n.isAuthenticated))throw new Error(`Invalid value for user. userName exists: [${!!n.userName}], type: [${n.type}], role: [${n.role}], profile exists: [${!!n.profile}],isAuthenticated: [${n.isAuthenticated}]`);const s=null===(o=null===(r=this.internalCache.GLOBAL)||void 0===r?void 0:r.User)||void 0===o?void 0:o.User,c=(0,a.Xx)(n);if(s&&!e.user&&!this._isGlobalUser(c))throw new Error("there is already global user in auth cache")},this._storage=e.localStorage,n.q.info("auth_cache initialized")}updateSetting(e,t){n.q.log(`Updating authCache setting ${e} from ${u[e]} to ${t}.`),"KeyVersion"===e&&(t!==u.KeyVersion&&(this.internalCache={}),u.KeyVersion=t),"UseAccountIdKey"===e&&(t!==u.UseAccountIdKey&&(this.internalCache={}),u.UseAccountIdKey=t)}setExpiryOffset(e,t){e&&(this._expireOffsetSeconds=e),t&&(this._expireOffsetSecondsMin=t)}put(e,t){var r,o;m(e),this._validateValue(e,t);const{typeName:i,key:n,user:s}=p(e);("Token"===i||"Discover"===i&&"SKYPE-TOKEN"===n)&&(t.fromCache=!0);let a=null===(o=null===(r=this.internalCache[s])||void 0===r?void 0:r[i])||void 0===o?void 0:o[n];return a?(a.hitCount=0,a.item=t):a={item:t,shouldRefresh:!1,hitCount:0},"User"===i&&this._putGlobalUserInCache(e,a),this._initializeCacheForCacheItem(i,s),this.internalCache[s][i][n]=a,this._addToExternalCache(e,a),!0}updateGlobalUser(e){const t="GLOBAL",r={item:e,shouldRefresh:!1,hitCount:0};return this._initializeCacheForCacheItem("User",t),this.internalCache.GLOBAL.User.User=r,this._addToExternalCache(c.Jl.globalUser,r),!0}get(e){var t,r,o;m(e);const i=p(e),{storageKey:a,loggingKey:c}=v(e,i),{typeName:l,key:u,user:d}=i;let h=null===(r=null===(t=this.internalCache[d])||void 0===t?void 0:t[l])||void 0===r?void 0:r[u];const f=!!h;if(!h)try{const e=null===(o=this._storage)||void 0===o?void 0:o.getItem(a);e&&(h=JSON.parse(e))}catch(e){n.q.error(`value for key [${c}] throw error. ${(0,s.VK)(e)}`)}if(h)return this._initializeCacheForCacheItem(l,d),this.internalCache[d][l][u]=h,("Token"===l||"Discover"===l&&"SKYPE-TOKEN"===u)&&(h.shouldRefresh=this._shouldRefresh(h.item,l),h.hitCount++,this.internalCache[d][l][u]=h,this._addToExternalCache(e,h)),void 0===h.shouldRefresh?(n.q.info(`cacheItem '[${a}]' need to refresh`),void this.del(e)):(n.q.info(`returning cacheItem '[${a}]' from cache. In memory:${+f} found: [${+!!h}]`),h);n.q.info(`value for key [${c}] not found in memory or storage`)}getValue(e){const t=this.get(e);return t?this._value(t):void 0}getAllOfType(e){const t=[],r=[];return Object.keys(this.internalCache).forEach((o=>{"GLOBAL"!==o&&Object.keys(this.internalCache[o][e]||{}).forEach((i=>{const{storageKey:n}=v({},{user:o,typeName:e,key:i});r.push(n),t.push(this.internalCache[o][e][i].item)}))})),Object.keys(this._storage).forEach((o=>{var i;if(-1===r.indexOf(o)&&-1===o.indexOf(".GLOBAL.")&&-1===o.indexOf("[GLOBAL]")&&(-1!==o.indexOf(`[${e}]`)||-1!==o.indexOf(`.${e}.`)))try{const e=this._storage.getItem(o);e&&t.push(null===(i=JSON.parse(e))||void 0===i?void 0:i.item)}catch(e){n.q.error(`value for key [${o}] throw error. ${(0,s.VK)(e)}`)}})),t}del(e){var t,r,o,i;if(!e)return n.q.error(`Invalid cacheKey: ${e}`),!1;if(!e.typeName)return n.q.error(`Invalid cacheKey type: ${e.typeName}`),!1;if("User"===e.typeName)return this.flush(e.user),!0;const s=p(e),{loggingKey:a}=v(e,s),{typeName:c,key:l,user:u}=s;(null===(r=null===(t=this.internalCache[u])||void 0===t?void 0:t[c])||void 0===r?void 0:r[l])&&n.q.info(`Value of key: [${a}] exists before deletion]`);const d=(null===(i=null===(o=this.internalCache[u])||void 0===o?void 0:o[c])||void 0===i?void 0:i[l])&&delete this.internalCache[u][c][l],h=this._deleteFromExternalCache(e);return n.q.info(`deleted from local auth-cache. key: [${a}], done - local: [${d}], storage: [${h}]`),d}delTokensWithError(e,t){var r,o,i,n;const{user:s,typeName:a}=p({user:e,typeName:"Token"});if(null===(r=this.internalCache[s])||void 0===r?void 0:r[a]){const r=this.internalCache[s][a];for(const s in r)(null===(n=null===(i=null===(o=r[s])||void 0===o?void 0:o.item)||void 0===i?void 0:i.error)||void 0===n?void 0:n.errorCode)===t&&this.del({user:e,typeName:a,key:s})}}deleteType(e,t){var r;const{user:o,typeName:i}=p({user:e,typeName:t});if(null===(r=this.internalCache[o])||void 0===r?void 0:r[i]){let t;if("Token"===i)t=this.internalCache[o][i];else{if("Discover"!==i)return;t=this.internalCache[o][i]}for(const r in t)r&&this.del({user:e,typeName:i,key:r})}}flush(e){var t,r;if(!e){n.q.info("no user provided, flushing global user from cache");const o=null===(r=null===(t=this.internalCache.GLOBAL)||void 0===t?void 0:t.User)||void 0===r?void 0:r.User;if(!o)return;e=(0,a.Xx)(o.item)}n.q.info("flushing user data from cache");const o=h(e);this.internalCache[o]={},this._flushExternalCache(e),this._isGlobalUser(e)&&(this.internalCache.GLOBAL={},this._storage.removeItem("$[GLOBAL][User][User]"),this._storage.removeItem("tmp.auth.v1.GLOBAL.User.User")),n.q.info("flushing completed")}_value(e){return e.item}_shouldRefresh(e,t){const r="Token"===t?null==e?void 0:e.expires:null==e?void 0:e.expiration,o=Math.round(Date.now()/i.rF.MILLI_PER_SECOND);let n;if(n="Discover"===t?Math.round(r/i.rF.MILLI_PER_SECOND):"Token"===t?r:void 0,e&&n){const e=n-this._expireOffsetSeconds;if(o<=n-this._expireOffsetSecondsMin)return o>=e}}}const m=e=>{if(!(-1===["Token","Discover"].indexOf(e.typeName)||e.key&&e.user))throw new Error(`key/user cannot be empty for type [${e.typeName}]: key: ${e.key}, user: ${+!!e.user}`)},y=e=>{var t;d||(d=new g(e),(null===(t=e.localStorage)||void 0===t?void 0:t.getItem("localDebug"))&&e.loader&&(e.loader.authCache=d))}},709167:(e,t,r)=>{r.d(t,{VF:()=>i,px:()=>n,Jl:()=>s});var o=r(648062);const i=e=>({userDetail:{user:e,typeName:"Discover",key:"discover-user-details"},regionGtm:{user:e,typeName:"Discover",key:"discover-region-gtm"},skypeToken:{user:e,typeName:"Discover",key:"skype-token"},user:{user:e,typeName:"User"},tenants:{user:e,typeName:"Tenants"},loginValidation:{user:e,typeName:"LoginValidation"},userAuthState:{user:e,typeName:"UserAuthState"}}),n=(e,t,r)=>({user:e,typeName:"Token",key:`${t}${r?`-external-${r}`:""}`}),s={logoutState:{typeName:o.ZU},authSessionId:{typeName:o.Fz},globalUser:{typeName:"User"},primaryUserId:{typeName:"PrimaryUserId"},encryptionKey:{typeName:"EncryptionKey"},exportedEncryptionKey:{typeName:"ExportedEncryptionKey"},initializationVector:{typeName:"InitializationVector"}}},272097:(e,t,r)=>{if(r.d(t,{b6:()=>m,yI:()=>y,B$:()=>_,QG:()=>C,nL:()=>S,Ig:()=>x,Xx:()=>$,qv:()=>k,nW:()=>A,aS:()=>O,Kv:()=>U,FG:()=>I,fM:()=>w,jV:()=>N,PU:()=>T,dW:()=>M,au:()=>j,S1:()=>D,ZW:()=>q,NL:()=>L,WD:()=>K,_Z:()=>P,ps:()=>R,Cq:()=>F,Fr:()=>G,N3:()=>J}),40179==r.j)var o=r(231191);var i,n=r(892891);if(40179==r.j)var s=r(69226);if(40179==r.j)var a=r(66431);if(40179==r.j)var c=r(628235);if(40179==r.j)var l=r(316058);if(40179==r.j)var u=r(648062);if(40179==r.j)var d=r(20204);if(40179==r.j)var h=r(372304);if(40179==r.j)var f=r(923036);if(40179==r.j)var p=r(709167);if(40179==r.j)var v=r(244449);if(40179==r.j)var g=r(809752);!function(e){e.Otp="mail",e.GFed="google.com"}(i||(i={}));const m=e=>(l.q.info(`[returnTokenForAnonUser][${e}] empty token return for anonymous user`),{token:"",expires:Math.floor((new Date).setMinutes(u.uI.FIFTEEN)/u.rF.MILLI_PER_SECOND),fromCache:!0}),y=(e,t,r)=>{if(e===s.G7.prod||e===s.G7.life)return"";const o=null==r?void 0:r("instanceUrl"),i=o?`${o}${null!=t?t:"common"}`:"";return l.q.log(`[getAuthorityFromCloud] Get Authority from cloud type - ${i}`),i},_=(e,t,r,o)=>{var i;const n=(null==t?void 0:t.profile.tid)||r||(null==e?void 0:e.tenantId);if(n&&(t||o||(null==e?void 0:e.isAnonEligible)&&(null==e?void 0:e.isAnonRestrictionSatisfied))){l.q.info("Anon flow - anonymous user created");const e=n===u.zP;return{id:E,isAuthenticated:!0,userName:(null==t?void 0:t.userName)||"anonymous",profile:{oid:k(n),tid:n,upn:(null===(i=null==t?void 0:t.profile)||void 0===i?void 0:i.upn)||"",puid:""},role:s.w4.Anonymous,type:s.Ch.Anonymous,homeAccountId:E,cloud:(null==t?void 0:t.cloud)||(e?s.G7.life:s.G7.prod),subType:s.Yf.Default}}},C=e=>e===a.e0?s.Ch.MsaLife:s.Ch.Aad,S=e=>{if(C(e.profile.tenantId)===s.Ch.MsaLife)return s.G7.life;switch(e.profile.sovereignty){case s.qn.prod:return s.G7.prod;case s.qn.gcch:return s.G7.gcch;case s.qn.dod:return s.G7.dod;default:return s.G7.prod}},x=(e,t,r,o)=>{var c,d,h,f,p,v;if(!t||(0,n.isEmpty)(t.profile)||t.role===s.w4.Anonymous||t.userRole===u.uI.TWO||!t.isAuthenticated&&e.isAnonEligible||!t.isAuthenticated&&o)return l.q.info("checking anon flow"),_(e,t,r,o);t.role=1===(null===(c=t.profile)||void 0===c?void 0:c.acct)?s.w4.Guest:s.w4.Member;let g=0===(null===(h=null===(d=t.profile)||void 0===d?void 0:d.altsecid)||void 0===h?void 0:h.indexOf("1:"))?s.Ch.Msa:s.Ch.Aad;return(null===(f=t.profile)||void 0===f?void 0:f.idp)&&(null===(p=t.profile)||void 0===p?void 0:p.iss)!==t.profile.idp?(g=t.profile.idp===i.Otp?s.Ch.Otp:g,g=t.profile.idp===i.GFed?s.Ch.GFed:g):(null===(v=t.profile)||void 0===v?void 0:v.tid)===a.e0&&(g=s.Ch.MsaLife),b(t,g)},b=(e,t)=>(e.type=t,e.profile.oid=e.profile.oid||k(e.profile.tid),e.cloud||(e.cloud=e.type===s.Ch.MsaLife?s.G7.life:s.G7.prod),!e.profile.hasOwnProperty("upn")&&e.hasOwnProperty("userName")&&(e.profile.upn=e.userName||""),e.subType||(e.subType=s.Yf.Default),l.q.info(`User role = [${e.role}], type = [${t}]`),e),$=e=>{if(!e)throw new Error("getUserIdentifier: User cannot be null");return{tenantId:e.profile.tid,oid:e.profile.oid,accountType:e.type,userName:e.userName,id:e.id}},k=e=>`8:defaultOid:${e}`,E="anonAccountId",A=e=>{const t=[];for(const r in e)Object.hasOwnProperty.call(e,r)&&t.push({name:r,key:r,value:e[r]});return t},O=(e,t)=>{var r;t.addEventData(["update-global-user:t"]),t.addScenarioMark("auth_update_global_user_start");const o=(0,g.zF)(e,void 0);if(o)return t.addScenarioMark("auth_update_global_user_foundUser"),d.Jt.updateGlobalUser(o);throw t.addScenarioMark("auth_update_global_user_noUserFound"),i=null===(r=t.correlation)||void 0===r?void 0:r.id,(0,h.Tr)({context:"core-auth-base",subContext:"getUserFromAccountId",correlationId:i,errorCode:u.SM.UserNotFoundError,message:"Cannot update global user ude to missing user"});var i},U=e=>e?(null==e?void 0:e.id)?null==e?void 0:e.id:`${null==e?void 0:e.oid}-${null==e?void 0:e.tenantId}`:"unknown user",I=(e,t)=>!!e&&!!t&&((e.id||t.id)&&e.id===t.id||e.tenantId===t.tenantId&&e.oid===t.oid&&e.userName===t.userName),w=(e,t,r)=>{var o;const i=new CustomEvent(t,{detail:r});null===(o=null==e?void 0:e.dispatchEvent)||void 0===o||o.call(e,i)},N=(e,t,r,o,i)=>{const n=x(e,t,o,i);return n&&(l.q.info(`[auth-helper][getMappedUserAndSetItToCache][${r}] put user in cache.`),d.Jt.put((0,p.VF)($(n)).user,n)),n},T=(e,t,r,o)=>{if(u.s9(e))throw o.addEventData(["scope_invalid:1"]),l.q.warn(`[core-auth-base][acquireToken][${r.source}][${r.id}] invalid scope. resource: [${e}]`),(0,h.Tr)({context:"core-auth-base",subContext:"acquireToken",message:`request with [${null==t?void 0:t.id}-${null==t?void 0:t.oid}-${null==t?void 0:t.tenantId}] sent from invalid resource: ${e}`,errorCode:u.SM.InvalidScopeResource,isExpected:!0,correlationId:r.id})},M=(e,t,r,o,i)=>(o.push("user_missing"),(0,h.Tr)({context:"core-auth-base",subContext:e,errorCode:u.SM.UserNotFoundError,isExpected:r,message:`request sent with [${t}] failed as user not found`,innerError:new Error("User Null or empty"),correlationId:i})),j=(e,t,r,o)=>(0,h.Tr)({context:"core-auth-base",subContext:e,errorCode:u.SM.UnsupportedParameter,isExpected:r,message:`${t} parameter is not currently supported`,innerError:new Error(`${t} parameter is not currently supported`),correlationId:o});const D=(e,t,r,o,i,n)=>{var s,a;null==o||o.push(`errorCode:${(null==t?void 0:t.errorCode)||"undefined"},errorMessage:${(null==t?void 0:t.message)||"undefined"}`),o&&o.length>0&&o.push("$");const c=function(e,t,r="",o,i){return{contentType:r,context:"core-auth-base",correlationId:null==t?void 0:t.correlationId,endpointUrl:i||"unset",errorCode:(null==t?void 0:t.errorCode)||"AcquireToken Error",innerError:t,isExpected:null==t?void 0:t.isExpected,message:(0,f.VK)(t),reason:(null==o?void 0:o.join(";"))||"",subContext:e}}(e,t,i,o,n),d=c.errorCode.includes(u.SM.InvalidScopeResource)||(null===(s=c.message)||void 0===s?void 0:s.includes(u.SM.InvalidScopeResource))||c.isExpected||(null===(a=c.innerError)||void 0===a?void 0:a.isExpected);return d?l.q.warning(`Error found ${(0,f.VK)(t)}`):l.q.error(`Error found ${(0,f.VK)(t)}`),d?null==r||r.incomplete(c):null==r||r.fail(c),c},q={access_token:{xms_cc:{values:["CP1"]}}},L=JSON.stringify(q),K=e=>!(!e||e===L),P=(e,t,r,o,i)=>{var n,s,a,c;return r.tflClaim&&(r.accessTokenToRenew=r.tflClaim),void 0===r.prompt&&void 0===r.silent&&(!r.accessTokenToRenew&&!K(r.claim)||(null==o?void 0:o("disablePromptFor401"))&&!((e,t)=>{const r=(null==t?void 0:t("enablePromptResourcesFor401"))||[];return!(!e||!r)&&Array.isArray(r)&&r.findIndex((t=>e.includes(t)))>-1})(e,o)?(r.prompt="none",r.silent=!0):(r.prompt="login",r.silent=!1)),t.addEventData(["cacheToken:"+ +!!i,"tflClaim:"+ +!!r.tflClaim,"accessTokenToRenew:"+ +!!r.accessTokenToRenew,"forceRenew:"+ +!!r.forceRenew,`prompt: ${r.prompt}`,"silent:"+ +!!r.silent]),(null===(s=null===(n=null==i?void 0:i.item)||void 0===n?void 0:n.error)||void 0===s?void 0:s.errorCode)&&t.addEventData([`errorInToken:[${(null===(c=null===(a=null==i?void 0:i.item)||void 0===a?void 0:a.error)||void 0===c?void 0:c.errorCode)||""}]`]),i?(r.forceRenew&&(l.q.info("[core-auth-base][acquireToken] force renewing."),r.accessTokenToRenew=i.item.token),r):r},R=(e,t,r,i,n)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){const o=null==n?void 0:n("buildCloud"),s=null==n?void 0:n("enableMultiCloud");if(l.q.log(`starting cloud misMatch check. Env: ${r}, buildCloud: ${o}, user tid: ${e.profile.tid}, user cloud: ${e.cloud}`),!e.cloud||!o||e.cloud===o)return!0;if(s)return t.closeScenario({reason:`_checkForCloudMismatchAndReboot. Env: ${r}, enableMultiCloud: ${s}, buildCloud: ${o}, user tid: ${e.profile.tid}, user cloud: ${e.cloud}`}),Promise.reject(V(e,i));throw d.Jt.del({user:$(e),typeName:"User"}),t.closeScenario({reason:`_checkForCloudMismatchAndReboot. Env: ${r}, buildCloud: ${o}, user tid: ${e.profile.tid}, user cloud: ${e.cloud}`}),new Error("cloud mis-match... reboot required")})),F=e=>{if(!(null==e?void 0:e("enableAuthCacheSchemaV1")))return!1;const t=null==e?void 0:e("authCacheSchemaVersion");t&&d.Jt.updateSetting("KeyVersion",t),l.q.log("[CoreAuth][_migrateAuthCache] Starting migration.");const r={id:(0,f.pW)(),scenarioName:c.RG.AuthWebMigrateCache,source:"core-auth::migrateAuthCache"},o=v.cv.create({correlation:r,subContext:"migrateAuthCache"}),i=d.Jt.getValue({typeName:"User"});if(!i)return l.q.log("[CoreAuth][_migrateAuthCache] Aborting migration. No existing user found"),o.closeScenario({reason:"no user found"},"abandoned"),d.Jt.updateSetting("UseAccountIdKey",!0),!0;if(!i.id)return l.q.log("[CoreAuth][_migrateAuthCache] Aborting migration. Existing user does not have id. Will try again next launch"),o.closeScenario({reason:"user has no id"},"incomplete"),d.Jt.updateSetting("UseAccountIdKey",!1),!1;d.Jt.updateSetting("UseAccountIdKey",!0);const n=d.Jt.getValue({typeName:"User"});return n?(l.q.log(`[CoreAuth][_migrateAuthCache] Aborting migration. Existing user found with new schema. Id: ${n.id}`),o.closeScenario({reason:"migration already complete"},"abandoned"),!1):(d.Jt.put((0,p.VF)($(i)).user,i),l.q.log(`[CoreAuth][_migrateAuthCache] Successful migration for account ${i.id}.`),o.closeScenario({reason:"migration completed successfully"},"success"),!0)},G=(e,t,r)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){return new Promise((i=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){if(e.length<=0)return i({count:0,failure:[]});let o=0;const n=[];for(const s of e){o++;try{const r=t(s);yield r,o>=e.length&&i({count:o,failure:n})}catch(t){n.push(o),null==r||r(t,o,s),o>=e.length&&i({count:o,failure:n})}}}))))})),V=(e,t)=>({errorMetaData:{cloud:e.cloud,accountId:e.id},authSubErrorCode:"MultiCloudMismatch",name:"CloudMisMatch",message:"Cloud Mismatch Detected, Rebooting",context:"Login",correlationId:t,errorCode:"CloudMismatch",subContext:"checkForCloudMismatchAndReboot"}),J=(e,t,r,o)=>{K(r)&&e.addEventData([`isSameToken: ${o===t.token}`]);const i=(e=>{const t=(e-Math.floor((new Date).getTime()/u.rF.MILLI_PER_SECOND))*u.rF.MILLI_PER_SECOND/u.rF.ONE_HOUR;return Math.floor(t)})(t.expires);e.addEventData([`tokenLifeTime: ${i}`,`fromCache: ${t.fromCache}`])}},736663:(e,t,r)=>{r.d(t,{z:()=>i,k:()=>n});var o=r(875291);const i=e=>o.Buffer.from(e).toString("base64"),n=e=>o.Buffer.from(e,"base64")},813459:(e,t,r)=>{if(r.d(t,{g:()=>f}),40179==r.j)var o=r(69226);if(40179==r.j)var i=r(372304);if(40179==r.j)var n=r(923036);if(40179==r.j)var s=r(272097);var a=r(648062);if(40179==r.j)var c=r(316058);if(40179==r.j)var l=r(437821);let u,d,h;function f(e,t,r,o){if(Object.getOwnPropertyDescriptor(Window,"mockApi")||Object.defineProperty(Window,"mockApi",{value:{enable:()=>{h=!0},disable:()=>{h=!1},setConfig:p}}),function(e,t){u||(u={});u[t]=e}(e,t),h=o,h){try{d="string"==typeof r?Object.assign(Object.assign({},d),JSON.parse(decodeURIComponent(r))):Object.assign(Object.assign({},d),r)}catch(e){c.q.warning(`[MOCK-API] cannot parse config: ${r}`)}v(e,t)}else d={}}function p(e,t={}){d||(d={}),d[e]=t;const r=e.split(".")[0];v(null==u?void 0:u[r],r)}function v(e,t){Object.getOwnPropertyNames(d).filter((e=>e.startsWith(`${t}.`))).map((e=>e.replace(`${t}.`,""))).forEach((r=>{var o,s;const a=(null===(o=Object.getOwnPropertyDescriptor(e,r))||void 0===o?void 0:o.value)||(null===(s=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),r))||void 0===s?void 0:s.value);Object.defineProperty(e,r,{configurable:!0,value:(...o)=>h?(c.q.warning(`[MOCK-API] returning mocked response for ${t}.${r}`),function(e,t){var r;const o=null==d?void 0:d[`${e}.${t}`];if(o&&o.error)throw function(e,t,r){return(0,i.Tr)({context:(null==e?void 0:e.context)||t,subContext:(null==e?void 0:e.subContext)||r,reason:null==e?void 0:e.reason,errorCode:(null==e?void 0:e.errorCode)||"ErrorCodeNotFound",correlationId:(null==e?void 0:e.correlationId)||(0,n.pW)(),isExpected:(null==e?void 0:e.isExpected)||!1,message:(null==e?void 0:e.message)||`[MockApi][${t}][${r}]`})}(o.error,e,t);if(o&&o.success){const e=function(e){switch(e){case"aquireToken":return m;case"user":return g();case"hostMachineUsers":return[y];case"users":return[g()];case"emptyList":return[]}return{}}(o.success.defaultValue);return Array.isArray(e)?o.success.returnValue?Array.isArray(o.success.returnValue)?[...e,...o.success.returnValue]:[...e,o.success.returnValue]:e:Object.assign(Object.assign({},e),null===(r=o.success)||void 0===r?void 0:r.returnValue)}return}(t,r)||a.apply(e,o)):a.apply(e,o)})}))}const g=()=>(0,s.Ig)(new l.N("https://test.msft.com"),{userName:"TestUserName@email.com",role:o.w4.Member,profile:{name:"Test",oid:(0,s.qv)("123456789"),tid:"123456789"}}),m={token:"TestToken",expires:Date.now()+a.rF.SECONDS_FIVE_MINUTES,fromCache:!1},y={accountType:"Aad",id:"TestHostMachineUserId",displayName:"Test User",emailPhone:"test@email.com",picture:""}},437821:(e,t,r)=>{if(r.d(t,{N:()=>n,j:()=>l}),40179==r.j)var o=r(648062);if(40179==r.j)var i=r(316058);class n{constructor(e){this._hash="",this._search="",this._pathname="",this._isAnonEligible=!1,this._isAnonRestrictionSatisfied=!1,this._tid=void 0,this._queryStrings={},this._parse=e=>{let t=Object.create(null);return"string"!=typeof e?t:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((e=>{const r=e.replace(/\+/g," ").split("=");let o=r.shift();const n=r.length>0?decodeURIComponent(r.join("=")):null;if(o){if(o=decodeURIComponent(o),"context"===o&&0===(null==n?void 0:n.indexOf("{")))try{const e=JSON.parse(n);for(const t in e)!e.hasOwnProperty(t)||"tid"!==t.toLowerCase()&&"tenantid"!==t.toLowerCase()||(this._tid=e[t]);t=Object.assign(Object.assign({},t),e)}catch(e){i.q.error(e)}if(Object.prototype.hasOwnProperty.call(t,o))Array.isArray(t[o])?t[o].push(n):t[o]=[t[o],n];else{t[o]=n;const e=o.toLowerCase();!n||"tid"!==e&&"tenantid"!==e||(this._tid=n)}}})),t):t};try{this._currenttUrl=Object.freeze(new URL(e))}catch(t){throw new Error(`[TeamsUrl::ctor] - error - ${t} url ${e}`)}if(this._currenttUrl.hash&&-1!==this._currenttUrl.hash.indexOf("#/")){const e=this._currenttUrl.href.substring(this._currenttUrl.origin.length),t=e.indexOf("#");t>=0&&(this._hash=e.substr(t),this._pathname=e.substr(0,t));const r=this._hash.indexOf("?");r>=0&&(this._search=this._hash.substr(r))}this._queryStrings=this._parse(this._search||this._currenttUrl.search);const t=s(this._currenttUrl);this._isAnonEligible=t[0],this._isAnonRestrictionSatisfied=t[1]}get href(){return this._currenttUrl.href}get isLocal(){return 0===this._currenttUrl.host.indexOf("local.teams.office.com")}get hash(){return this._hash||this._currenttUrl.hash}get pathname(){return this._pathname||this._currenttUrl.pathname}get search(){return this._search||this._currenttUrl.search}get origin(){return this._currenttUrl.origin}get searchParams(){return{get:e=>this._queryStrings[e]}}get queryStrings(){return this._queryStrings}get tenantId(){return 0===this._currenttUrl.host.indexOf("teams.live.")?o.zP:this._tid}get isAnonEligible(){return this._isAnonEligible}get isAnonRestrictionSatisfied(){return this._isAnonRestrictionSatisfied}get alternateUrl(){const e=new URL(this._currenttUrl.href);return this.isLocal?(e.port?e.port="":e.port="8080",e.href):(0===e.host.indexOf("teams.live.")?e.host="teams.microsoft.com":e.host="teams.live.com",e.href)}}const s=e=>{if(!c)return[!1,!1];for(const t of c)if(t.anonUrlMatch&&e.href.indexOf(t.anonUrlMatch)>-1)return[!0,a(t,e.href)];return[!1,!1]},a=(e,t)=>{if(!e.restrictions||0===e.restrictions.length)return!0;for(const r of e.restrictions)if(t.indexOf(r)>-1)return!0;return!1};let c=40179==r.j?[]:null;const l=e=>{e&&(c=e)}},854084:(e,t,r)=>{var o;r.d(t,{j:()=>o}),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting"}(o||(o={}))},266641:(e,t,r)=>{function o(e={},t){return new Proxy(e,{get:(e,r)=>t?r in e?e[r]:t(String(r)):String(r)})}r.d(t,{wh:()=>i,Ai:()=>n,Th:()=>s,rA:()=>a,PO:()=>c,Tk:()=>l,Yu:()=>u,$K:()=>d,sz:()=>h,eD:()=>f,uS:()=>p,b6:()=>v});const i=o({}),n=o({}),s=o({}),a=o({}),c=o({}),l=o({}),u=o({}),d=o({}),h=o({}),f=o({}),p=o({}),v=o({})},316058:(e,t,r)=>{r.d(t,{q:()=>i});var o=r(66431);const i=new class{constructor(){this.logLevel=o.in.Info,this.localCallback=void 0,this.error=e=>this.logMessage(o.in.Error,e),this.warning=e=>this.logMessage(o.in.Warning,e),this.warn=e=>this.logMessage(o.in.Warning,e),this.info=e=>this.logMessage(o.in.Info,e),this.log=e=>this.logMessage(o.in.Info,e),this.verbose=e=>this.logMessage(o.in.Verbose,e),this.debug=e=>this.logMessage(o.in.Verbose,e)}initialize(e,t=o.in.Verbose){this.localCallback=e,this.logLevel=t}executeCallback(e,t){this.localCallback?this.localCallback(e,t):console&&console.log(t)}logMessage(e,t){if(e>this.logLevel)return;const r=`[Auth]: ${t}`;this.executeCallback(e,r)}}},57066:(e,t,r)=>{r.d(t,{n:()=>o});class o{}o._authTelemetryCollection={},o._correlationMap={},o._userBiServiceMap={},o.getUserBiService=e=>o._userBiServiceMap[e]||o._userBiServiceMap.GLOBAL,o.setUserBiService=(e,t)=>{t?o._userBiServiceMap[e]=t:delete o._userBiServiceMap[e]},o.getAuthTelemetry=e=>o._authTelemetryCollection[e],o.setAuthTelemetry=(e,t)=>o._authTelemetryCollection[e]=t,o.delete=e=>{delete o._authTelemetryCollection[e];const t=Object.keys(o._correlationMap);for(const r in t)if(o._correlationMap.hasOwnProperty(t[r])){const i=t[r],n=o._correlationMap[i];n&&(o._correlationMap[i]=n.filter((t=>t!==e)))}},o.getCorrelation=e=>o._correlationMap[e],o.setCorrelation=e=>{const t=o.getCorrelation(e.scenarioName)||[];-1===t.indexOf(e.id)&&t.push(e.id),o._correlationMap[e.scenarioName]=t}},244449:(e,t,r)=>{if(r.d(t,{u:()=>l,OU:()=>u,ld:()=>h,cv:()=>f,Tu:()=>p}),40179==r.j)var o=r(231191);if(40179==r.j)var i=r(316058);if(40179==r.j)var n=r(923036);if(40179==r.j)var s=r(556461);if(40179==r.j)var a=r(57066);class c{constructor(e,t){this._scenarioProvider=e,this._telemetryService=t,this.create=e=>this._createScenario(e,!0),this.createNew=e=>{const t=new s.q(this._scenarioProvider,e.correlation,e.subContext,!0,e.timeoutMs,this._telemetryService);return e.scenarioEventData&&t.appendScenarioEventData(e.scenarioEventData),t},this.createWithoutScenario=e=>this._createScenario(e,!1),this.getCorrelation=e=>a.n.getCorrelation(e)||[],this._createScenario=(e,t)=>{var r,o;const{correlation:i,subContext:n,scenarioEventData:c,timeoutMs:l,scenario:u}=e;let d=a.n.getAuthTelemetry(i.id);if(d)d.addEventData([`fn:${n}`]);else{const c=null===(r=this._telemetryService)||void 0===r?void 0:r.getTelemetryServicesCache().get(null===(o=e.scenarioEventData)||void 0===o?void 0:o.accountId);d=new s.q((null==c?void 0:c.coreScenarioFactory)||this._scenarioProvider,i,n,t,l,(null==c?void 0:c.telemetryService)||this._telemetryService,u),a.n.setAuthTelemetry(i.id,d)}return c&&d.appendScenarioEventData(c),a.n.setCorrelation(i),d}}}const l=(e,t)=>{a.n.setUserBiService(e||"GLOBAL",t)},u=e=>{var t,r,i,s,a,c;e.options.correlation={id:null!==(r=null===(t=e.options.correlation)||void 0===t?void 0:t.id)&&void 0!==r?r:(0,n.pW)(),scenarioName:null!==(s=null===(i=e.options.correlation)||void 0===i?void 0:i.scenarioName)&&void 0!==s?s:e.scenarioName,source:null!==(c=null===(a=e.options.correlation)||void 0===a?void 0:a.source)&&void 0!==c?c:e.source};const{options:{correlation:l}}=e,u=(0,o.__rest)(e,["options"]);return d(Object.assign({correlation:l},u))},d=e=>{const{correlation:t,subContext:r,scenarioEventData:o,eventData:i,timeoutMs:n,scenario:s}=e,c=a.n.getAuthTelemetry(t.id),l=(e.startWithoutScenario?f.createWithoutScenario:f.create)({correlation:t,subContext:r,scenarioEventData:o,timeoutMs:n,scenario:s});i&&l.addEventData(i);return[l,(e,t)=>l.closeScenario(e,t,!!c)]},h=e=>f.getCorrelation(e);let f;const p=(e,t)=>{f||(f=new c(e,t),i.q.log("authTelemetryProvider initialized"))}},556461:(e,t,r)=>{if(r.d(t,{q:()=>c}),40179==r.j)var o=r(266641);if(40179==r.j)var i=r(316058);if(40179==r.j)var n=r(923036);if(40179==r.j)var s=r(372304);if(40179==r.j)var a=r(57066);class c{constructor(e,t,r,c,l,u,d){this._scenarioFactory=e,this._correlation=t,this._subContext=r,this._shouldCreateScenario=c,this._timeoutMs=l,this._telemetryService=u,this._eventData=[],this._localScenarioEventData={},this._loggingPrefix="",this.appendScenarioEventData=e=>{this._scenario&&this._scenario.appendEventData(e),this._localScenarioEventData=Object.assign(Object.assign({},this._localScenarioEventData),e)},this.addEventData=e=>{Array.prototype.push.apply(this._eventData,e)},this.getEventData=()=>[...this._eventData],this.addScenarioMark=(e,t={},r)=>{t=this._mapEventData(t,r),this._scenario?this._scenario.mark(e,t,t.status):this.addEventData([`${e}:${t.status}`]),i.q.log(`${this._loggingPrefix} [${e}][${t.status}][scenarioEventData][${(0,n.u4)(t)}]`)},this.closeScenario=(e={},t,r)=>{if(e=this._mapEventData(e,t),r)return e.reason&&this.addEventData([`reason:${e.reason}`]),e.errorCode&&this.addEventData([`errorCode:${e.errorCode}`]),void this.addEventData([`${this._subContext}$:${e.status}`]);if(!this._scenario){const t=this._shouldCreateScenario?i.q.warn:i.q.log,r=this._shouldCreateScenario?"[N/A]":"";return this.logEventData(t,`${this._loggingPrefix} [stop]${r} [scenarioEventData]`,e),void a.n.delete(this._correlation.id)}switch(e.status){case"incomplete":this._scenario.incomplete(e);break;case"failure":this._scenario.fail(e);break;case"abandoned":this._scenario.cancel(e);break;default:this._scenario.stop(e)}const o="failure"===e.status?i.q.error:i.q.log;this.logEventData(o,`${this._loggingPrefix} [stop][${e.status}] [e]`,e),a.n.delete(this._correlation.id)},this.createScenario=(e,t,r)=>{this._scenario?i.q.warn(`createScenario called with [${this._subContext}][${(0,n.u4)(this._correlation)}]::${e}, but there is already a scenario with that correltion id`):(this._createScenario(e,r||this._timeoutMs,Object.assign(Object.assign({},this._localScenarioEventData),t)),i.q.log(`${this._loggingPrefix} [create] - scenario created`))},this.recordAuthUserBiTelemetry=(e,t)=>{const r={panelRegion:o.Ai.main,panelType:o.wh.AuthStart,actionWorkload:o.sz.auth,actionSubworkload:o.eD.sisu,actionScenarioType:o.Yu.appAuth,actionScenario:t.scenario},n=a.n.getUserBiService(e||"GLOBAL");n&&n.recordPanelAction(r,i.q)},this.setUserToTelemetryContext=e=>{var t,r,o,i,n,s;if(e){const{id:a,oid:c,tid:l,type:u,role:d,subType:h}=e;void 0!==a&&(null===(t=this._telemetryService)||void 0===t||t.setCoreContext("userId",a===c?"":a)),void 0!==c&&(null===(r=this._telemetryService)||void 0===r||r.setCoreContext("UserInfo.Id",c)),void 0!==l&&(null===(o=this._telemetryService)||void 0===o||o.setCoreContext("UserInfo.TenantId",l)),void 0!==u&&(null===(i=this._telemetryService)||void 0===i||i.setCoreContext("UserInfo.Type",u)),void 0!==d&&(null===(n=this._telemetryService)||void 0===n||n.setCoreContext("UserInfo.Role",d)),void 0!==h&&(null===(s=this._telemetryService)||void 0===s||s.setCoreContext("UserInfo.SubType",h)),this.addScenarioMark(`${this._correlation.scenarioName}_set_user_on_telemetry_context`)}},this.setUserDetailsToTelemetryContext=e=>{var t;if(e){const{region:r}=e;void 0!==r&&(null===(t=this._telemetryService)||void 0===t||t.setCoreContext("UserInfo.Region",r)),this.addScenarioMark(`${this._correlation.scenarioName}_set_tenant_details_on_telemetry_context`)}},this._mapEventData=(e,t)=>{var r,o;return e.subContext=e.subContext||this._subContext,(e=Object.assign(Object.assign({},this._localScenarioEventData),e)).error&&(e.error=Object.assign(Object.assign({},e.error),{stack:e.error.stack,message:e.error.message,errorMetaData:void 0}),e.message=`[message]${null!==(r=e.message)&&void 0!==r?r:""} [errorMessage]${e.error.message}`,e.errorCode=null!==(o=e.error.code)&&void 0!==o?o:e.error.errorCode,this.addEventData([`errorCode:${e.error.errorCode}`])),!t&&e.error&&(t=(0,s.ZG)(e.error)?"incomplete":"failure"),e.eventData=this._eventData.join(","),e.status=t||"success",e},this._createScenario=(e,t,r)=>{var o,n,s;const a=t?{timeoutMs:t}:{};this._scenario=null!==(o=this._scenarioFactory.findScenario(e))&&void 0!==o?o:this._scenarioFactory.newScenario(e,a);try{null===(s=(n=this._scenarioFactory).hoistScenarioToCore)||void 0===s||s.call(n,this._scenario)}catch(e){i.q.log(`${this._loggingPrefix} ${e.message}`)}this._scenario.appendEventData(Object.assign({secondaryCorrelationId:this._correlation.id,commandSource:this._correlation.source},r)),this._shouldCreateScenario=!0},this.loggingPrefix=()=>`[Telemetry][${this._correlation.id}][${this._correlation.scenarioName}]`,this.logEventData=(e,t,r)=>{r.error||delete r.error;const o=this.splitStringEqually((0,n.u4)(r));for(const r of o)e(`${t}${r}`)},this.splitStringEqually=(e,t=300)=>{const r=new RegExp(`.{1,${t}}`,"g"),o=e.match(r);return o||[]},this._loggingPrefix=this.loggingPrefix(),c&&(d?this._scenario=d:this._createScenario(this._correlation.scenarioName,this._timeoutMs,void 0)),i.q.log(`${this._loggingPrefix} [start] - telemetry provider created for ${this._subContext}, source: ${this._correlation.source} with shouldCreateScenario: [${c}]`),this._eventData.push(`^source:${this._correlation.source},fn:${this._subContext}`)}get correlation(){return Object.assign({},this._correlation)}}},923036:(e,t,r)=>{r.d(t,{u4:()=>i,VK:()=>n,pW:()=>c});const o=globalThis;function i(e,t){const r=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!r.has(t)){if(t&&"object"==typeof t){if(r.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(null==t?void 0:t.errorCode)return t;if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}function n(e,t=!0){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,a(s(t)))}catch(e){return"Stringifying error failed"}}const s=(e=!0)=>(t,r)=>{if(r instanceof Error){const t={};return Object.getOwnPropertyNames(r).forEach((o=>{"stack"===o?e||(t[o]=("string"==typeof r.stack?r.stack:"").split("\n").map((e=>e.trim())).filter((e=>!!e))):t[o]=r[o]})),t}return r},a=e=>{const t=new WeakSet;return(r,o)=>{if("object"==typeof o&&null!==o){if(t.has(o))return;t.add(o)}return e(r,o)}},c=()=>{try{const e=o.msCrypto||o.crypto;return`${[1e7]}-1000-4000-8000-100000000000`.replace(/[018]/g,(t=>(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}catch(e){const t="xxxxxxxx-xxxx-8xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef";let o=0,i="";for(let e=0;e<36;e++)"-"!==t[e]&&"4"!==t[e]&&(o=16*Math.random()|0),"x"===t[e]?i+=r[o]:"y"===t[e]?(o&=3,o|=8,i+=r[o]):i+=t[e];return i}}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/62069-4761adb65025f981.js.map