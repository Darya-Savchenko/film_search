(()=>{var __webpack_modules__={388258:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"WindowStateEvent"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"isFocused"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"correlation"},type:{kind:"NamedType",name:{kind:"Name",value:"ServerCorrelation"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"shouldClose"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ServerCorrelation"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"startTimestamp"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"source"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Subscription"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"windowStateEvent"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"windowId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"WindowStateEvent"}}}}]}]}},854621:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"filter"},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticatedUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"allowAnon"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[{kind:"Directive",name:{kind:"Name",value:"deprecated"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"StringValue",value:"Use correlation",block:!1}}]}]},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"userContextId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"resource"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"acquireTokenOptions"},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationToken"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authConsent"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"resource"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"acquireTokenOptions"},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthConsent"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"hostMachineUsers"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"fetchAuthenticatedUsers"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"HostMachineUser"}}}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantData"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"accountId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"TenantData"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userAuthState"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userContextId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"UserAuthStateData"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userRelations"},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"UserRelation"}}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Mutation"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticateUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"loginUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationLogout"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"reason"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"authenticationLogoutResponse"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"reauthenticateUser"},type:{kind:"NamedType",name:{kind:"Name",value:"ReauthenticateResponse"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"resolveThirdPartyOauthCode"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"code"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"state"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"initializeAccounts"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"switchAccount"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userContextId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"refreshTenants"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userContextId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TenantData"}}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticateOrGetUser"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"allowAnon"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"loginHint"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"userContextId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"updateTenants"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userHomeAccountId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"isTenantHidden"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"TenantData"}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Subscription"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationUsersEvent"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationServiceEvent"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationStateChanged"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationStateChangedEvent"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationUser"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"profile"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserProfile"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isAuthenticated"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"type"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationAccountType"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"role"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserRole"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"loginUserName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"cloud"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationCloudType"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"homeAccountId"},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"subType"},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserSubType"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"authenticationLogoutResponse"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"succeed"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ReauthenticateResponse"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"success"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationAccountType"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Anonymous"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Aad"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Msa"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"MsaLife"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"GFed"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Otp"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationCloudType"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"dod"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"gcch"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"life"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"prod"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationUserRole"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Member"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Anonymous"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Guest"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationUserSubType"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Default"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Mto"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"AuthenticationState"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Up"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"InteractionRequired"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"AADReconnecting"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"SkypeReconnecting"}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationUserFilter"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"isAllCachedUsers"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"isAuthenticated"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"isPrimaryUser"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AcquireTokenOptions"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"claim"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"silent"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"userIdentifier"},type:{kind:"NamedType",name:{kind:"Name",value:"UserIdentifier"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"UserIdentifier"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"oid"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"userName"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"accountType"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationAccountType"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationToken"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"token"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthConsent"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"consentAccepted"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationUserProfile"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"objectId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"upn"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"puid"},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationServiceEvent"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationUsers"},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AuthenticationStateChangedEvent"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"authenticationState"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationState"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"HostMachineUser"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"accountType"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"displayName"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"emailPhone"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"picture"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TenantData"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"tenantName"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantType"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userType"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isInvitationRedeemed"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"cloudType"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"redeemUrl"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isTenantHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userTenantState"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"UserAuthStateData"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"state"},type:{kind:"NamedType",name:{kind:"Name",value:"UserAuthState"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"reason"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"customError"},type:{kind:"NamedType",name:{kind:"Name",value:"CustomError"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"UserRelation"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"isCurrentUserRelation"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"homeTenantEdge"},type:{kind:"NamedType",name:{kind:"Name",value:"UserEdge"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userEdges"},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"UserEdge"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"UserEdge"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"displayName"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"emailPhone"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tenantEdge"},type:{kind:"NamedType",name:{kind:"Name",value:"TenantEdge"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isCurrentUserEdge"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"homeAccountId"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"image"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TenantEdge"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"displayName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"CustomError"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"errorCode"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"message"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"context"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isExpected"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"innerError"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"correlationId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"subContext"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"UserAuthState"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"Up"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"InteractionRequired"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"AADReconnecting"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"SkypeReconnecting"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"LicenseError"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"SignInRestriction"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"UnRedeemed"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"LoginError"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"Unknown"}}]}]}},56023:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"allClientPreferences"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"clientPreferences"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"category"},type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferencesCategory"}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferenceCategoryTypes"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userExperiencePreferences"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferences"}}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Mutation"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"updateClientPreferences"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"value"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferencesInput"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"updateUserExperiencePreferences"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"value"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferencesInput"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"clearUserExperiencePreferences"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"clearUserExperiencePreferencesByCategory"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"category"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExperiencePreferencesCategory"}}}}],type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Subscription"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"clientPreferencesChangedEvent"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"category"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferencesCategory"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ClientPreferenceCategoryTypes"}}}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"Density"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"comfy"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"compact"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"FlyoutCameraUserChoice"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"on"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"off"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"notSet"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"InfoPaneState"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"closed"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"hidden"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"open"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"UserTheme"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"light"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"dark"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"contrast"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"UserExperiencePreferencesCategory"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"tflGroupTemplatesHidden"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"tflMeetingChicletPrivacyNoticeSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"prejoinSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"coachSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"streamingSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"channelInfoPaneSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"chatInfoPaneSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"audienceViewSettings"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"newChatDraft"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"mtmaAppBannerSettings"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"ClientPreferencesCategory"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"animation"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"density"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"flyoutCamera"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"infoPane"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"performance"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"appSwitcher"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"theme"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"videoEffect"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"backgroundEffect"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"promo"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"avatar"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"teamLayout"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"diagnosticsLogs"}}]},{kind:"EnumTypeDefinition",name:{kind:"Name",value:"PerformanceMode"},values:[{kind:"EnumValueDefinition",name:{kind:"Name",value:"normal"}},{kind:"EnumValueDefinition",name:{kind:"Name",value:"low"}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ThemePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"userTheme"},type:{kind:"NamedType",name:{kind:"Name",value:"UserTheme"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"followOsTheme"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AnimationPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"disableAnimations"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AppSwitcherPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"checkboxChecked"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"PromoBadgePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"badgeActionComplete"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"labelActionComplete"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"DensityPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"chatDensity"},type:{kind:"NamedType",name:{kind:"Name",value:"Density"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"FlyoutCameraPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"cameraState"},type:{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraUserChoice"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"InfoPanePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"chats"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"channels"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"chatContextualSearch"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"channelcontextualsearch"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"chatHighlightsDetails"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TeamLayoutPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"currentLayout"},type:{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferenceOptions"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ClientPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"animation"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AnimationPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"density"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DensityPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"flyoutCamera"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"infoPane"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InfoPanePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"performance"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PerformancePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"appSwitcher"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppSwitcherPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"theme"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ThemePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"videoEffect"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"VideoEffectPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"backgroundEffect"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BackgroundEffectPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"promo"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PromoBadgePreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"avatar"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AvatarPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"teamLayout"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferences"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"diagnosticsLogs"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DiagnosticsLogsPreferences"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplateHidden"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"groupTemplate"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplatesHidden"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"items"},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplateHidden"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"TflMeetingChicletPrivacyNoticeSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"dismissedAt"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"noticeDismissCount"},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"PrejoinSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"prejoinScreenSelectedAudio"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"prejoinScreenVideoState"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"prejoinScreenMicState"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AudienceViewSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"coachmarksDisplayed"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"CoachSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"isAutoStart"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"StreamingSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"uuid"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ChatInfoPaneSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"shouldShow"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ChannelInfoPaneSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"shouldShow"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"NewChatDraft"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"selectedUsers"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"groupName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"MtmaAppBannerSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"dismissedApps"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"UserExperiencePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tflGroupTemplatesHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplatesHidden"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"tflMeetingChicletPrivacyNoticeSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"TflMeetingChicletPrivacyNoticeSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"prejoinSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"PrejoinSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"coachSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"CoachSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"streamingSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"StreamingSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"channelInfoPaneSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"ChannelInfoPaneSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"chatInfoPaneSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"ChatInfoPaneSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"audienceViewSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"AudienceViewSettings"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"newChatDraft"},type:{kind:"NamedType",name:{kind:"Name",value:"NewChatDraft"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"mtmaAppBannerSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"MtmaAppBannerSettings"}}}]},{kind:"UnionTypeDefinition",name:{kind:"Name",value:"ClientPreferenceCategoryTypes"},types:[{kind:"NamedType",name:{kind:"Name",value:"AnimationPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"DensityPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"InfoPanePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"PerformancePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"AppSwitcherPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"ThemePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"VideoEffectPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"BackgroundEffectPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"AvatarPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"PromoBadgePreferences"}},{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferences"}},{kind:"NamedType",name:{kind:"Name",value:"DiagnosticsLogsPreferences"}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"PerformancePreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"mode"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PerformanceMode"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AvatarPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"lastUsedAvatarFilter"},type:{kind:"NamedType",name:{kind:"Name",value:"AvatarFilter"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"VideoEffectPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"lastUsedVideoFilter"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoFilter"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"lastUsedBackgroundImage"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoCustomBackgroundImage"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"BackgroundEffectPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"lastUsedBackgroundEffect"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoCustomBackgroundImage"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"VideoFilter"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"appId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"filterId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"appName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"VideoCustomBackgroundImage"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"imageId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"imagePath"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"AvatarFilter"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"appId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"filterId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"FieldDefinition",name:{kind:"Name",value:"imageId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"DiagnosticsLogsPreferences"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"FieldDefinition",name:{kind:"Name",value:"shouldPersistLogsIntoIDB"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplatesHiddenInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"items"},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplateHiddenInput"}}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TflGroupTemplateHiddenInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"groupTemplate"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"isHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TflMeetingChicletPrivacyNoticeSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"dismissedAt"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"noticeDismissCount"},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"PrejoinSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"prejoinScreenSelectedAudio"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"prejoinScreenVideoState"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"prejoinScreenMicState"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"CoachSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"isAutoStart"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"StreamingSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"uuid"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ChatInfoPaneSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"shouldShow"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ChannelInfoPaneSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"shouldShow"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AudienceViewSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"coachmarksDisplayed"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"NewChatDraftInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"selectedUsers"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"groupName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"MtmaAppBannerSettingsInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"dismissedApps"},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"UserExperiencePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"tflGroupTemplatesHidden"},type:{kind:"NamedType",name:{kind:"Name",value:"TflGroupTemplatesHiddenInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"tflMeetingChicletPrivacyNoticeSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"TflMeetingChicletPrivacyNoticeSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"prejoinSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"PrejoinSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"coachSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"CoachSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"streamingSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"StreamingSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"chatInfoPaneSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"ChatInfoPaneSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"channelInfoPaneSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"ChannelInfoPaneSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"audienceViewSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"AudienceViewSettingsInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"newChatDraft"},type:{kind:"NamedType",name:{kind:"Name",value:"NewChatDraftInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"mtmaAppBannerSettings"},type:{kind:"NamedType",name:{kind:"Name",value:"MtmaAppBannerSettingsInput"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AnimationPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"disableAnimations"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"CheckboxPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"checkboxChecked"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"PromoBadgePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"badgeActionComplete"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"labelActionComplete"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"DensityPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"chatDensity"},type:{kind:"NamedType",name:{kind:"Name",value:"Density"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"FlyoutCameraPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"cameraState"},type:{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraUserChoice"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"InfoPanePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"chats"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"channels"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"chatContextualSearch"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"channelcontextualsearch"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"chatHighlightsDetails"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPaneState"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"PerformancePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"mode"},type:{kind:"NamedType",name:{kind:"Name",value:"PerformanceMode"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ThemePreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"userTheme"},type:{kind:"NamedType",name:{kind:"Name",value:"UserTheme"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"followOsTheme"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"VideoEffectPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"lastUsedVideoFilter"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoFilterInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"lastUsedBackgroundImage"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoCustomBackgroundImageInput"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"BackgroundEffectPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"lastUsedBackgroundEffect"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoCustomBackgroundImageInput"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AvatarPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"lastUsedAvatarFilter"},type:{kind:"NamedType",name:{kind:"Name",value:"AvatarFilterInput"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"VideoFilterInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"appId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"filterId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"appName"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"VideoCustomBackgroundImageInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"imageId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"imagePath"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"AvatarFilterInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"appId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"filterId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"imageId"},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"TeamLayoutPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"currentLayout"},type:{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferenceOptions"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"DiagnosticsLogsPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"shouldPersistLogsIntoIDB"},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]},{kind:"InputObjectTypeDefinition",name:{kind:"Name",value:"ClientPreferencesInput"},fields:[{kind:"InputValueDefinition",name:{kind:"Name",value:"animation"},type:{kind:"NamedType",name:{kind:"Name",value:"AnimationPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"density"},type:{kind:"NamedType",name:{kind:"Name",value:"DensityPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"flyoutCamera"},type:{kind:"NamedType",name:{kind:"Name",value:"FlyoutCameraPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"infoPane"},type:{kind:"NamedType",name:{kind:"Name",value:"InfoPanePreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"performance"},type:{kind:"NamedType",name:{kind:"Name",value:"PerformancePreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"appSwitcher"},type:{kind:"NamedType",name:{kind:"Name",value:"CheckboxPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"theme"},type:{kind:"NamedType",name:{kind:"Name",value:"ThemePreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"videoEffect"},type:{kind:"NamedType",name:{kind:"Name",value:"VideoEffectPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"backgroundEffect"},type:{kind:"NamedType",name:{kind:"Name",value:"BackgroundEffectPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"promo"},type:{kind:"NamedType",name:{kind:"Name",value:"PromoBadgePreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"avatar"},type:{kind:"NamedType",name:{kind:"Name",value:"AvatarPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"teamLayout"},type:{kind:"NamedType",name:{kind:"Name",value:"TeamLayoutPreferencesInput"}}},{kind:"InputValueDefinition",name:{kind:"Name",value:"diagnosticsLogs"},type:{kind:"NamedType",name:{kind:"Name",value:"DiagnosticsLogsPreferencesInput"}}}]}]}},80130:e=>{e.exports={kind:"Document",definitions:[{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"localizationSettings"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocalizationSettings"}}}}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Mutation"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"updateCurrentLocale"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"newLocale"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocalizationSettings"}}}}]},{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"LocalizationSettings"},interfaces:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"currentLocale"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]}]}},931473:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<link\n  rel="icon"\n  type="image/png"\n  href="[[staticsPath]]/hashedassets/favicon/prod/favicon-32x32-04b7d908.png"\n/>\n<link\n  rel="icon"\n  type="image/png"\n  href="[[staticsPath]]/hashedassets/favicon/prod/favicon-16x16-aedbfeac.png"\n/>\n<link\n  rel="icon"\n  type="image/png"\n  href="[[staticsPath]]/hashedassets/favicon/prod/favicon-96x96-6b9521ce.png"\n/>\n<link\n  rel="shortcut icon"\n  type="image/x-icon"\n  href="[[staticsPath]]/hashedassets/favicon/prod/favicon-34ed16c5.ico"\n/>';return __p}},346701:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)__p+="<style>\n  .preload-title-bar-trim {\n    ","mac"===osPlatform?__p+="\n    --preload-title-bar-background-color: rgb(98, 100, 167);\n    ":__p+="\n    --preload-title-bar-background-color: rgb(70, 71, 117);\n    ",__p+='\n\n    background-color: var(--preload-title-bar-background-color);\n    padding: .3rem .3rem 0 .3rem;\n    height: 4rem;\n    width: 100%;\n    position: fixed;\n    top: 0;\n    left: 0;\n    box-sizing: border-box;\n    -webkit-app-region: drag;\n    z-index: -20;\n  }\n\n  .preload-title-bar-trim * {\n    margin: 0;\n    padding: 0;\n    -webkit-margin-before: 0;\n    -webkit-margin-after: 0;\n    box-sizing: inherit;\n  }\n\n  .preload-title-bar {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    color: white;\n    position: relative;\n  }\n\n\n  /**\n   * Allows resizing around the edges of the title bar by creating a region that isn\'t draggable\n   * The \'top\' value must be greater than zero, otherwise when the app is maximized,\n   * you won\'t be able to click and drag the window from the very top\n   */\n  .preload-title-bar::before {\n    content: "";\n    top: .2rem;\n    position: absolute;\n    height: .2rem;\n    -webkit-app-region: no-drag;\n    width: 100%;\n    left: 0;\n  }\n\n  .preload-title-bar-text {\n    margin: auto;\n    text-align: center;\n    font-size: 1.4rem;\n    pointer-events: none;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  .preload-title-bar-buttons {\n    height: 4rem;\n    display: flex;\n    flex-basis: 0;\n    align-items: center;\n    position: absolute;\n    top: 0;\n    right: 0;\n    margin-top: -.3rem;\n    margin-right: -.3rem;\n  }\n\n  .preload-title-bar-button {\n    background-color: var(--preload-title-bar-background-color);\n    -webkit-app-region: no-drag;\n    user-select: none;\n    border: 0;\n    border-radius: 0;\n    cursor: pointer;\n    height: 100%;\n    width: 4rem;\n    outline: none;\n  }\n\n  .preload-title-bar-button>svg {\n    fill: white;\n    background-color: inherit;\n    width: 1.6rem;\n    height: 1.6rem;\n    display: block;\n    margin: auto;\n  }\n\n  .preload-title-bar-button-close-filled {\n    display: none;\n  }\n\n  .preload-title-bar-button-close-outline {\n    display: block;\n  }\n\n  .preload-title-bar-button:hover {\n    background-color: rgb(51, 52, 74);\n  }\n\n  .preload-title-bar-button-close:hover {\n    background-color: rgb(196, 49, 75);\n  }\n\n  .preload-title-bar-button-close:hover .preload-title-bar-button-close-filled {\n    display: block;\n  }\n\n  .preload-title-bar-button-close:hover .preload-title-bar-button-close-outline {\n    display: none;\n  }\n</style>\n<div class="preload-title-bar-trim">\n  <div id="preload-title-bar" class="preload-title-bar">\n    <span class="preload-title-bar-text" aria-hidden="true">Microsoft Teams</span>\n\n    ',"windows"===osPlatform&&(__p+='\n    <div class="preload-title-bar-buttons">\n      \x3c!-- TODO: Hook button up to minimize/maximize/collapse API --\x3e\n      <button class="preload-title-bar-button">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <path d="M10 16v-1h12v1H10z"></path>\n        </svg>\n      </button>\n      \x3c!-- TODO: Hook button up to minimize/maximize/collapse API --\x3e\n      <button class="preload-title-bar-button">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <path d="M10 10h12v12H10V10zm11 11V11H11v10h10z"></path>\n        </svg>\n      </button>\n      \x3c!-- TODO: toggle on when maximized --\x3e\n      \x3c!-- TODO: Hook button up to minimize/maximize/collapse API --\x3e\n      <button class="preload-title-bar-button" style="display:none;">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <path d="M11 9v2H9v12h12v-2h2V9H11zm9 13H10V12h10v10zm2-2h-1v-9h-9v-1h10v10z"></path>\n        </svg>\n      </button>\n      <button class="preload-title-bar-button preload-title-bar-button-close">\n        <svg role="presentation" focusable="false" viewBox="8 8 16 16">\n          <g>\n            <path class="preload-title-bar-button-close-outline"\n              d="M16.707 16l4.243-4.243a.5.5 0 1 0-.707-.707L16 15.293l-4.243-4.243a.5.5 0 1 0-.707.707L15.293 16l-4.243 4.243a.5.5 0 1 0 .707.707L16 16.707l4.243 4.243a.498.498 0 0 0 .707 0 .5.5 0 0 0 0-.707L16.707 16z">\n            </path>\n            <path class="preload-title-bar-button-close-filled"\n              d="M17.414 16l3.89-3.89a1 1 0 1 0-1.415-1.413L16 14.586l-3.89-3.89a1 1 0 1 0-1.413 1.415L14.586 16l-3.89 3.89a1 1 0 1 0 1.415 1.413L16 17.414l3.89 3.89a.997.997 0 0 0 1.413 0 1 1 0 0 0 0-1.415L17.414 16z">\n            </path>\n          </g>\n        </svg>\n      </button>\n    </div>\n    '),__p+="\n  </div>\n</div>";return __p}},871177:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)0;return __p}},406364:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<style type="text/css" id="splash-styles">\n  /** Remove outline, when focusing splash screen, because it is not necessary to inform user about focus on that element. */\n  div[id="splash-screen"] {\n    outline: none;\n  }\n\n\n  /** Below styles are dedicated for the pre-loading wheel (before React loads) */\n  .ui.loader {\n    display: none;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    margin: 0;\n    text-align: center;\n    z-index: 1000;\n    -webkit-transform: translateX(-50%) translateY(-50%);\n    transform: translateX(-50%) translateY(-50%);\n  }\n\n  .ui.loader:before {\n    position: absolute;\n    content: "";\n    top: 0;\n    left: 50%;\n    width: 100%;\n    height: 100%;\n    border-radius: 500rem;\n    border: 0.2em solid rgba(0, 0, 0, 0.1);\n  }\n\n  .ui.loader:after {\n    position: absolute;\n    content: "";\n    top: 0;\n    left: 50%;\n    width: 100%;\n    height: 100%;\n    -webkit-animation: loader 0.6s linear;\n    animation: loader 0.6s linear;\n    -webkit-animation-iteration-count: infinite;\n    animation-iteration-count: infinite;\n    border-radius: 500rem;\n    border-color: #767676 transparent transparent;\n    border-style: solid;\n    border-width: 0.2em;\n    -webkit-box-shadow: 0 0 0 1px transparent;\n    box-shadow: 0 0 0 1px transparent;\n  }\n\n  @-webkit-keyframes loader {\n    from {\n      -webkit-transform: rotate(0);\n      transform: rotate(0);\n    }\n\n    to {\n      -webkit-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n\n  @keyframes loader {\n    from {\n      -webkit-transform: rotate(0);\n      transform: rotate(0);\n    }\n\n    to {\n      -webkit-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n\n  .ui.large.loader:after,\n  .ui.large.loader:before {\n    width: 3.42857143rem;\n    height: 3.42857143rem;\n    margin: 0 0 0 -1.71428571rem;\n  }\n\n  .ui.text.loader {\n    width: auto !important;\n    height: auto !important;\n    text-align: center;\n    font-style: normal;\n  }\n\n  .ui.loader.active,\n  .ui.loader.visible {\n    display: block;\n  }\n\n  .ui.loader.disabled,\n  .ui.loader.hidden {\n    display: none;\n  }\n\n  .ui.large.text.loader {\n    min-width: 3.42857143rem;\n    padding-top: 4.21428571rem;\n  }\n\n  @-webkit-keyframes fadeOut {\n    from {\n      opacity: 1;\n    }\n\n    to {\n      opacity: 0;\n    }\n  }\n\n  @keyframes fadeOut {\n    from {\n      opacity: 1;\n    }\n\n    to {\n      opacity: 0;\n    }\n  }\n\n  .ui.loader.fadeOut {\n    -webkit-animation: fadeOut 500ms linear;\n    animation: fadeOut 500ms linear;\n  }\n</style>';return __p}},874645:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)__p+='<div id="splash-screen" tabindex="-1" role="progressbar" aria-valuetext="Loading..."\nstyle="height: 100vh; overflow: hidden; -webkit-app-region: drag;">\n  \x3c!-- Inline styles below as once React loads, all of the below will be removed. --\x3e\n  <div style="height: calc(100% - 4rem);\n                -webkit-user-select: none;\n                background-color: transparent;">\n    ',titleBar&&(__p+='\n      <div style="height:4rem;background-color:#464775"></div>\n    '),__p+='\n    <div class="ui large active text loader">\n      <span id="splash-screen-label">Loading...</span>\n    </div>\n  </div>\n</div>\n';return __p}},706827:module=>{module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj){if(__p+='<!DOCTYPE html>\n<html lang="en">\n<head data-config="'+(null==(__t=htmlWebpackPlugin.options.platformConfig)?"":__t)+'">\n  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />\n  <meta name="containerVer" content="'+(null==(__t=htmlWebpackPlugin.options.containerVer)?"":__t)+'" />\n  <script nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">'+(null==(__t=htmlWebpackPlugin.options.publicPathScript)?"":__t)+"<\/script>\n  "+(null==(__t=htmlWebpackPlugin.options.partials.devtools)?"":__t)+"\n  "+(null==(__t=htmlWebpackPlugin.options.partials.favicons)?"":__t)+"\n\n  ",htmlWebpackPlugin.options.isMainWindow&&(__p+='\n    <script type="text/javascript" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+"\">\n      __webpack_nonce__ = '"+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+"';\n      __VERSION__  = '"+(null==(__t=htmlWebpackPlugin.options.containerVer)?"":__t)+'\';\n      // TODO Remove the copy step once OnePlayer Loader supports dynamic importing. (https://onedrive.visualstudio.com/OMG/_workitems/edit/1170258)\n      onePlayerLoaderFullStaticPath = window.__webpack_public_path__;\n      function postExperienceStarted(message, errorCode) {\n        if (window.desktop && window.desktop.ipcRenderer) {\n          // Notifies the host of the experienceStarted event\n          window.desktop.ipcRenderer.sendToHost("experience-renderer-channel", {\n            eventId: "experienceStarted",\n            payload: {\n              message: message,\n              errorCode: errorCode,\n              errorDescription: errorCode && message\n            }\n          });\n        }\n      }\n\n      function experienceContainerPerfEntriesHandler(_ipcRendererEvent, event) {\n          if (event && event.eventId === "getExperienceContainerPerfEntries") {\n            if (window.desktop.ipcRenderer) {\n              // Notifies the host of the performance entries\n              window.desktop.ipcRenderer.sendToHost("experience-renderer-channel", {\n                eventId: "getExperienceContainerPerfEntries",\n                payload: {\n                  data: window.performance.getEntriesByType("resource")\n                }\n              });\n            }\n          }\n        }\n\n      function postPerformanceEntriesOnRequest() {\n        if(window.desktop && window.desktop.ipcRenderer && window.desktop.ipcRenderer.once) {\n          window.desktop.ipcRenderer.once("experience-renderer-channel",\n          experienceContainerPerfEntriesHandler);\n        }\n      }\n\n      function registerHandlersAndSetSource(id, src) {\n        const scriptEle = document.getElementById(id);\n        if (scriptEle && src) {\n          scriptEle.onload = function() {\n            postExperienceStarted(id + " loaded");\n          };\n          scriptEle.onerror = function() {\n            postExperienceStarted("Loading " + id + " failed. src=" + src, -1);\n          };\n\n          scriptEle.src = src;\n        }\n      }\n    <\/script>\n\n    <script nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n      performance.mark("execute-index-html-script");\n      postExperienceStarted("start");\n      postPerformanceEntriesOnRequest();\n    <\/script>\n\n    \x3c!-- TODO [#2218015]: [Debt][MW]: remove html.position=fixed once MW is fully react. --\x3e\n    <style>\n      html {\n        position: fixed;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n      }\n    </style>\n  '),__p+="\n\n   <style>\n    html,\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Web', sans-serif;\n      width: 100%;\n      height: 100%;\n      padding: 0;\n      margin: 0;\n    }\n\n    html {\n      font-size: calc(1em * .625);\n    }\n\n    body {\n      font-size: 1.4rem;\n      overflow: hidden;\n    }\n\n    /** Enable antialiasing and font smoothing across supporting browsers for all elements */\n    * {\n      -webkit-font-smoothing: antialiased;\n      -moz-osx-font-smoothing: grayscale;\n    }\n\n    /*!*Remove hidden ADAL iframes borders as to not cause unnecessary vertical scrolling*!*/\n    body > iframe[id^=\"adal\"] {\n      border: 0;\n    }\n  </style>\n\n  "+(null==(__t=void 0!==htmlWebpackPlugin.options.partials.splashStyles?htmlWebpackPlugin.options.partials.splashStyles:"")?"":__t)+"\n\n</head>\n\n<body ",htmlWebpackPlugin.options.isMainWindow?__p+='\n        id="main-window-body"\n      ':__p+='\n        id="child-window-body"\n      ',__p+="\n>\n\n",htmlWebpackPlugin.options.partials.preloadTitleBar&&(__p+="\n  "+(null==(__t=htmlWebpackPlugin.options.partials.preloadTitleBar)?"":__t)+"\n"),__p+="\n\n",htmlWebpackPlugin.options.partials.splash&&!htmlWebpackPlugin.options.isMainWindow?__p+='\n  <div style="display: none; height: inherit;" id="app"></div>\n  '+(null==(__t=htmlWebpackPlugin.options.partials.splash)?"":__t)+"\n":__p+='\n  <div style="height: inherit;" id="app"></div>\n',__p+='\n\n  <script id="initialize-bootstrap-data" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n    // Wrap in an IIFE to prevent leaking to the global scope\n    (function() {\n      function setInitialThemeColors() {\n        const theme = "'+(null==(__t=htmlWebpackPlugin.options.theme)?"":__t)+'" || "default";\n\n        const bodyStyle = document.body.style;\n        switch (theme) {\n          case "default":\n            bodyStyle.backgroundColor = "#F3F2F1";\n            bodyStyle.color = "#252424";\n            break;\n          case "dark":\n            bodyStyle.backgroundColor = "#201F1F";\n            bodyStyle.color = "#FFF";\n            break;\n          case "contrast":\n            bodyStyle.backgroundColor = "#000";\n            bodyStyle.color = "#FFF";\n            break;\n          case "defaultV2":\n          case "tfl-default":\n            bodyStyle.backgroundColor = "#F5F5F5";\n            bodyStyle.color = "#252424";\n            break;\n          case "darkV2":\n          case "tfl-dark":\n            bodyStyle.backgroundColor = "#1F1F1F";\n            bodyStyle.color = "#FFF";\n            break;\n        }\n      }\n\n      function setInitialWindowTitle() {\n        const isMainWindow = "'+(null==(__t=htmlWebpackPlugin.options.isMainWindow)?"":__t)+'";\n\n        if (isMainWindow) {\n          document.title = "";\n        } else {\n          document.title = "New Window | Microsoft Teams";\n        }\n      }\n\n      function focusSplashScreen() {\n        const splashScreen = document.getElementById("splash-screen");\n        if (splashScreen) {\n          splashScreen.focus();\n        }\n      }\n      ',htmlWebpackPlugin.options.shouldStubConsoleError&&(__p+="\n      /*\n       * Stub console error to prevent the console from leaking objects.\n       * See bug: 1911460.\n       */\n      function stubConsoleError() {\n        const originalConsoleError = console.error;\n\n        const sendConsoleErrorToHost = function (args) {\n          // Stop this after main is loaded successfully.\n          if (window.desktop && window.desktop.ipcRenderer) {\n            const errorDescription = message = args.toString();\n\n            // Notifies the host of the experienceStarted event\n            window.desktop.ipcRenderer.sendToHost(\"experience-renderer-channel\", {\n              eventId: \"experienceStarted\",\n              payload: {\n                message,\n                errorCode: \"consoleError\",\n                errorDescription\n              }\n            });\n          }\n        }\n\n        const getConsoleErrorArgs = function (...args) {\n          const newArgs = [];\n          args.forEach(arg => {\n            if (!arg || typeof arg === 'string') {\n              newArgs.push(arg);\n            } else if (typeof arg.stack === 'string') {\n              newArgs.push(arg.stack);\n            } else if (typeof arg.message === 'string') {\n              newArgs.push(arg.message);\n            } else {\n              newArgs.push(JSON.stringify(arg));\n            }\n          });\n          return newArgs;\n        };\n\n        window.consoleErrorFn = function(...args) {\n          const newArgs = getConsoleErrorArgs(args);\n          originalConsoleError(...newArgs);\n        };\n\n        console.error = function(...args) {\n          const newArgs = getConsoleErrorArgs(args);\n          sendConsoleErrorToHost(newArgs);\n          originalConsoleError(...newArgs);\n      }\n    }\n\n      stubConsoleError();\n\n      /*\n       * Force unhandledrejections to errors to be serialized to prevent object leaks.\n       * See bug: 1911460.\n       */\n      const handleError = e => {\n        console.error((e && e.reason) || e);\n        e && e.preventDefault && e.preventDefault();\n        return true;\n      };\n      window.addEventListener('unhandledrejection', handleError);\n      window.addEventListener('error', handleError);\n      "),__p+='\n\n      const isScriptError = e => !!(\n        e.filename?.indexOf("46156") > -1 ||\n        e.filename?.indexOf("48494") > -1 ||\n        e.filename?.indexOf("92891") > -1 ||\n        e.filename?.indexOf("main") > -1\n        );\n\n      // Add handler for errors that occur during script loading phase.\n      window.handleGlobalWindowError = e => {\n        if (isScriptError(e)) {\n          postExperienceStarted("script error: " + e.message + ";" + "filename: " + e.filename, "scriptError");\n        }\n        return true;\n      };\n      window.addEventListener(\'error\', window.handleGlobalWindowError);\n\n      setInitialThemeColors();\n      setInitialWindowTitle();\n      // focus splash screen in order to narrate loading message and title of the window\n      focusSplashScreen();\n    })();\n  <\/script>\n\n  \x3c!-- Only use custom inject logic if `inject: false` is set --\x3e\n  ',!htmlWebpackPlugin.options.inject&&htmlWebpackPlugin.files.js){var allEntryAssets=htmlWebpackPlugin.files.js.concat(htmlWebpackPlugin.files.css).map((e=>({id:e.split("/").pop().replace(/(-[0-9a-g]+)?\..+/,""),path:e})));for(var file of(__p+='\n    \x3c!-- Chunk loader configuration --\x3e\n    <script id="cache-chunks" type="application/javascript" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+"\">\n      window.__experienceWindowChunks__ = JSON.parse('"+(null==(__t=JSON.stringify(Object.fromEntries(allEntryAssets.map((e=>[e.id,e.path])))))?"":__t)+"');\n    <\/script>\n\n    \x3c!-- Include the javascript entries that are expliclity mentioned, in the order they are mentioned --\x3e\n    ",allEntryAssets)){var fileId=file.id,fileLocation=file.path,isGriffel=/griffel/.test(fileLocation);if(!isGriffel){var lazy=htmlWebpackPlugin.options.lazy,isLazy=lazy&&lazy.includes(fileId),isPolyfill=/polyfill/.test(fileId);isPolyfill?__p+='\n        <script nomodule id="'+(null==(__t=fileId)?"":__t)+'" src="'+(null==(__t=fileLocation)?"":__t)+'"><\/script>\n      ':isLazy||(__p+='\n        <script id="'+(null==(__t=fileId)?"":__t)+'"><\/script>\n        <script nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n          registerHandlersAndSetSource("'+(null==(__t=fileId)?"":__t)+'", "'+(null==(__t=fileLocation)?"":__t)+'");\n        <\/script>\n      '),__p+="\n    "}}__p+="\n  "}__p+='\n\n  <script type="application/javascript" nonce="'+(null==(__t=htmlWebpackPlugin.options.cspNonce)?"":__t)+'">\n    // This code is required to provide post message communication between hosted iframe and MWv2 experience.\n    (function() {\n      function proxyPostMessage(target, message, targetOrigin) {\n        if (targetOrigin && target && target.contentWindow) {\n          target.contentWindow.postMessage(message, targetOrigin);\n        } else {\n          console.log("either targetOrigin or target is invalid");\n        }\n      }\n      window.proxyPostMessage = proxyPostMessage;\n    })();\n  <\/script>\n</body>\n</html>\n\n'}return __p}},121557:(e,t,n)=>{"use strict";n.d(t,{qo:()=>k,I1:()=>h,wY:()=>S,d4:()=>y,Zm:()=>f});var i=n(231191);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"firstLoginInfoNS"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"}},{kind:"Field",name:{kind:"Name",value:"WebNorthStar"}},{kind:"Field",name:{kind:"Name",value:"CoachMarkSavedWeb"}},{kind:"Field",name:{kind:"Name",value:"PromptCards"}},{kind:"Field",name:{kind:"Name",value:"FreemiumFRE"}},{kind:"Field",name:{kind:"Name",value:"ios"}},{kind:"Field",name:{kind:"Name",value:"android"}},{kind:"Field",name:{kind:"Name",value:"wp"}},{kind:"Field",name:{kind:"Name",value:"electron"}},{kind:"Field",name:{kind:"Name",value:"maglev"}},{kind:"Field",name:{kind:"Name",value:"desktopHwa"}},{kind:"Field",name:{kind:"Name",value:"surfaceHub"}},{kind:"Field",name:{kind:"Name",value:"espFirstRunStarted"}},{kind:"Field",name:{kind:"Name",value:"espFirstRunCompleted"}},{kind:"Field",name:{kind:"Name",value:"unknown"}}]}}]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferencesForCategory"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferencesForCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformationValue"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfoNS"}}]}}]}}]}}]}},...a.definitions]},r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsEspUserPreferenceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateUserPreferences"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserPreferences"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfoNS"}}]}}]}}]}}]}},...a.definitions]};var s=n(395816);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"activateEspTarget"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"surfaceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"targetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"selector"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activateEspTarget"},arguments:[{kind:"Argument",name:{kind:"Name",value:"surfaceId"},value:{kind:"Variable",name:{kind:"Name",value:"surfaceId"}}},{kind:"Argument",name:{kind:"Name",value:"targetId"},value:{kind:"Variable",name:{kind:"Name",value:"targetId"}}},{kind:"Argument",name:{kind:"Name",value:"selector"},value:{kind:"Variable",name:{kind:"Name",value:"selector"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}]}]}}]},d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsEspSurfaceUpdateEspSurfaceDisplayStatusMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isEspSurfaceShowing"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateEspSurfaceDisplayStatus"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isEspSurfaceShowing"},value:{kind:"Variable",name:{kind:"Name",value:"isEspSurfaceShowing"}}}]}]}}]};var c=n(153909),u=n(642115),m=n(281857),g=n(892891);const p="growth_growthplatform_start_esp_job",v="growth_growthplatform_esp_display_actions",h=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,a;try{const t=yield e.query({query:o,variables:{category:"firstLoginInformation"}});return"FirstLoginInformationValue"===(null===(n=t.data)||void 0===n?void 0:n.userPreferencesForCategory.__typename)?null===(i=t.data)||void 0===i?void 0:i.userPreferencesForCategory.firstLoginInformation:null}catch(e){return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,"First Login CDL Query failed",p),null}})),f=(e,t,n,a,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=Object.assign(Object.assign({},a),{[t]:n.toISOString()});if(delete i.__typename,i){let e;for(e in i)null===i[e]&&delete i[e]}yield e.mutate({mutation:r,variables:{category:s.nV$.firstLoginInformation,value:JSON.stringify(i)},update:(e,t)=>{var n,i,a,r,s;if("UserPreferences"===(null===(i=null===(n=t.data)||void 0===n?void 0:n.updateUserPreferences)||void 0===i?void 0:i.__typename))try{e.writeQuery({query:o,variables:{category:"firstLoginInformation"},data:{userPreferencesForCategory:{firstLoginInformation:null===(r=null===(a=t.data)||void 0===a?void 0:a.updateUserPreferences)||void 0===r?void 0:r.firstLoginInformation,__typename:"FirstLoginInformationValue"}}})}catch(e){null===(s=l.errorToTelemetry)||void 0===s||s.call(l,"Error while updating cache after updating firstLoginInformation.",p)}}})})),y=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;try{yield e.mutate({mutation:d,variables:{isEspSurfaceShowing:t},fetchPolicy:"no-cache"})}catch(e){const t=S(e,"Failed to update esp display status.");return null===(i=n.errorToTelemetry)||void 0===i||i.call(n,t.join(" "),v),Promise.reject()}return Promise.resolve(void 0)})),k=(e,t,n,a="shell",o,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;try{yield e.mutate({mutation:l,variables:{surfaceId:n,targetId:a,selector:o,windowId:r},fetchPolicy:"no-cache"})}catch(e){const n=S(e,"Failed to activate ESP target component.");return null===(i=t.errorToTelemetry)||void 0===i||i.call(t,n.join(" "),v),Promise.reject()}return Promise.resolve(void 0)})),S=(e,t)=>{const n=[t];if(b(e)){const t=(0,c.E6)(e),i=(0,u.O$)(t,"innerError",void 0);(null==i?void 0:i.code)===m.jK.NotPresent&&n.push((0,u.B9)(i))}return n},b=e=>!!e&&!!(0,g.get)(e,"graphQLErrors")},628033:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"espState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"espState"}}]}}]}},...n(16945).J.definitions]}},829333:(e,t,n)=>{"use strict";n.d(t,{$K:()=>i,Nw:()=>a,CN:()=>o});const i="corelayout",a={expandHeader:"expandHeader",collapseHeader:"collapseHeader",resetLayoutOverrides:"resetLayoutOverrides",expandTab:"expandTab",maximizeTab:"maximizeTab"},o={collapseHeader:()=>({actor:i,action:a.collapseHeader}),expandHeader:()=>({actor:i,action:a.expandHeader}),expandTab:e=>({actor:i,action:a.expandTab,data:e}),maximizeTab:()=>({actor:i,action:a.maximizeTab}),resetLayoutOverrides:()=>({actor:i,action:a.resetLayoutOverrides})}},167523:(e,t,n)=>{"use strict";n.d(t,{l8:()=>C,A1:()=>S,FC:()=>y});var i=n(632735),a=n(392471),o=n(632585),r=n(782801),s=n(767008),l=n(931147),d=n(118824),c=n(688448);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"activeCallsChangedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeCallsChangedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"calls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"teamsCallId"}},{kind:"Field",name:{kind:"Name",value:"callInitiator"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"replyChainMessageId"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}}]}}]}}]}}]};var m=n(247170),g=n(95717),p=n(226568),v=n(929331),h=n(235713);const[f,y]=(0,a.j)("ActiveCallsContext");function k(e){return null!=e}const S=new Map,b=(e,t,{data:n,error:i})=>{var a,o;if(i)return e.error(`Failed to receive data from activeCallsChangedEvent: ${i}`),t;const r=null===(a=null==n?void 0:n.activeCallsChangedEvent)||void 0===a?void 0:a.id;if(!r)return t;const s=((null===(o=null==n?void 0:n.activeCallsChangedEvent)||void 0===o?void 0:o.calls)||[]).filter(k),l=new Map(t);return 0===s.length?(l.delete(r),0===l.size?S:l):new Map(l.set(r,s.reduce(((e,t)=>t.messageId?e.set(t.messageId,t):e),new Map)))},C=({children:e})=>{const t=(0,c.x)(),n=(0,l.w)("ActiveCallsContextContainer"),{enableActiveCallsSubscription:a}=(0,s.NC)(d.J.Channels),y=(()=>{const e=i.useMemo((()=>new o.xQ),[]);return i.useEffect((()=>()=>{e.next(),e.complete()}),[e]),e})(),k=i.useMemo((()=>a?(0,m.G)(t.subscribe({query:u,fetchPolicy:"no-cache"})).pipe((0,g.R)(y),(0,p.R)(((e,t)=>b(n,e,t)),S),(0,v.x)(),(0,h.d)(1)):(0,r.of)(S)),[t,a,n,y]);return i.createElement(f,{source$:k,children:e})}},260465:(e,t,n)=>{"use strict";n.d(t,{Il:()=>d,bp:()=>c,fe:()=>u,i2:()=>m,iz:()=>g,Pi:()=>p});var i=n(892891),a=n(632735),o=n(843149),r=n(860467),s=n(929331),l=n(305501);const d=a.createContext({});d.displayName="AppContext";d.Consumer;const c=()=>a.useContext(d),u="Microsoft Teams",m=e=>`${e} | ${u}`;class g extends a.PureComponent{constructor(e){super(e);const t=new o.X(e.defaultAppTitle||u);this.state={biLogger:e.biLogger,chatServiceSubscriptionFilter:{convId:null},setI18nProviderLocale:()=>{},titleObservable:t},this.titleSubscription=t.pipe((0,r.h)((e=>!!e)),(0,s.x)()).subscribe({next:t=>{e.document&&(this.props.mtmaPrefix&&(t=t.concat(this.props.mtmaPrefix)),e.document.title=m(t))}})}componentWillUnmount(){this.titleSubscription.unsubscribe(),this.state.titleObservable.complete()}render(){return a.createElement(v,{children:this.props.children,value:this.state})}}const p=a.memo((({chatServiceSubscriptionFilter:e,children:t})=>{const n=a.useContext(d),i=a.useMemo((()=>Object.assign(Object.assign({},n),{chatServiceSubscriptionFilter:e})),[e,n]);return a.createElement(v,{children:t,value:i})}));p.displayName="AppContextStateOverride";const v=a.memo((({children:e,value:t})=>a.createElement(d.Provider,{value:(0,l.Q)(t,i.isEqual)},e)));v.displayName="MemoizedAppContextProvider"},94836:(e,t,n)=>{"use strict";n.d(t,{VY:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDefinition"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinition"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...n(669702).Eb.definitions]}},353915:(e,t,n)=>{"use strict";n.d(t,{zw:()=>i,dA:()=>a,Az:()=>o,dH:()=>r,SX:()=>s,WW:()=>l,uj:()=>d,zD:()=>c,ap:()=>u});const i="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSI+PC9yZWN0PjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",a="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgaGVpZ2h0PSIxMDAlIiB3aWR0aD0iMTAwJSIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMi40NzQ3IDguMDE0MzFDMTIuOTg3NiA4LjAxNDMxIDEzLjQxMDIgOC40MDAzNSAxMy40NjggOC44OTc2OUwxMy40NzQ3IDkuMDE0MzFWMTMuMzgxN0MxMy40NzQ3IDE1LjMwNiAxMS45MTQ4IDE2Ljg2NiA5Ljk5MDQ0IDE2Ljg2NkM4LjEzMDI3IDE2Ljg2NiA2LjYxMDU2IDE1LjQwODMgNi41MTEzMSAxMy41NzI4TDYuNTA2MTYgMTMuMzgxN1Y5LjAxNDMxQzYuNTA2MTYgOC41MDE0OCA2Ljg5MjIgOC4wNzg4IDcuMzg5NTQgOC4wMjEwNEw3LjUwNjE2IDguMDE0MzFIMTIuNDc0N1pNMTIuNDc0NyA5LjAxNDMxSDcuNTA2MTZWMTMuMzgxN0M3LjUwNjE2IDE0Ljc1MzcgOC42MTg0MSAxNS44NjYgOS45OTA0NCAxNS44NjZDMTEuMzA3NiAxNS44NjYgMTIuMzg1MyAxNC44NDA5IDEyLjQ2OTQgMTMuNTQ1TDEyLjQ3NDcgMTMuMzgxN1Y5LjAxNDMxWk01Ljc3NDA3IDguMDEzNzJDNS42MzIwOCA4LjI1ODk3IDUuNTQwNjkgOC41MzcxOCA1LjUxNDE3IDguODM0MDZMNS41MDYxNiA5LjAxNDMxSDMuMDE2ODVWMTIuNzUzNEMzLjAxNjg1IDEzLjc3ODYgMy44NDc5MyAxNC42MDk3IDQuODczMTIgMTQuNjA5N0M1LjE0NDMzIDE0LjYwOTcgNS40MDE5NiAxNC41NTE1IDUuNjM0MjEgMTQuNDQ3QzUuNzEzNDcgMTQuNzc1NiA1LjgzMDA1IDE1LjA5MDcgNS45Nzg1IDE1LjM4NzFDNS42Mzg4NyAxNS41MzA3IDUuMjY1MjIgMTUuNjA5NyA0Ljg3MzEyIDE1LjYwOTdDMy4zNTE5OCAxNS42MDk3IDIuMTA4NTcgMTQuNDIwNiAyLjAyMTY5IDEyLjkyMTJMMi4wMTY4NSAxMi43NTM0VjkuMDE0MzFDMi4wMTY4NSA4LjUwMTQ4IDIuNDAyODkgOC4wNzg4IDIuOTAwMjIgOC4wMjEwNEwzLjAxNjg1IDguMDE0MzFMNS43NzQwNyA4LjAxMzcyWk0xNC4yMDY4IDguMDEzNzJMMTYuOTkxMiA4LjAxNDMxQzE3LjUwNCA4LjAxNDMxIDE3LjkyNjcgOC40MDAzNSAxNy45ODQ0IDguODk3NjlMMTcuOTkxMiA5LjAxNDMxVjEyLjc1NDJDMTcuOTkxMiAxNC4zMzEyIDE2LjcxMjcgMTUuNjA5NyAxNS4xMzU3IDE1LjYwOTdDMTQuNzM0OCAxNS42MDk3IDE0LjM1MzIgMTUuNTI3MSAxNC4wMDY5IDE1LjM3NzlDMTQuMTU1MSAxNS4wODAzIDE0LjI3MDkgMTQuNzY0OCAxNC4zNTAzIDE0LjQzNTFDMTQuNTg4NyAxNC41NDczIDE0Ljg1NDkgMTQuNjA5NyAxNS4xMzU3IDE0LjYwOTdDMTYuMTExNiAxNC42MDk3IDE2LjkxMTYgMTMuODU2MiAxNi45ODU2IDEyLjg5OTJMMTYuOTkxMiAxMi43NTQyVjkuMDE0MzFIMTQuNDc0N0wxNC40NjkyIDguODY1MDVDMTQuNDQ2NSA4LjU1NjU0IDE0LjM1MzcgOC4yNjc0OSAxNC4yMDY4IDguMDEzNzJaTTkuOTg4NTcgMi45ODkyNkMxMS4yMTg3IDIuOTg5MjYgMTIuMjE1OSAzLjk4NjQ4IDEyLjIxNTkgNS4yMTY2MkMxMi4yMTU5IDYuNDQ2NzYgMTEuMjE4NyA3LjQ0Mzk4IDkuOTg4NTcgNy40NDM5OEM4Ljc1ODQzIDcuNDQzOTggNy43NjEyMSA2LjQ0Njc2IDcuNzYxMjEgNS4yMTY2MkM3Ljc2MTIxIDMuOTg2NDggOC43NTg0MyAyLjk4OTI2IDkuOTg4NTcgMi45ODkyNlpNMTQuOTc1NyAzLjYxNzM5QzE2LjAzMjQgMy42MTczOSAxNi44ODkgNC40NzQgMTYuODg5IDUuNTMwNjlDMTYuODg5IDYuNTg3MzcgMTYuMDMyNCA3LjQ0Mzk4IDE0Ljk3NTcgNy40NDM5OEMxMy45MTkxIDcuNDQzOTggMTMuMDYyNCA2LjU4NzM3IDEzLjA2MjQgNS41MzA2OUMxMy4wNjI0IDQuNDc0IDEzLjkxOTEgMy42MTczOSAxNC45NzU3IDMuNjE3MzlaTTUuMDE3MTcgMy42MTczOUM2LjA3Mzg2IDMuNjE3MzkgNi45MzA0NyA0LjQ3NCA2LjkzMDQ3IDUuNTMwNjlDNi45MzA0NyA2LjU4NzM3IDYuMDczODYgNy40NDM5OCA1LjAxNzE3IDcuNDQzOThDMy45NjA0OSA3LjQ0Mzk4IDMuMTAzODggNi41ODczNyAzLjEwMzg4IDUuNTMwNjlDMy4xMDM4OCA0LjQ3NCAzLjk2MDQ5IDMuNjE3MzkgNS4wMTcxNyAzLjYxNzM5Wk05Ljk4ODU3IDMuOTg5MjZDOS4zMTA3MiAzLjk4OTI2IDguNzYxMjEgNC41Mzg3NyA4Ljc2MTIxIDUuMjE2NjJDOC43NjEyMSA1Ljg5NDQ3IDkuMzEwNzIgNi40NDM5OCA5Ljk4ODU3IDYuNDQzOThDMTAuNjY2NCA2LjQ0Mzk4IDExLjIxNTkgNS44OTQ0NyAxMS4yMTU5IDUuMjE2NjJDMTEuMjE1OSA0LjUzODc3IDEwLjY2NjQgMy45ODkyNiA5Ljk4ODU3IDMuOTg5MjZaTTE0Ljk3NTcgNC42MTczOUMxNC40NzEzIDQuNjE3MzkgMTQuMDYyNCA1LjAyNjI5IDE0LjA2MjQgNS41MzA2OUMxNC4wNjI0IDYuMDM1MDkgMTQuNDcxMyA2LjQ0Mzk4IDE0Ljk3NTcgNi40NDM5OEMxNS40ODAxIDYuNDQzOTggMTUuODg5IDYuMDM1MDkgMTUuODg5IDUuNTMwNjlDMTUuODg5IDUuMDI2MjkgMTUuNDgwMSA0LjYxNzM5IDE0Ljk3NTcgNC42MTczOVpNNS4wMTcxNyA0LjYxNzM5QzQuNTEyNzcgNC42MTczOSA0LjEwMzg4IDUuMDI2MjkgNC4xMDM4OCA1LjUzMDY5QzQuMTAzODggNi4wMzUwOSA0LjUxMjc3IDYuNDQzOTggNS4wMTcxNyA2LjQ0Mzk4QzUuNTIxNTcgNi40NDM5OCA1LjkzMDQ3IDYuMDM1MDkgNS45MzA0NyA1LjUzMDY5QzUuOTMwNDcgNS4wMjYyOSA1LjUyMTU3IDQuNjE3MzkgNS4wMTcxNyA0LjYxNzM5WiIvPjwvc3ZnPg==",o="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9Im1lZGl1bXR1cnF1b2lzZSIgeD0iLTYiIHk9Ii02IiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjwvcmVjdD48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTAgMkM3Ljc5MDg2IDIgNiAzLjc5MDg2IDYgNkM2IDguMjA5MTQgNy43OTA4NiAxMCAxMCAxMEMxMi4yMDkxIDEwIDE0IDguMjA5MTQgMTQgNkMxNCAzLjc5MDg2IDEyLjIwOTEgMiAxMCAyWk03IDZDNyA0LjM0MzE1IDguMzQzMTUgMyAxMCAzQzExLjY1NjkgMyAxMyA0LjM0MzE1IDEzIDZDMTMgNy42NTY4NSAxMS42NTY5IDkgMTAgOUM4LjM0MzE1IDkgNyA3LjY1Njg1IDcgNlpNNS4wMDg3MyAxMUMzLjkwMzE1IDExIDMgMTEuODg2OSAzIDEzQzMgMTQuNjkxMiAzLjgzMjgxIDE1Ljk2NjMgNS4xMzQ5OSAxNi43OTY2QzYuNDE2OTcgMTcuNjE0IDguMTQ1MjYgMTggMTAgMThDMTEuODU0NyAxOCAxMy41ODMgMTcuNjE0IDE0Ljg2NSAxNi43OTY2QzE2LjE2NzIgMTUuOTY2MyAxNyAxNC42OTEyIDE3IDEzQzE3IDExLjg5NTYgMTYuMTA0NSAxMSAxNSAxMUw1LjAwODczIDExWk00IDEzQzQgMTIuNDQ2NyA0LjQ0Nzg2IDEyIDUuMDA4NzMgMTJMMTUgMTJDMTUuNTUyMiAxMiAxNiAxMi40NDc4IDE2IDEzQzE2IDE0LjMwODggMTUuMzc3NyAxNS4yODM3IDE0LjMyNzQgMTUuOTUzNEMxMy4yNTY4IDE2LjYzNiAxMS43MzUxIDE3IDEwIDE3QzguMjY0ODkgMTcgNi43NDMxOCAxNi42MzYgNS42NzI2MiAxNS45NTM0QzQuNjIyMjYgMTUuMjgzNyA0IDE0LjMwODggNCAxM1oiLz48L3N2Zz4=",r="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==",s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAACxKAAAsSgF3enRNAAAEuElEQVR42u2cwUsjVxzHv9tVKZs9uJTEg5cY0JaNI97W4DFpb41eWjbrYVkQ/4bSRSjI9r50T9arG+iyVNNrAr1I0ps467JViLmkkJHSHHakNND2sEzIrskaWzVvZj6fk5igM/M+83vv++a9ufbF3R//EYSWD7gECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAg2bIpIPJpOPKpONKTIwG8mJXj5oqlmoqlmrGHNM1E14WHYkMa/XhfGAbvpsIa4925LotugBJoWp8SUpMjGr14TxjAK/sh6nxOyXIpOMIkLozHtoBGAJI2szvy7aPQ9f4tn2s9e93GQR6WFZUK8uzGotFAt3wDcfV0/xLlSt1UkA3FrKTWsxOKRIZDlzjb+b3VSzVjBj9GyuAFwuXckkj+sgLK/cbu2o4rnHHNnABLCvacwxgWVEt5ZK+TQlnlfv3nftVcT05ffebQR7Ak8ef6datD/Xq19/Vav391meOc6JiqaY/mn/qk48/0sjIdV+V+/WNXVWPml0r3IP7M3pwf0bPnr8a6HEaMRWcSceVmhvXVuFA24XDU58XSzWVK3UtZqe0kJ30dbk3bYxjzLOAzn5/fWP3VGl03VZ7ELWyPCvLivqu3JuYcoZMu4PGYhGtfj3f805qOK7Wvt1Ram5c93K3B35BXbfVs3J552OisMYK0HnHfPf4057RqVypq1ypD7Sklit1Pc2/7FruI5FhZdJxLeWSRndZQzKcpVxSi9mptgjvsl04VKXymxayk1cWG6tHzffOYHoN74e5DOMF8O6mleVZpe6Ma+ung1MXvuG4Wt/YVfmX+qXGxrPKvWVFtfj5lLHl3rcCdF5gy4qqWKppM79/qluw7WN9Zf98Kd1Cr//57gDWbwzJh5wVG7cLhyqWahcSG237WJv5/a553sRYFwoBzhMby5U33cJ5y7JfY11oBOg3NlaPmueKjf3Eunu520rNBWMdw5ACQj+xcc92lEnHe5bs7cKhtgoHPft5P8S60ArQT2x03VY7NnbexcVSTduFw57Tt5l0XAvZyUCuVRj408Af8ouX9rdt+7hrbOws515/343ExOh/Gj+chy9zW1SAQcXGXg0ftPUIoRWg39gYpFiHAH3ERm+eoBNTHi4hwBXExpXlWS3lkqpW30zuJBKjobnjQy9AZ0Xw05z9ZcHuYAQABAAEGBQmrpUP07kPXIAw7gs06dyN2Bxq0lapq8J7XB16AVy3pbVHO6HqChqOa8wbQozZG+g9bg3yNKy31sCkDaJGbg713hqSmhv3vQyu21K5Um+/IMo0jBSgk8TEaHuqdmY6ptjYDWPn6xuOK6dxor0Xjly3pWq12XMtIQJcgBiRm8O6GRlRLHaj/fuZ6dhb3/s/wngN2sneC6f9s+Oc6LX7l9zXLeMbOnACQEBSACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAPwL3XwvzOsJdhMAAAAASUVORK5CYII=",l="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwNiAzMDY7IiB2aWV3Qm94PSIwIDAgMzA2IDMwNiIgeD0iMHB4IiB5PSIwcHgiIHhtbG5zOnhtbD0iaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICA8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgLnN0MHtmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtmaWxsOnJnYigyMTksIDQxLCA1Myk7fQogICAgLnN0MXtlbmFibGUtYmFja2dyb3VuZDpuZXc7fQogICAgLnN0MntmaWxsOnJnYigyNTUsIDI1NSwgMjU1KTt9CiAgPC9zdHlsZT4KICA8Zz4KICA8Zz4KICAgIDxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0gMTUzIDAgTCAxNTMgMCBjIDg0LjUgMCAxNTMgNjguNSAxNTMgMTUzIGwgMCAwIGMgMCA4NC41IC02OC41IDE1MyAtMTUzIDE1MyBsIDAgMCBDIDY4LjUgMzA2IDAgMjM3LjUgMCAxNTMgbCAwIDAgQyAwIDY4LjUgNjguNSAwIDE1MyAwIFoiLz4KICAgIDxnIGNsYXNzPSJzdDEiPgogICAgPHBhdGggY2xhc3M9InN0MiIgZD0iTSAxNTQuOCA4My42IGMgMi42IDAgNS4xIDAuNyA3LjUgMi4xIGMgMi4zIDEuNCA0LjEgMy4zIDUuNCA1LjYgbCA1MS45IDk2LjQgYyAxLjIgMi4yIDEuOCA0LjUgMS44IDYuOSBjIDAgMiAtMC40IDMuOSAtMS4yIDUuNiBjIC0wLjggMS44IC0xLjggMy4zIC0zLjIgNC42IGMgLTEuMyAxLjMgLTIuOSAyLjQgLTQuNiAzLjIgYyAtMS44IDAuOCAtMy43IDEuMiAtNS42IDEuMiBIIDEwMi44IGMgLTIgMCAtMy44IC0wLjQgLTUuNiAtMS4yIGMgLTEuOCAtMC44IC0zLjMgLTEuOSAtNC42IC0zLjIgYyAtMS4zIC0xLjMgLTIuNCAtMi45IC0zLjIgLTQuNiBjIC0wLjggLTEuOCAtMS4yIC0zLjYgLTEuMiAtNS42IGMgMCAtMi40IDAuNiAtNC43IDEuOCAtNi45IGwgNTEuOSAtOTYuNCBjIDEuMyAtMi4zIDMuMSAtNC4yIDUuNCAtNS42IEMgMTQ5LjcgODQuMyAxNTIuMiA4My42IDE1NC44IDgzLjYgWiBNIDE1NC44IDkzLjMgYyAtMSAwIC0xLjkgMC4zIC0yLjYgMC44IGMgLTAuNyAwLjYgLTEuNCAxLjIgLTEuOSAyLjEgYyAtMC42IDAuOCAtMSAxLjcgLTEuNCAyLjYgYyAtMC40IDAuOSAtMC44IDEuOCAtMS4yIDIuNSBjIC0wLjggMS41IC0yIDMuOSAtMy44IDcuMiBjIC0xLjggMy40IC0zLjkgNy4zIC02LjQgMTEuNyBjIC0yLjUgNC41IC01LjIgOS4zIC04LjEgMTQuNiBjIC0yLjkgNS4zIC01LjggMTAuNiAtOC43IDE1LjkgcyAtNS43IDEwLjUgLTguNCAxNS41IGMgLTIuNyA1IC01LjEgOS41IC03LjIgMTMuNiBjIC0yLjEgNCAtMy44IDcuMyAtNSA5LjkgYyAtMS4yIDIuNiAtMS45IDQuMiAtMS45IDQuOCBjIDAgMS4zIDAuNSAyLjUgMS40IDMuNCBjIDEgMSAyLjEgMS40IDMuNCAxLjQgaCAxMDMuOSBjIDEuMyAwIDIuNSAtMC41IDMuNCAtMS40IGMgMSAtMSAxLjQgLTIuMSAxLjQgLTMuNCBjIC0xLjUgLTMuNyAtMy4xIC03LjIgLTUgLTEwLjYgYyAtMS45IC0zLjQgLTMuNyAtNi45IC01LjUgLTEwLjQgYyAtMi40IC00LjUgLTQuNyAtOSAtNyAtMTMuNCBjIC0yLjMgLTQuNSAtNC43IC05IC03IC0xMy40IGMgLTIuNCAtNC42IC00LjkgLTkuMiAtNy4zIC0xMy43IGMgLTIuNCAtNC41IC00LjkgLTkuMSAtNy4zIC0xMy43IGMgLTEuOCAtMy4yIC0zLjUgLTYuNSAtNS4zIC05LjcgYyAtMS44IC0zLjIgLTMuNiAtNi40IC01LjQgLTkuNiBjIC0wLjQgLTAuNyAtMC44IC0xLjQgLTEuMiAtMi4xIGMgLTAuNCAtMC43IC0wLjkgLTEuMyAtMS40IC0xLjkgYyAtMC42IC0wLjcgLTEuMiAtMS4zIC0xLjggLTEuOCBDIDE1Ni42IDkzLjYgMTU1LjggOTMuMyAxNTQuOCA5My4zIFogTSAxNTQuOCAxNzcuNiBjIDEgMCAxLjkgMC4yIDIuNyAwLjYgYyAwLjkgMC40IDEuNiAxIDIuMyAxLjYgcyAxLjIgMS41IDEuNiAyLjMgYyAwLjQgMC45IDAuNiAxLjggMC42IDIuNyBjIDAgMSAtMC4yIDEuOSAtMC42IDIuNyBjIC0wLjQgMC45IC0xIDEuNiAtMS42IDIuMyBzIC0xLjUgMS4yIC0yLjMgMS42IGMgLTAuOSAwLjQgLTEuOCAwLjYgLTIuNyAwLjYgYyAtMSAwIC0xLjkgLTAuMiAtMi43IC0wLjYgYyAtMC45IC0wLjQgLTEuNiAtMSAtMi4zIC0xLjYgcyAtMS4yIC0xLjUgLTEuNiAtMi4zIGMgLTAuNCAtMC45IC0wLjYgLTEuOCAtMC42IC0yLjcgYyAwIC0xIDAuMiAtMS45IDAuNiAtMi43IGMgMC40IC0wLjkgMSAtMS42IDEuNiAtMi4zIHMgMS41IC0xLjIgMi4zIC0xLjYgQyAxNTIuOSAxNzcuOCAxNTMuOCAxNzcuNiAxNTQuOCAxNzcuNiBaIE0gMTU5LjcgMTcwLjIgaCAtOS44IHYgLTQ4LjggaCA5LjggViAxNzAuMiBaIi8+CiAgICA8L2c+CiAgPC9nPgogIDwvZz4KPC9zdmc+",d="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSItNiAtNiAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMCIgY3k9IjEwIiByPSIxNiIgZmlsbD0iI0UxREZERCIvPjxwYXRoIGZpbGw9IiM2MDVlNWMiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAABGdBTUEAALGPC/xhBQAAIGhJREFUeAHtnQl4VuWZhj8IJCxhDZAERGQT12rVuuCCgChWQVu7zkwvO52pV2eKgKJtHTdwA3cExNmns9aZ6bRVtC6I+9YZF1wAQXErJiEJW9gCBJj3OeFUCX/Iv5z35Lzne97raiNZzv9+9/N8z/+d85+lw+iFq/c6FgmQAAkYINDRQI9skQRIgAQCAgwsGoEESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanabrS4qIO7acIAN6KsuO1fTvFvYPyzhAN4sNJFgIGVEj0xOW8/v9yNH1Hq5k2u9Da0EFYY/znCATwYWikx+L5hMLBSoCcm5RyZnCcP7haMpleXIi9DKwwrjB8FHuDC0ApwpOL/GFjGZewsCs6eWO5O2RdW4XB8C62WYRVyABfwASeWfQKU0bCGzWFV4U49tHll1XIovoRWa2EV8gCf2RMrGFohEMNfGVhGxeskyt0mk/C0IZnDKhxW2kOrrbAKOYATeIEbyy4BymdQuyCszit3o9sIq3BoaQ2tbMMq5ABetwk3hlZIxN5XBpYxzTDZbpVJd/ph3XPqPG2hlWtYhbDADfwYWiERW18ZWIb0KhK1bjm33J2RY1iFQ0xLaOUbViEH8ANH8GTZIkDJjOgVhtWZQ3NbWbUcnvXQKjSsQh7gyNAKadj5ysAyoBXC6uYJ5e6sAsMqHKrV0IoqrEIO4AmuXGmFRJL/lYGVcI1wdcmscwa4McMKW1m1HKa10Io6rEIe4Aq+vIonJJLsrwysBOsThJVcEzd2eKlKl2FoDendWWX7UW0U/eFyG/SrUeCLaw8ZWhp0o90mAytanpFtDZNnpmJYhY1+tH6nW7ulKfxnIr+iP/SpWQgt8GZoaVIufNsMrMIZRr6FjhJWN8huyjillVXY8NKq7W7GozWusWlv+K1EfkV/6BP9ahZ4gzv4s5JJgIGVMF0wWW4cPyC424Bma29XN7qrDIRVyAChhX7Rt2bhLg/gz9DSpJz/thlY+bOL/C8xSa4fJ2E1UueYVdjwOzWNsmKpdtsTvrIK+w2/ol/0jf41C/yhA0NLk3J+22Zg5cct8r/CXsh14/q7cw/XD6srH6l223YlezewNcDoG/1rhxZ0gB7cO2xNifb5PgOrfbjv96phWJ13eI/9vh/1P96VlYnlsAp5hKGF8WgW9GBoaRLOfdsMrNyZRfoXCKtr5Z184ijdsFq2ttFdYXhl1RI6Qgvjwbg0C7pAH660NClnv20GVvasIv9NTIJrxvZ35yuH1fIgrGrM7ga2Br45tGocxqdZ0Ac6MbQ0KWe3bQZWdpxUfguT4IIjdFdWK2ob3fRHatzWnXtUxtDeG8W4ML4VtTtUW4FO0IvVvgQYWO3E/2dn91MPq/fqdrjpi9IbVqF0QWgtqnYYr2YhtKAbq/0IMLDagf1Px/Rzk47sqfrKK4OwqnZbUrqyagkP45wuoYVxaxZ0g36s9iHAwIqZ+0/E7JOP0g2rVTJpp8nk3bwjnbuBrUmG8WLcGL9mQT/oyIqfAAMrRuZXn9XPXaQdVvU73FQPwyqUEaGF8a8SDpoFHaEnK14CDKyYeM84s5+7+GjdldX7MkmnPezfyqqlhMFKSziAh2ZBT+jKio8AAysG1leeUea+foxuWH2wTlZWMkkbPNsNbE0+cAAPcNEs6Ap9WfEQYGApc75CzHzJsb1UX2X1up0MqwyEw9ACH82CvtCZpU+AgaXIePrpZe4bymH1YRBWVW5To18H2LOVDVymPlzlwEmzoDP0ZukSYGAp8Z0m5v3ml3RXVh/KTe0ul8m4kWF1UBXB5/JFElrKNwGE3lNHM7QOKkaBP2RgFQgw059fPrqv+5ZyWOEOnAyrTPQzf2/jdgktCXftO5d++7heDvqzdAgwsCLmOuW0vu47x/WOeKv7b+7jDQiraodJyMqeQHNoVTvw0yzoDx+woifAwIqQ6Y/FpN89XjesPkFYPVTtNmzfHWHn/mwK3MAPHDULPoAfWNESYGBFxPMvTu3r/iiGsJoik209w6og1cAPK1Tt0IIf4AtWdAQYWBGw/NEpfd2ffFl3ZfXpxubdQIZVBILJJtZtaw4tcNUs+AL+YEVDgIFVIMfLTu7jvneCblj9fuOuYDcGk4wVHYEgtGTFCr6aBX/AJ6zCCTCwCmD4QzHhpSfqGnHNpl1uiny6Vc+wKkCp1v8UXMEXnDULPoFfWIURYGDlye/Pv9LHfT+OsHpIwmorV1Z5ypTVn4HvFOGsHVrwC3zDyp8AAysPdj84qY/7U/mfZn3WgN3AKlfHsNLE/IdtgzN4g7tmwTfwDys/AgysHLn94KTe7s+U3yWrZNJM+U2Vq2VY5ahOYb8O3uAO/poF/8BHrNwJMLByYPb9ExFWup/4VCOs5EAwwyoHYSL81SC0hD900Cz4CH5i5UaAgZUlr0vlk54fnqwbVjWbd7kfy2RZu6Upy674axoEwB86QA/Ngp/gK1b2BBhYWbD6npxLc5nyuTQMqyyEiPFX4got+Ar+YmVHgIHVBqfgxD/ls5VrNjcFu4H4ykoOgbh0+ZH4S/vE4+RQLawTBtZB+P3x8b3UL63AOznuIlDNsDqIEu33I+gCfbR303EJD/zGOjgBBlYrfL4rtwn5y9N0721Ui7CSj9KrGriyakWGRHwb+kAn6KVZ8Bt8x2qdAAMrA5vviGmmKN+IrU7Mj5MVP2NYZVAged+CTtALumkWfAf/sTITYGC14PJtufHe5dphtRWfQjGsWqBP/D+D0JLdwzrRT7PgP/iQdSABBtYXmHzz2J5uqvJ9uWF2rqy+AN3Yf67ZtG+lpRxa8CH8yNqfAANrH49viDmmn6H7jLl6MTluHgfTs+wSgH7QEXpqFvwIX7I+J8DAEhaXyLPlrlAOq3XbxORy07jfK98V4HNp+V+aBKAj9ISumgVfwp+sZgLeB1bwIEzlp/euF1PjcptPle+7RFPHSwB6BneAVQ6tK8WfX1N+ani85PJ/Na8DCybQfmovwyp/c1r4y7hCa8aZZQwtMYS3gXXRUT0cTNChQwe1ebFh3214P+HKSo1xEjYMfbF7CL21Cj6FX+Fbn8vLwJosol99Vj/dsAoedFAlj5TSvYDWZ/MmaezQGWfEaz7NCKEF38K/vpZ3gTXpyB7uJ8phtXFfWH3EsPJqXkFvhBb01yqEFvwLH/tYXgXWhUf0cD8do7uyag6rannCMFdWPk4o6I7dQ+3Qgo/hZ9/Km8D66qhS97OzdcNqU+NuN1XM+qE8Rp7lLwHoP21RtYMftAorLfgZvvapvAgsiHrN2P6qx6waxJzTJKxWM6x8mj+tjvWDdRJa4gf4QqsQWvC1T6GV+sCaeHhzWHUUcbUKppwq76jvi0lZJBASgB/gC83Qgq8RWvC5D5XqwDpPRLx2XH+nGlY7ZGWFsKpnWPkwYXIdI3wBfzSIT7QK/obP4fe0V2oD69yRpe465bDaLCacLmZcxbBK+zwpaHzwB3wCv2gVQgt+h+/TXKkMrAkxhtXKOq6s0jxBohobfBJXaMH/aa2iwRdMm5mmwY0f0d3dMH6AK+qod8xqy449Yr4a957BsCoSLIN7d3bDy4qD/3Uv7uia9ux1jU17E2uD3l07uqF9i90R/Utcv+5FrrMMAhokt+PMKOvlTPjX1jS68cNLXXEnHX9ipXXmYd3cp3JxdhpPrekweuFqa7pndoN8d/zw7u7Gc2IIq0eq3YraHa32kcQfHFNeElyLNlrM3LOk6IAWV9btcE+v3up+9e4mt21X+1uiW+cO7uvH9HLjRNNRElQtC8eEXv54m/v1sgb37lpbWhw5oMTNvbDSlZbo7eDsljehWU/VuiWiaZoqNYE1Vow9U8Kqk+LKautOrKyq3XJDYdWna5G7Ss6MPntY96x8i0tLHnh1vXv0vc1Z/b7GL10gJ0TioQzoPZt69sOt7q7n61Uvi8mmj1x+5yiE1qRKhxWuVmHlPFNC65kUhVYqdgkxGWdN0A+rK2VltcxQWI2U3b75Fw10x5R3yXpOdO3c0Z05tLvr263I/e7TbbHudmF3dYaE62XygFH0kW0d1qfYjR9R6t74bLtbr3hZTLb9ZPN7dVt3uzertssKUnYPMXCFwu7hWaIlrnNMyzWt5gNrzNBu7qZzy9VXVggrS7seg3p2cg98baAr69Ypr6mA3RascF7+ZFtef5/PH2ElmO99n0plpYLdR6y2NsvxLQtVG1NojZE39I/khOY03DUk+7exBDrg9CESVhN0w2rbrj1uxqO2wgqLk9vPr3A9u2S3S9WatBfL/cImx3SRLV4Hr1dIYbwYdw6Ls0JeLpK/xZsg/AWfaRUOk2CeYL5YL7OBNbRPZzcTu4FKy2kIG4TVIzXunRpbB3UvObZX8KlaFObEU4k1j7OgR2wfrxNF4dNEjN9SwV8zxGeqoSXzBPMF88ZymQ0sXI7QTfGtdLu84131aI17u6bRlL44HnLpCb0j67mXrFq0n97yLXnQAl4nqsL4tY4LRdVjy+3AZ/AbfKdVmC+YN5bLZGCdemhXd3QOB5JzFQimmSHmeavaVlhhnCcO6lrwrmBLXjhvSLNw4DnKwq4hOFgr+E07tDBvMH+slsnAGpvlR/T5iNIoYXX1b22GFcY7ekj0ZhwmnzaWl+Z38L4tDbBdbD/q0uAQdY+ZtrdUQgv+gw+1SnP+aPUcbtdkYB1XGf2kBJAwrN6ssreyCgUd1FPnGMVA+dRRo7S2q8VBg0HLbcJ/mqGlNX9ajkPj3yYDC5dnRF07mmRl9ViNe8NwWIFJmQKbYLtyXpZGlSltF+eRWS74EH6EL6MujfkTdY+tbc9kYGlcOIKT7EqKTOLYT9sdStcEWtvuzt0aLtkPtfo/4Ef4MuqyTMbkDK3bEv3TdnFB7W0Ty91phg9Iwtj1cjKiRuHCXY1S264SBw0GmbYJH84WP8KXUZfG/Im6x9a2ZzKwcGBSo/BR+G0TK0x/irKqPvpzxrBa+Vjp1s/YrsZqaKUCBw3PZdomPsWDDzXCCq+nNX8yjSXq75kMLNxVQKsQWrPFLCcP1jmwr9V3uN3nP4r+UprX12x325V2NbFdbD/qekGBQ9Q9ZtreKeI7+E/zPLIlH2zJ9NImvmcysF4Tgy+VC0e1CmaZI8vxkw+xF1p4YsvytdGuQB9e0aCFOthu1NtfJuO3+OQi+A27gZphhXnz+mfR+kPVHC02bjKwMIbZz9ap3nK2pFNHN+f8cvcVg6F1/yvrW8ic/z/fkTOwNVZtX+wI28frRFULIxx/VD21tR34DH6D77QKt2jGvLFcenSUqazZ1OSue7JW5fhH2DrMc7uY6CRjoYVjFL98Z1M4jLy/4v5fc2IyOF4Hr1doYdzWjtHAX/CZZljhOCHmC+aN5TIbWICOXcNrHq9RD607xEwnDMr+nlJJMMS8l9YF97PKt5ddYvAbF9fGdh8l3K8Jr4fXzbdw/y6M21LBV/CXdlhhnmC+WC/z98PCO8Yqub3vWLkeTes+7rg9xzi5HOhd2W2p3mzjHQrT/qnVW4Ib8eFe6LkU7jqKa9pelxvixVlr5D7kb8jxldPlNs653MAPPT60vMHNWlLrCsi7OIcavNYJA7u4O79a4booXsSPN4C/krB69dN4tdSCaT6wACYILXmUEq6RUgstORCPG8ThWEuNldCS1HpJbsCH+7WPkOv12rrlMG6p+9Dyze562XVor5u9rZVz7B5buSUIrJH9its8cRI3ppv9TJ178K1Nbm/+izOt+dXqdr8sYXVXHGH1xFr3SkrCCjBTc093DAY3KLv1PJ2T7bB9lNU7OeBW98fLJMEtc3E/8X7dO0kodHDr5YTQqoYmeQfeJgfXtzrcujcp1V8uM0K/px7azeGaQ1xus10ekFG/tSm4rz76XSqXsEjOmqrjKru4uy+oyHkVmcsgsbK6VsIKb1hpqlQFFoQ5Q3YnbsUtk2VFpFVWQ0uLB7ebPYE4wqoJYfXkWveiPFUobWX6oHsmMSDSdSIWRNMqHF+5S94hv1Rh60C8Fg9uNzsC8At8k+vxuey23vxb8D38n8awwghTF1gY1AsSWtcv1g0t3L3x7gsr3LEVuR3QRn8s/wjAJ/CL5l1yEVbwPfyf1kplYEEsnIx4ozyTDQeStSoIrQsq5TFaDC0txmnYLvxxt/hENazE5/C79km+7a1HagMLYPHIJ5zboxlaeIDCPfIU36MZWu3t5US+PnwBf2g+yAP+hs/h97RXqgML4kFEPP1WO7TuFVPi0zcWCYQE4Af4Qjus4G8fwgpcUx9YGCQe1X2TiLpbcfcQpoQ58QBSFgnAB9phBT/D12l6FH1bzvEisABhiYRWcCa0YmiVlnR0cyW0cj2zvC2R+HNbBKA/fAA/aBXCCn6Gr30qPaIJpLjkg63u5qfrVFdaQWhNqpDQiv5JMAlEypZaEIDuc0V/7bCCj+Fn38qrwIK4i9/f4m4RsfcoXsfRo6RITFvpRjG0vJpP0Bu6Q3+tgm/hX/jYx/IusCDykzGG1uFyPRwr/QSgc1xhBf/6Wl4GFsR+YtUWd6vySqunvNPeJ++4uIiXlV4C0Bc6Q2+twsoKfoVvfS5vAwuiPy7i40p/zd1DPDZ9npgZd0tgpY8AdIW+0Fmr4E/4FH71vbwOLIj/W7mVCcywV/GYVhBakyvd8L4MrTRNOOg5T3TVDCv4Ev6ET1menIfVltAww5xn61VDqxdWWmLuYQyttuQw8XPoCD2hq1YhrOBLhtXnhL1fYYUoHnlvs7v9Od3Q6t21yM0Xkw/t2zl8WX41SAD6Iaygp1YhrOBH+JL1OQEG1ucs3KIVm90dz8cRWgPd0D4MrS+gN/Of0G3+5IFt3r21kAEhrOBD+JG1PwEG1v483MNyi+A7lUMLtyqG6Q9jaLWgn+x/Qq84wgr+gw9ZBxJgYB3IJLiv+d0v6D59pY/c7he7h0N6c6WVQYLEfQs6QS/oplVYWcF3uK8+KzMBBlZmLu7XyxrEPPWt/DSab/ft1sktuKjSHcrQigao0lagD3SCXpp1z4vrAt9pvob1bTOwDqLgr95tcPcwtA5CKP0/ii2sxGfwG+vgBBhYB+fj/kdMdO+LuiutMnnnxu7G4F7cPWxDjlh/DD2gC/TRLPgLPmO1TYCB1TYjeex7g7vvJd3QwmO35stuxyG9dCdHFsPlrwgB6AA9oItmwVfwFys7Agys7Di5/3q7Qf0x6P1lciyQTw8HyTP4WO1HAPyhA/TQrHkvrQt8pfkaads2AysHRf/z7U1u/su6nx72L+3k7r+IoZWDLJH+KsIK/KGDZsFH8BMrNwIMrNx4BY9EXxBDaC1gaOWoTOG/HqysYggr+OfBtxhW+SjGwMqD2i/EbAtf0V1pDZB3+PkyefCIdpY+AXAGb3DXLPgG/mHlR4CBlR839+9LN7kHXl2f519n92flCC05llLZQ3cSZddNen8LfMEZvDULfoFvWPkTYGDlz87925sb3d/8Tje0KmQy4aRFfGVFTyAuvvAJ/MIqjAADqzB+7l/e2Oj+Vj205ExrOR9IewVQIApzfw6e4FrRQ/f8N/gDPmEVToCBVThD989ixr/7X92VVmXPzvLpFUMrArmCTSCswBNcNQu+gD9Y0RBgYEXD0f389Y3uH/5PP7Swezigu94FuBHhSPRmwA8ctcMKfoAvWNERYGBFx9L942sIrQ0RbvHATQ2UFcGCi3FSI0PrQDptfwfcwA8cNQs+gB9Y0RJgYEXLU0y6wf2T/E+zBiG0cL4QQysnzEFYCTfw0yzoDx+woifAwIqeqft7eXf9+eu6hj1ELsxFaPVjaGWlIDiBF7hpFnSH/iwdAgwsHa5yEH6DfDKka9wgtOT8oX6KN5VTwhPrZsEH1wZqhxX0hu4sPQIMLD22co7WBvevyp8QDcadMOUAchlDK6OS4AI+4KRZ0Bl6s3QJMLB0+bq/juGEwUN7Fwf3beqr+BQXZUwqmwcP3M8KfDQLJ4RCZ5Y+AQaWPuPgEp7/WKr7idGQPsXBR/UMrWZBwQGnLoCLZkFX7Uu0NPu3tm0GVkyK3f/KeveLGEILuz94Ko/PFTyVKIawgp7QlRUfAQZWfKzdAjH3g2/prrQOkxUFdoN6d/VTWowb4wcHzYKO0JMVLwE/XR0v4/1ebf7L6+Uuk7pX7A+Vx6jj7gO9u/glL8aLcWP8mgX9oCMrfgJ+OTp+vhlf8T65Ne5/K4fWMM9CKwwrjFuzoBv0Y7UPAQZW+3B3c8X0v3xHd6U1rKzYzZMVR6+Ur7QwPowT49Us6AXdWO1HgIHVfuzl8WHr5Fl0uqE1PAitStezJJ1SY1zz5JgVxqlZ0Al6sdqXQDpd3L5Mc3p1PJpc+wGaI8pKgkmdttAKwwrj0yzoA51Y7U+AgdX+GshkqHe/Wab7bLqR/UrcfbIS6ZGSlRbGgfFgXJoFXaAPKxkEGFjJ0MHd+Xy9e2i5bmgdLpN73iT7oYWwwjgwHs2CHtCFlRwCDKzkaOHueK7ePawdWv1lpWU4tIKVFcJKxqFZ0AF6sJJFgIGVLD3c7TJJFq3QXWmNksl+74WVrrTYlvzoF32jf80Cf+jASh4BW45NHj+VjuY8W+8efW+zyrbDjR45oMTNnVThuhsJLfSJftG3ZoE7+LOSSYCBlUxd3Oxn6mIIrS5u7oUVrrioQ0IpNLeF/tDnkQO6qPaJsAJ3VnIJMLASqs1e6QuT57GVuiutpdWNbuduvFpyC/29WdWo2iA4g3eySagiMLFxBlaCZcLkufXpOve4Umjh1ihW7jawEE9NVnoQKfiCM8MqwZNhX2sMrIRrhEl0i0ymJ1ZFu9KyFFahRBqhBa7gy7AKKSf7KwMr2foE3YWh9eSqLZF0azGswoFHGVrgybAKydr4ysCyoZPbI6l189O17qn3Cwsty2EVShVFaIEjeIIryw4BBpYdrYLJNWuJhNYH+YVWGsIqlKuQ0AI/cGRYhTTtfGVg2dEq6BST7Kanat3Tq3MLrTSFVShZPqEFbuDHsAop2vrKwLKlV9AtzkKYubjWPZNlaKUxrELZcgkt8AK3hJ/FEQ6NXzMQYGBlgGLhW5h0N8rke/bDrQdtN81hFQ48m9ACJ/BiWIXUbH5lYNnULegak++GxWvdc62Elg9hFcp3sNACH3BiWIW07H5lYNnVLuh89x7nrpfJ+PxH+6+0cJKllZNCo5IgU2iBC/iAE8s+AQaWfQ2DyXjdk2vdC/tCC2GFyetjfTG0wANcGFbpcUKH0QtXy44FKw0EOsnbz4SRpXL9YW6fIKZh7C3HcP6oUrdYzrVq4sqqJRrT/2ZgmZaPzZOAXwS4S+iX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBBhYfunN0ZKAaQIMLNPysXkS8IsAA8svvTlaEjBNgIFlWj42TwJ+EWBg+aU3R0sCpgkwsEzLx+ZJwC8CDCy/9OZoScA0AQaWafnYPAn4RYCB5ZfeHC0JmCbAwDItH5snAb8IMLD80pujJQHTBBhYpuVj8yTgFwEGll96c7QkYJoAA8u0fGyeBPwiwMDyS2+OlgRME2BgmZaPzZOAXwQYWH7pzdGSgGkCDCzT8rF5EvCLAAPLL705WhIwTYCBZVo+Nk8CfhFgYPmlN0dLAqYJMLBMy8fmScAvAgwsv/TmaEnANAEGlmn52DwJ+EWAgeWX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBP4fdKKKT3sfOPsAAAAASUVORK5CYII=",u="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDQ1IDQ1Ij4KPHBhdGggZmlsbD0iI2E3MjAzNyIgc3Ryb2tlPSIjZmZmIiBkPSJNMjIuNSw0NC41YzEyLjE1LDAsMjItOS44NSwyMi0yMlMzNC42NSwuNSwyMi41LC41LC41LDEwLjM1LC41LDIyLjVzOS44NSwyMiwyMiwyMloiLz4KPHBhdGggY2xhc3M9ImNscy0zIiBkPSJNMjAuOTMsMzAuNDJsMy41Ni0xLjUxYy4xMywuODgtLjM0LDEuNzctMS4yLDIuMTQtLjg2LC4zNi0xLjgzLC4wOC0yLjM3LS42MlptNS40My0xNy44M2MyLjA5LDEuMTQsMy42NSwyLjYsNC42OCw0LjM5LDEuMDMsMS43OCwxLjUxLDMuODcsMS40Niw2LjI1LDAsLjQxLS4zNSwuNzQtLjc3LC43My0uNDEsMC0uNzQtLjM1LS43My0uNzcsLjA1LTIuMTEtLjM3LTMuOTMtMS4yNi01LjQ2LS44OS0xLjU0LTIuMjUtMi44MS00LjEtMy44Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWm0tOS4xNSw0LjQyYzIuODYtMS4yNyw2LjItLjA3LDcuNiwyLjc1bC4xLC4yMSwxLjI5LDIuODksMS43LDEuNDdjLjA5LC4wOCwuMTcsLjE3LC4yNywuMzJsLjA2LC4xMWMuMjgsLjYzLDAsMS4zNy0uNjQsMS42NWwtMTAuMzMsNC41N2MtLjE2LC4wNy0uMzMsLjExLS41MSwuMTEtLjY5LDAtMS4yNS0uNTYtMS4yNS0xLjI1di0yLjM0cy0xLjI0LTIuNzktMS4yNC0yLjc5Yy0xLjMxLTIuOTUsMC02LjM5LDIuOTUtNy43Wm0tMS41OCw3LjA5bDEuMzcsMy4wOHYyLjI4czkuNjItNC4yNiw5LjYyLTQuMjZsLTEuNjUtMS40My0xLjQyLTMuMTgtLjA4LS4xOGMtMS4wMy0yLjA4LTMuNTEtMi45Ny01LjY0LTIuMDMtMi4xOSwuOTctMy4xNywzLjUyLTIuMTksNS43MlptMTAuNS03LjkxYy45NywuNTMsMS43NCwxLjI5LDIuMzIsMi4yOSwuNTcsLjk5LC44NSwyLjA1LC44MiwzLjE1LS4wMSwuNDEtLjM1LC43NC0uNzcsLjczLS40MS0uMDEtLjc0LS4zNS0uNzMtLjc3LC4wMi0uODItLjE5LTEuNi0uNjItMi4zNi0uNDQtLjc2LTEuMDEtMS4zMy0xLjc0LTEuNzItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1oiLz4KPHBhdGggZmlsbD0iI2ZmZiIgZD0iTTIwLjkzLDMwLjQybDMuNTYtMS41MWMuMTMsLjg4LS4zNCwxLjc3LTEuMiwyLjE0LS44NiwuMzYtMS44MywuMDgtMi4zNy0uNjJabTUuNDMtMTcuODNjMi4wOSwxLjE0LDMuNjUsMi42LDQuNjgsNC4zOSwxLjAzLDEuNzgsMS41MSwzLjg3LDEuNDYsNi4yNSwwLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLDAtLjc0LS4zNS0uNzMtLjc3LC4wNS0yLjExLS4zNy0zLjkzLTEuMjYtNS40Ni0uODktMS41NC0yLjI1LTIuODEtNC4xLTMuODItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1ptLTkuMTUsNC40MmMyLjg2LTEuMjcsNi4yLS4wNyw3LjYsMi43NWwuMSwuMjEsMS4yOSwyLjg5LDEuNywxLjQ3Yy4wOSwuMDgsLjE3LC4xNywuMjcsLjMybC4wNiwuMTFjLjI4LC42MywwLDEuMzctLjY0LDEuNjVsLTEwLjMzLDQuNTdjLS4xNiwuMDctLjMzLC4xMS0uNTEsLjExLS42OSwwLTEuMjUtLjU2LTEuMjUtMS4yNXYtMi4zNHMtMS4yNC0yLjc5LTEuMjQtMi43OWMtMS4zMS0yLjk1LDAtNi4zOSwyLjk1LTcuN1ptOC45MS0uODJjLjk3LC41MywxLjc0LDEuMjksMi4zMiwyLjI5LC41NywuOTksLjg1LDIuMDUsLjgyLDMuMTUtLjAxLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLS4wMS0uNzQtLjM1LS43My0uNzcsLjAyLS44Mi0uMTktMS42LS42Mi0yLjM2LS40NC0uNzYtMS4wMS0xLjMzLTEuNzQtMS43Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWiIvPgo8L3N2Zz4="},554738:(e,t,n)=>{"use strict";n.d(t,{vb:()=>o,c6:()=>r});var i=n(632735);const a=i.createContext(""),o=i.memo((e=>{const{children:t,joinId:n}=e;return i.createElement(a.Provider,{value:n},t)})),r=()=>i.useContext(a);o.displayName="JoinContext"},580980:(e,t,n)=>{"use strict";n.d(t,{l:()=>u,S:()=>r});var i=n(316951),a=n(301210),o=n(889705);function r(e,t){(0,i.addHook)("uponSanitizeElement",l),(0,i.addHook)("uponSanitizeElement",s),t&&(0,i.addHook)("uponSanitizeElement",d);const n=(0,i.sanitize)(e,{ALLOWED_TAGS:[]});return(0,i.removeHooks)("uponSanitizeElement"),n}function s(e){"BR"===e.tagName&&e.replaceWith(" ")}function l(e){"BLOCKQUOTE"===e.tagName&&e.remove()}function d(e){var t;if("IMG"!==e.tagName)return;const n=null!==(t=e.getAttribute("src"))&&void 0!==t?t:"";if((e=>!!e&&e.split("giphy.com").length>1)(n))return void e.replaceWith(" GIF");const i=e.getAttribute("alt");if(!i)return;(function(e){return e===o.T.emoji}(e.getAttribute("itemtype"))||function(e,t){return e===c&&(null==t?void 0:t.startsWith(a.rW))}(e.className,n))&&e.replaceWith(i)}const c="emojione";function u(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}},498634:(e,t,n)=>{"use strict";n.d(t,{JT:()=>m});var i=n(229290),a=n(293681),o=n(915465),r=n(232922),s=n(299034),l=n(545004),d=n(107861),c=n(156508),u=n(438451);const m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chat"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"shortTitle"}},{kind:"Field",name:{kind:"Name",value:"groupTemplate"}},{kind:"Field",name:{kind:"Name",value:"themeId"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOneBotChat"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"newlyCreatedUserId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatPolicy"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"isAdmin"}},{kind:"Field",name:{kind:"Name",value:"isUserAnonymous"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}},{kind:"Field",name:{kind:"Name",value:"lastMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"lastMessageFields"}}]}},{kind:"Field",name:{kind:"Name",value:"lastMessageSender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonUserI18NFieldsFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberDisplayNamesLimited"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"hasEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnresolvedFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsUnverifiedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsVerifiedUser"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUserLimitedNames"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUsersLength"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatPolicyDefinedScenario"}},{kind:"Field",name:{kind:"Name",value:"isChatDisabledForRecipients"}},{kind:"Field",name:{kind:"Name",value:"guardianChatInfo"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"userAdminSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"adminDeleteEnabled"}},{kind:"Field",name:{kind:"Name",value:"deleteMessagesEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingInformationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"extendedDirectoryRedemptionRequired"}},{kind:"Field",name:{kind:"Name",value:"chatScheduleSuggestionSuppressUntil"}},{kind:"Field",name:{kind:"Name",value:"chatHistoryHiddenTime"}},{kind:"Field",name:{kind:"Name",value:"clearHistoryTime"}},{kind:"Field",name:{kind:"Name",value:"typingUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"typingUserFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProperties"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedConversationItems"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"pinnedMessageItemFields"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"addedBy"}},{kind:"Field",name:{kind:"Name",value:"addedByTenantId"}},{kind:"Field",name:{kind:"Name",value:"identityMaskEnabled"}}]}}]}},...i.T.definitions,...a.B.definitions,...o.f.definitions,...r.T.definitions,...s.v.definitions,...l.qL.definitions,...d.l.definitions,...c.I.definitions,...u.E.definitions]}},6813:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"newChatIntentId"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newChatIntentId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}]}]}}]}},572596:(e,t,n)=>{"use strict";n.d(t,{$Z:()=>c,xf:()=>u,$g:()=>f,zf:()=>d});var i=n(892891),a=n(11574),o=n(672729),r=n(539841);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageIdList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"replyChainId"},value:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}}},{kind:"Argument",name:{kind:"Name",value:"cursor"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageIdFields"}}]}},{kind:"Field",name:{kind:"Name",value:"cursor"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"messageIdFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}}]}}]};var l=n(833246);function d(e,t,n,o,r,s=!1,l){try{if((0,i.isEmpty)(o))return void(null==l||l.log(`convId: ${t}, replyChainId: ${n}:: newMessageBatch is empty!`));const a=u(e,t,n);if(!a)return void(null==l||l.warn(`convId: ${t}, replyChainId: ${n}:: cachedMessages is undefined!`));null==l||l.log(`convId: ${t}, replyChainId: ${n}:: newMessageBatch: [${o.map((e=>e.id))}]`);const d=g(e,o,a,r,s,l);d?m(e,t,n,d,l):null==l||l.log(`convId: ${t}, replyChainId: ${n}:: skipped writeCacheQuery. message list not updated!`)}catch(e){null==l||l.error((0,a.A)(e.message))}}const c=(e,t,n,o,r,l)=>{var d;const c=s,u={convId:t,replyChainId:n};try{const a=null===(d=e.readQuery({query:c,variables:u}))||void 0===d?void 0:d.messages;if(!a)return;const{messages:s,cursor:m,__typename:g}=a,p=(0,i.findLast)(s,(e=>e.id===o&&e.from===r));if(s&&p){const a=(0,i.without)(s,p);e.writeQuery({query:c,variables:u,data:{messages:{messages:a,cursor:m,__typename:g}}}),null==l||l.log(`convId: ${t}, replyChainId: ${n}:: deleted from cache. message: ${o}`)}}catch(e){null==l||l.error((0,a.A)(e.message))}},u=(e,t,n)=>{var i,a;const o=e.readQuery({query:s,variables:{convId:t,replyChainId:n}});return null!==(a=null===(i=null==o?void 0:o.messages)||void 0===i?void 0:i.messages)&&void 0!==a?a:null},m=(e,t,n,i,a)=>{const o=i.length>0?i[i.length-1].id:null,r={convId:t,replyChainId:n};e.writeQuery({query:s,variables:r,data:{messages:{messages:i,cursor:o,__typename:"MessagesResult"}}}),null==a||a.log(`cache.writeQuery message: [${i.map((e=>e.id))}]`)},g=(e,t,n,i,a,o)=>{let r;const s=[];return t.forEach((t=>{let o=!1,l=!1;t.from===i&&n.find((e=>e.id===t.clientMessageId))?(l=!0,o=!0):n.find((e=>e.id===t.id))||(o=!0),a&&h(e,t),o?(r||(r=[...n]),l&&v(r,t),p(r,t)):s.push(t.id)})),s.length>0&&(null==o||o.log(`Skipped message ids [${s.map((e=>e))}]`)),r},p=(e,t)=>{(0,r.M)(e,t,(e=>-new Date(e.originalArrivalTime)))},v=(e,t)=>{const n=e.findIndex((e=>e.clientMessageId===t.clientMessageId));n>=0&&e.splice(n,1)},h=(e,t)=>{e.writeFragment({id:`${(0,o.uG)(t)}`,fragment:l.Ue,data:Object.assign({},t)})},f=(e,t,n,i)=>{if(!n||!i)return null;try{return e.readFragment({id:`Message:${i}`,fragment:l.Ue})}catch(e){return t.error(`failed to read message from cache for ${n} and ${i}`),null}}},486328:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"controllerConnectedServicesEnabled"}},{kind:"Field",name:{kind:"Name",value:"readReceiptsEnabled"}}]}}]}}]}},356898:(e,t,n)=>{"use strict";n.d(t,{i1:()=>i,t3:()=>s,tT:()=>l,BN:()=>d,vc:()=>c});var i,a=n(767008),o=n(118824),r=n(975652);function s(e){const{allowUserChat:t,messagingPolicy:n}=e;return"boolean"==typeof t||!!n?t?i.Enabled:i.Disabled:i.Unknown}function l(){const e=(0,a.NC)(o.J.Messaging);return e.enableComposeDisabledBasedOnPolicy?s(e):i.Enabled}function d(e){const t=l();return e===r.k2.Meeting||e===r.k2.Channel?i.Enabled:t}function c(e,t){const n=d(e),{enablePinMessageToChat:r}=(0,a.NC)(o.J.Messaging);return t&&!!r&&n!==i.Disabled}!function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.Unknown="Unknown"}(i||(i={}))},200218:(e,t,n)=>{"use strict";n.d(t,{q:()=>a});const i="communities-selected-id",a=()=>localStorage.getItem(i)},880200:(e,t,n)=>{"use strict";n.d(t,{yx:()=>r,Cs:()=>s});var i=n(632735);const a={isCallModeStreaming:()=>!1,isFullScreenButtonDisabled:()=>!1,isInEmbedContext:()=>!1,isTestUser:()=>!1,getCallId:()=>{},getCorrelationId:()=>"",getForceAttendeeStreaming:()=>{},getEnablePlayerControlsForStreamingMode:()=>{},getParticipantId:()=>{},getStreamDetails:()=>{},getStreamingMode:()=>!1,getTelemetryData:()=>{},getThreadId:()=>"",getUiLanguagePreference:()=>{},setFullScreenButton:()=>{},setStreamDetails:()=>{},sendConveneError:()=>{},sendDataLoadError:()=>{},sendHeartbeat:()=>{},sendMetadata:()=>{},sendData:()=>{},sendServerError:()=>{},createBroadcastEndEventListener:()=>{},createCallDataUpdateEventListener:()=>{},createStreamUpdateEventListener:()=>{},createCaptionsToggleEventListener:()=>{},destroyCaptionsToggleEventListener:()=>{},createSubtitleTrackChangeEventListener:()=>{},destroySubtitleTrackChangeEventListener:()=>{},destroyBroadcastEndEventListener:()=>{},destroyCallDataUpdateEventListener:()=>{},destroyStreamUpdateEventListener:()=>{},sendReadyToRecieveBroadcastEndNotification:()=>{},sendReadyToRecieveCallDataUpdateNotification:()=>{},sendReadyToRecieveStreamUpdatesNotification:()=>{},validateEmbedStreamDetailsArray:()=>({isSuccessful:!0})},o=i.createContext(null),r=i.memo((e=>{const{conveneHostMessaging:t,children:n}=e,r={conveneHostMessaging:t||Object.assign({},a)};return i.createElement(o.Provider,{value:r},n)}));r.displayName="ConveneHostMessagingContextProvider";const s=()=>i.useContext(o)},592827:(e,t,n)=>{"use strict";var i;n.d(t,{WD:()=>h,HH:()=>f,FH:()=>y,Jb:()=>k,gr:()=>S,Du:()=>b});var a=n(231191),o=n(632735),r=n(895725),s=n(929331),l=n(803197),d=n(732170),c=n(723559);const{useCallback:u,useEffect:m,useMemo:g,useRef:p,useState:v}=i||(i=n.t(o,2)),h=e=>{const{layoutPhaseStateMachineRef:t}=(0,d.hc)(),n=t.current,i=p(n),[a,o]=v(n.currentPhase>=e),c=g((()=>i.current.currentPhaseObservable.pipe((0,r.U)((t=>t>=e)),(0,s.x)())),[e,i]),u=(0,l.m)(c,{next:a?()=>a:o},!0);return m((()=>()=>u()),[u]),a&&u(),i.current===n||a?a||i.current.currentPhase>=e||n.currentPhase>=e:(o(!0),!0)},f=e=>{const{layoutPhaseStateMachineRef:t}=(0,d.hc)();return u((()=>t.current.currentPhase>=e),[t,e])},y=()=>{const{layoutPhaseStateMachineRef:e}=(0,d.hc)(),t=e.current,{context:{hostCommunicationService:n},windowId:i}=(0,c.i)(),o=p(!1),r=u((()=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){var e;const t=yield n.loadModule("core");null===(e=null==t?void 0:t.reportFirstPaint)||void 0===e||e.call(t,i)}))),[n,i]);o.current||(null==t||t.scheduleForNextPaint({jobId:"app-phase-fire-first-paint",job:r}),o.current=!0)},k=({component:e,fallback:t,minimumAppPhase:n})=>i=>h(n)?o.createElement(e,Object.assign({},i)):t?o.createElement(t,null):null,S=()=>{const{useAppPhasePostCriticalOnEveryPhaseCycle:e}=(0,d.hc)();return e()},b=()=>{const{useAppPhaseCompleteOnEveryPhaseCycle:e}=(0,d.hc)();return e()}},553106:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});class i{constructor(){this.registerAppPhase=({phase:e,signals:t,timeout:n})=>{const i=this._phasesMap.get(e);this._phasesMap.set(e,Object.assign(Object.assign({},i),{signals:t,timeout:n}))},this._phasesMap=new Map}get appPhases(){return{phases:this._phasesMap}}}},899673:(e,t,n)=>{"use strict";n.d(t,{SM:()=>l,mM:()=>d});var i=n(231191),a=n(632735),o=n(305501),r=n(892891);const s=a.createContext(void 0);s.displayName="CoreContext";const l=e=>{const{children:t}=e,n=(0,i.__rest)(e,["children"]);return a.createElement(s.Provider,{value:(0,o.Q)(n,r.isEqual)},t)};l.displayName="CoreContextProvider";s.Consumer;const d=()=>a.useContext(s)},723559:(e,t,n)=>{"use strict";n.d(t,{E:()=>l,i:()=>d});var i=n(231191),a=n(892891),o=n(632735),r=n(305501);const s=o.createContext(void 0);s.displayName="CoreRenderingContext";const l=e=>{const{children:t}=e,n=(0,i.__rest)(e,["children"]),l=Object.assign(Object.assign({},n),{context:{hostCommunicationService:n.hostCommunicationService}});return o.createElement(s.Provider,{value:(0,r.Q)(l,a.isEqual)},t)};l.displayName="CoreRenderingContextProvider";const d=()=>o.useContext(s)},732170:(e,t,n)=>{"use strict";var i;n.d(t,{jH:()=>u,hc:()=>m});var a=n(231191),o=n(632735),r=n(305501);const{createContext:s,memo:l,useContext:d}=i||(i=n.t(o,2)),c=s(void 0);c.displayName="PhasedRenderingContext";const u=l((e=>{var{children:t}=e,n=(0,a.__rest)(e,["children"]);return o.createElement(c.Provider,{value:(0,r.Q)(n)},t)}));u.displayName="PhasedRenderingContextProvider";const m=()=>d(c)},15616:(e,t,n)=>{"use strict";n.d(t,{I:()=>c,x:()=>u});var i=n(330266),a=n(829333),o=n(533354),r=n(896606),s=n(931147),l=n(723559);const d=(0,o.QS)(void 0),c=e=>{const t=(0,i.f8)();return m(t,e)},u=e=>{const{appsRegistryService:t}=(0,l.i)(),n=t.getAppByActor(a.$K),i=null==n?void 0:n.manifest.id;return m(i,e)},m=(e,t)=>{var n,i,a;const o=(0,s.w)("useAppViewStateInternal"),{appsRegistryService:c,windowId:u}=(0,l.i)();e||null===(n=o.errorToTelemetry)||void 0===n||n.call(o,`Expected appId '${e}' to exist in order to look up viewStateKey ${t}'`,"webclient_framework_foundation_core_services");const m=e&&c.getAppViewStateForWindow(u,e)||void 0;e&&!m&&(null===(i=o.errorToTelemetry)||void 0===i||i.call(o,`Expected appViewState to exist for appId '${e}' and windowId '${u}'`,"webclient_framework_foundation_core_services"));const p=m&&g(m,t);e&&!p&&(null===(a=o.errorToTelemetry)||void 0===a||a.call(o,`Expected reactiveVar to exist for appId '${e}' and viewStateKey '${t}'`,"webclient_framework_foundation_core_services"));const v=p||d;return(0,r.l)(v)},g=(e,t)=>{var n,i;const a=e.nonNavigationalReactiveValues,o=null===(n=null==a?void 0:a[t])||void 0===n?void 0:n.ref,r=e.navigationalReactiveValues;return(null===(i=null==r?void 0:r[t])||void 0===i?void 0:i.ref)||o}},931147:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var i=n(632735),a=n(134056);const o=e=>{const{loggerFactory:t}=(0,a.SE)();return i.useMemo((()=>t.newLogger(e)),[t,e])}},134056:(e,t,n)=>{"use strict";var i;n.d(t,{fS:()=>E,B4:()=>M,SE:()=>R,G7:()=>P,TE:()=>O,Ix:()=>x,Od:()=>L,cJ:()=>U,Zs:()=>B});var a=n(632735),o=n(363592),r=n(745510),s=n(803197),l=n(305501),d=n(358272),c=n(659387),u=n(798703),m=n(281857),g=n(899673);const{createContext:p,memo:v,useCallback:h,useEffect:f,useMemo:y,useRef:k,useState:S}=i||(i=n.t(a,2)),b=m.eT.Uninitialized,C=p(void 0);C.displayName="UserContext";const w=p({appState:b}),N=p({clientState:d.pk.Initializing}),T=p({isOnline:!0}),I=({globalEntityCommanding:e,globalEventing:t,regenerateEntityCommandingServices:n,viewEntitiesRef:i,viewEntity:a,viewEntityName:o})=>{const r=k(a),s=(l=r.current,y((()=>{var e,t,n,i,a,o;return(null==l?void 0:l.action)!==(null==d?void 0:d.action)||(null==l?void 0:l.type)!==(null==d?void 0:d.type)||(null==l?void 0:l.id)!==(null==d?void 0:d.id)||(null===(e=null==l?void 0:l.linkedEntity)||void 0===e?void 0:e.action)!==(null===(t=null==d?void 0:d.linkedEntity)||void 0===t?void 0:t.action)||(null===(n=null==l?void 0:l.linkedEntity)||void 0===n?void 0:n.id)!==(null===(i=null==d?void 0:d.linkedEntity)||void 0===i?void 0:i.id)||(null===(a=null==l?void 0:l.linkedEntity)||void 0===a?void 0:a.type)!==(null===(o=null==d?void 0:d.linkedEntity)||void 0===o?void 0:o.type)?d:l}),[d=a,l]));var l,d;f((()=>{r.current=a}),[a]);const c=y((()=>s&&o?n(i,s,o):{entityCommanding:e,eventing:t}),[e,t,n,i,o,s]),{entityCommanding:u}=c;return f((()=>()=>{u.destroy()}),[u]),c},E=v((({children:e,meControlAvatarSrc:t,viewEntitiesRef:n,viewEntity:i,viewEntityName:m})=>{var p;const{defaultContext:v}=(0,g.mM)(),{appStateService:f,clientState:k,networkState:C}=v,{eventing:w,userContextValue:N}=(({meControlAvatarSrc:e,renderingContext:t,viewEntitiesRef:n,viewEntity:i,viewEntityName:a})=>{const{authenticationUser:o,cdlWorkerService:r,coreSettings:s,coreSettingsContext:l,entityCommanding:d,eventing:m,regenerateEntityCommandingServices:g,platformService:p,windowProvider:v}=t,f=h((()=>l.getDebugService()),[l]),k=h((()=>r?r.getDebugService():Promise.resolve(void 0)),[r]),S=h((()=>(0,c._)(s,p)),[s,p]),b=h(((e,t)=>{const n=o?(0,u.b)(o):"";return v.opener.globalWindow.open(e,`appAuthWindow_${n}`,t)}),[o,v]);t.windowProvider.openPlatformAppAuthWindowForCurrentUser=b;const C=y((()=>({appResponsivenessService:t.appResponsivenessService,authenticationUser:t.authenticationUser,avatarImageCache:t.avatarImageCache,coreSecurityService:t.coreSecurityService,coreSettings:t.coreSettings,DEBUG_ONLY__dataClientTrackingService:t.dataClientTrackingService,DEBUG_ONLY__dataEvictionService:t.dataEvictionService,DEBUG_ONLY__getCdlWorkerDebugService:k,DEBUG_ONLY__getCoreSettingsDebugService:f,DEBUG_ONLY__leakDetectorService:t.leakDetectorService,discover:t.discover,entityCommanding:{},errorState:t.errorState,host:t.windowProvider,isStoragePartitionEnabled:S,localStorageService:t.localStorage,loggerFactory:t.loggerFactory,logsCollectorService:t.logsCollectorService,meControlAvatarSrc:e,platformService:t.platformService,profilerService:t.profilerService,routingServices:t.routingServices,scenarioFactory:t.scenarioFactory,user:t.user,userBiService:t.userBiService,windowHistoryNavigationService:t.windowHistoryNavigationService,pulsar:t.pulsar})),[k,f,S,e,t.appResponsivenessService,t.authenticationUser,t.avatarImageCache,t.coreSecurityService,t.coreSettings,t.dataClientTrackingService,t.dataEvictionService,t.discover,t.errorState,t.leakDetectorService,t.localStorage,t.loggerFactory,t.logsCollectorService,t.platformService,t.profilerService,t.routingServices,t.scenarioFactory,t.user,t.userBiService,t.windowHistoryNavigationService,t.windowProvider,t.pulsar]),{entityCommanding:w,eventing:N}=I({globalEntityCommanding:d,globalEventing:m,regenerateEntityCommandingServices:g,viewEntitiesRef:n,viewEntity:i,viewEntityName:a});return C.entityCommanding=w,{eventing:N,userContextValue:C}})({meControlAvatarSrc:t,renderingContext:v,viewEntitiesRef:n,viewEntity:i,viewEntityName:m}),[T,E]=S(k&&k.getState()||d.pk.Initializing),M=y((()=>k.observe()),[k]);(0,s.m)(M,{next:E});const[R,P]=S(null!==(p=f&&f.getState())&&void 0!==p?p:b),O=y((()=>f.observe()),[f]);(0,s.m)(O,{next:P});const[x,L]=S(C&&C.isOnline()||!0),U=y((()=>C.observeIsOnline()),[C]);(0,s.m)(U,{next:L});const B=(0,l.Q)({clientState:T}),j=(0,l.Q)({appState:R}),W=(0,l.Q)({isOnline:x});return a.createElement(A,{userContextValue:N},a.createElement(o.q,{eventing:w,reactEventMapper:r.b},a.createElement(_,{clientStateContextValue:B},a.createElement(D,{appStateContextValue:j},a.createElement(F,{networkStateContextValue:W},e)))))}));E.displayName="UserContextProvider";const A=v((({children:e,userContextValue:t})=>a.createElement(C.Provider,{value:t},e)));A.displayName="UserContextProviderInner";const _=v((({children:e,clientStateContextValue:t})=>a.createElement(N.Provider,{value:t},e)));_.displayName="ClientStateContextProviderInner";const D=v((({children:e,appStateContextValue:t})=>a.createElement(w.Provider,{value:t},e)));D.displayName="AppStateContextProviderInner";const F=v((({children:e,networkStateContextValue:t})=>a.createElement(T.Provider,{value:t},e)));F.displayName="NetworkStateContextProvider";const M=C.Consumer,R=()=>a.useContext(C),P=e=>function(t){const n=R();return a.createElement(e,Object.assign({},Object.assign(Object.assign({},t),{userContext:n})))},O=(N.Consumer,()=>a.useContext(N)),x=(w.Consumer,()=>a.useContext(w)),L=T.Consumer,U=()=>a.useContext(T);function B(e){const t=a.useRef(e),{authenticationUser:n}=R(),i=a.useRef(null==n?void 0:n.id);return i.current!==(null==n?void 0:n.id)&&(i.current=null==n?void 0:n.id,t.current=e),t}},330266:(e,t,n)=>{"use strict";var i;n.d(t,{Ih:()=>c,sV:()=>u,f8:()=>m,Sx:()=>g});var a=n(231191),o=n(892891),r=n(632735),s=n(305501);const{memo:l}=i||(i=n.t(r,2)),d=r.createContext(void 0);d.displayName="ViewContext";const c=l((e=>{var{children:t,commandReportingCallbacks:n,doesChildViewEntityMatch:i=(()=>!1),UNSAFE_doesMainViewEntityMatch:l=(()=>!1)}=e,c=(0,a.__rest)(e,["children","commandReportingCallbacks","doesChildViewEntityMatch","UNSAFE_doesMainViewEntityMatch"]);return r.createElement(d.Provider,{value:(0,s.Q)(Object.assign(Object.assign(Object.assign({},c),n),{doesChildViewEntityMatch:i,UNSAFE_doesMainViewEntityMatch:l}),o.isEqual)},t)}));c.displayName="ViewContextProvider";d.Consumer;const u=()=>r.useContext(d),m=()=>{const{appId:e}=r.useContext(d);return e},g=e=>function(t){const n=u();return r.createElement(e,Object.assign({},Object.assign(Object.assign({},t),{viewContext:n})))}},879098:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});const i=e=>t=>t.reduce(((t,n)=>(t[n]=e[n],t)),{})},747884:(e,t,n)=>{"use strict";n.d(t,{FU:()=>i,ZG:()=>o});var i,a=n(729788);!function(e){e.DEFAULT="default",e.HEADER_AT_BOTTOM="header_at_bottom",e.HYER="hyer"}(i||(i={}));class o{constructor({layoutKey:e=i.DEFAULT,layoutMode:t,layoutTemplatesPerLayoutMode:n}){this.getTemplate=({layoutKey:e=i.DEFAULT,layoutMode:t,slots:n,slotsDimensionsOverrides:a={}})=>{const o=this._layoutTemplates[t][this._getKeyFromSlotNameArray(e,n)];return"function"==typeof o?o(a):o},this._getKeyFromSlotNameArray=(e=i.DEFAULT,t)=>[e,...[...t].sort()].join("-"),this._layoutTemplates={[a.lO.focus]:{},[a.lO.minimal]:{},[a.lO.standard]:{}},n[t].forEach((n=>{(n.layoutKey||i.DEFAULT)===e&&this._registerTemplates(Object.assign({layoutMode:t},n))}))}_registerTemplates({layoutKey:e=i.DEFAULT,layoutMode:t,responsiveTemplates:n,slots:a}){const o=this._getKeyFromSlotNameArray(e,a);if(void 0!==this._layoutTemplates[t][o])throw new Error(`You can't have two templates with same slots for same layoutMode, slots: ${o} layoutMode: ${t}`);this._layoutTemplates[t][o]="function"==typeof n?n:()=>n}}},549981:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var i,a=n(231191),o=n(312788),r=n(632735),s=n(451614),l=n(642115),d=n(281857),c=n(25503),u=n(628235);null===(i=null===performance||void 0===performance?void 0:performance.mark)||void 0===i||i.call(performance,"resolve-main-imports-end");const m=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(47113),n.e(15803),n.e(75916),n.e(50611),n.e(60567),n.e(84460),n.e(10440),n.e(75912),n.e(45746),n.e(19351),n.e(7983),n.e(1839),n.e(4759),n.e(5227),n.e(99834),n.e(62514),n.e(21439),n.e(38393),n.e(68865),n.e(2205),n.e(88978),n.e(23054),n.e(28430),n.e(79e3),n.e(27631),n.e(2054)]).then(n.bind(n,460887));class g{constructor(e){this._activationOptions=e,this._mounted=!1,this._logger=this._activationOptions.coreServices.loggerFactory.newLogger("CoreReactRenderer")}activate(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){this.deactivate();try{return this._activateRoot()}catch(e){const t=(0,l.Tr)("Experience",d.jK.Undefined,"activate",e);return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(t.message,"webclient_framework_foundation_components_core_react_renderer",void 0,!0),this._activationOptions.coreServices.errorState.error=t,Promise.reject(t)}}))}deactivate(){this._mounted&&(o.unmountComponentAtNode(this._activationOptions.rootElement),this._mounted=!1)}_activateRoot(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{window:t,rootElement:n,coreServices:{altScenarioService:i,scenarioFactory:a}}=this._activationOptions,{RootRenderer:l}=yield(0,c.mT)(m,"core-essentials",a);return null===(e=null==i?void 0:i.altScenario)||void 0===e||e.mark(u.ck.CoreEssentialsChunkLoad),new Promise((e=>{o.render(r.createElement(l,Object.assign({},this._activationOptions)),n,(()=>{this._mounted=!0,t&&(0,s.rx)(t.document,n),e()}))}))}))}}},32693:(e,t,n)=>{"use strict";n.d(t,{L:()=>l});var i=n(874645),a=n(406364),o=n(931473),r=n(346701),s=n(871177);const l={splashStyles:a,favicons:o,splash:i,preloadTitleBar:r,devtools:s}},451614:(e,t,n)=>{"use strict";n.d(t,{rx:()=>i});const i=(e,t)=>{((e,t)=>{const n=e.getElementById("splash-screen");n&&(n.setAttribute("aria-hidden","true"),e.body.removeChild(n),t&&(t.style.display="block"))})(e,t),(e=>{const t=e.getElementsByClassName("preload-title-bar-trim")[0];t&&e.body.removeChild(t)})(e)}},130806:(e,t,n)=>{"use strict";n.d(t,{o:()=>f});var i=n(231191),a=n(118824),o=n(25503),r=n(389957),s=n(549981),l=n(632735),d=n(312788),c=n(538606),u=n(367832);const m=()=>l.createElement(u.e,{client:{}},l.createElement("div",null));class g extends l.PureComponent{constructor(){super(...arguments),this.divRef=l.createRef(),this.siblingEl=l.createRef()}componentDidMount(){const{document:e}=this.props.mainWindow,t=e.createElement("div");this.divRef.current&&(this.divRef.current.appendChild(t),t.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0,relatedTarget:this.siblingEl.current})))}render(){return l.createElement("div",{ref:this.divRef},l.createElement("div",{ref:this.siblingEl,onMouseEnter:()=>{}}))}}class p extends l.PureComponent{constructor(){super(...arguments),this.state={mounted:!1}}componentDidMount(){this.setState({mounted:!0})}render(){return l.createElement("div",null)}}const v=e=>{(e=>{e.document.body.dispatchEvent(new MouseEvent("click",{bubbles:!0}))})(e)};var h=n(628235);const f=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const o=yield y(t);return e.pipe((0,r.j)((({id:e,window:i,context$:a})=>((e,t,n,i,a,o)=>{if(!e)return null;const r=e.document.getElementById("app");if(!r){const e=a.loggerFactory.newLogger("entry");return e.errorToTelemetry&&e.errorToTelemetry("element with ID 'app' not found on the document.","webclient_framework_foundation_components_render_windows",void 0,!0),null}a.scenarioFactory.startStep(h.RG.ExperienceReady,h.ck.RenderProviders);const l=new s.Z({context$:t,coreServices:a,getExperienceProps:n,reactDiagnosticsService:o,rootElement:r,windowId:i,window:e});return l.activate(),{coreRenderer:l,host:e,windowId:i}})(i,a,n,e,t,o)),(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!e)return;const{host:n,coreRenderer:o,windowId:r}=e;v(n),o.deactivate();const s=t.windowProvider;yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.document,n=t.body,i=t.createElement("div");i.setAttribute("id","memory-cleanup");const a=n.appendChild(i);yield(0,c._)(0),d.render(l.createElement(l.Fragment,null,l.createElement(m,null),l.createElement(g,{mainWindow:e}),l.createElement(p,null)),a),d.unmountComponentAtNode(a),n.removeChild(a)})))(s);const{dataCleanupService:u,dataEvictionService:h,coreSettings:f}=t;u.markDataForWindowAsInactive(r);const{enableSingleApolloCoreCache:y}=f.get(a.J.Core);y&&(null==h||h.evict())}))),(({id:e})=>e))).subscribe()})),y=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{enableReactDiagnostics:t,enableReactDiagnosticsConsoleLog:i,enableReactDiagnosticsDisplayNameFix:r}=e.coreSettings.get(a.J.Diagnostics);if(t)try{const{initReactDiagnostics:t,ReactDiagnosticsService:a}=yield(0,o.mT)((()=>Promise.all([n.e(21439),n.e(66475),n.e(79e3),n.e(82271)]).then(n.bind(n,721979))),"react-diagnostics",e.scenarioFactory),s=new a(!!i,!!r);return t(s),s}catch(t){const n=e.loggerFactory.newLogger("react-diagnostics");n.errorToTelemetry&&n.errorToTelemetry(`Failed to load react-diagnostic ${t}`,"webclient_framework_foundation_components_render_windows",void 0,!0)}}))},903589:(e,t,n)=>{"use strict";n.d(t,{A8:()=>g,IH:()=>p,I6:()=>c,rt:()=>m,t:()=>u});var i=n(231191),a=n(679578),o=n(118824),r=n(636524),s=n(324819);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsCortexTopicsSdkAuthenticationAcquireTokenQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},d=new Map;function c(e){return(0,a.I6)(e)}function u(e,t,n,a,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{lokiTokenResourceUrl:i,enableSilentLokiAuthTokenRetrieval:l}=a.get(o.J.People),d=c(n);return d?(yield p(t,n,i||r.s$,l||void 0,d),e(d)):s?s():void 0}))}function m(e,t,n,i,a){const{lokiTokenResourceUrl:s,enableSilentLokiAuthTokenRetrieval:l}=i.get(o.J.People),d=c(n);return d?(p(t,n,s||r.s$,l||void 0,d),e(d)):a?a():void 0}function g(e){const t=(0,s.v4)();return(n,a)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(d.has(v(e))){const i=d.get(v(e));i&&n(i,t)}else a("No token in Reference",t)}))}function p(e,t,n,a,o){var r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;o||(o=c(t)),o&&(i=o.createQosEvent("Cortex.TopicAnnotations.RenewToken.Execute"));try{let o;if(e){const{data:s}=yield e.query({query:l,variables:{resource:n,acquireTokenOptions:{silent:a}},fetchPolicy:"network-only"});o=null===(r=null==s?void 0:s.authenticationToken)||void 0===r?void 0:r.token,o?(d.set(v(t),o),null==i||i.logSuccess()):null==i||i.logUnexpectedFailure("NoTokenReceived")}else null==i||i.logUnexpectedFailure("NoApolloClient")}catch(e){null==i||i.logUnexpectedFailure("ErrorThrowRetrievingToken",e)}}))}function v(e){var t,n;return`${null!==(t=e.userAadObjectId)&&void 0!==t?t:""}_${null!==(n=e.tenantAadObjectId)&&void 0!==n?n:""}`}},493401:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});const i=()=>null;i.displayName="EmptyRenderComponent"},38421:(e,t,n)=>{"use strict";n.d(t,{C5:()=>a,LQ:()=>o,f4:()=>r,EK:()=>s,P7:()=>l});var i=n(395816),a=i.C55,o=i.LQM,r=i.f4k,s=(i.uNA,i.Qbq,i.EK3),l=i.P7M},224782:(e,t,n)=>{"use strict";n.d(t,{h:()=>l,v:()=>d});var i=n(632735),a=n(134056),o=n(266641),r=n(147540),s=n(38421);const l=({surface:e,emit:t,surfaceId:n,isControlGroup:s,disableWrapper:l,irisCampaignId:c,children:u,disableNativeListeners:m})=>{const{loggerFactory:{newLogger:g}}=(0,a.SE)();return void 0===t&&(t=!0),t?i.createElement(r.q,{panelRegion:d(e),panelType:s?o.wh.EligibleEngagementSurface:o.wh.DisplayedEngagementSurface,panelLaunchMethod:"direct",newLogger:g,dataBagProps:{identifier:n,irisCampaignId:c},disableWrapper:l,disableNativeListeners:m},u):i.createElement(i.Fragment,null,u)},d=e=>{switch(e){case s.C5.Modal:return o.Ai.dialog;case s.C5.Coachmark:return o.Ai.popover;case s.C5.QuickGuide:return o.Ai.quickGuide;case s.C5.Notification:return o.Ai.toast}};l.displayName="EspPanelViewTelemetry"},16945:(e,t,n)=>{"use strict";n.d(t,{l:()=>i,J:()=>a});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"espDisplayedSurface"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EspDisplayedSurface"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"controlGroupTimestamps"}},{kind:"Field",name:{kind:"Name",value:"displayedTimestamps"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"espState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EspState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayed"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"espDisplayedSurface"}}]}},{kind:"Field",name:{kind:"Name",value:"userState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"completedActions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"priorityThrottlesInMinutes"}}]}},...i.definitions]}},368596:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var i=n(632735),a=n(818097),o=n(616267);class r extends i.Component{constructor(e){super(e),this.mounted=!1;const{i18n:t,namespace:n,namespaces:i}=e,a=(i||[]).filter((e=>!t.isNamespaceLoaded(e)));!n||t.isNamespaceLoaded(n)||a.includes(n)||a.push(n),this.state={namespacesToLoad:a}}componentDidMount(){const{i18n:e}=this.props;this.mounted=!0;const t=()=>{this.mounted&&this.setState((t=>({namespacesToLoad:t.namespacesToLoad.filter((t=>!e.isNamespaceLoaded(t)))})))};this.state.namespacesToLoad.length&&Promise.all(this.state.namespacesToLoad.map((t=>e.waitForNamespace(t)))).then(t).catch(t)}componentWillUnmount(){this.mounted=!1}render(){const{loaderRenderer:e,children:t}=this.props;return this.state.namespacesToLoad.length?e?e():null:t&&i.createElement(a.dE,null,t)||null}}const s=(0,o.G)(r);s.displayName="GenericNamespaceProvider"},818097:(e,t,n)=>{"use strict";n.d(t,{YS:()=>l,dE:()=>c,dL:()=>d});var i=n(632735),a=n(305501),o=n(825998);const r=(e,t,n)=>{const i=e.get(t),a=null==i?void 0:i.value,r=null==i?void 0:i.params;if(a&&(0,o.V)(n,r))return a};var s=n(441454);const l=i.createContext({}),d=()=>i.useContext(l),c=e=>{const t=(e=>{let t;const n=Object.create(e),i=Object.getPrototypeOf(e);for(const e of Object.getOwnPropertyNames(i))"stringTranslate"!==e&&Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e));return Object.defineProperty(n,"stringTranslate",{enumerable:!1,configurable:!0,value:(n,i,a)=>{t||(t=new Map);const o=r(t,i,a);if(o)return o;const s={value:e.stringTranslate(n,i,a),params:a};return t.set(i,s),s.value}}),n})((0,s.Cq)());return i.createElement(l.Provider,{value:(0,a.Q)(t)},e.children)}},441454:(e,t,n)=>{"use strict";n.d(t,{tL:()=>m,xR:()=>u,OO:()=>l,bd:()=>c,Cq:()=>d});var i=n(632735),a=n(808176),o=n(356629);class r{get locale(){return this._i18n.locale}get originLocale(){return this._i18n.originLocale}get userLanguage(){return this._i18n.userLanguage}get isRtl(){return this._i18n.isRtl}constructor(e){this.i18nextWrapper=e,this._i18n=new o.o(e)}setLocale(e){return this._i18n.setLocale(e)}get osDateTimeLocale(){return this._i18n.osDateTimeLocale}get osFirstDayOfWeek(){return this._i18n.osFirstDayOfWeek}get osLocaleInfo(){return this._i18n.osLocaleInfo}get firstDayOfWeek(){return this._i18n.firstDayOfWeek}translate(e,t,n){return this.stringTranslate(e,t,n)}stringTranslate(e,t,n){return this._i18n.stringTranslate(e,t,n)}getTransForNs(e){this.i18nextWrapper.latestTranslation.namespace=e;const t=this.i18nextWrapper.i18next.getFixedT(this.locale,e);return n=>i.createElement(a.cC,Object.assign({},n,{tOptions:(0,o.E)(n.i18nKey||"",n.tOptions),t,ns:e}))}waitForNamespace(e){return this._i18n.waitForNamespace(e)}getNamespaceState(e){return this._i18n.getNamespaceState(e)}isNamespaceLoaded(e){return this._i18n.isNamespaceLoaded(e)}formatDateTime(e,t,n){return this._i18n.formatDateTime(e,t,n)}formatNumber(e,t){return this._i18n.formatNumber(e,t)}formatNumberWithRegionalFormat(e,t){return this._i18n.formatNumberWithRegionalFormat(e,t)}getStringComparer(e){return this._i18n.getStringComparer(e)}sortStrings(e,t){return this._i18n.sortStrings(e,t)}getLocaleTimeSettings(){return this._i18n.getLocaleTimeSettings()}}var s=n(564396);const l=i.createContext({}),d=()=>i.useContext(l),c=({locale:e,i18NextWrapper:t,host:n,children:o})=>{const[d,c]=i.useState(null);return i.useEffect((()=>{let i=!0;return e?t.setLocale(e).then((()=>{var a;if(!i)return;c(new r(t));const o=null===(a=null==n?void 0:n.document)||void 0===a?void 0:a.documentElement;o&&(s.p0.setLangAttribute(o,e),s.p0.setDirAttribute(o,void 0,e))})):c(new r(t)),()=>{i=!1}}),[n,t,e]),d?i.createElement(l.Provider,{value:d},i.createElement(a.a3,{i18n:t.i18next},o)):null},u=l.Consumer,m=({host:e,locale:t})=>{var n;const i=null===(n=e.document)||void 0===n?void 0:n.documentElement;return i&&(s.p0.setLangAttribute(i,t),s.p0.setDirAttribute(i,void 0,t)),null}},616267:(e,t,n)=>{"use strict";n.d(t,{G:()=>r,v:()=>s});var i=n(632735),a=n(441454),o=n(818097);const r=e=>t=>i.createElement(a.OO.Consumer,null,(n=>i.createElement(e,Object.assign({},Object.assign(Object.assign({},t),{i18n:n}))))),s=e=>t=>i.createElement(o.YS.Consumer,null,(n=>i.createElement(e,Object.assign({},Object.assign(Object.assign({},t),{i18n:n})))))},740223:(e,t,n)=>{"use strict";n.d(t,{Bg:()=>o,dA:()=>r,we:()=>a,GM:()=>s});var i=n(329371);function a(e,t,n,i,a){if(!t)return void a.warn("Host conversation Id is not defined for a shared channel");return{mriArray:[e],conversationId:t,isShortProfileRequested:!1,callerInfo:i,peoplePickerFilters:void 0,isSharedChannel:!0,hostTenantId:n}}const o=({userId:e,isSharedChannel:t,hostTenantId:n,hostConversationId:i})=>JSON.stringify({userId:e,isSharedChannel:t,hostTenantId:n,hostConversationId:i});function r(e){const t={userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0};if(!e)return t;try{const{userId:t,isSharedChannel:n,hostTenantId:i,hostConversationId:a}=JSON.parse(e);return{userId:t,isSharedChannel:!0===n,hostTenantId:i,hostConversationId:a}}catch(e){return t}}function s(e){if(e)switch(e.config.platformId){case i.us.Web:case i.us.SttOutlookWeb:return"Web";default:return"Desktop"}}},252794:(e,t,n)=>{"use strict";var i,a;n.d(t,{H_:()=>i,MW:()=>a}),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(i||(i={})),function(e){e.MouseHover="MouseHover",e.MouseClick="MouseClick",e.KeyboardPress="KeyboardPress",e.AppRequest="AppRequest"}(a||(a={}))},636524:(e,t,n)=>{"use strict";n.d(t,{s$:()=>l,EG:()=>s,Vf:()=>d});var i=n(231191),a=n(324819);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]};var r=n(723373);const s=(e,t)=>{if("df"===t)return"Df";if("msit"===t)return"Msit";switch(e){case r.s.prod:case r.s.life:return"Prod";case r.s.gcc:return"GccModerate";case r.s.gcchigh:return"GccHigh";case r.s.dod:return"DoD";case r.s.ag08:return"AG08";case r.s.ag09:return"AG09";case r.s.gallatin:return"Gallatin";default:return"Unknown"}},l="https://unknownregion.loki.delve.office.com",d=(e,t,n)=>{const r=(0,a.v4)();return(a,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,l;try{let d;e.current?d=null===(l=null===(i=(yield e.current.query({query:o,variables:{resource:t,acquireTokenOptions:{silent:n}},fetchPolicy:"network-only"})).data)||void 0===i?void 0:i.authenticationToken)||void 0===l?void 0:l.token:s("Error no apollo client to retrieve token",r),d?a(d,r):s("Error retrieving auth token",r)}catch(e){s("Error retrieving auth token",r)}}))}},126297:(e,t,n)=>{"use strict";n.d(t,{p3:()=>u,Lk:()=>m});var i=n(632735),a=n(74031),o=n(952121);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}}]}}]}}]};var s=n(305501),l=n(892891);const d=i.createContext({IsLivePersonaCardInitialized:!1}),c=e=>{const t={IsLivePersonaCardInitialized:e.IsLivePersonaCardInitialized};return i.createElement(d.Provider,{value:(0,s.Q)(t,l.isEqual)},e.children)},u=(0,o.C)((e=>i.createElement(a.A,{query:r},(({data:t,loading:n,error:a})=>{const o=!n&&!a&&!!t&&!!t.lpcState&&t.lpcState.isLivePersonaCardInitialized;return i.createElement(c,{children:e.children,IsLivePersonaCardInitialized:o})})))),m=()=>i.useContext(d)},392471:(e,t,n)=>{"use strict";n.d(t,{j:()=>p,g:()=>y});var i=n(892891),a=n(632735),o=n(550070),r=n(843149),s=n(929331),l=n(825998),d=n(895725),c=n(860467);var u=n(803197),m=n(305501),g=n(931147);const p=(e,t=o.E)=>{const n=a.createContext(t);return n.displayName=e,[v(n),h(n),f(n)]},v=({Provider:e})=>({source$:t,children:n})=>a.createElement(e,{value:t,children:n}),h=e=>(t,n=!1,s,l=!0)=>{(0,i.isBoolean)(t)&&(l=n,n=t,t=void 0);const d=(0,g.w)("setupUseObservableContext"),c=a.useContext(e);a.useEffect((()=>{c===o.E&&d.log("No provider set yet for context",e.displayName)}),[c,d]);const m=a.useMemo((()=>t?c.pipe(t):c),[c,t]),p=a.useRef(),v=a.useRef(!1),[h,f]=a.useState((()=>{if(c instanceof r.X)try{const e=c.getValue(),t=void 0!==e&&s?s(e):e;return p.current=e,v.current=!0,t}catch(e){return}})),y=a.useCallback((e=>{v.current&&(v.current=!1,c instanceof r.X&&p.current===c.getValue())?p.current=void 0:f(e)}),[f,c]),k=n?i.noop:y;return[n?void 0:h,(0,u.m)(m,{next:k},l)]},f=e=>()=>a.useContext(e),y=e=>(t,n)=>{const o=(0,m.Q)(t),r=a.useCallback((e=>e.pipe((e=>t=>t.pipe((0,d.U)((t=>e?(0,i.pick)(t,e):t)),(0,c.h)((e=>!(0,i.isEmpty)(e)))))(o),(0,s.x)(l.V))),[o]),[u]=e(r);return u||n}},693856:(e,t,n)=>{"use strict";n.d(t,{ul:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformTabUtilsChannelByIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"defaultOneNoteSectionId"}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"hostTeamGroupId"}},{kind:"Field",name:{kind:"Name",value:"hostTeamId"}},{kind:"Field",name:{kind:"Name",value:"hostTenantId"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}}]}}]}}]}},851726:(e,t,n)=>{"use strict";n.d(t,{CL:()=>f,dJ:()=>P,zy:()=>W,Kf:()=>de,jZ:()=>ie,$s:()=>N,hR:()=>T,rh:()=>se,kq:()=>M,ig:()=>we,uJ:()=>oe,SR:()=>ae,Td:()=>ye,uo:()=>F,CX:()=>fe,BT:()=>le,E9:()=>R,kT:()=>A,eF:()=>Ne,u$:()=>D,xO:()=>V,s0:()=>Z,Rd:()=>X,k6:()=>ee,Iv:()=>be,OL:()=>K,pQ:()=>re,gc:()=>ne,TQ:()=>te,g7:()=>w,$c:()=>I,RD:()=>E,dE:()=>L,Cn:()=>j,eA:()=>Y,J2:()=>ue,iP:()=>Q,Fd:()=>pe,KG:()=>$,rt:()=>Ce,kB:()=>he,ti:()=>ge,r6:()=>ve,vr:()=>ce,LY:()=>H,ui:()=>Se});var i=n(231191),a=n(694785),o=n(395816),r=n(959629),s=n(94836),l=n(797229),d=n(881933),c=n(69226),u=n(591231),m=n(355272),g=n(760083),p=n(717330),v=n(693856);const h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"teamId"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"parentPostTeamAndChannel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}}]}}]}}]};var f,y=n(628235),k=n(266641),S=n(975652),b=n(786152),C=n(84574);!function(e){e.Member="member",e.Guest="guest",e.External="external",e.Anonymous="anonymous",e.Unknown="unknown"}(f||(f={}));const w=(e,t,n,r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{data:i,error:l}=yield e.query({query:a.br,variables:(null==n?void 0:n.isChannelMeeting)&&(null==n?void 0:n.messageId)?{id:t,queryType:o.rtK.QueryByMessage,storageOptions:{messageStorage:{messageId:n.messageId},platformTabsQueryType:o.rtK.QueryByMessage},options:r}:{id:t,queryType:o.rtK.QueryByThread,options:r},fetchPolicy:"no-cache"});return l&&(null==s||s.error(`(getTabsData) Error fetching tabs: ${l.message}`)),i})),N=(e,t,n,a,r,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=Y(a),d=i?yield I(e,t):void 0,{data:c,error:u}=yield e.query({query:s.VY,variables:{scope:i?o.qi6.Team:o.qi6.GroupChat,conversationId:i?d:t,appId:n}});return u&&(null==l||l.fail({errors:`Error getting app data for app ${n}: ${u.message}`,"App.Id":n,reason:"AppDefinitionError"}),null==r||r.error(`(getAppData) Error getting app data for app ${n}: ${u.message}`)),c&&c.appDefinition||(null==l||l.fail({errors:`App definition not found for app ${n}`,"App.Id":n,reason:"AppDefinitionMissing"}),null==r||r.error(`(getAppData) App definition not found for app ${n}`)),c})),T=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{data:i}=yield e.query({query:s.VY,variables:{scope:a,conversationId:t,appId:n}});return i})),I=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n,i;const{conversationId:a}=F(t);return(null===(i=null===(n=(yield e.query({query:h,variables:{convId:a}})).data)||void 0===n?void 0:n.parentPostTeamAndChannel)||void 0===i?void 0:i.teamId)||void 0})),E=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n,i;const{conversationId:a}=F(t);return(null===(i=null===(n=(yield e.query({query:v.ul,variables:{conversationId:a}})).data)||void 0===n?void 0:n.channelByID.owningTeam)||void 0===i?void 0:i.id)||void 0})),A=(e,t,n)=>{var i,a;if(_(t)){if(!n)return{botMri:e,appId:t.id};if(null===(a=null===(i=t.definition)||void 0===i?void 0:i.staticTabs)||void 0===a?void 0:a.some((e=>e.entityId===n)))return{botMri:e,appId:t.id,tabEntityId:n}}},_=e=>{var t,n,i,a,o,r;return!!((null===(n=null===(t=e.definition)||void 0===t?void 0:t.galleryTabs)||void 0===n?void 0:n.some((e=>{var t;return null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.some((e=>e===l.jD.MeetingSidePanel))})))||(null===(a=null===(i=e.definition)||void 0===i?void 0:i.galleryTabs)||void 0===a?void 0:a.some((e=>{var t;return null===(t=null==e?void 0:e.meetingSurfaces)||void 0===t?void 0:t.some((e=>e===l.Aj.SidePanel))})))||(null===(r=null===(o=e.definition)||void 0===o?void 0:o.staticTabs)||void 0===r?void 0:r.some((e=>{var t;return null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.some((e=>e===l.BU.MeetingSidePanel))}))))},D=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{data:i,error:o}=yield e.query({query:r.yo,variables:{tabId:t,threadId:n}});return o&&(null==a||a.error(`(getPlatformTab) Error fetching tab: ${o.message}`)),i})),F=e=>{var t;const n=null!==(t=null==e?void 0:e.split(";replyChainId="))&&void 0!==t?t:[];let i=n[0];const a=n[1];if(null==i?void 0:i.includes("channelId")){i=JSON.parse(i).channelId}return{conversationId:i,replyChainId:a}},M=e=>{const{replyChainId:t}=F(e);return Y(t)?o.qi6.Team:o.qi6.GroupChat},R=(e,t)=>{var n,i;if(P(e))return f.Anonymous;if(O(e))return f.Guest;if(e&&t){if(Q(null===(n=e.profile)||void 0===n?void 0:n.tenantId,t))return f.External;if(J(null===(i=e.profile)||void 0===i?void 0:i.tenantId,t))return f.Member}return f.Unknown},P=e=>(null==e?void 0:e.role)===c.w4.Anonymous,O=e=>(null==e?void 0:e.role)===c.w4.Guest,x=(e,t,n,i,a)=>{var o;const r=null===(o=null==e?void 0:e.baseInfo)||void 0===o?void 0:o.id,s=null==t?void 0:t.appDefinition;if(null==a||a.log(`(isValidTabForInMeetingExperience) Tab: ${r}, App: ${null==s?void 0:s.name} ${null==s?void 0:s.id}, isAnonymousUser: ${n}, enableMeetingSurfaces: ${i}`),!i||((e,t,n)=>{var i,a,o,r,s,d,c,u;const m=null===(a=null===(i=t.appDefinition)||void 0===i?void 0:i.galleryTabs)||void 0===a?void 0:a[0];let g=!1;return"StaticExtensionTab"===e.__typename?(g=null===(r=null===(o=t.appDefinition)||void 0===o?void 0:o.staticTabs)||void 0===r?void 0:r.some((e=>{var t;return null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.some((e=>e===l.BU.MeetingSidePanel))})),null==n||n.log(`(isMeetingOptimizeApp) Static tab ${null===(s=null==e?void 0:e.baseInfo)||void 0===s?void 0:s.id} isMeetingOptimized: ${g}`)):(g=(null===(d=null==m?void 0:m.context)||void 0===d?void 0:d.some((e=>e===l.jD.MeetingSidePanel)))||(null===(c=null==m?void 0:m.meetingSurfaces)||void 0===c?void 0:c.some((e=>e===l.Aj.SidePanel))),null==n||n.log(`(isMeetingOptimizeApp) Gallery Tab ${null===(u=null==e?void 0:e.baseInfo)||void 0===u?void 0:u.id} isMeetingOptimized: ${g}. `)),!!g})(e,t,a)){const e=!n||(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.appDefinition)||void 0===t?void 0:t.meetingExtensionDefinition)||void 0===n?void 0:n.isAnonymousAccessAllowed})(t);return null==a||a.log(`(isValidTabForInMeetingExperience) is access to tab '${r}', valid: ${e}`),e}return!1},L=(e,t,n,i,a,o,r,s,l,u)=>{const m=(null==e?void 0:e.type)===c.Ch.MsaLife;if(u&&m)return!0;if(j(e,o))return!1;const g=z(n,r,i);if(B(i,g,a))return!1;const v=t===d.Eh.Organizer||t===d.Eh.Presenter,h=s&&n===p.rf.P2P;return v||h||l&&U(t,g)},U=(e,t)=>e===d.Eh.Attendee&&t,B=(e,t,n)=>n&&(e||t),j=(e,t)=>{if(P(e))return!0;if(O(e))return!0;return!!Q(null==e?void 0:e.profile.tenantId,t)},W=(e,t,n,a,o,r,s,l,d,c)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,u;const m=[],g=[];if(e)for(const l of e)if(d&&"StaticExtensionTab"===l.__typename||"ExtensionTab"===l.__typename){const e={tabId:l.baseInfo.id,displayName:decodeURIComponent(l.baseInfo.displayName||""),entityId:l.entityId,tabType:l.__typename},d=yield N(t,n,l.baseInfo.appId,r,s,c);if(x(l,d,a,!!o,s)){const t={tabInfo:e,appInfo:{appId:l.baseInfo.appId,appName:(null===(i=d.appDefinition)||void 0===i?void 0:i.name)||"",iconUrl:(null===(u=d.appDefinition)||void 0===u?void 0:u.smallImageUrl)||""}};m.push(t)}else g.push(l.baseInfo.appId)}return(null==g?void 0:g.length)>0&&(null==c||c.mark(y.ck.PlatformTabFetchUbarDroppedTabsDueToMeetingContext),null==s||s.log(`convertToTabButtons(${l}) dropped apps: ${g.join(",")}`)),m})),V=(e,t,n,a,o,r,s,l,d,c)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;null==c||c.mark(y.ck.PlatformTabFetchStart);const u=yield w(e,t,o,l,r);null==r||r.log(`getPlatformTabs(${s}): fetched ${null===(i=u.platformTabs)||void 0===i?void 0:i.length} tabs`);const m=yield W(u.platformTabs,e,t,n,a,null==o?void 0:o.messageId,r,s,d,c);return null==c||c.stop(),m})),H=(e,t)=>{var n,i;const a=[],o=[];for(const t of e.platformTabsEvent)if("StaticExtensionTab"===(null==t?void 0:t.__typename)||"ExtensionTab"===(null==t?void 0:t.__typename)){const e=null!==(n=t.baseInfo.appId)&&void 0!==n?n:"",r=null!==(i=t.baseInfo.id)&&void 0!==i?i:"";a.push(e),o.push(r)}t.log(`tabsEvent appData: ${a.join(",")}`),t.log(`tabsEvent tabData: ${o.join(",")}`)},$=(e,t,n,i,a,r,s,l,d,c)=>{const u=e&&[o.wJZ.Scheduled,o.wJZ.Recurring].includes(e)&&(!r||c),m=l&&q(e,t,n),g=s&&z(t,n,i),p=d&&G(t,n,i);return null==a||a.log(`isSupportedMeeting: meetingType-${e}, isChannelMeeting- ${r}, isSupportedInPrivateOrChannelMeeting-${u}, \n    callType -${t}, isSupportedInCalendarMeetNow: ${m}, isSupportedInGroupCall: ${g},\n    isSupportedInOneOnOneCall: ${p}`),!!(u||m||g||p)},z=(e,t,n)=>t===S.k2.None&&e===p.rf.Conference&&!n,G=(e,t,n)=>t===S.k2.None&&e===p.rf.P2P&&n,q=(e,t,n)=>e&&e===o.wJZ.MeetNow&&t===p.rf.Conference&&n===S.k2.Meeting,Q=(e,t,n)=>(null==n||n.log(`isExternalUser: tenantId-${t}, currentTenantId-${e}`),!(!t||!e||e===t)),J=(e,t)=>!!t&&!!e&&e===t,Y=e=>!!e&&"0"!==e;function K(e){return Y(e)?{platformTabsQueryType:o.rtK.QueryByMessage,messageStorage:{messageId:e}}:void 0}function Z(e){return e?{appInstallScope:o.qi6.Team}:{appInstallScope:o.qi6.GroupChat}}const X=e=>Y(e)?o.rtK.QueryByMessage:o.rtK.QueryByThread,ee=e=>{switch(e){case u.m.Channel:return o.qi6.Team;case u.m.ChannelMeeting:case u.m.ChannelMeetingSchedulingForm:return o.qi6.Team;default:return o.qi6.GroupChat}},te=e=>e?{appInstallScope:o.qi6.Team,platformTabsEntryPoint:o.sqJ.ChannelMeeting}:{appInstallScope:o.qi6.GroupChat,platformTabsEntryPoint:o.sqJ.PrivateMeeting},ne=e=>{switch(e){case b.mQ.privateMeetingSchedulingForm:return{appInstallScope:o.qi6.GroupChat,platformTabsEntryPoint:o.sqJ.PrivateMeetingSchedulingForm};case b.mQ.channelMeetingSchedulingForm:return{appInstallScope:o.qi6.Team,platformTabsEntryPoint:o.sqJ.ChannelMeetingSchedulingForm};case b.mQ.channelTab:return{appInstallScope:o.qi6.Team,platformTabsEntryPoint:o.sqJ.Channel};default:return}},ie=e=>{const t=new Error(e.message);return t.name=e.name,t},ae=e=>{switch(e){case o.qi6.GroupChat:return m.Mv.group;case o.qi6.Personal:return m.Mv.personal;case o.qi6.Team:return m.Mv.team;default:return}},oe=e=>(null==e?void 0:e.chatId)?o.qi6.GroupChat:(null==e?void 0:e.teamId)||(null==e?void 0:e.channelId)?o.qi6.Team:o.qi6.Personal,re=e=>ce(e)||ue(e)?e.baseInfo.id:"",se=e=>ce(e)||ue(e)?e.baseInfo.appId:"",le=e=>ue(e)&&e.entityId||"",de=e=>(ce(e)||ue(e))&&e.websiteUrl?e.websiteUrl:null,ce=e=>"WebsiteTab"===(null==e?void 0:e.__typename),ue=e=>"ExtensionTab"===(null==e?void 0:e.__typename)||me(e),me=e=>"StaticExtensionTab"===(null==e?void 0:e.__typename),ge=e=>"StaticExtensionTab"===e,pe=e=>"PlaceholderTab"===(null==e?void 0:e.__typename),ve=e=>{var t,n;return!!me(e)&&(null===(n=null===(t=e.baseInfo)||void 0===t?void 0:t.context)||void 0===n?void 0:n.includes(l.BU.TeamLevelApp))},he=e=>{var t;return(null===(t=null==e?void 0:e.linkedEntity)||void 0===t?void 0:t.type)===g.p.extensions},fe=(e,t,n,i)=>({threadId:e,tab:{id:t,displayName:"",tabType:o.Qhk.StaticExtensionTab,appInstallScope:n},storageOptions:K(i)}),ye=(e,t)=>{if(e)return ke(e.id,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,t)},ke=(e,t,n,i,a)=>{if(e)return t?k.Th.Meeting:n?i?k.Th.Botchat:k.Th.OneOnOneChat:a?k.Th.Channel:k.Th.GroupChat},Se=(e,t,n,i)=>{const a=a=>{var o;null===(o=e.findScenario(a))||void 0===o||o.cancel();const r=e.newScenario(a);e.hoistScenarioToCore&&e.hoistScenarioToCore(r),r.appendEventData({"App.Id":t,"App.EntryPoint":n}),null==i||i.log(`phase 1 scenario marker started for entryPoint ${n}`)};a(y.RG.PlatformTabFrameLoading),a(y.RG.PlatformTabLaunch)},be=e=>{switch(e){case u.m.Meeting:case u.m.ChannelMeeting:return l.BU.MeetingSidePanel;case u.m.PrivateMeetingSchedulingForm:case u.m.ChannelMeetingSchedulingForm:return l.BU.MeetingDetailsTab;case u.m.Channel:return l.BU.ChannelTab;case u.m.Chat:return l.BU.PrivateChatTab;case u.m.MeetingChat:return l.BU.MeetingChatTab;default:return l.BU.Unknown}},Ce=(e,t)=>e===C.PG.Desktop&&!1===t,we=e=>{switch(e){case m.Mv.group:return o.qi6.GroupChat;case m.Mv.personal:return o.qi6.Personal;case m.Mv.team:return o.qi6.Team;default:return}},Ne=(e,t)=>({threadId:e.threadId,messageId:e.messageId,appId:e.appId||t.appId,tabId:e.tabId||t.tabId,tabEntityId:t.tabEntityId||e.tabEntityId})},323262:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"baseInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BaseTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"externalAppId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"dateAdded"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"teamInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"teamSiteDomain"}},{kind:"Field",name:{kind:"Name",value:"teamSitePath"}},{kind:"Field",name:{kind:"Name",value:"teamSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"channelInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"channelRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"channelType"}}]}},{kind:"Field",name:{kind:"Name",value:"tabPermission"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canUpdateConfig"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"definedDevicePermissions"}}]}}]}}]}},977605:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlaceholderTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...n(323262).e.definitions]}},3078:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyDocumentLibraryTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyDocumentLibraryTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"libraryId"}},{kind:"Field",name:{kind:"Name",value:"libraryServerRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteImageUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedDocumentLibraryTitle"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteTitle"}}]}},...n(323262).e.definitions]}},49543:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"removeUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isPlaceholderTab"}}]}},...n(323262).e.definitions]}},604192:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"fileViewTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FileViewTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"providerMetadata"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}}]}},...n(323262).e.definitions]}},874142:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyWikiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyWikiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"wikiTabId"}},{kind:"Field",name:{kind:"Name",value:"wikiDefaultTab"}},{kind:"Field",name:{kind:"Name",value:"hasContent"}},{kind:"Field",name:{kind:"Name",value:"scenarioName"}},{kind:"Field",name:{kind:"Name",value:"isMyWiki"}},{kind:"Field",name:{kind:"Name",value:"isPrivateMeetingWiki"}},{kind:"Field",name:{kind:"Name",value:"meetingNotes"}},{kind:"Field",name:{kind:"Name",value:"hasMigratedToOneNote"}}]}},...n(323262).e.definitions]}},931254:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"oneNoteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneNoteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"oneNoteId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"sectionUrl"}},{kind:"Field",name:{kind:"Name",value:"notebookId"}},{kind:"Field",name:{kind:"Name",value:"notebookLocation"}},{kind:"Field",name:{kind:"Name",value:"service"}},{kind:"Field",name:{kind:"Name",value:"subtype"}}]}},...n(323262).e.definitions]}},404084:(e,t,n)=>{"use strict";n.d(t,{S:()=>h});var i=n(113852),a=n(323262);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...a.e.definitions]};var r=n(982141);const s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"basicTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BasicTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"displayNameLocalizationKey"}}]}}]}},...a.e.definitions]};var l=n(639211),d=n(604192),c=n(339178),u=n(931254),m=n(874142),g=n(3078),p=n(977605);const v={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...a.e.definitions]},h={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"basicTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"}}]}},...i.p.definitions,...o.definitions,...r.Y.definitions,...s.definitions,...l.Q.definitions,...d.N.definitions,...c.y.definitions,...u.H.definitions,...m.K.definitions,...g.C.definitions,...p.y.definitions,...v.definitions]}},339178:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"powerBiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PowerBiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"originatingTeam"}},{kind:"Field",name:{kind:"Name",value:"originatingTeamId"}},{kind:"Field",name:{kind:"Name",value:"reports"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...n(323262).e.definitions]}},639211:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...n(323262).e.definitions]}},113852:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...n(323262).e.definitions]}},982141:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"websiteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WebsiteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...n(323262).e.definitions]}},959629:(e,t,n)=>{"use strict";n.d(t,{yo:()=>g});var i=n(639211),a=n(49543),o=n(982141),r=n(113852),s=n(604192),l=n(339178),d=n(931254),c=n(874142),u=n(3078),m=n(977605);const g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Tab"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"tabId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTab"},arguments:[{kind:"Argument",name:{kind:"Name",value:"tabId"},value:{kind:"Variable",name:{kind:"Name",value:"tabId"}}},{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}}]}}]}},...i.Q.definitions,...a.e.definitions,...o.Y.definitions,...r.p.definitions,...s.N.definitions,...l.y.definitions,...d.H.definitions,...c.K.definitions,...u.C.definitions,...m.y.definitions]}},694785:(e,t,n)=>{"use strict";n.d(t,{br:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PlatformTabsInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsQueryType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTabs"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"platformTabsQueryType"},value:{kind:"Variable",name:{kind:"Name",value:"queryType"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"platformTabInfo"}}]}}]}},...n(404084).S.definitions]}},41058:(e,t,n)=>{"use strict";var i,a;n.d(t,{Rd:()=>i,Ai:()=>a,rG:()=>o}),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_240=240]="IS_AT_LEAST_240",e[e.IS_AT_LEAST_290=290]="IS_AT_LEAST_290",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_360=360]="IS_AT_LEAST_360",e[e.IS_AT_LEAST_375=375]="IS_AT_LEAST_375",e[e.IS_AT_LEAST_414=414]="IS_AT_LEAST_414",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_640=640]="IS_AT_LEAST_640",e[e.IS_AT_LEAST_720=720]="IS_AT_LEAST_720",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_834=834]="IS_AT_LEAST_834",e[e.IS_AT_LEAST_947=947]="IS_AT_LEAST_947",e[e.IS_AT_LEAST_1000=1e3]="IS_AT_LEAST_1000",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1350=1350]="IS_AT_LEAST_1350",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2048=2048]="IS_AT_LEAST_2048",e[e.IS_AT_LEAST_2560=2560]="IS_AT_LEAST_2560"}(i||(i={})),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_568=568]="IS_AT_LEAST_568",e[e.IS_AT_LEAST_667=667]="IS_AT_LEAST_667",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1366=1366]="IS_AT_LEAST_1366",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2160=2160]="IS_AT_LEAST_2160",e[e.IS_AT_LEAST_4320=4320]="IS_AT_LEAST_4320"}(a||(a={}));const o=(e,t={})=>{const{isMinWidthBreakpointAtLeast360:n,isMinWidthBreakpointAtLeast480:i,isMinWidthBreakpointAtLeast720:a,isMinWidthBreakpointAtLeast768:o}=e,{offsetForMinWidthBreakpointIsGreaterThan0:r,offsetForMinWidthBreakpointAtLeast360:s,offsetForMinWidthBreakpointAtLeast480:l,offsetForMinWidthBreakpointAtLeast720:d,offsetForMinWidthBreakpointAtLeast768:c}=t;let u=null!=r?r:0;o&&"number"==typeof c?u=c:a&&"number"==typeof d?u=d:i&&"number"==typeof l?u=l:n&&"number"==typeof s&&(u=s);const m=((({isMinWidthBreakpointAtLeast240:e,isMinWidthBreakpointAtLeast290:t,isMinWidthBreakpointAtLeast320:n,isMinWidthBreakpointAtLeast360:i,isMinWidthBreakpointAtLeast375:a,isMinWidthBreakpointAtLeast414:o,isMinWidthBreakpointAtLeast480:r,isMinWidthBreakpointAtLeast640:s,isMinWidthBreakpointAtLeast720:l,isMinWidthBreakpointAtLeast768:d,isMinWidthBreakpointAtLeast834:c,isMinWidthBreakpointAtLeast947:u,isMinWidthBreakpointAtLeast1000:m,isMinWidthBreakpointAtLeast1024:g,isMinWidthBreakpointAtLeast1280:p,isMinWidthBreakpointAtLeast1350:v,isMinWidthBreakpointAtLeast1440:h,isMinWidthBreakpointAtLeast1500:f,isMinWidthBreakpointAtLeast1680:y,isMinWidthBreakpointAtLeast1920:k,isMinWidthBreakpointAtLeast2048:S,isMinWidthBreakpointAtLeast2560:b})=>b?2560:S?2048:k?1920:y?1680:f?1500:h?1440:v?1350:p?1280:g?1024:m?1e3:u?947:c?834:d?768:l?720:s?640:r?480:o?414:a?375:i?360:n?320:t?290:e?240:239)(e)-u)/10+"rem";return{"--width":m,width:[m,"var(--width)"]}}},941355:(e,t,n)=>{"use strict";n.d(t,{r:()=>v,P:()=>p});var i=n(632735),a=n(767008),o=n(118824),r=n(688448);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FetchSearchPrefetchConfigs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchPrefetchConfigs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"verticals"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"searchVerticalConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"ecsSettings"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"searchVerticalConfig"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchVerticalConfig"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"queryTemplate"}},{kind:"Field",name:{kind:"Name",value:"entities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entity"}}]}},{kind:"Field",name:{kind:"Name",value:"refiners"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"refiner"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchEntity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contentSources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"contentSource"}}]}},{kind:"Field",name:{kind:"Name",value:"entityType"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"contentSource"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchContentSource"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"refiner"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SearchRefiner"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"layout"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"layout"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"layout"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RefinerLayout"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"fieldName"}},{kind:"Field",name:{kind:"Name",value:"displayInterface"}}]}}]}.definitions]}.definitions]};var l=n(134056),d=n(291019),c=n(628235),u=n(592827);const m=i.createContext({verticals:[],isInitialized:!1}),g={verticals:[],ecsSettings:{},isInitialized:!1},p=()=>i.useContext(m),v=i.memo((e=>{const{enableCustomVerticals:t}=(0,a.NC)(o.J.Serp),{scenarioFactory:n}=(0,l.SE)(),p=(0,r.x)(),[v,h]=i.useState(g),f=(0,u.WD)(d.nh.POST_CRITICAL),y=i.useCallback((()=>{const e=n.newScenario(c.RG.CustomSearchPreFetch,{startTime:Date.now()});p.query({query:s,fetchPolicy:"cache-first"}).then((t=>{var n;const i=null===(n=t.data)||void 0===n?void 0:n.searchPrefetchConfigs,a=Object.assign({},g);i&&(a.verticals=i.verticals,i.ecsSettings&&(a.ecsSettings=i.ecsSettings)),h((()=>Object.assign(Object.assign({},a),{isInitialized:!0}))),null==e||e.stop()}))}),[p,n]);f&&t&&!v.isInitialized&&y();const k=i.useMemo((()=>({verticals:v.verticals,ecsSettings:v.ecsSettings,isInitialized:v.isInitialized})),[v]);return t?i.createElement(m.Provider,{value:k},e.children):i.createElement(i.Fragment,null,e.children)}))},767008:(e,t,n)=>{"use strict";n.d(t,{NC:()=>o,h_:()=>r});var i=n(632735),a=n(134056);const o=(e,t)=>{const{coreSettings:n}=(0,a.SE)(),[o,r]=(0,i.useState)((()=>n?n.get(e,t):{}));return(0,i.useEffect)((()=>{if(n){const i=n.getObservable(e,t).subscribe(r);return()=>i.unsubscribe()}return()=>{}}),[n,e,t]),o},r=({category:e,settings:t,children:n})=>n(o(e,t))},305501:(e,t,n)=>{"use strict";n.d(t,{Q:()=>o});var i=n(632735),a=n(825998);const o=(e,t=a.V)=>{const n=(0,i.useRef)(e);return t(n.current,e)||(n.current=e),n.current}},803197:(e,t,n)=>{"use strict";n.d(t,{m:()=>d});var i=n(632735),a=n(550070),o=n(537330),r=n(276053),s=n(157459),l=n(305501);const d=(e,t,n)=>{const d=(0,i.useRef)(),{next:c,error:u,complete:m}=(0,l.Q)(t),g=(0,i.useCallback)((()=>{var e;null===(e=d.current)||void 0===e||e.unsubscribe(),d.current=void 0}),[]),p=(0,i.useMemo)((()=>{let t=[];return e?(n&&(t=[(0,r.K)((e=>(u&&u(e),(0,o._)(e)))),(0,s.a)((e=>n?e:a.E))]),e.pipe.apply(e,t)):a.E}),[e,n,u]);return(0,i.useEffect)((()=>(g(),d.current=p.subscribe({next:c,error:u,complete:m}),g)),[p,c,u,m,g]),g}},209001:(e,t,n)=>{"use strict";var i;n.d(t,{X:()=>i,G:()=>a}),function(e){e.CreateTeam="CreateTeam",e.JoinTeam="JoinTeam",e.JoinTeamByCode="JoinTeamByCode",e.AddMember="AddMember",e.AddChannel="AddChannel",e.ManageTeamsList="ManageTeamsList",e.ManageTeamsInvites="ManageTeamsInvites",e.CrossTeamAnalytics="CrossTeamAnalytics"}(i||(i={}));const a={forceSync:!1}},963097:(e,t,n)=>{"use strict";n.d(t,{g$:()=>c,jd:()=>u,pt:()=>g,GZ:()=>p});var i=n(395816),a=n(281857),o=n(642115),r=n(84574),s=n(727765),l=n(519194),d=n(209001);const c=(e,t)=>{var n,a;return e.isGeneral?t!==i.S1B.OwnersPost||e.memberRole===i.k_p.Admin:e.memberRole===i.k_p.Admin||e.isModerator||(null===(n=e.channelSettings)||void 0===n?void 0:n.channelPostPermissions)===i.XIP.Everyone||(null===(a=e.channelSettings)||void 0===a?void 0:a.channelPostPermissions)===i.XIP.EveryoneButGuests&&e.memberRole!==i.k_p.Guest&&e.memberRole!==i.k_p.Undefined},u=(e,t)=>{const n=decodeURIComponent(e),{channelId:i,replyChainId:r}=m(n,t);if(!("string"==typeof i)||!("string"==typeof r||null==r)){const n=`TeamsAndChannelsHelper::extractChannelMessageCompoundId::${a.jK.InvalidInput}::${e}`;throw null==t||t.error(n),(0,o.Tr)("TeamsAndChannelsHelper",a.jK.InvalidInput,"extractChannelMessageCompoundId",{compoundId:e},n)}return{channelId:i,replyChainId:r}},m=(e,t)=>{try{const{channelId:t,replyChainId:n}=JSON.parse(e);return{channelId:t,replyChainId:n}}catch(n){return null==t||t.warn(`Exception parsing channel navigation args JSON, will assume the passed id is a channel id: ${e}`),{channelId:e}}},g=e=>{if(!e)return{teamId:void 0,channelId:void 0};try{const{teamId:t,channelId:n}=JSON.parse(e);return{teamId:t,channelId:n}}catch(t){return{channelId:e}}},p=(e,t,n,i,a,o,c,u,m)=>{switch(e){case d.X.CreateTeam:(e=>e===r.oj.Teacher||e===r.oj.Student)(o)?t.school.eduCreateTeam():i?t.teamsAndChannels.createTeamOnMainView({source:s.IC.template},c):t.teamsAndChannels.createTeam();break;case d.X.JoinTeamByCode:c===l.D.SchoolTeams?t.school.gridTeamDiscover():t.teamsAndChannels.teamDiscover();break;case d.X.JoinTeam:a?t.teamsGallery.launchTeamsGallery():t.teamsAndChannels.teamDiscover();break;case d.X.AddChannel:n&&t.teamsAndChannels.addChannel(n.id);break;case d.X.AddMember:n&&t.teamsAndChannels.addMember(n.id);break;case d.X.ManageTeamsList:t.teamsAndChannels.manageTeamsList(l.D.ChannelList,void 0,null==m?void 0:m()),null==u||u();break;case d.X.ManageTeamsInvites:t.teamsAndChannels.manageSharedChannelsPendingInvites(l.D.ChannelList,void 0,null==m?void 0:m()),null==u||u();break;case d.X.CrossTeamAnalytics:t.teamsAndChannels.crossTeamAnalytics(l.D.ChannelList,void 0,null==m?void 0:m()),null==u||u()}}},407006:(e,t,n)=>{"use strict";n.d(t,{XL:()=>o,R2:()=>r,It:()=>s});var i=n(632735),a=n(892891);const o=i.createContext({recordPanelAction:()=>{},createDatabag:()=>({dispose:a.noop}),appendBiData:()=>{},removeBiData:()=>{},recordPanelView:()=>{}}),r=o.Provider,s=()=>i.useContext(o)},147540:(e,t,n)=>{"use strict";n.d(t,{q:()=>p});var i=n(632735),a=n(218789),o=n(400147),r=n(30459),s=n(260465),l=n(134056),d=n(330266),c=n(397163),u=n(865193);const m=null===u.f||void 0===u.f?void 0:u.f.root,g=[a.h,m],p=e=>{const{userBiService:t,loggerFactory:n,host:a}=(0,l.SE)(),u=(0,d.sV)(),m=u?u.entity:void 0,p=e.entityType||m&&m.type,v=i.useContext(s.Il);return i.createElement(c.S,Object.assign({biLogger:t||v.biLogger,loggerFactory:n,WrapperComponent:e.disableWrapper?o.R:r.x,whitelistedClassNames:g,host:a,entityType:p},e))}},397163:(e,t,n)=>{"use strict";n.d(t,{S:()=>p});var i=n(231191),a=n(632735),o=n(892891),r=n(266641),s=n(632822);const l={tags:["a","button","input"],classNames:[]},d=(e,t)=>{const n=function(e){if(e.path)return e.path;if(e.composedPath)return e.composedPath();return c(e.target)}(e),{trackableDataset:i,isActionable:a}=function(e,t){let n=!1,i={};const a=[...l.classNames,...t];return e.some((e=>e.dataset&&"false"===e.dataset.track?(n=!1,!0):(function(e){if(!e.dataset)return!1;const t=Object.keys(e.dataset).filter((e=>e.match("track")));return!(0,o.isEmpty)(t)}(e)&&(i=e.dataset),e.tagName&&(0,o.includes)(l.tags,e.tagName.toLowerCase())&&(n=!0),e.classList&&(0,o.intersection)(a,e.classList).length>0&&(n=!0),e.dataset&&"true"===e.dataset.track&&(n=!0),!(!n||!i)))),{trackableDataset:i,isActionable:n}}(n,t||[]);if(!a)return null;const r=Object.keys(i).length>0;return r&&i.trackEventType&&i.trackEventType!==e.type?null:a&&!r?function(e){const t=[];return e.forEach((e=>{if("BODY"===e.tagName||"HTML"===e.tagName||e instanceof Document||e instanceof Window)return;let n="";e.classList&&e.classList.length>0&&(n=`.${e.classList.value.replace(/ /g,".")}`),t.push(`${e.tagName&&e.tagName.toLowerCase()}${n}`)})),{trackDebug:t.reverse().join(" > ")}}(n):i};function c(e,t){return e?((t=t||[]).push(e),e.parentElement?c(e.parentElement,t):t):t||[]}var u=n(407006),m=n(340487),g=n(538606);class p extends a.Component{constructor(e){super(e),this._logger=this.props.loggerFactory.newLogger("BILogger"),this._eventListenerDispose=[],this._dataBags=[],this._recordPanelView=e=>{const{biLogger:t,contextWorkLoads:n}=this.props,i=e||n?(e||[]).concat(n||[]):void 0;t?t.recordPanelView(this._dataFromPanelView(),this._logger,i):this._logger.warn("BI Logger is not set on the context. No BI events are being logged.")},this._dataFromPanelView=()=>{const e=this.props,{dataBagProps:t}=e,n=(0,i.__rest)(e,["dataBagProps"]);if(!t)return n;const a=this._createDatabag();return Object.keys(t).forEach((e=>{a[e]=t[e]})),Object.assign({dataBag:a},n)},this._recordPanelAction=(e,t,n)=>{const{biLogger:i,panelLaunchMethod:a,panelUri:o,threadId:r,teamId:s,threadMembers:l,threadType:d,entityType:c,contextWorkLoads:u}=this.props;i&&i.recordPanelAction(Object.assign({panelLaunchMethod:a,panelUri:o,threadId:r,teamId:s,threadMembers:l,threadType:d,entityType:c},e),this._logger,n||u)},this._createDatabag=()=>{const e=new m.S;return this._dataBags.push(e),e.setDispose((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield(0,g._)(0);const t=this._dataBags.findIndex((t=>t.id===e.id));this._dataBags.splice(t,1)})))),e},this._appendBiData=(e,t)=>{var n,i;null===(i=null===(n=this.props)||void 0===n?void 0:n.biLogger)||void 0===i||i.appendBiData(e,t)},this._removeBiData=(e,t)=>{var n,i;null===(i=null===(n=this.props)||void 0===n?void 0:n.biLogger)||void 0===i||i.removeBiData(e,t)},this._handleRef=e=>{const t={capture:!0};if(e){const n=!!e.setAttribute&&!!e.removeAttribute&&!!e.hasAttribute;n&&e.hasAttribute("telemetrySet")||(n&&(e.setAttribute("telemetrySet","true"),this._eventListenerDispose.push((()=>{e.removeAttribute("telemetrySet")}))),e.addEventListener("click",this._captureAction,t),this._eventListenerDispose.push((()=>{e.removeEventListener("click",this._captureAction,t)})),e.addEventListener("keydown",this._captureActionOnEnter,t),this._eventListenerDispose.push((()=>{e.removeEventListener("keydown",this._captureActionOnEnter,t)})),e.addEventListener("scroll",this._debouncedCaptureAction,t),this._eventListenerDispose.push((()=>{e.removeEventListener("scroll",this._debouncedCaptureAction,t)})))}},this._captureAction=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n;const a=this.props,{biLogger:o,loggerFactory:s,children:l}=a,c=(0,i.__rest)(a,["biLogger","loggerFactory","children"]);let u;if(!o)return;this._isSyntheticEvent(e)&&(e=e.nativeEvent);const m=d(e,this.props.whitelistedClassNames);if(!m)return;m.trackDatabagId&&(yield(0,g._)(0),u=this._dataBags.find((e=>e.id===m.trackDatabagId)));let p=c.contextWorkLoads;if(m.trackContextWorkLoads){p=m.trackContextWorkLoads.split(",").map((e=>r.sz[e]))}const v=Object.assign(Object.assign({dataBag:u},c),this._cleanDataSet(m)),h=this.props.host?(null===(n=null===(t=this.props.host)||void 0===t?void 0:t.performance)||void 0===n?void 0:n.now())-e.timeStamp:void 0;h&&Object.assign(v,{actionInputDelay:h}),o.recordPanelAction(v,this._logger,p)})),this._cleanDataSet=e=>{const t={},n="track";return Object.keys(e).map((i=>{if(i.match(n)&&i!==n){const a=i.substr(n.length),o=`${a[0].toLowerCase()}${a.substr(1)}`;t[o]=e[i]}})),t},this._debouncedCaptureAction=(0,o.debounce)(this._captureAction,500),this._captureActionOnEnter=(0,o.cond)([[(0,o.matches)({keyCode:s.n.enter}),this._captureAction]]),this._contextValue={recordPanelAction:this._recordPanelAction,createDatabag:this._createDatabag,appendBiData:this._appendBiData,removeBiData:this._removeBiData,recordPanelView:this._recordPanelView,panelViewData:this._dataFromPanelView}}componentDidMount(){this.props.skipPanelViewOnMount||this._recordPanelView()}componentDidUpdate(e){if(!this.props.recordViewOnUpdate)return;const{disableWrapper:t,biLogger:n,loggerFactory:a,newLogger:o,children:r}=e,s=(0,i.__rest)(e,["disableWrapper","biLogger","loggerFactory","newLogger","children"]);let l=!1;Object.keys(s).forEach((t=>{e[t]!==this.props[t]&&(l=!0)})),l&&this._recordPanelView()}componentWillUnmount(){this._eventListenerDispose.forEach((e=>e())),this._eventListenerDispose=[],this._debouncedCaptureAction.cancel()}render(){const{biLogger:e,children:t,WrapperComponent:n,wrapperClassName:i}=this.props;if(!e)return t;const o=this.props.disableWrapper&&!this.props.disableNativeListeners?{children:a.createElement(a.Fragment,null,t),innerRef:this._handleRef}:{children:t,onClickCapture:this._captureAction,onKeyDownCapture:this._captureActionOnEnter,onScrollCapture:e=>{e.persist(),this._debouncedCaptureAction(e)}},r=i?Object.assign({className:i},o):o;return a.createElement(u.R2,{value:this._contextValue},a.createElement(n,Object.assign({},r)))}_isSyntheticEvent(e){return!!e&&!!e.nativeEvent}}},62415:(e,t,n)=>{"use strict";n.d(t,{su:()=>s,Ef:()=>l,V7:()=>d});var i=n(118824),a=n(767008),o=n(84574);const r=({ageGroup:e,enableUnderAgeOfConsentPolicy:t})=>{const n=e===o.zH.MinorWithMsaParentalConsent||e===o.zH.MinorWithoutMsaParentalConsent;return!!t&&n},s=e=>{const{ageGroup:t,enableUnderAgeOfConsentPolicy:n}=e.get(i.J.AgeConsent);return r({ageGroup:t,enableUnderAgeOfConsentPolicy:n})},l=(e=!1)=>{const{ageGroup:t,enableUnderAgeOfConsentPolicy:n}=(0,a.NC)(i.J.AgeConsent);return!(!e||t)||r({ageGroup:t,enableUnderAgeOfConsentPolicy:n})},d=e=>{const{disableGiphyForUnderAgeUser:t}=e.get(i.J.AgeConsent);return s(e)&&!!t}},666013:(e,t,n)=>{"use strict";function i(e){const t={};return(n,...i)=>{try{let a=t[n];return a||(a=t[n]=e(...i).then((e=>(delete t[n],e))).catch((e=>{throw delete t[n],e}))),a}catch(e){throw e}}}n.d(t,{k:()=>i})},69226:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m;n.d(t,{Ch:()=>i,w4:()=>a,Yf:()=>o,jh:()=>r,G7:()=>s,qn:()=>l,US:()=>c,JE:()=>u,Bl:()=>m}),function(e){e.Anonymous="Anonymous",e.Aad="Aad",e.Msa="Msa",e.MsaLife="MsaLife",e.GFed="GFed",e.Otp="Otp"}(i||(i={})),function(e){e.Member="Member",e.Anonymous="Anonymous",e.Guest="Guest"}(a||(a={})),function(e){e.Default="Default",e.Mto="Mto"}(o||(o={})),function(e){e[e.Member=0]="Member",e[e.Guest=1]="Guest",e[e.Anonymous=2]="Anonymous",e[e.CrossCloudMeeting=3]="CrossCloudMeeting"}(r||(r={})),function(e){e.prod="prod",e.life="life",e.dod="dod",e.gcch="gcch"}(s||(s={})),function(e){e.prod="Global",e.gcch="microsoftonline.us",e.dod="microsoftonline.mil"}(l||(l={})),function(e){e.prod="WW",e.dod="DOD",e.gcch="GCCHigh",e.gcc="GCC",e.unknown="UNKNOWN",e.gallatin="Gallatin"}(d||(d={})),function(e){e.DefaultHidden="DefaultHidden",e.Default="Default"}(c||(c={})),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting",e.LicenseError="LicenseError",e.SignInRestriction="SignInRestriction",e.UnRedeemed="UnRedeemed",e.LoginError="LoginError",e.Unknown="Unknown",e.LoginNotStartedAsTenantHidden="LoginNotStartedAsTenantHidden"}(u||(u={})),function(e){e.DefaultHidden="DefaultHidden",e.Hidden="Hidden",e.Shown="Shown"}(m||(m={}))},66431:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{in:()=>o,s_:()=>r,O_:()=>s,e0:()=>l}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={})),function(e){e[e.Skype=0]="Skype",e[e.AAD=1]="AAD",e[e.CAE=2]="CAE"}(a||(a={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(o||(o={})),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(r||(r={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT="https://api.spaces.skype.com",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read"}(s||(s={}));const l="9188040d-6c67-4c5b-b112-36a304b66dad"},374964:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a});let i=[];function a(e){i.push(e)}},845345:(e,t,n)=>{"use strict";n.d(t,{G:()=>r,X:()=>l});var i=n(907207),a=n(455304),o=n(395816);const r=(e,t)=>{let n,i=!1;for(let a=e.length-1;a>0;a--){const r=e[a],d=a>=1?e[a-1]:null;if(r.id===r.parentMessageId||(null==d?void 0:d.id)===r.parentMessageId)break;const c=r.isDeletedByAdmin||(null==d?void 0:d.isDeletedByAdmin),u=r.isDataSpillageHardDeleted||(null==d?void 0:d.isDataSpillageHardDeleted);if(c||u)continue;let m=!1;s(r,d)&&d&&(m=l(r,d)),m?n=o.HBY.bottom:i&&(n=o.HBY.top),t[a]=Object.assign(Object.assign({},t[a]),{attached:n}),i=m}return t},s=(e,t)=>{if(!t||t.isDeleted)return!1;if(e.creator!==t.creator)return!1;return!(e.creator&&e.isBotMessage&&e.onBehalfOf!==(null==t?void 0:t.onBehalfOf))},l=(e,t)=>{if(e.messageType&&d(e.messageType)||t.messageType&&d(t.messageType))return!1;const n=t.originalArrivalTime&&new Date(t.originalArrivalTime),i=e.originalArrivalTime&&new Date(e.originalArrivalTime);return!(!i||!n)&&i.getTime()-n.getTime()<=5*a.A_},d=e=>!!e&&(/^(Event|Control|ThreadActivity)/.test(e)||e===i.Cs.CallRecording)},367479:(e,t,n)=>{"use strict";n.d(t,{B$:()=>C,V5:()=>w,eU:()=>T,Ig:()=>E,k6:()=>A,aJ:()=>_,sW:()=>F,mH:()=>R,Wn:()=>P,zD:()=>O,vL:()=>x,TA:()=>L,CQ:()=>U,xT:()=>B});var i,a=n(231191),o=n(892891),r=n(69226),s=n(661564),l=n(84574),d=n(118824),c=n(249049),u=n(538606),m=n(758887),g=n(642115),p=n(281857),v=n(628235),h=n(66431),f=n(648062),y=n(372304),k=n(923036),S=n(244449);!function(e){e.Otp="mail",e.GFed="google.com"}(i||(i={}));const b="9188040d-6c67-4c5b-b112-36a304b66dad",C=(e,t,n)=>{var i,a;let o={};try{o=(0,c.s)().state.getSearchState()}catch(e){t.warn(`Error while fetching tid from routingServices: ${(0,g.VK)(e)}`)}const s=(null===(i=null==n?void 0:n.profile)||void 0===i?void 0:i.tid)||o.tid||o.Tid||o.tenantId||o.tenantid;if(s&&(n||e[0]&&e[1])){t.log("Anon flow - anonymous user created");const e=s===b?r.G7.life:r.G7.prod;return{isAuthenticated:!0,userName:(null==n?void 0:n.userName)||"anonymous",profile:{oid:`8:anon:${s}`,tid:s,upn:(null===(a=null==n?void 0:n.profile)||void 0===a?void 0:a.upn)||"",puid:""},role:r.w4.Anonymous,type:r.Ch.Anonymous,cloud:(null==n?void 0:n.cloud)||e}}t.log("non anon flow - user undefined")},w=e=>!!e&&e.status===s.qb.NOT_AUTHORIZED&&"SkypeToken"===e.headers["x-invalid-token"];var N;!function(e){e.PROTOCAL_MISMATCH_ERROR="Bearer token_types="}(N||(N={}));const T=(e,t,n,i)=>{var a,o;if("True"!==(null===(a=null==t?void 0:t.headers)||void 0===a?void 0:a[f.kI])||e!==f.ej.IC3_GATEWAY_CAE_KEY&&e!==f.ej.IC3_GATEWAY_AAD_KEY)return e;if(!n)return e;if(!(e=>e&&e.indexOf(N.PROTOCAL_MISMATCH_ERROR)>-1)(n))return e;const r=I(n);switch(e){case f.ej.IC3_GATEWAY_CAE_KEY:if(r===l.Zw.CAE)return e;break;case f.ej.IC3_GATEWAY_AAD_KEY:if(r===l.Zw.AAD||r===l.Zw.CAE)return e}if(r===l.Zw.AAD)return null==i||i.addEventData([`stmResource:${f.ej.IC3_GATEWAY_AAD_KEY}`]),f.ej.IC3_GATEWAY_AAD_KEY;if(r===l.Zw.Skype)throw null==i||i.addEventData(["stmResource:skype"]),(0,y.Tr)({context:"auth-helper",subContext:"getRetryResourceForStMigration",errorCode:f.SM.FallbackWithSkypeToken,message:"Highest protocal is Skype, retry with skypeToken",correlationId:null===(o=null==t?void 0:t.headers)||void 0===o?void 0:o.correlationId,isExpected:!0});return e},I=e=>{const t=null==e?void 0:e.toLowerCase();return(null==t?void 0:t.indexOf("cae"))>-1?l.Zw.CAE:(null==t?void 0:t.indexOf("aad"))>-1?l.Zw.AAD:(null==t||t.indexOf("skype"),l.Zw.Skype)},E=(e,t,n,a=!1)=>{var s,l,d,c,u,m,g,p;if((0,o.isEmpty)(e.profile)||!e.profile.oid&&a||e.role===r.w4.Anonymous||e.userRole===r.jh.Anonymous||!e.isAuthenticated&&t[0])return n.log("checking anon flow"),C(t,n,e);e.role=1===(null===(s=e.profile)||void 0===s?void 0:s.acct)?r.w4.Guest:r.w4.Member;let v=0===(null===(d=null===(l=e.profile)||void 0===l?void 0:l.altsecid)||void 0===d?void 0:d.indexOf("1:"))?r.Ch.Msa:r.Ch.Aad;return(null===(c=e.profile)||void 0===c?void 0:c.idp)&&(null===(u=e.profile)||void 0===u?void 0:u.iss)!==e.profile.idp?(v=(null===(m=e.profile)||void 0===m?void 0:m.idp)===i.Otp?r.Ch.Otp:v,v=(null===(g=e.profile)||void 0===g?void 0:g.idp)===i.GFed?r.Ch.GFed:v):(null===(p=e.profile)||void 0===p?void 0:p.tid)===b&&(v=r.Ch.MsaLife),e.cloud=v===r.Ch.MsaLife?r.G7.life:r.G7.prod,e.type=v,e.profile.oid=e.profile.oid||`8:defaultOid:${e.profile.tid}`,!e.profile.hasOwnProperty("upn")&&e.hasOwnProperty("userName")&&(e.profile.upn=e.userName||""),e.userRole===r.jh.CrossCloudMeeting&&(e.role=r.w4.Anonymous,e.type=r.Ch.Anonymous),n.log(`User role = [${e.role}], type = [${v}]`),e},A=(e,t)=>{if(!e.anon||!t)return[!1,!1];t=decodeURIComponent(t);for(const n of e.anon)if(n.anonUrlMatch&&t.indexOf(n.anonUrlMatch)>-1)return[!0,D(n,t)];return[!1,!1]},_=(e,t)=>{const n=new Error("Tenant is has not completed redemption");return Object.assign(n,{context:"global-auth",subContext:"handleGetTenants",reason:"",errorCode:e,serverResponse:"",correlationId:t,isExpected:!0,innerError:""})},D=(e,t)=>{if(!e.restrictions||0===e.restrictions.length)return!0;for(const n of e.restrictions)if(t.indexOf(n)>-1)return!0;return!1},F=(e,t)=>{const{maxRetries:n,retryWindow:i,backoffTime:o,shouldRetry:r}=t,s=e=>i-(Date.now()-e);return(...t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const i=Date.now();let a=0,l=s(i),d="";for(;a++<=n&&l>0;)try{return yield Promise.resolve(e.apply(e,t))}catch(e){if(r&&!r(e))throw e;if(e&&r&&r(e)&&a>=n){const t=`;All retries elapsed or retryWindow expired, RetryCount: ${a}, RemainingTime: ${l}`;throw(0,g.Tr)(e.context,e.code,e.subContext?e.subContext:"",e.reason,e.message+t,e.serverResponse)}if(a>=n||s(i)<=0){d=null==e?void 0:e.message;break}yield(0,u._)(o),l=s(i)}throw M(a,d,s(i))}))},M=(e,t,n)=>(0,g.Tr)("AuthRetryWithBackoff",p.jK.MaxLimitReached,"elapsed",void 0,`${t}; All retries elapsed or retryWindow expired, RetryCount: ${e}, RemainingTime: ${n}`);var R;!function(e){e.WWW_AUTHENTICATE_HEADER="www-authenticate",e.ERROR_PREFIX="error=",e.CLAIMS_PREFIX="claims=",e.INSUFFICIENT_CLAIMS="insufficient_claims"}(R||(R={}));const P=(e,t)=>{const n={error:void 0,claims:void 0},i=null==e?void 0:e[R.WWW_AUTHENTICATE_HEADER];if(!i)return n;const a=i.split(",").filter(Boolean).map((e=>e.trim()));for(const e of a){const i=e.split('"');if(3===i.length)switch(i[0].toLocaleLowerCase()){case R.ERROR_PREFIX:n.error=i[1];break;case R.CLAIMS_PREFIX:n.claims=t?i[1]:(0,m.G)(i[1])}}return n},O=(e,t)=>{var n;const i=[];return(null==t?void 0:t.correlation)?(i.push("options:true"),t.silent=null===(n=t.silent)||void 0===n||n):(i.push("options:false"),t={silent:!0,correlation:{id:(0,k.pW)(),scenarioName:v.RG.AuthWebLogin,source:e}}),[t,i]},x=(e,t,n)=>{const i=(e=>e&&"string"==typeof e?{claim:e}:e||{})(n),[a,o]=(0,S.OU)({options:i,source:e,scenarioName:v.RG.AcquireToken,subContext:t,startWithoutScenario:!0});return[i,a,o]},L=(e,t)=>({id:`dummy-user-${e.tenantId}`,userName:t.userName,profile:{acct:1,altsecid:"",amr:[],aud:"",exp:-1,email:t.profile.email,family_name:"",given_name:t.profile.given_name,iat:1,iss:"",name:t.profile.name,preferred_username:t.userName||t.profile.email,nbf:-1,nonce:"",oid:`dummy-user-${e.tenantId}`,onprem_sid:"",sub:"",tid:e.tenantId,unique_name:t.profile.unique_name,upn:t.profile.email,ver:"1.0",isHomeAccount:!1},homeAccountId:t.homeAccountId||t.id,isAuthenticated:!1,type:e.tenantId===h.e0?r.Ch.MsaLife:r.Ch.Aad,cloud:U(e.cloudType||""),role:r.w4.Guest}),U=e=>{switch(e){case"WW":case"GCC":return r.G7.prod;case"DOD":return r.G7.dod;case"GCCHigh":return r.G7.gcch;default:return r.G7.prod}},B=(e,t,n)=>{if(void 0===e||void 0===t)return l.Zw.Skype;const{skypeTokenMigrationServiceInfo:i}=t.get(d.J.Auth),a=null==i?void 0:i.find((t=>(null==t?void 0:t.source)===e));if(void 0===a)return l.Zw.Skype;null==n||n.addEventData([`source: ${null==a?void 0:a.source}, isOnboarded: ${null==a?void 0:a.isOnboarded},type: ${null==a?void 0:a.tokenType}`]);const o=null==a?void 0:a.isOnboarded,r=null==a?void 0:a.tokenType;return o&&r?r:l.Zw.Skype}},713153:(e,t,n)=>{"use strict";n.d(t,{R:()=>i,u:()=>s});var i,a=n(843149),o=n(118824),r=n(892891);!function(e){e.Active="Active",e.Inactive="Inactive",e.LongInactive="LongInactive"}(i||(i={}));class s{constructor(e,t,n,o,l){this._host=e,this._activityCallback=o,this._trackDocumentVisibility=l,this.msUntilIdle=s.MsUntilIdleDefault,this.msUntilLongIdle=s.msUntilLongIdleDefault,this.handleMonitoredWindowEvent=(0,r.debounce)((()=>{this._idleStateBehaviorSubject.value!==i.Active&&this._idleStateBehaviorSubject.next(i.Active),this.restartIdleTimer(),this._activityCallback&&this._activityCallback()}),s.msDelayTime,{maxWait:this.msUntilIdle-s.msDelayTime*s.msMaxWaitTimeFactor,leading:!0}),this.handleIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(i.Inactive),this._idleCountdownTimer=void 0,this.restartLongIdleTimer()},this.handleLongIdleTimerTimeout=()=>{this._idleStateBehaviorSubject.next(i.LongInactive),this._longIdleCountdownTimer=void 0},this.handleDocumentVisibilityChange=()=>{this._host.document.hidden?this._idleStateBehaviorSubject.next(i.Inactive):(this._idleStateBehaviorSubject.next(i.Active),this.restartIdleTimer())},this._idleStateBehaviorSubject=new a.X(i.Inactive),n&&this.setSettings(n),this.restartLongIdleTimer(),s.monitoredWindowEvents.forEach((t=>{e.addEventListener(t,this.handleMonitoredWindowEvent)})),l&&e.addEventListener("visibilitychange",this.handleDocumentVisibilityChange),t.newLogger("IdleTracker").log("Initialized")}observe(){return this._idleStateBehaviorSubject.asObservable()}getState(){return this._idleStateBehaviorSubject.value}createChildWindowIdleTracker(e,t,n){const i=this._activityCallback||this.handleMonitoredWindowEvent;return new s(e,t,n,i)}restartIdleTimer(){this.stopIdleTimers(),this._idleCountdownTimer=this._host.setTimeout(this.handleIdleTimerTimeout,this.msUntilIdle)}dispose(){this.stopIdleTimers(),s.monitoredWindowEvents.forEach((e=>{this._host.removeEventListener(e,this.handleMonitoredWindowEvent)})),this._trackDocumentVisibility&&this._host.removeEventListener("visibilitychange",this.handleDocumentVisibilityChange),this._idleStateBehaviorSubject.complete(),this.handleMonitoredWindowEvent.cancel()}setSettings(e){const{appIdleTimeoutInMs:t,appLongIdleTimeoutInMs:n}=e.get(o.J.Core);this.msUntilIdle=t||s.MsUntilIdleDefault,this.msUntilLongIdle=n||s.msUntilLongIdleDefault}restartLongIdleTimer(){void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0),this._longIdleCountdownTimer=this._host.setTimeout(this.handleLongIdleTimerTimeout,this.msUntilLongIdle)}stopIdleTimers(){void 0!==this._idleCountdownTimer&&(this._host.clearTimeout(this._idleCountdownTimer),this._idleCountdownTimer=void 0),void 0!==this._longIdleCountdownTimer&&(this._host.clearTimeout(this._longIdleCountdownTimer),this._longIdleCountdownTimer=void 0)}}s.monitoredWindowEvents=["scroll","DOMMouseScroll","mousewheel","touchstart","touchmove","mousemove","keydown"],s.msDelayTime=1e3,s.msMaxWaitTimeFactor=30,s.msUntilLongIdleDefault=12e5,s.MsUntilIdleDefault=3e5},84574:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m,g,p,v,h,f,y,k,S,b,C,w,N,T,I,E,A,_,D,F,M,R,P,O,x,L,U,B,j,W,V,H,$,z,G,q,Q,J,Y,K,Z,X,ee,te,ne,ie,ae,oe,re,se,le,de,ce,ue,me,ge,pe,ve,he,fe,ye,ke,Se,be,Ce,we,Ne,Te;n.d(t,{zH:()=>i,Zw:()=>o,jE:()=>r,Yl:()=>s,BI:()=>l,m6:()=>d,wx:()=>m,KX:()=>S,Fs:()=>b,wk:()=>C,mD:()=>w,vk:()=>N,yX:()=>E,Kk:()=>_,td:()=>D,Io:()=>P,Ry:()=>O,IC:()=>x,Z8:()=>L,FB:()=>j,EM:()=>H,Pn:()=>$,KN:()=>z,gG:()=>G,aG:()=>Q,TB:()=>K,C7:()=>Z,in:()=>te,B6:()=>ne,m1:()=>ie,vG:()=>ae,zO:()=>oe,EQ:()=>se,i:()=>ue,Gn:()=>ge,UF:()=>fe,Aq:()=>ye,$w:()=>ke,PG:()=>Se,oj:()=>be,Hj:()=>Ce,XI:()=>we,cJ:()=>Ne}),function(e){e.Adult="Adult",e.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired",e.MinorWithMsaParentalConsent="MinorWithMsaParentalConsent",e.MinorWithoutMsaParentalConsent="MinorWithoutMsaParentalConsent",e.NotAdult="NotAdult"}(i||(i={})),function(e){e.Msa="Msa",e.Aad="Aad"}(a||(a={})),function(e){e.Skype="Skype",e.AAD="AAD",e.CAE="CAE"}(o||(o={})),function(e){e.Discoverable="Discoverable",e.Undiscoverable="Undiscoverable",e.Unknown="Unknown"}(r||(r={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled",e.ForceDisabled="ForceDisabled",e.ForceEnabled="ForceEnabled"}(s||(s={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(l||(l={})),function(e){e.EveryoneInCompany="EveryoneInCompany",e.Everyone="Everyone"}(d||(d={})),function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Local="Local",e.Microsoft="Microsoft",e.Preview="Preview",e.Production="Production",e.Staging="Staging",e.SyntheticTraffic="SyntheticTraffic"}(c||(c={})),function(e){e.cancel="cancel",e.fail="fail",e.incomplete="incomplete",e.success="success"}(u||(u={})),function(e){e.PowerPoint="PowerPoint",e.Excel="Excel",e.Word="Word",e.Visio="Visio",e.OneNote="OneNote",e.Whiteboard="Whiteboard",e.Undefined="Undefined"}(m||(m={})),function(e){e.Present="Present",e.Collaboration="Collaboration",e.None="None"}(g||(g={})),function(e){e.NoPermission="NoPermission",e.SingleStepPermission="SingleStepPermission",e.MultiStepPermission="MultiStepPermission",e.None="None"}(p||(p={})),function(e){e.AlwaysEnabled="AlwaysEnabled",e.AlwaysDisabled="AlwaysDisabled",e.UserOverride="UserOverride"}(v||(v={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.UserOverride="UserOverride"}(h||(h={})),function(e){e.DisabledUserOverride="DisabledUserOverride",e.Disabled="Disabled"}(f||(f={})),function(e){e.DisabledUserOverride="DisabledUserOverride",e.Disabled="Disabled"}(y||(y={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(k||(k={})),function(e){e.horizontal="horizontal",e.horizontalEnd="horizontalEnd",e.overflow="overflow",e.indicators="indicators"}(S||(S={})),function(e){e.default="default",e.button="button"}(b||(b={})),function(e){e.Compact="Compact",e.Inline="Inline",e.Split="Split",e.Stacked="Stacked"}(C||(C={})),function(e){e.None="None",e.FreeTask="FreeTask",e.Idle="Idle"}(w||(w={})),function(e){e.AlwaysKeep="AlwaysKeep",e.MergeWithNext="MergeWithNext",e.MergeWithPrevious="MergeWithPrevious"}(N||(N={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(T||(T={})),function(e){e.NotificationOnly="NotificationOnly",e.ConferenceMuted="ConferenceMuted",e.ConferenceUnMuted="ConferenceUnMuted"}(I||(I={})),function(e){e.v0="v0",e.v1="v1",e.international="international"}(E||(E={})),function(e){e.Disabled="Disabled",e.SingleApplication="SingleApplication",e.EntireScreen="EntireScreen"}(A||(A={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.EnabledExceptAnonymous="EnabledExceptAnonymous"}(_||(_={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(D||(D={})),function(e){e.Unknown="Unknown",e.Online="Online",e.OnPrem="OnPrem"}(F||(F={})),function(e){e.Regular="Regular",e.CallQueue="CallQueue",e.CallGroup="CallGroup",e.Delegate="Delegate",e.MeetingStartedReminder="MeetingStartedReminder"}(M||(M={})),function(e){e.Ring="Ring",e.Bop="Bop",e.Bounce="Bounce",e.Bubbles="Bubbles",e.DripDrop="DripDrop",e.Eureka="Eureka",e.Flutter="Flutter",e.HighScore="HighScore",e.NextLevel="NextLevel",e.Plink="Plink",e.RingRing="RingRing",e.Ripple="Ripple",e.Spacetime="Spacetime",e.WishGranted="WishGranted",e.Wobble="Wobble",e.BubblesLoud="BubblesLoud",e.Remix="Remix"}(R||(R={})),function(e){e.Immediate="Immediate",e.Simultaneous="Simultaneous",e.Unanswered="Unanswered"}(P||(P={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing",e.Group="Group"}(O||(O={})),function(e){e.Ring="Ring",e.Mute="Mute"}(x||(x={})),function(e){e.BackgroundEffect="BackgroundEffect",e.BackgroundAPL="BackgroundAPL"}(L||(L={})),function(e){e.Cameo="Cameo",e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(U||(U={})),function(e){e.Disabled="Disabled",e.ReceiveOnly="ReceiveOnly",e.SendOnly="SendOnly",e.Inactive="Inactive",e.Bidirectional="Bidirectional"}(B||(B={})),function(e){e.fail="fail",e.incomplete="incomplete",e.cancel="cancel"}(j||(j={})),function(e){e.Grid="Grid",e.SpeakerView="SpeakerView",e.MixedGridView="MixedGridView"}(W||(W={})),function(e){e.sendMessage="sendMessage"}(V||(V={})),function(e){e.Mac="Mac",e.Windows="Windows"}(H||(H={})),function(e){e.ams="ams",e.amsV2="amsV2",e.appMonetizationService="appMonetizationService",e.appService="appService",e.appsSuggestionService="appsSuggestionService",e.calling_registrarUrl="calling_registrarUrl",e.calling_trouterUrl="calling_trouterUrl",e.chatService="chatService",e.chatServiceAfd="chatServiceAfd",e.chatSvcAggAfd="chatSvcAggAfd",e.cmdArtifactsService="cmdArtifactsService",e.consumerLicenses="consumerLicenses",e.groupsServiceV2="groupsServiceV2",e.mcpService="mcpService",e.middleTier="middleTier",e.mtImageService="mtImageService",e.powerPointStateService="powerPointStateService",e.search="search",e.teamsAndChannelsProvisioningService="teamsAndChannelsProvisioningService",e.teamsEventsIntegration="teamsEventsIntegration",e.teamsPushServiceAfd="teamsPushServiceAfd",e.unifiedPresence="unifiedPresence",e.urlp="urlp",e.urlpV2="urlpV2",e.userProfileService="userProfileService",e.virtualEventsService="virtualEventsService",e.userIntelligenceService="userIntelligenceService"}($||($={})),function(e){e.UserChoice="UserChoice",e.AdminDisabled="AdminDisabled",e.MicrosoftChoice="MicrosoftChoice"}(z||(z={})),function(e){e.Disabled="Disabled",e.DryRun="DryRun",e.DryRunQuiet="DryRunQuiet",e.Enabled="Enabled",e.EnabledQuiet="EnabledQuiet"}(G||(G={})),function(e){e.None="None",e.Error="Error",e.Warn="Warn",e.Info="Info",e.Debug="Debug",e.Verbose="Verbose",e.Max="Max"}(q||(q={})),function(e){e.team="team",e.personal="personal",e.groupChat="groupChat",e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat"}(Q||(Q={})),function(e){e.query="query",e.action="action",e.Query="Query",e.Action="Action"}(J||(J={})),function(e){e.Rating="Rating",e.Verbatim="Verbatim"}(Y||(Y={})),function(e){e.Petrol="Petrol",e.ODS="ODS"}(K||(K={})),function(e){e.Legacy="Legacy",e.Graph="Graph",e.Vroom="Vroom"}(Z||(Z={})),function(e){e.Osearch="Osearch",e.AllFiles="AllFiles"}(X||(X={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.EnabledUserOverride="EnabledUserOverride",e.DisabledUserOverride="DisabledUserOverride"}(ee||(ee={})),function(e){e.Full="Full",e.Limited="Limited",e.Restricted="Restricted"}(te||(te={})),function(e){e.Everyone="Everyone",e.None="None",e.UserPreference="UserPreference"}(ne||(ne={})),function(e){e.Strict="Strict",e.Moderate="Moderate",e.NoRestriction="NoRestriction"}(ie||(ie={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(ae||(ae={})),function(e){e.Chat="Chat",e.FlyoutInlineChat="FlyoutInlineChat",e.ChannelPost="ChannelPost",e.ChannelReply="ChannelReply",e.DiscoverSurfacePost="DiscoverSurfacePost"}(oe||(oe={})),function(e){e.Staging="Staging",e.Dogfood="Dogfood",e.Prod="Prod"}(re||(re={})),function(e){e.fixedByHost="fixedByHost",e.grow="grow",e.growHeight="growHeight"}(se||(se={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(le||(le={})),function(e){e.small="small",e.medium="medium",e.large="large"}(de||(de={})),function(e){e.Discoverable="Discoverable",e.Undiscoverable="Undiscoverable",e.Unknown="Unknown"}(ce||(ce={})),function(e){e.bubble="bubble",e.flat="flat"}(ue||(ue={})),function(e){e.df="df",e.msit="msit"}(me||(me={})),function(e){e.inTenantResults="inTenantResults",e.federatedAndBotResults="federatedAndBotResults",e.teamTagResults="teamTagResults",e.groupChatResults="groupChatResults",e.pstnResults="pstnResults"}(ge||(ge={})),function(e){e.Disabled="Disabled",e.EnabledTeamOwner="EnabledTeamOwner",e.EnabledTeamOwnerMember="EnabledTeamOwnerMember"}(pe||(pe={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(ve||(ve={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(he||(he={})),function(e){e.Clean="Clean",e.UpgradeBlocking="UpgradeBlocking",e.UpgradeNonBlocking="UpgradeNonBlocking",e.Warm="Warm"}(fe||(fe={})),function(e){e.Edge="Edge",e.Safari="Safari",e.Chrome="Chrome",e.Firefox="Firefox",e.Electron="Electron",e.Unknown="Unknown"}(ye||(ye={})),function(e){e.None="None",e.CitrixXenDesktop="CitrixXenDesktop",e.CitrixXenApp="CitrixXenApp",e.VMWare="VMWare",e.WVD="WVD"}(ke||(ke={})),function(e){e.Web="Web",e.Desktop="Desktop",e.Rigel="Rigel",e.SurfaceHub="SurfaceHub"}(Se||(Se={})),function(e){e.Unknown="Unknown",e.Teacher="Teacher",e.Student="Student",e.Anonymous="Anonymous"}(be||(be={})),function(e){e.Everyone="Everyone",e.EveryoneInCompanyExcludingGuests="EveryoneInCompanyExcludingGuests"}(Ce||(Ce={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(we||(we={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(Ne||(Ne={})),function(e){e.SingleChoice="SingleChoice",e.MultiChoice="MultiChoice",e.SingleLineText="SingleLineText",e.MultiLineText="MultiLineText"}(Te||(Te={}))},464776:(e,t,n)=>{"use strict";var i,a;n.d(t,{t:()=>i,Y:()=>a}),function(e){e.Compose="Compose",e.MessagePane="MessagePane",e.DeeplinkedMessage="DeeplinkedMessage",e.DoNotMove="DoNotMove"}(i||(i={})),function(e){e.LeftRailSelectedItem="LeftRailSelectedItem"}(a||(a={}))},808189:(e,t,n)=>{"use strict";n.d(t,{S:()=>c});var i=n(231191),a=n(395816);const{OverlayThinHorizontalBar:o,PartialOverlay:r,ThinHorizontalBar:s,TitleBar:l,VerticalBar:d}=a.OQr,c=(0,i.__rest)(a.OQr,["OverlayThinHorizontalBar","PartialOverlay","ThinHorizontalBar","TitleBar","VerticalBar"])},87412:(e,t,n)=>{"use strict";var i;n.d(t,{hO:()=>i,K$:()=>a,v4:()=>o,F_:()=>r,jq:()=>s,QI:()=>l}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={}));const a="https://api.spaces.skype.com",o="ForceFallbackToWebAuth",r="ForceReloadIfSkypeAuthFail";var s,l;!function(e){e.AADReconnecting="AADReconnecting",e.InteractionRequired="InteractionRequired",e.SkypeReconnecting="SkypeReconnecting",e.Up="Up"}(s||(s={})),function(e){e.Failure="Failure",e.InteractionRequired="InteractionRequired",e.Success="Success",e.Unknown="Unknown"}(l||(l={}))},148585:(e,t,n)=>{"use strict";var i;n.d(t,{l:()=>i,Q:()=>a}),function(e){e[e.UNKNOWN=-1]="UNKNOWN",e[e.ONLINE=1]="ONLINE",e[e.OFFLINE=0]="OFFLINE"}(i||(i={}));const a=["ChatSync","Presence","Files","OneNote","Groups","Video","MasterTab","IndexDb","AdalTokens","AdalLogin","AdalReauth","SkypeTokens","SkypeLicense","SupportedBrowser","MSAGuestLicense","AppSession","CSAStartup"]},662802:(e,t,n)=>{"use strict";n.d(t,{QC:()=>i,_1:()=>a,fl:()=>o});const i="cdl-worker-startup-status",a="cdl-worker-verbose-log",o="cdl-worker-aggregated-user-data"},154923:(e,t,n)=>{"use strict";var i;n.d(t,{B:()=>i}),function(e){e.Abandoned="Abandoned",e.AfterOnCommandReceived="AfterOnCommandReceived",e.AfterOnEventReceived="AfterOnEventReceived",e.AlreadyFocused="AlreadyFocused",e.ApplicationHookReceivedCommand="ApplicationHookReceivedCommand",e.ApplicationHookContinuedCommand="ApplicationHookContinuedCommand",e.BeforeOnCommandReceived="BeforeOnCommandReceived",e.BeforeOnEventReceived="BeforeOnEventReceived",e.Blanked="Blanked",e.ChunkLoadStarted="ChunkLoadStarted",e.ChunkLoadSucceeded="ChunkLoadSucceeded",e.Close="Close",e.CommandAfterGetAppViewEntitiesSucceeded="CommandAfterGetAppViewEntitiesSucceeded",e.CommandBeforeGetAppViewEntities="CommandBeforeGetAppViewEntities",e.CommandHandledByOnCommandReceived="CommandHandledByOnCommandReceived",e.CommandHandledPriorToResolution="CommandHandledPriorToResolution",e.CommandMetaDataAdded="CommandMetaDataAdded",e.CommandReceived="CommandReceived",e.CommandReportingTimedOut="CommandReportingTimedOut",e.CommandResolutionStarted="CommandResolutionStarted",e.CommandStart="CommandStart",e.DeeplinkReceived="DeeplinkReceived",e.DeeplinkParsed="DeeplinkParsed",e.DelegatedCommandReceived="DelegatedCommandReceived",e.EventBubbled="EventBubbled",e.EventHandled="EventHandled",e.Hidden="Hidden",e.IntentReceived="IntentReceived",e.IntentTransferredCrossCloud="IntentTransferredCrossCloud",e.OnBeforeIntentAuthenticatedStarted="OnBeforeIntentAuthenticatedStarted",e.OnBeforeIntentAuthenticatedCompleted="OnBeforeIntentAuthenticatedCompleted",e.WaitForUserContextStarted="WaitForUserContextStarted",e.WaitForUserContextCompleted="WaitForUserContextCompleted",e.OnAfterIntentAuthenticatedStarted="OnAfterIntentAuthenticatedStarted",e.OnAfterIntentAuthenticatedCompleted="OnAfterIntentAuthenticatedCompleted",e.IntentHookStarted="IntentHookStarted",e.IntentHookResolved="IntentHookResolved",e.IntentHookRejected="IntentHookRejected",e.IntentHookCompleted="IntentCompleted",e.IntentExecuted="IntentExecuted",e.Failure="Failure",e.Focus="Focus",e.Incomplete="Incomplete",e.LayoutRendered="LayoutRendered",e.LayoutRenderUpdated="LayoutRenderUpdated",e.NavigationCommandStart="NavigationCommandStart",e.NotHandled="NotHandled",e.Rendered="Rendered",e.RenderStarted="RenderStarted",e.ScenarioEventDataAppended="ScenarioEventDataAppended",e.ScenarioMarked="ScenarioMarked",e.SlotPhasedRenderingTimedOut="SlotPhasedRenderingTimedOut",e.Toggled="Toggled",e.UnmountStarted="UnmountStarted",e.WindowCreated="WindowCreated",e.WindowUpdated="WindowUpdated",e.WindowNotUpdated="WindowNotUpdated"}(i||(i={}))},546889:(e,t,n)=>{"use strict";var i;n.d(t,{y:()=>i}),function(e){e.AlreadyRendered="AlreadyRendered",e.CallHistoryContainerError="CallHistoryContainerError",e.CommandGetAppViewEntitiesFailure="CommandGetAppViewEntitiesFailure",e.ChannelDashboardHeader="ChannelDashboardHeader",e.ChannelDashboardView="ChannelDashboardView",e.ChannelHeader="ChannelHeader",e.ChannelHeaderBoundaryError="ChannelHeaderBoundaryError",e.CommunitiesHeader="CommunitiesHeader",e.ChannelHeaderTitle="ChannelHeaderTitle",e.ChannelHeaderTitleBoundaryError="ChannelHeaderTitleBoundaryError",e.ChannelListContainerError="ChannelListContainerError",e.CreateWindowError="CreateWindowError",e.CreateUserContextError="CreateUserContextError",e.DeeplinkIntentParseFailure="DeeplinkIntentParseFailure",e.DeeplinkExecutionTerminated="DeeplinkExecutionTerminated",e.DeeplinkLaunchCrossCloudError="DeeplinkLaunchCrossCloudError",e.DelegatedCommandError="DelegatedCommandError",e.EmptyWindowError="EmptyWindowError",e.ErrorAppError="ErrorAppError",e.ErrorBoundaryError="ErrorBoundaryError",e.EventError="EventError",e.GetCommandScenarioNameHookFailed="GetCommandScenarioNameHookFailed",e.GuardiansError="GuardiansError",e.MessagePaneBoundaryError="MessagePaneBoundaryError",e.NetworkOffline="NetworkOffline",e.OnBeforeIntentAuthenticatedReturnedUndefined="OnBeforeIntentAuthenticatedReturnedUndefined",e.OnBeforeIntentAuthenticatedRejected="OnBeforeIntentAuthenticatedRejected",e.OnAfterIntentAuthenticatedReturnedUndefined="OnAfterIntentAuthenticatedReturnedUndefined",e.OnAfterIntentAuthenticatedRejected="OnAfterIntentAuthenticatedRejected",e.OnBeforeCommandHandledRejected="OnBeforeCommandHandledRejected",e.PlatformErrorBoundaryError="PlatformErrorBoundaryError",e.RenderingError="RenderingError",e.SlotPhasedRenderingTimedOut="SlotPhasedRenderingTimedOut",e.TimeoutRunningApp="TimeoutRunningApp",e.TimeoutRunningCore="TimeoutRunningCore",e.UnknownCommandError="UnknownCommandError",e.UserContextMismatch="UserContextMismatch",e.WindowCacheFailedToUpdate="WindowCacheFailedToUpdate",e.WindowCloseRunningApp="WindowCloseRunningApp",e.WindowCloseRunningCore="WindowCloseRunningCore"}(i||(i={}))},815053:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{yU:()=>i,FV:()=>a,c4:()=>o}),function(e){e.ActiveEntitiesResolved="active_entities_resolved",e.ActiveEntitiesDestroyed="active_entities_destroyed",e.AppSelectionChanged="app_selection_changed_resolved",e.ExperienceIdleStateChanged="experience_idle_state_changed",e.InitialDeeplinkResolved="initial_deep_link_resolved",e.NavigationIntentExecuted="navigation_intent_executed",e.UserAuthenticated="user_authenticated",e.UserConsentedToConsumeResources="user_consented_to_consume_resources"}(i||(i={})),function(e){e.LayoutRenderComplete="layout_render_complete",e.LayoutRenderCancelled="layout_render_cancelled",e.WindowStateChange="window_state_change",e.WindowOptionsChange="window_options_change"}(a||(a={})),function(e){e.Started="app_started",e.Initialized="app_initialized",e.ExperienceWarm="experience_warm",e.UserWarm="user_warm",e.ExperienceIdle="experience_idle",e.WindowWarm="window_warm"}(o||(o={}))},358272:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{pk:()=>i,kZ:()=>a,UV:()=>o,V9:()=>r}),function(e){e.Initializing="Initializing",e.Unrecoverable="Unrecoverable",e.LongInactive="LongInactive",e.Inactive="Inactive",e.Active="Active",e.VeryActive="VeryActive"}(i||(i={})),function(e){e.Minimized="Minimized",e.Background="Background",e.InFocus="InFocus"}(a||(a={})),function(e){e.Locked="Locked",e.Active="Active"}(o||(o={})),function(e){e.Suspending="Suspending",e.Resumed="Resumed"}(r||(r={}))},953672:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{RE:()=>i,v0:()=>a,tA:()=>o}),function(e){e[e.Legacy=1]="Legacy",e[e.Store=2]="Store",e[e.InContextGalleryDialogFromChannel=3]="InContextGalleryDialogFromChannel",e[e.InContextGalleryDialogFromGroupChat=4]="InContextGalleryDialogFromGroupChat",e[e.InContextGalleryDialogMoreAppsFromChannel=5]="InContextGalleryDialogMoreAppsFromChannel",e[e.InContextGalleryDialogMoreAppsFromGroupChat=6]="InContextGalleryDialogMoreAppsFromGroupChat",e[e.Flyout=7]="Flyout",e[e.AppsManagementTabView=8]="AppsManagementTabView",e[e.GroupChatAppsManagementView=9]="GroupChatAppsManagementView",e[e.MoreAppFromSamePublisher=10]="MoreAppFromSamePublisher",e[e.MessagingExtensionFlyoutFromChannel=11]="MessagingExtensionFlyoutFromChannel",e[e.MessagingExtensionFlyoutFromChat=12]="MessagingExtensionFlyoutFromChat",e[e.StoreSideload=13]="StoreSideload",e[e.DeepLink=14]="DeepLink",e[e.ConnectorManagementDialog=15]="ConnectorManagementDialog",e[e.AppsManagementTabUpgrade=16]="AppsManagementTabUpgrade",e[e.GroupChatAppsManagementUpgrade=17]="GroupChatAppsManagementUpgrade",e[e.AppsList=18]="AppsList",e[e.TabSdkSideload=19]="TabSdkSideload",e[e.AppsManagementTabFromTeam=20]="AppsManagementTabFromTeam",e[e.AppsManagementTabFromGroupChat=21]="AppsManagementTabFromGroupChat",e[e.AppSuggestionInEmptyChannel=22]="AppSuggestionInEmptyChannel",e[e.MeetingFromGroupchat=23]="MeetingFromGroupchat",e[e.MeetingFromTeam=24]="MeetingFromTeam",e[e.MessagingExtensionFeaturedItem=25]="MessagingExtensionFeaturedItem",e[e.NewMessageUpgrade=26]="NewMessageUpgrade",e[e.AtMentionDirectInstallationFromTeam=27]="AtMentionDirectInstallationFromTeam",e[e.AtMentionDirectInstallationFromGroupChat=28]="AtMentionDirectInstallationFromGroupChat",e[e.PersonalAppBannerUpgrade=29]="PersonalAppBannerUpgrade",e[e.AppBarNew=30]="AppBarNew",e[e.AppsListNew=31]="AppsListNew",e[e.MessagingExtensionFlyoutV2=34]="MessagingExtensionFlyoutV2",e[e.AppsManagementTabFromTeamSideload=35]="AppsManagementTabFromTeamSideload",e[e.AppsManagementTabFromGroupChatSideload=36]="AppsManagementTabFromGroupChatSideload",e[e.PersonalFlyoutAppSearch=37]="PersonalFlyoutAppSearch",e[e.PersonalAppAbout=38]="PersonalAppAbout",e[e.PersonalFlyoutAppSuggestions=39]="PersonalFlyoutAppSuggestions",e[e.ChannelInfoPaneAppWidgetView=40]="ChannelInfoPaneAppWidgetView",e[e.ChannelInfoPaneAppWidgetUpgrade=41]="ChannelInfoPaneAppWidgetUpgrade",e[e.MoreAppsUsedTogether=42]="MoreAppsUsedTogether",e[e.PowerBar=43]="PowerBar",e[e.StageDeepLink=44]="StageDeepLink",e[e.ManageAppsInstalledApp=45]="ManageAppsInstalledApp",e[e.ManageAppsInstalledAppUpgrade=46]="ManageAppsInstalledAppUpgrade",e[e.LobNotifications=47]="LobNotifications",e[e.OnboardingNotifications=48]="OnboardingNotifications",e[e.StoreEditorialArticles=49]="StoreEditorialArticles",e[e.DiscoverAppsNotifications=50]="DiscoverAppsNotifications",e[e.StoreWorkflows=51]="StoreWorkflows",e[e.JITInstallFromPersonalFlyout=52]="JITInstallFromPersonalFlyout",e[e.AutoInstallAppsNotification=53]="AutoInstallAppsNotification",e[e.MessageExtensionFlyout=100]="MessageExtensionFlyout",e[e.Meeting=101]="Meeting",e[e.JITInstallCardAction=102]="JITInstallCardAction",e[e.CardHeaderInstallAction=103]="CardHeaderInstallAction",e[e.ScenePicker=104]="ScenePicker",e[e.MeetingFromChannel=105]="MeetingFromChannel",e[e.Url=106]="Url",e[e.JITInstallConsentOnCard=107]="JITInstallConsentOnCard",e[e.StoreFREDialog=108]="StoreFREDialog",e[e.AdaptiveCard=109]="AdaptiveCard",e[e.MessageExtensionFlyoutSuggestedCollection=110]="MessageExtensionFlyoutSuggestedCollection",e[e.ProactiveMessageForBots=111]="ProactiveMessageForBots",e[e.JITInstallTaskModule=112]="JITInstallTaskModule",e[e.ExposeBotActions=113]="ExposeBotActions",e[e.MessageExtensionCard=114]="MessageExtensionCard",e[e.MeetingFromDeepLink=115]="MeetingFromDeepLink",e[e.UrlPersonalUpgrade=116]="UrlPersonalUpgrade",e[e.MeetingAppsFlyout=117]="MeetingAppsFlyout",e[e.MeetingAppsFlyoutFromChannel=118]="MeetingAppsFlyoutFromChannel",e[e.ReactMessageExtensionFlyoutFromChannel=119]="ReactMessageExtensionFlyoutFromChannel",e[e.ShareFormDialog=120]="ShareFormDialog",e[e.PlatformAppConsentDialog=121]="PlatformAppConsentDialog",e[e.PlatformTabButtonGroupChat=122]="PlatformTabButtonGroupChat",e[e.PlatformTabButtonTeam=123]="PlatformTabButtonTeam",e[e.InContextStorePersonal=150]="InContextStorePersonal",e[e.MEInContextStoreGroupChat=151]="MEInContextStoreGroupChat",e[e.MEInContextStoreTeam=152]="MEInContextStoreTeam",e[e.TabsInContextStoreGroupChat=153]="TabsInContextStoreGroupChat",e[e.TabsInContextStoreTeam=154]="TabsInContextStoreTeam",e[e.BotsInContextStoreGroupChat=155]="BotsInContextStoreGroupChat",e[e.BotsInContextStoreTeam=156]="BotsInContextStoreTeam",e[e.PlatformAppScopeInstall=157]="PlatformAppScopeInstall"}(i||(i={})),function(e){e.AppDetails="AppDetails",e.TCPicker="TCPicker",e.ViewReviews="ViewReviews",e.PostReview="PostReview",e.ReportReview="ReportReview"}(a||(a={})),function(e){e.InContext="InContext",e.Update="Update",e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meeting="Meeting",e.RequestAccess="RequestAccess"}(o||(o={}))},338316:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m;n.d(t,{gV:()=>i,XY:()=>a,Jc:()=>o}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig"}(i||(i={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}(a||(a={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(o||(o={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox"}(r||(r={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent"}(s||(s={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook"}(l||(l={})),function(e){e.team="team",e.channel="channel"}(d||(d={})),function(e){e.html="html",e.text="text"}(c||(c={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry"}(u||(u={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser"}(m||(m={}))},118115:(e,t,n)=>{"use strict";var i;n.d(t,{p:()=>i}),function(e){e[e.chat=0]="chat",e[e.channel=1]="channel",e[e.tab=2]="tab"}(i||(i={}))},727765:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m,g,p,v;n.d(t,{Jm:()=>i,WQ:()=>a,DL:()=>r,IC:()=>d,KR:()=>c,WR:()=>u,pm:()=>m,fX:()=>g,LQ:()=>p,Px:()=>v}),function(e){e.Voicemail="voicemail",e.MissedCalls="missed-calls"}(i||(i={})),function(e){e.TranscriptionUFD="TranscriptionUFD",e.CatchUpUFD="CatchUpUFD",e.WrapUpUFD="WrapUpUFD",e.UBAR="UBAR",e.Recap="Recap",e.MeetingDetails="MeetingDetails",e.ChatInfoPane="ChatInfoPane",e.ChatInfoPaneLightBackground="ChatInfoPaneLightBackground"}(a||(a={})),function(e){e.Chat="Chat",e.Meeting="Meeting"}(o||(o={})),function(e){e.Invite="Invite",e.Claim="Claim",e.FileShare="FileShare",e.Community="Community",e.PlatformExtension="PlatformExtension"}(r||(r={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(s||(s={})),function(e){e.Outlook="Outlook",e.Google="Google"}(l||(l={})),function(e){e.template="template",e.group="group",e.team="team"}(d||(d={})),function(e){e[e.MessageExtensionsFlyout=0]="MessageExtensionsFlyout",e[e.MeetingAppsFlyout=1]="MeetingAppsFlyout",e[e.ChannelMeetingAppsFlyout=2]="ChannelMeetingAppsFlyout"}(c||(c={})),function(e){e[e.Whiteboard=0]="Whiteboard",e[e.Document=1]="Document",e[e.Video=2]="Video"}(u||(u={})),function(e){e.TeamDeleted="TeamDeleted",e.NoAccessToTeam="NoAccessToTeam",e.TeamNotFound="TeamNotFound",e.ChannelDeleted="ChannelDeleted",e.NoAccessToChannel="NoAccessToChannel",e.ChannelNotFound="ChannelNotFound",e.SomethingWentWrong="SomethingWentWrong"}(m||(m={})),function(e){e.JoinByCode="JoinByCode",e.Dialpad="Dialpad",e.Cortana="Cortana",e.SmartDeviceJoinByCode="SmartDeviceJoinByCode"}(g||(g={})),function(e){e.sideload="sideload",e.staging="staging",e.tenant="tenant"}(p||(p={})),function(e){e[e.AppDetailsDialog=1]="AppDetailsDialog"}(v||(v={}))},729788:(e,t,n)=>{"use strict";n.d(t,{ab:()=>i,Xt:()=>a,fe:()=>o,su:()=>r,oz:()=>s,oq:()=>l,lO:()=>d});const i="com.microsoft.teams.corelayout",a="com.microsoft.teams.entitymoreinfo";var o,r,s,l,d;!function(e){e.show="show",e.showWithoutFocusing="showWithoutFocusing",e.hide="hide",e.toggle="toggle"}(o||(o={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.flow="flow",e.forceFlow="forceFlow",e.new="new",e.extend="extend"}(r||(r={})),function(e){e.organization="organization",e.privacyManageVisibility="privacy_manage_visibility",e.linkedin="linkedin"}(s||(s={})),function(e){e.Cancelled="Cancelled",e.Closed="Closed",e.Confirmed="Confirmed",e.Error="Error",e.Open="Open"}(l||(l={})),function(e){e.minimal="minimal",e.focus="focus",e.standard="standard"}(d||(d={}))},281857:(e,t,n)=>{"use strict";n.d(t,{eT:()=>i,L3:()=>o,B:()=>s,jK:()=>l,w5:()=>d,lX:()=>c,w:()=>u,sM:()=>m,Yg:()=>g,f_:()=>p,ew:()=>v,QU:()=>h,ZW:()=>f,eL:()=>k,bA:()=>S});var i,a,o,r=n(661564);!function(e){e[e.Presenting=0]="Presenting",e[e.InCall=1]="InCall",e[e.InBroadcast=2]="InBroadcast",e[e.Interactive=3]="Interactive",e[e.Inactive=4]="Inactive",e[e.LongInactive=5]="LongInactive",e[e.Disabled=6]="Disabled",e[e.Disconnected=7]="Disconnected",e[e.Offline=8]="Offline",e[e.Uninitialized=9]="Uninitialized"}(i||(i={})),function(e){e.AppLogout="appLogout"}(a||(a={})),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=2]="info",e[e.verbose=3]="verbose"}(o||(o={}));const s={second:1e3,minute:6e4,tenMinutes:6e5};var l,d;!function(e){e.Deserialization="Deserialization",e.Unknown="Unknown",e.Undefined="Undefined",e.TimedOut="TimedOut",e.AlreadyInitialized="AlreadyInitialized",e.NotImplemented="NotImplemented",e.NotPresent="NotPresent",e.ResourceNotFound="ResourceNotFound",e.Unauthorized="Unauthorized",e.ProxyAuthenticationRequired="ProxyAuthenticationRequired",e.UserNotAuthorizedToPerformAppOperationOnGroupChat="UserNotAuthorizedToPerformAppOperationOnGroupChat",e.AlreadyPresent="AlreadyPresent",e.FileLocked="FileLocked",e.SpQuotaReached="SpQuotaReached",e.FailedToLazyLoadService="FailedToLazyLoadService",e.FileAccessDenied="FileAccessDenied",e.FileNameTooLong="FileNameTooLong",e.InvalidAudienceUri="InvalidAudienceUri",e.InvalidResponse="InvalidResponse",e.RemoteOperationFailed="RemoteOperationFailed",e.UnknownRenderer="UnknownRenderer",e.UnknownRequestId="UnknownRequestId",e.UnknownDocumentOperation="UnknownDocumentOperation",e.UrlUndefined="UrlUndefined",e.UserConsentRequired="UserConsentRequired",e.InvalidRequestFormat="InvalidRequestFormat",e.MaxLimitReached="MaxLimitReached",e.NotAFileLink="NotAFileLink",e.ApolloError="ApolloError",e.InvalidInput="InvalidInput",e.ThirdPartyError="ThirdPartyError",e.AlreadyInProgress="AlreadyInProgress",e.NotInitialized="NotInitialized",e.UnhandledRuntimeException="UnhandledRuntimeException",e.Paused="Paused",e.WaitingForResponse="WaitingForResponse",e.PollCreationFailure="PollCreationFailure",e.PollRuntimeFailure="PollRuntimeFailure",e.PreviousFailure="PreviousFailure",e.FeatureNotSupported="FeatureNotSupported",e.IndexDbException="IndexDbException",e.MultipleUsersPresentWithSpecifiedIdentifier="MultipleUsersPresentWithSpecifiedIdentifier",e.FailedToCreate="FailedToCreate",e.FailedToFetch="FailedToFetch",e.FailedToUpdate="FailedToUpdate",e.FailedToGet="FailedToGet",e.FailedToDelete="FailedToDelete",e.FailedToSubscribe="FailedToSubscribe",e.UndefinedGlobalError="UndefinedGlobalError",e.UndefinedWindowError="UndefinedWindowError",e.UnhandledPromiseRejection="UnhandledPromiseRejection",e.UndefinedDependencies="UndefinedDependencies",e.DuplicateFound="DuplicateFound",e.Empty="Empty",e.MissingParameter="MissingParameter",e.MaxCallCountReached="MaxCallCountReached",e.PayloadTooBig="PayloadTooBig",e.BotError="BotError",e.WriteToStoreFailed="WriteToStoreFailed",e.CorruptedSyncState="CorruptedSyncState",e.CorruptedConversation="CorruptedConversation",e.Aborted="Aborted",e.Forbidden="Forbidden",e.WaitToFetchMore="WaitToFetchMore",e.AuthSafariITPBlocked="AuthSafariITPBlocked",e.AuthSafariITPBlockedAlways="AuthSafariITPBlockedAlways",e.ScriptLoadError="ScriptLoadError",e.ScriptEvalError="ScriptEvalError",e.ScriptCodeError="ScriptCodeError",e.CSSLoadError="CSSLoadError",e.Disabled="Disabled",e.AuthPopupWindowClosed="AuthPopupWindowClosed",e.AuthPopupWindowBlocked="AuthPopupWindowBlocked",e.NetworkOffline="NetworkOffline",e.DBCleanupError="DBCleanupError",e.DBUnexpectedClosureError="DBUnexpectedClosureError",e.DBExpectedClosureError="DBExpectedClosureError",e.ComponentLoadError="ComponentLoadError",e.ChunkLoadTimedOut="ChunkLoadTimedOut",e.Throttled="Throttled",e.ServiceUnavailable="ServiceUnavailable",e.ExperienceDisabled="ExperienceDisabled",e.CallingServiceStateQueryError="CallingServiceStateQueryError",e.CallingServiceStateFailed="CallingServiceStateFailed",e.ShadowTokenRevoked="ShadowTokenRevoked",e.ShadowTokenExpired="ShadowTokenExpired",e.ShadowRefreshTokenExpired="ShadowRefreshTokenExpired",e.ShadowMailboxDeleted="ShadowMailboxDeleted",e.TrouterClient="TrouterClient",e.ConnectedAccountNotFound="ConnectedAccountNotFound",e.ErrorParsingQueryParams="ErrorParsingQueryParams",e.InvalidUrl="InvalidUrl",e.HTTPMethodNotSupportedForDownload="HTTPMethodNotSupportedForDownload",e.InvalidDomReference="InvalidDomReference",e.VersionMismatch="VersionMismatch",e.CoreInitFailure="CoreInitFailure",e.ConversationSyncFailure="ConversationSyncFailure",e.CoreServiceMissing="CoreServiceMissing",e.CoreNavigationServicesMissing="CoreNavigationServicesMissing",e.Authentication="Authentication",e.LayoutPhaseStateMachineTimeoutError="LayoutPhaseStateMachineTimeoutError",e.SignInRestrictions="SignInRestrictions",e.UndefinedExternalEntityKey="UndefinedExternalEntityKey",e.InvalidLoggedInUser="InvalidLoggedInUser",e.InvalidOrganizer="InvalidOrganizer",e.PeopleProviderFailure="PeopleProviderFailure",e.MaxTenantWideTeamLimitExceeded="MaxTenantWideTeamLimitExceeded",e.StandupCallingJobError="StandupCallingJobError",e.SetupCallingAppEventsJobError="SetupCallingAppEventsJobError",e.CallingCallsViewCommandError="CallingCallsViewCommandError",e.HandleCallingAppEventError="HandleCallingAppEventError",e.LayoutError="LayoutError",e.TerminalError="TerminalError",e.EmbedClientError="EmbedClientError",e.PolicyCheckFailed="PolicyCheckFailed",e.PolicyMissing="PolicyMissing",e.RejectedByPolicy="RejectedByPolicy",e.GatewayTimeout="GatewayTimeout",e.ChannelRosterSizeExceeded="ChannelRosterSizeExceeded"}(l||(l={})),function(e){e.AddShareUrlOnSendMessage="AddShareUrlOnSendMEssage",e.Apollo="Apollo",e.Authentication="Authentication",e.CmdArtifactsServiceClient="CmdArtifactsServiceClient",e.Commanding="Commanding",e.Core="Core",e.CSAService="CSAService",e.DataLayerClient="DataLayerClient",e.Discover="Discover",e.DiscoverSurfaceService="DiscoverSurfaceService",e.DistributionListService="DistributionListService",e.DriveDetailsService="DriveDetailsService",e.DriveItemShareService="DriveItemShareService",e.EmbedClient="EmbedClient",e.ErrorInRootLayout="ErrorInRootLayout",e.FileDownloadManagerService="FileDownloadManagerService",e.IndexDb="IndexDb",e.ItemDeleteService="ItemDeleteService",e.ItemDetailsService="ItemDetailsService",e.ItemUploadService="ItemUploadService",e.LayoutErrorInSlot="LayoutErrorInSlot",e.LayoutPhaseStateMachine="LayoutPhaseStateMachine",e.LazyComponentRenderer="LazyComponentRenderer",e.LongPoll="LongPoll",e.PeopleTargetingService="PeopleTargetingService",e.PhonelinkSmsService="PhonelinkSmsService",e.PostMessageClient="PostMessageClient",e.RejectHttpError="RejectHttpError",e.RequireStatus="RequireStatus",e.RequireStatusWithSsm="RequireStatusWithSsm",e.ServicesTasks="ServicesTasks",e.SettingsService="SettingsService",e.ShellService="ShellService",e.Tasks="Tasks",e.Theme="Theme",e.Timed="Timed"}(d||(d={}));const c=new Map([[r.qb.BAD_REQUEST,l.InvalidRequestFormat],[r.qb.NOT_AUTHORIZED,l.Unauthorized],[r.qb.FORBIDDEN,l.Forbidden],[r.qb.NOT_FOUND,l.ResourceNotFound],[r.qb.NOT_ALLOWED,l.InvalidRequestFormat],[r.qb.NOT_ACCEPTABLE,l.InvalidRequestFormat],[r.qb.PROXY_AUTHENTICATION_REQUIRED,l.ProxyAuthenticationRequired],[r.qb.CONFLICT,l.InvalidRequestFormat],[r.qb.GONE,l.ResourceNotFound],[r.qb.LENGTH_REQUIRED,l.InvalidRequestFormat],[r.qb.PRECONDITION_FAILED,l.InvalidRequestFormat],[r.qb.REQUEST_ENTITY_TOO_LARGE,l.PayloadTooBig],[r.qb.UNSUPPORTED_MEDIA_TYPE,l.InvalidRequestFormat],[r.qb.REQUEST_RANGE_NOT_SATISFIABLE,l.InvalidRequestFormat],[r.qb.UNPROCESSABLE_ENTITY,l.InvalidRequestFormat],[r.qb.THROTTLED,l.Throttled],[r.qb.SERVER_ERROR,l.RemoteOperationFailed],[r.qb.NOT_IMPLEMENTED,l.FeatureNotSupported],[r.qb.SERVICE_UNAVAILABLE,l.ServiceUnavailable],[r.qb.GATEWAY_TIMEOUT,l.GatewayTimeout],[r.qb.INSUFFICIENT_STORAGE,l.SpQuotaReached],[r.qb.BANDWIDTH_LIMIT_EXCEEDED,l.MaxCallCountReached]]),u="default";var m,g,p;!function(e){e.Initialization="Initialization",e.OnPrimaryUser="OnPrimaryUser",e.OnUserAuthenticated="OnUserAuthenticated",e.OnUserAuthenticated_MTMA="OnUserAuthenticated_MTMA"}(m||(m={})),function(e){e[e.ClearHostSettingsTask=0]="ClearHostSettingsTask",e[e.ConfigOverride=1]="ConfigOverride",e[e.CreateActiveWindowsHistoryTask=2]="CreateActiveWindowsHistoryTask",e[e.CreateAppBarServiceTask=3]="CreateAppBarServiceTask",e[e.CreateAppState=4]="CreateAppState",e[e.CreateAsyncMediaAuth=5]="CreateAsyncMediaAuth",e[e.CreateAuth=6]="CreateAuth",e[e.CreateAuthenticationResources=7]="CreateAuthenticationResources",e[e.CreateAuthMTMA=8]="CreateAuthMTMA",e[e.CreateAuthStateTask=9]="CreateAuthStateTask",e[e.CreateAuthTenants=10]="CreateAuthTenants",e[e.CreateCacheClearing=11]="CreateCacheClearing",e[e.CreateCacheStorageAndCacheManagers=12]="CreateCacheStorageAndCacheManagers",e[e.CreateCDLWorkerAppServiceTask=13]="CreateCDLWorkerAppServiceTask",e[e.CreateCDLWorkerAuthTask=14]="CreateCDLWorkerAuthTask",e[e.CreateCDLWorkerOnAuthUserTask=15]="CreateCDLWorkerOnAuthUserTask",e[e.CreateCDLWorkerOnInitTask=16]="CreateCDLWorkerOnInitTask",e[e.CreateCDLWorkerRegistrarServiceTask=17]="CreateCDLWorkerRegistrarServiceTask",e[e.CreateCDLWorkerTask=18]="CreateCDLWorkerTask",e[e.CreateChangeReporting=19]="CreateChangeReporting",e[e.CreateClientPreferences=20]="CreateClientPreferences",e[e.CreateCommandDelegator=21]="CreateCommandDelegator",e[e.CreateCommandHandler=22]="CreateCommandHandler",e[e.CreateCommandReportingService=23]="CreateCommandReportingService",e[e.CreateCommandResultHooksService=24]="CreateCommandResultHooksService",e[e.CreateCoreSecurityTask=25]="CreateCoreSecurityTask",e[e.CreateCoreShortcutService=26]="CreateCoreShortcutService",e[e.CreateCoreUtilities=27]="CreateCoreUtilities",e[e.CreateDataClient=28]="CreateDataClient",e[e.CreateDeeplinkService=29]="CreateDeeplinkService",e[e.CreateDefaultCacheStorageAndCacheManagers=30]="CreateDefaultCacheStorageAndCacheManagers",e[e.CreateDefaultLocalStorage=31]="CreateDefaultLocalStorage",e[e.CreateDiscovery=32]="CreateDiscovery",e[e.CreateEndpointsManager=33]="CreateEndpointsManager",e[e.CreateEntityCommanding=34]="CreateEntityCommanding",e[e.CreateEventHandler=35]="CreateEventHandler",e[e.CreateExternalCommandListener=36]="CreateExternalCommandListener",e[e.CreateGraphQlOpsService=37]="CreateGraphQlOpsService",e[e.CreateGraphQLStoreStatsReporterService=38]="CreateGraphQLStoreStatsReporterService",e[e.CreateGtmRegistry=39]="CreateGtmRegistry",e[e.CreateHostCommandingListener=40]="CreateHostCommandingListener",e[e.CreateHostCommunication=41]="CreateHostCommunication",e[e.CreateHostedWindowContext=42]="CreateHostedWindowContext",e[e.CreateI18n=43]="CreateI18n",e[e.CreateI18NextWrapper=44]="CreateI18NextWrapper",e[e.CreateImageCaches=45]="CreateImageCaches",e[e.CreateInactiveGC=46]="CreateInactiveGC",e[e.CreateLocalStorage=47]="CreateLocalStorage",e[e.CreateLpc=48]="CreateLpc",e[e.CreateNovaAppBarUpdater=49]="CreateNovaAppBarUpdater",e[e.CreatePlatform=50]="CreatePlatform",e[e.CreateProfiler=51]="CreateProfiler",e[e.CreateReboot=52]="CreateReboot",e[e.CreateRouting=53]="CreateRouting",e[e.CreateSettings=54]="CreateSettings",e[e.CreateSettingsUserContext=55]="CreateSettingsUserContext",e[e.CreateSignalProcessor=56]="CreateSignalProcessor",e[e.CreateTrackUserServiceTask=57]="CreateTrackUserServiceTask",e[e.CreateUserDataClient=58]="CreateUserDataClient",e[e.CreateUserOnContextContext=59]="CreateUserOnContextContext",e[e.CreateUserTelemetryServicesTask=60]="CreateUserTelemetryServicesTask",e[e.CreateWebClientUpdate=61]="CreateWebClientUpdate",e[e.CreateWindow=62]="CreateWindow",e[e.DisableExperience=63]="DisableExperience",e[e.DiscoverUser=64]="DiscoverUser",e[e.EnableHostRouting=65]="EnableHostRouting",e[e.FetchBootstrapData=66]="FetchBootstrapData",e[e.FetchCriticalDynamicImportsTask=67]="FetchCriticalDynamicImportsTask",e[e.FetchHostSettingsTask=68]="FetchHostSettingsTask",e[e.GeneralizedLogActivityTask=69]="GeneralizedLogActivityTask",e[e.InitApiServiceProvider=70]="InitApiServiceProvider",e[e.InitAsyncMediaAuthService=71]="InitAsyncMediaAuthService",e[e.InitATPPolicyTask=72]="InitATPPolicyTask",e[e.InitAuthenticationService=73]="InitAuthenticationService",e[e.InitBrbServiceManagerTask=74]="InitBrbServiceManagerTask",e[e.InitClientAccessAdminPolicyCheck=75]="InitClientAccessAdminPolicyCheck",e[e.InitDesktopEcsContext=76]="InitDesktopEcsContext",e[e.InitEcsClientVersionTask=77]="InitEcsClientVersionTask",e[e.InitExperimentation=78]="InitExperimentation",e[e.InitializePulsarTask=79]="InitializePulsarTask",e[e.InitInterprocessStore=80]="InitInterprocessStore",e[e.InitPreAuthSettingsEcsProvider=81]="InitPreAuthSettingsEcsProvider",e[e.InitSettingsClientFiltersProvider=82]="InitSettingsClientFiltersProvider",e[e.InitSettingsEcsProvider=83]="InitSettingsEcsProvider",e[e.InitSettingsMaglevHostProvider=84]="InitSettingsMaglevHostProvider",e[e.InitSettingsPolicyProvider=85]="InitSettingsPolicyProvider",e[e.InitTelemetry=86]="InitTelemetry",e[e.InitUserBrbServiceTask=87]="InitUserBrbServiceTask",e[e.LeakDetector=88]="LeakDetector",e[e.LogActivityTask=89]="LogActivityTask",e[e.Polyfills=90]="Polyfills",e[e.RegisterCustomFrameThemes=91]="RegisterCustomFrameThemes",e[e.ReinitSettingsEcsProvider=92]="ReinitSettingsEcsProvider",e[e.ReloadExperience=93]="ReloadExperience",e[e.Scheduling=94]="Scheduling",e[e.SetPrimaryUserOnCoreSettingsTask=95]="SetPrimaryUserOnCoreSettingsTask",e[e.SetPrimaryUserOnTelemetry=96]="SetPrimaryUserOnTelemetry",e[e.SetRingFinderCookieTask=97]="SetRingFinderCookieTask",e[e.SetUserOnDiagnosticsService=98]="SetUserOnDiagnosticsService",e[e.SetUserOnTelemetryContext=99]="SetUserOnTelemetryContext",e[e.SignalCoreLifecycleChangesTask=100]="SignalCoreLifecycleChangesTask",e[e.StoreBuildInfoTask=101]="StoreBuildInfoTask",e[e.TelemetryContext=102]="TelemetryContext",e[e.TrackExperienceIdle=103]="TrackExperienceIdle",e[e.TrackUserTask=104]="TrackUserTask",e[e.UpdateDataClientContext=105]="UpdateDataClientContext",e[e.UpdateNetworkStateDetection=106]="UpdateNetworkStateDetection",e[e.UpdateUserMetadataProperties=107]="UpdateUserMetadataProperties",e[e.UserSettings=108]="UserSettings",e[e.WaitForCDLWorkerTask=109]="WaitForCDLWorkerTask",e[e.WindowDebugEvents=110]="WindowDebugEvents",e[e.WrapChangeReportingServicesTask=111]="WrapChangeReportingServicesTask"}(g||(g={})),function(e){e.Blur="blur",e.Click="click",e.Focus="focus",e.Keydown="keydown",e.Keyup="keyup",e.Keypress="keypress",e.Mousedown="mousedown",e.Mousemove="mousemove",e.Mouseup="mouseup",e.Mouseleave="mouseleave",e.Touchstart="touchstart",e.Touchmove="touchmove",e.Touchend="touchend",e.Paste="paste",e.Resize="resize",e.Scroll="scroll",e.System="system",e.Sample="sample"}(p||(p={}));const v="main",h="core",f="en-us";var y;!function(e){e.CDN="CDN",e.Shared="Shared",e.Browser="Browser",e.None="None"}(y||(y={}));const k="teams-precache-v2",S='NOTE: Data sent in feedback submissions will be "Support Data" under your agreement for Microsoft 365, including any information that would otherwise be considered "Customer Data" or "Personal Data". Please do not submit feedback that may include data you do not wish to provide to Microsoft as "Support Data".'},291019:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{nh:()=>i,WL:()=>a,Ug:()=>o,GZ:()=>r,Vi:()=>s}),function(e){e[e.CRITICAL=0]="CRITICAL",e[e.POST_CRITICAL=1]="POST_CRITICAL",e[e.COMPLETE=2]="COMPLETE"}(i||(i={})),function(e){e.CONTEXTUAL_NOTIFICATIONS="contextual-notifications",e.END="end",e.HEADER="header",e.MAIN="main",e.MODAL="modal",e.NAV="nav",e.NOTIFICATIONS="notifications",e.START="start",e.SUBNAV="sub-nav",e.TITLE_BAR="title-bar",e.TOASTS="toasts",e.CONFIGURATIONS="configurations"}(a||(a={})),function(e){e.ALL_PHASE_SIGNALS_RECEIVED="all-phase-signals-received",e.PHASE_TIMEOUT_FIRED="phase-timeout-fired",e.PHASE_PREVIOUSLY_COMPLETED="phase-previously-completed",e.TARGET_AND_PREVIOUS_PHASES_DO_NOT_EXIST="target-and-previous-phases-do-not-exist"}(o||(o={})),function(e){e.APP_SWITCHER_CONFIRMATION_RENDERED="app-switcher-confirmation-renderer",e.AUDIO_DEVICE_SETTINGS_RENDERED="audio-device-settings-rendered",e.CALENDAR_HEADER_RENDERED="calendar-header-rendered",e.CALENDAR_VIEW_RENDERED="calendar-view-rendered",e.CALENDAR_SF_VIEW_RENDERED="calendar-sf-view-rendered",e.CALENDAR_SF_TRACKING_VIEW_RENDERED="calendar-sf-tracking-view-rendered",e.CALL_FORWARDING_SETTINGS_RENDERED="call-forwarding-settings-rendered",e.CALL_GROUP_OWNERS_RENDERED="call-group-owners-rendered",e.CALL_HISTORY_RENDERED="call-history-rendered",e.CALLING_SCREEN_RENDERED="calling-screen-rendered",e.CALLS_APP_RENDERED="calls-app-rendered",e.CAMPAIGN_VIEW_RENDERED="campaign-view-rendered",e.CHANNEL_DASHBOARD_HEADER_RENDERED="channel-dashboard-header-rendered",e.CHANNEL_DASHBOARD_VIEW_RENDERED="channel-dashboard-view-rendered",e.CHANNEL_HEADER_RENDERED="channel-header-rendered",e.CHANNEL_LIST_ITEMS_RENDERED="channel-list-items-rendered",e.CHAT_HEADER_BUTTONS_RENDERED="chat-header-buttons-rendered",e.CHAT_HEADER_TITLE_RENDERED="chat-header-title-rendered",e.CHAT_LIST_ITEMS_RENDERED="chat-list-items-rendered",e.COMPOSE_LAYOUT_LOADED="compose-layout-loaded",e.COMPOSE_LOADED="compose-loaded",e.COMMUNITIES_HEADER_RENDERED="communities-header-rendered",e.CONNECT_WITH_ANYONE_SHOWN="connect-with-anyone-shown",e.COURSE_TEAMS_MAIN_PANE_RENDERED="course-teams-main-pane-rendered",e.DIALPAD_RENDERED="dialpad-rendered",e.DISCOVER_SURFACE_FEED_RENDERED="discover-surface-feed-rendered",e.DISCOVER_SURFACE_HEADER_RENDERED="discover-surface-header-rendered",e.DISCOVER_SURFACE_VIEW_RENDERED="discover-surface-view-rendered",e.FEED_ITEM_NAVIGATION="feed-item-navigation",e.FEED_LIST_ITEMS_RENDERED="feed-list-items-rendered",e.GUARDIANS_APP_RENDERED="guardians-app-rendered",e.MESSAGE_REACTIONS_RENDERED="message-reactions-rendered",e.MESSAGES_RENDERED="messages-rendered",e.PLATFORM_APP_CONTAINER_RENDERED="platform_app_container_rendered",e.PLATFORM_APP_FRAME_RENDERED="platform_app_frame_rendered",e.PLATFORM_APP_FRAME_CONTENT_RENDERED="platform_app_frame_content_rendered",e.P2P_FILES_LIST_VIEW_RENDERED="p2p_files_list_view_rendered",e.PRESENCES_RENDERED="presences-rendered",e.SEARCH_RESULTS_RENDERED="search-results-rendered",e.SETTINGS_RENDERED="settings-rendered",e.SHARE_PAGE_RENDERED="share-page-rendered",e.SINGLE_TEAM_VIEW_LEFT_RAIL_LOADED="single-team-view-left-rail-loaded",e.SPEED_DIAL_RENDERED="speed-dial-rendered",e.TEAM_DASHBOARD_HEADER_RENDERED="team-dashboard-header-rendered",e.TEAM_DASHBOARD_VIEW_RENDERED="team-dashboard-view-rendered",e.TEAMS_DASHBOARD_HEADER_RENDERED="teams-dashboard-header-rendered",e.TEAMS_DASHBOARD_VIEW_RENDERED="teams-dashboard-view-rendered",e.TEAMS_GRID_VIEW_HEADER_RENDERED="teams-grid-view-header-rendered",e.TEAMS_GRID_VIEW_RENDERED="teams-grid-view-rendered",e.VIRTUAL_LIST_RENDER_BUFFER_FILLED="virtual-list-render-buffer-filled"}(r||(r={}));const s={[a.HEADER]:{height:{collapsed:"6.1rem",expanded:"24.3rem"}}}},609330:(e,t,n)=>{"use strict";var i;n.d(t,{vW:()=>i,o_:()=>a,Tf:()=>o}),function(e){e[e.Macro=0]="Macro",e[e.RenderBlocking=1]="RenderBlocking"}(i||(i={}));const a=-1;var o;!function(e){e[e.None=0]="None",e[e.Canceled=1]="Canceled",e[e.Received=2]="Received",e[e.Started=3]="Started",e[e.Complete=4]="Complete"}(o||(o={}))},695975:(e,t,n)=>{"use strict";var i,a;n.d(t,{Z:()=>i,d:()=>a}),function(e){e.AppUpdatedUsingServiceWorker="AppUpdatedUsingServiceWorker",e.ClearContainer="ClearContainer",e.CloudMismatchOnLogIn="CloudMismatchOnLogIn",e.ErrorPageReboot="ErrorPageReboot",e.ErrorPageSignOut="ErrorPageSignOut",e.RemoveAuthenticatedUser="RemoveAuthenticatedUser",e.RingSwitch="RingSwitch",e.LanguageSwitch="LanguageSwitch"}(i||(i={})),function(e){e.Auth="Auth",e.DeveloperSwitchersService="DeveloperSwitchersService",e.ReloadAppTask="ReloadAppTask",e.WebClientUpdateService="WebClientUpdateService",e.RemoveAuthenticatedUserResolver="RemoveAuthenticatedUserResolver",e.Core="Core"}(a||(a={}))},79647:(e,t,n)=>{"use strict";n.d(t,{dS:()=>i,Pz:()=>a,s_:()=>o,Tu:()=>r,Hm:()=>s,x8:()=>l});const i="com.microsoft.teams.chat",a="com.microsoft.teams.calling",o="com.microsoft.teams.meetingOptions",r="com.microsoft.teams.files",s="com.microsoft.teams.teamsAndChannels",l="com.microsoft.teams.teamsGallery"},411713:(e,t,n)=>{"use strict";var i,a;n.d(t,{_:()=>i,a:()=>a}),function(e){e.apps="apps",e.broadcasts="broadcasts",e.chats="chats",e.calls="calls",e.calendars="calendars",e.extensions="extensions",e.files="files",e.licenses="licenses",e.meetings="meetings",e.teamgallery="teamgallery"}(i||(i={})),function(e){e.list="list",e.create="create",e.join="join",e.error="error",e.view="view"}(a||(a={}))},405204:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{PG:()=>i,x9:()=>a,xL:()=>o}),function(e){e.ComposeMessage="composeMessage",e.PostCompose="postCompose",e.MessageList="messageList",e.Powerbar="powerbar",e.VirtualTreeList="virtualTreeList",e.FeedsFilter="feedsFilter",e.PeoplePicker="peoplePicker",e.SearchBox="searchBox",e.Floodgate="floodgate",e.ChatListSearchFilter="chatListSearchFilter",e.ChannelListSearchFilter="channelListSearchFilter",e.CallingPerf="callingPerf",e.TeamsAndChannelsTable="teamsAndChannelsTable",e.DiscoverSurfaceFeedList="discoverSurfaceFeedList",e.AllChannelSystemMessages="channelInfoPaneAllSystemMessages",e.AllPinnedPosts="channelInfoPaneAllPinnedPosts"}(i||(i={})),function(e){e.CallingScreen="callingScreen",e.Chat="chat",e.ChannelL1="channelL1",e.ChannelL2="channelL2",e.ChannelSettings="channelSettings",e.ChatList="chatList",e.Communities="communitites",e.DialPad="dialpad",e.FeedList="feedlist",e.FlyoutChatList="flyoutChatList",e.GroupChat="groupChat",e.MeetingChat="meetingChat",e.MessageEscalation="messageEscalation",e.NewChat="newChat",e.PeopleSearch="peopleSearch",e.Floodgate="floodgate",e.ChannelList="ChannelList",e.ManageThreadMembers="manageThreadMembers",e.ManageChannelThreadMembers="manageChannelThreadMembers",e.ManageTeams="manageTeams",e.ChannelInvitationsTab="channelInvitationsTab",e.DiscoverSurface="discoverSurface",e.ThreadMembersSearch="threadMembersSearch",e.SharedChannelPendingInvites="sharedChannelPendingInvites",e.PendingJoinRequests="pendingJoinRequests",e.SelectPeoplePickerExtensibility="selectPeoplePickerExtensibility",e.ChannelsTable="channelsTable",e.SpeedDial="SpeedDial"}(a||(a={})),function(e){e.HeartbeatMonitor="HeartbeatMonitor",e.CallingPerfMonitor="CallingPerfMonitor"}(o||(o={}))},107844:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m,g,p,v,h,f,y,k,S,b;n.d(t,{OV:()=>i,Qf:()=>a,Ml:()=>o,z7:()=>s,Wz:()=>l,Zc:()=>d,XR:()=>c,cb:()=>u,Lv:()=>m,oW:()=>g,$g:()=>p,hD:()=>h,_v:()=>y,zP:()=>k,Dz:()=>S,xu:()=>b}),function(e){e.Work="",e[e.Freemium=2]="Freemium",e[e.Life=3]="Life"}(i||(i={})),function(e){e.Personal="personal",e.Channel="channel",e.Unknown="unknown"}(a||(a={})),function(e){e.GuardianChat="GuardianChat"}(o||(o={})),function(e){e[e.anonymous=0]="anonymous",e[e.default=1]="default",e[e.guest=2]="guest",e[e.msaGuest=3]="msaGuest",e[e.msaMember=4]="msaMember",e[e.otpGuest=5]="otpGuest",e[e.otpMember=6]="otpMember"}(r||(r={})),function(e){e[e.Admin=0]="Admin",e[e.Anonymous=1]="Anonymous",e[e.Guest=2]="Guest",e[e.Regular=3]="Regular"}(s||(s={})),function(e){e.x64="x64",e.ia32="ia32",e.x86="x86",e.unknown="unknown"}(l||(l={})),function(e){e.MACOSX="UNIX/MACINTOSH",e.UNIX="UNIX",e.UNKNOWN="Unknown",e.WINDOWS="Windows"}(d||(d={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(c||(c={})),function(e){e.background="background",e.foreground="foreground"}(u||(u={})),function(e){e.maximized="maximized",e.minimized="minimized",e.systray="systray"}(m||(m={})),function(e){e.copy="Copy"}(g||(g={})),function(e){e.nav="nav",e.notification="notification"}(p||(p={})),function(e){e.Cold="cold",e.Warm="warm"}(v||(v={})),function(e){e.TopLevel="L1",e.DrillDown="L2"}(h||(h={})),function(e){e.SettingsPrivacyPage="SettingsPrivacyPage",e.LpcMeProfileCard="LpcMeProfileCard"}(f||(f={})),function(e){e.tflExternal="TFLExternal",e.tfwUser="TFWUser"}(y||(y={})),function(e){e.addMembers="addMembers",e.pinChannel="pinChannel",e.unpinChannel="unpinChannel",e.favoriteChannel="favoriteChannel",e.manageChannel="manageChannel",e.getChannelEmail="getChannelEmail",e.getChannelLink="getChannelLink",e.editChannel="editChannel",e.editChannelConnectors="editChannelConnectors",e.deleteChannel="deleteChannel"}(k||(k={})),function(e){e.pinned="pinned",e.shown="shown",e.hidden="hidden"}(S||(S={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(b||(b={}))},355272:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{Mv:()=>i,Ky:()=>a,sG:()=>o,Mb:()=>r,$E:()=>s}),function(e){e[e.general=0]="general",e[e.team=1]="team",e[e.personal=2]="personal",e[e.group=4]="group",e[e.meeting=8]="meeting"}(i||(i={})),function(e){e[e.na=0]="na",e[e.bots=1]="bots",e[e.tabs=2]="tabs",e[e.messaging=3]="messaging",e[e.connectors=4]="connectors"}(a||(a={})),function(e){e[e.na=0]="na",e[e.card=1]="card",e[e.deepLink=2]="deepLink",e[e.messageExtension=3]="messageExtension",e[e.platformExtensionTab=4]="platformExtensionTab",e[e.contentBubble=5]="contentBubble",e[e.shareToOutlook=6]="shareToOutlook",e[e.adaptiveCardTab=7]="adaptiveCardTab",e[e.botConfig=8]="botConfig"}(o||(o={})),function(e){e.bot="bot",e.inputextension="inputextension",e.connectors="connectors"}(r||(r={})),function(e){e.carousel="carousel",e.list="list"}(s||(s={}))},966009:(e,t,n)=>{"use strict";var i,a;n.d(t,{t:()=>i,z:()=>a}),function(e){e.core="core",e.window="window",e.mtmaCore="mtmaCore",e.mtmaUser="mtmaUser",e.mtmaWindow="mtmaWindow",e.viewSchema="viewSchema",e.embed="embed",e.cmd="cmd",e.other="other"}(i||(i={})),function(e){e.query="query",e.watchQuery="watchQuery",e.mutate="mutate",e.subscribe="subscribe",e.readQuery="readQuery",e.writeQuery="writeQuery",e.readFragment="readFragment",e.writeFragment="writeFragment"}(a||(a={}))},216967:(e,t,n)=>{"use strict";var i,a;n.d(t,{Q:()=>i,N:()=>a}),function(e){e.Unknown="unknown",e.Prod="prod"}(i||(i={})),function(e){e.MW="MW",e.Anglr="Anglr",e.ShareToTeams="ShareToTeams",e.Files="Files",e.Calendar="Calendar",e.MtgOpt="MtgOpt",e.EmbedClient="EmbedClient",e.LmsIntegration="LmsIntegration",e.CallingEmbed="CallingEmbed",e.ReactWebClient="ReactWebClient",e.Example="Example"}(a||(a={}))},329371:(e,t,n)=>{"use strict";var i,a,o,r,s,l;n.d(t,{NR:()=>i,Bh:()=>a,RY:()=>o,GJ:()=>r,AR:()=>s,us:()=>l}),function(e){e.Windows="windows",e.Mac="mac",e.Linux="linux",e.ChromeOS="chromeos",e.Android="android",e.IOS="ios",e.WindowsPhone="windowsphone",e.Unknown="unknown"}(i||(i={})),function(e){e.Web="web",e.Desktop="desktop",e.CDLWorker="cdlworker",e.Embed="embed",e.Maglev="maglev",e.OutlookWeb="Outlook Web",e.OutlookDesktop="Outlook Desktop",e.OfficeWeb="Office Web",e.OfficeDesktop="Office Desktop"}(a||(a={})),function(e){e.Embed="embed"}(o||(o={})),function(e){e.Outlook="outlook",e.Unknown="unknown"}(r||(r={})),function(e){e.Edge="edge",e.Safari="safari",e.Chrome="chrome",e.Firefox="firefox",e.Electron="electron",e.Unknown="unknown"}(s||(s={})),function(e){e[e.Web=1415]="Web",e[e.Desktop=27]="Desktop",e[e.Mac=28]="Mac",e[e.Linux=41]="Linux",e[e.Rigel=34]="Rigel",e[e.SurfaceHub=35]="SurfaceHub",e[e.SurfaceHub2=38]="SurfaceHub2",e[e.Maglev=48]="Maglev",e[e.MaglevT21=49]="MaglevT21",e[e.MaglevMacT21=50]="MaglevMacT21",e[e.MetaOsOffice=5500]="MetaOsOffice",e[e.MetaOsOutlook=5501]="MetaOsOutlook",e[e.TV=3623]="TV",e[e.Automotive=3624]="Automotive",e[e.SttOutlookWeb=5600]="SttOutlookWeb"}(l||(l={}))},957701:(e,t,n)=>{"use strict";var i,a;n.d(t,{B:()=>i,_:()=>a}),function(e){e.OpenOnMainRenderer="main"}(i||(i={})),function(e){e.DeepLink="deepLink",e.ImmersiveReader="immersiveReader",e.MeetingNotes="meetingNotes",e.Transcript="Transcript",e.JoinBroadcastAsAttendee="joinBroadcastAsAttendee"}(a||(a={}))},125901:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{QP:()=>i,d:()=>a,zF:()=>r}),function(e){e.standAlone="main",e.iframe="iFrame",e.secondary="MW",e.embedded="EDOM",e.worker="Worker"}(i||(i={})),function(e){e.flyout="flyout",e.main="main"}(a||(a={})),function(e){e.owa="OWA",e.outlook="Outlook",e.officeOnline="OfficeOnline",e.wordWeb="WordWeb",e.word="Word",e.excelWeb="ExcelWeb",e.excel="Excel",e.powerPointWeb="PowerPointWeb",e.powerPoint="PowerPoint",e.lmsBlackBoard="BlackBoard",e.lmsCanvas="Canvas",e.lmsMoodle="Moodle",e.lmsBrightspace="Brightspace",e.lmsOther="OtherLMS",e.lmsOpenLMS="OpenLMS",e.lmsSchoology="Schoology",e.unknown="unknown",e.thirdParty="ThirdParty",e.dynamics="Dynamics",e.onePlayer="OnePlayer",e.devHost="DevHost",e.edge="Edge"}(o||(o={})),function(e){e.userInitiated="userInitiated"}(r||(r={}))},646261:(e,t,n)=>{"use strict";var i,a,o,r,s;n.d(t,{rY:()=>i,cr:()=>a,Gx:()=>o,H:()=>s}),function(e){e.ExpandTab="expandTab",e.UndoExpandTab="undoExpandTab",e.MaximizeTab="maximizeTab",e.UndoMaximizeTab="undoMaximizeTab",e.WindowInitialized="windowInitialized",e.WindowErrored="windowErrored",e.GetAadToken="aadGetToken",e.Login="login",e.GetDriveItemResponse="getDriveItemResponse",e.GetAadCurrentUser="aadCurrentUser",e.AadClearCacheForResource="aadClearCache",e.GetStateData="getStateData",e.GetLogs="getLogs",e.GetSettings="getSettings",e.TriggerAutoBrb="triggerAutoBrb",e.ShouldShowChatNotification="shouldShowChatNotification",e.GetLeaks="getLeaks",e.GetMemory="getMemory",e.UpdateWindowState="updateWindowState",e.AppStateSyncMessage="appStateSyncMessage",e.CentralDataLayerRequest="centralDataLayer:request",e.CentralDataLayerResponse="centralDataLayer:response",e.ScreenSharingControlMessage="screenSharing:controlMessage",e.HideFileViewerLoader="hideFileViewerLoader",e.StopDocStageScenario="stopDocStageScenario",e.AddScenarioMarker="addScenarioMarker",e.FilesExperienceSendData="filesExperience:sendData",e.FilesExperienceRequestData="filesExperience:requestData",e.ActivityEvent="activityEvent",e.GetAggregatedSettings="getAggregatedSettings",e.SetAggregatedSettings="setAggregatedSettings",e.GetWindowLaunchSubSteps="getWindowLaunchSubSteps",e.CreateWebview="createWebview",e.UnhandledMouseEvent="unhandledMouseEvent",e.GetHeartbeat="getHeartbeat",e.GetApolloCacheStats="getApolloCacheStats",e.GetCdlStats="getCdlStats",e.GetWindowEntityTypeStats="getWindowEntityTypeStats",e.SetTouchBar="set-touch-bar",e.ClearTouchBar="clear-touch-bar",e.LayoutChangeMessage="layoutChangeMessage",e.UnhandledShortcut="unhandledShortcut",e.NavigateToOpenerLandmark="NavigateToOpenerLandmark",e.NavigateToLandmark="NavigateToLandmark",e.HybridRouteNavigation="hybridRouteNavigation",e.FocusManagementEvent="focusManagementEvent",e.FocusResetEvent="focusResetEvent",e.CdlRegistration="cdlRegistration",e.NotificationBannerUpdate="NotificationBannerUpdate",e.EntityCommandTimedOutAtHost="entityCommandTimedOutAtHost",e.ActivateOutlook="activateOutlook",e.RequestTabMetrics="requestTabMetrics",e.SendWebviewIdentity="sendWebviewIdentity",e.HasDevicePermissions="hasDevicePermissions",e.HasDevicePermissionsCallback="hasDevicePermissionsCallback"}(i||(i={})),function(e){e.GlobalWindowError="error",e.UnhandledRejection="unhandledrejection"}(a||(a={})),function(e){e.Create="createIframe",e.Destroy="destroyIframe",e.ChildReady="iframeReady",e.Acquired="iframeAcquired",e.ToggleMinimized="toggleChatMinimize"}(o||(o={})),function(e){e.ConversationOpened="conversationOpened",e.CreateNewConversation="createNewConversation",e.EmbedClientInitializationSuccess="embedClientInitializationSuccess",e.EmbedClientInitializationFail="embedClientInitializationFail",e.NewConversationResolved="newConversationResolved",e.SetFocusOnChatList="setFocusOnChatList",e.UpdateSettings="UpdateSettings"}(r||(r={})),function(e){e.LogoutSuccess="logoutSuccessful",e.LogoutFailed="logoutFailed",e.Logout="logout"}(s||(s={}))},412506:(e,t,n)=>{"use strict";n.d(t,{I:()=>o});var i=n(878233);const a="IntentPersistenceService";class o{constructor(e){this._localStorage=e}getAllStoredDeeplinks(){const e=this._localStorage.get(a,i.f.Experience);return this.jsonParseSafe(e)||{}}storeDeeplink(e,t){const n=this.getAllStoredDeeplinks();n[e]=t.toString(),this.persist(n)}deleteDeeplink(e){const t=this.getAllStoredDeeplinks();delete t[e],this.persist(t)}clear(){this._localStorage.remove(a,i.f.Experience)}persist(e){this._localStorage.set(a,JSON.stringify(e),i.f.Experience)}jsonParseSafe(e){if(e)try{return JSON.parse(e)}catch(e){return}}}},531804:(e,t,n)=>{"use strict";n.d(t,{xm:()=>a,qf:()=>o,vu:()=>r,b3:()=>s,j:()=>c,sW:()=>u});var i=n(769088);const a="[Authentication][DiscoverV2]";var o,r,s,l,d;!function(e){e.userLocale="X-Client-UI-Language",e.skypeTokenAuthzTypeHeader="ms-teams-authz-type",e.claimsChallengeCapable="claimsChallengeCapable",e.consistencyValue="ConsistencyLevel"}(o||(o={})),function(e){e.skypeTokenRefresh="TokenRefresh",e.skypeTokenExplicitLogin="ExplicitLogin",e.strongConsistencyMsInternalUserSignup="MS-Internal-UserSignup",e.strongConsistencyDefaultValue="Organization;ScenarioId={id}"}(r||(r={})),function(e){e[e.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD=i.gT.Two*i.gT.SECONDS_PER_MINUTE*i.gT.MILLI_PER_SECOND]="DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD"}(s||(s={})),function(e){e.skypeAuthAnonReloadJoinLocation="skypeAuthAnonReloadJoinLocation",e.skypeAuthForceAnonReload="skypeAuthForceAnonReload"}(l||(l={})),function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.THIRTY=30]="THIRTY"}(d||(d={}));const c={SKYPE_SEND_REQUEST:"skype_send_request",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim"},u="NA"},73230:(e,t,n)=>{"use strict";n.d(t,{bO:()=>A,BD:()=>_,r2:()=>D,db:()=>M,LO:()=>P,uc:()=>O,qW:()=>x,ut:()=>L,S9:()=>U,Z2:()=>B,Mu:()=>j,Qe:()=>W,br:()=>V,ZC:()=>H,wh:()=>$,nD:()=>G,TB:()=>q,wC:()=>Q,WA:()=>J,H:()=>Y,nd:()=>K,lm:()=>Z,UE:()=>ee,lZ:()=>te,l2:()=>ne,JY:()=>ie,nH:()=>ae,qO:()=>oe});var i=n(231191),a=n(281857),o=n(642115),r=n(661564),s=n(244705),l=n(118824),d=n(893088),c=n(107844),u=n(737188),m=n(247112),g=n(628235),p=n(66431),v=n(648062),h=n(923036),f=n(272097),y=n(372304),k=n(20204),S=n(769088),b=n(604781),C=n(758887),w=n(531804),N=n(395816),T=n(11574),I=n(39635);const E=[a.jK.NetworkOffline,a.jK.Forbidden,a.jK.ProxyAuthenticationRequired],A={context:w.xm,subContext:"_getDiscoverResponse",errorCode:a.jK.NetworkOffline,message:"Network is offline, not making any call",isExpected:!0},_={context:w.xm,subContext:"_getDiscoverResponse",errorCode:v.SM.InteractionRequired,message:"Interaction is required to get a skype token, not making any call",isExpected:!0},D=(e,t,n)=>{let i;if(!n){const{response:t}=e;i=null==t?void 0:t.isExpected}let r=e;r.context||(r=(0,o.Jn)(e,a.w5.Discover,a.jK.InvalidResponse,"",{error:e.stack},e.message||("string"==typeof e?e:(0,b.u4)(e))));const{serverResponse:{status:s,body:l,headers:d={}}={},context:c}=r;let{reason:u,message:m,code:g=a.jK.InvalidResponse,subContext:p=""}=r;return u=d?Object.assign(Object.assign({},u),{responseCorrelationId:d["correlation-id"],innerError:r}):u,m=(null==l?void 0:l.message)||m,p=(null==l?void 0:l.errorCode)||c,g=t?F(s):a.jK.NetworkOffline,(0,o.Tr)(a.w5.Discover,g,p,Object.assign(Object.assign({},u),{innerError:e}),m,r.serverResponse,i)},F=e=>{if(void 0===e)return a.jK.InvalidResponse;switch(e){case r.qb.FORBIDDEN:return a.jK.Forbidden;case r.qb.NOT_AUTHORIZED:return a.jK.Unauthorized;case r.qb.PROXY_AUTHENTICATION_REQUIRED:return a.jK.ProxyAuthenticationRequired;default:return a.jK.FailedToFetch}},M=(e,t,n)=>{if(!e)throw t;const i=Object.assign(Object.assign({},t),{errorCode:t.code,reason:(0,b.u4)(t.reason)});return X(t)||!n&&(null==t?void 0:t.isExpected)?e.cancel(i):e.fail(i),t.reason&&(t.reason.isExpectedError=X(t)),t},R=(0,u.type)({skypeid:u.string}),P=((0,u.type)({skypeTokenData:(0,u.type)({regionGtms:s.UH,token:(0,u.type)({skypeToken:u.string,expiration:u.number,userDetails:(0,u.partial)({region:u.string})})})},"token"),(e,t)=>{if(!e)return t.error("Can not get userId due to skypeToken is undefined"),"";const{skypeid:n}=(0,m.as)(R,(0,C.J)(e));return`8:${n}`}),O=e=>{let t=e.findScenario(g.RG.GetSkypeToken);return t||(t=e.newScenario(g.RG.GetSkypeToken),t.mark("Non authz error scenario")),t},x=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=(0,h.pW)();null==n||n.push("fn:getuid");const a=yield e.getUser({correlation:{id:i,source:"discover-helper::getUserIdentifierForDiscover",scenarioName:g.RG.AuthWebUser}});if(null==n||n.push("user:"+ +!!a),null==a?void 0:a.isAuthenticated){t.log(`[_getUserIdentifier][${i}]user found by getUser call`);return(0,f.Xx)(a)}const o=`[_getUserIdentifier] ${a?`User is not authenticated. UserId: [${a.id}] tenantId: [${a.profile.tid}]`:"user missing"}. ${null==n?void 0:n.join(";")}`;throw(0,y.Tr)({context:w.xm,subContext:"_getUserIdentifier",errorCode:a?v.SM.UserNotAuthenticated:v.SM.UserNotFoundError,isExpected:!0,message:o,correlationId:null!=i?i:(0,h.pW)()})})),L=(e,t,n,a,o,r,s,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){k.Jt.put(j(e),t.userDetails),null==n||n.push("userDetails:1"),yield(0,I.u)(t,s,r,l),k.Jt.put(B(e),t),null==n||n.push("skypeToken:1"),(null==t?void 0:t.regionGtms)?(k.Jt.put(U(e),null==t?void 0:t.regionGtms),null==n||n.push("regionGtms:1")):(null==n||n.push("regionGtms:-1"),o.error(`[_getDiscoverResponse][${a}] RegionGtm is missing in response, not able to cache.`))})),U=e=>({user:e,typeName:"Discover",key:v.op}),B=e=>({user:e,typeName:"Discover",key:v.rz}),j=e=>({user:e,typeName:"Discover",key:v.ru}),W=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a;const o=Date.now(),{regionGtms:r,licenseDetails:s,skypeToken:l,tokens:d,region:c,regionSettings:u,skypeGuestUserToken:m,consumerLicenseDetails:g}=yield e.body.json();null===(i=t.eventData)||void 0===i||i.push("parsejson:1");const p=l||d||m,v=null!==(a=null==p?void 0:p.skypeToken)&&void 0!==a?a:null==p?void 0:p.skypetoken;let h;return n.log(`[_acquireSkypeTokenWeb][${null==t?void 0:t.correlationId}] Response parsed succeed.`),g&&(h={timeStamp:new Date(o),consumerLicenseDetails:g}),{userId:P(v,n),regionGtms:r,licenseDetails:s,skypeToken:v,expires:new Date(o+(null==p?void 0:p.expiresIn)*S.gT.MILLI_PER_SECOND),region:c,regionSettings:u,consumerLicenseDetails:h}})),V=(e,t,n)=>{if(e.push("fn:_getUserDetailFromHost"),!t)return void e.push("_bootstrapData:0");const{userId:i,region:a,licenseDetails:o}=t;return i&&a&&o?{id:i,licenseDetails:o,region:a}:(n.log(`[_getUserDetailFromHost] userId:${!!i}|region:${!!a}|licenseDetails:${!!o}`),void e.push(`userId:${!!i}|region:${!!a}|licenseDetails:${!!o}`))},H=(e,t)=>{var n;const i=P(e.skypeToken,t);return t.log(`[convertResponseToISkypeToken] Skypeid received from discovery. Region: ${null==e?void 0:e.region}`),{skypeToken:null==e?void 0:e.skypeToken,expiration:null===(n=null==e?void 0:e.expires)||void 0===n?void 0:n.getTime(),regionGtms:null==e?void 0:e.regionGtms,userDetails:{id:i,licenseDetails:Object.assign(Object.assign({},null==e?void 0:e.licenseDetails),{consumerLicenseDetails:null==e?void 0:e.consumerLicenseDetails}),region:null==e?void 0:e.region,regionSettings:null==e?void 0:e.regionSettings}}},$=(e,t,n,i,a)=>{const{skypeTokenValidationDisabled:o}=n.get(l.J.Auth),r=n.get(l.J.Host).skypeTokenValidationDisabled,s=o||r;return s&&z(e,t,i,a),!!s},z=(e,t,n,i)=>{if(t){n.log(`Skype token validation skipped. forceRenew:${e};isTokenSame:${t}`);const a=i.newScenario(g.RG.SkypeTokenValidationSkipped);a.appendEventData({message:`forceRenew:${e};isTokenSame:${t}`}),a.stop()}},G=(e,t,n)=>{var i;if(!(0,f.FG)(e.userIdentifier,(0,f.Xx)(t)))throw null===(i=e.eventData)||void 0===i||i.push("userMismatch"),n.warn("[_acquireSkypeTokenWeb] user obtained does not match provided userIdentifier, throw error."),(0,y.Tr)({context:w.xm,subContext:"_acquireSkypeTokenWeb",errorCode:v.SM.UserNotFoundError,message:"User obtained does not match provided userIdentifier.",correlationId:e.correlationId,isExpected:!0})},q=(e,t,n,i,a,o)=>{const{authOverrides:r}=n.get(l.J.Host),{authzEndpointUrl:s,authzUrl:c,regionGtmsEnv:u}=n.get(l.J.Auth),m=((e,t,n,i)=>{const{environment:a}=(null==i?void 0:i.get(l.J.Metadata))||{};let o={method:"POST",url:n?`${e}?region_gtms_env=${n}`:`${e}`,serviceName:d.EJ.Auth,apiName:"acquireSkypeTokenWeb"};return t.role===N.w4O.Anonymous&&(o=Object.assign(Object.assign({},o),{url:`${e}/visitor`,body:`{"tenantId": "${t.profile.tid}"}`})),a!==p.s_.life||t.role!==N.w4O.Guest&&t.role!==N.w4O.Anonymous||(o=Object.assign(Object.assign({},o),{url:`${e}/guest${n?`?region_gtms_env=${n}`:""}`})),o})((null==r?void 0:r.authzEndpointUrl)||s||c||v.ej.AUTHZ_DEFAULT_BASE_URL,e,u,n);return i.log(`[_getFormatRequest][${t}] Request formatted. `),m.headers=((e,t,n,i)=>{const a={},o=null==t?void 0:t.locale,{disableClaimsChallenge:r}=n.get(l.J.Auth);return o&&(a[w.qf.userLocale]=o),r||(a[w.qf.claimsChallengeCapable]="true"),a.clientRequestId=e,a["x-ms-skip-phone"]="true",void 0!==i&&(a["ms-teams-authz-type"]=i?w.vu.skypeTokenRefresh:w.vu.skypeTokenExplicitLogin),a})(t,a,n,o),m},Q=e=>{var t,n,i,a,o,r,s,l,d,u,m,g,p,v;return{id:e.id,region:e.region,tenant:{type:(null===(t=e.licenseDetails)||void 0===t?void 0:t.isFreemium)?c.OV.Freemium:c.OV.Work},isAdvComms:(null===(n=e.licenseDetails)||void 0===n?void 0:n.isAdvComms)||!1,isTranscriptEnabled:(null===(i=e.licenseDetails)||void 0===i?void 0:i.isTranscriptEnabled)||!1,isFreemium:(null===(a=e.licenseDetails)||void 0===a?void 0:a.isFreemium)||!1,isTrial:(null===(o=e.licenseDetails)||void 0===o?void 0:o.isTrial)||!1,isWebinarEnabled:(null===(r=e.licenseDetails)||void 0===r?void 0:r.isWebinarEnabled)||!1,eduLicenseSkuAndCategory:(null===(s=e.licenseDetails)||void 0===s?void 0:s.eduLicenseSkuAndCategory)||void 0,isBasicLiveEventsEnabled:(null===(l=e.licenseDetails)||void 0===l?void 0:l.isBasicLiveEventsEnabled)||!1,isTPProtection:(null===(d=e.licenseDetails)||void 0===d?void 0:d.isTPProtection)||!1,isTPCustomization:(null===(u=e.licenseDetails)||void 0===u?void 0:u.isTPCustomization)||!1,isTPManagement:(null===(m=e.licenseDetails)||void 0===m?void 0:m.isTPManagement)||!1,isTPWebinar:(null===(g=e.licenseDetails)||void 0===g?void 0:g.isTPWebinar)||!1,isTPVirtualAppointments:(null===(p=e.licenseDetails)||void 0===p?void 0:p.isTPVirtualAppointments)||!1,isInfoProtectionPremium:(null===(v=e.licenseDetails)||void 0===v?void 0:v.isInfoProtectionPremium)||!1}},J=(e,t,n)=>{"object"==typeof e&&(e.context=e.context||w.xm,e.subContext=e.subContext||t,e.correlationId=e.correlationId||n)},Y=(e,t,n,i,a)=>{const o=`${null==e?void 0:e.subContext}: Failed to get skype token; correlationId:${e.correlationId}, status:${a}, message:${t}, eventData: ${null==n?void 0:n.join(";")}`;return e.isExpected?i.debug(o):i.error(o),e},K=(e,t,n)=>{const i=null==e?void 0:e.join(";"),a=(null==n?void 0:n.get(l.J.Metadata))||{},o=n.get(l.J.Auth);return{message:`${i}::isOnline-${t}::environment:${null==a?void 0:a.environment}`,endpointUrl:null==o?void 0:o.authzUrl,resource:null==o?void 0:o.authzResource}},Z=(e,t,n,i,o,s)=>{var d,c;const{serverResponse:{status:u,body:m}={}}=e;let{message:g,errorCode:p}=e;const{reason:v,code:h}=e,f=n&&!(e.context===a.w5.RejectHttpError&&h===a.jK.RemoteOperationFailed),y=null==t?void 0:t.join(";");u&&(p=F(u),g=m.message);const k={reason:v,message:g,eventData:y},S=(0,T.A)((0,b.u4)(k)),C=e.correlationId,N=(null==s?void 0:s.get(l.J.Metadata))||{},I=s.get(l.J.Auth);void 0===e.isExpected&&(e.isExpected=!f||E.indexOf(p)>-1);const A={context:null!==(d=null==e?void 0:e.context)&&void 0!==d?d:w.xm,subContext:null==e?void 0:e.subContext,message:`${g}::isOnline-${f}::env:${null==N?void 0:N.environment}`,errorCode:f?null!=p?p:h:a.jK.NetworkOffline,statusCode:u,correlationId:C,reason:S,endpointUrl:null==I?void 0:I.authzUrl,resource:null==I?void 0:I.authzResource,isExpected:!f||e.isExpected};if(!((null===(c=(0,b.u4)(e.reason))||void 0===c?void 0:c.indexOf("LoggedAlready"))>-1)&&i){switch(((e,t,n)=>{const{errorCode:i,code:o}=t;if(!e||t.isExpected||n===r.qb.FORBIDDEN||n===r.qb.PROXY_AUTHENTICATION_REQUIRED||i===a.jK.NetworkOffline||o===a.jK.NetworkOffline)return"cancel";if(i===a.jK.TimedOut||o===a.jK.TimedOut)return"incomplete";switch(n){case r.qb.NOT_AUTHORIZED:case-1:case r.qb.THROTTLED:return"incomplete";default:return"fail"}})(f,e,u)){case"stop":i.stop(A);break;case"incomplete":i.incomplete(A);break;case"cancel":i.cancel(A);break;case"fail":default:i.fail(A)}}return Y(e,g,t,o,u)};function X(e){return E.indexOf(e.code)>-1||"Authentication::getUser"===e.subContext&&e.message.indexOf("User information is not available")>-1||e.message.indexOf("getUser: MSAL account not found")>-1||e.message.indexOf("Get skype token promise timed out, keep retrying. Is expected:true")>-1}function ee(e,t,n,i){return t.getUser().then((()=>{const a=ie(i),{requireSkypetokenForMT:o}=i.get(l.J.Auth),r=t.authorize(e,a);return o?n.authorize(r,"x-skypetoken"):r}))}function te(e,t,n){return t.getUser().then((()=>{const i=ie(n);return t.authorize(e,i)}))}function ne(e,t,n){return t.getUser().then((()=>{const{cmdMeetingArtifactsServiceResource:i}=n.get(l.J.CMDMeetingArtifactsService);return t.authorize(e,null!=i?i:"")}))}function ie(e){const{isRunningGlassjar:t,mtAuthResourceOverride:n}=e.get(l.J.Test);if(t&&n)return n;const{authOverrides:i}=e.get(l.J.Host),{mtResource:a}=e.get(l.J.Auth);return(null==i?void 0:i.mtResource)||a||p.O_.MT}const ae=(e,t,n,i)=>{var a,o,r,s,d,u,m;if(!e)return void i.log("Failed to obtain telemetry details from discovery.");if(!n)return void i.log("Failed to obtain telemetry provider from getTelemetryProviderInstance.");const g=null===(a=e.licenseDetails)||void 0===a?void 0:a.isFreemium,{environment:v}=t.get(l.J.Metadata),h=v===p.s_.life?c.OV.Life:g?c.OV.Freemium:c.OV.Work;if(v===p.s_.life&&g&&i.warn("The Environment indicates TFL, but Freemium is true - defaulting telemetry to TFL Tenant.Model"),n.setContext("UserInfo.Region",e.region),n.setContext("Tenant.Model",h),null===(o=e.consumerLicenseDetails)||void 0===o?void 0:o.consumerLicenseDetails){const t=null===(d=null===(s=null===(r=e.consumerLicenseDetails)||void 0===r?void 0:r.consumerLicenseDetails)||void 0===s?void 0:s.licensedProducts)||void 0===d?void 0:d.map((e=>e.skuName)).sort().join(",");n.setContext("UserInfo.IsLicensed",!!(null===(m=null===(u=e.consumerLicenseDetails)||void 0===u?void 0:u.consumerLicenseDetails)||void 0===m?void 0:m.hasTeamsLicense)),n.setContext("UserInfo.Licenses",t)}},oe=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{disableClaimsChallenge:i}=a.get(l.J.Auth);if(i)o.log("[unauthorizedErrorHandler] Claims challenge handling disabled.");else if(e)if(t)k.Jt.deleteType(t,"Token");else{const e=yield n.getUser();k.Jt.deleteType((0,f.Xx)(e),"Token")}else o.log("[unauthorizedErrorHandler] No header passed in.")}))},39635:(e,t,n)=>{"use strict";n.d(t,{u:()=>u,p:()=>m});var i=n(231191),a=n(809752),o=n(736663),r=n(20204),s=n(709167),l=n(118824),d=n(628235),c=n(648062);function u(e,t,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableSkypeTokenEncryption:i}=r.get(l.J.Auth);if(!i)return e;const s=n.newScenario(d.RG.AuthWebEncryptToken);s.mark("auth_web_encrypt_token_start");const u=yield(0,a.mM)(t);if(!u)return s.mark("auth_web_encrypt_token_stop",{reason:"tokenEncryption:MissingEncryptionKey"}),s.stop(),e;try{const n=t.crypto.getRandomValues(new Uint8Array(c.uI.SIXTEEN)),i=(new TextEncoder).encode(e.skypeToken),a=yield t.crypto.subtle.encrypt({name:"AES-CBC",iv:n},u,i);e.encryptedToken=(0,o.z)(a),e.iv=(0,o.z)(n),s.mark("auth_web_encrypt_token_stop",{reason:"tokenEncryption:success"}),s.stop()}catch(e){s.mark("auth_web_encrypt_token_stop",{error:e,reason:"tokenEncryption:error"},"failure"),s.fail()}return e}))}function m(e,t,n,c){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableSkypeTokenEncryption:i}=c.get(l.J.Auth);if(!i||!e.encryptedToken||e.skypeToken)return e;const u=n.newScenario(d.RG.AuthWebDecryptToken);u.mark("auth_web_decrypt_token_start");const m=yield(0,a.mM)(t);if(!m)return u.mark("auth_web_decrypt_token_stop",{reason:"Missing encryption key for decryption"}),u.stop(),e;let g=e.iv;if(g||(g=r.Jt.getValue(s.Jl.initializationVector)),!g)return u.mark("auth_web_decrypt_token_stop",{reason:"Missing initialization vector for decryption"}),u.stop(),e;try{const n=(0,o.k)(g),i=(0,o.k)(e.encryptedToken),a=yield t.crypto.subtle.decrypt({name:"AES-CBC",iv:n},m,i);e.skypeToken=(new TextDecoder).decode(a),u.mark("auth_web_decrypt_token_stop"),u.stop()}catch(e){u.mark("auth_web_decrypt_token_stop",{error:e},"failure"),u.fail()}return e}))}},468043:(e,t,n)=>{"use strict";n.d(t,{Mf:()=>a,f$:()=>o,U3:()=>r,cW:()=>s});var i=n(760083);function a(e,t){return{entity:{type:i.p.chats,action:i.u.create,id:o(e)},command:t}}function o(e){return JSON.stringify(e&&e.length>0?e.sort():[])}function r(e,t,n,i){let a={};if(!e)return a;if(e.type===t&&e.action===n){const t=e.options;if(t&&"string"==typeof t)try{a=JSON.parse(t)}catch(e){i.warn(`Entity options are in unexpected format. Expected a valid stringified JSON object but instead received: ${t}.`)}}else i.warn(`Entity options are (incorrectly) being asked for type and action that do not pertain to the entity. ${e.type} != ${t} or ${e.action} != ${n}`);return a}const s=e=>`${e.substring(0,32)}00000000${e.substring(40)}`},781540:(e,t,n)=>{"use strict";n.d(t,{E:()=>s,z:()=>l});var i=n(231191),a=n(642115),o=n(281857);let r;const s=e=>t=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!r)return e(t);return e(t).then((e=>(null==r||r.processResponse(e),e))).catch((e=>{throw null==r||r.processError(e),e}))}));function l(e,t){if(r){throw(0,a.Tr)(o.w5.Tasks,o.jK.AlreadyInitialized,"subscribeToSendNetworkTracking",void 0,"subscription exists")}r={processResponse:e,processError:t};return()=>{r=void 0}}},902856:(e,t,n)=>{"use strict";n.d(t,{Cu:()=>a,pf:()=>o,f2:()=>r,nU:()=>s,zj:()=>l,IY:()=>d,K4:()=>c});var i=n(84574);function a(e){return e.includes("local")?"local":e.includes("-oncdn-")?"container":"production"}function o(e,t){var n,i,a;try{const t=r(e),i=null===(n=null==t?void 0:t.dataset)||void 0===n?void 0:n.config;return i?JSON.parse(decodeURIComponent(i)):{}}catch(e){const n=`Failed to parse head-data config with error: ${e}`;(null==t?void 0:t.errorToTelemetry)?null===(i=null==t?void 0:t.errorToTelemetry)||void 0===i||i.call(t,n,"webclient_framework_head_config",void 0,!0):null===(a=null==t?void 0:t.error)||void 0===a||a.call(t,n)}return{}}function r(e){const t=null==e?void 0:e.document.getElementsByTagName("head");if(t)return t[0]}function s(e){const t=e.navigator.userAgent.match(/maglev\/(\d+\.\d+\.\d+\.\d+)/);return t&&t.length>1?t[1]:void 0}function l(e,t){let n=(null==t?void 0:t.environment)||"prod";return"infer"===n&&(n=function(e){return e.location.origin.includes("gov")?"gcchigh":e.location.origin.includes("dod")?"dod":e.location.origin.includes("live")?"life":"prod"}(e)),n}const d=e=>e===i.UF.UpgradeNonBlocking||e===i.UF.Warm;function c(e){var t,n;const i=null===(n=null===(t=e.navigator)||void 0===t?void 0:t.serviceWorker)||void 0===n?void 0:n.controller;return"activated"===(null==i?void 0:i.state)}},836516:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o});var i=n(411713),a=n(741327);class o{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCallById(e){this.routingService.navigate(this.callByIdDescriptor(e))}toCallList(){this.routingService.navigate(this.callsListDescriptor())}callByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:i._.calls,id:e}]})}callsListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:i._.calls,action:i.a.list}]})}concatToAppDescriptor(e){const t=this.rootRoutingService.callingAppDescriptor();return(0,a.MJ)(t,e)}}},751902:(e,t,n)=>{"use strict";var i;n.d(t,{e:()=>r}),function(e){e.OrgChart="organization"}(i||(i={}));var a=n(411713),o=n(741327);class r{constructor(e,t){this.routingService=e,this.rootRoutingService=t}toCreateChatWithUsers(e){this.routingService.navigate(this.createChatWithUsersDescriptor(e))}toChatById(e){this.routingService.navigate(this.chatByIdDescriptor(e))}toOrgChart(e){this.routingService.navigate(this.orgChartDescriptor(e))}toChatList(){this.routingService.navigate(this.chatListDescriptor())}chatByIdDescriptor(e){return this.concatToAppDescriptor({resources:[{resource:a._.chats,id:e}]})}createChatWithUsersDescriptor(e){const t=JSON.stringify(e&&e.length>0?e.sort():[]);return this.concatToAppDescriptor({resources:[{resource:a._.chats,action:a.a.create,id:t}]})}chatListDescriptor(){return this.concatToAppDescriptor({resources:[{resource:a._.chats,action:a.a.list}]})}orgChartDescriptor(e){const t=this.createChatWithUsersDescriptor([e]);return(0,o.MJ)(t,{resources:[{resource:a._.extensions,id:i.OrgChart}]})}concatToAppDescriptor(e){const t=this.rootRoutingService.chatAppDescriptor();return(0,o.MJ)(t,e)}}},554917:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var i=n(741327);class a{constructor(e,t){this._history=t,this._logger=e.newLogger("External Routing Service")}serializeToPath(e){const{descriptor:t,exact:n}=e;let a="";return t&&(a=(0,i.XP)({descriptor:t})),this._history?n||(a=this._history.createHref({pathname:a}).toString()):n&&this._logger.error("Unable to execute on history to generate absolute path. History initialized with undefined"),a}}},94621:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var i=n(411713);class a{meetingOptionsPageDescriptor(e){const{tenantId:t,organizerId:n,threadId:a,messageId:o,additionalMessageId:r,search:s}=e;return{resources:[{resource:i._.meetings,id:JSON.stringify({tenantId:t,organizerId:n,threadId:a,messageId:o,additionalMessageId:r})}],search:s}}meetingOptionsLicenseDescriptor(e){return{resources:[{resource:i._.licenses,action:i.a.list}],search:e?e.search:void 0}}}},221282:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(79647),a=n(411713);class o{constructor(e){this._routingService=e}toAppById(e){this._routingService.navigate(this.appDescriptor(e))}chatAppDescriptor(){return this.appDescriptor(i.dS)}callingAppDescriptor(){return this.appDescriptor(i.Pz)}meetingOptionsAppDescriptor(){return this.appDescriptor(i.s_)}fileAppDescriptor(){return this.appDescriptor(i.Tu)}appDescriptor(e,t){return{resources:[{resource:a._.apps,id:e,action:t}]}}}},741327:(e,t,n)=>{"use strict";n.d(t,{MJ:()=>u,XP:()=>m,Or:()=>p,Df:()=>y,mR:()=>k});var i=n(231191),a=n(411713),o=n(972124),r=n(892891);const s=new Map,l=/^\/|\/$/g;function d(e,t){const n=t?":":"",i=e.id?`/${n}${e.id}`:"",a=e.action?`/${e.action}`:"";return`${e.resource}${i}${a}`}function c(e){const{descriptor:t,asPath:n,stem:a=""}=e,o=(0,i.__rest)(e,["descriptor","asPath","stem"]);let r=a;const s=t?t.resources:void 0;if(s&&s.length>0)for(const e of s)r=`${r}/${d(e,n)}`;return Object.assign(Object.assign({},o),{descriptor:t,asPath:n,stem:r})}function u(...e){return e.reduce(((e,t)=>(e.resources=e.resources.concat(t.resources),e.search=Object.assign(Object.assign({},e.search),t.search),e)),{resources:[],search:{}})}function m(e){return(0,r.flow)([c,h,f])(e).stem}function g(e){if(!e||0===e.length)return[];const t=s.get(e);if(t)return t;let n=[];const i=e.replace(l,"");if(0===i.length)return n;const o=i.split("/");try{const t=function(e){const t=[];let n=-1;for(const i of e){const e=i;a._[e]&&(n++,t[n]=[]),n>=0&&t[n].push(e)}return t}(o);return t&&(n=t.map((e=>{let t;const n=2,i=3;switch(e.length){case i:t={resource:e[0],id:e[1],action:e[n]};break;case n:{const n=e[1];t=a.a[n]?{resource:e[0],action:e[1]}:{resource:e[0],id:e[1]};break}default:throw new Error("Invalid resource fragment format found, id or action is required.")}return t}))),s.size<1e3&&s.set(e,n),n}catch(e){throw new Error(`Unable to parse path into proper resources. ${e.message}`)}}function p(e){return(0,o.Qc)(e||"")}function v(e){return(0,o.Pz)(e||{})}function h(e){const{context:t,asPath:n,stem:i=""}=e;let a=i;if(t){const e=t.router;if(!e)throw new Error("Cannot generate a relative path without a context. Verify a context was added provided");{const t=n?e.route.match.path:e.route.match.url;a="/"!==t?`${t}${a}`:a}}return Object.assign(Object.assign({},e),{stem:a})}function f(e){const{descriptor:t,asPath:n,stem:i=""}=e;let a=i;if(t){const e=v(t.search);e&&(a=`${a}${n?`/:${e}`:`?${e}`}`)}return Object.assign(Object.assign({},e),{stem:a})}function y(e){const{search:t}=e,n=(0,i.__rest)(e,["search"]),a=v(t);return{pathname:m({descriptor:n}),search:a}}function k(e){const{pathname:t,search:n}=e;return{resources:g(t),search:p(n)}}},241514:(e,t,n)=>{"use strict";var i;n.d(t,{S:()=>r}),function(e){e[e.Allow=0]="Allow",e[e.Block=1]="Block"}(i||(i={}));class a{constructor(){this._taps=[]}tap(e){return this._taps.push(e),()=>{this._taps=this._taps.filter((t=>t!==e))}}call(e){let t;for(const n of this._taps){const i=n({data:e,previousResult:t});void 0!==i&&(t=i)}return t}}var o=n(741327);class r{constructor(e){this._history=e,this.onNavigationBlocked=new a,this.onNavigationStart=new a,this.onNavigationSucceeded=new a,this._handleNavigationStart=e=>{if(!this._history||!this._history.location)return;const t=this._history.location,n=(0,o.mR)(t),a=(0,o.mR)(e);return this.onNavigationStart.call({from:n,to:a})===i.Block?(this.onNavigationBlocked.call({to:a}),!1):void 0},this._handleNavigationSuccess=e=>{const t=(0,o.mR)(e);this.onNavigationSucceeded.call({to:t})},this._history&&this._history.block&&this._history.block(this._handleNavigationStart),this._history&&this._history.listen&&this._history.listen(this._handleNavigationSuccess)}}},249049:(e,t,n)=>{"use strict";n.d(t,{I:()=>p,s:()=>v});var i=n(664059),a=n(537950),o=n(751902),r=n(836516),s=n(221282),l=n(241514),d=n(642115),c=n(281857),u=n(94621),m=n(554917);let g;const p=(e,t,n)=>{const d=new i.Z(e,t),c=new s.A(d),p={state:new a.M(e,n,t),root:c,call:new r.Y(d,c),chat:new o.e(d,c),meeting:new u.R,external:new m.z(e,t),hooks:new l.S(t)};return g=p,g},v=()=>{if(!g)throw(0,d.Tr)("RoutingServices",c.jK.NotInitialized,"getInstance");return g}},664059:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(741327);class a{constructor(e,t){this.history=t,this._logger=e.newLogger("Routing Service")}navigate(e){const t=(0,i.Df)(e);this.execute(t)}execute(e){this.history?this.history.push(e):this._logger.error("Unable to route using history. History initialized with undefined")}}},537950:(e,t,n)=>{"use strict";n.d(t,{M:()=>a});var i=n(741327);class a{constructor(e,t,n){this._location=t,this._history=n,this._logger=e.newLogger("State Routing Service")}getSearchState(){const e=this.getLocation();if(!e)return{};const t=e.search;return t!==this._previousSearch&&(this._previousSearch=t,this._currentState=(0,i.Or)(t)),this._currentState||{}}getOrigin(){const e=this.getLocation();return e&&e.origin}getHost(){const e=this.getLocation();return e&&e.host}getPathname(){const e=this.getLocation();return e&&e.pathname}getLocation(){if(this._location||this._logger.error("Unable to execute on location. Location initialized with undefined"),this._location&&this._history&&this._history.location){const{search:e,pathname:t}=this._history.location;return Object.assign(Object.assign({},this._location),{search:e,pathname:t})}return this._location}}},514400:(e,t,n)=>{"use strict";n.d(t,{Q6:()=>r,bE:()=>s,qo:()=>l});var i=n(118824),a=n(513356),o=n(892891);const r=e=>{const t=e.get(i.J.Host).enableSyncEngine;return(0,o.isNil)(t)?!!e.get(i.J.CdlWorker).enableSyncEngine:t},s=e=>{const t=e.get(i.J.Host).enableProfileManagerStore;return(0,o.isNil)(t)?!!e.get(i.J.People).enableProfileManagerStore:t},l=e=>{const{dataStoreMapType:t,disableDataStoreInMemoryProvider:n}=e.get(i.J.CdlWorker);return n?"none":t||a.o}},644174:(e,t,n)=>{"use strict";n.d(t,{ip:()=>c,Yx:()=>u,MI:()=>m,P3:()=>g,aA:()=>p});var i=n(928908),a=n(359052),o=n(374964),r=n(250570),s=n(790688),l=n(661564);const d="heartbeat";class c{constructor(){this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=()=>this.telemetryProvider.flush(),this.telemetryProvider=(0,i.G)(),(0,o.Y)((()=>{this.initialized=!1,this.eventDecoratorCallbacks=[]}))}get sessionId(){return this.telemetryProvider.sessionId}initialize(e,t){this.initialized||(this.consoleLogger=e,this.consoleLogger.debug("TelemetrySender initialized."),this._tablePostfix=t,this.initialized=!0)}static getInstance(){return this.telemetrySender||(this.telemetrySender=new c),this.telemetrySender}registerEventDecorator(e){this.eventDecoratorCallbacks.push(e)}sendTelemetry(e,t,n={},i,o,d,c=""){if(!this.initialized)return;t=t.replace(/\-/g,"_").toLowerCase();const u=`${r.x[e]}${this._tablePostfix}`.toLowerCase(),m=e===r.x.Http?n.resultCode:e===r.x.Endpoint&&n.result&&l.qb[n.result]?l.qb[n.result].toString():e===r.x.Endpoint&&n.hasInnerError?"fail":"success",g=s.H.getInstance().getSampleRate(u,null!=d?d:t,m);if(g===s.k)return;this.decorateEvent(t,n);const p=this.telemetryProvider.createEvent(u,t,n,i,o,d);p.setProperty("sampleRate",g),this.telemetryProvider.logEvent(a.hy.default,p,c)}sendScenarioEvent(e,t,n,i,o,l=""){if(!this.initialized)return;const d=e.replace(/\-/g,"_").toLowerCase(),c=`${r.x[r.x.Scenario]}${this._tablePostfix}`.toLowerCase(),u=s.H.getInstance().getSampleRate(c,d,n["Scenario.Status"]);if(u===s.k)return;this.decorateEvent(d,t);const m=Object.assign(Object.assign({},n),t),g=this.telemetryProvider.createEvent(c,e,m,i,o);g.setProperty("sampleRate",u),this.telemetryProvider.logEvent(a.hy.default,g,l)}sendHeartbeatEvent(e){if(!this.initialized)return;const t=`${r.x[r.x.Heartbeat]}${this._tablePostfix}`.toLowerCase();this.decorateEvent(d,e);const n=this.telemetryProvider.createEvent(t,d,e);this.telemetryProvider.logEvent(a.hy.default,n,void 0)}sendLoggingEvent(e,t,n,i,o,l){if(!this.initialized)return;e=e.replace(/\-/g,"_").toLowerCase();const d=`${r.x[r.x.Logging]}${this._tablePostfix}`.toLowerCase(),c=s.H.getInstance().getSampleRate(d,n,t.logLevel);if(c===s.k)return;this.decorateEvent(e,t);const u=this.telemetryProvider.createEvent(d,e,t,o,l,n);u.setProperty("sampleRate",c),this.telemetryProvider.logEvent(a.hy.default,u,i)}decorateEvent(e,t){this.eventDecoratorCallbacks.forEach((n=>n(e,t)))}}function u(e,t,n,i,a,o=""){c.getInstance().sendScenarioEvent(e,t,n,i,a,o)}function m(e,t,n,i,a,o=""){c.getInstance().sendLoggingEvent(e,t,n,o,i,a)}function g(e,t,n,i,a,o,r=""){c.getInstance().sendTelemetry(e,t,n,i,a,o,r)}function p(e){c.getInstance().sendHeartbeatEvent(e)}},340487:(e,t,n)=>{"use strict";n.d(t,{S:()=>a});var i=n(324819);class a{constructor(){this._id=(0,i.v4)(),this._dispose=null,this._data={}}get id(){return this._id}get data(){return this._data}set alertName(e){this._data["DataBag.alertName"]=e}set allAliasesTurnedOff(e){this._data["DataBag.allAliasesTurnedOff"]=e}set allAliasesWithPrivateVisibility(e){this._data["DataBag.allAliasesWithPrivateVisibility"]=e}set tabAppCount(e){this._data["DataBag.tabAppCount"]=e}set appId(e){this._data["DataBag.appId"]=e}set appInstallScope(e){this._data["DataBag.appInstallScope"]=e}set appStoreOriginSource(e){this._data["DataBag.appStoreOriginSource"]=e}set isUserPartOfMeetingAttendeesCount(e){this._data["DataBag.activeCallsCount"]=e}set setIsMeetingGame(e){this._data["DataBag.isMeetingGame"]=e}set autoreconnectShown(e){this._data["DataBag.autoreconnectShown"]=e}set backSpaceCount(e){this._data["DataBag.backSpaceCount"]=e}set bannerScenario(e){this._data["DataBag.bannerScenario"]=e}set bannerPageIndex(e){this._data["DataBag.bannerPageIndex"]=e}set callId(e){this._data["DataBag.callId"]=e}set callParticipantUserRole(e){this._data["DataBag.callParticipantUserRole"]=e}set callType(e){this._data["DataBag.callType"]=e}set callHistoryItemFetched(e){this._data["Calling.callHistoryItemFetched"]=e}set callHistoryItemDisplayed(e){this._data["Calling.callHistoryItemDisplayed"]=e}set callHistoryItemUiLimit(e){this._data["Calling.callHistoryItemUiLimit"]=e}set callHistoryItemCountIsBelowLimit(e){this._data["Calling.callHistoryItemCountIsBelowLimit"]=e}set callHistoryDelegatorId(e){this._data["Calling.callHistoryDelegatorId"]=e}set cardHasMentions(e){this._data["DataBag.cardHasMentions"]=e}set cardSenderType(e){this._data["DataBag.cardSenderType"]=e}set cardSenderUserId(e){this._data["DataBag.cardSenderUserId"]=e}set cardType(e){this._data["DataBag.cardType"]=e}set cardAggregatedCount(e){this._data["DataBag.cardAggregatedCount"]=e}set category(e){this._data["DataBag.category"]=e}set chatDensity(e){this._data["DataBag.chatDensity"]=e}set chatMembersCount(e){this._data["DataBag.chatMembersCount"]=e}set channelView(e){this._data["DataBag.channelView"]=e}set dataFetched(e){this._data["DataBag.dataFetched"]=e}set displayMode(e){this._data["DataBag.displayMode"]=e}set eventOrigin(e){this._data["DataBag.eventOrigin"]=e}set isChannelsV2(e){this._data["DataBag.isChannelsV2"]=e}set teamId(e){this._data["DataBag.teamId"]=e}set channelId(e){this._data["DataBag.channelId"]=e}set dwellTime(e){this._data["DataBag.dwellTime"]=e}set hasNewUpdates(e){this._data["DataBag.hasNewUpdates"]=e}set resourceType(e){this._data["DataBag.resourceType"]=e}set teamOfficeGroupId(e){this._data["Channels.teamOfficeGroupId"]=e}set deeplinkId(e){this._data["DataBag.deeplinkId"]=e}set dialIn(e){this._data["DataBag.dialIn"]=e}set dialOut(e){this._data["DataBag.dialOut"]=e}set eventType(e){this._data["DataBag.eventType"]=e}set hasAttachments(e){this._data["DataBag.hasAttachments"]=e}set hasExternalAttendees(e){this._data["DataBag.hasExternalAttendees"]=e}set isAllDayEvent(e){this._data["DataBag.isAllDayEvent"]=e}set isCancelled(e){this._data["DataBag.isCancelled"]=e}set isGroupChatRenamed(e){this._data["DataBag.isGroupChatRenamed"]=e}set newChatIntentId(e){this._data["DataBag.newChatIntentId"]=e}set isMeetingLive(e){this._data["DataBag.isMeetingLive"]=e}set isNetworkIssue(e){this._data["DataBag.isNetworkIssue"]=e}set isNewToVideoFilter(e){this._data["DataBag.isNewToVideoFilter"]=e}set isOwnInvite(e){this._data["DataBag.isOwnInvite"]=e}set isUserPartOfMeetingAttendees(e){this._data["DataBag.isUserPartOfMeetingAttendees"]=e}set isUnSupportedCard(e){this._data["DataBag.isUnSupportedCard"]=e}set isWXPFile(e){this._data["DataBag.isWXPFile"]=e}set isRequestWithAdminConfigUrl(e){this._data["PlatformUserLifeCycle.isRequestWithAdminConfigUrl"]=e}set isInstalledApp(e){this._data["PlatformUserLifeCycle.isInstalledApp"]=e}set subscriptionButtonType(e){this._data["AppMonetization.subscriptionButtonType"]=e}set joinLinkChatType(e){this._data["DataBag.joinLinkChatType"]=e}set joinLinkId(e){this._data["DataBag.joinLinkId"]=e}set joinLinkRedeemFailureReason(e){this._data["DataBag.joinLinkRedeemFailureReason"]=e}set joinLinkType(e){this._data["DataBag.joinLinkType"]=e}set joinLinkVariant(e){this._data["DataBag.joinLinkVariant"]=e}set wasShared(e){this._data["DataBag.wasShared"]=e}set sharedBy(e){this._data["DataBag.sharedBy"]=e}set mediaElementSource(e){this._data["Extensibility.mediaElementSource"]=e}set userType(e){this._data["Extensibility.userType"]=e}set meetingType(e){this._data["DataBag.meetingType"]=e}set meetingChatType(e){this._data["DataBag.meetingChatType"]=e}set meetingChatRegion(e){this._data["DataBag.meetingChatRegion"]=e}set meetingParticipants(e){this._data["DataBag.meetingParticipants"]=e}set shareWindowsCount(e){this._data["DataBag.shareWindowsCount"]=e}set shareScreensCount(e){this._data["DataBag.shareScreensCount"]=e}set meetingDuration(e){this._data["DataBag.meetingDuration"]=e}set totalCallParticipants(e){this._data["DataBag.totalCallParticipants"]=e}set isXboxWatchParty(e){this._data["DataBag.isXboxWatchParty"]=e}set meetingRecurrence(e){this._data["DataBag.meetingRecurrence"]=e}set meetingScheduledEndTime(e){this._data["DataBag.meetingScheduledEndTime"]=e}set meetingScheduledStartTime(e){this._data["DataBag.meetingScheduledStartTime"]=e}set mentionType(e){this._data["DataBag.mentionType"]=e}set participantId(e){this._data["DataBag.participantId"]=e}set participantCount(e){this._data["ModernStage.participantCount"]=e}set isPopout(e){this._data["ModernStage.isPopout"]=e}set defaultSize(e){this._data["ModernStage.defaultSize"]=e}set fromSize(e){this._data["ModernStage.fromSize"]=e}set toSize(e){this._data["ModernStage.toSize"]=e}set pickerUsageArea(e){this._data["DataBag.pickerUsageArea"]=e}set previousCallId(e){this._data["DataBag.previousCallId"]=e}set previousParticipantId(e){this._data["DataBag.previousParticipantId"]=e}set roomIndex(e){this._data["DataBag.roomIndex"]=e}set actionableAppProfileCard(e){this._data["GrowthPlatform.actionableAppProfileCard"]=e}set actionType(e){this._data["DataBag.actionType"]=e}set suggestionSecondaryActionType(e){this._data["Powerbar.suggestionSecondaryActionType"]=e}set fromExposeBotActions(e){this._data["DataBag.fromExposeBotActions"]=e}set didRenderChatOpenAppAction(e){this._data["Extensibility.didRenderChatOpenAppAction"]=e}set fromDeepLink(e){this._data["Extensibility.fromDeepLink"]=e}set installedAppsCount(e){this._data["DataBag.installedAppsCount"]=e}set isStaticTab(e){this._data["DataBag.isStaticTab"]=e}set isPreconsentedApp(e){this._data["DataBag.isPreconsentedApp"]=e}set atMentions(e){this._data["DataBag.atmentions"]=e}set attachmentIds(e){this._data["DataBag.attachmentIds"]=e}set attachments(e){this._data["DataBag.attachments"]=e}set autoDetectedLang(e){this._data["DataBag.autoDetectedLang"]=e}set avatarBackgroundId(e){this._data["DataBag.avatarBackgroundId"]=e}set avatarId(e){this._data["DataBag.avatarId"]=e}set isBrandedBackground(e){this._data["CMD.isBrandedBackground"]=e}set isBrandedColor(e){this._data["CMD.isBrandedColor"]=e}set isBrandedLogo(e){this._data["CMD.isBrandedLogo"]=e}set isVideoOn(e){this._data["CMD.isVideoOn"]=e}set joinWithOutgoingAudio(e){this._data["DataBag.joinWithOutgoingAudio"]=e}set joinWithOutgoingVideo(e){this._data["DataBag.joinWithOutgoingVideo"]=e}set joinWithIncomingAudio(e){this._data["DataBag.joinWithIncomingAudio"]=e}set wasAutomuteTriggered(e){this._data["DataBag.wasAutomuteTriggered"]=e}set wasRoomLoudSpeakerInTheMeetingTriggered(e){this._data["DataBag.wasRoomLoudSpeakerInTheMeetingTriggered"]=e}set wasRoomBluetoothProximityTriggered(e){this._data["DataBag.wasRoomBluetoothProximityTriggered"]=e}set raisedHandWithSkinTone(e){this._data["DataBag.raisedHandWithSkinTone"]=e}set botmentionedMriCollection(e){this._data["DataBag.botmentionedMriCollection"]=e}set botMentions(e){this._data["DataBag.botMentions"]=e}set breakoutRoomsAssignablePeopleCount(e){this._data["DataBag.breakoutRoomsAssignablePeopleCount"]=e}set breakoutRoomsAssignmentType(e){this._data["DataBag.breakoutRoomsAssignmentType"]=e}set breakoutRoomsAssignmentsCount(e){this._data["DataBag.breakoutRoomsAssignmentsCount"]=e}set breakoutRoomsAssignmentPerRoom(e){this._data["DataBag.breakoutRoomsAssignmentPerRoom"]=e}set breakoutRoomsAssignmentSortBy(e){this._data["DataBag.breakoutRoomsAssignmentSortBy"]=e}set breakoutRoomsExperience(e){this._data["DataBag.breakoutRoomsExperience"]=e}set breakoutRoomsCount(e){this._data["DataBag.breakoutRoomsCount"]=e}set breakoutRoomsEndpointsCount(e){this._data["DataBag.breakoutRoomsEndpointsCount"]=e}set isRecreation(e){this._data["BreakoutRooms.isRecreation"]=e}set panelContent(e){this._data["BreakoutRooms.panelContent"]=e}set breakoutRoomsPreMeetingSessionId(e){this._data["DataBag.breakoutRoomsPreMeetingSessionId"]=e}set breakoutRoomsSupportedEndpointsCount(e){this._data["DataBag.breakoutRoomsSupportedEndpointsCount"]=e}set broadcastDeviceId(e){this._data["DataBag.broadcastDeviceId"]=e}set broadcastPlatform(e){this._data["DataBag.broadcastPlatform"]=e}set broadcastOrganizerTenantId(e){this._data["DataBag.broadcastOrganizerTenantId"]=e}set broadcastRole(e){this._data["VirtualEvent.broadcastRole"]=e}set brSettingsAllowJoinBackToMainMeeting(e){this._data["DataBag.brSettingsAllowJoinBackToMainMeeting"]=e}set brSettingsAllowMoveParticipantsAutomatically(e){this._data["DataBag.brSettingsAllowMoveParticipantsAutomatically"]=e}set brSettingsAllowUsersToSelectBreakoutRoom(e){this._data["DataBag.brSettingsAllowUsersToSelectBreakoutRoom"]=e}set brSettingsManagers(e){this._data["DataBag.brSettingsManagers"]=e}set brSettingsRoomDuration(e){this._data["DataBag.brSettingsRoomDuration"]=e}set cachedPeopleResultsCount(e){this._data["DataBag.cachedPeopleResultsCount"]=e}set calendarSource(e){this._data["DataBag.calendarSource"]=e}set calendarType(e){this._data["DataBag.calendarType"]=e}set castSharePTT(e){this._data["DataBag.castSharePTT"]=e}set castShareScreen(e){this._data["DataBag.castShareScreen"]=e}set castComputerSound(e){this._data["DataBag.castComputerSound"]=e}set chainId(e){this._data["DataBag.chainid"]=e}set canSupportBreakoutRooms(e){this._data["DataBag.canSupportBreakoutRooms"]=e}set channelCount(e){this._data["DataBag.channelCount"]=e}set channelMentions(e){this._data["DataBag.channelmentions"]=e}set cleanupEnabled(e){this._data["ContentCamera.cleanupEnabled"]=e}set clickFromCTA(e){this._data["DataBag.clickFromCTA"]=e}set codeSnippets(e){this._data["DataBag.codeSnippets"]=e}set column(e){this._data["DataBag.column"]=e}set commandId(e){this._data["Databag.commandId"]=e}set commandSource(e){this._data["DataBag.commandSource"]=e}set containsTflSMSMember(e){this._data["DataBag.containsTflSMSMember"]=e}set contentCameraScanType(e){this._data["ContentCamera.contentCameraScanType"]=e}set contentType(e){this._data["DataBag.contentType"]=e}set videoEnvironment(e){this._data["DataBag.videoEnvironment"]=e}set countOfEdits(e){this._data["DataBag.countOfEdits"]=e}set cqId(e){this._data["DataBag.cqId"]=e}set isOptIn(e){this._data["DataBag.isOptIn"]=e}set campaignId(e){this._data["DataBag.campaignId"]=e}set dialogState(e){this._data["DataBag.dialogState"]=e}set dialogType(e){this._data["DataBag.dialogType"]=e}set dismissType(e){this._data["DataBag.dismissType"]=e}set directSubstrateCallEnabled(e){this._data["DataBag.directSubstrateCallEnabled"]=e}set edgeDetectionEnabled(e){this._data["ContentCamera.edgeDetectionEnabled"]=e}set editAge(e){this._data["DataBag.editAge"]=e}set emoji(e){this._data["DataBag.emoji"]=e}set emojiCategory(e){this._data["DataBag.emojiCategory"]=e}set emojiList(e){this._data["DataBag.emojiList"]=e}set entityId(e){this._data["DataBag.entityId"]=e}set entityType(e){this._data["DataBag.entityType"]=e}set entitySubType(e){this._data["DataBag.entitySubType"]=e}set entryPoint(e){this._data["DataBag.entryPoint"]=e}set endpointId(e){this._data["DataBag.endpointId"]=e}set federatedAndBotsResultsCount(e){this._data["DataBag.federatedAndBotsResultsCount"]=e}set feedId(e){this._data["DataBag.feedId"]=e}set offNetworkContactsSelected(e){this._data["DataBag.offNetworkContactsSelected"]=e}set sentGIFsInMessage(e){this._data["DataBag.GIF"]=e}set sentStickersInMessage(e){this._data["DataBag.Sticker"]=e}set originatedTimeStamp(e){this._data["DataBag.originatedTimeStamp"]=e}set fileAction(e){this._data["DataBag.fileAction"]=e}set fileControl(e){this._data["DataBag.fileControl"]=e}set fileId(e){this._data["DataBag.fileId"]=e}set fileSource(e){this._data["DataBag.fileSource"]=e}set suggestedFileContext(e){this._data["Files.suggestedFileContext"]=e}set fileViewerType(e){this._data["Files.fileViewerType"]=e}set fileViewerAppId(e){this._data["Files.fileViewerAppId"]=e}set fileExtension(e){this._data["DataBag.fileExtension"]=e}set fileTypeList(e){this._data["DataBag.fileTypeList"]=e}set filterApplied(e){this._data["DataBag.filterApplied"]=e}set renderableItemsCount(e){this._data["DataBag.renderableItemsCount"]=e}set filterType(e){this._data["DataBag.filterType"]=e}set folderLevel(e){this._data["DataBag.folderLevel"]=e}set giphy(e){this._data["DataBag.giphy"]=e}set groupType(e){this._data["DataBag.groupType"]=e}set groupTemplateType(e){this._data["DataBag.groupTemplateType"]=e}set hasAADFederatedMembers(e){this._data["DataBag.hasAADFederatedMembers"]=e}set hasMSAFederatedMembers(e){this._data["DataBag.hasMSAFederatedMembers"]=e}set importantflag(e){this._data["DataBag.importantflag"]=e}set insightType(e){this._data["AiInsights.insightType"]=e}set inlineImages(e){this._data["DataBag.inlineImages"]=e}set inputExtensionAppNameCollection(e){this._data["DataBag.inputExtensionAppNameCollection"]=e}set inputExtensionMrisCollection(e){this._data["DataBag.inputExtensionMrisCollection"]=e}set installDialogResult(e){this._data["DataBag.installDialogResult"]=e}set isActionOnSeries(e){this._data["DataBag.isActionOnSeries"]=e}set isContextMenuVisible(e){this._data["DataBag.isContextMenuVisible"]=e}set graphAppCount(e){this._data["ActivitySettings.graphAppCount"]=e}set graphAppId(e){this._data["ActivitySettings.graphAppId"]=e}set mtmaAccountNotificationsCount(e){this._data["DataBag.mtmaAccountNotificationsCount"]=e}set missedMtmaTotalNotificationsCount(e){this._data["DataBag.missedMtmaTotalNotificationsCount"]=e}set accountNotificationPositionInList(e){this._data["DataBag.accountNotificationPositionInList"]=e}set totalMtmaAccountsHavingNotifications(e){this._data["DataBag.totalMtmaAccountsHavingNotifications"]=e}set totalMtmaTenantsHavingNotifications(e){this._data["DataBag.totalMtmaTenantsHavingNotifications"]=e}set appBootType(e){this._data["DataBag.appBootType"]=e}set notificationSignalsList(e){this._data["DataBag.notificationSignalsList"]=e}set mostRecentNotificationSignal(e){this._data["DataBag.mostRecentNotificationSignal"]=e}set callingToastType(e){this._data["DataBag.callingToastType"]=e}set chatToastType(e){this._data["DataBag.chatToastType"]=e}set communitiesToastType(e){this._data["DataBag.communitiesToastType"]=e}set isDefaultFileOpenEndPointUsed(e){this._data["DataBag.isDefaultFileOpenEndPointUsed"]=e}set isGalleryEmpty(e){this._data["DataBag.isGalleryEmpty"]=e}set isLastKeyDownBackSpace(e){this._data["DataBag.isLastKeyDownBackSpace"]=e}set isModified(e){this._data["DataBag.isModified"]=e}set isNewChat(e){this._data["DataBag.isNewChat"]=e}set isOnlineMeeting(e){this._data["DataBag.isOnlineMeeting"]=e}set isPasted(e){this._data["DataBag.isPasted"]=e}set isPrivate(e){this._data["DataBag.isPrivate"]=e}set isReplyToEmailMessage(e){this._data["DataBag.isReplyToEmailMessage"]=e}set itemsCount(e){this._data["DataBag.itemsCount"]=e}set language(e){this._data["DataBag.language"]=e}set Latency(e){this._data["DataBag.Latency"]=e}set leftRailDirective(e){this._data["DataBag.leftRailDirective"]=e}set links(e){this._data["DataBag.links"]=e}set meetingCategories(e){this._data["DataBag.meetingCategories"]=e}set messageId(e){this._data["DataBag.messageID"]=e}set messageLength(e){this._data["DataBag.messagelength"]=e}set messageType(e){this._data["DataBag.messageType"]=e}set mriCollection(e){this._data["DataBag.mricollection"]=e}set mtResultCount(e){this._data["DataBag.mtResultCount"]=e}set name(e){this._data["DataBag.name"]=e}set namedGroupChatsResultsCount(e){this._data["DataBag.namedGroupChatsResultsCount"]=e}set negativeType(e){this._data["AiInsights.negativeType"]=e}set negativeReason(e){this._data["AiInsights.negativeReason"]=e}set newReaction(e){this._data["DataBag.newReaction"]=e}set newSettingsValue(e){this._data["DataBag.newSettingsValue"]=e}set netTimeTaken(e){this._data["DataBag.netTimeTaken"]=e}set networkSearchCount(e){this._data["DataBag.networkSearchCount"]=e}set nextView(e){this._data["DataBag.nextView"]=e}set notifyOrganizer(e){this._data["DataBag.notifyOrganizer"]=e}set numberOfAliases(e){this._data["DataBag.numberOfAliases"]=e}set numberOfAliasesTurnedOn(e){this._data["DataBag.numberOfAliasesTurnedOn"]=e}set numberOfAliasesTurnedOff(e){this._data["DataBag.numberOfAliasesTurnedOff"]=e}set numberOfAliasVisibilitySettings(e){this._data["DataBag.numberOfAliasVisibilitySettings"]=e}set referrer(e){this._data["DataBag.referrer"]=e}set numberOfAliasesWithPublicVisibility(e){this._data["DataBag.numberOfAliasesWithPublicVisibility"]=e}set numberOfAliasesWithPrivateVisibility(e){this._data["DataBag.numberOfAliasesWithPrivateVisibility"]=e}set newAliasVisibilityValue(e){this._data["DataBag.newAliasVisibilityValue"]=e}set numberOfEvents(e){this._data["DataBag.numberOfEvents"]=e}set numberOfEventsWithArtifacts(e){this._data["DataBag.numberOfEventsWithArtifacts"]=e}set numberOfAppointments(e){this._data["DataBag.numberOfAppointments"]=e}set numberOfEncryptedEvents(e){this._data["DataBag.numberOfEncryptedEvents"]=e}set totalMeetingMinutes(e){this._data["DataBag.totalMeetingMinutes"]=e}set totalAppointmentMinutes(e){this._data["DataBag.totalAppointmentMinutes"]=e}set numberOfCategorizedEvents(e){this._data["DataBag.numberOfCategorizedEvents"]=e}set oldSettingsValue(e){this._data["DataBag.oldSettingsValue"]=e}set numUsersSelectedViaPicker(e){this._data["DataBag.numUsersSelectedViaPicker"]=e}set optionsAvailable(e){this._data["DataBag.optionsAvailable"]=e}set optionsChanged(e){this._data["DataBag.optionsChanged"]=e}set meetingOptionsPresenterCount(e){this._data["MeetingOptions.meetingOptionsPresenterCount"]=e}set meetingOptionsCoorganizerCount(e){this._data["MeetingOptions.meetingOptionsCoorganizerCount"]=e}set meetingOptionsCoorganizerPromoteCount(e){this._data["MeetingOptions.meetingOptionsCoorganizerPromoteCount"]=e}set meetingOptionsCoorganizerDemoteCount(e){this._data["MeetingOptions.meetingOptionsCoorganizerDemoteCount"]=e}set meetingOptionsActedFrom(e){this._data["MeetingOptions.meetingOptionsActedFrom"]=e}set meetingOptionsSkinType(e){this._data["MeetingOptions.meetingOptionsSkinType"]=e}set selectedSensitivityLabel(e){this._data["MeetingOptions.selectedSensitivityLabel"]=e}set autoAdmittedUsers(e){this._data["MeetingOptions.autoAdmittedUsers"]=e}set allowPstnUsersToBypassLobby(e){this._data["MeetingOptions.allowPstnUsersToBypassLobby"]=e}set entryExitAnnouncementsEnabled(e){this._data["MeetingOptions.entryExitAnnouncementsEnabled"]=e}set coOrganizers(e){this._data["MeetingOptions.coOrganizers"]=e}set presenterOption(e){this._data["MeetingOptions.presenterOption"]=e}set attendeeViewModes(e){this._data["MeetingOptions.attendeeViewModes"]=e}set attendeeRestrictions(e){this._data["MeetingOptions.attendeeRestrictions"]=e}set autoRecordingEnabled(e){this._data["MeetingOptions.autoRecordingEnabled"]=e}set allowMeetingChat(e){this._data["MeetingOptions.allowMeetingChat"]=e}set allowTeamsMeetingReactions(e){this._data["MeetingOptions.allowTeamsMeetingReactions"]=e}set interpretation(e){this._data["MeetingOptions.interpretation"]=e}set yammerQNAEnabled(e){this._data["MeetingOptions.yammerQNAEnabled"]=e}set recorderOption(e){this._data["MeetingOptions.recorderOption"]=e}set meetingEndToEndEncryption(e){this._data["MeetingOptions.meetingEndToEndEncryption"]=e}set forceAttendeeStreaming(e){this._data["MeetingOptions.forceAttendeeStreaming"]=e}set watermarkVbssEnabled(e){this._data["MeetingOptions.watermarkVbssEnabled"]=e}set watermarkVideoEnabled(e){this._data["MeetingOptions.watermarkVideoEnabled"]=e}set maskIdentitiesForRole(e){this._data["MeetingOptions.maskIdentitiesForRole"]=e}set order(e){this._data["DataBag.order"]=e}set organizerId(e){this._data["DataBag.organizerId"]=e}set personType(e){this._data["DataBag.personType"]=e}set pinned(e){this._data["DataBag.pinned"]=e}set position(e){this._data["DataBag.position"]=e}set postType(e){this._data["DataBag.postType"]=e}set previousReaction(e){this._data["DataBag.previousReaction"]=e}set producerLayout(e){this._data["DataBag.producerLayout"]=e}set producerSourceTypes(e){this._data["DataBag.producerSourceTypes"]=e}set quadDetected(e){this._data["ContentCamera.quadDetected"]=e}set queryLength(e){this._data["DataBag.queryLength"]=e}set reactionScenario(e){this._data["DataBag.reactionScenario"]=e}set read(e){this._data["DataBag.Read"]=e}set reportType(e){this._data["DataBag.reportType"]=e}set richText(e){this._data["DataBag.richText"]=e}set RelatedMesaageID(e){this._data["DataBag.RelatedMesaageID"]=e}set rightClickAction(e){this._data["DataBag.rightClickAction"]=e}set rosterSize(e){this._data["DataBag.rostersize"]=e}set serpFromState(e){this._data["DataBag.serpFromState"]=e}set serpToState(e){this._data["DataBag.serpToState"]=e}set searchResultPage(e){this._data["DataBag.searchResultPage"]=e}set searchResultPosition(e){this._data["DataBag.searchResultPosition"]=e}set searchResultPositionInGroup(e){this._data["DataBag.searchResultPositionInGroup"]=e}set searchSessionId(e){this._data["DataBag.searchSessionId"]=e}set serpEntryUserAction(e){this._data["DataBag.serpEntryUserAction"]=e}set searchTermLength(e){this._data["DataBag.searchTermLength"]=e}set searchTextLength(e){this._data["DataBag.searchTextLength"]=e}set isLongSearchText(e){this._data["Powerbar.isLongSearchText"]=e}set selectedAudienceScene(e){this._data["DataBag.selectedAudienceScene"]=e}set selectedCustomVideoBackground(e){this._data["DataBag.selectedCustomVideoBackground"]=e}set selectedView(e){this._data["ModernStage.selectedView"]=e}set sharedContent(e){this._data["ModernStage.sharedContent"]=e}set substrateCallResultCount(e){this._data["DataBag.substrateCallResultCount"]=e}set syncSource(e){this._data["DataBag.syncSource"]=e}set provider(e){this._data["DataBag.provider"]=e}set sfbInteropMessage(e){this._data["DataBag.sfbInteropMessage"]=e}set size(e){this._data["DataBag.size"]=e}set SmartReplyClickPosition(e){this._data["DataBag.SmartReplyClickPosition"]=e}set ChatSummaryOption(e){this._data["Messaging.ChatSummaryOption"]=e}set PositiveFeedback(e){this._data["Messaging.PositiveFeedback"]=e}set SmartReplyLength(e){this._data["DataBag.SmartReplyLength"]=e}set SmartReplyTTR(e){this._data["DataBag.SmartReplyTTR"]=e}set smartReplySuggestionType(e){this._data["DataBag.smartReplySuggestionType"]=e}set ContainsEmoji(e){this._data["Messaging.ContainsEmoji"]=e}set ContainsEmojiList(e){this._data["Messaging.ContainsEmojiList"]=e}set ContainsRenderedEmoji(e){this._data["Messaging.ContainsRenderedEmoji"]=e}set ContainsRenderedEmojiList(e){this._data["Messaging.ContainsRenderedEmojiList"]=e}set emojiIndex(e){this._data["Messaging.emojiIndex"]=e}set SmartReplyWhisperId(e){this._data["DataBag.SmartReplyWhisperId"]=e}set SmartReplySettingEnabled(e){this._data["DataBag.SmartReplySettingEnabled"]=e}set SmartReplySuggestionIds(e){this._data["DataBag.SmartReplySuggestionIds"]=e}set SmartReplyFileSuggestionCount(e){this._data["DataBag.SmartReplyFileSuggestionCount"]=e}set codeSnippetLength(e){this._data["DataBag.Source"]=e}set reactionSource(e){this._data["DataBag.source"]=e}set serviceName(e){this._data["DataBag.serviceName"]=e}set selectedId(e){this._data["DataBag.selectedId"]=e}set selectedIndex(e){this._data["DataBag.selectedIndex"]=e}set storeItemIds(e){this._data["PlatformUserLifeCycle.storeItemIds"]=e}set isCTA(e){this._data["PlatformUserLifeCycle.isCTA"]=e}set CTAType(e){this._data["PlatformUserLifeCycle.CTAType"]=e}set zeroStateSuggestionsDiscardedByTabCount(e){this._data["DataBag.zeroStateSuggestionsDiscardedByTabCount"]=e}set zeroStateSuggestionSelectedAtUserCount(e){this._data["DataBag.zeroStateSuggestionSelectedAtUserCount"]=e}set zeroStateSuggestionsDiscardedByEscCount(e){this._data["DataBag.zeroStateSuggestionsDiscardedByEscCount"]=e}set selectionType(e){this._data["DataBag.selectionType"]=e}set sourceMessageId(e){this._data["DataBag.sourceMessageId"]=e}set sourceThreadId(e){this._data["DataBag.sourceThreadId"]=e}set stateBookmark(e){this._data["DataBag.state_bookmark"]=e}set stateBookmarkDuration(e){this._data["DataBag.state_bookmarkDuration"]=e}set subjectPresent(e){this._data["DataBag.subjectpresent"]=e}set subType(e){this._data["DataBag.subType"]=e}set suggestionSource(e){this._data["DataBag.suggestionSource"]=e}set suggestedActionTypes(e){this._data["DataBag.suggestedActionTypes"]=e}set suggestedFile(e){this._data["DataBag.suggestedFile"]=e}set synthNotificationUserNeverTriedApp(e){this._data["DataBag.synthNotificationUserNeverTriedApp"]=e}set tabType(e){this._data["DataBag.tabType"]=e}set tagged(e){this._data["DataBag.Tagged"]=e}set tagResultsCount(e){this._data["DataBag.tagResultsCount"]=e}set teamMentions(e){this._data["DataBag.teammentions"]=e}set tflOffNetworkEmailCount(e){this._data["DataBag.tflOffNetworkEmailCount"]=e}set tflOffNetworkOneWayPhoneCount(e){this._data["DataBag.tflOffNetworkOneWayPhoneCount"]=e}set tflSMSMembersCount(e){this._data["DataBag.tflSMSMembersCount"]=e}set timeFromFirstInput(e){this._data["DataBag.timeFromFirstInput"]=e}set totalKeyStrokes(e){this._data["DataBag.totalKeyStrokes"]=e}set trackSummary(e){this._data["DataBag.trackSummary"]=e}set transcriptId(e){this._data["DataBag.transcriptId"]=e}set type(e){this._data["DataBag.type"]=e}set unreadIncomingMessagesCount(e){this._data["DataBag.unreadIncomingMessagesCount"]=e}set userMeetingRole(e){this._data["DataBag.userMeetingRole"]=e}set usermentionMris(e){this._data["DataBag.usermentionMris"]=e}set userHasSearched(e){this._data["DataBag.userHasSearched"]=e}set userTypeSelected(e){this._data["DataBag.userTypeSelected"]=e}set TFLUserEDState(e){this._data["DataBag.TFLUserEDState"]=e}set TFLUserInED(e){this._data["DataBag.TFLUserInED"]=e}set EDInviteFree(e){this._data["DataBag.EDInviteFree"]=e}set oofSettingsStatus(e){this._data["DataBag.oofSettingsStatus"]=e}set isExternalMessageSet(e){this._data["DataBag.isExternalMessageSet"]=e}set externalAudienceType(e){this._data["DataBag.externalAudienceType"]=e}set isSelectAddedUserViaMention(e){this._data["DataBag.isSelectAddedUserViaMention"]=e}set identifier(e){this._data["DataBag.Identifier"]=e}set dateRangeType(e){this._data["DataBag.dateRangeType"]=e}set isActive(e){this._data["DataBag.isActive"]=e}set tabSubmenuItem(e){this._data["DataBag.tabSubmenuItem"]=e}set tabSubmenuTrigger(e){this._data["DataBag.tabSubmenuTrigger"]=e}set urlAppTipShown(e){this._data["DataBag.urlAppTipShown"]=e}set acAppTipShown(e){this._data["DataBag.acAppTipShown"]=e}set videoRotation(e){this._data["ContentCamera.videoRotation"]=e}set wasReply(e){this._data["DataBag.wasReply"]=e}set WhisperId(e){this._data["DataBag.WhisperId"]=e}set wrap(e){this._data["DataBag.wrap"]=e}set webinarId(e){this._data["DataBag.webinarId"]=e}set webinarQuestions(e){this._data["DataBag.webinarQuestions"]=e}set webinarCustomQuestionsCountDelta(e){this._data["DataBag.webinarCustomQuestionsCountDelta"]=e}set webinarQuestionCountDelta(e){this._data["DataBag.webinarQuestionCountDelta"]=e}set webinarSpeakerCountDelta(e){this._data["DataBag.webinarSpeakerCountDelta"]=e}set webinarAccessPolicy(e){this._data["DataBag.webinarAccessPolicy"]=e}set collaborativeState(e){this._data["DataBag.collaborativeState"]=e}set correlationId(e){this._data["DataBag.correlationId"]=e}set isACv2Card(e){this._data["DataBag.isACv2Card"]=e}set hasACv2Refresh(e){this._data["DataBag.hasACv2Refresh"]=e}set hasIncomingScreenshare(e){this._data["DataBag.hasIncomingScreenshare"]=e}set hasParentTeacherMeetingPolicies(e){this._data["DataBag.hasParentTeacherMeetingPolicies"]=e}set acv2RefreshUserIdCount(e){this._data["DataBag.acv2RefreshUserIdCount"]=e}set acv2RefreshForAll(e){this._data["DataBag.acv2RefreshForAll"]=e}set acv2RefreshTeamSize(e){this._data["DataBag.acv2RefreshTeamSize"]=e}set espActionId(e){this._data["DataBag.espActionId"]=e}set irisCampaignId(e){this._data["ESP.irisCampaignId"]=e}set executeTrigger(e){this._data["DataBag.executeTrigger"]=e}set actionExecuteResponseStatus(e){this._data["DataBag.actionExecuteResponseStatus"]=e}set actionExecuteResponseType(e){this._data["DataBag.actionExecuteResponseType"]=e}set actionExecuteCallTime(e){this._data["DataBag.actionExecuteCallTime"]=e}set actionExecuteCacheReadTime(e){this._data["DataBag.actionExecuteCacheReadTime"]=e}set actionExecuteErrorCode(e){this._data["DataBag.actionExecuteErrorCode"]=e}set reportReason(e){this._data["DataBag.reportReason"]=e}set reportHasDetails(e){this._data["DataBag.reportHasDetails"]=e}set appName(e){this._data["DataBag.appName"]=e}set isLOBApp(e){this._data["DataBag.isLOBApp"]=e}set showMap(e){this._data["DataBag.showMap"]=e}set allowChooseLocation(e){this._data["DataBag.allowChooseLocation"]=e}set errorCode(e){this._data["DataBag.errorCode"]=e}set selectedAplBackgroundId(e){this._data["DataBag.selectedAplBackgroundId"]=e}set presenterMode(e){this._data["DataBag.presenterMode"]=e}set attachmentLayout(e){this._data["DataBag.attachmentLayout"]=e}set isSyncContactsSelected(e){this._data["DataBag.isSyncContactsSelected"]=e}set isPhoneStamped(e){this._data["DataBag.isPhoneStamped"]=e}set isEmailStamped(e){this._data["DataBag.isEmailStamped"]=e}set isEmailGmail(e){this._data["DataBag.isEmailGmail"]=e}set videoApp(e){this._data["VideoExt.videoApp"]=e}set videoAppId(e){this._data["VideoExt.videoAppId"]=e}set videoEffectId(e){this._data["VideoExt.videoEffectId"]=e}set isVideoAppInstalled(e){this._data["VideoExt.isVideoAppInstalled"]=e}set videoEffectName(e){this._data["VideoExt.videoEffectName"]=e}set videoEffectCategory(e){this._data["VideoExt.videoEffectCategory"]=e}set videoFileId(e){this._data["DataBag.videoFileId"]=e}set computerSound(e){this._data["DataBag.computerSound"]=e}set isRegisteredAttendee(e){this._data["DataBag.isRegisteredAttendee"]=e}set isPublicEvent(e){this._data["DataBag.isPublicEvent"]=e}set lmsCourseId(e){this._data["DataBag.lmsCourseId"]=e}set lmsUserRoles(e){this._data["DataBag.lmsUserRoles"]=e}set messageActionIndex(e){this._data["DataBag.messageActionIndex"]=e}set isCoreMessageAction(e){this._data["DataBag.isCoreMessageAction"]=e}set messageActionType(e){this._data["DataBag.messageActionType"]=e}set messageActionMenuLevel(e){this._data["DataBag.messageActionMenuLevel"]=e}set guardiansChatMemberTypeCount(e){this._data["DataBag.guardiansChatMemberTypeCount"]=e}set guardiansChatEmailInviteCount(e){this._data["DataBag.guardiansChatEmailInviteCount"]=e}set guardiansChatSmsInviteCount(e){this._data["DataBag.guardiansChatSmsInviteCount"]=e}set guardiansChatFallbackEmailInviteCount(e){this._data["DataBag.guardiansChatFallbackEmailInviteCount"]=e}set guardiansChatNoInviteCount(e){this._data["DataBag.guardiansChatNoInviteCount"]=e}set launchTileId(e){this._data["NovaAppBar.launchTileId"]=e}set launchTilePosition(e){this._data["NovaAppBar.launchTilePosition"]=e}set launchTileEventType(e){this._data["NovaAppBar.launchTileEventType"]=e}set launchTileAppName(e){this._data["NovaAppBar.launchTileAppName"]=e}set numParentsWithEmails(e){this._data["DataBag.numParentsWithEmails"]=e}set numParentsWithValidPhones(e){this._data["DataBag.numParentsWithValidPhones"]=e}set numParentsWithInvalidPhones(e){this._data["DataBag.numParentsWithInvalidPhones"]=e}set numTotalParents(e){this._data["DataBag.numTotalParents"]=e}set preferredContactMethod(e){this._data["DataBag.preferredContactMethod"]=e}set isBackedBySubstrateGroup(e){this._data["DataBag.isBackedBySubstrateGroup"]=e}set totalStoreItemsCount(e){this._data["DataBag.totalStoreItemsCount"]=e}set totalStoreBlockedItemsCount(e){this._data["PlatformUserLifeCycle.totalStoreBlockedItemsCount"]=e}set isFrequentCollaborators(e){this._data["PlatformUserLifeCycle.isFrequentCollaborators"]=e}set totalFrequentCollaboratorsStoreItemsCount(e){this._data["PlatformUserLifeCycle.totalFrequentCollaboratorsStoreItemsCount"]=e}set totalFrequentCollaboratorsCount(e){this._data["PlatformUserLifeCycle.totalFrequentCollaboratorsCount"]=e}set suggestedSource(e){this._data["PlatformUserLifeCycle.suggestedSource"]=e}set collectionId(e){this._data["DataBag.collectionId"]=e}set articleId(e){this._data["DataBag.articleId"]=e}set storeFilterSelectedItems(e){this._data["DataBag.storeFilterSelectedItems"]=e}set storeItemTemplate(e){this._data["DataBag.storeItemTemplate"]=e}set storeItemIsBlocked(e){this._data["DataBag.storeItemIsBlocked"]=e}set teamSensitivity(e){this._data["DataBag.teamSensitivity"]=e}set teamsPerGridViewSection(e){this._data["DataBag.teamsPerGridViewSection"]=e}set teamVisibility(e){this._data["DataBag.teamVisibility"]=e}set templateId(e){this._data["DataBag.templateId"]=e}set templateUri(e){this._data["DataBag.templateUri"]=e}set isExitModal(e){this._data["DataBag.isExitModal"]=e}set searchResultView(e){this._data["DataBag.searchResultView"]=e}set usersSuggestionsCount(e){this._data["DataBag.usersSuggestionsCount"]=e}set isLeavingPinnedTogetherMode(e){this._data["DataBag.isLeavingPinnedTogetherMode"]=e}set isLeavingSignLanguageView(e){this._data["DataBag.isLeavingSignLanguageView"]=e}set countTeamMembers(e){this._data["DataBag.countTeamMembers"]=e}set countTeamMembersAndInvitees(e){this._data["DataBag.countTeamMembersAndInvitees"]=e}set countChatMembers(e){this._data["DataBag.countChatMembers"]=e}set countInvitees(e){this._data["DataBag.countInvitees"]=e}set countAssignedInvitees(e){this._data["DataBag.countAssignedInvitees"]=e}set countAssignedTeamMembers(e){this._data["DataBag.countAssignedTeamMembers"]=e}set countAssignedTeamMembersAndInvitees(e){this._data["DataBag.countAssignedTeamMembersAndInvitees"]=e}set countUnassignedInvitees(e){this._data["DataBag.countUnassignedInvitees"]=e}set countUnassignedTeamMembers(e){this._data["DataBag.countUnassignedTeamMembers"]=e}set countUnassignedTeamMembersAndInvitees(e){this._data["DataBag.countUnassignedTeamMembersAndInvitees"]=e}set countOfAssignmentsNotInMeeting(e){this._data["BreakoutRooms.countOfAssignmentsNotInMeeting"]=e}set implicitContactsCount(e){this._data["DataBag.implicitContactsCount"]=e}set implicitContactsRate(e){this._data["DataBag.implicitContactsRate"]=e}set googleImplicitContactsCount(e){this._data["DataBag.googleImplicitContactsCount"]=e}set chatType(e){this._data["DataBag.chatType"]=e}set isPanelAutoOpened(e){this._data["DataBag.isPanelAutoOpened"]=e}set isOrganizer(e){this._data["DataBag.isOrganizer"]=e}set hasMultipleUserEndpoints(e){this._data["DataBag.hasMultipleUserEndpoints"]=e}set isRecurrent(e){this._data["DataBag.isRecurrent"]=e}set isEventEncrypted(e){this._data["DataBag.isEventEncrypted"]=e}set isEventDecryptionFailed(e){this._data["DataBag.isEventDecryptionFailed"]=e}set isCopyDisabledBySensitivity(e){this._data["DataBag.isCopyDisabledBySensitivity"]=e}set isForwardDisabledBySensitivity(e){this._data["DataBag.isForwardDisabledBySensitivity"]=e}set autoCreatedCollabNotes(e){this._data["DataBag.autoCreatedCollabNotes"]=e}set numberOfRequiredAttendees(e){this._data["DataBag.numberOfRequiredAttendees"]=e}set isSensitivityLabelPresent(e){this._data["DataBag.isSensitivityLabelPresent"]=e}set sensitivityLabelLearnMoreClicked(e){this._data["Calendar.sensitivityLabelLearnMoreClicked"]=e}set numberOfOptionalAttendees(e){this._data["DataBag.numberOfOptionalAttendees"]=e}set numberOfAttendeesWithDifferentTimezone(e){this._data["DataBag.numberOfAttendeesWithDifferentTimezone"]=e}set numberOfLocation(e){this._data["DataBag.numberOfLocation"]=e}set numberOfClassicalAttachments(e){this._data["DataBag.numberOfClassicalAttachments"]=e}set numberOfCloudAttachments(e){this._data["DataBag.numberOfCloudAttachments"]=e}set isFormEdited(e){this._data["DataBag.isFormEdited"]=e}set providerType(e){this._data["DataBag.providerType"]=e}set tabId(e){this._data["DataBag.tabId"]=e}set teamCardNotificationCount(e){this._data["DataBag.teamCardNotificationCount"]=e}set notesCreateTime(e){this._data["DataBag.notesCreateTime"]=e}set fluidCorrelationId(e){this._data["Messaging.fluidCorrelationId"]=e}set fluidIsFromCurrentUser(e){this._data["Messaging.fluidIsFromCurrentUser"]=e}set fluidMessageId(e){this._data["Messaging.fluidMessageId"]=e}set isFluidOpenedFromExtensibilityFlyout(e){this._data["Messaging.isFluidOpenedFromExtensibilityFlyout"]=e}set campaignType(e){this._data["GrowthPlatform.campaignType"]=e}set meetAppCalendarType(e){this._data["DataBag.meetAppCalendarType"]=e}set meetAppScenarioName(e){this._data["MeetApp.meetAppScenarioName"]=e}set meetAppEventType(e){this._data["MeetApp.meetAppEventType"]=e}set meetAppEventName(e){this._data["MeetApp.meetAppEventName"]=e}set meetAppEventId(e){this._data["MeetApp.meetAppEventId"]=e}set meetAppSessionId(e){this._data["MeetApp.meetAppSessionId"]=e}set eventId(e){this._data["VirtualEvent.eventId"]=e}set tokenType(e){this._data["VirtualEvent.tokenType"]=e}set templateType(e){this._data["VirtualEvent.templateType"]=e}set isSenderNameEdited(e){this._data["VirtualEvent.isSenderNameEdited"]=e}set isSubjectEdited(e){this._data["VirtualEvent.isSubjectEdited"]=e}set isBodyEdited(e){this._data["VirtualEvent.isBodyEdited"]=e}set privacySetting(e){this._data["VirtualEvent.privacySetting"]=e}set isTPWebinar(e){this._data["VirtualEvent.isTPWebinar"]=e}set meetingCoorganizerCount(e){this._data["DataBag.meetingCoorganizerCount"]=e}set meetingPresenterCount(e){this._data["DataBag.meetingPresenterCount"]=e}set meetingTimezone(e){this._data["DataBag.meetingTimezone"]=e}set featureId(e){this._data["WhatsNew.featureId"]=e}set featuresCount(e){this._data["WhatsNew.featuresCount"]=e}set trigger(e){this._data["WhatsNew.trigger"]=e}set redDotShown(e){this._data["WhatsNew.redDotShown"]=e}set chatHasMissedCall(e){this._data["ChatList.chatHasMissedCall"]=e}set chatHasMissedMention(e){this._data["ChatList.chatHasMissedMention"]=e}set chatHasMissedReaction(e){this._data["ChatList.chatHasMissedReaction"]=e}set chatIsUnread(e){this._data["ChatList.chatIsUnread"]=e}set isEmptyState(e){this._data["Flyout.isEmptyState"]=e}get isEmptyState(){return this._data["Flyout.isEmptyState"]}set pageName(e){this._data["Flyout.pageName"]=e}set deviceType(e){this._data["DataBag.deviceType"]=e}set permissions(e){this._data["DataBag.permissions"]=e}set collabStageViewChildWindowOpenDuration(e){this._data["DataBag.collabStageViewChildWindowOpenDuration"]=e}set channelMemberCount(e){this._data["TeamsAndChannels.channelMemberCount"]=e}set channelPosition(e){this._data["TeamsAndChannels.channelPosition"]=e}set channelState(e){this._data["TeamsAndChannels.channelState"]=e}set channelType(e){this._data["TeamsAndChannels.channelType"]=e}set dndSortedItemOldPosition(e){this._data["TeamsAndChannels.dndSortedItemOldPosition"]=e}set dndSortedItemNewPosition(e){this._data["TeamsAndChannels.dndSortedItemNewPosition"]=e}set dndSortedItemsTotalCount(e){this._data["TeamsAndChannels.dndSortedItemsTotalCount"]=e}set sharedChannelTeamRelationship(e){this._data["TeamsAndChannels.sharedChannelTeamRelationship"]=e}set hostTeamInheritance(e){this._data["TeamsAndChannels.hostTeamInheritance"]=e}set sharedChannelTeamCount(e){this._data["TeamsAndChannels.sharedChannelTeamCount"]=e}set hostTeamId(e){this._data["TeamsAndChannels.hostTeamId"]=e}set teamMembershipType(e){this._data["TeamsAndChannels.teamMembershipType"]=e}set sensitivity(e){this._data["TeamsAndChannels.sensitivity"]=e}set teamType(e){this._data["TeamsAndChannels.teamType"]=e}set visibility(e){this._data["TeamsAndChannels.visibility"]=e}set atMentionBadgeCount(e){this._data["TeamsAndChannels.atMentionBadgeCount"]=e}set isFavDefault(e){this._data["TeamsAndChannels.isFavDefault"]=e}set isChannelNew(e){this._data["TeamsAndChannels.isChannelNew"]=e}set isTeamNew(e){this._data["TeamsAndChannels.isTeamNew"]=e}set teamPrivateChannelCount(e){this._data["TeamsAndChannels.teamPrivateChannelCount"]=e}set teamSharedChannelCount(e){this._data["TeamsAndChannels.teamSharedChannelCount"]=e}set teamStandardChannelCount(e){this._data["TeamsAndChannels.teamStandardChannelCount"]=e}set updatedUserRole(e){this._data["TeamsAndChannels.updatedUserRole"]=e}set channelAction(e){this._data["TeamsAndChannels.channelAction"]=e}set channelSetting(e){this._data["TeamsAndChannels.channelSetting"]=e}set channelSettingValue(e){this._data["TeamsAndChannels.channelSettingValue"]=e}set teamSetting(e){this._data["TeamsAndChannels.teamSetting"]=e}set teamSettingValue(e){this._data["TeamsAndChannels.teamSettingValue"]=e}set mbScenarioName(e){this._data["DataBag.mbScenarioName"]=e}set mbEventType(e){this._data["DataBag.mbEventType"]=e}set mbEventName(e){this._data["DataBag.mbEventName"]=e}set mbEventId(e){this._data["DataBag.mbEventId"]=e}set mbActionValue(e){this._data["DataBag.mbActionValue"]=e}set numberOfTotalAttendeesEmailsPasted(e){this._data["DataBag.numberOfTotalAttendeesEmailsPasted"]=e}set numberOfInvalidAttendeesEmailsPasted(e){this._data["DataBag.numberOfInvalidAttendeesEmailsPasted"]=e}set delimitersUsedToSeparateEmails(e){this._data["DataBag.delimitersUsedToSeparateEmails"]=e}set hasSuggestedSendTime(e){this._data["VivaInsights.hasSuggestedSendTime"]=e}set scheduleSuggestionNudgeCount(e){this._data["VivaInsights.scheduleSuggestionNudgeCount"]=e}set scheduleSuggestionNudgeTTR(e){this._data["VivaInsights.scheduleSuggestionNudgeTTR"]=e}set numChatSpaces(e){this._data["Spaces.numChatSpaces"]=e}set numChannelSpaces(e){this._data["Spaces.numChannelSpaces"]=e}set numActiveSpaces(e){this._data["Spaces.numActiveSpaces"]=e}set currentSubtitlesLanguage(e){this._data["DataBag.currentSubtitlesLanguage"]=e}set currentSubtitlesSource(e){this._data["DataBag.currentSubtitlesSource"]=e}set beforeSubtitlesLanguage(e){this._data["DataBag.beforeSubtitlesLanguage"]=e}set beforeSubtitlesSource(e){this._data["DataBag.beforeSubtitlesSource"]=e}set currentSpokenLanguage(e){this._data["DataBag.currentSpokenLanguage"]=e}set isWithinComposition(e){this._data["DataBag.isWithinComposition"]=e}set frameContext(e){this._data["DataBag.frameContext"]=e}set unifiedConsentEventCode(e){this._data["UnifiedConsent.eventCode"]=e}set unifiedConsentEventName(e){this._data["UnifiedConsent.eventName"]=e}set unifiedConsentEventMessage(e){this._data["UnifiedConsent.eventMessage"]=e}set unifiedConsentFormFactor(e){this._data["UnifiedConsent.formFactor"]=e}set unifiedConsentSurface(e){this._data["UnifiedConsent.consentSurface"]=e}set unifiedConsentType(e){this._data["UnifiedConsent.consentType"]=e}set unifiedConsentModelVersion(e){this._data["UnifiedConsent.modelVersion"]=e}set unifiedConsentModelType(e){this._data["UnifiedConsent.modelType"]=e}set unifiedConsentModelId(e){this._data["UnifiedConsent.modelId"]=e}set unifiedConsentReconsentReason(e){this._data["UnifiedConsent.reconsentReason"]=e}set unifiedConsentCorrelationId(e){this._data["UnifiedConsent.correlationId"]=e}set tagMemberCount(e){this._data["PeopleTargeting.tagMemberCount"]=e}set hasDescription(e){this._data["PeopleTargeting.hasDescription"]=e}set canPostToChannel(e){this._data["PeopleTargeting.canPostToChannel"]=e}set postToChannel(e){this._data["PeopleTargeting.postToChannel"]=e}set hasCustomMessage(e){this._data["PeopleTargeting.hasCustomMessage"]=e}set isFromCopy(e){this._data["PeopleTargeting.isFromCopy"]=e}set EDUserState(e){this._data["DataBag.EDUserState"]=e}set EDUserSelected(e){this._data["DataBag.EDUserSelected"]=e}set isEDUser(e){this._data["DataBag.isEDUser"]=e}set togetherEmojisInteractionType(e){this._data["TogetherEmojis.interactionType"]=e}set userBiTestOnly(e){this._data["Instrumentation.UserBiTestOnly"]=e}set inviteAllMembers(e){this._data["DataBag.inviteAllMembers"]=e}set totalChannelMemberCount(e){this._data["Calendar.totalChannelMemberCount"]=e}set sensitivityLabelDowngradeJustification(e){this._data["DataBag.sensitivityLabelDowngradeJustification"]=e}set sensitivityLabelDowngradeDialogSkin(e){this._data["DataBag.sensitivityLabelDowngradeDialogSkin"]=e}set onboardingIsUnifiedConsentApproved(e){this._data["Onboarding.isUnifiedConsentApproved"]=e}set ufdId(e){this._data["UFD.ufdId"]=e}set alertType(e){this._data["UFD.alertType"]=e}set severity(e){this._data["UFD.severity"]=e}set ufdOrigin(e){this._data["UFD.ufdOrigin"]=e}set isPrivacyUfd(e){this._data["UFD.isPrivacyUfd"]=e}set ufdDismissable(e){this._data["UFD.ufdDismissable"]=e}set ufdMutable(e){this._data["UFD.ufdMutable"]=e}set freVersion(e){this._data["Onboarding.freVersion"]=e}set isCurrentScreenFreErrorScreen(e){this._data["Onboarding.isCurrentScreenFreErrorScreen"]=e}set selectedGroup(e){this._data["LiveInterpretation.selectedGroup"]=e}set sourceLanguage(e){this._data["LiveInterpretation.sourceLanguage"]=e}set targetLanguage(e){this._data["LiveInterpretation.targetLanguage"]=e}set requestTraceId(e){this._data["MeetingCollab.requestTraceId"]=e}set requestCorrelationId(e){this._data["MeetingCollab.requestCorrelationId"]=e}set promptType(e){this._data["MeetingCollab.promptType"]=e}set promptId(e){this._data["MeetingCollab.promptId"]=e}set promptCharCount(e){this._data["MeetingCollab.promptCharCount"]=e}set promptWordCount(e){this._data["MeetingCollab.promptWordCount"]=e}set responseCharCount(e){this._data["MeetingCollab.responseCharCount"]=e}set responseWordCount(e){this._data["MeetingCollab.responseWordCount"]=e}set responseStatus(e){this._data["MeetingCollab.responseStatus"]=e}set feedbackType(e){this._data["MeetingCollab.feedbackType"]=e}set responseTimestamp(e){this._data["MeetingCollab.responseTimestamp"]=e}set promptTimestamp(e){this._data["MeetingCollab.promptTimestamp"]=e}set feedbackTimestamp(e){this._data["MeetingCollab.feedbackTimestamp"]=e}set triggeringControl(e){this._data["MeetingCollab.triggeringControl"]=e}set goToRecapTime(e){this._data["MeetingRecap.goToRecapTime"]=e}set recordingId(e){this._data["MeetingRecap.recordingId"]=e}set insightProcessingResultStatus(e){this._data["MeetingRecap.insightProcessingResultStatus"]=e}set itemNumber(e){this._data["MeetingRecap.itemNumber"]=e}set isNameProvided(e){this._data["Communities.isNameProvided"]=e}set isDescriptionProvided(e){this._data["Communities.isDescriptionProvided"]=e}set isAvatarProvided(e){this._data["Communities.isAvatarProvided"]=e}set areGuidelinesProvided(e){this._data["Communities.areGuidelinesProvided"]=e}set unifiedFunPicker(e){this._data["Messaging.unifiedFunPicker"]=e}set callParticipantCount(e){this._data["CallDialpad.callParticipantCount"]=e}set hasCodeblock(e){this._data["DataBag.hasCodeblock"]=e}set codeblockLanguage(e){this._data["DataBag.codeblockLanguage"]=e}set codeblockShortcut(e){this._data["DataBag.codeblockShortcut"]=e}setDispose(e){this._dispose=e}dispose(){this._dispose&&this._dispose()}}},87308:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var i=n(250921);class a{constructor(e,t){this.value=e,this.piiKind=t}static isPIIValue(e){return!!e&&"string"!=typeof e&&void 0!==e.scrub}scrub(){return(0,i.sha256)(JSON.stringify(this.value))}}},645794:(e,t,n)=>{"use strict";n.d(t,{cZ:()=>f,Gg:()=>y,UZ:()=>h});var i=n(281857),a=n(215080),o=n(136295),r=n(226568),s=n(15710),l=n(725186),d=n(618682),c=n(697950),u=n(895725),m=n(157459),g=n(916638),p=n(157505);const v=([e,t])=>(t&&e.do((()=>{}),(e=>{throw e})),e);function h(e,t){return(...n)=>(0,a.P)((()=>e(...n))).pipe(((e,t)=>{const n=e.pipe((0,r.R)(((e,n)=>e||!t(n)),!1)),i=e.pipe((0,s.P)(t),(0,l.V)(5e3));return(0,o.z)((0,d.i)(),(0,c.M)(n),(0,u.U)(v),(0,m.a)((e=>e.pipe((0,g.w)(i)))),(0,p.D)())})(t,k)).toPromise()}const f=e=>(e=>{switch(e){case i.eT.Disabled:case i.eT.Offline:return!1;default:return!0}})(e),y=e=>()=>f(e.getState()),k=e=>e},892685:(e,t,n)=>{"use strict";n.d(t,{mf:()=>i,Zz:()=>a,hh:()=>o,YM:()=>r});const i={Safari:11.1},a=11,o=11.1,r={chrome:">=60",chromium:">=60",edge:">=12",electron:">=2",firefox:">=52"}},907310:(e,t,n)=>{"use strict";n.d(t,{H$:()=>r,MB:()=>s,Qh:()=>l,L5:()=>d});var i=n(745534),a=n(892685),o=n(119423);function r(e=a.YM){return!!e&&!!c().satisfies(e)}function s(){return!u("ie")}function l(){return!!c().satisfies({safari:`>=${a.mf.Safari}`})}function d(){return u("safari")&&void 0===c().getBrowserVersion()}function c(){return i.getParser((0,o.J)().navigator.userAgent)}function u(e){return c().isBrowser(e,!0)}},993103:(e,t,n)=>{"use strict";n.d(t,{yL:()=>c,lY:()=>u,Gw:()=>m,kP:()=>g,fQ:()=>p});var i=n(395816),a=n(672729),o=n(845345),r=n(48369),s=n(859759),l=n(123321),d=n(130476);const c=(e,t,n,i,o)=>{if(t.from&&t.imDisplayName&&(n||t.attached))return t;const{fragment:s,fragmentTypeName:l,fragmentName:d}=m(o);try{const o=e.readFragment(n?{id:`${l}:${t.clientMessageId}`,fragment:s,fragmentName:d}:{id:`${(0,a.uG)(t)}`,fragment:r.xP,fragmentName:"replyMessage"});if(!o)return i&&i.warn(`getDataToWrite::No existing entry found in cache for ${n?"post":"reply"} with clientMessageId ${t.clientMessageId}. Returning given data.`),t;const c=n?void 0:o.attached;return Object.assign(Object.assign(Object.assign({},t),!n&&{attached:c}),{from:o.from,imDisplayName:o.imDisplayName})}catch(e){return i&&i.warn(`getDataToWrite::Failed to read ${n?"post":"reply"} fragment to replace existing lie for msg with clientMessageId ${t.clientMessageId}. Returning given data.`),t}};function u(e,t,n){const i=c(e,t,!1,n);try{const n=i.attached;e.writeFragment({id:`${(0,a.uG)(t)}`,fragment:r.xP,fragmentName:"replyMessage",data:Object.assign(Object.assign({},i),n&&{attached:n})})}catch(e){n&&n.error(`updateReplyChainSummariesWithReply::Failed writing replyChainMessage fragment to cache for clientMessageId ${t.clientMessageId}`)}}const m=e=>{switch(e){case i.hQF.Announcement:return{fragmentName:"announcementPostMessage",fragmentTypeName:"AnnouncementPostMessage",fragment:s.hb};case i.hQF.Guardians:return{fragmentName:"DataFragmentsCommonGuardiansPostMessageFragment",fragmentTypeName:"GuardiansPostMessage",fragment:d.N4};default:return{fragmentName:"standardPostMessage",fragmentTypeName:"StandardPostMessage",fragment:l.wZ}}},g=(e,t,n,o=i.hQF.Standard)=>t!==n?{id:(0,a.uG)({__typename:e,id:n}),fragmentName:"replyMessage",fragment:r.xP}:Object.assign({id:`${e}:${n}`},m(o)),p=(e,t)=>{let n;if(!t||t.deleteTime)return;if(e.from!==t.from)return;return(0,o.X)(e,t)?n=i.HBY.bottom:t.attached&&(n=i.HBY.top),n}},859759:(e,t,n)=>{"use strict";n.d(t,{hb:()=>m});var i=n(552888),a=n(13039),o=n(275333),r=n(453163),s=n(482500),l=n(601216),d=n(550286),c=n(545872),u=n(183876);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"announcementPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"announcement"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"originalImageUrl"}},{kind:"Field",name:{kind:"Name",value:"croppedImageUrl"}},{kind:"Field",name:{kind:"Name",value:"colorTheme"}},{kind:"Field",name:{kind:"Name",value:"croppedImageHeight"}},{kind:"Field",name:{kind:"Name",value:"croppedImageWidth"}},{kind:"Field",name:{kind:"Name",value:"croppedImageAltText"}},{kind:"Field",name:{kind:"Name",value:"isTeamsIllustration"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meeting"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.v.definitions,...l.w.definitions,...d.x.definitions,...c.I.definitions,...u.ev.definitions]}},916241:(e,t,n)=>{"use strict";n.d(t,{p:()=>m});var i=n(232922),a=n(123321),o=n(859759),r=n(383231),s=n(106332),l=n(453490),d=n(130476),c=n(48369),u=n(268808);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChannelReplyChainSummaryWithUserDetailsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainSummary"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"postMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"standardPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"announcementPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"emailPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"connectorPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonGuardiansPostMessageFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"previewMessageSet"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"replyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"mostRecentOverflowMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"replyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"totalReplies"}},{kind:"Field",name:{kind:"Name",value:"totalUsers"}},{kind:"Field",name:{kind:"Name",value:"recentUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"recentUserDisplayNameHints"}},{kind:"Field",name:{kind:"Name",value:"creationTime"}},{kind:"Field",name:{kind:"Name",value:"updatedTime"}},{kind:"Field",name:{kind:"Name",value:"hasMention"}},{kind:"Field",name:{kind:"Name",value:"hasChannelMention"}},{kind:"Field",name:{kind:"Name",value:"hasImportance"}},{kind:"Field",name:{kind:"Name",value:"hasFiles"}},{kind:"Field",name:{kind:"Name",value:"hasCurrentUserMention"}},{kind:"Field",name:{kind:"Name",value:"hasUnreadPostMessage"}},{kind:"Field",name:{kind:"Name",value:"hasUnreadReplyMessage"}}]}},...i.T.definitions,...a.wZ.definitions,...o.hb.definitions,...r.tO.definitions,...s.z6.definitions,...l.zL.definitions,...d.N4.definitions,...c.xP.definitions,...u.SN.definitions]}},383231:(e,t,n)=>{"use strict";n.d(t,{tO:()=>m});var i=n(552888),a=n(13039),o=n(275333),r=n(453163);const s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emailDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"from"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"sender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"to"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"cc"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"emailLink"}},{kind:"Field",name:{kind:"Name",value:"totalRecipients"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"emailUser"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"smtp"}}]}}]};var l=n(482500),d=n(601216),c=n(550286),u=n(545872);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emailPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"emailDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emailDetails"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.definitions,...l.v.definitions,...d.w.definitions,...c.x.definitions,...u.I.definitions]}},183876:(e,t,n)=>{"use strict";n.d(t,{ev:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meeting"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingActionType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"scheduledMeetingInfo"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"scheduledMeetingInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ScheduledMeetingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]}},106332:(e,t,n)=>{"use strict";n.d(t,{z6:()=>m});var i=n(13039),a=n(275333),o=n(453163),r=n(552888),s=n(183876),l=n(482500),d=n(601216),c=n(550286),u=n(545872);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meeting"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.w.definitions,...a.p.definitions,...o.S.definitions,...r.Uw.definitions,...s.ev.definitions,...l.v.definitions,...d.w.definitions,...c.x.definitions,...u.I.definitions]}},268808:(e,t,n)=>{"use strict";n.d(t,{SN:()=>m});var i=n(275333),a=n(453163),o=n(13039),r=n(482500),s=n(601216),l=n(552888),d=n(183876),c=n(550286),u=n(545872);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingReplyMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meeting"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.p.definitions,...a.S.definitions,...o.w.definitions,...r.v.definitions,...s.w.definitions,...l.Uw.definitions,...d.ev.definitions,...c.x.definitions,...u.I.definitions]}},48369:(e,t,n)=>{"use strict";n.d(t,{xP:()=>u});var i=n(552888),a=n(275333),o=n(453163),r=n(13039),s=n(482500),l=n(601216),d=n(545872),c=n(550286);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}},{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.p.definitions,...o.S.definitions,...r.w.definitions,...s.v.definitions,...l.w.definitions,...d.I.definitions,...c.x.definitions]}},123321:(e,t,n)=>{"use strict";n.d(t,{wZ:()=>u});var i=n(552888),a=n(13039),o=n(275333),r=n(453163),s=n(482500),l=n(601216),d=n(545872),c=n(550286);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"standardPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.v.definitions,...l.w.definitions,...d.I.definitions,...c.x.definitions]}},999211:(e,t,n)=>{"use strict";n.d(t,{x:()=>o});var i=n(563753),a=n(690009);const o=(e,t,n,o,r,s=!1,l=!1,d,c)=>{n?((0,i.RT)(e,t,n,o,r,s,c),(0,a.mH)(e,t,n,o,s,c)):(0,i.vz)(e,t,o,r,s,l,d,c)}},690009:(e,t,n)=>{"use strict";n.d(t,{df:()=>S,YV:()=>k,mH:()=>h});var i=n(305731),a=n(232922),o=n(123321),r=n(859759),s=n(383231),l=n(106332),d=n(48369),c=n(268808),u=n(453490),m=n(130476);const g={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyChainMessageNodeLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessageNode"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"standardPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"announcementPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"emailPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"replyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"connectorPostMessage"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonGuardiansPostMessageFragment"}}]}}]}},...o.wZ.definitions,...r.hb.definitions,...s.tO.definitions,...l.z6.definitions,...d.xP.definitions,...c.SN.definitions,...u.zL.definitions,...m.N4.definitions]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"replyChainMessagesList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryInput"}},type:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainQueryInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"replyChainMessages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"channelId"},value:{kind:"Variable",name:{kind:"Name",value:"channelId"}}},{kind:"Argument",name:{kind:"Name",value:"replychainId"},value:{kind:"Variable",name:{kind:"Name",value:"replyChainId"}}},{kind:"Argument",name:{kind:"Name",value:"queryInput"},value:{kind:"Variable",name:{kind:"Name",value:"queryInput"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startCursor"}},{kind:"Field",name:{kind:"Name",value:"endCursor"}},{kind:"Field",name:{kind:"Name",value:"hasNextPage"}},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"}}]}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"replyChainMessageNodeLie"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"parentMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}}]}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dataSource"}},{kind:"Field",name:{kind:"Name",value:"channelRosterSizeExceeded"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinkedMessageState"}}]}}]}},...a.T.definitions,...g.definitions]};var v=n(993103);function h(e,t,n,i,a,o){var r,s,l;const d=a?(0,v.yL)(e,i,!1,o):i,c=y(e,t,n,o);if(!c)return void(o&&o.warn(`updateReplyChainMessagesWithReply::Failed getting replyChainMessage data for channel ${t} replyChainId ${n}`));let u=d.attached;if(!a){const e=null===(l=null===(s=null===(r=null==c?void 0:c.replyChainMessages)||void 0===r?void 0:r.edges)||void 0===s?void 0:s[0])||void 0===l?void 0:l.node;u=!(null==e?void 0:e.postType)?(0,v.fQ)(d,null==e?void 0:e.message):void 0}const m=C(a?i.id:i.clientMessageId||"",n),g={id:m,postType:null,message:Object.assign(Object.assign({},d),u&&{attached:u})};if(a){const e=b(m,c);if(-1===e)return void(o&&o.warn("updateReplyChainMessagesWithReply::replaceExisting::Could not find matching message to replace"));c.replyChainMessages.edges[e]={__typename:"ReplyChainMessagesEdge",node:Object.assign({__typename:"ReplyChainMessageNode"},g)}}else c.replyChainMessages.edges.unshift({__typename:"ReplyChainMessagesEdge",node:Object.assign({__typename:"ReplyChainMessageNode"},g)});f(e,t,n,c,o)}const f=(e,t,n,i,a)=>{try{e.writeQuery({query:p,variables:{channelId:t,replyChainId:n},data:i})}catch(e){return void(a&&a.error(`writeReplyChainMessageData::Failed writing replyChainMessageList query to cache for channel ${t} replyChainId ${n}`))}},y=(e,t,n,a)=>{try{const a=e.readQuery({query:p,variables:{channelId:t,replyChainId:n}});return(0,i.X)(a)}catch(e){return a&&a.error(`getReplyChainSummariesData::Failed to read replyChainSummariesQuery for channel ${t} replyChainId ${n}`),null}},k=(e,t,n,i,a)=>{let o=null;try{o=e.readFragment({id:`ReplyChainMessage:${i.id}`,fragment:d.xP,fragmentName:"replyMessage"})}catch(e){a&&a.error(`removeLieFromReplyChainMessages::Failed to read cache fragment for replyMessage id ${i.id} for channelId ${t} and replyChainId ${n}`)}const r=y(e,t,n,a);if(!r)return void(a&&a.warn(`removeLieFromReplyChainMessages::Failed to read from replyChainMessages cache for channel ${t}.`));const s=b(C(i.clientMessageId||"",n),r);-1!==s?(o?r.replyChainMessages.edges[s]={__typename:"ReplyChainMessagesEdge",node:{__typename:"ReplyChainMessageNode",id:C((null==o?void 0:o.id)||"",n),postType:null,message:Object.assign(Object.assign({},o),{__typename:"ReplyChainMessage"})}}:r.replyChainMessages.edges[s].node.message.id=i.id,f(e,t,n,r,a)):a&&a.warn(`removeLieFromReplyChainMessages::Message with id ${i.clientMessageId||""} not found in cache for channel ${t}`)},S=(e,t,n,i,a)=>{const o=y(e,t,n,a);if(!o)return void a.warn(`deleteFailedReplyLieFromReplyChainMessages::Failed to read from replyChainMessages cache for channel ${t}.`);const r=C(i||"",n);-1!==b(r,o)?(o.replyChainMessages.edges=o.replyChainMessages.edges.filter((e=>e.node.id!==r)),f(e,t,n,o,a)):a.warn(`deleteFailedReplyLieFromReplyChainMessages::Message with id ${i||""} not found in cache for channel ${t}`)},b=(e,t)=>t.replyChainMessages.edges.findIndex((t=>t.node.id===e)),C=(e,t)=>`${t}_${e}`},563753:(e,t,n)=>{"use strict";n.d(t,{tO:()=>v,CZ:()=>p,vz:()=>g,RT:()=>m});var i=n(395816),a=n(672729),o=n(305731),r=n(172887),s=n(48369),l=n(916241);const d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"replyChainSummaryLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainSummary"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"postType"}},{kind:"Field",name:{kind:"Name",value:"postMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"standardPostLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"emailPostMessageLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingPostMessageLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"announcementPostMessageLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"guardiansPostMessageLie"}}]}},{kind:"Field",name:{kind:"Name",value:"previewMessageSet"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"replyLie"}},{kind:"FragmentSpread",name:{kind:"Name",value:"meetingReplyLie"}}]}},{kind:"Field",name:{kind:"Name",value:"creationTime"}}]}},...n(232922).T.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"standardPostLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingPostLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"emailPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"announcementPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"guardiansPostMessageLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"replyLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"attached"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingReplyLie"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"attached"}}]}}]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"replyChainSummaryList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryInput"}},type:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainSummaryQueryInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"last"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"before"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"replyChainSummaries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"channelId"},value:{kind:"Variable",name:{kind:"Name",value:"channelId"}}},{kind:"Argument",name:{kind:"Name",value:"queryInput"},value:{kind:"Variable",name:{kind:"Name",value:"queryInput"}}},{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"last"},value:{kind:"Variable",name:{kind:"Name",value:"last"}}},{kind:"Argument",name:{kind:"Name",value:"before"},value:{kind:"Variable",name:{kind:"Name",value:"before"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startCursor"}},{kind:"Field",name:{kind:"Name",value:"endCursor"}},{kind:"Field",name:{kind:"Name",value:"hasNextPage"}},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"}}]}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"replyChainSummaryLie"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dataSource"}},{kind:"Field",name:{kind:"Name",value:"channelRosterSizeExceeded"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinkedMessageState"}}]}}]}},...d.definitions]};var u=n(993103);function m(e,t,n,o,l,c,m){const g=c?(0,u.yL)(e,o,!1,m):o;try{const t=g.attached;e.writeFragment({id:`${(0,a.uG)(o)}`,fragment:s.xP,fragmentName:"replyMessage",data:Object.assign(Object.assign({},g),t&&{attached:t})})}catch(e){return void(m&&m.error(`updateReplyChainSummariesWithReply::Failed writing replyChainMessage fragment to cache for clientMessageId ${o.clientMessageId}`))}if(c)return;const p=h(e,t,m);if(!p)return void(m&&m.warn(`updateReplyChainSummariesWithReply::No replyChainSummaries found in cache for channel ${t}`));const v=p.replyChainSummaries.edges.find((e=>e.node.replyChainId===n));if(!v)return void(m&&m.warn(`updateReplyChainSummariesWithReply::ReplyChainSummary does not include post with replyChainId ${n}`));const{node:f}=v,y=[...f.previewMessageSet];y.length===r.up&&y.shift();let k=i.HBY.top;if(y.length){const e=y[y.length-1];k=(0,u.fQ)(o,e)||i.HBY.top;const t=Object.assign(Object.assign({},y[0]),{attached:i.HBY.top});y[0]=t}const S={__typename:o.__typename||"ReplyChainMessage",id:o.clientMessageId||"",clientMessageId:o.clientMessageId||"",from:l,originalArrivalTime:o.originalArrivalTime||"",version:"-1",attached:k};y.push(S);try{e.writeFragment({id:`ReplyChainSummary:${t}::${n}`,fragment:d,fragmentName:"replyChainSummaryLie",data:Object.assign(Object.assign({},f),{previewMessageSet:y})})}catch(e){return void(m&&m.error(`updateReplyChainSummariesWithReply::Failed writing replyChainSummary fragment to cache for ReplyChainSummary:${t}::${n}`))}}function g(e,t,n,a,o,r,s,d){const c=o?(0,u.yL)(e,n,!0,d,s):n,m=Object.assign(Object.assign({},c),{__typename:n.__typename||"StandardPostMessage",clientMessageId:n.clientMessageId||"",originalArrivalTime:n.originalArrivalTime||"",from:a||c.from||"",version:"-1"}),{fragmentName:g,fragmentTypeName:p,fragment:v}=(0,u.Gw)(s);try{e.writeFragment({id:`${p}:${r?n.id:n.clientMessageId}`,fragment:v,fragmentName:g,data:m})}catch(e){return void(d&&d.error(`updateReplyChainSummariesWithPost::Failed to write post fragment for clientMessageId ${n.clientMessageId}`))}if(o)return;const y={__typename:"ReplyChainSummary",id:`${t}::${n.clientMessageId}`,channelId:t,replyChainId:n.clientMessageId||"",creationTime:n.originalArrivalTime||"",postType:s||i.hQF.Standard,postMessage:m,previewMessageSet:[],mostRecentOverflowMessage:null,totalReplies:0,totalUsers:0,recentUsers:[],recentUserDisplayNameHints:[],updatedTime:null,hasMention:!1,hasChannelMention:!1,hasImportance:!1,hasFiles:!1,hasCurrentUserMention:!1,hasUnreadPostMessage:null,hasUnreadReplyMessage:null,consumptionHorizon:{id:"lie_ch"}};try{e.writeFragment({id:`ReplyChainSummary:${t}::${r?n.id:n.clientMessageId}`,fragment:l.p,fragmentName:"DataClientChannelReplyChainSummaryWithUserDetailsFragment",data:y})}catch(e){return void(d&&d.error(`updateReplyChainSummariesWithPost::Failed to write replyChainSummary fragment for clientMessageId ${n.clientMessageId}`))}const k=h(e,t,d);k?(k.replyChainSummaries.edges.unshift({__typename:"ReplyChainSummaryEdge",node:y}),f(e,t,k,d)):d&&d.warn(`updateReplyChainSummariesWithPost::replyChainSummariesList is undefined for channel ${t}`)}const p=(e,t,n,i,a,o)=>{const r=h(e,t,a);if(!r)return void(a&&a.warn(`removePostClientLie::replyChainSummariesList is undefined for channel ${t}`));const s=r.replyChainSummaries.edges;let l;if(l=o?s.findIndex((e=>e.node.postMessage.clientMessageId===i)):s.findIndex((e=>e.node.id===`${t}::${i}`)),-1!==l){if(o)r.replyChainSummaries.edges=s.filter((e=>e.node.postMessage.clientMessageId!==i));else{const e=s[l].node;e.id=`${t}::${n}`,e.replyChainId=n,e.postMessage.id=n}f(e,t,r,a)}else a&&a.warn(`removePostClientLie::Could not find matching ${t}::${i} node in replyChainSummaries.`)},v=(e,t,n,i,a)=>{const o=h(e,t,a);if(!o)return void a.warn(`deleteFailedReplyLieFromReplyChainSummaries::replyChainSummariesList is undefined for channel ${t}`);const r=o.replyChainSummaries.edges.find((e=>e.node.replyChainId===n));if(!r)return void a.warn(`deleteFailedReplyLieFromReplyChainSummaries::ReplyChainSummaries does not include post with replyChainId ${n}`);const s=r.node.previewMessageSet.findIndex((e=>e.clientMessageId===i));-1!==s?(r.node.previewMessageSet.splice(s,1),f(e,t,o,a)):a.warn("deleteFailedReplyLieFromReplyChainSummaries::Failed to delete reply lie for replyChainSummary.")},h=(e,t,n)=>{try{const n=e.readQuery({query:c,variables:{channelId:t}});return(0,o.X)(n)}catch(e){return n&&n.error("getReplyChainSummariesData::Failed to read replyChainSummariesQuery"),null}},f=(e,t,n,i)=>{try{e.writeQuery({query:c,variables:{channelId:t},data:n})}catch(e){return void(i&&i.error(`writeReplyChainSummariesData::Failed to write to replyChainSummariesQuery for channel ${t}`))}}},316574:(e,t,n)=>{"use strict";n.d(t,{qJ:()=>A,X$:()=>D,sE:()=>T,lx:()=>I,iu:()=>_,wh:()=>E});var i=n(350672),a=n(395816);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForDeletedMessages"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"time"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}},{kind:"Field",name:{kind:"Name",value:"escalations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"userHasSaved"}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"FragmentSpread",name:{kind:"Name",value:"deletionInfo"}}]}},...o.definitions]},s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"deletedMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletedMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"message"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageFieldsForDeletedMessages"}}]}}]}}]}},...r.definitions]};var l=n(434960);const d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedReplyChainMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};l.lB.definitions;var c=n(927529);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedMeetingReplyMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};c.yM.definitions;var m=n(806812);const g={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedStandardPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};m.w3.definitions;var p=n(277783);const v={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedAnnouncementPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};p.Be.definitions;var h=n(325e3);const f={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedEmailPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};h.E3.definitions;var y=n(295487);const k={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedMeetingPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};y.lU.definitions;var S=n(453490);const b={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedConnectorPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectorPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};S.zL.definitions;var C=n(130476);const w={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedGuardiansPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};C.N4.definitions;var N=n(413446);function T(e,t){const{message:n}=M(e,t.id,t.clientMessageId,void 0,!(null==t?void 0:t.deleteTime)),i=n&&n.message&&n.message.importance===a.Ntc.Urgent;return{__typename:"DeletionInfo",showMessageAsDeleted:!!n,canBeUndeleted:!!n&&!i,deleteFailed:!1}}function I(e,t,n,i){try{const{message:a}=M(e,t,n,i);if(a){const{message:n}=a,i=Object.assign(Object.assign({},n),{id:t}),o=`Message:${t}`;return e.writeFragment({id:o,fragment:r,data:i}),i}}catch(e){}}function E(e,t,n,i,a){const{fragment:r,fragmentName:s}=function(e){switch(e){case"Message":return{fragment:o,fragmentName:"deletionInfo"};case"ReplyChainMessage":return{fragment:d,fragmentName:"DataClientChatDeletedReplyChainMessageFragment_deletionInfo"};case"MeetingReplyMessage":return{fragment:u,fragmentName:"DataClientChatDeletedMeetingReplyMessageFragment_deletionInfo"};case"StandardPostMessage":return{fragment:g,fragmentName:"DataClientChatDeletedStandardPostMessageFragment_deletionInfo"};case"AnnouncementPostMessage":return{fragment:v,fragmentName:"DataClientChatDeletedAnnouncementPostMessageFragment_deletionInfo"};case"EmailPostMessage":return{fragment:f,fragmentName:"DataClientChatDeletedEmailPostMessageFragment_deletionInfo"};case"MeetingPostMessage":return{fragment:k,fragmentName:"DataClientChatDeletedMeetingPostMessageFragment_deletionInfo"};case"ConnectorPostMessage":return{fragment:b,fragmentName:"DataClientChatDeletedConnectorPostMessageFragment_deletionInfo"};case"GuardiansPostMessage":return{fragment:w,fragmentName:"DataClientChatDeletedGuardiansPostMessageFragment_deletionInfo"};default:return{fragment:o,fragmentName:"deletionInfo"}}}(n),l=`${n}:${t}`;try{const a=e.readFragment({id:l,fragment:r,fragmentName:s});a&&e.writeFragment({id:l,fragment:r,data:Object.assign(Object.assign({},a),{id:t,deletionInfo:{__typename:"Message"===n?"DeletionInfo":"MessageDeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:i},version:(0,N.M)()[0].toString()})})}catch(e){a&&a.error(`Failed to cache delete failure on ${t}: ${e}`)}}function A(e,t,n){let i=[];try{i=F(e,n)}catch(e){}if(!i.find((e=>e.id===t)))try{const n=`Message:${t}`,a=e.readFragment({id:n,fragment:r,fragmentName:"messageFieldsForDeletedMessages"}),o=Object.assign(Object.assign({},a),{id:`${a.id}_deleted`}),l={id:t,message:o,__typename:"DeletedMessage"};return i=[l,...i],e.writeQuery({query:s,data:{deletedMessages:i}}),l}catch(e){n&&n.error(`Failed to addDeletedMessageToCache: ${e}`)}}function _(e,t,n,i){try{const a=F(e,i),{message:o,isDeletedLieMessage:l}=M(e,t,n,i,!1,a);if(o){const i=a.filter((e=>{var i;return l?(null===(i=e.message)||void 0===i?void 0:i.clientMessageId)!==n:e.id!==t})),d=Object.assign(Object.assign({},o.message),{id:t,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},version:(0,N.M)()[0].toString(),__typename:"Message"});e.writeQuery({query:s,data:{deletedMessages:i}});const c=`Message:${t}`;return e.writeFragment({id:c,fragment:r,data:d}),d}}catch(e){}}function D(e,t,n){const o=i.Ps`
    fragment messageFieldsNeeded on Message {
      deleteTime
      importance
      deletionInfo {
        showMessageAsDeleted
        canBeUndeleted
        deleteFailed
      }
      version
    }
  `,r=`Message:${t}`;try{const t=e.readFragment({id:r,fragment:o});if(t){const i=t.importance===a.Ntc.Urgent;e.writeFragment({id:r,fragment:o,data:{deleteTime:n,importance:t.importance,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!!n,canBeUndeleted:!!n&&!i,deleteFailed:!1},version:(0,N.M)()[0].toString(),__typename:"Message"}})}}catch(e){}}const F=(e,t)=>{let n;try{n=e.readQuery({query:s})}catch(e){t&&t.error("Unable to fetch deleted messages",e)}return n&&n.deletedMessages||[]},M=(e,t,n,i,a,o)=>{const r={message:null,isDeletedLieMessage:!1};if(!(o=o||F(e,i))||0===o.length)return r;if(!a){const e=o.find((e=>e.id===t));if(e)return{message:e,isDeletedLieMessage:!1}}const s=o.find((e=>e.message&&e.message.clientMessageId===n));return s?{message:s,isDeletedLieMessage:!0}:r}},291540:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"dlpDialogData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dlpDialogData"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isReport"}},{kind:"Field",name:{kind:"Name",value:"isOverride"}},{kind:"Field",name:{kind:"Name",value:"justification"}}]}}]}}]}},595091:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"insertedHyperlink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"insertedHyperlink"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayText"}},{kind:"Field",name:{kind:"Name",value:"address"}}]}}]}}]}},25729:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"smartReplyFileSuggestion"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"smartReplyFileSuggestion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileName"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}},491257:(e,t,n)=>{"use strict";n.d(t,{Om:()=>s,Ng:()=>l});var i=n(892891),a=n(118824);const o=[{predicate:e=>!!e.get(a.J.Presence).enablePresenceInWorker,resolvers:{query:["presence","presences"],mutation:["setPresence","setStatusNote","setCallStatePresence"],subscription:["presenceUpdateEvent"]}},{predicate:e=>!!e.get(a.J.Host).enableEspInWorker||!!e.get(a.J.Esp).enableEsp,resolvers:{query:["espState","irisCampaign"],mutation:["recordEligibleSurface","recordDisplayedSurface","recordEspCompletedActions","triggerNotificationDisplay"],subscription:["espTriggerEvent"]}},{predicate:e=>!!e.get(a.J.Guardians).enableMembersAndRelatedContactsWorkerResolver,resolvers:{query:["membersAndRelatedContacts"],mutation:[],subscription:[]}},{predicate:e=>!!e.get(a.J.Guardians).enableRelatedContactsWorkerResolver,resolvers:{query:["relatedContacts"],mutation:[],subscription:[]}},{predicate:e=>!!e.get(a.J.Host).enableHybridDiscoverSurface,resolvers:{query:["feed"],mutation:["feedback","discoverSurfaceUserPreferenceForEntities","removeHasUpdatedItemsFlag"],subscription:["replyChainSummaryEvent","discoverFeedHasUpdatedItems"]}},{predicate:e=>!!e.get(a.J.WhatsNew).enableWhatsNew,resolvers:{query:["whatsNewState"],mutation:["recordWhatsNewDisplayedFeature","recordWhatsNewEntryPointPromotion","recordWhatsNewEntryPointUserAction"],subscription:[]}}],r=[{predicate:e=>!!e.get(a.J.Host).enableOfflineActionsManager&&!!e.get(a.J.Host).msgEnableOfflineReactions,resolvers:{query:[],mutation:["updateMessageEmotion"],subscription:[]}},{predicate:e=>!!e.get(a.J.Messaging).msgEnableAutoSetConsumptionHorizonResolver,resolvers:{query:[],mutation:["setConsumptionHorizon"],subscription:[]}},{predicate:e=>!!e.get(a.J.Extensibility).enableAdaptiveAppletCacheFromCDL,resolvers:{query:[],mutation:["cardCacheOperation"],subscription:[]}}];function s(e,t){const{experimentalResolvers:n,stableResolvers:o}=e.get(a.J.Cdl),s=o&&o.resolvers||{query:[],mutation:[],subscription:[]};if(t.log(`Supported operations from config: ${JSON.stringify(s,c)}`),o&&o.version&&n&&n.version&&o.version>=n.version){const e=n.resolvers||{query:[],mutation:[],subscription:[]};t.log(`Supported operations from ECS: ${JSON.stringify(e,c)}`),(0,i.mergeWith)(s,e,u)}m(s,r,e,t);const l=(0,i.mapValues)(s,(e=>e?new Set(e):new Set)),{dataLayerSettings:g}=e.get(a.J.Host);return d(g,l,t,"Angular")}function l(e,t,n){const r=function(e,t){var n;let a;try{if(!t)throw new Error("CDL Worker did not return supported operations");a=JSON.parse(t)}catch(t){null===(n=e.errorToTelemetry)||void 0===n||n.call(e,`getWorkerSupportedOperations: Failed to set CDL Worker supported operations: ${t&&t.message}`,"cdl_worker_manager_get_worker_supported_operations_error",void 0,!0),a={query:[],mutation:[],subscription:[]}}return(0,i.mapValues)(a,(e=>e?new Set(e):new Set))}(t,n),{supportedResolvers:s,activitySupportedResolvers:l,mtmaMissedNotificationsSupportedResolvers:c,calendarSupportedResolvers:g,chatSupportedResolvers:p,chatPartiallySupportedResolvers:v,phonelinkSmsSupportedResolvers:h,appsUsageResolvers:f,peopleTargetingSupportedResolvers:y}=e.get(a.J.CdlWorker),k=function(e){const t={query:[],mutation:[],subscription:[]};return e.forEach((e=>e&&(0,i.mergeWith)(t,e,u))),t}([s,l,c,g,p,v,h,f,y]);return m(k,o,e,t),d(k,r,t,"Worker")}function d(e,t,n,a){if(!e)return{query:new Set,mutation:new Set,subscription:new Set};n.log(`Supported operations received from ${a}: ${JSON.stringify(e,c)}`);const o=(0,i.mapValues)(e,((e,n)=>new Set(e.filter((e=>t[n]&&t[n].has(e))))));return n.log(`Merged datalayer settings with config: ${JSON.stringify(o,c)}`),o}const c=(e,t)=>"object"==typeof t&&t instanceof Set?Array.from(t):t,u=(e,t)=>(0,i.isArray)(e)?e.concat(t):void 0;function m(e,t,n,a){const o={query:[],mutation:[],subscription:[]};t.forEach((({predicate:e,resolvers:t})=>{e(n)&&(0,i.mergeWith)(o,t,u)})),a.log(`Supported additional operations: ${JSON.stringify(o,c)}`),(0,i.mergeWith)(e,o,u)}},792691:(e,t,n)=>{"use strict";n.d(t,{Ow:()=>a,wA:()=>o,gv:()=>i});const i={parseFileLabelQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"parseFileLabelFromUrl"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ParseFileLabelFromUrlInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"parseFileLabelFromUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileLabel"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"linktype"}}]}}]}}]}}]},fileDetailsForChicletQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsForChiclet"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileDetailsForChicletInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsForChiclet"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"fileSourceDetail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileSource"}}]}}]}}]}}]}}]},fetchShareInfoQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchShareInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"redeemFile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"siteUrl"}}]}}]}}]}}]},currentFilesQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getFiles"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileContainerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentFiles"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fileContainerId"},value:{kind:"Variable",name:{kind:"Name",value:"fileContainerId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"progress"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"isReferencedFile"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"permissionScope"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}},{kind:"Field",name:{kind:"Name",value:"externalFileShareInfo"}}]}}]}}]},userPreferencesQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPersonalSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileOpenPreference"}},{kind:"Field",name:{kind:"Name",value:"nonFileOpenPreferenceSelectedCount"}}]}}]}}]}}]}}]},fileShareDialogAudience:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shareDialogAudience"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shareDialogAudienceInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ShareDialogAudienceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareDialogAudience"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shareDialogAudienceInput"},value:{kind:"Variable",name:{kind:"Name",value:"shareDialogAudienceInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recipients"}},{kind:"Field",name:{kind:"Name",value:"audienceConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityName"}},{kind:"Field",name:{kind:"Name",value:"audienceType"}}]}}]}}]}}]},fileDetailsByIdQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsById"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileByIdInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileByIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"redeemFileById"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileByIdInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileByIdInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}}]}}]}}]},fileDetailsWithSharepointIdQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDetailsWithSharepointId"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileDetailsWithSharepointIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsWithSharepointId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"},value:{kind:"Variable",name:{kind:"Name",value:"fileDetailsWithSharepointIdInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}}]}}]}}]}}]},fileDetailsForThumbnailQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientFilesFileRedeemThumbnailQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RedeemFileInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDetailsForThumbnail"},arguments:[{kind:"Argument",name:{kind:"Name",value:"redeemFileInput"},value:{kind:"Variable",name:{kind:"Name",value:"redeemFileInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"webUrl"}},{kind:"Field",name:{kind:"Name",value:"size"}},{kind:"Field",name:{kind:"Name",value:"eTag"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"odataContext"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"parentReference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"driveId"}},{kind:"Field",name:{kind:"Name",value:"driveType"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"path"}}]}},{kind:"Field",name:{kind:"Name",value:"cTag"}},{kind:"Field",name:{kind:"Name",value:"sharepointIds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"listId"}},{kind:"Field",name:{kind:"Name",value:"listItemId"}},{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}},{kind:"Field",name:{kind:"Name",value:"siteId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"syncResourceId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"webId"}}]}},{kind:"Field",name:{kind:"Name",value:"thumbnails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"small"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"medium"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"large"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"file"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mimeType"}},{kind:"Field",name:{kind:"Name",value:"irmEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"fileSystemInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createdDateTime"}},{kind:"Field",name:{kind:"Name",value:"lastModifiedDateTime"}}]}},{kind:"Field",name:{kind:"Name",value:"shared"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"effectiveRoles"}},{kind:"Field",name:{kind:"Name",value:"scope"}}]}}]}}]}}]},openInDesktopAsDeviceSpecificFileOpenPreferenceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"openInDesktopAsDeviceSpecificFileOpenPreference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"openInDesktopAsDeviceSpecificFileOpenPreference"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isDesktopSetAsDefaultFileOpenPreference"}}]}}]}}]}},a={fileDownloadDetailsUsingItemDetailsServiceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDownloadDetailsUsingItemDetailsService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemDetailsServiceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDownloadDetailsUsingItemDetailsService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}},{kind:"Field",name:{kind:"Name",value:"webDavUrl"}}]}}]}}]},fileDownloadDetailsUsingLegacyVroomServiceQuery:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fileDownloadDetailsUsingLegacyVroomService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LegacyVroomServiceInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileDownloadDetailsUsingLegacyVroomService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"downloadUrl"}}]}}]}}]}},o={downloadFileMutation:{kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"downloadFile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"downloadUrl"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadFile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"downloadUrl"},value:{kind:"Variable",name:{kind:"Name",value:"downloadUrl"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadUrl"}}]}}]}}]}}},11695:(e,t,n)=>{"use strict";n.d(t,{zz:()=>d,nG:()=>l,Fj:()=>c});var i=n(642115),a=n(281857),o=n(892891),r=n(792691);const s=(e,t)=>{let n=null;try{n=e.readQuery({query:r.gv.currentFilesQuery,variables:{fileContainerId:t}})}catch(e){}if(!n)throw new Error("Expected initial files to be populated before a command is executed");return n.currentFiles},l=(e,t,n)=>s(n,t).find((t=>t.id===e)),d=(e,t,n)=>{const i={currentFiles:[...s(t,n).map((t=>{const n=e.findIndex((e=>e.id===t.id));if(-1===n)return t;const i=e[n];e.splice(n,1);return(0,o.merge)({},t,i)})),...e]};t.writeQuery({query:r.gv.currentFilesQuery,variables:{fileContainerId:n},data:i})},c=(e,t,n)=>{const o=s(n,t),l=o.find((t=>t.id===e));if(!l)throw(0,i.Tr)("FileUploadResolver",a.jK.NotPresent,"removecachefile",{logErrorMessage:`File with id: ${e} not found  in the cache`});const d=o.filter((t=>t.id!==e));return n.writeQuery({query:r.gv.currentFilesQuery,variables:{fileContainerId:t},data:{currentFiles:d}}),l}},490326:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDetailsResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDetailsResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appInstallId"}},{kind:"Field",name:{kind:"Name",value:"isAppInstalled"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}}]}}]}}]}},907306:(e,t,n)=>{"use strict";n.d(t,{kY:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"customAppUploadResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppUploadResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customAppType"}}]}}]}}]}},589884:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppButtonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appButtonResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}}]}},920047:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppDevicePermissionsUpdatedQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDevicePermissionsUpdated"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]}},136772:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppsBadgeReadQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsBadgeRead"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},627291:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformBackButtonHandlerStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"backButtonHandlerState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registered"}}]}}]}}]}},622673:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},878635:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsTriggerQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsTriggerResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},523950:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformInContextStoreLaunchInstalledAppResultQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"inContextStoreLaunchInstalledAppResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"capability"}},{kind:"Field",name:{kind:"Name",value:"appDisplayName"}},{kind:"Field",name:{kind:"Name",value:"draftId"}}]}}]}}]}},569516:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformLocalFrameContextQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localFrameContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}}]}}]}}]}},516135:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mapCoordinateResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mapCoordinateResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}},{kind:"Field",name:{kind:"Name",value:"locationApiError"}}]}}]}}]}},619695:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageExtensionsAppsState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageExtensionsAppsState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toggleRefetch"}}]}}]}}]}},721715:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToChildResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToChildResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},85273:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToParentResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToParentResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},582364:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectMediaResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaError"}},{kind:"Field",name:{kind:"Name",value:"mediaUrls"}}]}}]}}]}},698355:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectPeoplePickerResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectPeoplePickerResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"email"}}]}}]}}]}},454016:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"showLocationResponse"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showLocationResponse"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},685539:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"tabConfigurationResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tabConfigurationResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},369443:(e,t,n)=>{"use strict";n.d(t,{sR:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"taskModuleResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"taskModuleResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"card"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"adaptiveCardTabResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"taskModuleId"}},{kind:"Field",name:{kind:"Name",value:"draftId"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"reason"}},{kind:"Field",name:{kind:"Name",value:"entryPoint"}}]}}]}}]}},337147:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"viewImagesResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesError"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}}]}}]}}]}},228222:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webhookConfirmationResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webhookConfirmationResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},567444:(e,t,n)=>{"use strict";n.r(t),n.d(t,{clientResolvers:()=>i.w,resolvers:()=>o,typeDefs:()=>s,useActiveWindow:()=>r.M,writeWindowsDefaults:()=>a.k});var i=n(214118),a=n(532009);const o={Subscription:{windowStateEvent:{subscribe:(e,{windowId:t},{pubsub:n})=>n.asyncIterator(`windowStateEvent-${t}`)}}};var r=n(507488),s=n(388258)},507488:(e,t,n)=>{"use strict";n.d(t,{M:()=>o});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}}]};var a=n(424555);const o=e=>{const{data:t,error:n,loading:o}=(0,a.a)(i,{variables:{windowId:e}});if(t&&!n&&!o)return t.activeWindow}},214118:(e,t,n)=>{"use strict";n.d(t,{w:()=>s});var i=n(264091),a=n(154923),o=n(892891);function r(e,t,n=!0){var a;let r=[];try{const t=e.readQuery({query:i.i8});r=null!==(a=null==t?void 0:t.activeWindows)&&void 0!==a?a:r}catch(e){t.warn(`cache.readQuery failed for activeWindowsQuery with ${e}`)}return n?(0,o.cloneDeep)(r):r}const s=()=>({Query:{activeWindows:(e,t,{cache:n,loggerFactory:i})=>r(n,i.newLogger("activeWindows-query"),!1)},Mutation:{removeWindow(e,{windowId:t},{cache:n,loggerFactory:o,commandChangeReportingService:s}){const l=o.newLogger("removeWindow-mutation"),d=r(n,l),c=d.findIndex((e=>e.id===t));if(c>=0){const e=function(e,t,n){const a=e.splice(t,1);return n.writeQuery({query:i.i8,data:{activeWindows:e}}),a[0]}(d,c,n);return s.report({type:a.B.Close,correlationId:e.correlation.id,context:{target:"remove-window-mutation"}}),e}return l.warn(`Removing window that does not exist ${t}`),null}}})},532009:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var i=n(264091);function a(e){e.writeQuery({query:i.i8,data:{activeWindows:[]}})}},669702:(e,t,n)=>{"use strict";n.d(t,{Eb:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"smallImageUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"categories"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"showTabLoadingIndicator"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"botDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"customBots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endpointUrl"}},{kind:"Field",name:{kind:"Name",value:"secret"}}]}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"contentBotId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"containerAppIds"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isAnonymousAccessAllowed"}},{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}},{kind:"Field",name:{kind:"Name",value:"videoAppContentUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"inputType"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"choices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageHandlers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"value"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"domains"}},{kind:"Field",name:{kind:"Name",value:"supportsAnonymousAccess"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"resource"}},{kind:"Field",name:{kind:"Name",value:"applicationPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"screenshotUrls"}},{kind:"Field",name:{kind:"Name",value:"officeAssetId"}},{kind:"Field",name:{kind:"Name",value:"videoUrl"}},{kind:"Field",name:{kind:"Name",value:"devicePermissions"}},{kind:"Field",name:{kind:"Name",value:"securityComplianceInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mcasId"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"csaId"}},{kind:"Field",name:{kind:"Name",value:"csaName"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultInstallScope"}},{kind:"Field",name:{kind:"Name",value:"defaultGroupCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"}},{kind:"Field",name:{kind:"Name",value:"groupchat"}},{kind:"Field",name:{kind:"Name",value:"meetings"}}]}},{kind:"Field",name:{kind:"Name",value:"subscriptionOffer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"offerId"}}]}},{kind:"Field",name:{kind:"Name",value:"manifestVersion"}}]}},...n(626588).g.definitions]}},626588:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"botDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"commandLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}}]}}]}},336265:(e,t,n)=>{"use strict";n.d(t,{_L:()=>a});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"sdnFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SDNDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"playbackInfo"}},{kind:"Field",name:{kind:"Name",value:"pluginUrl"}},{kind:"Field",name:{kind:"Name",value:"sdkUrl"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Broadcast"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"admissionType"}},{kind:"Field",name:{kind:"Name",value:"userRole"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"streamingDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"streamingDetailsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"qna"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}},{kind:"Field",name:{kind:"Name",value:"attendeeUrl"}},{kind:"Field",name:{kind:"Name",value:"moderatorUrl"}},{kind:"Field",name:{kind:"Name",value:"iosAutodiscoverUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"yammer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}},{kind:"Field",name:{kind:"Name",value:"broadcastId"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"eventUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingStatus"}},{kind:"Field",name:{kind:"Name",value:"sdn"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"sdnFields"}}]}},{kind:"Field",name:{kind:"Name",value:"transcription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"}},{kind:"Field",name:{kind:"Name",value:"isSuppressed"}},{kind:"Field",name:{kind:"Name",value:"transcriptionLanguage"}},{kind:"Field",name:{kind:"Name",value:"translationLanguages"}},{kind:"Field",name:{kind:"Name",value:"captionsCacheUrl"}},{kind:"Field",name:{kind:"Name",value:"captionsOriginUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"aesKey"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"iv"}},{kind:"Field",name:{kind:"Name",value:"expiry"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"aesKeyRefresh"}},{kind:"Field",name:{kind:"Name",value:"error"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"errorFields"}}]}},{kind:"Field",name:{kind:"Name",value:"utcStart"}},{kind:"Field",name:{kind:"Name",value:"utcEnd"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"supportUrl"}},{kind:"Field",name:{kind:"Name",value:"streamResource"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attendeeEmbed"}}]}},{kind:"Field",name:{kind:"Name",value:"signalR"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attendeeHubName"}},{kind:"Field",name:{kind:"Name",value:"eventTeamHubName"}},{kind:"Field",name:{kind:"Name",value:"setCookieUrl"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"querystrings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"joinid"}},{kind:"Field",name:{kind:"Name",value:"msgid"}},{kind:"Field",name:{kind:"Name",value:"organizerid"}},{kind:"Field",name:{kind:"Name",value:"tenantid"}},{kind:"Field",name:{kind:"Name",value:"threadid"}},{kind:"Field",name:{kind:"Name",value:"uid"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"broadcastRestartVersion"}},{kind:"Field",name:{kind:"Name",value:"odspVodShareUrl"}},{kind:"Field",name:{kind:"Name",value:"access"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attendeeAuthorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"details"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"subCode"}}]}},{kind:"Field",name:{kind:"Name",value:"disableLobby"}},{kind:"Field",name:{kind:"Name",value:"inInvitation"}},{kind:"Field",name:{kind:"Name",value:"useLiveEventAuthorizationV2"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"streamingDetailsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastStreamingDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"stream"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"streamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"altStream"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"streamFields"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"streamFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastStreamingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"wamsStreamingUrl"}},{kind:"Field",name:{kind:"Name",value:"decryptionToken"}},{kind:"Field",name:{kind:"Name",value:"keyAuthorizationToken"}},{kind:"Field",name:{kind:"Name",value:"setKeyAuthorizationCookieUri"}},{kind:"Field",name:{kind:"Name",value:"sdn"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"sdnFields"}}]}},{kind:"Field",name:{kind:"Name",value:"deliveryPipelineType"}}]}},...i.definitions]}.definitions]}.definitions,...i.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"errorFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastErrorDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"errorMessage"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"errorSubCode"}}]}}]}},517344:(e,t,n)=>{"use strict";n.d(t,{hl:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAlert"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAlert"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamsCallId"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"alertType"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"ariaText"}},{kind:"Field",name:{kind:"Name",value:"severity"}},{kind:"Field",name:{kind:"Name",value:"actions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"action"}}]}},{kind:"Field",name:{kind:"Name",value:"dismissable"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"action"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AlertAction"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"isSecondary"}},{kind:"Field",name:{kind:"Name",value:"actionId"}}]}}]}},482500:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"card"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Card"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"userSpecificContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"authBlockLastUsedOn"}}]}}]}}]}},453490:(e,t,n)=>{"use strict";n.d(t,{zL:()=>d});var i=n(552888),a=n(13039),o=n(275333),r=n(453163),s=n(482500),l=n(550286);const d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"connectorPostMessage"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectorPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"connectorMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorSenderGuid"}},{kind:"Field",name:{kind:"Name",value:"providerAccountUniqueId"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.v.definitions,...l.x.definitions]}},299034:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizonBookmark"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},232922:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},277783:(e,t,n)=>{"use strict";n.d(t,{Be:()=>m});var i=n(552888),a=n(13039),o=n(275333),r=n(453163),s=n(482500),l=n(601216),d=n(550286),c=n(545872),u=n(722439);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonAnnouncementPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"announcement"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"originalImageUrl"}},{kind:"Field",name:{kind:"Name",value:"croppedImageUrl"}},{kind:"Field",name:{kind:"Name",value:"colorTheme"}},{kind:"Field",name:{kind:"Name",value:"croppedImageHeight"}},{kind:"Field",name:{kind:"Name",value:"croppedImageWidth"}},{kind:"Field",name:{kind:"Name",value:"croppedImageAltText"}},{kind:"Field",name:{kind:"Name",value:"isTeamsIllustration"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.v.definitions,...l.w.definitions,...d.x.definitions,...c.I.definitions,...u.M3.definitions]}},601216:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ATPSafelinksSharepointData"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"URL"}},{kind:"Field",name:{kind:"Name",value:"Xsdata"}},{kind:"Field",name:{kind:"Name",value:"Sdata"}}]}}]}},325e3:(e,t,n)=>{"use strict";n.d(t,{E3:()=>m});var i=n(552888),a=n(13039),o=n(275333),r=n(453163);const s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"from"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"sender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"to"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"cc"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]}},{kind:"Field",name:{kind:"Name",value:"emailLink"}},{kind:"Field",name:{kind:"Name",value:"totalRecipients"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"smtp"}}]}}]};var l=n(482500),d=n(601216),c=n(550286),u=n(545872);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"emailDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.definitions,...l.v.definitions,...d.w.definitions,...c.x.definitions,...u.I.definitions]}},130476:(e,t,n)=>{"use strict";n.d(t,{N4:()=>l});var i=n(13039),a=n(275333),o=n(453163),r=n(482500),s=n(550286);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonGuardiansPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"parentsAnnouncementsStatus"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.w.definitions,...a.p.definitions,...o.S.definitions,...r.v.definitions,...s.x.definitions]}},722439:(e,t,n)=>{"use strict";n.d(t,{M3:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingActionType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ScheduledMeetingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]}},295487:(e,t,n)=>{"use strict";n.d(t,{lU:()=>m});var i=n(13039),a=n(275333),o=n(453163),r=n(552888),s=n(722439),l=n(482500),d=n(601216),c=n(550286),u=n(545872);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.w.definitions,...a.p.definitions,...o.S.definitions,...r.Uw.definitions,...s.M3.definitions,...l.v.definitions,...d.w.definitions,...c.x.definitions,...u.I.definitions]}},927529:(e,t,n)=>{"use strict";n.d(t,{yM:()=>m});var i=n(275333),a=n(453163),o=n(13039),r=n(482500),s=n(601216),l=n(552888),d=n(722439),c=n(550286),u=n(545872);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingReplyMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.p.definitions,...a.S.definitions,...o.w.definitions,...r.v.definitions,...s.w.definitions,...l.Uw.definitions,...d.M3.definitions,...c.x.definitions,...u.I.definitions]}},434960:(e,t,n)=>{"use strict";n.d(t,{lB:()=>u});var i=n(552888),a=n(275333),o=n(453163),r=n(13039),s=n(482500),l=n(601216),d=n(545872),c=n(550286);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonReplyMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}},{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"isImportant"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"attached"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.p.definitions,...o.S.definitions,...r.w.definitions,...s.v.definitions,...l.w.definitions,...d.I.definitions,...c.x.definitions]}},806812:(e,t,n)=>{"use strict";n.d(t,{w3:()=>u});var i=n(552888),a=n(13039),o=n(275333),r=n(453163),s=n(482500),l=n(601216),d=n(545872),c=n(550286);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonStandardPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"isLastRead"}},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"}},{kind:"Field",name:{kind:"Name",value:"isCrossPost"}},{kind:"Field",name:{kind:"Name",value:"crossPostId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]}},{kind:"Field",name:{kind:"Name",value:"messageRenderType"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"canUserReply"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}}]}},...i.Uw.definitions,...a.w.definitions,...o.p.definitions,...r.S.definitions,...s.v.definitions,...l.w.definitions,...d.I.definitions,...c.x.definitions]}},293681:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonUserI18NFieldsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"surname"}}]}}]}},545872:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"dlpContext"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DlpContext"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policyViolation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"verdictDetails"}},{kind:"Field",name:{kind:"Name",value:"dlpAction"}},{kind:"Field",name:{kind:"Name",value:"genericStreamItemId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"justificationText"}},{kind:"Field",name:{kind:"Name",value:"userAction"}},{kind:"Field",name:{kind:"Name",value:"violationType"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"policyTip"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalText"}},{kind:"Field",name:{kind:"Name",value:"complianceUrl"}},{kind:"Field",name:{kind:"Name",value:"matchedConditionDescriptions"}}]}}]}}]}}]}},275333:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emotions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"time"}}]}}]}}]}},453163:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"emotionsSummary"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}}]}},552888:(e,t,n)=>{"use strict";n.d(t,{Uw:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"files"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"File"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"providerDataV2"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},63053:(e,t,n)=>{"use strict";n.d(t,{W4:()=>o});var i=n(401510),a=n(669702);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"installedAppFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"installedAppProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUninstallable"}},{kind:"Field",name:{kind:"Name",value:"isAdminPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewGlobalPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewAdminPreInstalled"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appPermissions"}}]}}]}},...i.l.definitions,...a.Eb.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"appPermissions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppPermissions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},229290:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"lastMessageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LastMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}}]}}]}},545004:(e,t,n)=>{"use strict";n.d(t,{qL:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingInformationFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"scenario"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"isRecurring"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"resolvedSensitivityLabelId"}},{kind:"Field",name:{kind:"Name",value:"isCopyRestrictionEnforced"}}]}}]}},13039:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"mentions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Mention"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}}]}},401510:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageExtensionState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MessageExtensionState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"pinOrder"}}]}}]}},833246:(e,t,n)=>{"use strict";n.d(t,{Ue:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"interopDeliveryState"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"smsDeliveryReports"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"time"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}},{kind:"Field",name:{kind:"Name",value:"escalations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"meetingTitle"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"rsvpTo"}},{kind:"Field",name:{kind:"Name",value:"body"}},{kind:"Field",name:{kind:"Name",value:"meetingActionType"}},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUID"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"timeZoneId"}},{kind:"Field",name:{kind:"Name",value:"originalStartTime"}},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}}]}},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"}},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}},{kind:"Field",name:{kind:"Name",value:"interval"}}]}},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"}}]}},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"userSpecificContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"authBlockLastUsedOn"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"}},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"}}]}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"chicletBreadcrumbs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceTeamName"}},{kind:"Field",name:{kind:"Name",value:"sourceChannelName"}}]}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewUrl"}},{kind:"Field",name:{kind:"Name",value:"previewHeight"}},{kind:"Field",name:{kind:"Name",value:"previewWidth"}},{kind:"Field",name:{kind:"Name",value:"progressComplete"}},{kind:"Field",name:{kind:"Name",value:"hasUploadFailed"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"providerDataV2"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"channelId"}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"previewEnabled"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"embeddedLinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"fileShareUrlMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policyViolation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"verdictDetails"}},{kind:"Field",name:{kind:"Name",value:"dlpAction"}},{kind:"Field",name:{kind:"Name",value:"genericStreamItemId"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"justificationText"}},{kind:"Field",name:{kind:"Name",value:"userAction"}},{kind:"Field",name:{kind:"Name",value:"violationType"}}]}},{kind:"Field",name:{kind:"Name",value:"dlpData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"policyTip"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalText"}},{kind:"Field",name:{kind:"Name",value:"complianceUrl"}},{kind:"Field",name:{kind:"Name",value:"matchedConditionDescriptions"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"editTime"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"userHasSaved"}},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"}},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"}},{kind:"Field",name:{kind:"Name",value:"deleteFailed"}}]}},{kind:"Field",name:{kind:"Name",value:"translation"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"URL"}},{kind:"Field",name:{kind:"Name",value:"Xsdata"}},{kind:"Field",name:{kind:"Name",value:"Sdata"}}]}},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"}},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"}},{kind:"Field",name:{kind:"Name",value:"translatedSubject"}},{kind:"Field",name:{kind:"Name",value:"translatedContent"}},{kind:"Field",name:{kind:"Name",value:"translationStatus"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"}},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"}},{kind:"Field",name:{kind:"Name",value:"scheduledSendTime"}},{kind:"Field",name:{kind:"Name",value:"draftId"}},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"}},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"}}]}}]}},293761:(e,t,n)=>{"use strict";n.d(t,{u_:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"participantFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Participant"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isServerMuted"}},{kind:"Field",name:{kind:"Name",value:"isHandRaised"}},{kind:"Field",name:{kind:"Name",value:"raiseHandsRank"}},{kind:"Field",name:{kind:"Name",value:"raiseHandsOrderedRank"}},{kind:"Field",name:{kind:"Name",value:"isSpotlighted"}},{kind:"Field",name:{kind:"Name",value:"spotlightRank"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isReconciled"}},{kind:"Field",name:{kind:"Name",value:"streams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"audio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"isVideoLive"}},{kind:"Field",name:{kind:"Name",value:"isScreenShareLive"}},{kind:"Field",name:{kind:"Name",value:"meetingRole"}},{kind:"Field",name:{kind:"Name",value:"stateReason"}},{kind:"Field",name:{kind:"Name",value:"contentSharingRole"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"holographicDevice"}},{kind:"Field",name:{kind:"Name",value:"timeZoneOffset"}},{kind:"Field",name:{kind:"Name",value:"endpoints"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"endpointDetailsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"weathermanModeDetail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"weathermanModeDetailFields"}}]}},{kind:"Field",name:{kind:"Name",value:"mappedTo"}},{kind:"Field",name:{kind:"Name",value:"mappedToMeetingRoom"}},{kind:"Field",name:{kind:"Name",value:"deviceType"}},{kind:"Field",name:{kind:"Name",value:"interpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isInterpreter"}},{kind:"Field",name:{kind:"Name",value:"group"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"joinCorrelationId"}},{kind:"Field",name:{kind:"Name",value:"isInSameRoom"}},{kind:"Field",name:{kind:"Name",value:"isIdentityMasked"}},{kind:"Field",name:{kind:"Name",value:"nonMaskedId"}},{kind:"Field",name:{kind:"Name",value:"nonMaskedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"maskedIdSeqNumber"}},{kind:"Field",name:{kind:"Name",value:"displayNameOverride"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"participantStreamFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ParticipantStream"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAvailable"}},{kind:"Field",name:{kind:"Name",value:"isStreaming"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"rank"}},{kind:"Field",name:{kind:"Name",value:"negotiationTag"}},{kind:"Field",name:{kind:"Name",value:"participantLegId"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"endpointId"}},{kind:"Field",name:{kind:"Name",value:"dynamicVirtualParticipantId"}},{kind:"Field",name:{kind:"Name",value:"mediaDeviceCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMediaDeviceCapabilitiesFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"sourceId"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMediaDeviceCapabilitiesFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MediaDeviceCapabilities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"videoAspectRatio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonVideoAspectRatioFragment"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonVideoAspectRatioFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VideoAspectRatio"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}.definitions]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"endpointDetailsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EndpointDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"originalId"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"clientEndpointCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"}}]}},{kind:"Field",name:{kind:"Name",value:"endpointId"}},{kind:"Field",name:{kind:"Name",value:"endpointMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"audienceview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"page"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"botData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hiddenParticipant"}},{kind:"Field",name:{kind:"Name",value:"hiddenStream"}},{kind:"Field",name:{kind:"Name",value:"canBeMutedAndUnMuted"}},{kind:"Field",name:{kind:"Name",value:"page"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientEndpointCapabilities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CanSupportBreakOutRoom"}}]}}]}.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"weathermanModeDetailFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WeathermanModeDetail"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isWeatherpersonPresenter"}},{kind:"Field",name:{kind:"Name",value:"overlayCoords"}}]}}]}},438451:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"pinnedMessageItemFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},550286:(e,t,n)=>{"use strict";n.d(t,{x:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"translation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Translation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"subject"}},{kind:"Field",name:{kind:"Name",value:"title"}}]}}]}},107861:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"typingUserFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TypingUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"arrivalTime"}}]}}]}},915465:(e,t,n)=>{"use strict";n.d(t,{o:()=>i,f:()=>a});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"featureSettingsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserFeatureSettingsInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coExistenceMode"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatEnabled"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"decoratedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"surname"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"jobTitle"}},{kind:"Field",name:{kind:"Name",value:"department"}},{kind:"Field",name:{kind:"Name",value:"featureSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"featureSettingsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},...i.definitions]}},156508:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProperties"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationUserProperties"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isMutedInChannel"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"maskId"}}]}}]}},395816:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m,g,p,v,h,f,y,k,S,b,C,w,N,T,I,E,A,_,D,F,M,R,P,O,x,L,U,B,j,W,V,H,$,z,G,q,Q,J,Y,K,Z,X,ee,te,ne,ie,ae,oe,re,se,le,de,ce,ue,me,ge,pe,ve,he,fe,ye,ke,Se,be,Ce,we,Ne,Te,Ie,Ee,Ae,_e,De,Fe,Me,Re,Pe,Oe,xe,Le,Ue,Be,je,We,Ve,He,$e,ze,Ge,qe,Qe,Je,Ye,Ke,Ze,Xe,et,tt,nt,it,at,ot,rt,st,lt,dt,ct,ut,mt,gt,pt,vt,ht,ft,yt,kt,St,bt,Ct,wt,Nt,Tt,It,Et,At,_t,Dt,Ft,Mt,Rt,Pt,Ot,xt,Lt,Ut,Bt,jt,Wt,Vt,Ht,$t,zt,Gt,qt,Qt,Jt,Yt,Kt,Zt,Xt,en,tn,nn,an,on,rn,sn,ln,dn,cn,un,mn,gn,pn,vn,hn,fn,yn,kn,Sn,bn,Cn,wn,Nn,Tn,In,En,An,_n,Dn,Fn,Mn,Rn,Pn,On,xn,Ln,Un,Bn,jn,Wn,Vn,Hn,$n,zn,Gn,qn,Qn,Jn,Yn,Kn,Zn,Xn,ei,ti,ni,ii,ai,oi,ri,si,li,di,ci,ui,mi,gi,pi,vi,hi,fi,yi,ki,Si,bi,Ci,wi,Ni,Ti,Ii,Ei,Ai,_i,Di,Fi,Mi,Ri,Pi,Oi,xi,Li,Ui,Bi,ji,Wi,Vi,Hi,$i,zi,Gi,qi,Qi,Ji,Yi,Ki,Zi,Xi,ea,ta,na,ia,aa,oa,ra,sa,la,da,ca,ua,ma,ga,pa,va,ha,fa,ya,ka,Sa,ba,Ca,wa,Na,Ta,Ia,Ea,Aa,_a,Da,Fa,Ma,Ra,Pa,Oa,xa,La,Ua,Ba,ja,Wa,Va,Ha,$a,za,Ga,qa,Qa,Ja,Ya,Ka,Za,Xa,eo,to,no,io,ao,oo,ro,so,lo,co,uo,mo,go,po,vo,ho,fo,yo,ko,So,bo,Co,wo,No,To,Io,Eo,Ao,_o,Do,Fo,Mo,Ro,Po,Oo,xo,Lo,Uo,Bo,jo,Wo,Vo,Ho,$o,zo,Go,qo,Qo,Jo,Yo,Ko,Zo,Xo,er,tr,nr,ir,ar,or,rr,sr,lr,dr,cr,ur,mr,gr,pr,vr,hr,fr,yr,kr,Sr,br,Cr,wr,Nr,Tr,Ir,Er,Ar,_r,Dr,Fr,Mr,Rr,Pr,Or,xr,Lr,Ur,Br,jr,Wr,Vr,Hr,$r,zr,Gr,qr,Qr,Jr,Yr,Kr,Zr,Xr,es,ts,ns,is,as,os,rs,ss,ls,ds,cs,us,ms,gs,ps,vs,hs,fs,ys,ks,Ss,bs,Cs,ws,Ns,Ts,Is,Es,As,_s,Ds,Fs,Ms,Rs,Ps,Os,xs,Ls,Us,Bs,js,Ws,Vs,Hs,$s,zs,Gs,qs,Qs,Js,Ys,Ks,Zs,Xs,el,tl,nl,il,al,ol,rl,sl,ll,dl,cl,ul,ml,gl,pl,vl,hl,fl,yl,kl,Sl,bl,Cl,wl,Nl,Tl,Il,El,Al,_l,Dl,Fl,Ml,Rl,Pl,Ol,xl,Ll,Ul,Bl,jl,Wl,Vl,Hl,$l,zl,Gl,ql,Ql,Jl,Yl,Kl,Zl,Xl,ed,td,nd,id,ad,od,rd,sd,ld,dd,cd,ud,md,gd,pd,vd,hd,fd,yd,kd,Sd,bd,Cd,wd,Nd,Td,Id,Ed,Ad,_d,Dd,Fd,Md,Rd,Pd,Od,xd,Ld,Ud,Bd,jd,Wd,Vd,Hd,$d,zd,Gd,qd,Qd,Jd,Yd,Kd,Zd,Xd;n.d(t,{bCV:()=>i,XR$:()=>a,jx2:()=>o,phR:()=>r,hFs:()=>s,sZ5:()=>l,vhA:()=>d,XoC:()=>c,Z7A:()=>u,ipA:()=>m,nWM:()=>g,iR3:()=>p,cCY:()=>v,pMG:()=>h,QuG:()=>f,Vuv:()=>y,OJN:()=>k,URt:()=>S,Uq$:()=>b,prp:()=>C,MEc:()=>w,Iho:()=>N,YN3:()=>T,Vif:()=>I,jer:()=>E,gcs:()=>A,dxg:()=>_,wkl:()=>D,uJ4:()=>F,eb2:()=>M,XQ2:()=>R,kAY:()=>P,KRy:()=>O,cAL:()=>x,lCV:()=>L,JLw:()=>U,sRD:()=>B,XDy:()=>j,Dyf:()=>W,jWr:()=>V,zO$:()=>H,Liy:()=>$,WBC:()=>z,pCN:()=>G,k$E:()=>q,BHj:()=>Q,DjH:()=>J,TPi:()=>Y,oXn:()=>K,Z8d:()=>Z,Dhn:()=>X,h6$:()=>ee,fCN:()=>te,JPG:()=>ne,ICr:()=>ie,jpo:()=>ae,h$0:()=>oe,NHA:()=>re,ja_:()=>se,QeU:()=>le,e30:()=>de,YYW:()=>ce,M9W:()=>ue,gXl:()=>me,Io4:()=>ge,fGh:()=>pe,l5h:()=>ve,oNF:()=>he,BIC:()=>fe,VCP:()=>ye,nEL:()=>ke,p8s:()=>Se,BsF:()=>be,Ge7:()=>Ce,YYO:()=>we,WR8:()=>Ne,fk5:()=>Te,wVt:()=>Ie,z$r:()=>Ee,iTP:()=>Ae,O3C:()=>_e,pq3:()=>De,clf:()=>Fe,Ln2:()=>Me,Vfj:()=>Re,_Ll:()=>Pe,b1t:()=>Oe,LVq:()=>xe,zct:()=>Le,l8x:()=>Ue,VTC:()=>Be,yOG:()=>je,ERR:()=>We,LUR:()=>Ve,clb:()=>He,LB2:()=>$e,LQX:()=>ze,EhV:()=>Ge,vDg:()=>qe,gCs:()=>Qe,ts3:()=>Je,Fd9:()=>Ye,X9x:()=>Ke,rsL:()=>Ze,h5P:()=>Xe,Yvc:()=>et,Z4B:()=>tt,y2I:()=>nt,yVM:()=>it,nwx:()=>at,ven:()=>ot,qi6:()=>rt,Ajc:()=>st,jDS:()=>lt,BUQ:()=>dt,vo$:()=>ct,Jb0:()=>ut,MUv:()=>mt,kK_:()=>gt,k_p:()=>pt,XIP:()=>vt,S1B:()=>ht,_iy:()=>ft,eQ$:()=>yt,o2x:()=>kt,msV:()=>St,fNK:()=>bt,pyR:()=>Ct,ukP:()=>wt,feW:()=>Nt,suD:()=>Tt,tF7:()=>It,lOW:()=>Et,fEB:()=>At,c$2:()=>_t,OQr:()=>Dt,WLT:()=>Ft,oqG:()=>Mt,XKC:()=>Rt,ozu:()=>Pt,bax:()=>Ot,jld:()=>xt,v6g:()=>Lt,$0E:()=>Ut,sTL:()=>Bt,jxR:()=>jt,mGI:()=>Wt,Da2:()=>Vt,$Q1:()=>Ht,p1$:()=>$t,ffC:()=>zt,CF7:()=>Gt,a4b:()=>qt,vSz:()=>Qt,Ivr:()=>Jt,OIX:()=>Yt,gVh:()=>Kt,Kks:()=>Zt,hvQ:()=>Xt,MpO:()=>en,yBp:()=>tn,kg$:()=>nn,_Gd:()=>an,xys:()=>on,XlO:()=>rn,sfQ:()=>sn,Ili:()=>ln,i44:()=>dn,H9H:()=>cn,ZAT:()=>un,mTO:()=>mn,LJK:()=>gn,Voh:()=>pn,Cfe:()=>vn,Vne:()=>hn,VDl:()=>fn,Mu6:()=>yn,kjp:()=>kn,mH$:()=>Sn,Cn5:()=>bn,Z9q:()=>Cn,ENt:()=>wn,CNO:()=>Nn,ZnX:()=>Tn,o0l:()=>In,$lW:()=>En,BYq:()=>An,LQ7:()=>_n,c$B:()=>Dn,DGS:()=>Fn,T3A:()=>Mn,I_G:()=>Rn,BzI:()=>Pn,sjk:()=>On,IGm:()=>xn,QFN:()=>Ln,C14:()=>Un,mz$:()=>Bn,CDU:()=>jn,myd:()=>Wn,TPs:()=>Vn,Vos:()=>Hn,tHj:()=>$n,zk2:()=>zn,GXC:()=>Gn,cku:()=>qn,nUz:()=>Qn,ceh:()=>Jn,AeV:()=>Yn,w$N:()=>Kn,FT_:()=>Zn,xUu:()=>Xn,k3Z:()=>ei,KZH:()=>ti,ASP:()=>ni,a8y:()=>ii,cS$:()=>ai,kz6:()=>oi,z_3:()=>ri,k2e:()=>si,uI5:()=>li,A1$:()=>di,UOl:()=>ci,Rdl:()=>ui,B1J:()=>mi,dRH:()=>gi,Mem:()=>pi,HBY:()=>vi,IEi:()=>hi,wJZ:()=>fi,F6r:()=>yi,rJC:()=>ki,Ntc:()=>Si,P$n:()=>bi,hQF:()=>Ci,f1K:()=>wi,LWr:()=>Ni,FTP:()=>Ti,BdF:()=>Ii,Qv1:()=>Ei,kwT:()=>Ai,hyV:()=>_i,Io1:()=>Di,Ryo:()=>Fi,M4c:()=>Mi,s1w:()=>Ri,rRG:()=>Pi,WzC:()=>Oi,xNx:()=>xi,Xjc:()=>Li,LwA:()=>Ui,VwM:()=>Bi,eN:()=>ji,Vf1:()=>Wi,yG1:()=>Vi,ytK:()=>Hi,z_G:()=>$i,qeQ:()=>zi,C9I:()=>Gi,eUH:()=>qi,xuW:()=>Qi,iNV:()=>Ji,m1e:()=>Yi,Ygv:()=>Ki,Tak:()=>Zi,ytf:()=>Xi,s8d:()=>ea,MTl:()=>ta,btQ:()=>na,cj1:()=>ia,TDJ:()=>aa,Yii:()=>oa,BLW:()=>ra,c3b:()=>sa,NK9:()=>la,HnM:()=>da,c_Z:()=>ca,zYS:()=>ua,EUN:()=>ma,h88:()=>ga,Tuo:()=>pa,VRN:()=>va,YnP:()=>ha,tf6:()=>fa,W8Z:()=>ya,v2d:()=>ka,YVt:()=>Sa,s8E:()=>ba,JEf:()=>Ca,_WJ:()=>wa,Hdy:()=>Na,$Kr:()=>Ta,wHp:()=>Ia,ht_:()=>Ea,evG:()=>Aa,Le1:()=>_a,osM:()=>Da,Kb4:()=>Fa,DPJ:()=>Ma,$i$:()=>Ra,VpQ:()=>Pa,su9:()=>Oa,x1h:()=>xa,Ws2:()=>La,RWp:()=>Ua,mFJ:()=>Ba,BUw:()=>ja,q2e:()=>Wa,AjG:()=>Va,rgk:()=>Ha,xz$:()=>$a,$xx:()=>za,FXX:()=>Ga,kge:()=>qa,zcD:()=>Qa,lom:()=>Ja,X6H:()=>Ya,Of:()=>Ka,sfo:()=>Za,xHp:()=>Xa,vE1:()=>eo,xP5:()=>to,Hn1:()=>no,SrV:()=>io,Em8:()=>ao,XuV:()=>oo,Zwl:()=>ro,OQk:()=>so,YEG:()=>lo,YHP:()=>co,Chc:()=>uo,G7Z:()=>mo,w4O:()=>go,Yfn:()=>po,zGj:()=>vo,JEq:()=>ho,G7F:()=>fo,tL2:()=>yo,g9K:()=>ko,_eA:()=>So,XDD:()=>bo,T1N:()=>Co,DTV:()=>wo,amW:()=>No,YQ8:()=>To,P3i:()=>Io,ufv:()=>Eo,IU_:()=>Ao,kUj:()=>_o,R0O:()=>Do,bzN:()=>Fo,$qY:()=>Mo,UnB:()=>Ro,XXy:()=>Po,U4g:()=>Oo,UWY:()=>xo,$IJ:()=>Lo,_BL:()=>Uo,cSI:()=>Bo,WwQ:()=>jo,OCt:()=>Wo,gzh:()=>Vo,UT7:()=>Ho,A49:()=>$o,fNg:()=>zo,eNG:()=>Go,V9I:()=>qo,BFo:()=>Qo,IEy:()=>Jo,xen:()=>Yo,oR$:()=>Ko,$pD:()=>Zo,wR5:()=>Xo,sTX:()=>er,j5k:()=>tr,Oig:()=>nr,aVM:()=>ir,NNg:()=>ar,TEU:()=>or,taM:()=>rr,oR4:()=>sr,TBq:()=>lr,D73:()=>dr,i0v:()=>cr,Tg8:()=>ur,g8S:()=>mr,ZR_:()=>gr,c87:()=>pr,LE8:()=>vr,D8e:()=>hr,MSv:()=>fr,m0e:()=>yr,UjV:()=>kr,MDw:()=>Sr,RyT:()=>br,fjC:()=>Cr,VSu:()=>wr,U5q:()=>Nr,l9N:()=>Tr,Usq:()=>Ir,Jpo:()=>Er,ynw:()=>Ar,FHR:()=>_r,NtM:()=>Dr,vXL:()=>Fr,kfo:()=>Mr,yhY:()=>Rr,Y5e:()=>Pr,dXV:()=>Or,$hY:()=>xr,PwB:()=>Lr,JMQ:()=>Ur,rQh:()=>Br,pyY:()=>jr,YeP:()=>Wr,nK:()=>Vr,EG2:()=>Hr,Q2A:()=>$r,WVv:()=>zr,kUQ:()=>Gr,CO3:()=>qr,$xD:()=>Qr,Ae9:()=>Jr,MnL:()=>Yr,LYR:()=>Kr,XW6:()=>Zr,sQ6:()=>Xr,oDm:()=>es,$cQ:()=>ts,OQO:()=>ns,jQt:()=>is,n96:()=>as,vJe:()=>os,opK:()=>rs,bGy:()=>ss,sTm:()=>ls,aUL:()=>ds,PFp:()=>cs,Rb4:()=>us,ygE:()=>ms,xyM:()=>gs,RaO:()=>ps,Xzf:()=>vs,wJo:()=>hs,wls:()=>fs,JKW:()=>ys,xvC:()=>ks,aR8:()=>Ss,$u5:()=>bs,LXf:()=>Cs,MZr:()=>ws,ivb:()=>Ns,GQc:()=>Ts,zPu:()=>Is,oNc:()=>Es,yNt:()=>As,_34:()=>_s,v0k:()=>Ds,XdF:()=>Fs,H9T:()=>Ms,xa1:()=>Rs,AcR:()=>Ps,Bq8:()=>Os,C55:()=>xs,LQM:()=>Ls,EK3:()=>Us,uNA:()=>Bs,Qbq:()=>js,jlU:()=>Ws,f4k:()=>Vs,P7M:()=>Hs,RqE:()=>$s,dcg:()=>zs,ZSI:()=>Gs,QMz:()=>qs,c0v:()=>Qs,Loq:()=>Js,HTB:()=>Ys,Hy_:()=>Ks,WZ1:()=>Zs,AMX:()=>Xs,CRV:()=>el,MwA:()=>tl,SqH:()=>nl,UZQ:()=>il,wIZ:()=>al,eft:()=>ol,UMR:()=>rl,YXx:()=>sl,unu:()=>ll,mez:()=>dl,KY$:()=>cl,Mck:()=>ul,wGx:()=>ml,ZB_:()=>gl,dOr:()=>pl,u1r:()=>vl,M_S:()=>hl,kBB:()=>fl,LmM:()=>yl,XRp:()=>kl,gLg:()=>Sl,gNb:()=>bl,Jbg:()=>Cl,lFB:()=>wl,GSK:()=>Nl,TSI:()=>Tl,f15:()=>Il,OPX:()=>El,vb$:()=>Al,mFq:()=>_l,Qhk:()=>Dl,rtK:()=>Fl,sqJ:()=>Ml,fXy:()=>Rl,x4d:()=>Pl,_fr:()=>Ol,b8x:()=>xl,TEL:()=>Ll,FFn:()=>Ul,fZW:()=>Bl,$nY:()=>jl,NPL:()=>Wl,rZ3:()=>Vl,dQF:()=>Hl,Bpo:()=>$l,orD:()=>zl,xwW:()=>Gl,y3S:()=>ql,Frf:()=>Ql,Ulw:()=>Jl,PaK:()=>Yl,Up8:()=>Kl,zO9:()=>Zl,OPt:()=>Xl,sCu:()=>ed,fSs:()=>td,r7c:()=>nd,qVz:()=>id,OO0:()=>ad,OE2:()=>od,JJh:()=>rd,l2X:()=>sd,yvs:()=>ld,reX:()=>dd,y$p:()=>cd,MwQ:()=>ud,Q9H:()=>md,_Bi:()=>gd,HRx:()=>pd,wZ4:()=>vd,Slq:()=>hd,Xh1:()=>fd,r2Q:()=>yd,ZHF:()=>kd,arA:()=>Sd,Bo:()=>bd,nqg:()=>Cd,Bg:()=>wd,eDm:()=>Nd,nx0:()=>Td,aU:()=>Id,Qen:()=>Ed,Dz_:()=>Ad,HRk:()=>_d,nV$:()=>Dd,zwH:()=>Fd,UQW:()=>Md,SMg:()=>Rd,vdn:()=>Pd,Cyn:()=>Od,Djg:()=>xd,HrE:()=>Ld,Ei:()=>Ud,oDq:()=>Bd,nmV:()=>jd,xK:()=>Wd,AyW:()=>Vd,swL:()=>Hd,bkD:()=>$d,U6l:()=>zd,zMv:()=>Gd,z$1:()=>qd,L8l:()=>Qd,Ie1:()=>Jd,rr4:()=>Yd,ehc:()=>Kd,ebH:()=>Zd,wi7:()=>Xd}),function(e){e.Add="Add",e.Remove="Remove",e.Update="Update"}(i||(i={})),function(e){e.Next="Next",e.Prev="Prev",e.GoTo="GoTo"}(a||(a={})),function(e){e.AlwaysEnabled="AlwaysEnabled",e.AlwaysDisabled="AlwaysDisabled",e.UserOverride="UserOverride"}(o||(o={})),function(e){e.Disabled="Disabled",e.AutoAcceptInTenant="AutoAcceptInTenant",e.AutoAcceptAll="AutoAcceptAll"}(r||(r={})),function(e){e.Ready="Ready",e.NotReady="NotReady",e.NotCapable="NotCapable"}(s||(s={})),function(e){e.EyeContact="EyeContact",e.AutoFraming="AutoFraming"}(l||(l={})),function(e){e.On="On",e.Off="Off",e.Default="Default"}(d||(d={})),function(e){e.Accessibility="Accessibility",e.Audience="Audience",e.ContentOnly="ContentOnly",e.FrontRow="FrontRow",e.Grid="Grid",e.ImmersiveView="ImmersiveView",e.LargeGrid="LargeGrid",e.MixedGridView="MixedGridView",e.SpeakerView="SpeakerView"}(c||(c={})),function(e){e.AudioStage="AudioStage",e.BotStage="BotStage",e.VideoStage="VideoStage"}(u||(u={})),function(e){e.NV12="NV12"}(m||(m={})),function(e){e.Pause="Pause",e.Resume="Resume"}(g||(g={})),function(e){e.PerformanceFrozenEvent="PerformanceFrozenEvent",e.PerformanceSlowEvent="PerformanceSlowEvent"}(p||(p={})),function(e){e.acknowledgeFirstFrame="acknowledgeFirstFrame",e.actionOnAlert="actionOnAlert",e.activeCallsChangedEvent="activeCallsChangedEvent",e.addAudienceBotDataChannel="addAudienceBotDataChannel",e.addParticipant1="addParticipant1",e.addScreenRecordingDisabledAlert="addScreenRecordingDisabledAlert",e.admitAllParticipants1="admitAllParticipants1",e.admitParticipant1="admitParticipant1",e.applyVideoBackgroundEffects="applyVideoBackgroundEffects",e.askPermissionTicketStateChanged="askPermissionTicketStateChanged",e.blurringCapabilityChangedEvent="blurringCapabilityChangedEvent",e.busyOnBusySetting="busyOnBusySetting",e.call="call",e.callAppContentSharingAddedEvent="callAppContentSharingAddedEvent",e.callAppContentSharingRemovedEvent="callAppContentSharingRemovedEvent",e.callAppContentSharingStartedEvent="callAppContentSharingStartedEvent",e.callAppContentSharingStartFailedEvent="callAppContentSharingStartFailedEvent",e.callAppContentSharingStatusChangedEvent="callAppContentSharingStatusChangedEvent",e.callAppUrlChangedEvent="callAppUrlChangedEvent",e.explicitRecordingConsentStateChangedEvent="explicitRecordingConsentStateChangedEvent",e.callFeedbackRendered="callFeedbackRendered",e.callHealthCategories="callHealthCategories",e.callRedirectionSettings="callRedirectionSettings",e.updateCallRedirectionSettings="updateCallRedirectionSettings",e.callingAlerts="callingAlerts",e.callingClientStateEvent="callingClientStateEvent",e.callingIntent="callingIntent",e.callingIntentEvent="callingIntentEvent",e.callingScenarioApiCallWithLoggingContext="callingScenarioApiCallWithLoggingContext",e.callingScreenStatusChanged="callingScreenStatusChanged",e.callingServiceEvent="callingServiceEvent",e.callingWindowingContentChangedEvent="callingWindowingContentChangedEvent",e.callingServiceDispose="callingServiceDispose",e.callMeetingInfo="callMeetingInfo",e.callMicNrgLevelsChangedEvent="callMicNrgLevelsChangedEvent",e.callParticipants="callParticipants",e.callParticipantsChangedEvent="callParticipantsChangedEvent",e.callParticipantsOnlyChangedEvent="callParticipantsOnlyChangedEvent",e.callParticipantsVoiceLevelsChangedEvent="callParticipantsVoiceLevelsChangedEvent",e.callParticipantAudioRestrictionsChangedEvent="callParticipantAudioRestrictionsChangedEvent",e.callParticipantVideoRestrictionsChangedEvent="callParticipantVideoRestrictionsChangedEvent",e.callPptSharingEvent="callPptSharingEvent",e.callQuestionnaire="callQuestionnaire",e.callRecordingStateChangedEvent="callRecordingStateChangedEvent",e.callLocalRecordingStateChangedEvent="callLocalRecordingStateChangedEvent",e.callScreenPreviewsV2="callScreenPreviewsV2",e.screenRecordingEnabled="screenRecordingEnabled",e.callSpeakerHWMutedChangedEvent="callSpeakerHWMutedChangedEvent",e.callSpeakerMutedChangedEvent="callSpeakerMutedChangedEvent",e.callSpeakerVolumeChangedEvent="callSpeakerVolumeChangedEvent",e.callStartTimestamp="callStartTimestamp",e.callTitleChangedEvent="callTitleChangedEvent",e.callTranscriptEditEvent="callTranscriptEditEvent",e.callTranscriptEntryEvent="callTranscriptEntryEvent",e.callTranscriptStateEvent="callTranscriptStateEvent",e.callVoiceCollectionChangedEvent="callVoiceCollectionChangedEvent",e.callWhiteboardSharingSources="callWhiteboardSharingSources",e.cancelCallFeedback="cancelCallFeedback",e.cancelRetry="cancelRetry",e.changeRingtoneSettings="changeRingtoneSettings",e.closedCaptionsDynamicEntryEvent="closedCaptionsDynamicEntryEvent",e.closedCaptionsEntryEvent="closedCaptionsEntryEvent",e.closedCaptionsStatusEvent="closedCaptionsStatusEvent",e.coachStatusEvent="coachStatusEvent",e.companionStreamAddedEvent="companionStreamAddedEvent",e.companionStreamRemovedEvent="companionStreamRemovedEvent",e.connectedCallsChangedEvent="connectedCallsChangedEvent",e.createCompositorV2="createCompositorV2",e.createOrGetInstantMeetingInfo="createOrGetInstantMeetingInfo",e.createRoomRemoteSession="createRoomRemoteSession",e.currentAudienceScene="currentAudienceScene",e.currentSeatingAssignment="currentSeatingAssignment",e.currentSeatMapping="currentSeatMapping",e.disableCallForwarding="disableCallForwarding",e.defaultVideoBackgroundImages="defaultVideoBackgroundImages",e.tenantVideoBackgroundImages="tenantVideoBackgroundImages",e.demotePresenterToAttendee="demotePresenterToAttendee",e.denyParticipant="denyParticipant",e.deviceList="deviceList",e.dismissAlert="dismissAlert",e.dismissParkedCallById="dismissParkedCallById",e.delegateSettingsChangedEvent="delegateSettingsChangedEvent",e.disposeCompositor="disposeCompositor",e.dominantSpeakerInfoEvent="dominantSpeakerInfoEvent",e.downloadVideoBackgroundImage="downloadVideoBackgroundImage",e.e2eeStatusChangedEvent="e2eeStatusChangedEvent",e.endCallingIntent="endCallingIntent",e.fireCallingIntent="fireCallingIntent",e.frameSizeChangedEvent="frameSizeChangedEvent",e.framesinkEventsChangedEvent="framesinkEventsChangedEvent",e.getDeviceBlurringCapability="getDeviceBlurringCapability",e.hasOngoingCallsChangedEvent="hasOngoingCallsChangedEvent",e.highFidelityAudioSwitchChangedEvent="highFidelityAudioSwitchChangedEvent",e.musicModeSettingsChangedEvent="musicModeSettingsChangedEvent",e.musicModeSettings="musicModeSettings",e.isAnonUserFromCloud="isAnonUserFromCloud",e.isE2EECallEnabled="isE2EECallEnabled",e.isE2EESettingEnabledByTenantAdmin="isE2EESettingEnabledByTenantAdmin",e.isE2EEQualifiedBySlimcoreVersion="isE2EEQualifiedBySlimcoreVersion",e.isTTYSettingEnabled="isTTYSettingEnabled",e.joinCallFromIntent="joinCallFromIntent",e.lowerAllRaisedHands="lowerAllRaisedHands",e.lowerOtherParticipantsHand="lowerOtherParticipantsHand",e.makeTranscriptEdit="makeTranscriptEdit",e.meetingInfoFromCall="meetingInfoFromCall",e.meetingRoomInfo="meetingRoomInfo",e.muteAllParticipants1="muteAllParticipants1",e.muteParticipant1="muteParticipant1",e.toggleParticipantRoomView="toggleParticipantRoomView",e.cloudPeopleFeedRoomViewState="cloudPeopleFeedRoomViewState",e.newCallingScenario="newCallingScenario",e.noiseSuppressionChangedEvent="noiseSuppressionChangedEvent",e.noiseSuppressionSetting="noiseSuppressionSetting",e.autoGainControlSetting="autoGainControlSetting",e.autoGainControlChangedEvent="autoGainControlChangedEvent",e.notifyCallingViewportCreation="notifyCallingViewportCreation",e.notifyCallingWindowingContainerUpdate="notifyCallingWindowingContainerUpdate",e.onAppPreInit="onAppPreInit",e.onAppPreWarm="onAppPreWarm",e.openSettingsPane="openSettingsPane",e.sendDtmf="sendDtmf",e.parkCall="parkCall",e.unparkCall="unparkCall",e.unparkCallById="unparkCallById",e.promoteAttendeeToPresenter="promoteAttendeeToPresenter",e.passGetUserMediaWithoutMedia="passGetUserMediaWithoutMedia",e.cleanupGetUserMediaModal="cleanupGetUserMediaModal",e.raiseHandStateChangedEvent="raiseHandStateChangedEvent",e.rejoinCall="rejoinCall",e.removeParticipant1="removeParticipant1",e.saveEmergencyAddress="saveEmergencyAddress",e.saveEmergencyLocation="saveEmergencyLocation",e.registerControlEvents="registerControlEvents",e.removeCustomEmergencyAddress="removeCustomEmergencyAddress",e.ringtoneSettings="ringtoneSettings",e.setUserAgreementEmergencyCustomDisclaimer="setUserAgreementEmergencyCustomDisclaimer",e.screenSharingAcceptControlRequest="screenSharingAcceptControlRequest",e.screenSharingDenyControlRequest="screenSharingDenyControlRequest",e.screenSharingTerminateControlRequest="screenSharingTerminateControlRequest",e.screenSharingReleaseControl="screenSharingReleaseControl",e.screenSharingRequestControl="screenSharingRequestControl",e.searchUsersByIdsOrQuery="searchUsersByIdsOrQuery",e.selectAudienceSceneAndAssignSeats="selectAudienceSceneAndAssignSeats",e.selectAudioDevice="selectAudioDevice",e.selectDevice="selectDevice",e.sendCommandToMeetingRoom="sendCommandToMeetingRoom",e.sendThirdPartyDevicePairingResponse="sendThirdPartyDevicePairingResponse",e.setBusyOnBusySetting="setBusyOnBusySetting",e.setClosedCaptionsLanguage="setClosedCaptionsLanguage",e.setClosedCaptionsTextTrack="setClosedCaptionsTextTrack",e.requestClosedCaptionSubtitle="requestClosedCaptionSubtitle",e.setInterpretationGroup="setInterpretationGroup",e.setMaxVideoChannels="setMaxVideoChannels",e.setSpeakerVolume="setSpeakerVolume",e.pstnUserProfile="pstnUserProfile",e.setTextureSharingSupported="setTextureSharingSupported",e.setVideoPreference="setVideoPreference",e.setVideosSizeAndPreference="setVideosSizeAndPreference",e.spatialAudioConfigs="spatialAudioConfigs",e.spatialAudioConfigsChangedEvent="spatialAudioConfigsChangedEvent",e.speakerHWMuted="speakerHWMuted",e.speakerMuted="speakerMuted",e.spotlightParticipant="spotlightParticipant",e.isApplianceMode="isApplianceMode",e.startCall="startCall",e.startCallAppContentSharing="startCallAppContentSharing",e.startBotView="startBotView",e.callingRosterAddARoom="callingRosterAddARoom",e.screenShareControlEvent="screenShareControlEvent",e.sendCallingDataToTelemetry="sendCallingDataToTelemetry",e.startClosedCaptions="startClosedCaptions",e.startCoach="startCoach",e.startOrContinueInstantMeeting="startOrContinueInstantMeeting",e.startPreview="startPreview",e.startPstnCall="startPstnCall",e.startRecording="startRecording",e.startRecordingAndTranscript="startRecordingAndTranscript",e.startLocalRecording="startLocalRecording",e.stopLocalRecording="stopLocalRecording",e.startSharing="startSharing",e.startStream="startStream",e.startStream1="startStream1",e.startTranscript="startTranscript",e.stopCall="stopCall",e.stopCallAppContentSharing="stopCallAppContentSharing",e.stopClosedCaptions="stopClosedCaptions",e.stopCoach="stopCoach",e.stopPreview="stopPreview",e.stopRecording="stopRecording",e.stopRecordingAndTranscript="stopRecordingAndTranscript",e.stopSharing="stopSharing",e.stopSpotlight="stopSpotlight",e.stopSpotlightOnParticipant="stopSpotlightOnParticipant",e.updateParticipantInterpretationState="updateParticipantInterpretationState",e.updateSelfExplicitRecordingConsentState="updateSelfExplicitRecordingConsentState",e.stopStream="stopStream",e.stopStream1="stopStream1",e.stopTranscript="stopTranscript",e.stopVideoForAllCalls="stopVideoForAllCalls",e.submitCallFeedback="submitCallFeedback",e.subscribedCallChangedEvent="subscribedCallChangedEvent",e.systemAudioState="systemAudioState",e.castingSystemAudioState="castingSystemAudioState",e.systemAudioStateChanged="systemAudioStateChanged",e.teamsCallId="teamsCallId",e.thirdPartyDevicesEvent="thirdPartyDevicesEvent",e.threadMembers="threadMembers",e.toggleE2EECall="toggleE2EECall",e.toggleHighFidelityAudio="toggleHighFidelityAudio",e.toggleMusicModeSettings="toggleMusicModeSettings",e.toggleHoldCall="toggleHoldCall",e.toggleIncomingVideo="toggleIncomingVideo",e.toggleMute="toggleMute",e.toggleMuteWithState="toggleMuteWithState",e.toggleMuteSpeaker="toggleMuteSpeaker",e.toggleRaiseHands="toggleRaiseHands",e.toggleTogetherModePinning="toggleTogetherModePinning",e.toggleTTYSetting="toggleTTYSetting",e.toggleVideo="toggleVideo",e.toggleVideoWithState="toggleVideoWithState",e.toggleAutoGainControl="toggleAutoGainControl",e.saveGeneratedBackgroundImage="saveGeneratedBackgroundImage",e.captureVideoFrame="captureVideoFrame",e.transferCall="transferCall",e.parkedCallDetails="parkedCallDetails",e.OngoingConsultation="OngoingConsultation",e.OngoingConsultationEvent="OngoingConsultationEvent",e.transportCompanionDeviceInfo="transportCompanionDeviceInfo",e.tryToggleIncludeSystemAudio="tryToggleIncludeSystemAudio",e.startSystemAudioSharing="startSystemAudioSharing",e.stopSystemAudioSharing="stopSystemAudioSharing",e.turnOffCallGroupNotification="turnOffCallGroupNotification",e.updateAttendeeRestrictions="updateAttendeeRestrictions",e.unregisterControlEvents="unregisterControlEvents",e.updateCallingScenarioEventData="updateCallingScenarioEventData",e.updateCallRefreshSettings="updateCallRefreshSettings",e.updateCompositorLayout="updateCompositorLayout",e.updateMeetNowTitle="updateMeetNowTitle",e.updateNoiseSuppression="updateNoiseSuppression",e.updateUserDelegates="updateUserDelegates",e.userCallingSettings="userCallingSettings",e.explicitRecordingConsentState="explicitRecordingConsentState",e.videoAvailableForConversation="videoAvailableForConversation",e.videoSizeChanged="videoSizeChanged",e.callByThreadId="callByThreadId",e.handlePresentDeepLink="handlePresentDeepLink",e.startFileSharing1="startFileSharing1",e.startWhiteboardSharing="startWhiteboardSharing",e.stopWhiteboardSharing="stopWhiteboardSharing",e.changeCallForwardingTargetTo="changeCallForwardingTargetTo",e.changeImmersiveViewStatus="changeImmersiveViewStatus",e.callPptSharingAddedEvent="callPptSharingAddedEvent",e.callPptSharingChangeSlideCortanaInvocationEvent="callPptSharingChangeSlideCortanaInvocationEvent",e.callPptSharingContentSharingStatusChangedEvent="callPptSharingContentSharingStatusChangedEvent",e.callPptSharingJoinFailedEvent="callPptSharingJoinFailedEvent",e.callPptSharingMediaEventUpdatedEvent="callPptSharingMediaEventUpdatedEvent",e.callPptSharingPresentationUrlReadyEvent="callPptSharingPresentationUrlReadyEvent",e.callPptSharingPrivateViewingChangedEvent="callPptSharingPrivateViewingChangedEvent",e.callPptSharingRemovedEvent="callPptSharingRemovedEvent",e.callPptSharingStartedEvent="callPptSharingStartedEvent",e.callPptSharingStartFailedEvent="callPptSharingStartFailedEvent",e.callPptSharingSlideChangedEvent="callPptSharingSlideChangedEvent",e.callPptSharingTelemetryUpdatedEvent="callPptSharingTelemetryUpdatedEvent",e.callPptSharingChangeSlide="callPptSharingChangeSlide",e.callPptSharingMediaEventUpdate="callPptSharingMediaEventUpdate",e.callPptSharingStopContentSharing="callPptSharingStopContentSharing",e.callPptSharingTakeControl="callPptSharingTakeControl",e.callPptSharingTogglePrivateViewing="callPptSharingTogglePrivateViewing",e.callPptSharingUpdateCameoState="callPptSharingUpdateCameoState",e.callPptSharingUpdateLayout="callPptSharingUpdateLayout",e.callPptSharingUpdatePresentationUrl="callPptSharingUpdatePresentationUrl",e.callPptSharingUpdateSlidesCount="callPptSharingUpdateSlidesCount",e.callMeBackWithResult="callMeBackWithResult",e.changeWhiteboardUrl="changeWhiteboardUrl",e.changeFileUserPermissions="changeFileUserPermissions",e.postFluidWhiteboard="postFluidWhiteboard",e.whiteboardSharingAddedEvent="whiteboardSharingAddedEvent",e.whiteboardSharingStartedEvent="whiteboardSharingStartedEvent",e.whiteboardSharingStartFailedEvent="whiteboardSharingStartFailedEvent",e.whiteboardSharingStatusChangedEvent="whiteboardSharingStatusChangedEvent",e.whiteboardUrlChangedEvent="whiteboardUrlChangedEvent",e.fileUserPermissionsChangedEvent="fileUserPermissionsChangedEvent",e.updateStreams="updateStreams",e.isHighFidelityAudioModeOn="isHighFidelityAudioModeOn",e.toggleVideoStreamFocus="toggleVideoStreamFocus",e.isVideoEffectCapableOnDevice="isVideoEffectCapableOnDevice",e.isCameraSharingEnabled="isCameraSharingEnabled",e.videoEffectStateV2="videoEffectStateV2",e.videoTouchUpStrength="videoTouchUpStrength",e.toggleVideoEffectV2="toggleVideoEffectV2",e.setTouchUpVideoEffect="setTouchUpVideoEffect",e.videoEffectConfigChangedEvent="videoEffectConfigChangedEvent",e.windowsEffectsCapability="windowsEffectsCapability",e.isWindowsEffectsQuickSettingsSupported="isWindowsEffectsQuickSettingsSupported",e.windowsEffectsState="windowsEffectsState",e.setWindowsEffectsState="setWindowsEffectsState",e.callParticipantsCounts="callParticipantsCounts",e.callTransferEvents="callTransferEvents",e.roomRemoteStateUpdateEvent="roomRemoteStateUpdateEvent",e.roomRemoteCapabilitiesUpdateEvent="roomRemoteCapabilitiesUpdateEvent",e.roomRemoteProximityBannerEvent="roomRemoteProximityBannerEvent",e.endRoomRemoteSession="endRoomRemoteSession",e.videoEffectReadinessOnDevice="videoEffectReadinessOnDevice",e.videoEffectReadinessChangedEvent="videoEffectReadinessChangedEvent",e.windowsEffectsCapabilityChangedEvent="windowsEffectsCapabilityChangedEvent",e.videoEffectCapabilitiesChangedEvent="videoEffectCapabilitiesChangedEvent",e.videoAvailableForConversationChangedEvent="videoAvailableForConversationChangedEvent",e.videoCapabilityLimitsChangedEvent="videoCapabilityLimitsChangedEvent",e.videoLayoutCapabilitiesChangedEvent="videoLayoutCapabilitiesChangedEvent",e.totalMeetingParticipantCount="totalMeetingParticipantCount",e.setAvatarModeState="setAvatarModeState",e.setIsAvatarAppAvailable="setIsAvatarAppAvailable",e.updateCustomLayoutSelection="updateCustomLayoutSelection",e.setSpatialAudio="setSpatialAudio",e.updateSpatialAudioStageConfig="updateSpatialAudioStageConfig",e.updateSpatialAudioSubStageConfig="updateSpatialAudioSubStageConfig",e.updateSpatialAudioParticipantsPosition="updateSpatialAudioParticipantsPosition",e.getEmergencyAddress="getEmergencyAddress",e.getLocationResponseAddress="getLocationResponseAddress",e.emergencyAddressUpdatedEvent="emergencyAddressUpdatedEvent",e.emergencyCustomDisclaimerUpdatedEvent="emergencyCustomDisclaimerUpdatedEvent",e.emergencyCustomDisclaimer="emergencyCustomDisclaimer",e.holographicCallState="holographicCallState",e.holographicAnnotationEvent="holographicAnnotationEvent",e.holographicCallStateChangedEvent="holographicCallStateChangedEvent",e.startHolographicInteraction="startHolographicInteraction",e.startHolographicFreezeFrameInteraction="startHolographicFreezeFrameInteraction",e.stopHolographicInteraction2="stopHolographicInteraction2",e.stopHolographicFreezeFrameInteraction="stopHolographicFreezeFrameInteraction",e.updateHolographicViewingParticipant="updateHolographicViewingParticipant",e.updateImmersiveViewParticipantWithMeshTag="updateImmersiveViewParticipantWithMeshTag",e.placeHolographicAnnotation="placeHolographicAnnotation",e.continueHolographicInking="continueHolographicInking",e.stopHolographicInking="stopHolographicInking",e.deleteHolographicAnnotations="deleteHolographicAnnotations",e.recoverHolographicAnnotations="recoverHolographicAnnotations",e.clearAllHolographicAnnotations="clearAllHolographicAnnotations",e.setHolographicToolbarVisibility="setHolographicToolbarVisibility",e.setHolographicToolbarAvailability="setHolographicToolbarAvailability",e.isBlockOutgoingCallerIDEnabled="isBlockOutgoingCallerIDEnabled",e.isOutgoingCallerIDBlocked="isOutgoingCallerIDBlocked",e.updateBlockOutgoingCallerID="updateBlockOutgoingCallerID",e.voicemailPolicySettings="voicemailPolicySettings",e.voicemailSettings="voicemailSettings",e.updateVoicemailSettings="updateVoicemailSettings",e.currentSeatMappingChangedEvent="currentSeatMappingChangedEvent",e.userDelegation="userDelegation",e.userDelegates="userDelegates",e.isWatermarkSupported="isWatermarkSupported",e.isAudioOnlySupported="isAudioOnlySupported",e.ignoreMirroringVideoPreferenceSetting="ignoreMirroringVideoPreferenceSetting",e.setIgnoreMirroring="setIgnoreMirroring",e.updateIgnoreMirroringVideoPreferenceSetting="updateIgnoreMirroringVideoPreferenceSetting",e.ignoreMirroringVideoPreferenceSettingChangedEvent="ignoreMirroringVideoPreferenceSettingChangedEvent",e.stopMdpDataCollection="stopMdpDataCollection",e.streamingInfoChangedEvent="streamingInfoChangedEvent",e.playAudioFile="playAudioFile",e.pauseAudioFile="pauseAudioFile",e.audioEndedEvent="audioEndedEvent",e.callingAggregateSettings="callingAggregateSettings",e.callingAggregateSettingsEvent="callingAggregateSettingsEvent",e.parkedCalls="parkedCalls",e.parkedCallsChangedEvent="parkedCallsChangedEvent",e.slaCalls="slaCalls",e.slaCallsChangedEvent="slaCallsChangedEvent",e.joinCallByInvitationContent="joinCallByInvitationContent",e.userVideoBackgroundImages="userVideoBackgroundImages",e.uploadVideoBackgroundImage="uploadVideoBackgroundImage",e.deleteVideoBackgroundImage="deleteVideoBackgroundImage",e.renameParticipant="renameParticipant",e.browserPopoutUserPreference="browserPopoutUserPreference",e.setBrowserPopoutUserPreference="setBrowserPopoutUserPreference",e.createBreakoutRoomsWithDetails="createBreakoutRoomsWithDetails",e.updateSecondaryRingerDevice="updateSecondaryRingerDevice",e.getSecondaryRingerDevice="getSecondaryRingerDevice",e.enableVideoExtensibility="enableVideoExtensibility",e.disableVideoExtensibility="disableVideoExtensibility",e.closeVideoExtensibility="closeVideoExtensibility",e.videoExtensibilityLifecycleEvent="videoExtensibilityLifecycleEvent",e.videoExtensibilityPerformanceEvent="videoExtensibilityPerformanceEvent",e.roomCoordinates="roomCoordinates",e.listBreakoutRoomsWithDetails="listBreakoutRoomsWithDetails",e.breakoutRoomSettings="breakoutRoomSettings",e.breakoutRoomsDetails="breakoutRoomsDetails",e.setBreakoutRoomsInMeetingEnabled="setBreakoutRoomsInMeetingEnabled",e.takeControlToManageBreakoutRooms="takeControlToManageBreakoutRooms",e.updateBreakoutRoomSettings="updateBreakoutRoomSettings",e.updateBreakoutRoomInfo="updateBreakoutRoomInfo",e.updateBreakoutRooms="updateBreakoutRooms",e.deleteAllBreakoutRooms="deleteAllBreakoutRooms",e.addBreakoutRoom="addBreakoutRoom",e.deleteBreakoutRoom="deleteBreakoutRoom",e.breakoutRoomBulkMoveAction="breakoutRoomBulkMoveAction",e.openBreakoutRooms="openBreakoutRooms",e.closeBreakoutRooms="closeBreakoutRooms",e.sendBreakoutRoomAnnouncementAlert="sendBreakoutRoomAnnouncementAlert",e.activateBreakoutRoomAlert="activateBreakoutRoomAlert",e.goToMainMeetingFromBreakoutRoom="goToMainMeetingFromBreakoutRoom",e.goToBreakoutRoomFromMainMeeting="goToBreakoutRoomFromMainMeeting",e.moveToNewMeeting="moveToNewMeeting",e.setMutedLobbyDialogForCall="setMutedLobbyDialogForCall",e.askToJoinBreakoutRoom="askToJoinBreakoutRoom"}(v||(v={})),function(e){e.SignOut="SignOut"}(h||(h={})),function(e){e.StandupCallingAppJob="StandupCallingAppJob"}(f||(f={})),function(e){e.Added="Added",e.Removed="Removed",e.AnnotationSharerWindow="AnnotationSharerWindow"}(y||(y={})),function(e){e.Disabled="Disabled",e.Failed="Failed",e.None="None",e.Paused="Paused",e.Pending="Pending",e.Recording="Recording",e.Stopping="Stopping",e.Waiting="Waiting",e.WaitingForMeetingLive="WaitingForMeetingLive"}(k||(k={})),function(e){e.None="None",e.Recording="Recording",e.Stopped="Stopped",e.Error="Error"}(S||(S={})),function(e){e.None="None",e.Started="Started",e.Failed="Failed"}(b||(b={})),function(e){e.None="None",e.Disabled="Disabled",e.Pending="Pending",e.Waiting="Waiting",e.Started="Started",e.Stopped="Stopped",e.Failed="Failed",e.WaitingForMeetingLive="WaitingForMeetingLive"}(C||(C={})),function(e){e.Accessibility="Accessibility",e.Audience="Audience",e.Content="Content",e.FrontRow="FrontRow",e.Grid="Grid",e.LargeGrid="LargeGrid",e.PeopleAndContent="PeopleAndContent"}(w||(w={})),function(e){e.Accessibility="Accessibility",e.Audience="Audience",e.FrontRow="FrontRow",e.Grid="Grid",e.LargeGrid="LargeGrid"}(N||(N={})),function(e){e.Ready="Ready",e.Listening="Listening",e.Thinking="Thinking",e.Speaking="Speaking"}(T||(T={})),function(e){e.Hold="Hold",e.Resume="Resume",e.Transfer="Transfer",e.ConsultativeTransfer="ConsultativeTransfer"}(I||(I={})),function(e){e.Request="Request",e.Release="Release"}(E||(E={})),function(e){e.Grid="Grid",e.FrontRow="FrontRow"}(A||(A={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(_||(_={})),function(e){e.Auto="Auto",e.Chat="Chat",e.Hide="Hide",e.RaisedHand="RaisedHand"}(D||(D={})),function(e){e.Rendering="Rendering",e.FirstFrameRendered="FirstFrameRendered",e.Stopped="Stopped"}(F||(F={})),function(e){e.CallingAppEventsServiceSubscribe="CallingAppEventsServiceSubscribe",e.CreateNotificationWithActions="CreateNotificationWithActions",e.DialogOpen="DialogOpen",e.HideBannerNotification="HideBannerNotification",e.MultiWindowNavigation="MultiWindowNavigation",e.NavigateToConversationPromiseChat="NavigateToConversationPromiseChat",e.NavigateToConversationPromiseChatList="NavigateToConversationPromiseChatList",e.NavigateToDefaultState="NavigateToDefaultState",e.NavigateToDefaultWithFallbacks="NavigateToDefaultWithFallbacks",e.NavigateToLastChatState="NavigateToLastChatState",e.NavigateToLastTeamState="NavigateToLastTeamState",e.NavigateToMainWindow="NavigateToMainWindow",e.ShowBannerNotification="ShowBannerNotification",e.SingleWindowNavigation="SingleWindowNavigation"}(M||(M={})),function(e){e.CallGroup="CallGroup",e.Calls="Calls",e.Devices="Devices",e.PremiumBenefits="PremiumBenefits",e.Privacy="Privacy"}(R||(R={})),function(e){e.PreJoinConnecting="PreJoinConnecting",e.PreJoin="PreJoin",e.PreJoinV2="PreJoinV2",e.CallingLobby="CallingLobby",e.Calling="Calling",e.InCall="InCall",e.CallEnd="CallEnd"}(P||(P={})),function(e){e.Show="Show",e.Hide="Hide"}(O||(O={})),function(e){e.Calling="Calling",e.RigelGallery="RigelGallery",e.RigelContent="RigelContent",e.RigelGalleryAndContent="RigelGalleryAndContent"}(x||(x={})),function(e){e.SingleWindow="SingleWindow",e.MultiWindow="MultiWindow"}(L||(L={})),function(e){e.Chat="Chat"}(U||(U={})),function(e){e.PrimaryAction="PrimaryAction",e.DismissAction="DismissAction"}(B||(B={})),function(e){e.EndpointTransfer="EndpointTransfer"}(j||(j={})),function(e){e.BannerNotification="BannerNotification"}(W||(W={})),function(e){e.DialogTitle="DialogTitle",e.DialogText="DialogText",e.PrimaryButton="PrimaryButton",e.ConfirmMessageTitle="ConfirmMessageTitle",e.ConfirmMessageHtmlBody="ConfirmMessageHtmlBody",e.OkButtonText="OkButtonText"}(V||(V={})),function(e){e.WaitingForBrowser="WaitingForBrowser",e.WaitingForUser="WaitingForUser",e.Approved="Approved",e.Denied="Denied",e.Expired="Expired",e.Deficient="Deficient",e.NotSupported="NotSupported"}(H||(H={})),function(e){e.PostConfirm="PostConfirm",e.PreClose="PreClose",e.PostClose="PostClose",e.PreActiveElementIds="PreActiveElementIds",e.CloseByDocument="CloseByDocument"}($||($={})),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.OptionsSettings="OptionsSettings",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="UserMedia",e.CallingRestartRecomendedError="CallingRestartRecomendedError",e.WindowingError="WindowingError"}(z||(z={})),function(e){e.MeetingStart="MeetingStart",e.MeetingStartFromLobby="MeetingStartFromLobby"}(G||(G={})),function(e){e.OneToOne="OneToOne",e.GroupCall="GroupCall",e.Meeting="Meeting",e.Chat="Chat",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.Like="Like",e.Mention="Mention",e.Download="Download",e.AppUpdated="AppUpdated",e.NeedMoreDiskSpace="NeedMoreDiskSpace",e.TeamMembershipChange="TeamMembershipChange",e.Follow="Follow",e.OneToOnePstn="OneToOnePstn",e.Thirdparty="Thirdparty",e.MessageSendFailed="MessageSendFailed",e.CallTransferFailed="CallTransferFailed",e.ShareFromChat="ShareFromChat",e.Inferred="Inferred",e.Trending="Trending",e.MeetingWentLive="MeetingWentLive",e.PresenceStatus="PresenceStatus",e.Reaction="Reaction",e.Priority="Priority",e.TeamsTasks="TeamsTasks",e.Dlp="Dlp",e.TeamsEngagementActivity="TeamsEngagementActivity",e.MsGraph="MsGraph",e.StaffHub="StaffHub",e.CallAnsweredElsewhere="CallAnsweredElsewhere",e.CallSafeTransferRingback="CallSafeTransferRingback",e.SkypeConsumerCall="SkypeConsumerCall",e.SpamCall="SpamCall",e.Default="Default"}(q||(q={})),function(e){e.BannerContentToCommandingConversionError="BannerContentToCommandingConversionError",e.CallingAppEventJobHandlerError="CallingAppEventJobHandlerError",e.CallingAppEventResolverError="CallingAppEventResolverError",e.DismissBannerError="DismissBannerError",e.DismissBannerSuccess="DismissBannerSuccess",e.ShowBannerError="ShowBannerError",e.ShowBannerSuccess="ShowBannerSuccess",e.WindowingCommandingProcessingError="WindowingCommandingProcessingError",e.WindowingCommandingSuccess="WindowingCommandingSuccess",e.WindowingCommandingTriggerError="WindowingCommandingTriggerError"}(Q||(Q={})),function(e){e.showVideoGallery="showVideoGallery",e.showContent="showContent",e.showVideoGalleryAndContent="showVideoGalleryAndContent",e.showLargeGallery="showLargeGallery",e.showTogether="showTogether",e.showFrontRow="showFrontRow"}(J||(J={})),function(e){e.leaveMeeting="leaveMeeting"}(Y||(Y={})),function(e){e.toggleMute="toggleMute",e.toggleCamera="toggleCamera",e.volume="volume",e.toggleCaptions="toggleCaptions"}(K||(K={})),function(e){e.allow="allow",e.block="block",e.timeout="timeout",e.dismissed="dismissed",e.busy="busy",e.error="error"}(Z||(Z={})),function(e){e.DataChannel="DataChannel",e.AnnotationReady="AnnotationReady",e.ClientInForeground="ClientInForeground",e.AnnotationLimit="AnnotationLimit",e.Tracking="Tracking"}(X||(X={})),function(e){e.Failed="Failed",e.NotReady="NotReady",e.Ready="Ready"}(ee||(ee={})),function(e){e.Ring="Ring",e.Mute="Mute",e.Banner="Banner"}(te||(te={})),function(e){e.Abandon="Abandon",e.Fail="Fail",e.StartMarker="StartMarker",e.Stop="Stop",e.StopMarker="StopMarker"}(ne||(ne={})),function(e){e.Ring="Ring",e.Mute="Mute"}(ie||(ie={})),function(e){e.None="None",e.CollabDetails="CollabDetails"}(ae||(ae={})),function(e){e.All="All",e.Presenters="Presenters",e.Attendees="Attendees",e.Interpreters="Interpreters"}(oe||(oe={})),function(e){e.Devices="Devices"}(re||(re={})),function(e){e.GreenScreen="GreenScreen"}(se||(se={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing"}(le||(le={})),function(e){e.Pause="Pause",e.Resume="Resume",e.Goto="Goto",e.Cards="Cards"}(de||(de={})),function(e){e.Success="Success",e.DetectFailed="DetectFailed",e.Timeout="Timeout",e.TextTooShort="TextTooShort",e.Unsupported="Unsupported",e.UnknownError="UnknownError",e.LowConfidence="LowConfidence",e.NoContent="NoContent"}(ce||(ce={})),function(e){e.E164="E164",e.INTERNATIONAL="INTERNATIONAL",e.NATIONAL="NATIONAL",e.RFC3966="RFC3966"}(ue||(ue={})),function(e){e.Chat="Chat",e.TeamsCall="TeamsCall"}(me||(me={})),function(e){e.Custom="Custom",e.Favorites="Favorites",e.SfBFavorites="SfBFavorites",e.Tagged="Tagged",e.OtherContacts="OtherContacts",e.TflContacts="TflContacts",e.TflBlocked="TflBlocked"}(ge||(ge={})),function(e){e.AddDelegate="AddDelegate",e.EditDelegate="EditDelegate",e.RemoveDelegate="RemoveDelegate",e.AddDelegateOnBehalfOfDelegator="AddDelegateOnBehalfOfDelegator",e.EditDelegateOnBehalfOfDelegator="EditDelegateOnBehalfOfDelegator",e.RemoveDelegateOnBehalfOfDelegator="RemoveDelegateOnBehalfOfDelegator"}(pe||(pe={})),function(e){e.Exchange="Exchange",e.BuddyList="BuddyList",e.MiddleTier="MiddleTier",e.SerializedData="SerializedData"}(ve||(ve={})),function(e){e.Principal="Principal",e.Manager="Manager",e.Peer="Peer",e.InOrg="InOrg"}(he||(he={})),function(e){e.Error="Error",e.Started="Started",e.Captured="Captured",e.Processed="Processed",e.Stopped="Stopped",e.Updated="Updated"}(fe||(fe={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.NONE="NONE",e.SUCCESS="SUCCESS",e.FAIL="FAIL"}(ye||(ye={})),function(e){e.BackgroundEffect="BackgroundEffect",e.BackgroundAPL="BackgroundAPL"}(ke||(ke={})),function(e){e.Crop="Crop",e.Fit="Fit",e.Stretch="Stretch"}(Se||(Se={})),function(e){e.Unspecified="Unspecified",e.AttendeeView="AttendeeView",e.PptSharing="PptSharing",e.IncomingScreenShare="IncomingScreenShare",e.IncomingVideo="IncomingVideo",e.LocalPreview="LocalPreview",e.FrameSinkReader="FrameSinkReader"}(be||(be={})),function(e){e.Disabled="Disabled",e.Failed="Failed",e.None="None",e.Pending="Pending",e.Started="Started",e.Stopped="Stopped"}(Ce||(Ce={})),function(e){e.Team="Team",e.SharedLine="SharedLine",e.ServerHold="ServerHold"}(we||(we={})),function(e){e.HdmiIngest="HdmiIngest",e.WhiteboardCamera="WhiteboardCamera"}(Ne||(Ne={})),function(e){e.None="None",e.Home="Home",e.Mobile="Mobile",e.Work="Work"}(Te||(Te={})),function(e){e.Idle="Idle",e.AdHoc="AdHoc",e.Incoming="Incoming",e.InACall="InACall",e.CQF="CQF",e.Cortana="Cortana",e.Broadcast="Broadcast",e.ExperienceContainerError="ExperienceContainerError"}(Ie||(Ie={})),function(e){e.Unknown="Unknown",e.Metadata="Metadata",e.Location="Location",e.Body="Body"}(Ee||(Ee={})),function(e){e.Screen="Screen",e.App="App"}(Ae||(Ae={})),function(e){e.hold="hold",e.active="active"}(_e||(_e={})),function(e){e.NotInstalled="NotInstalled",e.InProgress="InProgress",e.Installed="Installed",e.Unavailable="Unavailable",e.UpdateAvailable="UpdateAvailable",e.MustUpdate="MustUpdate"}(De||(De={})),function(e){e.Ai="Ai",e.Cart="Cart",e.Cea708="Cea708",e.Mt="Mt"}(Fe||(Fe={})),function(e){e.NotSupported="NotSupported",e.FullySupported="FullySupported",e.LightweightOnly="LightweightOnly"}(Me||(Me={})),function(e){e.Created="Created",e.Ready="Ready",e.Started="Started",e.Stopping="Stopping",e.Stopped="Stopped"}(Re||(Re={})),function(e){e.media="media",e.geolocation="geolocation",e.notifications="notifications",e.midi="midi",e.openExternal="openExternal"}(Pe||(Pe={})),function(e){e.Participant="Participant",e.Interpreter="Interpreter",e.Presenter="Presenter"}(Oe||(Oe={})),function(e){e.Unknown="Unknown",e.Teams="Teams",e.Skype="Skype",e.Webex="Webex",e.Zoom="Zoom",e.BlueJeans="BlueJeans",e.GoTo="GoTo"}(xe||(xe={})),function(e){e.Native="Native",e.Chromium="Chromium",e.Webview="Webview"}(Le||(Le={})),function(e){e.Active="Active",e.Inactive="Inactive",e.Failed="Failed"}(Ue||(Ue={})),function(e){e.Outlook="Outlook",e.Skype="Skype",e.Google="Google",e.Device="Device",e.M365="M365"}(Be||(Be={})),function(e){e.None="None",e.ConnectedAccountsSyncError="ConnectedAccountsSyncError"}(je||(je={})),function(e){e.Full="Full",e.Delta="Delta"}(We||(We={})),function(e){e.SyncStarted="SyncStarted",e.SyncFailed="SyncFailed",e.SyncCompleted="SyncCompleted",e.UnsyncStarted="UnsyncStarted",e.UnsyncFailed="UnsyncFailed",e.UnsyncCompleted="UnsyncCompleted"}(Ve||(Ve={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.Unsupported="Unsupported"}(He||(He={})),function(e){e.BlueWave="BlueWave",e.CreativeConservatory="CreativeConservatory",e.Default="Default",e.DigitalForest="DigitalForest",e.Dreamcatcher="Dreamcatcher",e.IntoTheFold="IntoTheFold",e.Limeade="Limeade",e.NoTheme="NoTheme",e.PixelPerfect="PixelPerfect",e.PurpleParadise="PurpleParadise",e.Roadmap="Roadmap",e.SeasideBliss="SeasideBliss",e.SummerSummit="SummerSummit",e.Sunset="Sunset",e.VividFlagDefault="VividFlagDefault",e.Custom="Custom"}($e||($e={})),function(e){e.sideload="sideload",e.tenant="tenant",e.staging="staging"}(ze||(ze={})),function(e){e.MeetingNotesAddition="MeetingNotesAddition"}(Ge||(Ge={})),function(e){e.NotStarted="NotStarted",e.Active="Active",e.Resolved="Resolved",e.Rejected="Rejected",e.Timeout="Timeout",e.Abandoned="Abandoned"}(qe||(qe={})),function(e){e.Chat="Chat"}(Qe||(Qe={})),function(e){e.Save="Save"}(Je||(Je={})),function(e){e.NotStarted="NotStarted",e.Started="Started",e.Starting="Starting",e.Stopped="Stopped",e.Stopping="Stopping"}(Ye||(Ye={})),function(e){e.Producer="Producer",e.Contributor="Contributor",e.Attendee="Attendee",e.None="None"}(Ke||(Ke={})),function(e){e.InCall="InCall",e.ScreenSharing="ScreenSharing",e.None="None"}(Ze||(Ze={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.BrowsingPrivately="BrowsingPrivately",e.Presenting="Presenting"}(Xe||(Xe={})),function(e){e.Done="Done",e.InProcess="InProcess",e.NotStarted="NotStarted",e.ScoreTooLow="ScoreTooLow",e.TooManyCharacters="TooManyCharacters",e.UnknownError="UnknownError"}(et||(et={})),function(e){e.ChatDisabledDueToIB="ChatDisabledDueToIB",e.SmsChatDisabledDueToLicense="SmsChatDisabledDueToLicense",e.SmsChatDisabledDueToRNLError="SmsChatDisabledDueToRNLError",e.ChatDisabledDueToBotStatus="ChatDisabledDueToBotStatus",e.ChatDisabledDueToRecipientTeamsUpgradePolicy="ChatDisabledDueToRecipientTeamsUpgradePolicy",e.UnknownReason="UnknownReason"}(tt||(tt={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker"}(nt||(nt={})),function(e){e.AttendeeAudio="AttendeeAudio",e.AttendeeCaptions="AttendeeCaptions",e.AttendeeGeneral="AttendeeGeneral",e.Audio="Audio",e.Broadcast="Broadcast",e.CallClosedCaptions="CallClosedCaptions",e.EffectiveMeeting="EffectiveMeeting",e.Other="Other",e.ScreenSharing="ScreenSharing",e.ScreenshareFromChat="ScreenshareFromChat",e.Video="Video"}(it||(it={})),function(e){e.EffectiveMeeting="EffectiveMeeting",e.EffectiveMeetingV2="EffectiveMeetingV2",e.EffectiveMeetingViva="EffectiveMeetingViva",e.Quality="Quality",e.ShortDurationHangup="ShortDurationHangup"}(at||(at={})),function(e){e.GroupCall="GroupCall",e.Meeting="Meeting",e.P2P="P2P",e.PSTN="PSTN",e.ScreenshareFromChat="ScreenshareFromChat",e.SfB="SfB"}(ot||(ot={})),function(e){e.GroupChat="GroupChat",e.Personal="Personal",e.Team="Team"}(rt||(rt={})),function(e){e.SidePanel="SidePanel",e.Stage="Stage",e.Unknown="Unknown"}(st||(st={})),function(e){e.CallingSidePanel="CallingSidePanel",e.ChannelTab="ChannelTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.PersonalTab="PersonalTab",e.PrivateChatTab="PrivateChatTab",e.Unknown="Unknown"}(lt||(lt={})),function(e){e.ChannelTab="ChannelTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.PersonalTab="PersonalTab",e.PrivateChatTab="PrivateChatTab",e.TeamLevelApp="TeamLevelApp",e.Unknown="Unknown"}(dt||(dt={})),function(e){e.CALENDAR_LEFT_RAIL_SETTINGS_SYNCING="CALENDAR_LEFT_RAIL_SETTINGS_SYNCING",e.CALENDAR_LEFT_RAIL_SETTINGS_SYNC_FAILED="CALENDAR_LEFT_RAIL_SETTINGS_SYNC_FAILED",e.CALENDAR_LEFT_RAIL_SETTINGS_UPTO_DATE="CALENDAR_LEFT_RAIL_SETTINGS_UPTO_DATE",e.CONNECTED_CALENDAR_SYNCING="CONNECTED_CALENDAR_SYNCING",e.CONNECTED_CALENDAR_SYNC_FAILED="CONNECTED_CALENDAR_SYNC_FAILED",e.CONNECTED_CALENDAR_UPTO_DATE="CONNECTED_CALENDAR_UPTO_DATE",e.EMPTY="EMPTY",e.MULTI_CALENDAR_SYNCING="MULTI_CALENDAR_SYNCING",e.MULTI_CALENDAR_SYNC_FAILED="MULTI_CALENDAR_SYNC_FAILED",e.MULTI_CALENDAR_UPTO_DATE="MULTI_CALENDAR_UPTO_DATE",e.USER_CALENDAR_SYNCING="USER_CALENDAR_SYNCING",e.USER_CALENDAR_SYNC_FAILED="USER_CALENDAR_SYNC_FAILED",e.USER_CALENDAR_UPTO_DATE="USER_CALENDAR_UPTO_DATE"}(ct||(ct={})),function(e){e.None="None",e.MutedTeamMember="MutedTeamMember",e.OnlyOwnersCanPost="OnlyOwnersCanPost"}(ut||(ut={})),function(e){e.private="private",e.online="online",e.event="event",e.inPerson="inPerson",e.channel="channel",e.broadcast="broadcast"}(mt||(mt={})),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared"}(gt||(gt={})),function(e){e.Admin="Admin",e.Guest="Guest",e.Shadow="Shadow",e.Undefined="Undefined",e.User="User"}(pt||(pt={})),function(e){e.Everyone="Everyone",e.EveryoneButGuests="EveryoneButGuests",e.Moderators="Moderators"}(vt||(vt={})),function(e){e.AnyonePost="AnyonePost",e.AnyoneWithWarning="AnyoneWithWarning",e.OwnersPost="OwnersPost"}(ht||(ht={})),function(e){e.Room="Room",e.Building="Building"}(ft||(ft={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.Exception="Exception",e.RecurringMaster="RecurringMaster"}(yt||(yt={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown"}(kt||(kt={})),function(e){e.Content="Content",e.ContentWithGallery="ContentWithGallery",e.Gallery="Gallery",e.None="None"}(St||(St={})),function(e){e.Info="Info",e.Error="Error"}(bt||(bt={})),function(e){e.accessibilitypanel="accessibilitypanel",e.accounts="accounts",e.activecalldialog="activecalldialog",e.activity="activity",e.addchannel="addchannel",e.addmember="addmember",e.addmembernewteam="addmembernewteam",e.agendapage="agendapage",e.aiinsightscontent="aiinsightscontent",e.alttext="alttext",e.annotation="annotation",e.appdetails="appdetails",e.attendancereport="attendancereport",e.attendeeview="attendeeview",e.autobrbconfirmationdialog="autobrbconfirmationdialog",e.autoinstallnotification="autoinstallnotification",e.bannerNotification="bannerNotification",e.blank="blank",e.blockChat="blockChat",e.livepersonacard="livepersonacard",e.livepersonaeditor="livepersonaeditor",e.brbfeedbackdialog="brbfeedbackdialog",e.breakoutrooms="breakoutrooms",e.breakoutroomsassignment="breakoutroomsassignment",e.breakoutroomsassignmenttype="breakoutroomsassignmenttype",e.breakoutroomscreaterooms="breakoutroomscreaterooms",e.breakoutroomsdeleteroom="breakoutroomsdeleteroom",e.breakoutroomsdeleterooms="breakoutroomsdeleterooms",e.breakoutroomseditroom="breakoutroomseditroom",e.breakoutroomssettings="breakoutroomssettings",e.breakoutroomspanel="breakoutroomspanel",e.broadcastfeedback="broadcastfeedback",e.broadcastliveevent="broadcastliveevent",e.broadcastqna="broadcastqna",e.broadcasts="broadcasts",e.calendar="calendar",e.callablechannels="callablechannels",e.callingalertdialog="callingalertdialog",e.callingbannernotification="callingbannernotification",e.callingconfirmdialog="callingconfirmdialog",e.callingdeeplink="callingdeeplink",e.callingprotocoldeeplinkdialog="callingprotocoldeeplinkdialog",e.calls="calls",e.callscontent="callscontent",e.callsgallery="callsgallery",e.callsgalleryandcontent="callsgalleryandcontent",e.callskeypad="callskeypad",e.callsmain="callsmain",e.callsmonitor="callsmonitor",e.callstransfer="callstransfer",e.cameraeffects="cameraeffects",e.campaignnotifications="campaignnotifications",e.cast="cast",e.channelanalytics="channelanalytics",e.channelcalendar="channelcalendar",e.channelconnectors="channelconnectors",e.channeldeeplink="channeldeeplink",e.channeldelete="channeldelete",e.channeledit="channeledit",e.channelemail="channelemail",e.channelemailerror="channelemailerror",e.channelemailv2="channelemailv2",e.channelinvitations="channelinvitations",e.channelmanage="channelmanage",e.channelmembers="channelmembers",e.channelmoderators="channelmoderators",e.channelnotificationsettings="channelnotificationsettings",e.channelroster="channelroster",e.channels="channels",e.channelsettings="channelsettings",e.channelsPinnedPost="channelsPinnedPost",e.channelsSystemMessage="channelsSystemMessage",e.channelcontextualsearch="channelcontextualsearch",e.channeltags="channeltags",e.chats="chats",e.chatContextualSearch="chatContextualSearch",e.chatHighlightsDetails="chatHighlightsDetails",e.chatManageApps="chatManageApps",e.chatsInfo="chatsInfo",e.chatsInfoView="chatsInfoView",e.chatInviteConfirmation="chatInviteConfirmation",e.classesintegrationcontent="classesintegrationcontent",e.closedcaptionssettings="closedcaptionssettings",e.coachreport="coachreport",e.codesnippet="codesnippet",e.communities="communities",e.communitiesaddmember="communitiesaddmember",e.communitiesevents="communitiesevents",e.communitiesguidelinesdialog="communitiesguidelinesdialog",e.communitiesonboarding="communitiesonboarding",e.connectedcalendardialog="connectedcalendardialog",e.contactssync="contactssync",e.contentcamerasetup="contentcamerasetup",e.coursecalendar="coursecalendar",e.courseteams="courseteams",e.crosspostchannelselectiondialog="crosspostchannelselectiondialog",e.crosspostchannelselectiondialogV2="crosspostchannelselectiondialogV2",e.crosspostdeletedialog="crosspostdeletedialog",e.crossTeamAnalytics="crossTeamAnalytics",e.customapp="customapp",e.default="default",e.deletechat="deletechat",e.devicesettings="devicesettings",e.defaultchannelnavdialog="defaultchannelnavdialog",e.deleteActivityFeedItem="deleteActivityFeedItem",e.discoverappsnotifications="discoverappsnotifications",e.discoversurface="discoversurface",e.dlp="dlp",e.eduteamcreate="eduteamcreate",e.email="email",e.error="error",e.esp="esp",e.example="example",e.extensions="extensions",e.faceenrollment="faceenrollment",e.file="file",e.fileopensettings="fileopensettings",e.filepicker="filepicker",e.filesoneupviewer="filesoneupviewer",e.floodgate="floodgate",e.fluid="fluid",e.flyout="flyout",e.framework="framework",e.freemiumupgrade="freemiumupgrade",e.gallery="gallery",e.galleryImages="galleryImages",e.giphyconsent="giphyconsent",e.givefeedbackchoices="givefeedbackchoices",e.guardians="guardians",e.help="help",e.homepage="homepage",e.hostedincontextstore="hostedincontextstore",e.hwctaskmodule="hwctaskmodule",e.hybridplaceholder="hybridplaceholder",e.hyperlink="hyperlink",e.identity="identity",e.identitydialog="identitydialog",e.inAppToast="inAppToast",e.incontextstore="incontextstore",e.invisionwhiteboard="invisionwhiteboard",e.joinlinkdialog="joinlinkdialog",e.leavechat="leavechat",e.leaveGroupAndBlockUser="leaveGroupAndBlockUser",e.licenses="licenses",e.linkedin="linkedin",e.lobnotifications="lobnotifications",e.locationapi="locationapi",e.manageapps="manageapps",e.manageappswebhook="manageappswebhook",e.mediastreams="mediastreams",e.meet="meet",e.meetinganalytics="meetinganalytics",e.meetingapis="meetingapis",e.meetingcollaboration="meetingcollaboration",e.meetingdetails="meetingdetails",e.meetingoptionscreatedialog="meetingoptionscreatedialog",e.meetingrecap="meetingrecap",e.meetingrecaptab="meetingrecaptab",e.meetingroomallinone="meetingroomallinone",e.meetingroomallinonecall="meetingroomallinonecall",e.meetingroomconsolecall="meetingroomconsolecall",e.meetingroomfrontofroom="meetingroomfrontofroom",e.meetingroomfrontofroomcontent="meetingroomfrontofroomcontent",e.meetingroomfrontofroomgallery="meetingroomfrontofroomgallery",e.meetings="meetings",e.meetingsettings="meetingsettings",e.meetingstream="meetingstream",e.meshavatar="meshavatar",e.messagedraft="messagedraft",e.messages="messages",e.notes="notes",e.oauthcode="oauthcode",e.onboardingnotifications="onboardingnotifications",e.open3sfeedback="open3sfeedback",e.optionssettingsdialog="optionssettingsdialog",e.pearnotdefaultapp="pearnotdefaultapp",e.pstncallmedialog="pstncallmedialog",e.pinnedchatsmaxreached="pinnedchatsmaxreached",e.pinnedconversationitems="pinnedconversationitems",e.pinunpinpost="pinunpinpost",e.platformapp="platformapp",e.platformappdetails="platformappdetails",e.platformappconsent="platformappconsent",e.platformappdevicepermissions="platformappdevicepermissions",e.platformapps="platformapps",e.platformauthconsentdialog="platformauthconsentdialog",e.platformStage="platformStage",e.platformstageinactivemeeting="platformstageinactivemeeting",e.platformsubscriptionplans="platformsubscriptionplans",e.platformtab="platformtab",e.platformTabGallery="platformTabGallery",e.prejoinoverlaydialog="prejoinoverlaydialog",e.presentdeeplinknomeetingcontextdialog="presentdeeplinknomeetingcontextdialog",e.presentertoolbar="presentertoolbar",e.ptzextension="ptzextension",e.registration="registration",e.removechannelemail="removechannelemail",e.removechatuser="removechatuser",e.reportConcern="reportConcern",e.reportConcernForTFW="reportConcernForTFW",e.restartrecomendeddialog="restartrecomendeddialog",e.restorechannel="restorechannel",e.roomremote="roomremote",e.roster="roster",e.schedulingform="schedulingform",e.schoolteams="schoolteams",e.search="search",e.selectMediaApi="selectMediaApi",e.selectpeoplepicker="selectpeoplepicker",e.settingsdialog="settingsdialog",e.settingsstore="settingsstore",e.settingsstorecallqueue="settingsstorecallqueue",e.settingsstoredelegator="settingsstoredelegator",e.sharedchannelacceptinvitation="sharedchannelacceptinvitation",e.sharedchanneldeclineinvitation="sharedchanneldeclineinvitation",e.sharedchannelspendinginvites="sharedchannelspendinginvites",e.sharedchanneldenyinvitation="sharedchanneldenyinvitation",e.showChannelOwners="showChannelOwners",e.showformemberdialog="showformemberdialog",e.teamslist="teamslist",e.sharechatlink="sharechatlink",e.shareformdialog="shareformdialog",e.shareMeetingInfo="shareMeetingInfo",e.sharecommunitieslink="sharecommunitieslink",e.reportconcerncommunities="reportconcerncommunities",e.signoutdialog="signoutdialog",e.smartdeviceagendapage="smartdeviceagendapage",e.smartdevicelogin="smartdevicelogin",e.smartdevicelogoutdialog="smartdevicelogoutdialog",e.spaces="spaces",e.stagecontent="stagecontent",e.standaloneapp="standaloneapp",e.stagedapps="stagedapps",e.stagingroomstartmeetingconfirmationdialog="stagingroomstartmeetingconfirmationdialog",e.stopsharingchannelwithteam="stopsharingchannelwithteam",e.store="store",e.storefre="storefre",e.streamcamera="streamcamera",e.survey="survey",e.tabapps="tabapps",e.taskmodule="taskmodule",e.teamarchive="teamarchive",e.teamchannels="teamchannels",e.teamcreate="teamcreate",e.teamdeeplink="teamdeeplink",e.teamdiscover="teamdiscover",e.teamedit="teamedit",e.teamsgallery="teamsgallery",e.teamjoin="teamjoin",e.teamjoincode="teamjoincode",e.teamleave="teamleave",e.teammanage="teammanage",e.teamanalytics="teamanalytics",e.teammanageapps="teammanageapps",e.teammanagetags="teammanagetags",e.teampendingrequests="teampendingrequests",e.teampicture="teampicture",e.teamrenewal="teamrenewal",e.teamrestore="teamrestore",e.teams="teams",e.teamsettings="teamsettings",e.tflfre="tflfre",e.toasts="toasts",e.tpndialog="tpndialog",e.transcript="transcript",e.transcriptcontent="transcriptcontent",e.transcripttab="transcripttab",e.translationfeedback="translationfeedback",e.twowaysmsfriendlyname="twowaysmsfriendlyname",e.unparkcalldialog="unparkcalldialog",e.unifiedconsentdialog="unifiedconsentdialog",e.unsupporteddeeplinkdialog="unsupporteddeeplinkdialog",e.updategroupchatavatar="updategroupchatavatar",e.updatemsaprofileavatardialog="updatemsaprofileavatardialog",e.updatemsaprofilenamedialog="updatemsaprofilenamedialog",e.usermediadialog="usermediadialog",e.videobackgrounds="videobackgrounds",e.videoeffectsandavatar="videoeffectsandavatar",e.videoeffectscustomization="videoeffectscustomization",e.videoeffectsmoreview="videoeffectsmoreview",e.viewImagesApi="viewImagesApi",e.virtualevents="virtualevents",e.voiceenrollment="voiceenrollment",e.whatsnewdialog="whatsnewdialog",e.wiki="wiki",e.windowingerrordialog="windowingerrordialog",e.workflows="workflows",e.yammerqna="yammerqna",e.locationnotification="locationnotification",e.externalnavigation="externalnavigation",e.officeintegrationfredialog="officeintegrationfredialog",e.meetingcollaborationcontent="meetingcollaborationcontent"}(Ct||(Ct={})),function(e){e.config="config",e.confirm="confirm",e.create="create",e.tenantLogin="tenantLogin",e.tenantRedemption="tenantRedemption",e.default="default",e.delete="delete",e.error="error",e.health="health",e.info="info",e.infoDetails="infoDetails",e.join="join",e.list="list",e.manage="manage",e.mutate="mutate",e.signin="signin",e.update="update",e.view="view",e.share="share",e.leave="leave",e.empty="empty"}(wt||(wt={})),function(e){e.show="show",e.showWithoutFocusing="showWithoutFocusing",e.hide="hide",e.toggle="toggle"}(Nt||(Nt={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.flow="flow",e.forceFlow="forceFlow",e.new="new",e.extend="extend"}(Tt||(Tt={})),function(e){e.subNavEntity="subNavEntity",e.headerEntity="headerEntity",e.startEntity="startEntity",e.mainEntity="mainEntity",e.endEntity="endEntity"}(It||(It={})),function(e){e.minimal="minimal",e.focus="focus",e.standard="standard"}(Et||(Et={})),function(e){e.back="back",e.forward="forward"}(At||(At={})),function(e){e.Activity="Activity",e.NonHybridLeftRail="NonHybridLeftRail"}(_t||(_t={})),function(e){e.HorizontalBar="HorizontalBar",e.Main="Main",e.Modal="Modal",e.Rail="Rail",e.OverlayThinHorizontalBar="OverlayThinHorizontalBar",e.PartialOverlay="PartialOverlay",e.Configurations="Configurations",e.ThinHorizontalBar="ThinHorizontalBar",e.TitleBar="TitleBar",e.VerticalBar="VerticalBar"}(Dt||(Dt={})),function(e){e.CONTEXTUAL_NOTIFICATIONS="CONTEXTUAL_NOTIFICATIONS",e.END="END",e.HEADER="HEADER",e.MAIN="MAIN",e.MODAL="MODAL",e.NAV="NAV",e.NOTIFICATIONS="NOTIFICATIONS",e.CONFIGURATIONS="CONFIGURATIONS",e.START="START",e.SUBNAV="SUBNAV",e.TITLE_BAR="TITLE_BAR",e.TOASTS="TOASTS"}(Ft||(Ft={})),function(e){e.Cancelled="Cancelled",e.Closed="Closed",e.Confirmed="Confirmed",e.Error="Error",e.Open="Open"}(Mt||(Mt={})),function(e){e.ContentAndPeople="ContentAndPeople",e.ContentOnly="ContentOnly",e.PeopleOnly="PeopleOnly"}(Rt||(Rt={})),function(e){e.organization="organization"}(Pt||(Pt={})),function(e){e.whiteboard="whiteboard",e.document="document",e.video="video",e.none="none"}(Ot||(Ot={})),function(e){e.Video="Video",e.ScreenSharing="ScreenSharing"}(xt||(xt={})),function(e){e.Single="Single",e.TwoLargeLeft="TwoLargeLeft"}(Lt||(Lt={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(Ut||(Ut={})),function(e){e.Single="Single",e.Left="Left",e.Right="Right"}(Bt||(Bt={})),function(e){e.ScreenSharing="ScreenSharing",e.Video="Video"}(jt||(jt={})),function(e){e.Fade="Fade",e.Off="Off",e.On="On"}(Wt||(Wt={})),function(e){e.Compose="Compose",e.Paste="Paste"}(Vt||(Vt={})),function(e){e.NonEmbed="NonEmbed",e.Embed="Embed"}(Ht||(Ht={})),function(e){e.Cache="Cache",e.Network="Network"}($t||($t={})),function(e){e.QuickStart="QuickStart",e.BYOE="BYOE",e.QuickStartPushToStream="QuickStartPushToStream",e.Overflow="Overflow",e.ODSP="ODSP"}(zt||(zt={})),function(e){e.Opening="Opening",e.OpeningFailed="OpeningFailed",e.Closing="Closing",e.ClosingFailed="ClosingFailed",e.Deleting="Deleting",e.DeletingFailed="DeletingFailed"}(Gt||(Gt={})),function(e){e.aggregatefiles="aggregatefiles",e.customspo="customspo",e.downloads="downloads",e.p2p="p2p",e.personal="personal",e.recent="recent",e.teams="teams",e.teamsSdk="teamsSdk"}(qt||(qt={})),function(e){e.Manual="Manual",e.Automatic="Automatic"}(Qt||(Qt={})),function(e){e.Initial="Initial",e.Creating="Creating",e.AlreadyExist="AlreadyExist",e.Failed="Failed"}(Jt||(Jt={})),function(e){e.Saving="Saving",e.Loading="Loading",e.FailedToLoad="FailedToLoad",e.FailedToSave="FailedToSave",e.Success="Success"}(Yt||(Yt={})),function(e){e.AdaptiveCardTab="AdaptiveCardTab",e.BotConfig="BotConfig",e.Card="Card",e.ContentBubble="ContentBubble",e.DeepLink="DeepLink",e.MessageExtension="MessageExtension",e.PlatformExtensionTab="PlatformExtensionTab",e.ShareToOutlook="ShareToOutlook"}(Kt||(Kt={})),function(e){e.CancelledByUser="CancelledByUser",e.Done="Done"}(Zt||(Zt={})),function(e){e.AutoAdjust="AutoAdjust",e.BackgroundBlur="BackgroundBlur",e.BackgroundReplace="BackgroundReplace",e.EyeContact="EyeContact",e.Greenscreen="Greenscreen",e.Off="Off",e.TouchUp="TouchUp",e.WhiteboardCleanup="WhiteboardCleanup",e.WhiteboardZoom="WhiteboardZoom",e.WhiteboardZoomAndCleanup="WhiteboardZoomAndCleanup"}(Xt||(Xt={})),function(e){e.Error="Error",e.Loading="Loading",e.ModelNotReady="ModelNotReady",e.NotReady="NotReady",e.Off="Off",e.On="On",e.Unavailable="Unavailable"}(en||(en={})),function(e){e.Everyone="Everyone",e.EveryoneInCompany="EveryoneInCompany",e.None="None"}(tn||(tn={})),function(e){e.MultiChoice="MultiChoice",e.MultiLineText="MultiLineText",e.SingleChoice="SingleChoice",e.SingleLineText="SingleLineText"}(nn||(nn={})),function(e){e.CreateEventEnableRegistration="CreateEventEnableRegistration",e.GetRegistrationInformation="GetRegistrationInformation",e.RemoveRegistration="RemoveRegistration",e.UpdateEventDisableRegistration="UpdateEventDisableRegistration",e.UpdateEventEnableRegistration="UpdateEventEnableRegistration"}(an||(an={})),function(e){e.Standard="Standard",e.PlazaRoom="PlazaRoom"}(on||(on={})),function(e){e.Uninitialised="Uninitialised",e.InProgress="InProgress",e.Resolved="Resolved",e.Rejected="Rejected"}(rn||(rn={})),function(e){e.FileAttachment="FileAttachment",e.ItemAttachment="ItemAttachment",e.ReferenceAttachment="ReferenceAttachment"}(sn||(sn={})),function(e){e.Optional="Optional",e.Organizer="Organizer",e.Required="Required",e.Resource="Resource",e.Room="Room"}(ln||(ln={})),function(e){e.User="User",e.Admin="Admin",e.Guest="Guest",e.None="None"}(dn||(dn={})),function(e){e.SecurityGroup="SecurityGroup",e.StreamGroup="StreamGroup"}(cn||(cn={})),function(e){e.collaborativeSpace="collaborativeSpace"}(un||(un={})),function(e){e.TeamsCalendarDetailsPage="TeamsCalendarDetailsPage",e.TeamsCalendarScheduling="TeamsCalendarScheduling",e.TeamsInMeeting="TeamsInMeeting"}(mn||(mn={})),function(e){e.Disabled="Disabled",e.Enabled="Enabled"}(gn||(gn={})),function(e){e.Message="Message"}(pn||(pn={})),function(e){e.ApplyClicked="ApplyClicked",e.Other="Other"}(vn||(vn={})),function(e){e.Exception="Exception",e.Occurrence="Occurrence",e.RecurringMaster="RecurringMaster",e.Single="Single"}(hn||(hn={})),function(e){e.updated="updated",e.notUpdated="notUpdated"}(fn||(fn={})),function(e){e.Cancel="Cancel",e.Publish="Publish"}(yn||(yn={})),function(e){e.BookFollowUpMeeting="BookFollowUpMeeting",e.CheckAttendance="CheckAttendance",e.DropCurrentMeeting="DropCurrentMeeting",e.JoinNextMeeting="JoinNextMeeting",e.MuteAllParticipants="MuteAllParticipants",e.OpenBotInMeetingChat="OpenBotInMeetingChat",e.OpenFeedback="OpenFeedback",e.PostMeetingStartedEvent="PostMeetingStartedEvent",e.RemindInMeetingChat="RemindInMeetingChat",e.SendRunningLateMessage="SendRunningLateMessage",e.ShareCurrentMeeting="ShareCurrentMeeting",e.ShareFile="ShareFile",e.ShareFiles="ShareFiles",e.ShareMyScreen="ShareMyScreen",e.SharePresentedDeck="SharePresentedDeck",e.ShowDeviceSettings="ShowDeviceSettings",e.ShowMeetingOptions="ShowMeetingOptions",e.ShowMissingParticipants="ShowMissingParticipants",e.StartLiveCaptions="StartLiveCaptions",e.StartRecording="StartRecording",e.StartTranscription="StartTranscription",e.StopLiveCaptions="StopLiveCaptions",e.StopRecording="StopRecording",e.StopTranscription="StopTranscription"}(kn||(kn={})),function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(Sn||(Sn={})),function(e){e.Speaker="Speaker"}(bn||(bn={})),function(e){e.Vtt="Vtt",e.Docx="Docx",e.Pdf="Pdf"}(Cn||(Cn={})),function(e){e.anonymous="anonymous",e.organization="organization",e.users="users",e.existingAccess="existingAccess"}(wn||(wn={})),function(e){e.view="view",e.edit="edit"}(Nn||(Nn={})),function(e){e.MediaPaused="MediaPaused",e.MediaPlayed="MediaPlayed",e.MediaStopped="MediaStopped",e.MediaSeeked="MediaSeeked",e.MediaVolumeChanged="MediaVolumeChanged"}(Tn||(Tn={})),function(e){e.rotate_0="rotate_0",e.rotate_90="rotate_90",e.rotate_180="rotate_180",e.rotate_270="rotate_270"}(In||(In={})),function(e){e.list="list",e.grid="grid"}(En||(En={})),function(e){e.NotSupported="NotSupported",e.Unavailable="Unavailable",e.Available="Available"}(An||(An={})),function(e){e.LIS="LIS",e.CLS="CLS",e.Assist="Assist",e.Manual="Manual",e.Registered="Registered",e.None="None"}(_n||(_n={})),function(e){e.CommandResetError="CommandResetError",e.CommandZoomInError="CommandZoomInError",e.CommandZoomOutError="CommandZoomOutError",e.CommandPanLeftError="CommandPanLeftError",e.CommandPanRightError="CommandPanRightError",e.CommandTiltUpError="CommandTiltUpError",e.CommandTiltDownError="CommandTiltDownError",e.SendDataError="SendDataError"}(Dn||(Dn={})),function(e){e.None="None",e.ControlDenied="ControlDenied",e.ControlNoResponse="ControlNoResponse",e.ControlBusy="ControlBusy",e.AckTimeout="AckTimeout",e.ControlTerminated="ControlTerminated",e.ControllerTerminated="ControllerTerminated",e.DataChannelError="DataChannelError",e.ControllerCancelled="ControllerCancelled",e.ControlDisabled="ControlDisabled",e.ControlTerminatedToAllowOtherController="ControlTerminatedToAllowOtherController"}(Fn||(Fn={})),function(e){e.None="None",e.Disabled="Disabled",e.Pending="Pending",e.Waiting="Waiting",e.Started="Started",e.Stopped="Stopped",e.Failed="Failed"}(Mn||(Mn={})),function(e){e.None="None",e.Started="Started",e.Stopped="Stopped",e.Pending="Pending",e.Failed="Failed",e.Disabled="Disabled"}(Rn||(Rn={})),function(e){e.ImplicitActionItems="ImplicitActionItems",e.ManualActionItems="ManualActionItems"}(Pn||(Pn={})),function(e){e.ImplicitActionItem="ImplicitActionItem",e.ExplicitActionItem="ExplicitActionItem"}(On||(On={})),function(e){e.Low="Low",e.High="High"}(xn||(xn={})),function(e){e.Unassigned="Unassigned",e.Commitment="Commitment",e.Request="Request",e.Delegation="Delegation"}(Ln||(Ln={})),function(e){e.Done="Done",e.InProcess="InProcess",e.NotStarted="NotStarted",e.ScoreTooLow="ScoreTooLow",e.TooManyCharacters="TooManyCharacters",e.UnknownError="UnknownError",e.TranslationNotNeeded="TranslationNotNeeded",e.ShowOriginalMessage="ShowOriginalMessage",e.MessageNotFound="MessageNotFound",e.VersionNotFound="VersionNotFound",e.LanguageDetectionFailed="LanguageDetectionFailed",e.UnsupportedSourceLanguage="UnsupportedSourceLanguage",e.ClientMutationThrottled="ClientMutationThrottled"}(Un||(Un={})),function(e){e.GetByKey="GetByKey",e.Put="Put",e.Delete="Delete",e.DeleteCardData="DeleteCardData",e.GetAuthBlockLastUsage="GetAuthBlockLastUsage",e.PutAuthBlockLastUsage="PutAuthBlockLastUsage"}(Bn||(Bn={})),function(e){e.NotControlCapable="NotControlCapable",e.Disabled="Disabled",e.NotInControl="NotInControl",e.RequestSent="RequestSent",e.InControl="InControl"}(jn||(jn={})),function(e){e.Monitor="Monitor",e.Window="Window",e.Camera="Camera"}(Wn||(Wn={})),function(e){e.NotStarted="NotStarted",e.Starting="Starting",e.Started="Started",e.Stopping="Stopping",e.Stopped="Stopped"}(Vn||(Vn={})),function(e){e.Offline="Offline",e.InitFailed="InitFailed",e.JoinFailed="JoinFailed",e.AcceptFailed="AcceptFailed"}(Hn||(Hn={})),function(e){e.None="None",e.Normal="Normal",e.Deep="Deep",e.PNS="PNS"}($n||($n={})),function(e){e.Auto="Auto",e.High="High",e.Low="Low",e.Medium="Medium",e.None="None"}(zn||(zn={})),function(e){e.OngoingCall="OngoingCall",e.Meeting="Meeting",e.OneToOneCall="OneToOneCall",e.GroupCall="GroupCall"}(Gn||(Gn={})),function(e){e.Legacy="Legacy",e.MeetingData="MeetingData"}(qn||(qn={})),function(e){e.Default="Default",e.LongrangeSpeaker="LongrangeSpeaker",e.Auditorium="Auditorium"}(Qn||(Qn={})),function(e){e.MeetingCoach="MeetingCoach",e.MeetingInfo="MeetingInfo",e.MeetingInfoV3="MeetingInfoV3",e.AttendanceReport="AttendanceReport",e.AttendanceReportV3="AttendanceReportV3",e.ExternalParticipants="ExternalParticipants",e.ExplicitActionItems="ExplicitActionItems",e.ImplicitActionItems="ImplicitActionItems",e.Decisions="Decisions",e.Notes="Notes",e.Playground="Playground",e.ManualActionItems="ManualActionItems",e.NgcParticipantsActivity="NgcParticipantsActivity",e.Transcript="Transcript",e.TranscriptEntities="TranscriptEntities",e.TranscriptEvents="TranscriptEvents",e.Recording="Recording",e.MeetingContent="MeetingContent",e.MeetingStage="MeetingStage",e.MeetingChat="MeetingChat",e.Attachment="Attachment"}(Jn||(Jn={})),function(e){e.Default="Default",e.Room="Room"}(Yn||(Yn={})),function(e){e.BCP="BCP"}(Kn||(Kn={})),function(e){e.AMS="AMS",e.MiddleLaneUltraLowLatency="MiddleLaneUltraLowLatency",e.MiddleLaneHttpLiveStreaming="MiddleLaneHttpLiveStreaming"}(Zn||(Zn={})),function(e){e.RTMPInput="RTMPInput"}(Xn||(Xn={})),function(e){e.Audio="Audio",e.Video="Video",e.PanoramicVideo="PanoramicVideo",e.ScreenShare="ScreenShare",e.Data="Data",e.ParticipantVideo_0="ParticipantVideo_0",e.ParticipantVideo_1="ParticipantVideo_1",e.ParticipantVideo_2="ParticipantVideo_2",e.ParticipantVideo_3="ParticipantVideo_3"}(ei||(ei={})),function(e){e.Unknown="Unknown",e.Standard="Standard",e.Reserved="Reserved"}(ti||(ti={})),function(e){e.Room="Room",e.Workspace="Workspace",e.RoomList="RoomList"}(ni||(ni={})),function(e){e.PresenceUnknown="PresenceUnknown",e.Available="Available",e.AvailableIdle="AvailableIdle",e.Away="Away",e.Busy="Busy",e.BusyIdle="BusyIdle",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Offline="Offline"}(ii||(ii={})),function(e){e.InACall="InACall",e.InAConferenceCall="InAConferenceCall",e.InAMeeting="InAMeeting",e.Presenting="Presenting",e.OffWork="OffWork",e.Available="Available",e.Inactive="Inactive",e.Busy="Busy",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Away="Away",e.Offline="Offline",e.UrgentInterruptionsOnly="UrgentInterruptionsOnly",e.PresenceUnknown="PresenceUnknown",e.OutOfOffice="OutOfOffice"}(ai||(ai={})),function(e){e.None="None",e.OnShift="OnShift",e.OffShift="OffShift"}(oi||(oi={})),function(e){e.Chat="Chat",e.PhoneChat="PhoneChat",e.Meeting="Meeting",e.SfBInteropChat="SfBInteropChat"}(ri||(ri={})),function(e){e.None="None",e.Meeting="Meeting",e.Channel="Channel"}(si||(si={})),function(e){e.AcceptPending="AcceptPending",e.Accepted="Accepted",e.Blocked="Blocked",e.Quarantined="Quarantined",e.ExtendedDirectoryAcceptPending="ExtendedDirectoryAcceptPending"}(li||(li={})),function(e){e.Unknown="Unknown",e.Office="Office",e.Remote="Remote"}(di||(di={})),function(e){e.ChatEnabled="ChatEnabled",e.ChatDisabled="ChatDisabled",e.InMeeting="InMeeting",e.ChatEnabledAnonymousDisabled="ChatEnabledAnonymousDisabled",e.InMeetingAnonymousDisabled="InMeetingAnonymousDisabled"}(ci||(ci={})),function(e){e.OptedOut="OptedOut",e.Deprovisioned="Deprovisioned",e.Claimed="Claimed"}(ui||(ui={})),function(e){e.Importing="Importing",e.Completed="Completed"}(mi||(mi={})),function(e){e.None="None",e.Admin="Admin",e.User="User",e.Guest="Guest",e.Shadow="Shadow",e.Anonymous="Anonymous"}(gi||(gi={})),function(e){e.Standard="Standard",e.MeetingControl="MeetingControl",e.MeetingRecording="MeetingRecording",e.MeetingTranscript="MeetingTranscript"}(pi||(pi={})),function(e){e.top="top",e.bottom="bottom"}(vi||(vi={})),function(e){e.LOADED="LOADED",e.DELETED="DELETED",e.INVALID="INVALID",e.NOTFOUND="NOTFOUND"}(hi||(hi={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(fi||(fi={})),function(e){e.Email="Email",e.Call="Call",e.PSTN="PSTN",e.SMS="SMS",e.TeamsCall="TeamsCall",e.ETNP="ETNP"}(yi||(yi={})),function(e){e.Delivered="Delivered",e.Sending="Sending",e.Error="Error",e.Undeliverable="Undeliverable"}(ki||(ki={})),function(e){e.Standard="Standard",e.Important="Important",e.Urgent="Urgent"}(Si||(Si={})),function(e){e.Everyone="Everyone",e.AuthorAndOwners="AuthorAndOwners",e.Undefined="Undefined"}(bi||(bi={})),function(e){e.Standard="Standard",e.Announcement="Announcement",e.Email="Email",e.ScheduledMeeting="ScheduledMeeting",e.InstantMeeting="InstantMeeting",e.Connector="Connector",e.Guardians="Guardians"}(Ci||(Ci={})),function(e){e.Sent="Sent",e.sent="sent",e.Failed="Failed",e.failed="failed"}(wi||(wi={})),function(e){e.Hold="Hold",e.Resume="Resume",e.Barge="Barge"}(Ni||(Ni={})),function(e){e.Default="Default",e.ScreenSharing="ScreenSharing",e.EmergencyGroupCall="EmergencyGroupCall",e.Unknown="Unknown"}(Ti||(Ti={})),function(e){e.MultiParty="MultiParty",e.TwoParty="TwoParty",e.Unknown="Unknown"}(Ii||(Ii={})),function(e){e.Accepted="Accepted",e.AcceptedElsewhere="AcceptedElsewhere",e.Declined="Declined",e.Missed="Missed",e.Unknown="Unknown"}(Ei||(Ei={})),function(e){e.Outgoing="Outgoing",e.Incoming="Incoming",e.Unknown="Unknown"}(Ai||(Ai={})),function(e){e.Transferred="Transferred",e.TransferAccepted="TransferAccepted",e.TransferFailed="TransferFailed",e.TransferSucceeded="TransferSucceeded",e.Unknown="Unknown"}(_i||(_i={})),function(e){e.Immediate="Immediate",e.Simultaneous="Simultaneous",e.Unanswered="Unanswered"}(Di||(Di={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing",e.Group="Group"}(Fi||(Fi={})),function(e){e.PlayBusySignal="PlayBusySignal",e.RedirectAsUnansweredCall="RedirectAsUnansweredCall",e.RingUser="RingUser"}(Mi||(Mi={})),function(e){e.Regular="Regular",e.CallQueue="CallQueue",e.CallGroup="CallGroup",e.Delegate="Delegate",e.MeetingStartedReminder="MeetingStartedReminder"}(Ri||(Ri={})),function(e){e.Ring="Ring",e.Bop="Bop",e.Bounce="Bounce",e.Bubbles="Bubbles",e.DripDrop="DripDrop",e.Eureka="Eureka",e.Flutter="Flutter",e.HighScore="HighScore",e.NextLevel="NextLevel",e.Plink="Plink",e.RingRing="RingRing",e.Ripple="Ripple",e.Spacetime="Spacetime",e.WishGranted="WishGranted",e.Wobble="Wobble",e.BubblesLoud="BubblesLoud",e.Remix="Remix"}(Pi||(Pi={})),function(e){e.loading="loading",e.granting="granting"}(Oi||(Oi={})),function(e){e.Unknown="Unknown",e.NetworkError="NetworkError",e.NetworkOffline="NetworkOffline",e.ValidationError="ValidationError",e.DeserializationError="DeserializationError",e.NotImplemented="NotImplemented",e.CalendarEventCreationFailedOccurrenceTimeSpanTooBig="CalendarEventCreationFailedOccurrenceTimeSpanTooBig",e.ErrorOccurrenceTimeSpanTooBig="ErrorOccurrenceTimeSpanTooBig",e.CalendarEventEndDateIsEarlierThanStartDate="CalendarEventEndDateIsEarlierThanStartDate",e.ErrorCalendarEndDateIsEarlierThanStartDate="ErrorCalendarEndDateIsEarlierThanStartDate",e.ErrorInSchedulingServiceEventNotFound="ErrorInSchedulingServiceEventNotFound",e.ErrorInSchedulingServiceNotInEventTeam="ErrorInSchedulingServiceNotInEventTeam",e.ErrorInSchedulingServiceMsnpMeetingPropertiesNotFound="ErrorInSchedulingServiceMsnpMeetingPropertiesNotFound",e.ErrorRecurrenceHasNoOccurrence="ErrorRecurrenceHasNoOccurrence",e.CalendarEventCreationFailedInExchange="CalendarEventCreationFailedInExchange",e.CalendarEventNotFound="CalendarEventNotFound",e.ErrorItemNotFound="ErrorItemNotFound",e.CalendarEventNull="CalendarEventNull",e.HtmlViewNotPresent="HtmlViewNotPresent",e.EmptySchedulingServiceMeetingSettings="EmptySchedulingServiceMeetingSettings",e.EmptySchedulingServiceEvent="EmptySchedulingServiceEvent",e.ErrorCalendarIsOrganizerForRsvp="ErrorCalendarIsOrganizerForRsvp",e.ErrorCalendarIsOrganizerForAccept="ErrorCalendarIsOrganizerForAccept",e.ErrorCalendarIsOrganizerForDecline="ErrorCalendarIsOrganizerForDecline",e.ErrorCalendarIsOrganizerForTentative="ErrorCalendarIsOrganizerForTentative",e.ErrorCalendarIsCancelledForRsvp="ErrorCalendarIsCancelledForRsvp",e.ErrorCalendarIsCancelledForAccept="ErrorCalendarIsCancelledForAccept",e.ErrorCalendarIsCancelledForDecline="ErrorCalendarIsCancelledForDecline",e.ErrorCalendarIsCancelledForTentative="ErrorCalendarIsCancelledForTentative",e.ExchangeInvalidLicense="ExchangeInvalidLicense",e.ErrorInvalidLicense="ErrorInvalidLicense",e.ErrorInvalidRecipients="ErrorInvalidRecipients",e.ErrorNonExistentMailbox="ErrorNonExistentMailbox",e.ErrorTimeZone="ErrorTimeZone",e.ErrorOccurrenceCrossingBoundary="ErrorOccurrenceCrossingBoundary",e.ErrorCalendarIsNotOrganizer="ErrorCalendarIsNotOrganizer",e.ErrorInSchedulingServiceOutdatedEvent="ErrorInSchedulingServiceOutdatedEvent",e.InvalidCancellationMessageFormat="InvalidCancellationMessageFormat",e.InvalidConversationId="InvalidConversationId",e.InvalidExchangeId="InvalidExchangeId",e.InvalidICalUid="InvalidICalUid",e.InvalidMailboxAddress="InvalidMailboxAddress",e.InvalidMailboxAddressOrGuid="InvalidMailboxAddressOrGuid",e.InvalidMeetingOrganizer="InvalidMeetingOrganizer",e.InvalidUpdateMessageFormat="InvalidUpdateMessageFormat",e.ConnectedAccountNotFound="ConnectedAccountNotFound",e.ShadowMailboxDeleted="ShadowMailboxDeleted",e.ShadowTokenRevoked="ShadowTokenRevoked",e.ShadowTokenExpired="ShadowTokenExpired"}(xi||(xi={})),function(e){e.Recording="Recording",e.Notes="Notes",e.AttendanceReport="AttendanceReport",e.Transcript="Transcript",e.SuggestedTasksSession="SuggestedTasksSession",e.MeetingContent="MeetingContent",e.Document="Document",e.PowerPoint="PowerPoint",e.Whiteboard="Whiteboard",e.Attachments="Attachments"}(Li||(Li={})),function(e){e.Channel="Channel"}(Ui||(Ui={})),function(e){e.Anonymous="Anonymous",e.AllCompany="AllCompany",e.InvitationOnly="InvitationOnly"}(Bi||(Bi={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown"}(ji||(ji={})),function(e){e.None="None",e.Organizer="Organizer",e.Tentative="Tentative",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(Wi||(Wi={})),function(e){e.None="None",e.InPerson="InPerson",e.Virtual="Virtual"}(Vi||(Vi={})),function(e){e.Created="Created",e.Activated="Activated",e.Abandoned="Abandoned",e.Suspended="Suspended",e.Live="Live",e.Stopped="Stopped",e.Deleted="Deleted",e.Recreated="Recreated",e.Hidden="Hidden"}(Hi||(Hi={})),function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Other="Other"}($i||($i={})),function(e){e.Delete="Delete"}(zi||(zi={})),function(e){e.Team="Team",e.Edu="Edu",e.Class="Class",e.Plc="Plc",e.Staff="Staff",e.HealthcareCareCoordination="HealthcareCareCoordination",e.Community="Community"}(Gi||(Gi={})),function(e){e.None="None",e.Private="Private",e.Secret="Secret",e.Public="Public",e.HiddenMembership="HiddenMembership",e.Unknown="Unknown",e.All="All"}(qi||(qi={})),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared"}(Qi||(Qi={})),function(e){e.Locked="Locked",e.PartialSuccess="PartialSuccess",e.Failed="Failed",e.Unlocked="Unlocked"}(Ji||(Ji={})),function(e){e.Strict="Strict",e.Moderate="Moderate",e.NoRestriction="NoRestriction"}(Yi||(Yi={})),function(e){e.Pinned="Pinned",e.Unpinned="Unpinned"}(Ki||(Ki={})),function(e){e.RoleUpdatePromotion="RoleUpdatePromotion",e.SystemRoleUpdatePromotion="SystemRoleUpdatePromotion",e.RoleUpdateDemotion="RoleUpdateDemotion",e.SystemRoleUpdateDemotion="SystemRoleUpdateDemotion"}(Zi||(Zi={})),function(e){e.Everyone="Everyone",e.Moderators="Moderators"}(Xi||(Xi={})),function(e){e.Everyone="Everyone",e.Moderators="Moderators"}(ea||(ea={})),function(e){e.Domains="Domains",e.Members="Members",e.Anyone="Anyone"}(ta||(ta={})),function(e){e.zap="zap",e.dlp="dlp",e.cc="cc"}(na||(na={})),function(e){e.active="active",e.deleted="deleted",e.reference="reference",e.hidden="hidden"}(ia||(ia={})),function(e){e.active="active",e.deleted="deleted",e.reference="reference",e.hidden="hidden"}(aa||(aa={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker"}(oa||(oa={})),function(e){e.Info="Info",e.Warning="Warning",e.Error="Error",e.Standalone="Standalone"}(ra||(ra={})),function(e){e.AcceptBreakoutRoomInvite="AcceptBreakoutRoomInvite",e.AllowControl="AllowControl",e.betterTogetherTransferCall="betterTogetherTransferCall",e.BroadcastLearnMore="BroadcastLearnMore",e.BroadcastModalityReconnect="BroadcastModalityReconnect",e.CloseVideoApp="CloseVideoApp",e.MeetingAttendeeUfdRaiseHand="MeetingAttendeeUfdRaiseHand",e.DeclineBreakoutRoomInvite="DeclineBreakoutRoomInvite",e.DenyControl="DenyControl",e.DownloadApp="DownloadApp",e.MuteSpeakerAndMicAudio="MuteSpeakerAndMicAudio",e.NdiPrivacyPolicyCapturer="NdiPrivacyPolicyCapturer",e.PrivacyPolicyParticipant="PrivacyPolicyParticipant",e.OpenAudioEscalationDialog="OpenAudioEscalationDialog",e.SwitchDevice="SwitchDevice",e.OpenDeviceSettings="OpenDeviceSettings",e.OpenLearnMoreLink="OpenLearnMoreLink",e.OpenMeetingInfo="OpenMeetingInfo",e.OpenPrivacyPolicyLink="OpenPrivacyPolicyLink",e.OpenVideoDevicePermission="OpenVideoDevicePermission",e.OptOutFromVoiceCollection="OptOutFromVoiceCollection",e.CloseVoiceCollection="CloseVoiceCollection",e.PaywallUpgrade="PaywallUpgrade",e.PstnDialInManually="PstnDialInManually",e.PstnDialOutManually="PstnDialOutManually",e.RejoinAsGuest="RejoinAsGuest",e.ReportScdFailure="ReportScdFailure",e.ShowPstnDialog="ShowPstnDialog",e.StartChromeExtensionInstallation="StartChromeExtensionInstallation",e.StartContentSharing="StartContentSharing",e.StartScreenSharingOnCall="StartScreenSharingOnCall",e.StartTranscript="StartTranscript",e.StartRecording="StartRecording",e.SwitchMicrophone="SwitchMicrophone",e.SwitchShareContent="SwitchShareContent",e.ViewLobby="ViewLobby",e.TerminateControl="TerminateControl",e.TakePptSharingControl="TakePptSharingControl",e.TryAgain="TryAgain",e.TurnCameraOn="TurnCameraOn",e.ToggleHighFidelityMusicMode="ToggleHighFidelityMusicMode",e.UnmuteMicAudio="UnmuteMicAudio",e.UnmuteSpeakers="UnmuteSpeakers",e.StartMeeting="StartMeeting",e.EnableScreenshareRecording="EnableScreenshareRecording",e.DisableIncomingAndOutgoingVideo="DisableIncomingAndOutgoingVideo",e.UnmuteMicAndSpeakers="UnmuteMicAndSpeakers",e.OpenInterpretationDialog="OpenInterpretationDialog",e.ControlRoomSystemPanel="ControlRoomSystemPanel",e.Cancel="Cancel",e.ViewBreakoutRooms="ViewBreakoutRooms",e.LowerHandNow="LowerHandNow",e.KeepHandRaised="KeepHandRaised",e.LowerHand="LowerHand"}(sa||(sa={})),function(e){e.ACSUserJoined="ACSUserJoined",e.ACSUserLimitedCapabilities="ACSUserLimitedCapabilities",e.AddMemberToChatFailed="AddMemberToChatFailed",e.APLDisabledInCompanionMode="APLDisabledInCompanionMode",e.AttendeeBringOffStageAlert="AttendeeBringOffStageAlert",e.AttendeeBringOnStageAlert="AttendeeBringOnStageAlert",e.AttendeeHostViewModeActivated="AttendeeHostViewModeActivated",e.AttendeeHostViewModeActivatedRaiseHand="AttendeeHostViewModeActivatedRaiseHand",e.AttendeeHostViewModeDeactivated="AttendeeHostViewModeDeactivated",e.AudioCaptureMusicDetectedWithHighNS="AudioCaptureMusicDetectedWithHighNS",e.AudioCaptureMusicDetectedWithLowNS="AudioCaptureMusicDetectedWithLowNS",e.AudioCaptureUltrasoundDetected="AudioCaptureUltrasoundDetected",e.AudioCaptureUltrasoundDetectedWithUnmuteButton="AudioCaptureUltrasoundDetectedWithUnmuteButton",e.AudioCaptureUltrasoundDetectedWithMuteButton="AudioCaptureUltrasoundDetectedWithMuteButton",e.AudienceViewFailed="AudienceViewFailed",e.AudienceViewSceneAck="AudienceViewSceneAck",e.AudienceViewSceneChanged="AudienceViewSceneChanged",e.AudienceViewSceneChangeFailed="AudienceViewSceneChangeFailed",e.BetterTogetherOutOfProximityWarning="BetterTogetherOutOfProximityWarning",e.Bmc_setLayout_command_failure="Bmc_setLayout_command_failure",e.Bmc_setLayout_command_video_stall="Bmc_setLayout_command_video_stall",e.Bmc_start_command_failure="Bmc_start_command_failure",e.Bmc_stop_command_failure="Bmc_stop_command_failure",e.Bmc_restart_command_failure="Bmc_restart_command_failure",e.BreakoutRoomAnnouncement="BreakoutRoomAnnouncement",e.BreakoutRoomsBulkMoveFailure="BreakoutRoomsBulkMoveFailure",e.BreakoutRoomsControlLost="BreakoutRoomsControlLost",e.BreakoutRoomsPanelClosedOnRoomsDeleted="BreakoutRoomsPanelClosedOnRoomsDeleted",e.BreakoutRoomsParticipantHasNoRoomsToChoose="BreakoutRoomsParticipantHasNoRoomsToChoose",e.BreakoutRoomsParticipantHasRoomsToChoose="BreakoutRoomsParticipantHasRoomsToChoose",e.BreakoutRoomCannotMoveDisconnectedParticipants="BreakoutRoomCannotMoveDisconnectedParticipants",e.BreakoutRoomCloseCreateBrDialog="BreakoutRoomCloseCreateBrDialog",e.BreakoutRoomCreationFailed="BreakoutRoomCreationFailed",e.BreakoutRoomEnding="BreakoutRoomEnding",e.BreakoutRoomInvite="BreakoutRoomInvite",e.BreakoutRoomLockXlMeeting="BreakoutRoomLockXlMeeting",e.BreakoutRoomBulkCreationFailed="BreakoutRoomBulkCreationFailed",e.BreakoutRoomBulkCreationSucceeded="BreakoutRoomBulkCreationSucceeded",e.BreakoutRoomBulkCreationFailedRoomsAlreadyExist="BreakoutRoomBulkCreationFailedRoomsAlreadyExist",e.BreakoutRoomOptimisticOpenStarted="BreakoutRoomOptimisticOpenStarted",e.BreakoutRoomOptimisticCloseStarted="BreakoutRoomOptimisticCloseStarted",e.Broadcast_captions_disabled_by_ETM="Broadcast_captions_disabled_by_ETM",e.Broadcast_concurrent_videos_limit="Broadcast_concurrent_videos_limit",e.Broadcast_end_warning="Broadcast_end_warning",e.Broadcast_ipvideo_permission="Broadcast_ipvideo_permission",e.Broadcast_ipvideo_vbss_permission="Broadcast_ipvideo_vbss_permission",e.Broadcast_noCamera="Broadcast_noCamera",e.Broadcast_preview_overflow_warning="Broadcast_preview_overflow_warning",e.Broadcast_reset_done="Broadcast_reset_done",e.Broadcast_vbss_permission="Broadcast_vbss_permission",e.BroadcastModalityDisconnected="BroadcastModalityDisconnected",e.BroadcastModalityNotReceived="BroadcastModalityNotReceived",e.BroadcastMutedProducerWarning="BroadcastMutedProducerWarning",e.BroadcastStopped="BroadcastStopped",e.CameraUnmuteTakesLongerTime="CameraUnmuteTakesLongerTime",e.CannotUnmuteOSMicrophone="CannotUnmuteOSMicrophone",e.ClosedCaptionsStartFailed="ClosedCaptionsStartFailed",e.CoachNotification="CoachNotification",e.CoachStarted="CoachStarted",e.CoachStartFailed="CoachStartFailed",e.CoachStopped="CoachStopped",e.CoachStopFailed="CoachStopFailed",e.ComplianceRecordingE2EEJoinError="ComplianceRecordingE2EEJoinError",e.ComplianceRecordingStarted="ComplianceRecordingStarted",e.ComplianceRecordingStopped="ComplianceRecordingStopped",e.ConsentToRecordingError="ConsentToRecordingError",e.ContentOnlyAlert="ContentOnlyAlert",e.ContentOnlyFromNudgeAlert="ContentOnlyFromNudgeAlert",e.ContentSharingFailed="ContentSharingFailed",e.ControlRoomSystemAlert="ControlRoomSystemAlert",e.CpuInsufficient="CpuInsufficient",e.CurrentMeetingIsXL="CurrentMeetingIsXL",e.DenyConsentToRecordingError="DenyConsentToRecordingError",e.DeviceAtCallStart="DeviceAtCallStart",e.DeviceCaptureMute="DeviceCaptureMute",e.DeviceCaptureNotFunctioning="DeviceCaptureNotFunctioning",e.DeviceCaptureNotFunctioningAudioSrvNotRunning="DeviceCaptureNotFunctioningAudioSrvNotRunning",e.DeviceCaptureNotMuteButSilent="DeviceCaptureNotMuteButSilent",e.DeviceClipping="DeviceClipping",e.DeviceHowling="DeviceHowling",e.DeviceLowSNR="DeviceLowSNR",e.DeviceMultipleEndpoints="DeviceMultipleEndpoints",e.DeviceNearEndToEchoRatio="DeviceNearEndToEchoRatio",e.DeviceRenderHowling="DeviceRenderHowling",e.DeviceRenderMute="DeviceRenderMute",e.DeviceRenderNotFunctioning="DeviceRenderNotFunctioning",e.DeviceRenderNotFunctioningAudioSrvNotRunning="DeviceRenderNotFunctioningAudioSrvNotRunning",e.DeviceRenderZeroVolume="DeviceRenderZeroVolume",e.DeviceSpeakWhileMuted="DeviceSpeakWhileMuted",e.DisableIncomingMeetingAudio="DisableIncomingMeetingAudio",e.EndToEndEncryptedMeetingMaxCapacity="EndToEndEncryptedMeetingMaxCapacity",e.EnableIncomingMeetingAudio="EnableIncomingMeetingAudio",e.EndOfMeetingAlert="EndOfMeetingAlert",e.FaceStreamEndedForCall="FaceStreamEndedForCall",e.FaceStreamStartedForCall="FaceStreamStartedForCall",e.GreenRoomStartMeetingAlert="GreenRoomStartMeetingAlert",e.GreenRoomParticipantFailedToBeMovedAlert="GreenRoomParticipantFailedToBeMovedAlert",e.GreenRoomMeetingGoLiveFailedAlert="GreenRoomMeetingGoLiveFailedAlert",e.LargeGalleryViewFailed="LargeGalleryViewFailed",e.HardwareOutMeetingSendToDevice="HardwareOutMeetingSendToDevice",e.HardwareOutMeetingStopDevice="HardwareOutMeetingStopDevice",e.HolographicAnnotationsError="HolographicAnnotationsError",e.HostViewModeActivated="HostViewModeActivated",e.HostViewModeDeactivated="HostViewModeDeactivated",e.ImageRenderingQualityAlert="ImageRenderingQualityAlert",e.ImmersiveViewUnsupportedContentAlert="ImmersiveViewUnsupportedContentAlert",e.InitiatorStartedRecording="InitiatorStartedRecording",e.InsufficientMeetingRole="InsufficientMeetingRole",e.InteropCallAlert="InteropCallAlert",e.InteropScreenshare="InteropScreenshare",e.InterpretationAvailable="InterpretationAvailable",e.JoinersOngoingRecording="JoinersOngoingRecording",e.LocalDeviceEcho="LocalDeviceEcho",e.LockedScreenInCall="LockedScreenInCall",e.LowerHandPrompt="LowerHandPrompt",e.MaskIdentitiesForRole="MaskIdentitiesForRole",e.Meeting_attendee_restrictions_operation_failure="Meeting_attendee_restrictions_operation_failure",e.Meeting_attendees_audio_failed="Meeting_attendees_audio_failed",e.Meeting_attendees_audio_restricted="Meeting_attendees_audio_restricted",e.Meeting_attendees_audio_unrestricted="Meeting_attendees_audio_unrestricted",e.Meeting_attendees_video_failed="Meeting_attendees_video_failed",e.Meeting_attendees_video_restricted="Meeting_attendees_video_restricted",e.Meeting_attendees_video_unrestricted="Meeting_attendees_video_unrestricted",e.Meeting_self_attendee_audio_restricted="Meeting_self_attendee_audio_restricted",e.Meeting_self_attendee_audio_unrestricted="Meeting_self_attendee_audio_unrestricted",e.Meeting_self_attendee_video_restricted="Meeting_self_attendee_video_restricted",e.Meeting_self_attendee_video_unrestricted="Meeting_self_attendee_video_unrestricted",e.MeetingLocked="MeetingLocked",e.MeetingLockedError="MeetingLockedError",e.MeetingUnlocked="MeetingUnlocked",e.MeetingRoleChanged="MeetingRoleChanged",e.MergeFailedAlert="MergeFailedAlert",e.MicMutedRemotely="MicMutedRemotely",e.MicUnmuteTakesLongerTime="MicUnmuteTakesLongerTime",e.HighFidelityAudioToggled="HighFidelityAudioToggled",e.HighFidelityAudioToggleFailure="HighFidelityAudioToggleFailure",e.NdiMeetingBroadcastCapturer="NdiMeetingBroadcastCapturer",e.NdiMeetingBroadcastStoppedCapturer="NdiMeetingBroadcastStoppedCapturer",e.NdiMeetingBroadcastParticipant="NdiMeetingBroadcastParticipant",e.NdiMeetingBroadcastStoppedParticipant="NdiMeetingBroadcastStoppedParticipant",e.NetworkErrorForOrganizer="NetworkErrorForOrganizer",e.NetworkQuality="NetworkQuality",e.NetworkReconnect="NetworkReconnect",e.NetworkRecvCatastrophicPoorTurnOffVideo="NetworkRecvCatastrophicPoorTurnOffVideo",e.NetworkRecvCatastrophicPstnAvailable="NetworkRecvCatastrophicPstnAvailable",e.NetworkRecvCatastrophicPstnNotAvailable="NetworkRecvCatastrophicPstnNotAvailable",e.NetworkSendCatastrophicPoorTurnOffVideo="NetworkSendCatastrophicPoorTurnOffVideo",e.NetworkSendCatastrophicPstnAvailable="NetworkSendCatastrophicPstnAvailable",e.NetworkSendCatastrophicPstnNotAvailable="NetworkSendCatastrophicPstnNotAvailable",e.NoAvailableMicrophone="NoAvailableMicrophone",e.NoAvailableSpeakers="NoAvailableSpeakers",e.NoRequiredVideoCodecs="NoRequiredVideoCodecs",e.OverflowRoomCreated="OverflowRoomCreated",e.ParticipantsRecordingStarted="ParticipantsRecordingStarted",e.PaywallTimerStart="PaywallTimerStart",e.PaywallRemainingDuration="PaywallRemainingDuration",e.PaywallRemainingParticipantCapacity="PaywallRemainingParticipantCapacity",e.PeopleFeedEndedForCall="PeopleFeedEndedForCall",e.PeopleFeedStartedForCall="PeopleFeedStartedForCall",e.PlazaEditMisrecognizedParticipantFailed="PlazaEditMisrecognizedParticipantFailed",e.PossibleBrowserPopoutForPSTNCall="PossibleBrowserPopoutForPSTNCall",e.PptContentSharingConsent="PptContentSharingConsent",e.PptContentSharingUnsupportedMeeting="PptContentSharingUnsupportedMeeting",e.PptPresentOnMeetingStart="PptPresentOnMeetingStart",e.PptPrivateViewingFailed="PptPrivateViewingFailed",e.PptSharingStolen="PptSharingStolen",e.PptSharingUnavailable="PptSharingUnavailable",e.PptUnsupportedUpload="PptUnsupportedUpload",e.PptWeatherpersonFailed="PptWeatherpersonFailed",e.PSTNCallLBRFailure="PSTNCallLBRFailure",e.PSTNDomesticRestrictedFailure="PSTNDomesticRestrictedFailure",e.PSTNEntitlementFailure="PSTNEntitlementFailure",e.RaiseHandsOperationFailure="RaiseHandsOperationFailure",e.RecordingAndTranscriptFailed="RecordingAndTranscriptFailed",e.RecordingAndTranscriptPending="RecordingAndTranscriptPending",e.RecordingAndTranscriptStarted="RecordingAndTranscriptStarted",e.RecordingAndTranscriptStartedByOthers="RecordingAndTranscriptStartedByOthers",e.RecordingAndTranscriptStopFailed="RecordingAndTranscriptStopFailed",e.RecordingAndTranscriptStopped="RecordingAndTranscriptStopped",e.RecordingAndTranscriptWaitingForMeetingLive="RecordingAndTranscriptWaitingForMeetingLive",e.RecordingDisabled="RecordingDisabled",e.RecordingExited="RecordingExited",e.RecordingFailed="RecordingFailed",e.RecordingFailedTranscriptPending="RecordingFailedTranscriptPending",e.RecordingFailedTranscriptStarted="RecordingFailedTranscriptStarted",e.RecordingPPT="RecordingPPT",e.RecordingStartedTranscriptPending="RecordingStartedTranscriptPending",e.RecordingSpotlight="RecordingSpotlight",e.RecordingStopped="RecordingStopped",e.RecordingWaitingForMeetingLive="RecordingWaitingForMeetingLive",e.RecordingWhiteboard="RecordingWhiteboard",e.RemoteDeviceEcho="RemoteDeviceEcho",e.RigelAutoExitMeetingAlert="RigelAutoExitMeetingAlert",e.RigelDisplayDisconnected="RigelDisplayDisconnected",e.RigelParticipantsInLobby="RigelParticipantsInLobby",e.RigelRoomPeopleCountChanged="RigelRoomPeopleCountChanged",e.RigelUrlBlocked="RigelUrlBlocked",e.ScreenShareContentNotSupportedForOverflow="ScreenShareContentNotSupportedForOverflow",e.ScreenshareRecordingDisabled="ScreenshareRecordingDisabled",e.ScreensharingCallEscalatedToAudio="ScreensharingCallEscalatedToAudio",e.ScreensharingCallEscalatedToAudioFailed="ScreensharingCallEscalatedToAudioFailed",e.ScreenSharingNotSupported="ScreenSharingNotSupported",e.ScreenSharingRenderingError="ScreenSharingRenderingError",e.ScreenSharingWindowMinimizedPopUpAlert="ScreenSharingWindowMinimizedPopUpAlert",e.SensitivityLabelAlert="SensitivityLabelAlert",e.SharedWindowMinimized="SharedWindowMinimized",e.SharingControlRequestDenied="SharingControlRequestDenied",e.SharingControlRequestRevoked="SharingControlRequestRevoked",e.SharingDropped="SharingDropped",e.SharingStolen="SharingStolen",e.SharingIncomingControlRequest="SharingIncomingControlRequest",e.SharingTerminateControl="SharingTerminateControl",e.NewAudioDevicePluggedInAlert="NewAudioDevicePluggedInAlert",e.NewVideoDevicePluggedInAlert="NewVideoDevicePluggedInAlert",e.AudioDeviceSelectionChangedAlert="AudioDeviceSelectionChangedAlert",e.ActiveAudioDevicePluggedOutAlert="ActiveAudioDevicePluggedOutAlert",e.ActiveVideoDevicePluggedOutAlert="ActiveVideoDevicePluggedOutAlert",e.ScdFailed="ScdFailed",e.ScdStopped="ScdStopped",e.ScdSucceeded="ScdSucceeded",e.ServerMuteForConsentRequired="ServerMuteForConsentRequired",e.SpeakerAndMicUnmuted="SpeakerAndMicUnmuted",e.SpotlightError="SpotlightError",e.SpotlightStatusChanged="SpotlightStatusChanged",e.SpotlightStatusOn="SpotlightStatusOn",e.SpotlightStatusOff="SpotlightStatusOff",e.StreamingMeetingStarted="StreamingMeetingStarted",e.StreamingMeetingStopped="StreamingMeetingStopped",e.SystemAudioDevicesMismatchInCallingScreen="SystemAudioDevicesMismatchInCallingScreen",e.SystemAudioNoDeviceInCallingScreen="SystemAudioNoDeviceInCallingScreen",e.SystemAudioDevicesNotMatch="SystemAudioDevicesNotMatch",e.SystemAudioDevicesStoppedWithError="SystemAudioDevicesStoppedWithError",e.SystemAudioDriverInstallationFailed="SystemAudioDriverInstallationFailed",e.SystemAudioDriverInstallationSucceeded="SystemAudioDriverInstallationSucceeded",e.SystemAudioNoDevice="SystemAudioNoDevice",e.SystemAudioStarted="SystemAudioStarted",e.SystemAudioUnsupportedSharing="SystemAudioUnsupportedSharing",e.TemporarilyUnmuted="TemporarilyUnmuted",e.TogetherModePinError="TogetherModePinError",e.TogetherModePinStatusOn="TogetherModePinStatusOn",e.TranscriptFailedRecordingPending="TranscriptFailedRecordingPending",e.TranscriptFailedRecordingStarted="TranscriptFailedRecordingStarted",e.TranscriptStarted="TranscriptStarted",e.TranscriptStartedByOthers="TranscriptStartedByOthers",e.TranscriptStartedRecordingPending="TranscriptStartedRecordingPending",e.TranscriptStartFailed="TranscriptStartFailed",e.TranscriptStopFailed="TranscriptStopFailed",e.TranscriptStopped="TranscriptStopped",e.TranscriptWaitingForMeetingLive="TranscriptWaitingForMeetingLive",e.UnmuteWithoutConsent="UnmuteWithoutConsent",e.UserHandLoweredByPresenter="UserHandLoweredByPresenter",e.VideoCaptureDeviceFreeze="VideoCaptureDeviceFreeze",e.VideoCaptureFreezeRecovered="VideoCaptureFreezeRecovered",e.VideoCapturePermissionDenied="VideoCapturePermissionDenied",e.VideoCapturerDeviceStartFailed="VideoCapturerDeviceStartFailed",e.VideoCapturerDeviceStartFailureLackSystemRes="VideoCapturerDeviceStartFailureLackSystemRes",e.VideoCapturerDeviceStartFailureMFResConflict="VideoCapturerDeviceStartFailureMFResConflict",e.VideoCapturerDeviceStartTimedOut="VideoCapturerDeviceStartTimedOut",e.VideoExtensibilityDisabledInStandoutMode="VideoExtensibilityDisabledInStandoutMode",e.VideoExtensibilityFreeze="VideoExtensibilityFreeze",e.VideoExtensibilitySlow="VideoExtensibilitySlow",e.VideoEffectsQualityDegraded="VideoEffectsQualityDegraded",e.VoiceCollectionFailed="VoiceCollectionFailed",e.VoiceCollectionStarted="VoiceCollectionStarted",e.VoiceCollectionStopped="VoiceCollectionStopped",e.WatermarkAnonymousUser="WatermarkAnonymousUser",e.WatermarkUnsupportedPlatformUser="WatermarkUnsupportedPlatformUser",e.WatermarkVideoStreamStart="WatermarkVideoStreamStart",e.WeatherpersonContentNotSupported="WeatherpersonContentNotSupported",e.WeatherpersonVideoStopped="WeatherpersonVideoStopped"}(la||(la={})),function(e){e.upload="upload",e.recent="recent",e.channel="channel",e.attachment="attachment",e.cortana="cortana",e.deepLink="deepLink",e.onedrive="onedrive"}(da||(da={})),function(e){e.ppt="ppt",e.invision_whiteboard="invision_whiteboard",e.whiteboard="whiteboard",e.extensible_app="extensible_app",e.annotation="annotation",e.mesh_app="mesh_app"}(ca||(ca={})),function(e){e.pptLaserPointLongPressed="pptLaserPointLongPressed",e.pptLaserPointReleased="pptLaserPointReleased",e.pptPrevSlidePressed="pptPrevSlidePressed",e.pptNextSlidePressed="pptNextSlidePressed"}(ua||(ua={})),function(e){e.Cameo="Cameo",e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(ma||(ma={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.BrowsingPrivately="BrowsingPrivately",e.Presenting="Presenting",e.Starting="Starting",e.Joining="Joining"}(ga||(ga={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.Presenting="Presenting"}(pa||(pa={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.Presenting="Presenting"}(va||(va={})),function(e){e.None="None",e.Text="Text",e.StartEvent="StartEvent",e.StopEvent="StopEvent",e.ParticipantJoined="ParticipantJoined",e.ParticipantLeft="ParticipantLeft",e.RoomAttributionStarted="RoomAttributionStarted",e.RoomAttributionStopped="RoomAttributionStopped"}(ha||(ha={})),function(e){e.Producer="Producer",e.Contributor="Contributor",e.Attendee="Attendee",e.None="None"}(fa||(fa={})),function(e){e.ups="ups",e.sfb="sfb"}(ya||(ya={})),function(e){e.Never="Never",e.OneHour="OneHour",e.FourHours="FourHours",e.Today="Today",e.ThisWeek="ThisWeek",e.Custom="Custom"}(ka||(ka={})),function(e){e.Application="Application",e.Delegated="Delegated"}(Sa||(Sa={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(ba||(ba={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(Ca||(Ca={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(wa||(wa={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition"}(Na||(Na={})),function(e){e.Identity="Identity",e.MessageTeamMembers="MessageTeamMembers",e.SendReceiveData="SendReceiveData",e.ContactData="ContactData",e.FullAccess="FullAccess",e.PublishToInternet="PublishToInternet",e.ReadAllDocument="ReadAllDocument",e.ReadDocument="ReadDocument",e.ReadItem="ReadItem",e.ReadWriteDocument="ReadWriteDocument",e.ReadWriteItem="ReadWriteItem",e.ReadWriteMailbox="ReadWriteMailbox",e.Restricted="Restricted",e.WriteDocument="WriteDocument"}(Ta||(Ta={})),function(e){e.Query="Query",e.Action="Action"}(Ia||(Ia={})),function(e){e.Compose="Compose",e.Commandbox="Commandbox",e.Message="Message"}(Ea||(Ea={})),function(e){e.Text="Text",e.Textarea="Textarea",e.Number="Number",e.Date="Date",e.Time="Time",e.Toggle="Toggle",e.Choiceset="Choiceset"}(Aa||(Aa={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(_a||(_a={})),function(e){e.like="like",e.heart="heart",e.applause="applause",e.raisehand="raisehand"}(Da||(Da={})),function(e){e.Init="Init",e.Cancel="Cancel",e.Complete="Complete"}(Fa||(Fa={})),function(e){e.Caller="Caller",e.SecurityDesk="SecurityDesk"}(Ma||(Ma={})),function(e){e.admin="admin",e.boss="boss",e.endUser="endUser"}(Ra||(Ra={})),function(e){e.None="None",e.HoloLens="HoloLens",e.Android="Android",e.iOS="iOS",e.HoloLensGuides="HoloLensGuides",e.MeshApp="MeshApp",e.Other="Other"}(Pa||(Pa={})),function(e){e.ProducerScreen="ProducerScreen",e.ContributorScreen="ContributorScreen",e.CallHealthScreen="CallHealthScreen"}(Oa||(Oa={})),function(e){e.NotAvailable="NotAvailable",e.Green="Green",e.Amber="Amber",e.Red="Red"}(xa||(xa={})),function(e){e.None="None",e.Connected="Connected",e.Disconnected="Disconnected",e.Local="Local",e.Unknown="Unknown"}(La||(La={})),function(e){e.Sharepoint="Sharepoint",e.WOPI="WOPI",e.Google="Google",e.OneDrive="OneDrive",e.Recent="Recent",e.Aggregate="Aggregate",e.FileSystem="FileSystem",e.Search="Search",e.AllFiles="AllFiles",e.SharedWithMe="SharedWithMe"}(Ua||(Ua={})),function(e){e.DROPBOX="DROPBOX",e.BOX="BOX",e.SHAREFILE="SHAREFILE",e.GOOGLEDRIVE="GOOGLEDRIVE",e.EGNYTE="EGNYTE",e.SharePoint="SharePoint"}(Ba||(Ba={})),function(e){e.Recent="Recent",e.Aggregate="Aggregate",e.Personal="Personal",e.Teams="Teams",e.Channels="Channels",e.Downloads="Downloads",e.PersonalWopi="PersonalWopi",e.PersonalGoogle="PersonalGoogle",e.CustomSpo="CustomSpo",e.SharedWithMe="SharedWithMe",e.Chats="Chats"}(ja||(ja={})),function(e){e.classMaterials="classMaterials"}(Wa||(Wa={})),function(e){e.readonly="readonly"}(Va||(Va={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent"}(Ha||(Ha={})),function(e){e.chat="chat",e.channel="channel"}($a||($a={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser"}(za||(za={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook"}(Ga||(Ga={})),function(e){e.team="team",e.channel="channel"}(qa||(qa={})),function(e){e.html="html",e.text="text"}(Qa||(Qa={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry"}(Ja||(Ja={})),function(e){e.Member="Member",e.Guest="Guest",e.Federated="Federated"}(Ya||(Ya={})),function(e){e.List="List",e.BitMask="BitMask",e.Boolean="Boolean",e.SensitivityLabelList="SensitivityLabelList"}(Ka||(Ka={})),function(e){e.ExternalFeed="ExternalFeed"}(Za||(Za={})),function(e){e.Interpretation="Interpretation"}(Xa||(Xa={})),function(e){e.PeopleSelection="PeopleSelection",e.PresenterSelection="PresenterSelection"}(eo||(eo={})),function(e){e.Google="Google"}(to||(to={})),function(e){e.TYPE="TYPE",e.TITLE="TITLE",e.MODIFIED="MODIFIED",e.SENTBY="SENTBY"}(no||(no={})),function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"}(io||(io={})),function(e){e.OrganizersAndPresentersOnly="OrganizersAndPresentersOnly",e.OrganizerAndCoOrganizersOnly="OrganizerAndCoOrganizersOnly"}(ao||(ao={})),function(e){e.MostSevere="MostSevere",e.Live="Live",e.Severe="Severe",e.Positive="Positive",e.Neutral="Neutral"}(oo||(oo={})),function(e){e.Audio="Audio",e.Video="Video"}(ro||(ro={})),function(e){e.Success="Success",e.Retrying="Retrying",e.SendFailure="SendFailure",e.SendFailureCanRetry="SendFailureCanRetry",e.EditFailure="EditFailure",e.EditFailureCanRetry="EditFailureCanRetry",e.DeleteSingleFailure="DeleteSingleFailure",e.DeleteSingleFailureCanRetry="DeleteSingleFailureCanRetry",e.DeleteAllFailure="DeleteAllFailure",e.DeleteAllFailureCanRetry="DeleteAllFailureCanRetry"}(so||(so={})),function(e){e.IMAGE="IMAGE",e.DOCUMENT="DOCUMENT"}(lo||(lo={})),function(e){e.UNKNOWN="UNKNOWN",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(co||(co={})),function(e){e.Anonymous="Anonymous",e.Aad="Aad",e.Msa="Msa",e.MsaLife="MsaLife",e.GFed="GFed",e.Otp="Otp"}(uo||(uo={})),function(e){e.dod="dod",e.gcch="gcch",e.life="life",e.prod="prod"}(mo||(mo={})),function(e){e.Member="Member",e.Anonymous="Anonymous",e.Guest="Guest"}(go||(go={})),function(e){e.Default="Default",e.Mto="Mto"}(po||(po={})),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting"}(vo||(vo={})),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting",e.LicenseError="LicenseError",e.SignInRestriction="SignInRestriction",e.UnRedeemed="UnRedeemed",e.LoginError="LoginError",e.Unknown="Unknown"}(ho||(ho={})),function(e){e.QuickStart="QuickStart",e.BYOE="BYOE",e.QuickStartPushToStream="QuickStartPushToStream",e.Slowlane="Slowlane",e.Overflow="Overflow"}(fo||(fo={})),function(e){e.AttendeeAvailabilityOnly="AttendeeAvailabilityOnly",e.SuggestedTimesOnly="SuggestedTimesOnly",e.Both="Both"}(yo||(yo={})),function(e){e.Excellent="Excellent",e.Good="Good",e.Fair="Fair",e.Poor="Poor",e.Unknown="Unknown"}(ko||(ko={})),function(e){e.Scheduled="Scheduled",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(So||(So={})),function(e){e.Email="Email",e.MeetingInvite="MeetingInvite"}(bo||(bo={})),function(e){e.Document="Document",e.Message="Message"}(Co||(Co={})),function(e){e.SharePoint="SharePoint",e.OneDriveBusiness="OneDriveBusiness",e.Exchange="Exchange"}(wo||(wo={})),function(e){e.Implicit="Implicit",e.Explicit="Explicit"}(No||(No={})),function(e){e.HEADER="HEADER",e.MAIN="MAIN"}(To||(To={})),function(e){e.Blocking="Blocking",e.Global="Global",e.Component="Component"}(Io||(Io={})),function(e){e.attendees="attendees",e.bodyContent="bodyContent",e.bodyContentType="bodyContentType",e.categories="categories",e.cleanGlobalObjectId="cleanGlobalObjectId",e.clientOptimisticEventId="clientOptimisticEventId",e.contextId="contextId",e.doNotForward="doNotForward",e.endTime="endTime",e.eventTimeZone="eventTimeZone",e.eventType="eventType",e.iCalUid="iCalUid",e.isAllDayEvent="isAllDayEvent",e.isCancelled="isCancelled",e.isOnlineMeeting="isOnlineMeeting",e.isOrganizer="isOrganizer",e.isPrivate="isPrivate",e.isReminderSet="isReminderSet",e.isResponseRequested="isResponseRequested",e.joinOnlineMeetingUrl="joinOnlineMeetingUrl",e.lastModifiedTime="lastModifiedTime",e.location="location",e.mailboxAddress="mailboxAddress",e.meetingAgenda="meetingAgenda",e.myResponseType="myResponseType",e.objectId="objectId",e.onlineMeetingConfLink="onlineMeetingConfLink",e.onlineMeetingConferenceId="onlineMeetingConferenceId",e.onlineMeetingTollFreeNumbers="onlineMeetingTollFreeNumbers",e.onlineMeetingTollNumber="onlineMeetingTollNumber",e.organizerAddress="organizerAddress",e.organizerName="organizerName",e.reminderMinutesBeforeStart="reminderMinutesBeforeStart",e.schedulingServiceUpdateUrl="schedulingServiceUpdateUrl",e.seriesMasterId="seriesMasterId",e.showAs="showAs",e.skypeTeamsData="skypeTeamsData",e.skypeTeamsMeetingUrl="skypeTeamsMeetingUrl",e.startTime="startTime",e.subject="subject",e.teamsVtcTenantId="teamsVtcTenantId"}(Eo||(Eo={})),function(e){e.Block="Block",e.Unblock="Unblock"}(Ao||(Ao={})),function(e){e.Done="Done",e.Error="Error",e.ErrorTooManyCharacters="ErrorTooManyCharacters",e.InProcess="InProcess"}(_o||(_o={})),function(e){e.Url="Url",e.Text="Text"}(Do||(Do={})),function(e){e.SINGLEACCOUNT="SINGLEACCOUNT",e.MULTIPLEACCOUNTS="MULTIPLEACCOUNTS"}(Fo||(Fo={})),function(e){e.Exchange="Exchange",e.OneDriveBusiness="OneDriveBusiness",e.SharePoint="SharePoint"}(Mo||(Mo={})),function(e){e.TEAMS="TEAMS",e.SHAREPOINT="SHAREPOINT"}(Ro||(Ro={})),function(e){e.PROGRESS="PROGRESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.CONFLICT="CONFLICT",e.COMPLETE="COMPLETE"}(Po||(Po={})),function(e){e.view="view",e.review="review",e.edit="edit",e.embed="embed"}(Oo||(Oo={})),function(e){e.anonymous="anonymous",e.organization="organization",e.users="users"}(xo||(xo={})),function(e){e.File="File",e.Folder="Folder"}(Lo||(Lo={})),function(e){e.chat="chat",e.team="team",e.channel="channel",e.recipient="recipient"}(Uo||(Uo={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.READY="READY",e.NO_CONTENT="NO_CONTENT",e.FAILED="FAILED",e.PERMANENTLY_FAILED="PERMANENTLY_FAILED",e.NONE="NONE"}(Bo||(Bo={})),function(e){e.DASH="DASH",e.DASH_ABR="DASH_ABR"}(jo||(jo={})),function(e){e.READY="READY",e.FAILED="FAILED",e.INPROGRESS="INPROGRESS"}(Wo||(Wo={})),function(e){e.LoadedMetadata="LoadedMetadata",e.LoadStart="LoadStart",e.LoadedData="LoadedData",e.Start="Start",e.Ready="Ready",e.Play="Play",e.Playing="Playing",e.Paused="Paused",e.Buffering="Buffering",e.Seeking="Seeking",e.Seeked="Seeked",e.Ended="Ended",e.Error="Error",e.Destroyed="Destroyed",e.Initialized="Initialized",e.Resume="Resume"}(Vo||(Vo={})),function(e){e.UnsupportedPlatform="UnsupportedPlatform",e.NetworkError="NetworkError",e.PlaybackRetried="PlaybackRetried",e.PlaybackError="PlaybackError",e.Unknown="Unknown"}(Ho||(Ho={})),function(e){e.AzureMediaPlayer="AzureMediaPlayer",e.HttpLiveStreamingPlayer="HttpLiveStreamingPlayer"}($o||($o={})),function(e){e.Townhall="Townhall",e.OverflowV1="OverflowV1",e.OverflowV2="OverflowV2",e.TLE="TLE",e.Overflow="Overflow"}(zo||(zo={})),function(e){e.BCP="BCP"}(Go||(Go={})),function(e){e.TeamSummariesAvailable="TeamSummariesAvailable",e.NoTeamsAvailable="NoTeamsAvailable",e.DefaultError="DefaultError"}(qo||(qo={})),function(e){e.MembersAndOwnersAvailable="MembersAndOwnersAvailable",e.NoMembersAndOwnersAvailable="NoMembersAndOwnersAvailable",e.NoGroupsAvailable="NoGroupsAvailable",e.MembersAndOwnersLimitExceeded="MembersAndOwnersLimitExceeded",e.ApiDisabled="ApiDisabled",e.DefaultError="DefaultError"}(Qo||(Qo={})),function(e){e.Recent="Recent",e.Recommended="Recommended",e.Upcoming="Upcoming"}(Jo||(Jo={})),function(e){e.accepted="accepted",e.tentative="tentative",e.declined="declined",e.notResponded="notResponded",e.organizer="organizer"}(Yo||(Yo={})),function(e){e.mentions="mentions",e.tasks="tasks"}(Ko||(Ko={})),function(e){e.allDeclined="allDeclined",e.outOfWorkingHours="outOfWorkingHours",e.conflictWithOtherMeeting="conflictWithOtherMeeting",e.beingInvited="beingInvited",e.hasNotResponded="hasNotResponded",e.rsvpStatus="rsvpStatus",e.noIssue="noIssue",e.meetingCancelled="meetingCancelled",e.missed="missed",e.joinLate="joinLate",e.leaveEarly="leaveEarly",e.mentioned="mentioned",e.mentionedWithMissed="mentionedWithMissed",e.mentionedBeforeJoined="mentionedBeforeJoined",e.mentionedAfterLeft="mentionedAfterLeft"}(Zo||(Zo={})),function(e){e.join="join",e.runningLate="runningLate",e.sendReminderToUser="sendReminderToUser",e.rsvp="rsvp",e.proposeNewTime="proposeNewTime",e.recordMeeting="recordMeeting",e.removeFromCalendar="removeFromCalendar",e.reschedule="reschedule",e.sendReminderToAttendees="sendReminderToAttendees",e.openMeetingChat="openMeetingChat",e.sendRecordingRequest="sendRecordingRequest"}(Xo||(Xo={})),function(e){e.call="call",e.calendar="calendar"}(er||(er={})),function(e){e.Daily="Daily",e.Weekly="Weekly",e.Monthly="Monthly",e.Yearly="Yearly"}(tr||(tr={})),function(e){e.Sunday="Sunday",e.Monday="Monday",e.Tuesday="Tuesday",e.Wednesday="Wednesday",e.Thursday="Thursday",e.Friday="Friday",e.Saturday="Saturday"}(nr||(nr={})),function(e){e.EmptyState="EmptyState",e.InvalidQsp="InvalidQsp",e.NotOrganizer="NotOrganizer",e.MissingQsp="MissingQsp",e.PartialChange="PartialChange",e.CacheNotInitialized="CacheNotInitialized",e.Unknown="Unknown",e.NotFound="NotFound",e.BadStagingRoomConfig="BadStagingRoomConfig",e.BadForceAttendeeStreamingConfig="BadForceAttendeeStreamingConfig"}(ir||(ir={})),function(e){e.eq="eq"}(ar||(ar={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(or||(or={})),function(e){e.Idea="Idea",e.Survey="Survey",e.Frown="Frown",e.Smile="Smile"}(rr||(rr={})),function(e){e.Rating="Rating",e.Verbatim="Verbatim"}(sr||(sr={})),function(e){e.Petrol="Petrol",e.ODS="ODS"}(lr||(lr={})),function(e){e.Scheduled="Scheduled",e.InProgress="InProgress",e.Published="Published",e.Failed="Failed",e.Expired="Expired"}(dr||(dr={})),function(e){e.Webinar="Webinar",e.Conference="Conference",e.Townhall="Townhall"}(cr||(cr={})),function(e){e.Draft="Draft",e.Published="Published",e.Ended="Ended",e.Canceled="Canceled"}(ur||(ur={})),function(e){e.Public="Public",e.Private="Private"}(mr||(mr={})),function(e){e.Attendee="Attendee",e.CoOrganizer="CoOrganizer",e.Presenter="Presenter",e.Organizer="Organizer"}(gr||(gr={})),function(e){e.Daily="Daily",e.Weekly="Weekly",e.AbsoluteMonthly="AbsoluteMonthly",e.RelativeMonthly="RelativeMonthly",e.AbsoluteYearly="AbsoluteYearly",e.RelativeYearly="RelativeYearly"}(pr||(pr={})),function(e){e.Standard="Standard",e.Predefined="Predefined",e.UserCreated="UserCreated"}(vr||(vr={})),function(e){e.Text="Text",e.Note="Note",e.SingleChoice="SingleChoice",e.MultiChoice="MultiChoice",e.Boolean="Boolean",e.PromoEmailConsent="PromoEmailConsent"}(hr||(hr={})),function(e){e.ProcessingPendingApproval="ProcessingPendingApproval",e.ProcessingWaitlisting="ProcessingWaitlisting",e.Waitlisted="Waitlisted",e.PendingApproval="PendingApproval",e.ProcessingApproval="ProcessingApproval",e.ProcessingRejection="ProcessingRejection",e.Rejected="Rejected",e.PendingPayment="PendingPayment",e.ProcessingRegistration="ProcessingRegistration",e.Registered="Registered",e.ProcessingCancellation="ProcessingCancellation",e.Canceled="Canceled"}(fr||(fr={})),function(e){e.Approve="Approve",e.Reject="Reject"}(yr||(yr={})),function(e){e.AttendeeCancellation="AttendeeCancellation",e.AttendeeCancellationRequest="AttendeeCancellationRequest",e.AttendeePendingApproval="AttendeePendingApproval",e.AttendeeRegisterAfterWaitlist="AttendeeRegisterAfterWaitlist",e.AttendeeRegistration="AttendeeRegistration",e.AttendeeRejection="AttendeeRejection",e.AttendeeWaitlisting="AttendeeWaitlisting",e.EventCancellation="EventCancellation",e.EventDateTimeUpdate="EventDateTimeUpdate",e.EventAttendeeReminder="EventAttendeeReminder",e.EventInvite="EventInvite",e.EventRecording="EventRecording"}(kr||(kr={})),function(e){e.Draft="Draft",e.Active="Active",e.ProcessingCancellation="ProcessingCancellation",e.Canceled="Canceled"}(Sr||(Sr={})),function(e){e.Organizer="Organizer",e.Presenter="Presenter",e.Attendee="Attendee"}(br||(br={})),function(e){e.DateTime="DateTime",e.Location="Location",e.Description="Description",e.Speaker="Speaker",e.Questionnaire="Questionnaire"}(Cr||(Cr={})),function(e){e.slot="slot",e.page="page"}(wr||(wr={})),function(e){e.horizontal="horizontal",e.vertical="vertical"}(Nr||(Nr={})),function(e){e.alert_inline="alert_inline",e.alert_banner="alert_banner",e.button="button",e.dropdown="dropdown",e.openWindowsNotificationSettings="openWindowsNotificationSettings",e.subPage="subPage",e.text="text",e.toggle="toggle",e.compoundButton="compoundButton",e.checkbox="checkbox",e.resetButton="resetButton"}(Tr||(Tr={})),function(e){e.mutation="mutation",e.navigation="navigation",e.external_navigation="external_navigation"}(Ir||(Ir={})),function(e){e.ToastSettings="ToastSettings",e.ActivityGenerationSettings="ActivityGenerationSettings",e.SoundsSettings="SoundsSettings",e.EmailSettings="EmailSettings",e.selectedPreset="selectedPreset"}(Er||(Er={})),function(e){e.DLP="DLP"}(Ar||(Ar={})),function(e){e.teamAvatar="teamAvatar",e.staticImage="staticImage",e.imageUrl="imageUrl",e.default="default"}(_r||(_r={})),function(e){e.DEFAULT="DEFAULT",e.CHANNEL="CHANNEL"}(Dr||(Dr={})),function(e){e.ThumbsUp="ThumbsUp",e.ThumbsDown="ThumbsDown",e.RecallFeedback="RecallFeedback",e.Accept="Accept",e.Reject="Reject",e.Edit="Edit",e.Delete="Delete",e.Done="Done",e.AssignOwner="AssignOwner",e.AssignDueDate="AssignDueDate",e.EditNotes="EditNotes",e.CreateCRM="CreateCRM",e.OpenEmail="OpenEmail"}(Fr||(Fr={})),function(e){e.Add="Add",e.Edit="Edit",e.Delete="Delete"}(Mr||(Mr={})),function(e){e.OneStar="OneStar",e.TwoStars="TwoStars",e.ThreeStars="ThreeStars",e.FourStars="FourStars",e.FiveStars="FiveStars"}(Rr||(Rr={})),function(e){e.MostRecent="MostRecent",e.HighestRating="HighestRating",e.LowestRating="LowestRating"}(Pr||(Pr={})),function(e){e.All="All",e.G2="G2",e.Teams="Teams",e.AppSource="AppSource"}(Or||(Or={})),function(e){e.OffensiveContent="OffensiveContent",e.SpamAndAdvertising="SpamAndAdvertising",e.InvalidReview="InvalidReview",e.Other="Other"}(xr||(xr={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector"}(Lr||(Lr={})),function(e){e.NotInstalled="NotInstalled",e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured",e.PreConsented="PreConsented",e.AdminPreInstalled="AdminPreInstalled",e.RequireConsent="RequireConsent"}(Ur||(Ur={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced"}(Br||(Br={})),function(e){e.Open="Open",e.Close="Close",e.Result="Result",e.Cancel="Cancel"}(jr||(jr={})),function(e){e.MRU="MRU",e.AlphabeticalAsc="AlphabeticalAsc",e.AlphabeticalDesc="AlphabeticalDesc"}(Wr||(Wr={})),function(e){e.PROGRESS="PROGRESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.COMPLETE="COMPLETE"}(Vr||(Vr={})),function(e){e.Network_Only="Network_Only",e.Cache_First="Cache_First",e.Cache_Only="Cache_Only",e.Network_Debounce="Network_Debounce"}(Hr||(Hr={})),function(e){e.default="default",e.dark="dark",e.highContrast="highContrast"}($r||($r={})),function(e){e.edit="edit",e.send="send"}(zr||(zr={})),function(e){e.list="list",e.grid="grid"}(Gr||(Gr={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview",e.silentAuth="silentAuth"}(qr||(qr={})),function(e){e.auth="auth",e.config="config"}(Qr||(Qr={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox"}(Jr||(Jr={})),function(e){e.StringAuthResult="StringAuthResult",e.JsonAuthResult="JsonAuthResult"}(Yr||(Yr={})),function(e){e.NoMatch="NoMatch",e.MatchButNotInstalled="MatchButNotInstalled",e.MatchButNeedAuthOrConfig="MatchButNeedAuthOrConfig",e.MatchAndPendingFetch="MatchAndPendingFetch",e.HasResult="HasResult",e.Failed="Failed"}(Kr||(Kr={})),function(e){e.NoCache="NoCache"}(Zr||(Zr={})),function(e){e.Thumbnail="Thumbnail",e.Card="Card",e.Permission="Permission"}(Xr||(Xr={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.RecurringMaster="RecurringMaster",e.Exception="Exception"}(es||(es={})),function(e){e.Invitee="Invitee",e.ChatMember="ChatMember",e.TeamMember="TeamMember",e.GroupMember="GroupMember"}(ts||(ts={})),function(e){e.AGENDA_VIEW_EVENTS="AGENDA_VIEW_EVENTS",e.AGENDA_VIEW_EMPTY_PAGE="AGENDA_VIEW_EMPTY_PAGE",e.AGENDA_VIEW_ERROR_PAGE="AGENDA_VIEW_ERROR_PAGE"}(ns||(ns={})),function(e){e.Success="Success",e.Failure="Failure",e.Abandoned="Abandoned",e.Incomplete="Incomplete"}(is||(is={})),function(e){e.New="New",e.Update="Update"}(as||(as={})),function(e){e.Sending="Sending",e.TeacherChatMessageSent="TeacherChatMessageSent",e.ChatCreationSuccess="ChatCreationSuccess",e.ChatCreationFailed="ChatCreationFailed",e.MessageForwardingFailed="MessageForwardingFailed",e.MessageForwardingPartiallyFailed="MessageForwardingPartiallyFailed"}(os||(os={})),function(e){e.Success_TeacherChatMessageSent="Success_TeacherChatMessageSent",e.Success_ChatCreation="Success_ChatCreation",e.Failed_ChatCreation="Failed_ChatCreation",e.Success_MessageForwarding="Success_MessageForwarding",e.Partial_MessageForwarding="Partial_MessageForwarding",e.Failed_MessageForwarding="Failed_MessageForwarding"}(rs||(rs={})),function(e){e.Forward="Forward",e.Backward="Backward"}(ss||(ss={})),function(e){e.unread="unread",e.meeting="meeting",e.muted="muted",e.chats="chats"}(ls||(ls={})),function(e){e.like="like",e.star="star",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry",e.acks="acks"}(ds||(ds={})),function(e){e.add="add",e.remove="remove"}(cs||(cs={})),function(e){e.add="add",e.remove="remove"}(us||(us={})),function(e){e.Translate="Translate",e.Untranslate="Untranslate"}(ms||(ms={})),function(e){e.Create="Create",e.Update="Update"}(gs||(gs={})),function(e){e.OffensiveContent="OffensiveContent",e.Terrorism="Terrorism",e.ChildEndangermentExploitation="ChildEndangermentExploitation",e.ImminentHarmToPersonsOrProperty="ImminentHarmToPersonsOrProperty",e.ThreatsCyberbullyingHarassment="ThreatsCyberbullyingHarassment",e.VirusSpywareMalware="VirusSpywareMalware",e.Fraud="Fraud",e.ContentInfringement="ContentInfringement",e.HateSpeech="HateSpeech",e.Other="Other"}(ps||(ps={})),function(e){e.contact_request="contact_request",e.delete_contact="delete_contact",e.block_contact="block_contact",e.profile="profile",e.message="message",e.highlight="highlight",e.search="search",e.profile_image="profile_image"}(vs||(vs={})),function(e){e.CopilotChatFeedback="CopilotChatFeedback",e.CopilotChatReportHarm="CopilotChatReportHarm"}(hs||(hs={})),function(e){e.White="White",e.Yellow="Yellow",e.Blue="Blue",e.Green="Green"}(fs||(fs={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(ys||(ys={})),function(e){e.Top="Top",e.Bottom="Bottom"}(ks||(ks={})),function(e){e.Smaller="Smaller",e.Small="Small",e.Medium="Medium",e.Large="Large",e.Larger="Larger"}(Ss||(Ss={})),function(e){e.MeetingId="MeetingId",e.MeetingJoinUrl="MeetingJoinUrl",e.GroupChatId="GroupChatId"}(bs||(bs={})),function(e){e.Guest="Guest",e.Presenter="Presenter",e.Attendee="Attendee",e.Organizer="Organizer"}(Cs||(Cs={})),function(e){e.Added="Added",e.AlreadyExists="AlreadyExists",e.Conflict="Conflict",e.NotFound="NotFound"}(ws||(ws={})),function(e){e.AAD="AAD",e.Skype="Skype",e.SkypeEnterprise="SkypeEnterprise"}(Ns||(Ns={})),function(e){e.confirm="confirm",e.revert="revert",e.dismiss="dismiss"}(Ts||(Ts={})),function(e){e.Close="Close",e.Sync="Sync"}(Is||(Is={})),function(e){e.NONE="NONE",e.LIKE="LIKE",e.UNLIKE="UNLIKE",e.MORE_LIKE_THIS="MORE_LIKE_THIS",e.LESS_LIKE_THIS="LESS_LIKE_THIS",e.CLICK="CLICK",e.SCROLL_START="SCROLL_START",e.BOUNCE="BOUNCE",e.VIEW="VIEW",e.READ="READ",e.NEVER_SHOW_AGAIN="NEVER_SHOW_AGAIN",e.CLEAR_EXPLICIT_FEEDBACK="CLEAR_EXPLICIT_FEEDBACK"}(Es||(Es={})),function(e){e.NONE="NONE",e.SYNC="SYNC",e.ANNOTATE="ANNOTATE",e.SYNC_NEXT="SYNC_NEXT",e.ANNOTATE_NEXT="ANNOTATE_NEXT"}(As||(As={})),function(e){e.UNKNOWN="UNKNOWN",e.POST_POPULARITY="POST_POPULARITY",e.AUTHOR_YOU_COLLABORATE_WITH="AUTHOR_YOU_COLLABORATE_WITH",e.CHANNEL_YOU_ENGAGE_WITH="CHANNEL_YOU_ENGAGE_WITH",e.AUTHOR_POPULARITY="AUTHOR_POPULARITY",e.CHANNEL_POPULARITY="CHANNEL_POPULARITY",e.CHANNEL_YOU_VISIT="CHANNEL_YOU_VISIT",e.AUTHOR_YOU_INTERACT_WITH="AUTHOR_YOU_INTERACT_WITH",e.ACTIVE_AUTHOR="ACTIVE_AUTHOR"}(_s||(_s={})),function(e){e.ACTOR_RELATIONSHIP="ACTOR_RELATIONSHIP",e.CONTAINER="CONTAINER"}(Ds||(Ds={})),function(e){e.GLOBAL="GLOBAL",e.TEAMS_FEED="TEAMS_FEED"}(Fs||(Fs={})),function(e){e.EXCLUDE="EXCLUDE",e.INCLUDE="INCLUDE"}(Ms||(Ms={})),function(e){e.UNKNOWN="UNKNOWN",e.DOCUMENT_LAST_MODIFIED_BY="DOCUMENT_LAST_MODIFIED_BY",e.SHARED_BY="SHARED_BY",e.AUTHOR="AUTHOR",e.COMMENT_ON="COMMENT_ON",e.MENTION="MENTION",e.REQUESTOR="REQUESTOR",e.SENDER="SENDER",e.ANY="ANY"}(Rs||(Rs={})),function(e){e.TooManyMembers="TooManyMembers",e.ErrorFetchingData="ErrorFetchingData"}(Ps||(Ps={})),function(e){e.Undefined="Undefined",e.DefaultOrganizationExists="DefaultOrganizationExists",e.TenantGeoIsNotSupported="TenantGeoIsNotSupported",e.TeamsRingIsNotSupported="TeamsRingIsNotSupported",e.InProgress="InProgress",e.Failed="Failed",e.Conflict="Conflict",e.InternalError="InternalError"}(Os||(Os={})),function(e){e.Coachmark="Coachmark",e.Modal="Modal",e.Notification="Notification",e.Iris="Iris",e.QuickGuide="QuickGuide"}(xs||(xs={})),function(e){e.AppReady="AppReady",e.Manual="Manual",e.Daily="Daily",e.BIEvent="BIEvent",e.FollowUp="FollowUp"}(Ls||(Ls={})),function(e){e.notLocalized="notLocalized",e.localized="localized"}(Us||(Us={})),function(e){e.above="above",e.below="below",e.before="before",e.after="after"}(Bs||(Bs={})),function(e){e.bottom="bottom",e.top="top",e.start="start",e.end="end",e.center="center"}(js||(js={})),function(e){e.none="none",e.inline="inline",e.banner="banner"}(Ws||(Ws={})),function(e){e.close="close",e.openFollowUpSurface="openFollowUpSurface",e.navigateToUrl="navigateToUrl",e.navigateWithEntityCommand="navigateWithEntityCommand",e.navigateWithDeeplink="navigateWithDeeplink"}(Vs||(Vs={})),function(e){e.httpGet="httpGet"}(Hs||(Hs={})),function(e){e.Google="Google"}($s||($s={})),function(e){e.TeamsFreemium="TeamsFreemium",e.TflCloudCache="TflCloudCache"}(zs||(zs={})),function(e){e.Documents="Documents",e.Photos="Photos",e.Cameraroll="Cameraroll",e.Approot="Approot",e.Music="Music",e.Meetings="Meetings"}(Gs||(Gs={})),function(e){e.AccessDenied="AccessDenied",e.BadRequest="BadRequest",e.InvalidArgument="InvalidArgument",e.InvalidBackendResponse="InvalidBackendResponse",e.UserProfileNotFound="UserProfileNotFound",e.Unknown="Unknown"}(qs||(qs={})),function(e){e.BadRequest="BadRequest",e.MembersNotFound="MembersNotFound",e.MembersAndRelatedContactsPartialSuccess="MembersAndRelatedContactsPartialSuccess",e.InvalidBackendResponse="InvalidBackendResponse",e.CallerIsNotGroupOwner="CallerIsNotGroupOwner",e.Unknown="Unknown"}(Qs||(Qs={})),function(e){e.Active="Active",e.Inactive="Inactive"}(Js||(Js={})),function(e){e.FailedToFetchRelatedContacts="FailedToFetchRelatedContacts",e.RelatedContactsNotFound="RelatedContactsNotFound",e.BadRequest="BadRequest",e.InvalidBackendResponse="InvalidBackendResponse",e.InvalidCallerOrGroup="InvalidCallerOrGroup",e.InvalidUserOrGroup="InvalidUserOrGroup",e.Unknown="Unknown"}(Ys||(Ys={})),function(e){e.GENERIC="GENERIC",e.LINK_EXPIRED="LINK_EXPIRED",e.LINK_NOT_FOUND="LINK_NOT_FOUND",e.LINK_INVALID_FORMAT="LINK_INVALID_FORMAT",e.MSA_PHONE_MISMATCH="MSA_PHONE_MISMATCH",e.MSA_PHONES_MISSING_INVALID="MSA_PHONES_MISSING_INVALID"}(Ks||(Ks={})),function(e){e.Thread="Thread",e.User="User"}(Zs||(Zs={})),function(e){e.comfy="comfy",e.compact="compact"}(Xs||(Xs={})),function(e){e.on="on",e.off="off",e.notSet="notSet"}(el||(el={})),function(e){e.closed="closed",e.hidden="hidden",e.open="open"}(tl||(tl={})),function(e){e.light="light",e.dark="dark",e.contrast="contrast"}(nl||(nl={})),function(e){e.tflGroupTemplatesHidden="tflGroupTemplatesHidden",e.tflMeetingChicletPrivacyNoticeSettings="tflMeetingChicletPrivacyNoticeSettings",e.prejoinSettings="prejoinSettings",e.coachSettings="coachSettings",e.streamingSettings="streamingSettings",e.channelInfoPaneSettings="channelInfoPaneSettings",e.chatInfoPaneSettings="chatInfoPaneSettings",e.audienceViewSettings="audienceViewSettings",e.newChatDraft="newChatDraft",e.mtmaAppBannerSettings="mtmaAppBannerSettings"}(il||(il={})),function(e){e.animation="animation",e.density="density",e.flyoutCamera="flyoutCamera",e.infoPane="infoPane",e.performance="performance",e.appSwitcher="appSwitcher",e.theme="theme",e.videoEffect="videoEffect",e.backgroundEffect="backgroundEffect",e.promo="promo",e.avatar="avatar",e.teamLayout="teamLayout",e.diagnosticsLogs="diagnosticsLogs"}(al||(al={})),function(e){e.normal="normal",e.low="low"}(ol||(ol={})),function(e){e.RECENT="RECENT",e.UPCOMING="UPCOMING"}(rl||(rl={})),function(e){e.InProgress="InProgress",e.Error="Error",e.Success="Success"}(sl||(sl={})),function(e){e.ALL_DECLINED="ALL_DECLINED",e.OUT_OF_WORKING_HOURS="OUT_OF_WORKING_HOURS",e.CONFLICT_WITH_OTHER_MEETING="CONFLICT_WITH_OTHER_MEETING",e.BEING_INVITED="BEING_INVITED",e.HAS_NOT_RESPONDED="HAS_NOT_RESPONDED",e.RSVP_STATUS="RSVP_STATUS",e.NO_ISSUE="NO_ISSUE",e.MEETING_CANCELLED="MEETING_CANCELLED",e.MISSED="MISSED",e.JOIN_LATE="JOIN_LATE",e.LEAVE_EARLY="LEAVE_EARLY",e.MENTIONED="MENTIONED",e.MENTIONED_WITH_MISSED="MENTIONED_WITH_MISSED",e.MENTIONED_BEFORE_JOINED="MENTIONED_BEFORE_JOINED",e.MENTIONED_AFTER_LEFT="MENTIONED_AFTER_LEFT"}(ll||(ll={})),function(e){e.JOIN="JOIN",e.RUNNING_LATE="RUNNING_LATE",e.RSVP="RSVP",e.PROPOSE_NEW_TIME="PROPOSE_NEW_TIME",e.RECORD_MEETING="RECORD_MEETING",e.REMOVE_FROM_CALENDAR="REMOVE_FROM_CALENDAR",e.RESCHEDULE="RESCHEDULE",e.SEND_REMINDER_TO_ATTENDEES="SEND_REMINDER_TO_ATTENDEES",e.OPEN_MEETING_CHAT="OPEN_MEETING_CHAT",e.SEND_RECORDING_REQUEST="SEND_RECORDING_REQUEST"}(dl||(dl={})),function(e){e.ALL="ALL",e.CONTENT="CONTENT",e.MISSED="MISSED",e.MENTIONED="MENTIONED",e.RECORDED="RECORDED"}(cl||(cl={})),function(e){e.Streaming="Streaming",e.RealTime="RealTime"}(ul||(ul={})),function(e){e.ClientTeamsDesktop="ClientTeamsDesktop",e.ClientTeamsMobile="ClientTeamsMobile",e.ClientTeamsWeb="ClientTeamsWeb",e.RoomDeviceAll="RoomDeviceAll",e.RoomDeviceMicrosoftTeamsRoom="RoomDeviceMicrosoftTeamsRoom",e.RoomDeviceMeetingRoomCVI="RoomDeviceMeetingRoomCVI",e.RoomDeviceMeetingRoomDGJ="RoomDeviceMeetingRoomDGJ",e.PSTN="PSTN",e.Other="Other"}(ml||(ml={})),function(e){e.consenttorecording="consenttorecording",e.denyconsenttorecording="denyconsenttorecording",e.autoconsenttorecording="autoconsenttorecording",e.implicitconsenttorecording="implicitconsenttorecording",e.unknown="unknown"}(gl||(gl={})),function(e){e.Organizer="Organizer",e.CoOrganizer="CoOrganizer",e.Attendee="Attendee",e.Unknown="Unknown"}(pl||(pl={})),function(e){e.RecordingAndTranscript="RecordingAndTranscript",e.Recording="Recording",e.Transcript="Transcript",e.None="None"}(vl||(vl={})),function(e){e.Successful="Successful",e.UnknownStatus="UnknownStatus",e.InternalServerError="InternalServerError",e.WaitingPermissionPropagation="WaitingPermissionPropagation",e.NotFoundRecordingFile="NotFoundRecordingFile",e.NotFoundPremiumLicense="NotFoundPremiumLicense",e.ServiceThrottling="ServiceThrottling",e.UnsupportedAPIArguments="UnsupportedAPIArguments"}(hl||(hl={})),function(e){e.LostProcessingResult="LostProcessingResult",e.UnknownProcessingResult="UnknownProcessingResult",e.NotInitialized="NotInitialized",e.NotInitializedWithinSLA="NotInitializedWithinSLA",e.LostSomeHighLevelSummaries="LostSomeHighLevelSummaries",e.NotProcessedMissingLicense="NotProcessedMissingLicense",e.TakingTooLong="TakingTooLong",e.InitializedError="InitializedError",e.ProcessedSuccessfully="ProcessedSuccessfully",e.ProcessedWithError="ProcessedWithError",e.NotRequested="NotRequested",e.NotProcessedMissingTranscript="NotProcessedMissingTranscript",e.NotProcessedFeatureNotAvailable="NotProcessedFeatureNotAvailable",e.NotProcessedTranscriptTooShort="NotProcessedTranscriptTooShort",e.NotProcessedNonEnglishTranscript="NotProcessedNonEnglishTranscript",e.AttendanceReportRedacted="AttendanceReportRedacted",e.NotFoundPremiumLicense="NotFoundPremiumLicense"}(fl||(fl={})),function(e){e.AttendanceReportNodata="AttendanceReportNodata",e.AttendanceReportV3="AttendanceReportV3",e.AttendanceReportWebinar="AttendanceReportWebinar",e.RegistrationReportWebinar="RegistrationReportWebinar",e.AttendanceReportV3Overflow="AttendanceReportV3Overflow",e.AttendanceReportV3Breakoutroom="AttendanceReportV3Breakoutroom",e.AttendanceReportVirtualEvent="AttendanceReportVirtualEvent",e.RegistrationReportVirtualEvent="RegistrationReportVirtualEvent"}(yl||(yl={})),function(e){e.MeetingQuestions="MeetingQuestions",e.MeetingPrivateQuestions="MeetingPrivateQuestions",e.MeetingAnswers="MeetingAnswers",e.MeetingPrivateAnswers="MeetingPrivateAnswers"}(kl||(kl={})),function(e){e.Chat="Chat",e.Channel="Channel"}(Sl||(Sl={})),function(e){e.call="call",e.mention="mention",e.chat="chat",e.channel="channel",e.other="other"}(bl||(bl={})),function(e){e.notifications_x_days_of_inactive_status="notifications_x_days_of_inactive_status"}(Cl||(Cl={})),function(e){e.AuthError="AuthError",e.Offline="Offline",e.ConnectedAccountError="ConnectedAccountError",e.SettingsWarnUser="SettingsWarnUser",e.UnsupportedAppVersionDetected="UnsupportedAppVersionDetected"}(wl||(wl={})),function(e){e.Success="Success",e.Warning="Warning",e.Error="Error",e.Info="Info",e.InfoAvatar="InfoAvatar"}(Nl||(Nl={})),function(e){e.SearchSuggestions="SearchSuggestions",e.SearchResults="SearchResults",e.AddToChat="AddToChat",e.AddToTeam="AddToTeam",e.NewChat="NewChat",e.Transfer="Transfer",e.AddToCall="AddToCall",e.CallRouting="CallRouting",e.CallForwardGroupSelection="CallForwardGroupSelection",e.DelegationSelection="DelegationSelection",e.PresenceSettings="PresenceSettings",e.AddToMeeting="AddToMeeting",e.MeetingSchedule="MeetingSchedule",e.AddToSpeedDialOrContacts="AddToSpeedDialOrContacts",e.AtMention="AtMention",e.OrgChart="OrgChart",e.PriorityContactsSelection="PriorityContactsSelection",e.TaggedContactsSelection="TaggedContactsSelection",e.StatusNote="StatusNote",e.VoicemailTransferTarget="VoicemailTransferTarget",e.SearchExpoDisplays="SearchExpoDisplays",e.AllFalse="AllFalse",e.AllTrue="AllTrue",e.MeetingRoomCall="MeetingRoomCall"}(Tl||(Tl={})),function(e){e.open="open",e.cancelled="cancelled",e.shared="shared",e.error="error"}(Il||(Il={})),function(e){e.Removed="Removed",e.Updated="Updated"}(El||(El={})),function(e){e.GlobalPrepinned="GlobalPrepinned",e.UserPinned="UserPinned"}(Al||(Al={})),function(e){e.pdf="pdf",e.xls="xls",e.xlsb="xlsb",e.xlsm="xlsm",e.xlsx="xlsx",e.csv="csv",e.doc="doc",e.docm="docm",e.docx="docx",e.dot="dot",e.dotm="dotm",e.dotx="dotx",e.pot="pot",e.potm="potm",e.potx="potx",e.pps="pps",e.ppsm="ppsm",e.ppsx="ppsx",e.ppt="ppt",e.pptm="pptm",e.pptx="pptx",e.vsd="vsd",e.vsdx="vsdx",e.one="one"}(_l||(_l={})),function(e){e.WhoBotTab="WhoBotTab",e.ExtensionTab="ExtensionTab",e.WebsiteTab="WebsiteTab",e.StaticExtensionTab="StaticExtensionTab"}(Dl||(Dl={})),function(e){e.QueryByThread="QueryByThread",e.QueryByApp="QueryByApp",e.QueryByMessage="QueryByMessage"}(Fl||(Fl={})),function(e){e.PrivateMeeting="PrivateMeeting",e.ChannelMeeting="ChannelMeeting",e.Channel="Channel",e.PrivateMeetingSchedulingForm="PrivateMeetingSchedulingForm",e.ChannelMeetingSchedulingForm="ChannelMeetingSchedulingForm"}(Ml||(Ml={})),function(e){e.returnFocus="returnFocus"}(Rl||(Rl={})),function(e){e.voiceAdminSettings="voiceAdminSettings"}(Pl||(Pl={})),function(e){e.voiceAdminSettings="voiceAdminSettings"}(Ol||(Ol={})),function(e){e.alwaysEnabled="alwaysEnabled",e.scheduled="scheduled",e.disabled="disabled"}(xl||(xl={})),function(e){e.none="none",e.contactsOnly="contactsOnly",e.all="all"}(Ll||(Ll={})),function(e){e.Private="Private",e.Shared="Shared",e.Recap="Recap",e.Chat="Chat"}(Ul||(Ul={})),function(e){e.PERSONCHAT="PERSONCHAT",e.GROUPCHAT="GROUPCHAT",e.QUERYSEARCH="QUERYSEARCH",e.POPOUTPERSONCHAT="POPOUTPERSONCHAT",e.POPOUTGROUPCHAT="POPOUTGROUPCHAT",e.REMOVESUGGESTION="REMOVESUGGESTION",e.ORGCHART="ORGCHART",e.TEAMNAVIGATION="TEAMNAVIGATION",e.CHANNELNAVIGATION="CHANNELNAVIGATION",e.FILENAVIGATION="FILENAVIGATION",e.JOINLINKDIALOG="JOINLINKDIALOG",e.GROUPCHATMEETING="GROUPCHATMEETING",e.CHANNELMEETING="CHANNELMEETING",e.TEAMMANAGETAGS="TEAMMANAGETAGS",e.SEARCHEXTERNAL="SEARCHEXTERNAL",e.DIALOGCLICK="DIALOGCLICK",e.PERSONLPC="PERSONLPC",e.PRIMARYDOMAIN="PRIMARYDOMAIN"}(Bl||(Bl={})),function(e){e.IMAGE="IMAGE",e.AVATAR="AVATAR",e.ICON="ICON"}(jl||(jl={})),function(e){e.GENERATED="GENERATED",e.INDEXEDDB="INDEXEDDB",e.INVITEFLOW="INVITEFLOW",e.SCD="SCD",e.HISTORY="HISTORY",e.MT="MT",e.SUBSTRATE="SUBSTRATE",e.TOPN="TOPN"}(Wl||(Wl={})),function(e){e.ADD="ADD",e.DELETE="DELETE",e.REMOVEALL="REMOVEALL"}(Vl||(Vl={})),function(e){e.CLEAR_SEARCHTEXT="CLEAR_SEARCHTEXT",e.DEACTIVATE="DEACTIVATE",e.REFETCH_SUGGESTIONS="REFETCH_SUGGESTIONS",e.REFETCH_SUGGESTIONS_WITH_ANIMATION="REFETCH_SUGGESTIONS_WITH_ANIMATION",e.SET_TITLE_AS_SEARCH_TEXT="SET_TITLE_AS_SEARCH_TEXT"}(Hl||(Hl={})),function(e){e.SEARCH="SEARCH",e.PERSON="PERSON",e.GROUPCHAT="GROUPCHAT",e.JOINLINK="JOINLINK"}($l||($l={})),function(e){e.PEOPLE="PEOPLE",e.GROUPCHATS="GROUPCHATS",e.SEARCHES="SEARCHES",e.HISTORY="HISTORY",e.SUGGESTED="SUGGESTED"}(zl||(zl={})),function(e){e.Suggestion="Suggestion",e.NoResultModification="NoResultModification",e.NoResultFolderRefinerModification="NoResultFolderRefinerModification",e.Modification="Modification",e.Extension="Extension",e.NoRequeryModification="NoRequeryModification"}(Gl||(Gl={})),function(e){e.Quorum="Quorum",e.OutOfRoutine="OutOfRoutine",e.Conflicts="Conflicts"}(ql||(ql={})),function(e){e.Attachment="Attachment",e.RelatedFile="RelatedFile",e.RelatedEmail="RelatedEmail",e.FileAttachment="FileAttachment",e.EmailAttachment="EmailAttachment",e.RecordingFile="RecordingFile",e.SharedFile="SharedFile"}(Ql||(Ql={})),function(e){e.AttachmentGroupType="AttachmentGroupType",e.RelatedEmailType="RelatedEmailType"}(Jl||(Jl={})),function(e){e.Relevance="Relevance",e.DateTime="DateTime"}(Yl||(Yl={})),function(e){e.Light="Light",e.Dark="Dark",e.Contrast="Contrast",e.OSTheme="OSTheme"}(Kl||(Kl={})),function(e){e.MouseEnter="MouseEnter",e.MouseLeave="MouseLeave",e.Click="Click"}(Zl||(Zl={})),function(e){e.Teams1="Teams1",e.Teams2="Teams2"}(Xl||(Xl={})),function(e){e.Personal="Personal",e.Business="Business",e.Neutral="Neutral",e.Mixed="Mixed",e.Unknown="Unknown"}(ed||(ed={})),function(e){e.None="None",e.PowerApp="PowerApp",e.Link="Link"}(td||(td={})),function(e){e.None="None",e.Promotion="Promotion",e.Certified="Certified",e.FirstParty="FirstParty",e.SecondParty="SecondParty"}(nd||(nd={})),function(e){e.Alphabetical="Alphabetical",e.Popularity="Popularity"}(id||(id={})),function(e){e.None="None",e.Bot="Bot",e.Certified="Certified",e.Connector="Connector",e.GroupChat="GroupChat",e.Team="Team",e.Meeting="Meeting",e.MessageExtension="MessageExtension",e.MessageExtensionComposeContext="MessageExtensionComposeContext",e.MessageExtensionCommandboxContext="MessageExtensionCommandboxContext",e.MessageExtensionMessageContext="MessageExtensionMessageContext",e.Personal="Personal",e.Tab="Tab",e.Blocked="Blocked",e.Available="Available",e.NoContextTeamTab="NoContextTeamTab",e.NoContextChatTab="NoContextChatTab",e.EducationContextTab="EducationContextTab",e.TrainingAndTutorialContextTab="TrainingAndTutorialContextTab",e.PersonalContextTab="PersonalContextTab",e.ChannelContextTab="ChannelContextTab",e.PrivateChatContextGroupChatScopeTab="PrivateChatContextGroupChatScopeTab",e.MeetingChatContextGroupChatScopeTab="MeetingChatContextGroupChatScopeTab",e.MeetingDetailsContextGroupChatScopeTab="MeetingDetailsContextGroupChatScopeTab",e.MeetingSidePanelContextGroupChatScopeTab="MeetingSidePanelContextGroupChatScopeTab",e.MeetingStageContextGroupChatScopeTab="MeetingStageContextGroupChatScopeTab",e.CallingSidePanelContextGroupChatScopeTab="CallingSidePanelContextGroupChatScopeTab",e.PrivateChatContextTeamScopeTab="PrivateChatContextTeamScopeTab",e.MeetingChatContextTeamScopeTab="MeetingChatContextTeamScopeTab",e.MeetingDetailsContextTeamScopeTab="MeetingDetailsContextTeamScopeTab",e.MeetingSidePanelContextTeamScopeTab="MeetingSidePanelContextTeamScopeTab",e.MeetingStageContextTeamScopeTab="MeetingStageContextTeamScopeTab",e.CallingSidePanelContextTeamScopeTab="CallingSidePanelContextTeamScopeTab",e.PersonalContextBot="PersonalContextBot",e.TeamContextBot="TeamContextBot",e.GroupChatContextBot="GroupChatContextBot",e.Free="Free",e.Paid="Paid",e.PublisherAttested="PublisherAttested",e.NoContextTeamStaticTab="NoContextTeamStaticTab",e.NoContextChatStaticTab="NoContextChatStaticTab",e.PersonalContextStaticTab="PersonalContextStaticTab",e.ChannelContextStaticTab="ChannelContextStaticTab",e.PrivateChatContextGroupChatScopeStaticTab="PrivateChatContextGroupChatScopeStaticTab",e.MeetingChatContextGroupChatScopeStaticTab="MeetingChatContextGroupChatScopeStaticTab",e.MeetingDetailsContextGroupChatScopeStaticTab="MeetingDetailsContextGroupChatScopeStaticTab",e.MeetingSidePanelContextGroupChatScopeStaticTab="MeetingSidePanelContextGroupChatScopeStaticTab",e.MeetingStageContextGroupChatScopeStaticTab="MeetingStageContextGroupChatScopeStaticTab",e.CallingSidePanelContextGroupChatScopeStaticTab="CallingSidePanelContextGroupChatScopeStaticTab",e.PrivateChatContextTeamScopeStaticTab="PrivateChatContextTeamScopeStaticTab",e.MeetingChatContextTeamScopeStaticTab="MeetingChatContextTeamScopeStaticTab",e.MeetingDetailsContextTeamScopeStaticTab="MeetingDetailsContextTeamScopeStaticTab",e.MeetingSidePanelContextTeamScopeStaticTab="MeetingSidePanelContextTeamScopeStaticTab",e.MeetingStageContextTeamScopeStaticTab="MeetingStageContextTeamScopeStaticTab",e.CallingSidePanelContextTeamScopeStaticTab="CallingSidePanelContextTeamScopeStaticTab",e.DisabledScopeForPrivateChannel="DisabledScopeForPrivateChannel"}(ad||(ad={})),function(e){e.Image="Image",e.Video="Video"}(od||(od={})),function(e){e.Channel="Channel",e.Chat="Chat",e.Document="Document",e.File="File",e.Message="Message",e.People="People",e.Team="Team",e.Text="Text"}(rd||(rd={})),function(e){e.AutoStart="AutoStart",e.OpenAppInBackground="OpenAppInBackground",e.KeepAppRunningOnClose="KeepAppRunningOnClose",e.DefaultImProvider="DefaultImProvider"}(sd||(sd={})),function(e){e.NotJoined="NotJoined",e.Joining="Joining",e.Joined="Joined",e.Pending="Pending"}(ld||(ld={})),function(e){e.CreateAndDeleteTab="CreateAndDeleteTab",e.CreateAndUpdateChannel="CreateAndUpdateChannel",e.EditMessagesEnabled="EditMessagesEnabled",e.DeleteMessagesEnabled="DeleteMessagesEnabled",e.AdminDeleteEnabled="AdminDeleteEnabled",e.InstallAndUninstallApps="InstallAndUninstallApps",e.UploadCustomApp="UploadCustomApp",e.DeleteChannel="DeleteChannel",e.CreatePrivateChannel="CreatePrivateChannel",e.UpdateConnectors="UpdateConnectors",e.GeneralChannelPosting="GeneralChannelPosting",e.TeamMention="TeamMention",e.ChannelMention="ChannelMention",e.GiphyEnabled="GiphyEnabled",e.GiphyRating="GiphyRating",e.StickersEnabled="StickersEnabled",e.CustomMemesEnabled="CustomMemesEnabled",e.AddAndRemoveDisplayContent="AddAndRemoveDisplayContent"}(dd||(dd={})),function(e){e.ClassTeamsSection="ClassTeamsSection",e.HiddenTeamsSection="HiddenTeamsSection",e.OtherTeamsSection="OtherTeamsSection"}(cd||(cd={})),function(e){e.Sent="Sent",e.Pending="Pending",e.Declined="Declined",e.Revoked="Revoked",e.Validating="Validating",e.Approved="Approved"}(ud||(ud={})),function(e){e.XTAP="XTAP",e.IB="IB",e.None="None"}(md||(md={})),function(e){e.Queued="Queued",e.InProgress="InProgress",e.Compliant="Compliant",e.NonCompliant="NonCompliant",e.Failed="Failed",e.FailedTemporarily="FailedTemporarily"}(gd||(gd={})),function(e){e.ChannelAlreadySharedWithTeam="ChannelAlreadySharedWithTeam",e.SensitivityLabelMismatchValidationFailure="SensitivityLabelMismatchValidationFailure",e.SensitivityLabelPrivacyLevelValidationFailure="SensitivityLabelPrivacyLevelValidationFailure",e.UnknownError="UnknownError"}(pd||(pd={})),function(e){e.PreTeamCreation="PreTeamCreation",e.Unknown="Unknown",e.Pending="Pending",e.InProgress="InProgress",e.Completed="Completed",e.Failed="Failed"}(vd||(vd={})),function(e){e.Pending="Pending",e.InProgress="InProgress",e.Completed="Completed",e.Failed="Failed"}(hd||(hd={})),function(e){e.Accept="Accept",e.Reject="Reject"}(fd||(fd={})),function(e){e.UnknownError="UnknownError",e.MaximumTeamMembersLimitReached="MaximumTeamMembersLimitReached",e.IBPolicyViolation="IBPolicyViolation",e.UserAlreadyExists="UserAlreadyExists",e.RequireStatusFailed="RequireStatusFailed"}(yd||(yd={})),function(e){e.NotJoined="NotJoined",e.Joining="Joining",e.Joined="Joined",e.Pending="Pending"}(kd||(kd={})),function(e){e.Success="Success",e.Error="Error",e.PartialSuccess="PartialSuccess"}(Sd||(Sd={})),function(e){e.Joined="Joined",e.Left="Left",e.Promoted="Promoted",e.Demoted="Demoted",e.DemotedAndLeft="DemotedAndLeft"}(bd||(bd={})),function(e){e.LAST_SEVEN_DAYS="LAST_SEVEN_DAYS",e.LAST_THIRTY_DAYS="LAST_THIRTY_DAYS",e.LAST_NINETY_DAYS="LAST_NINETY_DAYS"}(Cd||(Cd={})),function(e){e.PUBLIC="PUBLIC",e.PRIVATE="PRIVATE",e.ORGWIDE="ORGWIDE"}(wd||(wd={})),function(e){e.member="member",e.guest="guest"}(Nd||(Nd={})),function(e){e.ImportContactsMsa="ImportContactsMsa",e.ImportContactsGoogle="ImportContactsGoogle",e.JoinByCode="JoinByCode"}(Td||(Td={})),function(e){e.pastMeeting="pastMeeting",e.upcomingMeeting="upcomingMeeting"}(Id||(Id={})),function(e){e.CallStarted="CallStarted",e.CallEnded="CallEnded",e.TranscriptStarted="TranscriptStarted",e.TranscriptStopped="TranscriptStopped",e.ParticipantJoined="ParticipantJoined",e.ParticipantLeft="ParticipantLeft",e.UserEdit="UserEdit",e.RoomAttributionStarted="RoomAttributionStarted",e.RoomAttributionStopped="RoomAttributionStopped",e.TranscriptPublished="TranscriptPublished",e.SessionHandover="SessionHandover",e.RoomAttributionFailed="RoomAttributionFailed"}(Ed||(Ed={})),function(e){e.CallEvents="CallEvents",e.Transcript="Transcript"}(Ad||(Ad={})),function(e){e.Calling="Calling"}(_d||(_d={})),function(e){e.personalFileSite="personalFileSite",e.userPersonalSettings="userPersonalSettings",e.userGraphSettings="userGraphSettings",e.firstLoginInformation="firstLoginInformation",e.readReceiptsEnabled="readReceiptsEnabled",e.controllerConnectedServicesEnabled="controllerConnectedServicesEnabled",e.translationSettings="translationSettings",e.favorites="favorites",e.teamsOrder="teamsOrder",e.showInMeetingReport="showInMeetingReport",e.mobileContactsSync="mobileContactsSync",e.userPinnedApps="userPinnedApps",e.suggestedRepliesSettings="suggestedRepliesSettings",e.suggestedScheduleMessageDeliverySettings="suggestedScheduleMessageDeliverySettings",e.cortanaSettings="cortanaSettings",e.callAccessibilitySettings="callAccessibilitySettings",e.vivaTopicsSettings="vivaTopicsSettings",e.selfChatSettings="selfChatSettings",e.eduSimplifiedUxListDefault="eduSimplifiedUxListDefault",e.enableChannelsV2="enableChannelsV2",e.preferredSkinToneIndex="preferredSkinToneIndex",e.userEnableSurveysNotification="userEnableSurveysNotification",e.applicationIntegrationEnabled="applicationIntegrationEnabled"}(Dd||(Dd={})),function(e){e.Translate="Translate",e.NeverTranslate="NeverTranslate",e.Unknown="Unknown"}(Fd||(Fd={})),function(e){e.Unknown="Unknown",e.Available="Available",e.NotAvailable="NotAvailable"}(Md||(Md={})),function(e){e.Immediately="Immediately",e.Every10Mins="Every10Mins",e.Hourly="Hourly",e.EveryEightHours="EveryEightHours",e.Daily="Daily",e.Never="Never"}(Rd||(Rd={})),function(e){e.Daily="Daily",e.Never="Never"}(Pd||(Pd={})),function(e){e.MeetingsUserParticipatesIn="MeetingsUserParticipatesIn",e.MeetingsUserIsInvitedTo="MeetingsUserIsInvitedTo",e.MeetingsManuallyUnmuted="MeetingsManuallyUnmuted"}(Od||(Od={})),function(e){e.Teams="Teams",e.Desktop="Desktop",e.Web="Web",e.Unknown="Unknown"}(xd||(xd={})),function(e){e.On="On",e.Off="Off",e.BannerAndFeed="BannerAndFeed",e.OnlyFeed="OnlyFeed",e.OnlyBanner="OnlyBanner",e.All="All",e.CallMentionChats="CallMentionChats",e.Immediately="Immediately",e.Every10Mins="Every10Mins",e.Hourly="Hourly",e.EveryEightHours="EveryEightHours",e.Daily="Daily",e.Never="Never",e.AllActivity="AllActivity",e.MyAtMentions="MyAtMentions",e.Custom="Custom",e.Feed="Feed"}(Ld||(Ld={})),function(e){e.Private="Private",e.Public="Public"}(Ud||(Ud={})),function(e){e.NONE="NONE",e.PROFILE="PROFILE",e.CONTACT="CONTACT",e.INFERRED_CONTACT="INFERRED_CONTACT"}(Bd||(Bd={})),function(e){e.HOME="HOME",e.BUSINESS="BUSINESS",e.MOBILE="MOBILE",e.PAGER="PAGER",e.ORGANIZATION="ORGANIZATION",e.HOME_FAX="HOME_FAX",e.BUSINESS_FAX="BUSINESS_FAX",e.OTHER="OTHER",e.OTHER_FAX="OTHER_FAX",e.ASSISTANT="ASSISTANT",e.RADIO="RADIO"}(jd||(jd={})),function(e){e.UNKNOWN="UNKNOWN",e.WORK="WORK",e.PERSONAL="PERSONAL",e.MAIN="MAIN",e.BILLING="BILLING",e.OTHER="OTHER"}(Wd||(Wd={})),function(e){e.TEXT="TEXT",e.HTML="HTML"}(Vd||(Vd={})),function(e){e.HOME="HOME",e.BUSINESS="BUSINESS",e.OTHER="OTHER",e.UNKNOWN="UNKNOWN"}(Hd||(Hd={})),function(e){e.MANAGER="MANAGER",e.COLLEAGUE="COLLEAGUE",e.DIRECT_REPORT="DIRECT_REPORT",e.DOT_LINE_REPORT="DOT_LINE_REPORT",e.ASSISTANT="ASSISTANT",e.DOT_LINE_MANAGER="DOT_LINE_MANAGER",e.ALTERNATE_CONTACT="ALTERNATE_CONTACT",e.FRIEND="FRIEND",e.SPOUSE="SPOUSE",e.SIBLING="SIBLING",e.CHILD="CHILD",e.PARENT="PARENT",e.SPONSOR="SPONSOR",e.EMERGENCY_CONTACT="EMERGENCY_CONTACT",e.OTHER="OTHER"}($d||($d={})),function(e){e.BIRTHDAY="BIRTHDAY",e.WEDDING="WEDDING",e.OTHER="OTHER"}(zd||(zd={})),function(e){e.DEFAULT="DEFAULT",e.RED="RED",e.ORANGE="ORANGE",e.PEACH="PEACH",e.YELLOW_LIGHT="YELLOW_LIGHT",e.GREEN_LIGHT="GREEN_LIGHT",e.TEAL_LIGHT="TEAL_LIGHT",e.OLIVE="OLIVE",e.BLUE_SKY="BLUE_SKY",e.PURPLE_LIGHT="PURPLE_LIGHT",e.PINK="PINK",e.STEEL_LIGHT="STEEL_LIGHT",e.STEEL_GREY="STEEL_GREY",e.GREY_LIGHT="GREY_LIGHT",e.GREY_DARK="GREY_DARK",e.BLACK="BLACK",e.RED_DARK="RED_DARK",e.ORANGE_DARK="ORANGE_DARK",e.BROWN_MEDIUM="BROWN_MEDIUM",e.YELLOW_DARK="YELLOW_DARK",e.GREEN_DARK="GREEN_DARK",e.TEAL_DARK="TEAL_DARK",e.OLIVE_DARK="OLIVE_DARK",e.BLUE_DARK="BLUE_DARK",e.PURPLE_DARK="PURPLE_DARK",e.MAGENTA_DARK="MAGENTA_DARK"}(Gd||(Gd={})),function(e){e.SOURCE="SOURCE"}(qd||(qd={})),function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"}(Qd||(Qd={})),function(e){e.NONE="NONE",e.ON_SHIFT="ON_SHIFT",e.OFF_SHIFT="OFF_SHIFT"}(Jd||(Jd={})),function(e){e.PRESENCE_UNKNOWN="PRESENCE_UNKNOWN",e.AVAILABLE="AVAILABLE",e.AVAILABLE_IDLE="AVAILABLE_IDLE",e.AWAY="AWAY",e.BUSY="BUSY",e.BUSY_IDLE="BUSY_IDLE",e.DO_NOT_DISTURB="DO_NOT_DISTURB",e.BE_RIGHT_BACK="BE_RIGHT_BACK",e.OFFLINE="OFFLINE"}(Yd||(Yd={})),function(e){e.NEVER="NEVER",e.ONE_HOUR="ONE_HOUR",e.FOUR_HOURS="FOUR_HOURS",e.TODAY="TODAY",e.THIS_WEEK="THIS_WEEK"}(Kd||(Kd={})),function(e){e.AVAILABLE="AVAILABLE",e.BUSY="BUSY",e.DO_NOT_DISTURB="DO_NOT_DISTURB",e.BE_RIGHT_BACK="BE_RIGHT_BACK",e.APPEAR_AWAY="APPEAR_AWAY",e.APPEAR_OFFLINE="APPEAR_OFFLINE"}(Zd||(Zd={})),function(e){e.deeplinkIntoMainApp="deeplinkIntoMainApp"}(Xd||(Xd={}))},451900:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ActionItemConfidence:()=>i.IGm,ActionItemOwnershipType:()=>i.QFN,ActionItemsModelInsightType:()=>i.sjk,ActionType:()=>i.Usq,ActiveContextType:()=>i.xz$,Activity:()=>i.cS$,ActorToItemRelationshipType:()=>i.xa1,AgendaViewEndState:()=>i.OQO,AiInsightsOperationType:()=>i.kfo,AlertActionType:()=>i.c3b,AlertSeverity:()=>i.BLW,AlertType:()=>i.NK9,AliasVisibilitySetting:()=>i.Ei,AllowVoicemail:()=>i.jx2,AllowedNotificationsEngineParams:()=>i.Jbg,AllowedSenderType:()=>i.MTl,AltScenarioAction:()=>i.JPG,AmsItemType:()=>i.YEG,AnnotationEventType:()=>i.Vuv,AppBasedLinkAppResultType:()=>i.LYR,AppBasedLinkCachePolicyType:()=>i.XW6,AppBasedLinkPreviewType:()=>i.sQ6,AppCapability:()=>i.PwB,AppDefaultInstallScope:()=>i.s8E,AppDevicePermissionType:()=>i._Ll,AppDevicePermissionsUpdatedStatus:()=>i.VDl,AppGroupCapability:()=>i.JEf,AppInstallScope:()=>i.qi6,AppInstallationStates:()=>i.JMQ,AppKind:()=>i.OPt,AppPermissionNodeType:()=>i.YVt,AppRenderMode:()=>i.OQr,AppReviewReportCategory:()=>i.$hY,AppReviewSource:()=>i.dXV,AppReviewsFilter:()=>i.yhY,AppReviewsSort:()=>i.Y5e,AppServiceState:()=>i.YHP,ApplicationIdentityType:()=>i.FXX,AppointmentType:()=>i.Vne,ApprovalAction:()=>i.m0e,ArtifactType:()=>i.BzI,AskPermissionTicketState:()=>i.zO$,AttachmentLayout:()=>i.kUQ,AttachmentType:()=>i.sfQ,AttendanceReportType:()=>i.LmM,AttendeeClientType:()=>i.wGx,AttendeeConsentType:()=>i.ZB_,AttendeeGroupType:()=>i.H9H,AttendeeRegistrationStatus:()=>i.MSv,AttendeeRestrictableModality:()=>i.Zwl,AttendeeType:()=>i.Ili,AudienceType:()=>i._BL,AudioUsageMode:()=>i.nUz,AuthenticationAccountType:()=>i.Chc,AuthenticationCloudType:()=>i.G7Z,AuthenticationState:()=>i.zGj,AuthenticationUserRole:()=>i.w4O,AuthenticationUserSubType:()=>i.Yfn,Availability:()=>i.a8y,AvailabilityFreeBusyType:()=>i.o2x,AvatarMediaType:()=>i.FHR,BackgroundImageContext:()=>i.nEL,BannerAction:()=>i.sRD,BannerName:()=>i.XDy,BannerNotificationCause:()=>i.lFB,BannerNotificationIntentLevel:()=>i.XuV,BiometricVoiceEnrollmentStatus:()=>i.nK,BlobType:()=>i.R0O,BotAuthResultType:()=>i.MnL,BotConfigResultTypes:()=>i.$xD,BotMessagePreviewAction:()=>i.WVv,BotSourceType:()=>i.xUu,BreakoutRoomActionState:()=>i.CF7,BreakoutRoomsAssignmentType:()=>i.vSz,BreakoutRoomsCreationStatus:()=>i.Ivr,BreakoutRoomsSettingsStatus:()=>i.OIX,BroadcastLayoutType:()=>i.v6g,BroadcastMeetingAccessLevel:()=>i.VwM,BroadcastParticipantRole:()=>i.tf6,BroadcastPlayerType:()=>i.A49,BroadcastSectionType:()=>i.sTL,BroadcastStatus:()=>i.TPs,BroadcastStreamType:()=>i.jld,BroadcastType:()=>i.G7F,BuddyGroupType:()=>i.Io4,BusyOnBusyOptions:()=>i.M4c,CalendarAppointmentType:()=>i.eQ$,CalendarArtifactGroupType:()=>i.Ulw,CalendarArtifactType:()=>i.Frf,CalendarAvailabilityType:()=>i.tL2,CalendarErrorCode:()=>i.xNx,CalendarEventSelectFields:()=>i.ufv,CalendarEventType:()=>i.oDm,CalendarFormErrorType:()=>i.P3i,CalendarFormSlotType:()=>i.YQ8,CalendarInsightType:()=>i.y3S,CalendarMeetingScheduleType:()=>i.MUv,CalendarScenarioStatus:()=>i.jQt,CalendarSyncStatusEnum:()=>i.vo$,CallAbortReason:()=>i.Vos,CallAction:()=>i.LWr,CallAppContentSharingMode:()=>i.VRN,CallBlockingAction:()=>i.IU_,CallClosedCaptionStatus:()=>i.I_G,CallClosedCaptionsStatus:()=>i.Ge7,CallCoachStatus:()=>i.T3A,CallDeviceShortcutType:()=>i.zYS,CallDirection:()=>i.kwT,CallForwardingTargetType:()=>i.Ryo,CallForwardingType:()=>i.Io1,CallGroupNotification:()=>i.fCN,CallGroupNotificationOverride:()=>i.ICr,CallHealthState:()=>i.x1h,CallLocalRecordingState:()=>i.URt,CallLogCallState:()=>i.Qv1,CallLogCallType:()=>i.BdF,CallLogSessionType:()=>i.FTP,CallLogTransferStatus:()=>i.hyV,CallParticipantKind:()=>i.xys,CallPptSharingChangeSlideAction:()=>i.XR$,CallRecordingState:()=>i.OJN,CallRedirectionTargetType:()=>i.QeU,CallRefreshSettingsType:()=>i.jpo,CallTranscriptEntryType:()=>i.YnP,CallTranscriptState:()=>i.prp,CallVoiceCollectionState:()=>i.Uq$,CallingAppEventResolutionSourceName:()=>i.BHj,CallingAppEventSourceName:()=>i.eb2,CallingContentActionVisibility:()=>i.KRy,CallingIntentType:()=>i.GXC,CallingScreenGalleryType:()=>i.Iho,CallingServiceEntrypointType:()=>i.cCY,CallingServiceState:()=>i.h6$,CaptionFontSizeType:()=>i.$0E,CardCacheOperationType:()=>i.mz$,ChannelCrossPostStatus:()=>i.OQk,ChannelMessageEventType:()=>i.n96,ChannelPinPostPermissions:()=>i.s8d,ChannelPostPermissions:()=>i.XIP,ChannelReplyPermissions:()=>i.ytf,ChannelSystemMessageRoleUpdateType:()=>i.Tak,ChannelType:()=>i.xuW,ChatDisabledContextReason:()=>i.Z4B,ChatListEventType:()=>i.Rb4,ChatSubType:()=>i.k2e,ChatType:()=>i.z_3,ChatTypeFilter:()=>i.sTm,ClaimedConversationImportState:()=>i.B1J,ClientChannelType:()=>i.kK_,ClientDeviceType:()=>i.AeV,ClientPreferencesCategory:()=>i.wIZ,ClosedCaptionsSettingsCaptionColorType:()=>i.wls,ClosedCaptionsSettingsCaptionHeightType:()=>i.JKW,ClosedCaptionsSettingsFontSizeType:()=>i.aR8,ClosedCaptionsSettingsPositionType:()=>i.xvC,ClosedCaptionsTextTrackSource:()=>i.clf,CommandActions:()=>i.kjp,CommandContext:()=>i.Ae9,CommandSource:()=>i.Dyf,CompliancePolicyStatus:()=>i._Bi,CompliancePolicyType:()=>i.Q9H,ComplianceRecordingState:()=>i.l8x,ComposeLanguagePromptEvent:()=>i.GQc,CompositorRenderType:()=>i.zct,ConfigurableTabContext:()=>i.jDS,ConnectedAccountRequestSource:()=>i.dcg,ConnectedCalendarSource:()=>i.xP5,ConsultMode:()=>i.gXl,ContactDataSource:()=>i.l5h,ContactsSyncError:()=>i.yOG,ContactsSyncSource:()=>i.VTC,ContactsSyncType:()=>i.ERR,ContactsSyncWorkflowStatus:()=>i.LUR,ContainerState:()=>i.MZr,ContentCameraType:()=>i.WR8,ContentType:()=>i.zcD,ConversationIdentityType:()=>i.kge,ConversationMemberRole:()=>i.dRH,CorrelationSourceHint:()=>i.c$2,CortanaState:()=>i.YN3,CourseMembersAndOwnersStatus:()=>i.BFo,CreateCompositorContext:()=>i.BsF,CreateLinkType:()=>i.U4g,CurrentCallingState:()=>i.rsL,CustomAppType:()=>i.LQX,CustomFrameAreaEventType:()=>i.zO9,CustomLayoutSelection:()=>i.XoC,DLResultError:()=>i.AcR,DebugBroadcastParticipantRole:()=>i.X9x,DebugBroadcastStateStatus:()=>i.Fd9,DebugBroadcastType:()=>i.ffC,DeepLinkChicletState:()=>i.TDJ,DeeplinkedMessageState:()=>i.IEi,DeltaRequestMode:()=>i.yNt,Density:()=>i.AMX,DeviceType:()=>i.Yii,DeviceTypeInput:()=>i.y2I,DevicesMeetingType:()=>i.LVq,DialogAction:()=>i.Liy,DialogContentType:()=>i.jWr,DialogName:()=>i.WBC,DisableReasonCode:()=>i.Rdl,DisallowedToPostReason:()=>i.Jb0,DiscoverSurfacePreference:()=>i.H9T,DiscoverSurfaceScopeForPreference:()=>i.XdF,DiscoverSurfaceUserPreferenceEntity:()=>i.v0k,DisplayWaterMark:()=>i.mGI,DisposeReason:()=>i.pMG,DisposeSource:()=>i.QuG,DocumentViewerFileType:()=>i.mFq,DurableTaskWorkflowStatus:()=>i.Slq,ElementType:()=>i.Hdy,EmailDigestOptions:()=>i.vdn,EmailNotificationOptions:()=>i.SMg,EmergencyLocationType:()=>i.LQ7,EmotionAction:()=>i.PFp,EmotionKey:()=>i.aUL,EngagementSurface:()=>i.C55,EntityAction:()=>i.ukP,EntityStateTransition:()=>i.suD,EntityType:()=>i.pyR,EntityVisibilityState:()=>i.feW,EnvironmentSupport:()=>i.Ln2,EscalationModality:()=>i.F6r,EspActionType:()=>i.f4k,EspAlignment:()=>i.Qbq,EspExternalTelemetryType:()=>i.P7M,EspModalImageStyling:()=>i.jlU,EspPosition:()=>i.uNA,EspResourceType:()=>i.EK3,EspTrigger:()=>i.LQM,EventActionType:()=>i.qeQ,ExperienceAccountMode:()=>i.bzN,ExtendedContainerState:()=>i.oqG,ExtensionPointTypes:()=>i._WJ,ExternalAccountProvider:()=>i.RqE,ExternalCloudStorageProviderCode:()=>i.mFJ,FeedbackActionType:()=>i.vXL,FeedbackCallType:()=>i.ven,FeedbackService:()=>i.TBq,FeedbackSignalType:()=>i.oNc,FeedbackType:()=>i.nwx,FileAttachSuggestionSource:()=>i.$qY,FileChicletState:()=>i.cj1,FileOpenPreference:()=>i.Djg,FileUploadStatus:()=>i.XXy,FileViewServiceName:()=>i.a4b,FilesNavigationType:()=>i.BUw,FilesProviderType:()=>i.RWp,FluidContextType:()=>i.$Q1,FluidSourceType:()=>i.Da2,FluidUrlPermissionState:()=>i.WzC,FlyoutCameraUserChoice:()=>i.CRV,FrameSinkEventType:()=>i.uJ4,FreeBusyType:()=>i.eN,FrontRowDefaultPanelType:()=>i.wkl,FrontRowVideoSize:()=>i.dxg,GeneralChannelPosting:()=>i.S1B,GestureBasedReactionServiceState:()=>i.clb,GestureReactionStatus:()=>i.Kb4,GestureReactionType:()=>i.osM,GiphyRatingType:()=>i.m1e,GridViewSectionId:()=>i.y$p,GuardiansAnnouncementStatus:()=>i.vJe,HolographicDeviceType:()=>i.VpQ,HolographicInteractionComponent:()=>i.Dhn,HostTheme:()=>i.Up8,InfoPaneState:()=>i.MwA,InsightKindEnum:()=>i.UMR,InsightProcessingResultStatus:()=>i.kBB,InstalledAppSortType:()=>i.YeP,InstalledAppsUpdateEventType:()=>i.rQh,InteractionCommand:()=>i.e30,InteropConversationStatus:()=>i.uI5,InvitationState:()=>i.MwQ,InviteLinkType:()=>i.WZ1,JoinActionType:()=>i.Xh1,JoinRequestErrors:()=>i.r2Q,LandingScreen:()=>i.kAY,LayoutModes:()=>i.lOW,LayoutType:()=>i.msV,LeftRailSettingsCalendarType:()=>i.LwA,LinkScopeInput:()=>i.ENt,LinkType:()=>i.UnB,LinkTypeInput:()=>i.CNO,LiveStreamCaptionsLocale:()=>i.eNG,LiveStreamPlaybackError:()=>i.UT7,LiveStreamPlaybackState:()=>i.gzh,LoadDirection:()=>i.bGy,LocaleParamsType:()=>i.NtM,LocationType:()=>i._iy,MediaEventType:()=>i.ZnX,MeetAppAction:()=>i.wR5,MeetAppEventInsightSource:()=>i.sTX,MeetAppEventResponse:()=>i.xen,MeetAppScenario:()=>i.$pD,MeetAppTopic:()=>i.IEy,MeetAppTranscriptFragmentSource:()=>i.oR$,MeetForWorkAction:()=>i.mez,MeetForWorkFilterTab:()=>i.KY$,MeetForWorkRecurrencePatternType:()=>i.j5k,MeetForWorkResultStatus:()=>i.YXx,MeetForWorkScenario:()=>i.unu,MeetForWorkWeekDay:()=>i.Oig,MeetingAgendaHostClient:()=>i.mTO,MeetingAgendaState:()=>i.LJK,MeetingAgendaType:()=>i.ZAT,MeetingArtifactResourceType:()=>i.Xjc,MeetingArtifactType:()=>i.ceh,MeetingAttendanceType:()=>i.yG1,MeetingChatNotificationValue:()=>i.Cyn,MeetingChatPolicy:()=>i.UOl,MeetingJoinType:()=>i.cku,MeetingOptionsError:()=>i.aVM,MeetingOptionsPredicateOperator:()=>i.NNg,MeetingOptionsUserType:()=>i.X6H,MeetingPanelLocation:()=>i.su9,MeetingReactionType:()=>i.Le1,MeetingRecapCatchupItemsStatus:()=>i.M_S,MeetingRecommendationEntityType:()=>i.T1N,MeetingRecordingType:()=>i.u1r,MeetingResponseType:()=>i.Vf1,MeetingRoomAppState:()=>i.wVt,MeetingRoomDefaultFoRLayoutType:()=>i.gcs,MeetingRoomFrontOfRoomCallPanel:()=>i.gCs,MeetingRoomLayoutSelection:()=>i.XKC,MeetingRoomMeetingLinkUrlSource:()=>i.z$r,MeetingRoomRemoteControlLayoutType:()=>i.MEc,MeetingRoomThemeName:()=>i.LB2,MeetingStatus:()=>i.ytK,MeetingSummaryQnAType:()=>i.XRp,MeetingSurface:()=>i.Ajc,MeetingType:()=>i.wJZ,MembersAndRelatedContactsError:()=>i.c0v,MembershipType:()=>i.$cQ,MeshSpaceConversationType:()=>i.gLg,MessageAttachedType:()=>i.HBY,MessageExtensionCommandContextType:()=>i.ht_,MessageExtensionCommandType:()=>i.wHp,MessageExtensionInputType:()=>i.evG,MessageExtensionInvokeCacheFetchPolicy:()=>i.EG2,MessageImportance:()=>i.Ntc,MessageImportanceInGraphFormat:()=>i.rgk,MessageLanguageStatus:()=>i.YYW,MessageRenderType:()=>i.Mem,MessageReplyPermissions:()=>i.P$n,MessageSize:()=>i.TEU,MessageStatus:()=>i.rJC,MissedMtmaNotificationSignals:()=>i.gNb,MuteAllScope:()=>i.h$0,NavigationDirection:()=>i.fEB,NoiseSuppressionMode:()=>i.zk2,NoiseSuppressionSupport:()=>i.tHj,NotificationSettingsOptions:()=>i.HrE,NotificationType:()=>i.k$E,OneDriveForBusinessAvailability:()=>i.UQW,OneDriveItemType:()=>i.$IJ,OneGQL_PersonAnniversaryType:()=>i.U6l,OneGQL_PersonRawCollectionSortField:()=>i.z$1,OneGQL_PersonRelationship:()=>i.bkD,OneGQL_PersonTagColor:()=>i.zMv,OneGQL_PersonaAddressType:()=>i.swL,OneGQL_PersonaBodyType:()=>i.AyW,OneGQL_PersonaEmailType:()=>i.xK,OneGQL_PersonaPhoneType:()=>i.nmV,OneGQL_PersonaPropertySource:()=>i.oDq,OneGQL_PresenceAvailabilityType:()=>i.rr4,OneGQL_PresenceFrontLineWorkerPresence:()=>i.Ie1,OneGQL_PresenceSettableAvailabilityType:()=>i.ebH,OneGQL_PresenceStatusNoteExpiryPreDefinedEnum:()=>i.ehc,OneGQL_SortDirection:()=>i.L8l,OptionExternalFeedType:()=>i.sfo,OptionInterpretationType:()=>i.xHp,OptionPersonType:()=>i.vE1,OptionValueType:()=>i.Of,OutOfOfficeExternalAudience:()=>i.TEL,OutOfOfficeStatus:()=>i.b8x,OverflowRoomCallState:()=>i.O3C,ParentsAnnouncementsStatus:()=>i.opK,ParkContext:()=>i.YYO,ParticipantChangeType:()=>i.bCV,ParticipantJoinMeetingMode:()=>i.Mck,ParticipantState:()=>i.b1t,PeoplePickerFor:()=>i.TSI,PerformanceMode:()=>i.eft,PermissionScope:()=>i.UWY,PhoneNumberFormat:()=>i.M9W,PhoneNumberType:()=>i.fk5,PhoneType:()=>i.z_G,PinOperation:()=>i.Ygv,PinnedConversationItemType:()=>i.Voh,PlaceType:()=>i.ASP,PlatformAppPermission:()=>i.$Kr,PlatformAppsFetchSource:()=>i.p1$,PlatformTabEventType:()=>i.OPX,PlatformTabSettingsTypes:()=>i.Qhk,PlatformTabsEntryPoint:()=>i.sqJ,PlatformTabsQueryType:()=>i.rtK,PolicyViolationType:()=>i.btQ,PollOnDemandSupportedSettingsNamespaces:()=>i.x4d,PostType:()=>i.hQF,PptSharingContentMode:()=>i.h88,PptSharingMode:()=>i.h5P,PptSharingSource:()=>i.HnM,PresenceLocationType:()=>i.A1$,PresenceSource:()=>i.W8Z,ProvenanceType:()=>i.DTV,PtzControlCommand:()=>i.mH$,PtzErrorReason:()=>i.c$B,PtzSessionTerminatedReason:()=>i.DGS,QuestionnaireItemType:()=>i.yVM,ReactionType:()=>i.lom,RecorderOption:()=>i.Em8,RecordingPublishProgressStatus:()=>i.D73,RedeemIssueType:()=>i.Hy_,RegistrationOperationType:()=>i._Gd,RegistrationQuestionCategory:()=>i.LE8,RegistrationQuestionType:()=>i.D8e,RelatedContactError:()=>i.HTB,RelatedContactStatus:()=>i.Loq,RelevanceRelationshipType:()=>i.amW,ReportConcernContext:()=>i.Xzf,ReportConcernReason:()=>i.RaO,ResultTypes:()=>i.CO3,RingtoneCallType:()=>i.s1w,RingtoneNames:()=>i.rRG,RoomBookingType:()=>i.KZH,RoomRemoteMediaControlsCapabilities:()=>i.oXn,RoomRemoteMeetingControlsCapabilities:()=>i.TPi,RoomRemoteStageLayoutControlsCapabilities:()=>i.DjH,ScalingMode:()=>i.p8s,ScdStatus:()=>i.BIC,SchedulingFormTaskState:()=>i.vDg,SchedulingFormTaskType:()=>i.EhV,SchedulingFormTerminatingActionType:()=>i.ts3,SchedulingServiceEventType:()=>i._eA,SchedulingServiceMeetingPromiseState:()=>i.XlO,ScreenShareControlState:()=>i.jer,ScreenSharingControlStateAsViewer:()=>i.CDU,SearchBoxAction:()=>i.dQF,SearchHistoryAction:()=>i.rZ3,SearchSuggestionActionType:()=>i.fZW,SearchSuggestionEntitySource:()=>i.NPL,SearchSuggestionEntityType:()=>i.Bpo,SearchSuggestionGroupType:()=>i.orD,SearchSuggestionIconType:()=>i.$nY,SendFeedbackType:()=>i.wJo,SendMessageAction:()=>i.xyM,ServiceRecourseQueryAlterationTypes:()=>i.xwW,ServiceTeamMembershipUpdateType:()=>i.Bo,SessionType:()=>i.FFn,SettingsCategory:()=>i.Jpo,SettingsComponentLayoutType:()=>i.U5q,SettingsComponentType:()=>i.VSu,SettingsPaneCategory:()=>i.XQ2,SettingsPanelTab:()=>i.NHA,SettingsPanelTabElement:()=>i.ja_,ShareFormStatus:()=>i.f15,SharePointFileDocumentLibraryAccessType:()=>i.AjG,SharePointFileSpecialDocumentLibraryType:()=>i.q2e,SharePreviewType:()=>i.iTP,ShareableContentType:()=>i.c_Z,SharedWithTeamInvitationError:()=>i.HRx,SharingEntityType:()=>i.XDD,SharingLayoutMode:()=>i.EUN,SharingSourceType:()=>i.myd,SlotName:()=>i.WLT,SmbUserIntentType:()=>i.sCu,SmsDeliveryReportKey:()=>i.f1K,SortColumn:()=>i.Hn1,SortDirection:()=>i.SrV,SortOrderSources:()=>i.PaK,SpecialFolderName:()=>i.ZSI,StaticImageType:()=>i.ynw,StaticTabContext:()=>i.BUQ,StaticTabID:()=>i.ozu,StatusBarMessageType:()=>i.fNK,StatusNoteExpiry:()=>i.v2d,StoreArticleMediaType:()=>i.OE2,StoreItemAttribute:()=>i.r7c,StoreItemFeature:()=>i.OO0,StoreItemKind:()=>i.fSs,StoreItemOrder:()=>i.qVz,StreamDeliveryPipelineType:()=>i.FT_,StreamLabel:()=>i.k3Z,StreamTranscriptionLocale:()=>i.w$N,StreamType:()=>i.jxR,StreamingAppState:()=>i.Vfj,StreamingEventType:()=>i.fNg,SubStageType:()=>i.Z7A,SubstrateEntityType:()=>i.JJh,SuggestionTimeQuality:()=>i.g9K,SupportedViewEntities:()=>i.tF7,SurveyFieldType:()=>i.oR4,SyncBannerUserActionType:()=>i.zPu,SystemAudioDriverState:()=>i.pq3,SystemAudioSupport:()=>i.BYq,SystemSettingId:()=>i.l2X,TabPinnedState:()=>i.vb$,TaskModuleClosedReason:()=>i.Kks,TaskModuleEntryPoints:()=>i.gVh,TaskModuleUpdateType:()=>i.pyY,TeacherAnnouncementsChatIdError:()=>i.QMz,TeamAccessType:()=>i.eUH,TeamCreationStatus:()=>i.wZ4,TeamJoinState:()=>i.yvs,TeamJoinStatus:()=>i.ZHF,TeamLayoutPreferenceOptions:()=>i.$lW,TeamLockState:()=>i.iNV,TeamMemberRole:()=>i.k_p,TeamSettingsProperty:()=>i.reX,TeamType:()=>i.C9I,TeamsCameraFarEndPanTiltZoomControlMode:()=>i.phR,TeamsChannelPostInclusionReasonDetailedInclusionReasonEnum:()=>i._34,TeamsCollabContextType:()=>i.$u5,TeamsForCourseStatus:()=>i.V9I,TenantAnalyticsTeamTypeByPrivacy:()=>i.Bg,TenantAnalyticsTimeperiod:()=>i.nqg,TenantInvitationScenario:()=>i.nx0,TenantInvitationUserType:()=>i.eDm,TflMeetingType:()=>i.aU,Theme:()=>i.Q2A,ThirdPartyDevicePairingResult:()=>i.Z8d,ToastIntent:()=>i.GSK,ToastType:()=>i.pCN,ToggleHoldCallContext:()=>i.Vif,TokenType:()=>i.ivb,TranscriptArtifactType:()=>i.Dz_,TranscriptDownloadFormat:()=>i.Z9q,TranscriptEditType:()=>i.Cn5,TranscriptEventType:()=>i.Qen,TranslationAction:()=>i.ygE,TranslationFeedbackType:()=>i.taM,TranslationPreference:()=>i.zwH,TranslationRequestState:()=>i.kUj,TranslationStatus:()=>i.Yvc,TranslationStatusV2:()=>i.C14,TswSdkMessageType:()=>i.fXy,UnlockTeamResult:()=>i.arA,UpdateClientStateSource:()=>i.HRk,UpdateDelegatesAction:()=>i.fGh,UpdateLocalCacheSupportedPoliciesAndSettingsNamespaces:()=>i._fr,UserAuthState:()=>i.JEq,UserClassification:()=>i.oNF,UserExperiencePreferencesCategory:()=>i.UZQ,UserFlwPresence:()=>i.kz6,UserIdentityType:()=>i.$xx,UserMeetingRole:()=>i.LXf,UserMeetingRoleType:()=>i.dOr,UserPreferencesCategory:()=>i.nV$,UserRole:()=>i.i44,UserRoleInConsultCall:()=>i.$i$,UserRoleInEmergencyCall:()=>i.DPJ,UserTheme:()=>i.SqH,VideoAppPostMessageEvent:()=>i.Cfe,VideoBackgroundImageState:()=>i.VCP,VideoEffect:()=>i.hvQ,VideoEffectReadinessOnDevice:()=>i.hFs,VideoEffectStateType:()=>i.MpO,VideoExtensibilityLifecycleEventType:()=>i.nWM,VideoExtensibilityPerfEventType:()=>i.iR3,VideoFileStatus:()=>i.cSI,VideoFrameFormat:()=>i.ipA,VideoManifestType:()=>i.WwQ,VideoMessageCaptionStatus:()=>i.OCt,VideoRotationDegree:()=>i.o0l,VideoScanType:()=>i.bax,VirtualDesktopInfrastructureConnectedState:()=>i.Ws2,VirtualEventAccessType:()=>i.g8S,VirtualEventAction:()=>i.Mu6,VirtualEventEmailTemplateType:()=>i.UjV,VirtualEventRecurrenceType:()=>i.c87,VirtualEventRoleType:()=>i.ZR_,VirtualEventState:()=>i.Tg8,VirtualEventType:()=>i.i0v,VirtualEventsOrgProvisioningStatus:()=>i.Bq8,WebinarAccessPolicy:()=>i.yBp,WebinarField:()=>i.fjC,WebinarParticipantRole:()=>i.RyT,WebinarQuestionnaireType:()=>i.kg$,WebinarStatus:()=>i.MDw,WhatsNewActionType:()=>i.wi7,WhiteboardSharingContentMode:()=>i.Tuo,WidgetType:()=>i.l9N,WindowingCoordsType:()=>i.cAL,WindowingLinkedContentType:()=>i.JLw,WindowingMode:()=>i.lCV,WindowsEffects:()=>i.sZ5,WindowsEffectsStates:()=>i.vhA});var i=n(395816)},263589:(e,t,n)=>{"use strict";n.d(t,{g_h:()=>i});const i={possibleTypes:{MeetingCoordinates:["LegacyMeetingCoordinates","MeetingDataCoordinates"],CallingWindowingContentChangedEvent:["CallingWindowingConversationOrReplyChainContentUpdate"],CallingServiceEvent:["CallAdded","CallRemoved","CallUpdated","CallAlertsUpdated","CallDeviceListUpdated","ParticipantsOnCallConnected"],CallTransfer:["CallTransferred","CallTransferredFailed","CallTransferredSucceeded"],ParticipantsChangedEvent:["ParticipantsChanged","ParticipantCountsChanged"],CallAudienceBotDataChannel:["CallAudienceSceneChanged","CallAudienceSelectSceneAck"],CortanaEvent:["CortanaInvocationStateChanged","CortanaStateChanged"],ExplicitRecordingConsentUpdateResult:["ExplicitRecordingConsentState","ExplicitRecordingConsentTransactionEnd"],ParkedCall:["RegularParkedCall","SLAParkedCall"],CallingAppEventType:["CallingContentEvent","CallingAppSetupEvent"],CallingContent:["CallingBannerContent","CallingWindowingContent","CallingDialogContent","CallingNotificationContent","CallingToChatContent","CallingToChatListContent","CallingToCallListContent","CallingToSettingsPaneContent"],ThirdPartyDevicesEvent:["ThirdPartyDevicePairingRequest","ThirdPartyDeviceMeetingReactionRequest","ThirdPartyDeviceToggleRequest"],HolographicAnnotationEvent:["HolographicAnnotationCreatedEvent","HolographicAnnotationModifiedEvent","HolographicAnnotationRemovedEvent","HolographicInteractionEnabledEvent","HolographicInteractionInitializedEvent","HolographicInteractionComponentChangedEvent","HolographicSnapshotEnabledEvent","HolographicResetEvent","HolographicFreezeFrameEvent"],VideoEffectConfigChanged:["TouchUpToggleChanged","TouchUpStrengthChanged","AutoAdjustToggleChanged","EyeContactToggleChanged"],ContentSharingSession:["PptSharingSession","WhiteboardSharingSession"],ActionStatusEvent:["SendMessageActionData","ReactionsActionData","ErrorActionData"],CallCoordinates:["LegacyMeetingCoordinates","MeetingDataCoordinates","ExistingCallCoordinates","OneToOneCoordinates","GroupCallCoordinates"],CallJoinOptions:["JoinOptions","MeetingJoinOptions","OneToOneJoinOptions","GroupCallJoinOptions"],MeetingArtifactV2Union:["MeetingArtifactV2Transcript","MeetingArtifactV2Recording","MeetingArtifactV2Notes","MeetingArtifactV2MeetingContent","MeetingArtifactV2Default"],MeetingArtifactV2Interface:["MeetingArtifactV2Transcript","MeetingArtifactV2Recording","MeetingArtifactV2Notes","MeetingArtifactV2MeetingContent","MeetingArtifactV2Default"],IConnection:["ContactsSuggestionsConnection","ActivitiesConnection","AppReviewsConnection","AppReviewCommentsConnection","ReplyChainSummaryConnection","ReplyChainMessageConnection","ChatsConnection","SearchTeamConnection"],IEdge:["ContactsSuggestionsEdge","ActivityEdge","AppReviewEdge","AppReviewCommentEdge","ReplyChainSummaryEdge","ReplyChainMessagesEdge","ChatsEdge","SearchTeamsEdge"],IEdgeNode:["ContactsSuggestionsItem","Conversation","FeedActivity","AppReview","AppReviewComment","ReplyChainSummary","ReplyChainMessageNode","DiscoverTeamDetails"],IMessage:["Message","LastMessage","ReplyChainMessage","MeetingReplyMessage","StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage","ConnectorPostMessage","GuardiansPostMessage"],ChannelNotificationSettingsConfig:["ChannelNotificationSettingsSuccess","ChannelNotificationSettingsError"],ChannelEmailSettings:["ChannelEmailSettingsSuccess","ChannelEmailSettingsError"],ChannelSystemMessage:["BaseChannelSystemMessage","AddDeleteMemberSystemMessage","ChannelUpdatesSystemMessage","PinnedItemSystemMessage","ManageMembersSystemMessage","ChannelAddDeleteSystemMessage","SharedInSpacesSystemMessage","RoleUpdateSystemMessage","UpdateFavDefaultSystemMessage"],ChannelSystemMessageType:["BaseChannelSystemMessage","AddDeleteMemberSystemMessage","ChannelUpdatesSystemMessage","PinnedItemSystemMessage","ManageMembersSystemMessage","ChannelAddDeleteSystemMessage","SharedInSpacesSystemMessage","RoleUpdateSystemMessage","UpdateFavDefaultSystemMessage"],Dimension:["DimensionInFloat","DimensionInString"],BreakoutRoomsParticipantDetails:["ParticipantMainMeetingDetails","ParticipantBreakoutRoomDetails"],CommunitiesUpdateEvent:["CommunitiesUpdate"],TeamsAndChannelsUpdateEvent:["TeamUpdate","ChannelUpdate"],TeamAndChannelListUpdateEvent:["TeamUpdate","ChannelUpdate"],PinnedConversationItemInfo:["Message"],CalendarMultiSlotEventPayload:["CalendarFormCacheSyncEvent","CalendarFormSpinnerEvent","CalendarFormShareDialogEvent","CalendarFormErrorEvent","CalendarToggleTabEvent"],InviteUsersToCommunityResponse:["CommunityResponse","InviteUsersToCommunityError"],CreateCommunityResponse:["Community","CreateCommunityPartialSuccessResponse","CreateCommunityErrorResponse"],Mentionable:["TagCard","User","ChannelMentionSearchResult","AppDefinition","CommandDefinition"],FeedLocationLocaleParams:["DefaultFeedLocaleParams","ChannelFeedLocationLocaleParams"],FeedTitleLocaleParams:["DefaultFeedLocaleParams","ChannelFeedTitleLocaleParams"],AppBarIcon:["InternalIcon","RemoteImage"],LaunchTileBadge:["LaunchTileNumericBadge"],M365Application:["M365HubApplication","M365PlatformApplication"],M365ApplicationIcon:["InternalIcon","RemoteImage"],M365ApplicationBadge:["M365ApplicationNumericBadge"],EventTrigger:["AppAcquisitionLink","AppSecondaryAction"],InvokeAdaptiveCardTabResult:["AdaptiveCardTabContinue","AdaptiveCardTabDone","AdaptiveCardTabAuth"],InvokeTaskModuleResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone"],MessageExtensionTaskResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone","MessageExtensionResult"],BotConfigTaskResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone","BotConfigResult"],AdaptiveCardTabTaskResult:["TaskModuleTaskContinue","TaskModuleTaskMessage","TaskModuleTaskDone","AdaptiveCardTabContinue"],CalendarSyncPayloads:["CalendarSyncPayload","ConnectedCalendarSyncPayload","MultiCalendarSyncPayload","CalendarLeftRailSettingsSyncPayload"],CalendarCreateUpdateEventResult:["CalendarEvent","CalendarErrorResponse"],TeamCalendarEventsV2Result:["FilteredEvents","CalendarErrorResponse"],IPostMessage:["StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage","ConnectorPostMessage","GuardiansPostMessage"],ChannelPostMessage:["StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage","ConnectorPostMessage","GuardiansPostMessage"],ChannelReplyMessage:["ReplyChainMessage","MeetingReplyMessage"],ChannelMessage:["ReplyChainMessage","MeetingReplyMessage","StandardPostMessage","AnnouncementPostMessage","EmailPostMessage","MeetingPostMessage","ConnectorPostMessage","GuardiansPostMessage"],ConversationPinnedResult:["ConversationPinnedUpdate","SetChatPinnedMaxLimitReachedError"],ChatServiceEvent:["NewMessage","MessageUpdate","ThreadUpdate","ConversationUpdate","ConversationFullUpdate","ConsumptionHorizonUpdate","ResolveConversationLie","DiscardConversation","NotificationUpdate"],DiscoverSurfaceContainerEntity:["DiscoverSurfaceContainerEntityChannel","DiscoverSurfaceContainerEntityDefault"],DiscoverSurfaceUserPreferenceForEntity:["DiscoverSurfaceUserPreferenceForEntityActorKind","DiscoverSurfaceUserPreferenceForEntityContainerKind"],SelectorResolutionResult:["SelectorResolution","EspTargetError"],EspResource:["EspNotLocalizedResource","EspLocalizedResource"],EspUserInterfaceControl:["EspTextControl","EspImageControl","EspButtonControl","EspSpaceControl","EspInfoItemControl"],EspSurfaceParams:["EspModalParams","EspCoachmarkParams","EspNotificationParams","EspQuickGuideParams","EspIrisParams"],EspAction:["EspNoParamsAction","EspEntityCommandAction","EspDeeplinkNavigationAction","EspFollowUpSurfaceAction","EspUrlNavigationAction"],SetExternalCalendarEmailAddressResult:["User","SetExternalCalendarEmailAddressError"],ClientPreferenceCategoryTypes:["AnimationPreferences","DensityPreferences","FlyoutCameraPreferences","InfoPanePreferences","PerformancePreferences","AppSwitcherPreferences","ThemePreferences","VideoEffectPreferences","BackgroundEffectPreferences","AvatarPreferences","PromoBadgePreferences","TeamLayoutPreferences","DiagnosticsLogsPreferences"],NotificationsEngineData:["NotificationXDaysOfInactiveStatus"],PlatformTab:["BasicTab","ExtensionTab","WikiTab","FileViewTab","PowerBiTab","WebsiteTab","DocumentLibraryTab","OneNoteTab","StaticExtensionTab","LegacyWikiTab","LegacyDocumentLibraryTab","PlaceholderTab","CalendarTab"],PresenceError:["PresenceErrorGeneric","PresenceErrorNetworkOffline"],PresenceResult:["PresenceSuccess","PresenceErrorNetworkOffline","PresenceErrorGeneric"],BaseSearchSuggestionEntity:["PeopleSearchSuggestionEntity","GroupChatSearchSuggestionEntity","QuerySearchSuggestionEntity","JoinLinkDialogSuggestionEntity"],SearchSuggestionNavigationObject:["PeopleSuggestionNavigation","ConversationSuggestionNavigation","QuerySuggestionNavigation","JoinLinkDialogNavigation"],SearchSuggestionEntity:["PeopleSearchSuggestionEntity","GroupChatSearchSuggestionEntity","QuerySearchSuggestionEntity"],SBGroupLayout:["SBGroupLayoutSingleRenderer","SBGroupLayoutMultiRenderer"],CalendarInsight:["Quorum","OutOfRoutine","Conflicts"],CalendarArtifact:["AttachmentGroupType","RelatedEmailType"],AllSearchResults:["SearchMessageResult","SearchFileResult","PeopleSearchResult","SearchEmailResult"],UserPreferencesCategoryValue:["PersonalFileSiteDetailsValue","UserSettingsValue","FirstLoginInformationValue","ReadReceiptsEnabledValue","IsSingleUserTenantValue","CortanaSettingsValue","ControllerConnectedServicesEnabledValue","SuggestedRepliesSettingsValue","SuggestedScheduleMessageDeliverySettings","TranslationSettingsValue","FavoritesValue","TeamOrdersValue","ShowInMeetingReportValue","MobileContactsSyncValue","UserPinnedAppValue","CallAccessibilitySettingsValue","SelfChatSettingsValue","EnableChannelsV2Value","VivaTopicsSettingsValue","EduSimplifiedUxListDefaultValue","PreferredSkinToneIndexValue","UserEnableSurveysNotificationValue","ApplicationIntegrationValue"],UserPreferencesResponse:["UserPreferences","UserPreferencesError"],Node:["OneGQL_Person","OneGQL_Me","OneGQL_UnifiedGroup","OneGQL_MePresence","OneGQL_PersonPresence"],ConnectionEdge:["OneGQL_PersonaOrganizationEdge"],ConnectionEdgeWithCursorPagination:["OneGQL_PersonaOrganizationEdge"],Connection:[],ConnectionWithCursorPagination:["OneGQL_PersonaOrganizationConnection"],MutationFailure:["OneGQL_ContactMutationErrorGeneric","OneGQL_ContactMutationErrorNetworkOffline","OneGQL_PresenceMutationFailure","OneGQL_PresenceMutationFailureNetworkOffline"],OneGQL_Individual:["OneGQL_Person","OneGQL_Me"],OneGQL_PersonaComplexTypeBaseRaw:["OneGQL_PersonNameRaw","OneGQL_PersonaPhoneRaw","OneGQL_PersonaEmailAddressRaw","OneGQL_PersonaImAddressRaw","OneGQL_PersonaWebsiteRaw","OneGQL_PersonAnnotationRaw","OneGQL_PersonaAddressRaw","OneGQL_PersonWorkPositionRaw","OneGQL_PersonRelatedEntityRaw","OneGQL_PersonAnniversaryRaw","OneGQL_PersonTag","OneGQL_PersonCustomAttribute"],OneGQL_PersonaComplexTypeBaseDeduplicated:["OneGQL_PersonName","OneGQL_PersonaPhone","OneGQL_PersonaEmailAddress","OneGQL_PersonaImAddress","OneGQL_PersonaWebsite","OneGQL_PersonAnnotation","OneGQL_PersonaAddress","OneGQL_PersonWorkPosition","OneGQL_PersonRelatedEntity","OneGQL_PersonAnniversary"],OneGQL_PersonNameBase:["OneGQL_PersonNameRaw","OneGQL_PersonName"],OneGQL_PersonaPhoneBase:["OneGQL_PersonaPhoneRaw","OneGQL_PersonaPhone"],OneGQL_PersonaEmailAddressBase:["OneGQL_PersonaEmailAddressRaw","OneGQL_PersonaEmailAddress"],OneGQL_PersonaImAddressBase:["OneGQL_PersonaImAddressRaw","OneGQL_PersonaImAddress"],OneGQL_PersonaWebsiteBase:["OneGQL_PersonaWebsiteRaw","OneGQL_PersonaWebsite"],OneGQL_PersonAnnotationBase:["OneGQL_PersonAnnotationRaw","OneGQL_PersonAnnotation"],OneGQL_PersonaAddressBase:["OneGQL_PersonaAddressRaw","OneGQL_PersonaAddress"],OneGQL_PersonWorkPositionBase:["OneGQL_PersonWorkPositionRaw","OneGQL_PersonWorkPosition"],OneGQL_PersonRelatedEntityBase:["OneGQL_PersonRelatedEntityRaw","OneGQL_PersonRelatedEntity"],OneGQL_PersonAnniversaryBase:["OneGQL_PersonAnniversaryRaw","OneGQL_PersonAnniversary"],OneGQL_ContactMutationResult:["OneGQL_ContactMutationSuccess","OneGQL_ContactMutationErrorNetworkOffline","OneGQL_ContactMutationErrorGeneric"],OneGQL_EntityWithPersonaPhoto:["OneGQL_Person","OneGQL_Me","OneGQL_UnifiedGroup"],OneGQL_Persona:["OneGQL_Person","OneGQL_Me","OneGQL_UnifiedGroup"],OneGQL_Presence:["OneGQL_MePresence","OneGQL_PersonPresence"],OneGQL_PresenceStatusNoteExpiry:["OneGQL_PresenceStatusNoteExpiryPreDefined","OneGQL_PresenceStatusNoteExpiryCustom"],OneGQL_PresenceMutationResult:["OneGQL_PresenceMutationSuccess","OneGQL_PresenceMutationFailure","OneGQL_PresenceMutationFailureNetworkOffline"]}}.possibleTypes},233609:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i={M365Application:["M365HubApplication","M365PlatformApplication"],M365ApplicationIcon:["InternalIcon","RemoteImage"],M365ApplicationBadge:["M365ApplicationNumericBadge"],EventTrigger:["AppAcquisitionLink","AppSecondaryAction"],Node:["M365HubApplication","M365PlatformApplication","Conversation","Me","FullAccount","Cloud","ActiveTenant","InactiveTenant","MeInOtherTenant","Person","MePresence","PersonPresence","AvailabilityOption"],ConnectionEdge:["M365ApplicationEdge","AccountEdge","TenantEdge"],ConnectionEdgeWithCursorPagination:[],Connection:["M365ApplicationConnection","AccountConnection","TenantConnection"],ConnectionWithCursorPagination:[],MutationFailure:["PresenceMutationFailure","PresenceMutationFailureNetworkOffline"],BaseAccount:["FullAccount","Cloud"],Account:["FullAccount","Cloud"],Tenant:["ActiveTenant","InactiveTenant"],BaseTenant:["ActiveTenant","InactiveTenant"],Persona:["Me","MeInOtherTenant","Person"],Individual:["Me","MeInOtherTenant","Person"],Presence:["MePresence","PersonPresence"],PresenceStatusNoteExpiry:["PresenceStatusNoteExpiryPreDefined","PresenceStatusNoteExpiryCustom"],PresenceMutationResult:["PresenceMutationSuccess","PresenceMutationFailure","PresenceMutationFailureNetworkOffline"]}},717233:(e,t,n)=>{"use strict";n.r(t),n.d(t,{resolvers:()=>f,typeDefs:()=>C});var i=n(231191),a=n(695185),o=n(118824),r=n(87412),s=n(519194),l=n(628235),d=n(923036),c=n(244449),u=n(372304),m=n(648062),g=n(798703),p=n(969626),v=n(272097),h=n(29809);const f={Query:{authenticationUsers(e,{filter:t},{authenticationService:n}){var a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=t?{}:void 0;e&&(null==t?void 0:t.isAuthenticated)&&(e.isAuthenticated=t.isAuthenticated),e&&(null==t?void 0:t.isPrimaryUser)&&(e.isPrimaryUser=t.isPrimaryUser),e&&(null==t?void 0:t.isAllCachedUsers)&&(e.isAllCachedUsers=t.isAllCachedUsers);return S(null!==(o=yield null===(a=null==n?void 0:n.getCachedUsers)||void 0===a?void 0:a.call(n,{id:(0,d.pW)(),source:"authenticationUsersQuery",scenarioName:l.RG.AuthWebCachedUser},e))&&void 0!==o?o:[])}))},authenticatedUser(e,{allowAnon:t,tenantId:n,loginHint:a,userContextId:o},{authenticationService:r,correlation:s,loggerFactory:c}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=null==c?void 0:c.newLogger("AuthenticationService"),i={id:(null==s?void 0:s.id)||(0,d.pW)(),source:(null==s?void 0:s.source)||"getUserQuery",scenarioName:(null==s?void 0:s.scenarioName)||l.RG.AuthWebUser};try{const e=yield r.getUser({allowAnon:t,correlation:i,tenantId:null!=n?n:void 0,loginHint:null!=a?a:void 0,accountId:null!=o?o:void 0});return e?b(e):null}catch(t){throw null==e||e.warn(`[resolvers][authenticatedUser] ${t.code||t.errorCode} - ${t.message}`),t}}))},authenticationToken(e,{resource:t,acquireTokenOptions:n},{authenticationService:a,windowId:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return{token:yield a.acquireToken(t,{claim:(null==n?void 0:n.claim)||void 0,windowId:o||void 0,silent:n&&null!=n.silent?n.silent:void 0,userIdentifier:(null==n?void 0:n.userIdentifier)||void 0,tenantId:(null==n?void 0:n.tenantId)||void 0})}}))},authConsent(e,{resource:t,tenantId:n,acquireTokenOptions:a},{authenticationService:o,correlation:r,windowId:s,loggerFactory:l}){var c;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=null==l?void 0:l.newLogger("AuthenticationService");return o.acquireToken(t,{claim:(null==a?void 0:a.claim)||void 0,windowId:s||void 0,silent:a&&null!==a.silent?a.silent:void 0,userIdentifier:(null==a?void 0:a.userIdentifier)||void 0,correlationId:null!==(c=null==r?void 0:r.id)&&void 0!==c?c:(0,d.pW)(),tenantId:n}).then((()=>({consentAccepted:!0}))).catch((t=>(null==e||e.warn(`[resolvers][authConsent] Failed to acquire user's consent with error: ${t.code||t.errorCode} - ${t.message}`),{consentAccepted:!1})))}))},hostMachineUsers(e,{fetchAuthenticatedUsers:t},{authenticationService:n,loggerFactory:a}){var o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=null==a?void 0:a.newLogger("AuthenticationService"),i=yield null===(o=n.getHostMachineUsers)||void 0===o?void 0:o.call(n,(0,d.pW)()).catch((t=>e&&e.warn(`[resolvers][hostMachineUsers] ${t.code||t.errorCode} - ${t.message}`)));if(null!=t){return function(e,t,n){if(!e||e.length<1||!t||(null==t?void 0:t.length)<1)return n?[]:e;return n?e.filter((e=>t.find((({id:t})=>e.id===t)))):e.filter((e=>!t.find((({id:t})=>e.id===t))))}(i,yield null===(r=n.getCachedUsers)||void 0===r?void 0:r.call(n,{id:(0,d.pW)(),scenarioName:l.RG.AuthWebCachedUser,source:"server-resolvers::hostMachineUsers"}),t)}return i||[]}))},tenantData(e,{accountId:t},{authenticationService:n,correlation:a}){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!t)return null;if(!a||!a.source)throw new Error("CorrelationKey is not passed to UseGetTenantData");const e={id:(null==a?void 0:a.id)||(0,d.pW)(),scenarioName:(null==a?void 0:a.scenarioName)||l.RG.AuthWebGetTenantData,source:(null==a?void 0:a.source)||"server-resolver"},[i,r]=(0,c.OU)({options:{correlation:e},subContext:"tenantData",scenarioName:l.RG.AuthWebGetTenantData,source:"server-resolver"});i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStart);try{const e=yield null===(o=n.getTenantData)||void 0===o?void 0:o.call(n,{correlation:a,accountId:t});return i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStop),r(),e||null}catch(e){throw i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStop,{error:e}),r({error:e}),e}}))},userAuthState(e,{userContextId:t},{authenticationService:n,correlation:a}){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!(null==a?void 0:a.source))throw new Error("CorrelationKey is not passed to userAuthState");const e={id:a.id||(0,d.pW)(),scenarioName:a.scenarioName||l.RG.AuthWebGetTenantData,source:a.source},[i,r]=(0,c.OU)({options:{correlation:e},subContext:"tenantData",scenarioName:l.RG.AuthWebGetTenantData,source:"server-resolver"});i.addScenarioMark(l.ck.AuthWebGetUserAuthStateResolverStart);try{const a=yield null===(o=n.getUserAuthState)||void 0===o?void 0:o.call(n,{correlation:e,accountId:t});return i.addScenarioMark(l.ck.AuthWebGetUserAuthStateResolverStop),r(),a||null}catch(e){throw i.addScenarioMark(l.ck.AuthWebGetUserAuthStateResolverStop,{error:e}),r({error:e}),e}}))},userRelations(e,t,{authenticationService:n,correlation:a,authenticationUser:o}){var r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!(null==a?void 0:a.source))throw new Error("CorrelationKey is not passed to userRelation");const e={id:a.id||(0,d.pW)(),scenarioName:a.scenarioName||l.RG.AuthWebGenerateUserRelation,source:a.source||"server-resolver"},[t,s]=(0,c.OU)({options:{correlation:e},subContext:"userRelation",scenarioName:l.RG.AuthWebGenerateUserRelation,source:"server-resolver"});t.addScenarioMark(l.ck.AuthWebGenerateUserRelationStart);try{const t=(yield null===(r=null==n?void 0:n.getCachedUsers)||void 0===r?void 0:r.call(n,e,{isAllCachedUsers:!0}))||[],a=[];yield(0,v.Fr)(t,(t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield k(n,e,t,o);a.push(i)}))));const l=a.filter((e=>e.id===e.homeAccountId)),d=[];return l.forEach((e=>{let t=!1;const n=a.filter((t=>t.homeAccountId===e.id&&t.id!==t.homeAccountId)).map((e=>(e.isCurrentUserEdge&&(t=!0),e)));e.isCurrentUserEdge&&(t=!0),d.push({isCurrentUserRelation:t,homeTenantEdge:e,userEdges:null==n?void 0:n.sort(y)})})),d.sort((e=>e.isCurrentUserRelation?-1:1)),s(),d||[]}catch(e){throw t.addScenarioMark(l.ck.AuthWebGetUserAuthStateResolverStop,{error:e}),s({error:e}),e}}))}},Mutation:{authenticateUser(e,{id:t,correlationId:n,loginHint:a},{authenticationService:r,windowId:s,coreSettings:l,loggerFactory:c,correlation:u}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=null==c?void 0:c.newLogger("AuthenticationService"),g={accountId:t||"",correlation:{id:null!=n?n:(0,d.pW)(),source:(null==u?void 0:u.source)||"login-mutation",scenarioName:(null==u?void 0:u.scenarioName)||"auth_web_login"},loginHint:null!=a?a:"",prompt:"login",silent:!1,windowId:s||void 0};return r.login(g).then((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return e?b(e):null})))).catch((t=>{var n;if(null==e||e.warn(`[resolvers][authenticateUser] Failed with error: ${t.code||t.errorCode} - isExpected: ${t.isExpected}. ${t.message}.`),t.code=null!==(n=t.code)&&void 0!==n?n:t.errorCode,!t.isExpected||t.errorCode===m.SM.SignInRestrictions||t.errorCode===m.SM.UserNotLicensed||!l.get(o.J.Auth).disableOfflineErrors&&function(e){switch(e){case m.wK.NoNetwork:case m.SM.RemoteOperationFailed:return!0;default:return!1}}(t.errorCode))throw null==e||e.error("[resolvers][authenticateUser] Warning above is fatal. Failing mutation."),t;return null==e||e.log("[resolvers][authenticateUser] Warning above is expected. Ignoring failure."),null}))}))},authenticateOrGetUser(e,{allowAnon:t,userContextId:n,loginHint:a,tenantId:r},{authenticationService:s,windowId:u,correlation:m,coreSettings:g}){var p,v,h;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={id:(null==m?void 0:m.id)||(0,d.pW)(),source:(null==m?void 0:m.source)||"getOrCreateUserQuery",scenarioName:(null==m?void 0:m.scenarioName)||l.RG.AuthWebUser},[i,f]=(0,c.OU)({options:{correlation:e},subContext:"authenticateOrGetUser",scenarioName:null!==(p=null==m?void 0:m.scenarioName)&&void 0!==p?p:l.RG.AuthWebGetActiveUsers,source:null!==(v=null==m?void 0:m.source)&&void 0!==v?v:"ServerResolvers"});try{const o=yield s.getUser({allowAnon:t,correlation:e,tenantId:null!=r?r:void 0,loginHint:null!=a?a:void 0,accountId:null!=n?n:void 0});if(o)return i.addEventData(["returnedCachedUser:1"]),f(),b(o)}catch(e){throw f({error:e}),e}try{const e=!!g.get(o.J.Auth).enableRedirectToSignIn,l={accountId:n||"",correlation:{id:null!==(h=null==m?void 0:m.id)&&void 0!==h?h:(0,d.pW)(),source:(null==m?void 0:m.source)||"getOrCreateUser",scenarioName:(null==m?void 0:m.scenarioName)||"getOrCreateUser"},loginHint:null!=a?a:"",prompt:"none",silent:!e,windowId:u||void 0};g.get(o.J.Auth).enableTenantTurnOnTurnOff&&(l.extraQueryParameters={tenantId:null!=r?r:"",allowAnon:`${t}`});const c=yield s.login(l);if(c)return i.addEventData(["ReturnedLoginUser:1"]),f(),b(c);i.addEventData(["NoLoginUserFound:1"]),f()}catch(e){f({error:e})}return null}))},refreshTenants(e,{userContextId:t},{authenticationService:n,correlation:a}){var o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!a||!a.source||!a.id)throw new Error("CorrelationKey is not passed to UseGetTenant");const e={id:a.id,scenarioName:a.scenarioName,source:a.source},[i,s]=(0,c.OU)({options:{correlation:e},subContext:"getTenants",scenarioName:null!==(o=a.scenarioName)&&void 0!==o?o:l.RG.AuthWebSetUpTenants,source:e.source,scenarioEventData:{targetedUser:t}});i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStart);try{const a=yield null===(r=n.getTenants)||void 0===r?void 0:r.call(n,{correlation:e,forceRefresh:!0,accountId:t});return i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStop),s(),a||null}catch(e){throw i.addScenarioMark(l.ck.AuthWebGetTenantDataResolverStop,{error:e}),s({error:e}),e}}))},updateTenants(e,{userHomeAccountId:t,tenantId:n,isTenantHidden:a},{authenticationService:o,correlation:r}){var s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!r||!r.source||!r.id)throw new Error("CorrelationKey is not passed to UpdateTenant");const e="server-resolvers::updateTenants",i={id:r.id,scenarioName:l.RG.AuthWebUpdateTenants,source:r.source},[d,g]=(0,c.OU)({options:{correlation:i},subContext:e,scenarioName:l.RG.AuthWebUpdateTenants,source:i.source,scenarioEventData:{primaryUserId:t}});d.addScenarioMark(l.ck.AuthWebUpdateTenantDataResolverStart);try{const l=yield null===(s=o.updateTenants)||void 0===s?void 0:s.call(o,{correlation:i,forceRefresh:!0,accountId:t},{tenantId:n,isTenantHidden:a});if(g(),!l)throw(0,u.Tr)({context:r.source,subContext:e,message:"Null response",errorCode:m.SM.EmptyResponse,isExpected:!1,correlationId:r.id});return l}catch(e){throw g({error:e}),e}}))},authenticationLogout(e,t,{authenticationService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return t.correlation||(t.correlation={id:(0,d.pW)(),source:"server-resolvers::authenticationLogout",scenarioName:l.RG.AuthWebLogout}),n.logout?n.logout(t).then((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return{succeed:!0}})))).catch((()=>({succeed:!1}))):{succeed:!1}}))},reauthenticateUser(e,t,{authenticationService:n,authStateProvider:a,coreSettings:s,windowId:u,loggerFactory:g}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=null==g?void 0:g.newLogger("AuthenticationService");let t=null==a?void 0:a.getInteractionRequiredResource();if(!t){null==e||e.error("reauthenticateUser called but no InteractionRequired resource found");const{criticalResources:n,mtResource:i}=(null==s?void 0:s.get(o.J.Auth))||{};t=(null==n?void 0:n[0])||i||r.K$}const i={silent:!1,prompt:"login",forceRenew:!0,loginRedirect:!!s.get(o.J.Auth).enableRedirectToSignIn,windowId:u||void 0,correlation:{id:(0,d.pW)(),scenarioName:l.RG.AcquireToken,source:"reauthenticateUser"}},[,p]=(0,c.OU)({options:i,source:"server-resolvers",scenarioName:l.RG.AcquireToken,subContext:"reauthenticateUser",timeoutMs:!1===i.silent?m.rF.ONE_HOUR:void 0,scenarioEventData:{isSilent:i.silent,endpointUrl:t},eventData:["silent:"+(void 0===i.silent?-1:+!!i.silent)],startWithoutScenario:!0});return n.acquireToken(t,i).then((()=>(p(),{success:!0}))).catch((e=>(p(e),{success:!1})))}))},resolveThirdPartyOauthCode(e,{code:t,state:n},{getGoogleCalendarAuthenticationService:a,getGoogleContactsAuthenticationService:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!function(e){return e.includes(h.W.Calendar)||e.includes(h.W.Contacts)}(n))return!1;return(n.includes(h.W.Calendar)?yield a():yield o()).setAuthCode(t||null,n||null),!0}))},switchAccount(e,{userContextId:t},{entityCommanding:n,correlation:a}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={source:s.D.SwitchAccountFromMeMenu,id:null==a?void 0:a.id};return n.authentication.switchAccount({userContextId:t,correlation:e}),!0}))},initializeAccounts(e,t,{authenticationService:n,correlation:a}){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={id:(null==a?void 0:a.id)||(0,d.pW)(),scenarioName:(null==a?void 0:a.scenarioName)||l.RG.AuthWebInitializeAccounts,source:(null==a?void 0:a.source)||"server-resolver"},[t]=(0,c.OU)({options:{correlation:e},subContext:"initializeAccounts",scenarioName:l.RG.AuthWebInitializeAccounts,source:"server-resolver"});t.addScenarioMark(l.ck.AuthWebInitializeAccountsResolverStart);const i=yield null===(o=n.initializeAccounts)||void 0===o?void 0:o.call(n,{correlation:a});return t.addScenarioMark(l.ck.AuthWebInitializeAccountsResolverStop),t.closeScenario(),i||!1}))}},Subscription:{authenticationUsersEvent:{subscribe(e,{filter:t},{authenticationService:n}){return(0,i.__asyncGenerator)(this,arguments,(function*(){var e,a,o,r;try{for(var s,l=!0,d=(0,i.__asyncValues)(n.getUsersIterator(t));!(e=(s=yield(0,i.__await)(d.next())).done);){r=s.value,l=!1;try{const e=r;yield yield(0,i.__await)({authenticationUsersEvent:{authenticationUsers:S(e)}})}finally{l=!0}}}catch(e){a={error:e}}finally{try{l||e||!(o=d.return)||(yield(0,i.__await)(o.call(d)))}finally{if(a)throw a.error}}}))}},authenticationStateChanged:{subscribe(e,t,{authStateProvider:n}){return(0,i.__asyncGenerator)(this,arguments,(function*(){var e,t,o,s;const l=new a((e=>{const t=null==n?void 0:n.observe();t?null==t||t.subscribe((t=>{e.next(t)})):e.next(r.jq.Up)}));try{for(var d,c=!0,u=(0,i.__asyncValues)((0,p.Z)(l,void 0,void 0,"authenticationStateChanged"));!(e=(d=yield(0,i.__await)(u.next())).done);){s=d.value,c=!1;try{const e=s;yield yield(0,i.__await)({authenticationStateChanged:{authenticationState:e}})}finally{c=!0}}}catch(e){t={error:e}}finally{try{c||e||!(o=u.return)||(yield(0,i.__await)(o.call(u)))}finally{if(t)throw t.error}}}))}}}},y=(e,t)=>{var n,i;const a=(null===(n=null==e?void 0:e.tenantEdge)||void 0===n?void 0:n.displayName)||"",o=(null===(i=null==t?void 0:t.tenantEdge)||void 0===i?void 0:i.displayName)||"";return a.localeCompare(o)},k=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,o;const r=n.id&&(yield null===(i=e.getTenantData)||void 0===i?void 0:i.call(e,{correlation:t,accountId:n.id})),s=n.id&&(yield null===(o=e.getUserImage)||void 0===o?void 0:o.call(e,{correlation:t,id:n.id})),l=n.id===(null==a?void 0:a.id);return{id:n.id||"",tenantEdge:{id:n.profile.tid,displayName:r&&r.tenantName},emailPhone:n.userName,displayName:n.profile.name,isCurrentUserEdge:l,homeAccountId:n.homeAccountId||"",image:s}}));function S(e){return e.filter(Boolean).map(b)}function b(e){const t=e.homeAccountId,n=(0,g.K)(e),i=n.profile,{upn:a}=e.profile;return Object.assign(Object.assign({},n),{__typename:"AuthenticationUser",profile:Object.assign(Object.assign({},i),{__typename:"AuthenticationUserProfile",upn:a}),homeAccountId:t,isAuthenticated:!!n.isAuthenticated})}var C=n(854621)},759099:(e,t,n)=>{"use strict";n.d(t,{wf:()=>j,s_:()=>B});var i=n(231191),a=n(395816);const o=e=>e&&!!e.wamsStreamingUrl&&!!e.decryptionToken,r=(e,t,n)=>{var i,r,s,l;return{__typename:"Broadcast",id:e,admissionType:n.admissionType,type:t?a.G7F.Overflow:a.G7F.QuickStart,userRole:n.userRole||a.tf6.Attendee,correlationId:n.correlationId,title:n.subject,utcStart:n.utcStart||null,utcEnd:n.utcEnd||null,location:n.location||null,streamingDetails:d(e,n),qna:Object.assign(Object.assign({},n.qna),{isEnabled:(null===(i=n.qna)||void 0===i?void 0:i.isEnabled)||!1,attendeeUrl:(null===(r=n.qna)||void 0===r?void 0:r.attendeeUrl)||"",moderatorUrl:(null===(s=n.qna)||void 0===s?void 0:s.moderatorUrl)||"",iosAutodiscoverUrl:(null===(l=n.qna)||void 0===l?void 0:l.iosAutodiscoverUrl)||"",__typename:"BroadcastQnaMetadata"}),yammer:n.yammer&&{__typename:"BroadcastYammerMetadata",broadcastId:n.yammer.broadcastId,groupId:n.yammer.groupId,isEnabled:n.yammer.isEnabled,eventUrl:n.yammer.event}||null,meetingStatus:n.meetingStatus||(o(n.stream)||o(n.altStream)?a.ytK.Live:a.ytK.Created),supportUrl:n.supportUrl,sdn:u(n)||null,transcription:g(e,n),aesKey:Object.assign({__typename:"AESKey"},p(n)),aesKeyRefresh:n.aesKeyRefresh,error:n.error||null,signalR:Object.assign({__typename:"SignalRDetails"},v(n)),streamResource:h(n),broadcastRestartVersion:n.broadcastRestartVersion||0,odspVodShareUrl:n.odspVodShareUrl||null,access:f(n)}},s=e=>({__typename:"BroadcastAttendeeStream",wamsStreamingUrl:null==e?void 0:e.wamsStreamingUrl,decryptionToken:null==e?void 0:e.decryptionToken}),l=e=>({__typename:"BroadcastStreamingInfo",wamsStreamingUrl:(null==e?void 0:e.wamsStreamingUrl)||null,decryptionToken:(null==e?void 0:e.decryptionToken)||null,setKeyAuthorizationCookieUri:null,keyAuthorizationToken:null,sdn:c(e)||null}),d=(e,t)=>({__typename:"BroadcastStreamingDetails",id:e,stream:l(t.stream),altStream:l(t.altStream)}),c=e=>e&&e.sdnName&&e.sdnPluginUrl&&{__typename:"SDNDetails",name:e.sdnName,playbackInfo:e.sdnPlaybackInfo||"",pluginUrl:e.sdnPluginUrl,sdkUrl:""}||void 0,u=e=>e.stream&&c(e.stream)||e.altStream&&c(e.altStream),m=e=>e/1e3,g=(e,t)=>{var n,i,a,o,r,s;return{__typename:"BroadcastTranscription",id:e,isEnabled:null===(n=t.transcription)||void 0===n?void 0:n.isEnabled,isSuppressed:null===(i=t.transcription)||void 0===i?void 0:i.isSuppressed,translationLanguages:null===(a=t.transcription)||void 0===a?void 0:a.translationLanguages,transcriptionLanguage:null===(o=t.transcription)||void 0===o?void 0:o.transcriptionLanguage,captionsOriginUrl:null===(r=t.transcription)||void 0===r?void 0:r.captionsOriginUrl,captionsCacheUrl:null===(s=t.transcription)||void 0===s?void 0:s.captionsCacheUrl}},p=e=>{var t,n,i,a;return{id:(null===(t=e.aesKey)||void 0===t?void 0:t.id)||"",iv:(null===(n=e.aesKey)||void 0===n?void 0:n.iv)||"",expiry:(null===(i=e.aesKey)||void 0===i?void 0:i.expiry)||"",key:(null===(a=e.aesKey)||void 0===a?void 0:a.key)||""}},v=e=>{var t,n,i,a,o;return{attendeeHubName:(null===(t=null==e?void 0:e.signalR)||void 0===t?void 0:t.attendeeHubName)||null,eventTeamHubName:(null===(n=null==e?void 0:e.signalR)||void 0===n?void 0:n.eventTeamHubName)||null,url:(null===(i=null==e?void 0:e.signalR)||void 0===i?void 0:i.url)||null,querystrings:(null===(a=null==e?void 0:e.signalR)||void 0===a?void 0:a.querystrings)||null,setCookieUrl:(null===(o=null==e?void 0:e.signalR)||void 0===o?void 0:o.setCookieUrl)||null}},h=e=>{var t;return{__typename:"StreamResource",attendeeEmbed:(null===(t=e.streamResource)||void 0===t?void 0:t.attendeeEmbed)||""}},f=e=>{var t,n,i;return(null==e?void 0:e.access)&&{__typename:"BroadcastAccess",useLiveEventAuthorizationV2:null===(t=null==e?void 0:e.access)||void 0===t?void 0:t.useLiveEventAuthorizationV2,disableLobby:null===(n=null==e?void 0:e.access)||void 0===n?void 0:n.disableLobby,inInvitation:null===(i=null==e?void 0:e.access)||void 0===i?void 0:i.inInvitation,attendeeAuthorization:y(e)}||void 0},y=e=>{var t;return(null===(t=null==e?void 0:e.access)||void 0===t?void 0:t.attendeeAuthorization)&&{__typename:"BroadcastAttendeeAuthorization",errorCode:e.access.attendeeAuthorization.errorCode,subCode:e.access.attendeeAuthorization.subCode,details:e.access.attendeeAuthorization.details}||void 0};const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"broadcast"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"roleHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"broadcast"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"roleHint"},value:{kind:"Variable",name:{kind:"Name",value:"roleHint"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastFragment"}}]}}]}},...n(336265)._L.definitions]},S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showInMeetingReport"}}]}}]}}]};var b=n(61858),C=n(628235),w=n(759207);const N=e=>{const[t,n,i,o,r]=e.split("__");return{tenantId:t,organizerId:n,threadId:i,messageId:o,sessionId:r,roleHint:a.tf6.Attendee}},T=(e,t,n,a,o,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const i=(0,w.G5)(t),l=e.readQuery({query:k,variables:{id:i}});if(l)return l.broadcast;{const l=yield n.getAttendeeMeeting(a),d=r(t,o,l);return I(e,s,i,d),d}}catch(e){throw s.error(e),e}})),I=(e,t,n,i)=>{const a={broadcast:i};try{e.writeQuery({query:k,variables:{id:n},data:a})}catch(e){t.error(e)}},E=(e,t,n,a,o,r,s,l,d,c,u)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,m;if(A(e))return!1;const g=_(s,a,o,d,l,c),p=O(a,n);r.joinId=null===(m=null===(i=null==e?void 0:e.signalR)||void 0===i?void 0:i.querystrings)||void 0===m?void 0:m.joinid;const v=x(a,r,n,g,l,s,o,e.meetingStatus);try{const i=!o||u;return e.signalR&&e.signalR.url&&!e.error&&i?(yield t.subscribeToBroadcast(a,e.signalR,g,p,v),!0):!e.error&&(n.startPollingAttendeeMeeting(a,r,g,e.meetingStatus,!0),!0)}catch(t){return l.error(t),n.startPollingAttendeeMeeting(a,r,g,e.meetingStatus,!0),!0}})),A=e=>{var t;return e.meetingStatus===a.ytK.Stopped&&(null===(t=e.streamingDetails)||void 0===t?void 0:t.stream.wamsStreamingUrl)},_=(e,t,n,i,a,o)=>(s,l)=>{const c=D(o,t);let u="",m="";try{const o=(0,w.G5)(t),p=i.readQuery({query:k,variables:{id:o}}),v=null==p?void 0:p.broadcast;let h;if(v)if(h=Object.assign({},v),l===b.N.transcriptionStateUpdate)h.transcription=g(t,s),u="SignalR",m=b.N.transcriptionStateUpdate;else if(l===b.N.streamUpdateHubEvent){const e=d(t,s);if(F(e,v.streamingDetails))return void c.stop({broadcastData:"Duplicated update skipped"});h.streamingDetails=M(v,e),h.broadcastRestartVersion=s.broadcastRestartVersion,h.meetingStatus=R(v.broadcastRestartVersion,s.broadcastRestartVersion),u="SignalR",m=b.N.streamUpdateHubEvent}else h=Object.assign({},r(t,n,s)),u="Attendee Polling";else h=Object.assign({},r(t,n,s));const f=P(h);a.log(f),c.stop({broadcastData:JSON.stringify({updateSource:u,updateType:m,details:f})}),e.publish(`${b.V}-${t}`,{broadcastUpdatedEvent:h}),a.log(`New broadcast info successfully published for ${t}`),I(i,a,o,h)}catch(e){a.error(e),c.fail({broadcastData:`Error while processing broadcast update. updateSource: ${u}, updateType: ${m}`,broadcastError:e&&e.message})}},D=(e,t)=>{const n=e.newScenario(C.RG.BroadcastSubscriptionUpdate);return n.appendEventData({"Thread.Id":(0,w.G5)(t)}),n},F=(e,t)=>(null==e?void 0:e.stream.wamsStreamingUrl)===(null==t?void 0:t.stream.wamsStreamingUrl)&&(null==e?void 0:e.altStream.wamsStreamingUrl)===(null==t?void 0:t.altStream.wamsStreamingUrl),M=(e,t)=>{var n,i,a;return{__typename:"BroadcastStreamingDetails",stream:(null==t?void 0:t.stream)||(null===(n=e.streamingDetails)||void 0===n?void 0:n.stream),altStream:(null==t?void 0:t.altStream)||(null===(i=e.streamingDetails)||void 0===i?void 0:i.altStream),id:(null==t?void 0:t.id)||(null===(a=e.streamingDetails)||void 0===a?void 0:a.id)}},R=(e,t)=>(t=t||0)>(e=e||0)?a.ytK.Suspended:a.ytK.Created,P=e=>{var t,n,i,a,o,r,s,l;const d=e.broadcastRestartVersion,c=e.meetingStatus,u=null===(n=null===(t=e.streamingDetails)||void 0===t?void 0:t.stream)||void 0===n?void 0:n.wamsStreamingUrl,m=!!(null===(a=null===(i=e.streamingDetails)||void 0===i?void 0:i.stream)||void 0===a?void 0:a.decryptionToken),g=null===(r=null===(o=e.streamingDetails)||void 0===o?void 0:o.altStream)||void 0===r?void 0:r.wamsStreamingUrl,p=!!(null===(l=null===(s=e.streamingDetails)||void 0===s?void 0:s.altStream)||void 0===l?void 0:l.decryptionToken),v=e.transcription;return`broadcastRestartVersion: ${d}, meetingStatus: ${c}, stream: ${u}, isDecryptionTokenAvailable: ${m}, altStream: ${g}, isAltDecryptionTokenAvailable: ${p}, isTranscriptionEnabled: ${null==v?void 0:v.isEnabled}, isTranscriptionSuppressed: ${null==v?void 0:v.isSuppressed}`},O=(e,t)=>()=>{t.stopPollingAttendeeMeeting(e)},x=(e,t,n,i,a,o,r,s)=>l=>{if(!l){a.log("broadcast-subscripotion disconnect callback called not intentionally. Subscribing to attendee service polling.");try{n.startPollingAttendeeMeeting(e,t,i,s,!1)}catch(t){L(a,o,t.message,e,r)}}},L=(e,t,n,i,a)=>{e.error("Error while starting broadcast updates subscription");const o=r(i,a,{error:{errorMessage:n}});t.publish(`${b.V}-${i}`,{broadcastUpdatedEvent:o})};var U=n(118824);const B={Query:{broadcastAttendeeMeeting(e,{broadcastAttendeeMeetingParams:t},{cache:n,coreSettings:a,getBroadcastAttendeeService:o,loggerFactory:r}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=a.get(U.J.MeetingArtifacts);let i=!0;const l=r.newLogger("broadcastAttendeeMeetingQuery"),{overflowAttendance:d}=e;if(t){if(d)try{i=((e,t)=>{var n;if("Disabled"===t)return!1;if("Enabled"===t)return!0;const i=!(!e||!e.userPreferences||"true"!==e.userPreferences.showInMeetingReport&&"false"!==e.userPreferences.showInMeetingReport);return"EnabledUserOverride"===t?!i||"false"!==(null===(n=null==e?void 0:e.userPreferences)||void 0===n?void 0:n.showInMeetingReport):"DisabledUserOverride"!==t||!!i&&"false"!==(null==e?void 0:e.userPreferences.showInMeetingReport)})(n.readQuery({query:S}),e.allowTrackingInReportPolicy)}catch(e){l.error("Failed to fetch allowTrackingInReportPolicy"),l.error(e)}return{__typename:"BroadcastAttendeeMeeting",id:(c=yield(yield o()).getAttendeeMeeting(Object.assign(Object.assign({},t),{allowTrackingInReport:i}))).correlationId,title:c.subject,stream:s(c.stream),altStream:s(c.altStream),qna:c.qna,yammer:c.yammer&&{__typename:"YammerMetadata",broadcastId:c.yammer.broadcastId,groupId:c.yammer.groupId,isEnabled:c.yammer.isEnabled,eventUrl:c.yammer.event},supportUrl:c.supportUrl}}return null;var c}))},broadcastCaptions(e,{id:t,broadcastId:n,culture:a,currentPlayerTime:o},{cache:r,getBroadcastCaptionsService:s,loggerFactory:l}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=l.newLogger("broadcastCaptionsQuery");if(!t&&!n||!a)return e.error("Invalid params sent to broadcastCaptions Query"),Promise.reject("Invalid params sent to broadcastCaptions Query");e.log(`Fetching the captions for: ID: ${t}, Culture: ${a}, Time: ${o}`);const i=t||(0,w.G5)(n);try{const e=r.readQuery({query:k,variables:{id:i}});if(e&&e.broadcast.aesKey&&e.broadcast.transcription){const t={aesKey:e.broadcast.aesKey,aesKeyRefresh:e.broadcast.aesKeyRefresh,correlationId:e.broadcast.correlationId,transcription:e.broadcast.transcription},n=yield s();n.setCurrentCaptionLanguage(i,a);return(e=>{const t=[];for(const n of e){if(""===n.Text)continue;const e={__typename:"Captions",start:m(n.TimestampMs),text:n.Text,end:m(n.EndTimestampMs)};t.push(e)}return t})(yield n.getCaptions(o,i,t,a))}}catch(t){e.error("Failed to fetch captions"),e.error(t)}return Promise.resolve([])}))},broadcast(e,{id:t,roleHint:n},{getBroadcastAttendeeService:o,loggerFactory:s}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const[e,i,l,d,c]=t.split("__");if(!(e&&i&&l&&d)){const e=`Invalid Id: ${t}`;throw s.newLogger("broadcast").error(e),new Error(e)}const u=!!c,m=u?a.G7F.Overflow:a.G7F.QuickStart,g=yield(yield o()).getAttendeeMeeting({tenantId:e,organizerId:i,threadId:l,messageId:d,sessionId:c,roleHint:n,broadcastType:m});return r(t,u,g)}))}},Mutation:{startLiveStreamCaptions(e,{id:t,liveStreamId:n,culture:a},{cache:o,getBroadcastCaptionsService:r,getLiveStreamRenderingService:s,loggerFactory:l}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=l.newLogger("liveStreamCaptionsMutation");try{const i=o.readQuery({query:k,variables:{id:t}});if(!i)throw new Error("Could not find broadcast data");const l=yield s(),d=yield r(),c=()=>l.getDiagnosticData(n).then((t=>(e.log(`The times are: ${t.currentAbsoluteTime}, ${t.currentMediaTime}, ${t.currentPlayPosition}`),t.currentAbsoluteTime))),u=e=>{l.addCues(n,e)},m={aesKey:i.broadcast.aesKey,aesKeyRefresh:i.broadcast.aesKeyRefresh,correlationId:i.broadcast.correlationId,transcription:i.broadcast.transcription};d.startCaptionsForStream(n,t,m,a,c,u)}catch(t){e.error("Failed to fetch captions"),e.error(t)}return null}))},stopLiveStreamCaptions(e,{liveStreamId:t},{getBroadcastCaptionsService:n,getLiveStreamRenderingService:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=o.newLogger("liveStreamCaptionsMutation");e.log(`Stopping captions for stream ${t}`);try{const e=yield n(),i=yield a();return e.stopCaptionsForStream(t),i.clearCues(t),!0}catch(n){return e.error(`Error while stopping captions for stream ${t}`),e.error(n),!1}}))},toggleLiveStreamCaptionButton(e,{liveStreamId:t,shouldShowButton:n},{getLiveStreamRenderingService:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=o.newLogger("toggleLiveStreamCaptionButton");e.log(`Setting the caption button visibility in the player to ${n} for stream ${t}`);try{return(yield a()).showCaptions(t,n),!0}catch(i){return e.error(`Error while setting the caption button to ${n} for stream ${t}`),!1}}))},subscribeToBroadcastUpdates(e,{id:t},{loggerFactory:n,getBroadcastAttendeeService:a,getBroadcastSignalRService:o,pubsub:r,cache:s,coreSettings:l,scenarioFactory:d}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield a(),c=yield o(),u=n.newLogger("broadcastSubscribe"),{enableSignalrForOverflow:m}=l.get(U.J.Broadcast);return yield((e,t,n,a,o,r,s,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=N(e),d=!!i.sessionId;try{const c=yield T(o,e,t,i,d,r);return c?(a.publish(`${b.V}-${e}`,{broadcastUpdatedEvent:c}),yield E(c,n,t,e,d,i,a,r,o,s,l)):(L(r,a,"Error subscribing to broadcast updates",e,d),!1)}catch(t){return r.error(t),L(r,a,t.message,e,d),!1}})))(t,e,c,r,s,u,d,!!m)}))},unsubscribeFromBroadcastUpdates(e,{id:t},{getBroadcastAttendeeService:n,getBroadcastSignalRService:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=o.newLogger("broadcastUnsubscribe");e.log(`Stopping subscription for broadcast ${t}`);try{(yield n()).stopPollingAttendeeMeeting(t);return(yield a()).unsubscribeFromBroadcast(t),!0}catch(n){return e.error(`Error while unsubscribing from broadcast ${t}`),e.error(n),!1}}))}},Subscription:{broadcastQnaFeedStatusEvent:{subscribe:(e,{id:t},{pubsub:n})=>n.asyncIterator(t)},broadcastUpdatedEvent:{subscribe:(e,{broadcastId:t},{pubsub:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return n.asyncIterator(`${b.V}-${t}`)}))}}},j=()=>({Mutation:{updateBroadcastQnaFeedStatus:(e,{id:t,isQnaFeedLoaded:n,hasNewMessages:i},{pubsub:a})=>(null==i&&null==n||a.publish(t,{broadcastQnaFeedStatusEvent:{isQnaFeedLoaded:!!n,hasNewMessages:!!i}}),{__typename:"BroadcastQnaFeedStatus",isQnaFeedLoaded:!!n,hasNewMessages:!!i})}})},119653:(e,t,n)=>{"use strict";n.d(t,{w:()=>s});var i=n(892891),a=n(967215);const o="calendarv2",r=e=>{const t=e.get(o);return t?(0,a.D)(t):{}},s={Query:{calendarSettingsFromLocalStorage:(e,t,{localStorage:n})=>(({shouldGetDateRangeType:e,shouldGetWorkHours:t,shouldGetWorkWeekDays:n},i)=>{const a=r(i);return{__typename:"ICalendarSettings",dateRangeType:e&&a.dateRangeType||null,workHours:t&&a.workHours?Object.assign({__typename:"IWorkHours"},a.workHours):null,workWeekDays:n&&a.workWeekDays||null}})(t,n)},Mutation:{saveCalendarSettingsInLocalStorage:(e,t,{localStorage:n})=>((e,t)=>{const n=r(t);return(0,i.forOwn)(e,((e,t)=>{null!=e&&(n[t]=e)})),t.setSafe(o,JSON.stringify(n)),!0})(t,n)}}},446221:(e,t,n)=>{"use strict";n.d(t,{wz:()=>m,FJ:()=>T,Z6:()=>w,gL:()=>_,I6:()=>b,Nz:()=>I,C9:()=>g,eM:()=>C,jF:()=>A,QV:()=>N,qz:()=>E,g:()=>W,_w:()=>F,Li:()=>D,Oh:()=>x,vV:()=>f,yw:()=>h,bF:()=>z,nh:()=>y,M3:()=>k,gv:()=>O,e7:()=>B,mB:()=>j,nP:()=>L,Jw:()=>H,kc:()=>$,bW:()=>M,s6:()=>P,tx:()=>U,tW:()=>p,bC:()=>v});var i=n(395816),a=n(118824),o=n(410061),r=n(93966),s=n(145937),l=n(960754);const d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"breakoutRoomParticipants"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BreakoutRoom"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coordinates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"threadId"}}]}},{kind:"Field",name:{kind:"Name",value:"participants"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"upn"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"role"}}]}}]}}]};var c=n(226790),u=n(293761);const m="acceptStreamPermissionsDebug",g={__typename:"PrejoinState",incomingAudio:!0,isPSTN:!1,withAudio:!0,withVideo:!1,volume:10,wasMuteToggledByUser:!1,roomDetails:{__typename:"RoomDetails",room:null,roomParticipantInMeeting:null,wasRoomBluetoothProximityTriggered:!1,wasRoomLoudSpeakerInTheMeetingTriggered:!1},wasAutomuteTriggered:!1,isAuditoriumModeEnabled:!1,shouldShowCameraCoachMark:!1,shouldAutoExpandRoomsDropdown:!1};function p(e){e.writeQuery({query:l.vB,data:{prejoinState:g}})}function v(e){e.writeQuery({query:c._,data:{shouldShowVideoApp:!1}})}const h=e=>({__typename:"CallingScreenStatus",id:e,isDtmfKeypadVisible:!1,isPstnDialogVisible:!1,isBroadcastRestartWaitingOverlayVisible:!1,isChatBubblesSuppressed:!1,hasTogetherModeBeenPinned:!1,isShareTrayVisible:!1,hasOnMeetingLandingElementBeenShown:!1,isAudienceBackgroundDialogVisible:!1,isTogetherModeSeatSelectionDialogVisible:!1,isAnnouncementDialogVisible:!1,isUnlockMeetingDialogVisible:!1,isInterpretationDialogVisible:!1}),f=e=>({__typename:"CallingScreenLayout",currentLayout:e.get(a.J.Calling).defaultLayoutSelection||i.XoC.Grid,meetingRoomLayoutSelection:i.XKC.ContentAndPeople,lastSelectedLayout:i.XoC.Grid,initialLayoutBeforeContentPopout:i.XoC.Grid,meetingRoomLayoutPreferences:[],isFocusModeEnabled:!1,isNarrowModeActiveByUser:!1,isNarrowModeActiveByResize:!1,isNarrowModeActiveInSpatialAudio:!1,isHostViewModeNoContentActive:!1,isHostViewModeWithContentActive:!1,isLayoutFlipped:!1,isPresenterHostMode:!1,isContentPoppedOut:!1,isPresenterHostModeWithContent:!1,isVideoInCentralSegment:!1,currentMixedGridGallerySize:null,isMyselfInBarSegment:!1}),y=e=>({__typename:"PinnedParticipantIds",participantIds:[],id:e}),k=e=>({__typename:"VideoScanTypeResponse",videoScanType:i.bax.none,id:e}),S="microsoft_none",b={__typename:"BackgroundsInfo",imageId:S,imagePath:""},C={__typename:"SelectedAvatarInfo",id:"SelectedAvatarInfoWithAppId:null",appId:null,filterId:null,isFilterApplyUnderLoadingProcess:null,imageId:S},w={__typename:"AvatarAppAvailabilityInfo",available:!1,dataFetched:!1},N={__typename:"VideoEffectInfo",appId:"",appName:"",filterId:""},T={__typename:"ActiveVideoEffects",first:N,second:N,third:N},I={__typename:"InstallingVideoEffectInfo",appId:"",appName:"",developerName:"",effectCount:0,filterId:""},E={__typename:"VideoEffectsCurrentInfo",isInstallingVideoEffectInfo:I,isShowingAppPageVideoEffect:N,isAppliedVideoEffect:N,isUnderApplyingProcessVideoEffect:N,allVideoApps:[]},A={__typename:"VideoAppInfo",appId:"",appName:"",developerName:"",effectCount:1,isInstalled:!0},_={__typename:"AvatarPayload",avatarItems:[]},D=(e,t)=>{var n;return(null===(n=t.readQuery({query:r.Q,variables:{id:e}}))||void 0===n?void 0:n.callParticipants)||[]},F=(e,t)=>t.readFragment({id:R(e),fragment:u.u_,fragmentName:"participantFields"})||null,M=(e,t,n)=>{const i=F(e,n);i&&n.writeFragment({id:R(e),fragment:u.u_,data:Object.assign(Object.assign({},i),t),fragmentName:"participantFields"})},R=e=>`Participant:{"participantId":"${e}"}`,P=(e,t)=>{e.writeQuery({query:s.j,data:{callingAlerts:t}})},O=e=>`No call found with id ${e}`,x=(e,t)=>{var n;const a=e.coordinates;return{conversationId:(0,o.N6)(a)&&a.conversationId||null,isOneOnOne:e.type===i.GXC.OneToOneCall,isMeetup:e.type===i.GXC.Meeting,isBroadcast:(0,o.N6)(a)&&"LegacyMeetingCoordinates"===a.__typename&&!!a.broadcast,broadcastRole:(0,o.N6)(a)&&"LegacyMeetingCoordinates"===a.__typename?(0,o.N6)(a)&&(null===(n=a.broadcast)||void 0===n?void 0:n.role):null,withVideo:t&&t.outgoingVideo,withAudio:t&&t.outgoingAudio}},L=(e,t)=>{if(e)try{return t.readFragment({id:`BreakoutRoom:${e}`,fragment:d})}catch(t){throw new Error(`room ${e} doesn't exist`)}return null},U=({roomFragment:e,cache:t,updateParticipants:n})=>{const i=Object.assign(Object.assign({},e),{participants:n(e.participants||[])});try{t.writeFragment({id:`BreakoutRoom:${e.coordinates.threadId}`,fragment:d,data:i})}catch(e){throw new Error("Error updating room participants in cache")}return i},B=e=>({__typename:"BreakoutRoomParticipant",mri:e,role:null,objectId:null,upn:null}),j=e=>({tenantId:"tenantId",organizerId:null!=e?e:"6763e6ac-1bfd-48ec-8352-a3e3a066c81c",threadId:"threadId",messageId:"messageId",additionalMessageId:"additionalMessage"}),W=()=>{const e=j();return{__typename:"BreakoutRoom",coordinates:Object.assign(Object.assign({__typename:"RoomCoordinates"},e),{additionalMessageId:"additionalMessage"}),roomName:"Room 1",sourceMeetingCoordinates:Object.assign(Object.assign({__typename:"RoomCoordinates"},e),{additionalMessageId:"additionalMessage"}),participants:[B("6763e6ac-1bfd-48ec-8352-a3e3a066c81c")],restrictChatAccess:!0,isOpened:!1,meetingJoinUrl:"https://teams.microsoft.com",clientActionState:null}},V=(e,t)=>e?Object.assign(Object.assign({},e),{__typename:"VideoEffectInfo"}):t,H=e=>({__typename:"ActiveVideoEffects",first:V(e.activeVideoEffects.first,N),second:V(e.activeVideoEffects.second,N),third:V(e.activeVideoEffects.third,N)}),$=(e,t)=>({__typename:"VideoEffectsCurrentInfo",allVideoApps:t&&t.allVideoApps&&t.allVideoApps.length>0&&t.allVideoApps.map((e=>Object.assign(Object.assign({},e),{__typename:"VideoAppInfo"})))||e.allVideoApps,isInstallingVideoEffectInfo:t.isInstallingVideoEffectInfo?Object.assign(Object.assign({},t.isInstallingVideoEffectInfo),{__typename:"InstallingVideoEffectInfo"}):e.isInstallingVideoEffectInfo,isShowingAppPageVideoEffect:V(t.isShowingAppPageVideoEffect,e.isShowingAppPageVideoEffect),isAppliedVideoEffect:V(t.isAppliedVideoEffect,e.isAppliedVideoEffect),isUnderApplyingProcessVideoEffect:V(t.isUnderApplyingProcessVideoEffect,e.isUnderApplyingProcessVideoEffect)}),z=()=>i.rsL.None},258705:(e,t,n)=>{"use strict";n.d(t,{b:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataResolversBrowserCallingUpdateCallingStateMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newState"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CurrentCallingState"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateCallingState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"newState"},value:{kind:"Variable",name:{kind:"Name",value:"newState"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},93966:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callParticipants"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callParticipants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantFields"}}]}}]}},...n(293761).u_.definitions]}},145937:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAlert"}}]}}]}},...n(517344).hl.definitions]}},256319:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserCallingShouldAvatarMenuItemSelectedQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldAvatarMenuItemSelected"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},425851:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserCallingShouldKeepPreviewWindowInSidePanelOpenQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldKeepPreviewWindowInSidePanelOpen"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},960754:(e,t,n)=>{"use strict";n.d(t,{vB:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"prejoinState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"prejoinState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntentId"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"incomingAudio"}},{kind:"Field",name:{kind:"Name",value:"isPSTN"}},{kind:"Field",name:{kind:"Name",value:"withAudio"}},{kind:"Field",name:{kind:"Name",value:"withVideo"}},{kind:"Field",name:{kind:"Name",value:"volume"}},{kind:"Field",name:{kind:"Name",value:"wasAutomuteTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasMuteToggledByUser"}},{kind:"Field",name:{kind:"Name",value:"roomDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomDetails"}}]}},{kind:"Field",name:{kind:"Name",value:"isAuditoriumModeEnabled"}},{kind:"Field",name:{kind:"Name",value:"shouldShowCameraCoachMark"}},{kind:"Field",name:{kind:"Name",value:"shouldAutoExpandRoomsDropdown"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"roomDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RoomDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"room"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomData"}}]}},{kind:"Field",name:{kind:"Name",value:"roomParticipantInMeeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomData"}}]}},{kind:"Field",name:{kind:"Name",value:"wasRoomBluetoothProximityTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasRoomLoudSpeakerInTheMeetingTriggered"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"roomData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientRoom"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"proximityValidationCode"}}]}}]}.definitions]}},226790:(e,t,n)=>{"use strict";n.d(t,{_:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shouldShowVideoApp"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowVideoApp"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},665454:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shouldShowVideoEffectsPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowVideoEffectsPreview"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},890902:(e,t,n)=>{"use strict";n.d(t,{s:()=>W});var i=n(231191),a=n(6813),o=n(486328),r=n(118824),s=n(723373),l=n(628235),d=n(903001),c=n(255044),u=n(281857),m=n(642115),g=n(249412);const p=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=n.filter((e=>!e.shareUrl)).map((e=>e.id));if(0===i.length)return n;const a=yield e.shareDriveItems(i),o=new Map;a.forEach(((e,t)=>o.set(i[t],e)));const r=[];for(const e of n){const n=o.get(e.id);if(n){if(!n.link){const n=`ShareUrl (link.webUrl) is not present in createLink response for fileId: ${e.id}`,i={[g.z.internalErrorCode]:"ShareUrlIsMissingFromResponse",[g.z.logErrorMessage]:n};throw t.newLogger("ChatResolversUtilsFiles").error(`${n}. ${JSON.stringify(i)}`),(0,m.Tr)(u.w5.AddShareUrlOnSendMessage,u.jK.Undefined,"",i,n)}r.push(Object.assign(Object.assign({},e),{shareUrl:n.link.webUrl,shareId:n.shareId}))}else r.push(e)}return r})),v=e=>{var t;return!!(null===(t=null==e?void 0:e.files)||void 0===t?void 0:t.length)},h=(e,t,n)=>{const i=e.newLogger("ChatResolversUtilsFiles"),{reason:a}=n;if(a){const e={errorCode:a[g.z.internalErrorCode]||n.code||"ErrorCodeMissing",correlationId:a[g.z.correlationId],statusCode:a[g.z.httpCode],message:a[g.z.logErrorMessage]||"Log message is not present in reason bag",errors:a[g.z.logErrorMessage]};throw t.fail(e),i.error(`Failed to generate ShareUrl for files. ${JSON.stringify(e)}`),n}const o={errorCode:n.code||u.jK.Unknown,message:"thrown error is not an instance of IError. So not much data available",errors:`${n.context}_${n.subContext}`};throw t.fail(o),i.error(`Failed to generate ShareUrl for files and as well error is not instance of IError ${JSON.stringify(o)}`),n},f=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{return yield e()}catch(e){const i="Failed to lazy load drive item share service",a={[g.z.internalErrorCode]:e.code||"FailedToLazyLoadDriveItemShareService",[g.z.logErrorMessage]:i,innerError:e},o={errorCode:a[g.z.internalErrorCode],message:a[g.z.logErrorMessage]};n.fail(o);throw t.newLogger("ChatResolversUtilsFiles").error(`Failed to get DriveItemShareService. error: ${JSON.stringify(o)}`),(0,m.Tr)(u.w5.AddShareUrlOnSendMessage,u.jK.FailedToLazyLoadService,"",a,i)}}));var y=n(870822),k=n(892891),S=n(107844),b=n(266641),C=n(355272),w=n(870209),N=n(907207),T=n(975652),I=n(889705),E=n(117294);const A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"optionalTelemetry"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"optionalTelemetry"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidCorrelationId"}},{kind:"Field",name:{kind:"Name",value:"fluidDataLossOccurred"}},{kind:"Field",name:{kind:"Name",value:"fluidDataLossPrevented"}}]}}]}}]};var _=n(523556),D=n(395816);const F=e=>{switch(e){case"Standard":return"NORMAL";case"Important":return"HIGH";case"Urgent":return"URGENT"}return null},M=e=>{var t;const n=null===(t=e.computed)||void 0===t?void 0:t.cards;if(!n)return!1;return!!(0,k.find)(n,(e=>"application/vnd.microsoft.card.fluid"===e.contentType))},R=e=>{var t;const n=null===(t=e.computed)||void 0===t?void 0:t.cards;if(n){const e=[];return n.forEach((t=>{e.push(t.appId)})),null==e?void 0:e.join(",")}return""},P=e=>{const t=new RegExp(I.T.reply,"g");return(e.match(t)||[]).length},O=(e,t)=>e.split(" ").filter((e=>e===`itemtype="${t}"`)).length,x=(e,t,n,i,a,o,r)=>{var s,l,d,c,u,m,g,p,v,h,f;return Object.assign({"DataBag.messagelength":(f=e.content,f?f.replace(/(<([^>]+)>)/gi,""):"").length,"DataBag.size":e.content.length,"DataBag.importantflag":F(e.importance),"DataBag.messageType":o?r?"replyConversation":"newConversation":"Update"===t?"chatEdit":"newP2PMessage","DataBag.postType":"Announcement"===e.postType?"announcement":"normal","DataBag.richText":(h=e.messageType,"RichText/Html"===h),"DataBag.fluidCard":M(e),"DataBag.appId":R(e),"DataBag.sfbInteropMessage":(null==i?void 0:i.chatType)===D.z_3.SfBInteropChat,"DataBag.mricollection":(null===(l=null===(s=null==i?void 0:i.memberIds)||void 0===s?void 0:s.map((e=>(0,w.Q2)(e))))||void 0===l?void 0:l.join(" "))||"","DataBag.rostersize":(null===(d=null==i?void 0:i.memberIds)||void 0===d?void 0:d.length)||0,"DataBag.attachments":(null===(c=e.files)||void 0===c?void 0:c.length)||0,"DataBag.attachmentIds":(null===(m=null===(u=e.files)||void 0===u?void 0:u.map((e=>e.id)))||void 0===m?void 0:m.join(" "))||"","DataBag.fileTypeList":(null===(p=null===(g=e.files)||void 0===g?void 0:g.map((e=>e.type)))||void 0===p?void 0:p.filter((e=>!(0,k.isNil)(e))))||[],"DataBag.suggestedFile":null===(v=e.files)||void 0===v?void 0:v.some((e=>"smartReply"===e.context)),"DataBag.leftRailDirective":o?"channel-list":"chat-list","DataBag.messageID":e.id!==e.clientMessageId?e.id:void 0,"DataBag.isNewChat":!!a,"DataBag.newChatIntentId":a,"DataBag.tflOffNetworkEmailCount":(null==i?void 0:i.memberIds)?i.memberIds.filter((e=>e.startsWith(N.b6))).length:0,"DataBag.tflOffNetworkOneWayPhoneCount":(null==i?void 0:i.memberIds)?i.memberIds.filter((e=>e.startsWith(N.EI))).length:0,"DataBag.tflSMSMembersCount":(null==i?void 0:i.memberIds)?i.memberIds.filter(w.yj).length:0,"DataBag.offNetworkContactsSelected":(null==i?void 0:i.memberIds)?i.memberIds.filter(w.$i).length:0,"DataBag.hasAADFederatedMembers":(null==i?void 0:i.hasFederatedUser)||!1,"DataBag.hasMSAFederatedMembers":(null==i?void 0:i.hasTflConsumerUser)||!1,"DataBag.quotedReplyCount":P(e.content),"DataBag.groupTemplateType":null==i?void 0:i.groupTemplate,"DataBag.chatType":L(i),"DataBag.GIF":O(e.content,I.T.giphy),"DataBag.Sticker":O(e.content,I.T.sticker)},((e,t)=>{const n={};if(e&&(null==t?void 0:t.isOneOnOne)&&(null==t?void 0:t.hasFederatedUser)){const e=_.eo.getTflExtendedDirectoryMembership(null==t?void 0:t.extendedDirectoryRedemptionRequired);e&&(n["DataBag.TFLUserInED"]=!0,n["DataBag.TFLUserEDState"]=e)}return n})(n,i))},L=e=>(null==e?void 0:e.guardianChatInfo)?S.Ml.GuardianChat:null,U=(e,t,n,i,a,o,r,s,l,c,u,m,g)=>{var p;const v=((e,t)=>{var n,i;if(!e||e.chatSubType===T.k2.Channel)return t?b.Th.Channel:void 0;const a=null!==(i=null===(n=e.memberIds)||void 0===n?void 0:n.map((e=>e)))&&void 0!==i?i:[],o=(0,w._K)(e.id,e.isFederated,e.isOneOnOne,e.hasFederatedUser,a);return(0,d.NL)(e.id,e.chatType,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,o,e.isFederated)})(s,u);let h={};v===b.Th.Botchat&&(h=((e,t)=>{var n,i,a;const o=null===(n=null==e?void 0:e.memberIds)||void 0===n?void 0:n.find(w.bl);if(o){const e=o.substring(N.at.BotPrefix.length);try{const n=t.readQuery({query:E.Cj,variables:{installedContext:{scope:D.qi6.Personal}}});if(n){const t=null===(i=n.installedAppsV2)||void 0===i?void 0:i.filter((t=>{var n,i,a;return(null===(a=null===(i=null===(n=null==t?void 0:t.definition)||void 0===n?void 0:n.bots)||void 0===i?void 0:i[0])||void 0===a?void 0:a.id)===e}));if(t&&t.length>0)return{id:null===(a=t[0])||void 0===a?void 0:a.id,capabilityId:e,scenarioCapability:C.Ky.bots}}}catch(e){}}return{}})(s,c));const f=u?b.wh.Channel:b.wh.Chat,y=u?"channel":"chat";a.recordPanelAction({actionGesture:b.uS.click,actionOutcome:b.$K.submit,actionOutcomeNew:b.$K.submit,actionScenarioType:b.Yu.composeMsg,actionScenario:b.Tk.composeSendMessage,moduleName:b.rA.sendButton,moduleNameNew:b.rA.sendButton,moduleType:b.PO.sendMessageButton,moduleTypeNew:b.PO.sendMessageButton,panelRegion:b.Ai.main,panelType:f,panelRegionNew:b.Ai.main,panelTypeNew:f,threadId:e,teamId:g,threadMembers:null===(p=null==s?void 0:s.memberIds)||void 0===p?void 0:p.length,threadType:v,actionWorkload:u?b.sz.channelContent:b.sz.chatContent,actionSubworkload:b.eD.composeMsg,tabId:"",tabType:"conversations",tabIdNew:"",tabTypeNew:"conversations",tabOrdinal:1,appName:y,dataBag:{id:"",data:Object.assign(Object.assign(Object.assign({},i),x(t,n,r,s,l,u,m)),B(c)),dispose:()=>{}},extensibilityData:h},o)};function B(e){var t,n,i;const a={};let o=null;try{o=e.readQuery({query:A})}catch(e){}const r=null==o?void 0:o.optionalTelemetry;return void 0!==(null==r?void 0:r.fluidDataLossOccurred)&&null!==(null==r?void 0:r.fluidDataLossOccurred)&&(a["DataBag.fluidDataLossOccurred"]=null===(t=null==o?void 0:o.optionalTelemetry)||void 0===t?void 0:t.fluidDataLossOccurred),void 0!==(null==r?void 0:r.fluidDataLossPrevented)&&null!==(null==r?void 0:r.fluidDataLossPrevented)&&(a["DataBag.fluidDataLossPrevented"]=null===(n=null==o?void 0:o.optionalTelemetry)||void 0===n?void 0:n.fluidDataLossPrevented),void 0!==(null==r?void 0:r.fluidCorrelationId)&&null!==(null==r?void 0:r.fluidCorrelationId)&&(a["Messaging.fluidCorrelationId"]=null===(i=null==o?void 0:o.optionalTelemetry)||void 0===i?void 0:i.fluidCorrelationId),a}var j=n(289895);const W={Mutation:{sendMessageWorker(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return V(e,t)}))},sendMessage(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return V(e,t)}))}}},V=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n,a;const{convId:o,action:d,originalConvId:u,withChatNetworkFallback:m,searchSessionId:g,sendFromChannel_ToBeRefactored:k}=e;let S=e.message;const{cache:b,coreSettings:C,loggerFactory:w,offlineCacheManager:N,getDriveItemShareService:T,scenarioFactory:I,channelView:E,teamId:A,getPeopleService:_}=t,{enableInstalledAppsV2:D,enableBotsFileSharing:F,enableAppsQueryOptimization:M,botFileInfoFetchTimeout:R}=C.get(r.J.Extensibility),{enableFilesShareLinksInvite:P,enableSharingByCreateLinkAPI:O,enableFilesShareLinksFetchFederatedUsersAPI:x,enableFilesShareLinksFetchTflConsumerUsersAPI:L}=C.get(r.J.Files),{msgEnableChannelsV2:B}=C.get(r.J.Host),{enableScheduleMessage:W}=C.get(r.J.Messaging),{enableMeetingChatAttachmentsInMCO:V,meetingChatAttachmentsMap:q}=C.get(r.J.ArtifactsPlatform),{environment:Q}=C.get(r.J.Metadata),J=Q===s.s.life,Y={"DataBag.searchSessionId":g,"DataBag.isChannelsV2":!!B,"DataBag.channelView":E},K=w.newLogger("chatMutationForwardResolvers"),Z=(0,c.q)(d,S),X=I.findScenario(Z),ee=yield(0,y.mb)(o,b,t,K,w,m,null,null,void 0,u||"");null==X||X.mark(l.ck.ChatSendMessageGotChat);const te=$(u,b,K),ne=yield H(t);null==X||X.mark(l.ck.ChatSendMessageServicesLazyLoadComplete);const ie=(0,y.Fb)(b,o,D,M),ae=(0,y.QD)(b),oe=z(t,K);if((P||W)&&ee&&(0,y.iX)(ee)&&(S=yield(0,y.Ju)(S,ee,t,x,L)),(P||W)&&k&&(S=yield(0,y.DE)(S,b,o,K,t)),V){if(null===(n=null==S?void 0:S.files)||void 0===n?void 0:n.length){const e=yield _();!function(e,t,n,i,a,o,r,s){var l,d,c,u;if((null===(l=null==e?void 0:e.files)||void 0===l?void 0:l.length)&&("Recurring"===(null===(d=null==t?void 0:t.meetingInformation)||void 0===d?void 0:d.meetingType)||"Scheduled"===(null===(c=null==t?void 0:t.meetingInformation)||void 0===c?void 0:c.meetingType)))try{const s=`${null===(u=t.me)||void 0===u?void 0:u.objectId}@${t.addedByTenantId}`,l=`${t.meetingInformation.organizerId}@${t.meetingInformation.tenantId}`,d=t.meetingInformation.iCalUid||"",c=e.files,m=[];let g="",p="",v=!1;c.forEach((e=>{var n,a;const o=(null==e?void 0:e.type)||"";for(const e of i||[])if(e.enabled){if(null===(n=e.fileType)||void 0===n?void 0:n.includes(o)){g=e.appType,p=e.appId,v=!0;break}(null===(a=e.fileType)||void 0===a?void 0:a.includes("all"))&&(v=!0)}if(v){const n=((e,t,n,i)=>{var a;return{location:(null==e?void 0:e.objectUrl)||"",type:"MeetingChat",metadata:{appTitle:n||"",appId:i||"",userId:(null===(a=null==t?void 0:t.me)||void 0===a?void 0:a.objectId)||"",fileTitle:(null==e?void 0:e.title)||"",imageUrl:(null==e?void 0:e.previewUrl)||"",shareUrl:(null==e?void 0:e.shareUrl)||"",fileId:(null==e?void 0:e.id)||"",fileType:(null==e?void 0:e.type)||"",baseUrl:(null==e?void 0:e.baseUrl)||""}}})(e,t,g,p);m.push(n),g="",p="",v=!1}})),m.length>0&&(0,j.A)(r,o,a,"MeetingChat",d,d,l,s,m,((e,t)=>{var n;return{meetingUrl:(null===(n=e.meetingInformation)||void 0===n?void 0:n.meetingJoinUrl)||"https://teams.microsoft.com",threadId:e.id,messageId:"0",organizerUpn:t}})(t,n))}catch(e){s.error("addMeetingArtifacts mutation failed with errorCode")}}(S,ee,(yield G((null===(a=null==ee?void 0:ee.meetingInformation)||void 0===a?void 0:a.organizerId)||"",e))||"",q,w,I,t.getCollabObjectService,K)}}let re=yield(0,y.JB)(t,S,d,o,oe,Object.assign(Object.assign({},ne),{offlineCacheManager:N,telemetryDatabag:Y,convId:o,getInstalledMessageExtensionApps:ie,getAppDefinitions:ae}),X,!!k);return O&&S&&(re=yield((e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(v(a)){const i=t.newScenario(l.RG.FilesCreateShareLink),o=yield f(e,n,i);try{const e=yield p(o,n,a.files);return i.stop(),Object.assign(Object.assign({},a),{files:e})}catch(e){h(n,i,e)}}return Object.assign({},a)})))(T,I,w,re)),re=yield(0,y.R_)(ne.botsPlatformService,re,F,w,ee,R),re=(0,y.wX)(re,ee),((e,t,n,i,{loggerFactory:a,userBiService:o,cache:r},s,l,d,c,u,m)=>{const g=a.newLogger("sendMessageTelemetry");o?U(e,t,n,i,o,g,s,l,d,r,c,u,m):g.warn("userBiService is null")})(o,re,d,Y,t,J,ee,te,k,null==S?void 0:S.replyChainId,A),Object.assign(Object.assign({},e),{message:re})})),H=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{getAppBasedLinkService:t,getAsyncMediaService:n,getUrlPreviewService:i,getImageProxyService:a,getFilesReferenceService:o,getBotsPlatformService:r}=e,[s,l,d,c,u,m]=yield Promise.all([n(),a(),i(),o(),t(),r()]);return{asyncMediaService:s,imageProxyService:l,urlPreviewService:d,fileReferenceService:c,appBasedLinkService:u,botsPlatformService:m}})),$=(e,t,n)=>{var i;let o=null;if((0,d.UL)(e))try{const n=t.readQuery({query:a.i,variables:{convId:e}});o=null!==(i=null==n?void 0:n.newChatIntentId)&&void 0!==i?i:null}catch(e){n.error("Failed to find newChatIntentId in cache")}return o},z=(e,t)=>{var n;let i=!0;const{cache:a,coreSettings:s}=e,{enableConnectedExperiences:l}=s.get(r.J.Messaging);if(!l)return i;try{const e=a.readQuery({query:o.K});i="false"!==(null===(n=null==e?void 0:e.userPreferences)||void 0===n?void 0:n.controllerConnectedServicesEnabled)}catch(e){t.error("Failed to find userPreferences in cache")}return i},G=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=`8:orgid:${e}`,i=(yield t.getPeopleProfilesByMris([n],"MeetingChat")).get(n);return null==i?void 0:i.userPrincipalName}))},870822:(e,t,n)=>{"use strict";n.d(t,{QD:()=>j,R_:()=>U,mb:()=>Q,Fb:()=>W,Ju:()=>$,DE:()=>z,iX:()=>J,PJ:()=>L,JB:()=>O,wX:()=>Y});var i=n(231191),a=n(892891),o=n(498634),r=n(628235),s=n(903001),l=n(660286),d=n(827957);let c=class{transform(e,t){var n,i,o,r,s,l;if(e.parent&&1===e.parent.children.length&&"div"===(null===(n=e.parent.name)||void 0===n?void 0:n.toLowerCase())&&"root"===(null===(i=e.parent.parent)||void 0===i?void 0:i.type)){if((!e.children||0===e.children.length)&&"text"===e.type)return t.isPureText=!0,void(t.textContent=(0,a.unescape)(e.data));if("tag"===e.type&&"p"===(null===(o=e.name)||void 0===o?void 0:o.toLowerCase())&&1===(null===(r=e.children)||void 0===r?void 0:r.length)&&"text"===e.children[0].type)return t.isPureText=!0,void(t.textContent=(0,a.unescape)(null===(s=e.children)||void 0===s?void 0:s[0].data));if("tag"===e.type&&"p"===(null===(l=e.name)||void 0===l?void 0:l.toLowerCase()))return e.name="div",e}}};c=(0,i.__decorate)([(0,d.wx)({name:"BotMessageContentSerializer",filter:"*"})],c);var u=n(639763),m=n(870209),g=n(129350),p=n(907207),v=n(882450),h=n(118824);var f=n(220496),y=n(215235),k=n(995404);const S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserChatAppDefinitionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...n(669702).Eb.definitions]};var b=n(117294),C=n(63053);const w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...C.W4.definitions]},N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...C.W4.definitions]};var T=n(582463),I=n(889705),E=n(413446);const A={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}}]};let _=class{transform(e,t){if(e&&e.attribs&&T.zj.cacheKey in e.attribs&&e.attribs[T.zj.cacheKey]===t.cacheKey)return t.instancesReplaced++,void 0!==t.value?e.attribs[t.prop]=t.value:t.prop in e.attribs&&void 0===t.value&&delete e.attribs[t.prop],e}};_=(0,i.__decorate)([(0,d.wx)({name:"InlineVideoUpdater",filter:[{itemtype:I.T.amsVideo}]})],_);var D=n(395816),F=n(596805),M=n(525965);const R={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserChatChannelIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"smtpAddress"}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}}]}}]}}]}}]},P=(e,t,n,a,o,s,l,c)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{cache:i,coreSettings:m,loggerFactory:g,scenarioFactory:p,authenticationUser:v}=e,h=g.newLogger("chat-resolver-utils"),f=(0,d.te)(u.bl,t,Object.assign(Object.assign({},n),{coreSettings:m,loggerFactory:g,scenarioFactory:p,authenticationUser:v}));try{yield(0,k.yG)(i,e,a,o,s,f,n.messageProperties,c),null==l||l.mark(r.ck.ChatSendMessageOptimisticResponsePosted)}catch(e){h.error(`client lie generation failed for conversation: ${a} clientMessageId: ${o.clientMessageId} error: ${e}`)}return(0,d.zL)(u.Vf,f,Object.assign(Object.assign({},n),{coreSettings:m,loggerFactory:g,scenarioFactory:p,videoMessageLieUpdater:(e,t,n)=>((e,t,n,i,a)=>{if(!t)throw Error("clientMessageId undefined");const o=`Message:${t}`;let r;try{r=e.readFragment({id:o,fragment:A})}catch(e){throw e}if(!r)throw Error(`Message lie ${o} not found.`);if(!r.content)throw Error(`Message lie ${o} has no content.`);const s={cacheKey:n,prop:i,value:a,instancesReplaced:0},l=(0,d.te)([_],r.content,s);if(1!==s.instancesReplaced)throw Error(`${s.instancesReplaced} instances found instead of 1`);{const n=(0,E.M)()[0].toString();try{e.writeFragment({id:o,fragment:A,data:{__typename:"Message",id:t,content:l,version:n}})}catch(e){throw e}}})(i,o.clientMessageId,e,t,n)}))})),O=(e,t,n,a,o,s,l,d)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{content:c,computed:u,files:m,clientMessageId:g,deeplinks:p,title:f}=t,y=(0,i.__rest)(t,["content","computed","files","clientMessageId","deeplinks","title"]),k=Object.assign({conversationId:a,connectedExperienceEnabled:o,existingLinks:(null==u?void 0:u.embeddedLinks)||[],messageProperties:u?Object.assign(Object.assign({},u),{embeddedLinks:[]}):{},files:m,coreSettings:e.coreSettings,loggerFactory:e.loggerFactory},s),{coreSettings:S,loggerFactory:b}=e,C=b.newLogger("chat-resolver-utils"),w=yield P(e,c,k,a,t,n,l,d),N=((e,t)=>{const{enableEntityConversationInMWTab:n}=e.get(h.J.Extensibility);if(!n)return[];const i=v.h.getInstance(),a=i.getSubEntityDeepLinkInfo();return a&&t&&i.getClientMessageId()===t?(i.setSubEntityDeepLinkInfo(void 0),i.setClientMessageId(void 0),[a]):[]})(S,g||void 0),{updatedTitle:T,updatedCards:I}=yield x(f||"",k);return C.log(`serialized message ${g}`),null==l||l.mark(r.ck.ChatSendMessageSerializationComplete),Object.assign({content:w,computed:Object.assign(Object.assign({},k.messageProperties),{cards:I}),files:k.files,deeplinks:N.length>0?N:p,clientMessageId:g,title:T},y)})),x=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,a,o,r,s,l;let d=e,c=t.messageProperties.cards;if(null==c?void 0:c.length){const e=c.find((e=>e.appId===F.lq&&e.contentType===F.hY));if(e){const u=JSON.parse(e.content);if((null===(i=null===(n=u.imageData)||void 0===n?void 0:n.origImage)||void 0===i?void 0:i.src)&&(null===(r=null===(o=null===(a=u.imageData)||void 0===a?void 0:a.croppedImage)||void 0===o?void 0:o.src)||void 0===r?void 0:r.startsWith("blob:"))){const n=yield(0,f.Hk)(null===(l=null===(s=u.imageData)||void 0===s?void 0:s.croppedImage)||void 0===l?void 0:l.src),i="MicrosoftTeams-image.png",a=yield t.asyncMediaService.uploadItem(n,t.conversationId,"IMAGE",i,M.r1.Inline);u.imageData.croppedImage.src=a.inlineSizeUrl,u.imageData.origImage.src=a.inlineSizeUrl;const o=Object.assign(Object.assign({},e),{content:JSON.stringify(u)});c=c.map((e=>e.appId===F.lq&&e.contentType===F.hY?o:e)),d=""}}}return{updatedTitle:d,updatedCards:c}})),L=(e,t)=>{const{loggerFactory:n,offlineCacheManager:i}=e,a={logger:n.newLogger("serializeDraftMessage"),offlineCacheManager:i},o=(0,d.te)(u.D,t.content,a);return Object.assign(Object.assign({},t),{content:o})},U=(e,t,n,a,o,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!o||!n||!t.files||0===t.files.length)return t;if(!(null==o?void 0:o.isOneOnOneBotChat))return t;const i=a.newLogger("chat-resolver-utils"),s=r||1e4,l=yield Promise.all(t.files.map((t=>B(t,e,i,s))));return Object.assign(Object.assign({},t),{files:l})})),B=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=e.objectUrl;if(i){let o;try{o=yield(0,y.E)(t.getBotFileDownloadUrl(i,n),a,"get bot downlaod url timed out")}catch(e){o=null,n.error("getBotDownloadUrlForFiles: failed to get file info")}if(o)return Object.assign(Object.assign({},e),{downloadUrl:o})}return e})),j=e=>()=>{try{const t=e.readQuery({query:S,variables:{options:{capabilityFilter:[D.PwB.Messaging]}}});return(null==t?void 0:t.appDefinitions)||void 0}catch(e){return}},W=(e,t,n,i)=>()=>{var o;try{if(n){const n=V(e,t,i);return(0,a.compact)(null==n?void 0:n.filter((e=>{var t;return null===(t=null==e?void 0:e.definition)||void 0===t?void 0:t.messageExtensions})).map((e=>e&&H(e)?e:null)))}{const n=e.readQuery({query:N,variables:{conversationId:t,installedScopes:[D.qi6.Personal,D.qi6.GroupChat],options:{capabilityFilter:[D.PwB.Messaging]}}});return(0,a.compact)(null===(o=null==n?void 0:n.installedApps)||void 0===o?void 0:o.map((e=>e&&H(e)?e:null)))}}catch(e){return}},V=(e,t,n)=>{var i;let a=null;try{a=e.readQuery({query:b.Cj,variables:{installedContext:{scope:D.qi6.Personal}}})}catch(e){a=null}let o=null;try{if(n){const n=e.readQuery({query:w,variables:{conversationId:t}});o=null==n?void 0:n.installedChatAppsWithPreCheck}else{const n=e.readQuery({query:b.Cj,variables:{installedContext:{conversationId:t,scope:D.qi6.GroupChat}}});o=null==n?void 0:n.installedAppsV2}}catch(e){o=null}const r=null!=o?o:[];return(null!==(i=null==a?void 0:a.installedAppsV2)&&void 0!==i?i:[]).concat(r)},H=e=>(0,a.includes)([D.JMQ.Installed,D.JMQ.InstalledAndFavorited,D.JMQ.InstalledAndPermanent],e.installationState),$=(e,t,{getSharepointShareService:n,getPeopleService:a,discover:o},r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;if((null===(i=null==e?void 0:e.files)||void 0===i?void 0:i.length)&&!(null==t?void 0:t.isOneOnOneBotChat)){const i=yield n(),l=yield a(),d=yield o.skypeid(),c=(yield q(t,l,r,s)).filter((e=>e.mri!==d)),u=yield i.shareFiles(e.files,c);return Object.assign(Object.assign({},e),{files:u})}return e})),z=(e,t,n,a,{getSharepointShareService:o})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,r,s,l,d,c,u,m,g;const p=G(t,n,a),v=null===(s=null===(r=null===(i=null==p?void 0:p.channelByID)||void 0===i?void 0:i.owningTeam)||void 0===r?void 0:r.teamSiteInformation)||void 0===s?void 0:s.sharepointSiteUrl,h=null===(d=null===(l=null==p?void 0:p.channelByID)||void 0===l?void 0:l.owningTeam)||void 0===d?void 0:d.smtpAddress,f=null===(m=null===(u=null===(c=null==p?void 0:p.channelByID)||void 0===c?void 0:c.owningTeam)||void 0===u?void 0:u.teamSiteInformation)||void 0===m?void 0:m.groupId;if(v&&h&&f&&(null===(g=null==e?void 0:e.files)||void 0===g?void 0:g.length)&&e.files[0].baseUrl!==v)try{const t=yield o(),n=[{id:f,smtpAddresses:[h],objectId:f}],i=yield t.shareFiles(e.files,n);return Object.assign(Object.assign({},e),{files:i})}catch(e){a.error("getMessageWithFileShareLinksForChannel: Failed to create the shareLink for Channel's message")}return e})),G=(e,t,n)=>{try{return e.readQuery({query:R,variables:{conversationId:t}})}catch(e){return n.error("getChannelFieldsForFileSharing: Failed to find channels related data"),null}},q=(e,t,n,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=e.hasFederatedUser,r=e.hasTflConsumerUser,[s,d]=r?(0,a.partition)(e.memberIds,(t=>(0,m.Nl)(t)&&!(0,g.Bl)(e.id))):[[],e.memberIds],c=n&&i?yield(0,l.a2)(d||[],t):yield(0,l.Mv)(d||[],t),u=o&&r?yield(0,l.LH)(s||[],t):[];return c.concat(u)})),Q=(e,t,n,a,r,l,d,c,u,m)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,g;let p;try{p=null===(i=t.readQuery({query:o.JT,variables:{convId:e}}))||void 0===i?void 0:i.chat}catch(e){a.error("Failed to find chat in cache")}if(l&&!p){const t=yield n.getCSAService(),i=yield t.getChat(e);i&&(p=(0,s._$)(i,r,d,{id:c},u))}const v=(0,s.UL)(m)||(0,s.AK)(m);if(!p&&v&&m){e=m;try{p=null===(g=t.readQuery({query:o.JT,variables:{convId:e}}))||void 0===g?void 0:g.chat}catch(e){a.error("Failed to find chat in cache")}}return p})),J=({chatType:e})=>e===D.z_3.Chat||e===D.z_3.Meeting,Y=(e,t)=>{var n,i;const o=!(0,a.isEmpty)(null==t?void 0:t.botMembers),r=!!(null===(i=null===(n=e.computed)||void 0===n?void 0:n.mentions)||void 0===i?void 0:i.find((e=>"bot"===e.mentionType)));if(!((null==t?void 0:t.isOneOnOneBotChat)||o&&r))return e;const s={},l=(0,d.te)([c],e.content,s);return s.isPureText&&!(0,a.isNil)(s.textContent)?Object.assign(Object.assign({},e),{content:s.textContent,messageType:"BotMessageBack"===e.messageType?"BotMessageBack":p.Cs.Text}):Object.assign(Object.assign({},e),{content:l})}},995404:(e,t,n)=>{"use strict";n.d(t,{yG:()=>u,lD:()=>m,wr:()=>g});var i=n(231191),a=n(892891),o=n(572596),r=n(999211),s=n(993103),l=n(413446),d=n(596805),c=n(395816);const u=(e,t,n,a,s,l,{mentions:d,cards:u},m)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:i,discover:g,loggerFactory:h}=t,f=h.newLogger("Client Lie Helper"),[{profile:{name:y}},k]=yield Promise.all([i.getUser(),g.skypeid()]);let S=v(l,a,{mentions:d,cards:u});const{replyChainId:b}=a;S=Object.assign(Object.assign({},S),{from:k,imDisplayName:y});const C=s===c.xyM.Update;if(C){const{clientMessageId:e,id:t,originalArrivalTime:n,messageType:i}=a;t&&n&&i?S=Object.assign(Object.assign({},S),{id:t,originalArrivalTime:n,editTime:new Date(Date.now()).toISOString(),messageType:i}):f.error(`can't find id, originalArrivalTime, messageType for ${e}`)}const w=C||m&&!!a.id;m?(0,r.x)(e,n,b||void 0,p(S,a),k,w,C,(null==a?void 0:a.postType)||void 0,f):(0,o.zf)(e,n,null,[S],k,!0,f)})),m=e=>v(e.content,e,e.computed||{}),g=e=>p(m(e),e),p=(e,t)=>{const n=!(null==t?void 0:t.replyChainId),i=(null==t?void 0:t.subject)||"",a=(null==t?void 0:t.replyPermission)||null,o=n&&(null==t?void 0:t.postType)===c.hQF.Announcement?(0,d.JY)(t):void 0,{fragmentTypeName:r}=(0,s.Gw)(null==t?void 0:t.postType);return Object.assign(Object.assign({},e),{__typename:n?r:"ReplyChainMessage",id:e.id||"",isImportant:"Important"===e.importance,isPinned:!1,messageRenderType:c.Mem.Standard,subject:i||"",isLastRead:!1,isTimestampDividerNeeded:!1,isCrossPost:!1,crossPostId:null,attached:null,translation:null,translatedSubject:null,translatedContent:null,translationStatus:null,softDeleteReason:null,sourceLanguageName:null,sourceLanguageCode:null,announcement:o,replyPermission:a,deletionInfo:{__typename:"MessageDeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},canUserReply:!0,parentsAnnouncementsStatus:null})},v=(e,{clientMessageId:t,files:n,deeplinks:i,importance:a,messageType:o,scheduledSendTime:r},{mentions:s,cards:d})=>({__typename:"Message",id:t||"",clientMessageId:t||"",originalArrivalTime:new Date(Date.now()).toISOString(),version:(0,l.M)()[0].toString(),importance:a||null,content:e,messageType:o||"RichText/Html",interopDeliveryState:null,smsDeliveryReports:null,emotionsSummary:null,emotions:null,escalations:null,mentions:h(s),onBehalfOf:null,cards:f(d),from:null,imDisplayName:null,files:y(n),deeplinks:k(i),urlPreview:null,embeddedLinks:null,dlpContext:null,deleteTime:null,editTime:null,status:c.rJC.Sending,diagnosticInfo:null,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},userHasSaved:!1,callId:null,replyPermission:null,translation:null,atpSharepointData:null,isDeletedByAdmin:null,meeting:null,hardDeleteTime:null,hardDeleteReason:null,translatedSubject:null,translatedContent:null,translationStatus:null,sourceLanguageName:null,sourceLanguageCode:null,scheduledSendTime:r||null,draftId:r?t||"":null,crossPostStatus:null,crossPostFailedChannels:null}),h=e=>(0,a.map)(e,(e=>{var{itemId:t}=e,n=(0,i.__rest)(e,["itemId"]);return Object.assign({__typename:"Mention",id:t,itemId:t},n)})),f=e=>(0,a.map)(e,(e=>({__typename:"Card",appIcon:e.appIcon||null,appId:e.appId,appName:e.appName||null,cardClientId:e.cardClientId,content:e.content,contentType:e.contentType,locale:e.locale||null,userSpecificContent:null}))),y=e=>(0,a.map)(e,(e=>{var{chicletBreadcrumbs:t,title:n,type:a}=e,o=(0,i.__rest)(e,["chicletBreadcrumbs","title","type"]);return{__typename:"File",id:o.id,itemId:o.itemId||null,chicletBreadcrumbs:t?{__typename:"ChicletBreadcrumbs",sourceChannelName:t.sourceChannelName||null,sourceTeamName:t.sourceTeamName||null}:null,baseUrl:null,objectUrl:null,shareId:null,shareUrl:null,type:a||null,title:n||null,previewUrl:null,previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1,serviceName:null,providerDataV2:null,state:null}})),k=e=>(0,a.map)(e,(e=>({__typename:"DeepLink",id:(0,i.__rest)(e,[]).id,channelId:null,title:null,siteUrl:null,objectUrl:null,serverRelativeUrl:null,state:null})))},117294:(e,t,n)=>{"use strict";n.d(t,{Cj:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...n(63053).W4.definitions]}},130896:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var i=n(672729);function a(e){var t;switch(e.__typename){case"BreakoutRoom":return`${e.__typename}:${null===(t=e.coordinates)||void 0===t?void 0:t.threadId}`;case"Participant":return`${e.__typename}:${e.participantId}`;case"TeamTagCards":return`${e.__typename}:${e.teamId}`;case"TagCard":return`${e.__typename}:${e.tagId}`;case"Entity":return e.linkedEntity?`${e.__typename}:${e.id}:${e.type}:${e.action}:${e.options}:${e.linkedEntity.id}:${e.linkedEntity.type}:${e.linkedEntity.action}`:`${e.__typename}:${e.id}:${e.type}:${e.action}:${e.options}`;case"InstalledApp":const n=`${(0,i.uG)(e)}:${e.installedScope}`;return e.conversationId?`${n}:${e.conversationId}`:n;case"AppDefinition":return`${(0,i.uG)(e)}:${e.version}`;case"MessageExtensionCommand":return`${(0,i.uG)(e)}:${e.appKey}`;case"BotDynamicCommands":return`${e.__typename}:${e.botMri}:${e.commandContext}`;case"DeviceList":if(!e.id)throw new Error("dataIdFromObject(), no id on DeviceList object.");return(0,i.uG)(e);case"TransportCompanionDeviceInfo":case"UserPreferences":case"UserSettings":case"MessagingSettings":case"MeetingChatSettings":case"AppsUsage":return e.__typename;case"StagedApp":return`${(0,i.uG)(e)}:${e.reviewStatus}`;case"CallLogParticipant":return`${(0,i.uG)(e)}:${e.displayName}:${e.type}`;case"WebApplicationInfo":return`${e.__typename}:${e.appKey}`;case"DeepLink":return`${e.__typename}:${e.id}:${e.serverRelativeUrl}`;case"TranslationSettingsV2":return e.__typename;default:return(0,i.uG)(e)}}},382190:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var i=n(350672);const a={Mutation:{updateFilePermission(e,{updateFilePermissionInput:t},{cache:n}){if(!t)return!1;const{fileId:a,shareUrl:o,shareId:r,scope:s}=t,l=i.Ps`
  fragment filePermissionUpdate on FileUpload {
    id
    shareUrl
    shareId
    permissionScope
  }
`;let d;const c=`FileUpload:${a}`;try{d=n.readFragment({fragment:l,id:c})}catch(e){throw e}if(!d)throw new Error("Expected initial files to be populated before a command is executed");const u=Object.assign(Object.assign({},d),{shareUrl:o,shareId:r,permissionScope:s});return n.writeFragment({fragment:l,id:c,data:u}),!0},updatePermissionScopeInFileUpload(e,{updatePermissionScopeInput:t},{cache:n}){if(!t)return!1;const{fileId:a,scope:o}=t;if(!a)return!1;const r={permissionScope:o,__typename:"FileUpload"};try{n.writeFragment({fragment:i.Ps`
  fragment updatePermissionScope on FileUpload {
    permissionScope
  }
`,id:`FileUpload:${a}`,data:r})}catch(e){return!1}return!0}}}},892185:(e,t,n)=>{"use strict";n.d(t,{w:()=>o,Q:()=>r});var i=n(231191),a=n(95181);const o={Query:{meetForWorkAppUserState(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetForWorkService()).getAppUserState()}))},meetForWorkDiagnoisticInformation(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetForWorkService()).readDiagnosticMessage()}))}},Mutation:{refreshForMeetApp(e,t,{getMeetForWorkService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return n().then((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return e.refresh()})))),!0}))},deleteUpcomingEventForMeetApp(e,{meetingId:t},{getMeetForWorkService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n()).deleteUpcomingEvent(t)}))},updateUpcomingEventCallStateForMeetApp(e,{conversationId:t,isOngoingCall:n},{getMeetForWorkService:a}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield a()).updateUpcomingEventCallState(t,n)}))},updateMeetForWorkAppUserState(e,{updatedValue:t},n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetForWorkService()).updateAppUserState(t)}))},setFetchMeetAppDataEnabled(e,{enable:t},{getMeetForWorkService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n()).setFetchDataEnabled(t),!0}))},requireFurtherRecentDataFromMeetApp(e,{sessionId:t},{getMeetForWorkService:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n()).requireFurtherRecentData(t)}))}}},r={Subscription:{meetAppInsightsEvent:{subscribe:(0,a.OF)(((e,t,{pubsub:n,getMeetForWorkService:a})=>(a().then((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){e.fetchDataIfNeeded()})))),n.asyncIterator("meetAppInsightsEvent"))),((e,t)=>t.topic===e.meetAppInsightsEvent.topic))}}}},289895:(e,t,n)=>{"use strict";n.d(t,{A:()=>S,s_:()=>k});var i=n(231191),a=n(281857),o=n(628235),r=n(666815),s=n(395816),l=n(642115),d=n(892891),c=n(11574),u=n(7017),m=n(324819);const g=e=>(0,c.A)(e)||"<scrubbed>",p=e=>e.map((e=>e.type)).sort().toString(),v=(e,t)=>{const n=t.newScenario(e);let i=n.id;return(0,u.z)(i)||(i=(0,m.v4)()),n.appendEventData({correlationId:i}),{scenario:n,correlationId:i}};function h(e,t,n,i,a){var o,s,l,d,c,u,m,g,p;const v={message:null===(o=t.reason)||void 0===o?void 0:o[r.zm.logErrorMessage],statusCode:null===(s=t.reason)||void 0===s?void 0:s[r.zm.httpStatusCode],errorCode:null===(l=t.reason)||void 0===l?void 0:l[r.zm.internalErrorCode],subError:null===(d=t.reason)||void 0===d?void 0:d[r.zm.subError],correlationId:null===(c=t.reason)||void 0===c?void 0:c[r.zm.correlationId],cmdRequestId:null===(u=t.reason)||void 0===u?void 0:u[r.zm.cmdRequestId],reportingService:null===(m=t.reason)||void 0===m?void 0:m[r.zm.reportingService]};!function(e,t,n,i){e.errorToTelemetry?e.errorToTelemetry(t,n,i,!0):e.error(t)}(e,`${a} ${null===(g=t.reason)||void 0===g?void 0:g[r.zm.internalErrorCode]}, errorMessage: ${null===(p=t.reason)||void 0===p?void 0:p[r.zm.logErrorMessage]}`,i,v),n.fail(v)}let f;const y=e=>f||(f=e.newLogger("meeting-artifacts-resolvers")),k={Query:{meetingArtifacts(e,{meetingArtifactType:t,externalEntityKey:n,organizer:a,user:r},{getCollabObjectService:s,scenarioFactory:l,loggerFactory:d,callerApp:c}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=v(o.RG.ReadCollabObject,l),u=g(n);e.appendEventData({externalEntityKey:u}),y(d),f.log(`Read collab object for ${u}`);try{const o=yield s(),l=yield o.readCollabObject(i,n,a,r,c),d=((null==l?void 0:l.resources)||[]).filter((e=>e.type.toLowerCase()===t.toLowerCase())).map((e=>({id:e.id,type:C(e.type),location:e.location,metadata:e.metadata})));f.log(`type of resources received after reading collabObject ${p(d)}`);const u={changeKey:null==l?void 0:l.changeKey,resources:d};return e.stop({message:p(d)}),u}catch(t){return h(f,t,e,"cmd_meetings_collab_object_read_collab_object_event","get meetingArtifacts query failed with errorCode"),Promise.reject(t)}}))},allMeetingArtifacts(e,{externalEntityKey:t,organizer:n,user:a},{getCollabObjectService:r,scenarioFactory:s,loggerFactory:l,callerApp:d}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=v(o.RG.ReadCollabObject,s),c=g(t);e.appendEventData({externalEntityKey:c}),y(l),f.log(`Read collab object to get all meeting artifacts for ${c}`);try{const o=yield r(),s=yield o.readCollabObject(i,t,n,a,d),l=((null==s?void 0:s.resources)||[]).filter((e=>w(e.type))).map((e=>Object.assign({id:e.id,type:C(e.type),location:e.location},e.metadata)));f.log(`type of resources received after reading collabObject to get all meeting artifacts are ${p(l)}`);const c={changeKey:null==s?void 0:s.changeKey,resources:l};return e.stop({message:p(l)}),c}catch(t){return h(f,t,e,"cmd_meetings_collab_object_read_collab_object_event","get meetingArtifacts query failed with errorCode"),Promise.reject(t)}}))},allMeetingArtifactsBatch(e,{meetingArtifactsBatchInputList:t},{getCollabObjectService:n,scenarioFactory:a,loggerFactory:r}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=v(o.RG.ReadCollabObjectBatchRequest,a);y(r),f.log(`Read group of meeting artifacts for ${t.length} meetings start`);try{const a=yield n(),o=function(e){const t=[];if(null==e?void 0:e.collabMap){const n=e.collabMap;Object.keys(n).forEach((e=>{var i;const a={iCalUid:e,value:{resources:((null===(i=n[e].collab)||void 0===i?void 0:i.resources)||[]).filter((e=>w(e.type))).map((e=>Object.assign({id:e.id,type:C(e.type),location:e.location},e.metadata)))}};t.push(a)}))}return t}(yield a.readCollabObjectBatchRequest(i,function(e){const t={collabIds:{}};return e.forEach((e=>{t.collabIds=Object.assign(Object.assign({},t.collabIds),{[e.iCalUid]:{smtp:e.organizer}})})),t}(t)));return f.log(`Read group of meeting artifacts for ${o.length} meetings success`),e.stop(),o}catch(t){return h(f,t,e,"cmd_meetings_collab_object_read_collab_object_batch_request_event","get meetingArtifacts batch request query failed with errorCode"),Promise.reject(t)}}))},reserveMeetingArtifact(e,{externalEntityKey:t,seriesExternalEntityKey:n,organizer:a,user:r,meetingParams:l},{getCollabObjectService:d,scenarioFactory:c,loggerFactory:u,callerApp:m}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=v(o.RG.ReserveResourceToCollabObject,c),p=g(t),k=g(n);e.appendEventData({externalEntityKey:p,seriesExternalEntityKey:k}),y(u),f.log(`Reserve meeting artifact for instance externalEntityKey: ${p}, series externalEntityKey: ${k}`);try{const o=s.ceh.Notes,c=yield d(),u=yield c.reserveResourceToCollabObject(i,function(e,t,n,i,a,o){return{type:e.toLowerCase(),externalEntityKey:t,seriesExternalEntityKey:n,meetingUrl:o.meetingUrl,threadId:o.threadId,messageId:o.messageId,organizerUpn:o.organizerUpn,organizer:i,user:a}}(o,t,n,a,r,l),m);if(null==u?void 0:u.collab){const t=b(o,u);return e.stop(),Object.assign(Object.assign({},u),{collab:{changeKey:null==u?void 0:u.collab.changeKey,resources:t}})}return e.stop(),u}catch(t){return h(f,t,e,"cmd_meetings_collab_object_reserve_resource_to_collab_object_event","reserveMeetingArtifact query failed with errorCode"),Promise.reject(t)}}))},readAndOptionallyReserveMeetingArtifact(e,{externalEntityKey:t,organizer:n,user:a},{getCollabObjectService:r,scenarioFactory:l,loggerFactory:d,callerApp:c}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenario:e,correlationId:i}=v(o.RG.ReadAndOptionallyReserveResourceToCollabObject,l),u=g(t);e.appendEventData({externalEntityKey:u}),y(d),f.log(`Read and Optionally Reserve meeting artifact for instance externalEntityKey: ${u}`);try{const o=s.ceh.Notes,l=yield r(),d=yield l.readAndOptionallyReserveResourceToCollabObject(i,function(e,t,n,i){return{type:e.toLowerCase(),externalEntityKey:t,organizer:n,user:i}}(o,t,n,a),c);if(null==d?void 0:d.collab){const t=b(o,d);return e.stop(),Object.assign(Object.assign({},d),{collab:{changeKey:null==d?void 0:d.collab.changeKey,resources:t}})}return e.stop(),d}catch(t){return h(f,t,e,"cmd_meetings_collab_object_read_and_optionally_reserve_resource_to_collab_object_event","readAndOptionallyReserveMeetingArtifact query failed with errorCode"),Promise.reject(t)}}))}},Mutation:{addMeetingArtifacts(e,{externalEntityKey:t,seriesExternalEntityKey:n,organizer:a,user:o,meetingParams:r,meetingArtifacts:s},{getCollabObjectService:l,scenarioFactory:d,loggerFactory:c,callerApp:u}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return S(l,d,c,u,t,n,a,o,s,r)}))},commitMeetingArtifact(e,{externalEntityKey:t,seriesExternalEntityKey:n,organizer:a,user:l,secret:c,resourceUri:u,metadata:m},{getCollabObjectService:p,scenarioFactory:f,loggerFactory:k,callerApp:S}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=y(k),{scenario:i,correlationId:b}=v(o.RG.CommitResourceToCollabObject,f);try{const o=yield p(),v=g(t),h=g(n);return e.log(`commit Meeting Artifact to instance externalEntityKey: ${v}, series externalEntityKey: ${h}`),i.appendEventData({externalEntityKey:v,seriesExternalEntityKey:h}),c?(yield o.commitResourceToCollabObject(b,function(e,t,n,i,a,o,r,s){var l;const c=null!==(l=s)&&void 0!==l?l:{};return{type:e.toLowerCase(),externalEntityKey:t,seriesExternalEntityKey:n,organizer:i,user:a,secret:o,resourceUri:r,metadata:(0,d.omitBy)(I(c),d.isEmpty)}}(s.ceh.Notes,t,n,a,l,c,u,m),S),i.stop(),!0):(e.error("commit Meeting Artifact API called without secret"),i.fail({errorCode:r.py.INVALID_SECRET.toString(),message:r.WK.INVALID_SECRET}),!1)}catch(t){return h(e,t,i,"cmd_meetings_collab_object_commit_resource_to_collab_object_event","commit Meeting Artifact commit mutation failed with errorCode"),Promise.reject(t)}}))},updateMeetingArtifacts(e,{externalEntityKey:t,seriesExternalEntityKey:n,organizer:s,user:d,meetingParams:c,changeKey:u,meetingArtifacts:m},{getCollabObjectService:f,scenarioFactory:k,loggerFactory:S,callerApp:b}){var C;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=y(S),{scenario:i,correlationId:w}=v(o.RG.UpdateResourcesOnCollabObject,k),N=g(t),I=g(n);e.log(`Update meeting artifacts for externalEntityKey: ${N} and seriesExternalEntityKey: ${I}`);try{const o=yield f(),g=null!==(C=m)&&void 0!==C?C:[];if(i.appendEventData({externalEntityKey:N,seriesExternalEntityKey:I,message:p(g)}),0===g.length){return h(e,(0,l.Tr)(a.w5.CmdArtifactsServiceClient,a.jK.InvalidInput,"meetingArtifactsResolver.updateMeetingArtifacts",{[r.zm.internalErrorCode]:r.py.EMPTY_INPUT,[r.zm.logErrorMessage]:r.WK.EMPTY_INPUT},r.WK.EMPTY_INPUT.toString()),i,"cmd_meetings_collab_object_add_resources_to_collab_object_event","addMeetingArtifactsCalled with an empty array of meeting artifacts"),!1}return yield o.updateResourcesOnCollabObject(w,function(e,t,n,i,a,o,r){return{externalEntityKey:e,seriesExternalEntityKey:t,organizer:n,user:i,meetingUrl:a.meetingUrl,threadId:a.threadId,messageId:a.messageId,organizerUpn:a.organizerUpn,changeKey:o,resources:T(r)}}(t,n,s,d,c,u,g),b),i.stop(),!0}catch(t){return h(e,t,i,"cmd_meetings_collab_object_update_resource_on_collab_object_event","UpdateMeetingArtifacts mutation failed"),Promise.reject(t)}}))}},MeetingArtifactV2Union:{__resolveType:e=>e.type===s.ceh.Transcript?"MeetingArtifactV2Transcript":e.type===s.ceh.Recording?"MeetingArtifactV2Recording":e.type===s.ceh.Notes?"MeetingArtifactV2Notes":e.type===s.ceh.MeetingContent?"MeetingArtifactV2MeetingContent":"MeetingArtifactV2Default"}};function S(e,t,n,a,s,l,d,c,u,m){var f;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=y(n),{scenario:k,correlationId:S}=v(o.RG.AddResourcesToCollabObject,t);try{const t=yield e(),n=g(s);i.log(`Adding meeting artifacts to externalEntityKey: ${n}`);const o=null!==(f=u)&&void 0!==f?f:[];return k.appendEventData({externalEntityKey:n,message:p(o)}),0===o.length?(i.error("addMeetingArtifacts called with and empty array of meeting artifacts"),k.fail({errorCode:r.py.EMPTY_INPUT.toString(),message:r.WK.EMPTY_INPUT}),!1):(yield t.addResourcesToCollabObject(S,function(e,t,n,i,a,o){return{externalEntityKey:e,seriesExternalEntityKey:t,organizer:n,user:i,meetingUrl:a.meetingUrl,threadId:a.threadId,messageId:a.messageId,organizerUpn:a.organizerUpn,resources:T(o)}}(s,l,d,c,m,o),a),k.stop(),!0)}catch(e){return h(i,e,k,"cmd_meetings_collab_object_add_resources_to_collab_object_event","addMeetingArtifacts mutation failed with errorCode"),Promise.reject(e)}}))}const b=(e,t)=>{var n,i;return null===(i=null===(n=null==t?void 0:t.collab)||void 0===n?void 0:n.resources)||void 0===i?void 0:i.filter((t=>t.type.toLowerCase()===s.ceh[e].toLowerCase())).map((e=>Object.assign(Object.assign({},e),{id:e.id,type:C(e.type),location:e.location,metadata:e.metadata})))},C=e=>{for(const t of Object.keys(s.ceh))if(t.toLowerCase()===e.toLowerCase())return s.ceh[t];return e},w=e=>{for(const t of Object.keys(s.ceh))if(t.toLowerCase()===e.toLowerCase())return!0;return!1},N=e=>{var t;const n=null!==(t=e.metadata)&&void 0!==t?t:{};return{id:e.id,location:e.location,type:e.type,metadata:I(n)}},T=e=>e.map(N),I=e=>(e=>{let t={};if(e.state){const n=t;t=Object.assign(Object.assign({},n),{state:e.state})}if(e.isShared){const n=t;t=Object.assign(Object.assign({},n),{isShared:e.isShared})}if(e.linkScope){const n=t;t=Object.assign(Object.assign({},n),{linkScope:e.linkScope})}if(e.hostClient){const n=t;t=Object.assign(Object.assign({},n),{hostClient:e.hostClient})}if(e.appId){const n=t;t=Object.assign(Object.assign({},n),{appId:e.appId})}if(e.appTitle){const n=t;t=Object.assign(Object.assign({},n),{appTitle:e.appTitle})}if(e.fileTitle){const n=t;t=Object.assign(Object.assign({},n),{fileTitle:e.fileTitle})}if(e.imageUrl){const n=t;t=Object.assign(Object.assign({},n),{imageUrl:e.imageUrl})}if(e.userId){const n=t;t=Object.assign(Object.assign({},n),{userId:e.userId})}if(e.shareUrl){const n=t;t=Object.assign(Object.assign({},n),{shareUrl:e.shareUrl})}if(e.fileId){const n=t;t=Object.assign(Object.assign({},n),{fileId:e.fileId})}if(e.fileType){const n=t;t=Object.assign(Object.assign({},n),{fileType:e.fileType})}if(e.baseUrl){const n=t;t=Object.assign(Object.assign({},n),{baseUrl:e.baseUrl})}if(e.objectUrl){const n=t;t=Object.assign(Object.assign({},n),{objectUrl:e.objectUrl})}if(e.meetingContentMetadataObject){const n=t;t=Object.assign(Object.assign({},n),{meetingContentMetadataObject:e.meetingContentMetadataObject})}return t})(e)},314769:(e,t,n)=>{"use strict";n.d(t,{w:()=>r,s:()=>s});var i=n(231191),a=n(422074),o=n(95181);const r={Query:{meetingBotMetaInfo(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{getMeetingBotService:e}=n,t=yield e();return{meetingBotMri:yield t.getBotId(),__typename:"MeetingBotMetaInfo"}}))},meetingBotCalendarEvents(e,{start:t,end:n},a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield a.getMeetingBotService();return(yield e.fetchCalendarEvents(t,n)).filter((e=>!e.isAllDayEvent&&e.isOnlineMeeting)).map((e=>{var t;return{id:e.objectId,start:new Date(e.startTime).toUTCString(),end:new Date(e.endTime).toUTCString(),iCalUID:e.iCalUID,subject:e.subject,objectId:e.objectId,conversationId:null===(t=e.skypeTeamsDataObj)||void 0===t?void 0:t.cid,skypeTeamsMeetingUrl:e.skypeTeamsMeetingUrl,isCancelled:e.isCancelled,isAllDayEvent:e.isAllDayEvent}}))}))},meetingBotChatIdForCalendarEvent(e,{eventId:t},n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetingBotService()).fetchChatIdForCalendarEvent(t)}))}},Mutation:{postMeetingStarted(e,{absentAttendees:t,hasRecordingStarted:n,meetingId:o,isForced:r},s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield s.getMeetingBotService();if(!r&&e.isMeetingEventSent(o,a.$.MeetingStart))return"absentAttendee checked";if(e.setMeetingEventSent(o,a.$.MeetingStart),t&&t.length>0){const i=yield e.postEventToBot({Scenario:a.$.MeetingStart,MeetingInfo:{HasRecordingStarted:n,AbsentAttendee:t}});return`${null==i?void 0:i.status}`}return"no absent attendees"}))},postGreetingToMeetingBot(e,{input:{meetingId:t,organizerId:n,recordingState:o,hasPresentedDeck:r,hasRecordingStarted:s,hasProactiveAction:l,absentAttendee:d,timeElapedSinceMeetingStartedInMinutes:c,hasNextMeeting:u,endTime:m,isRecurrent:g}},p){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield p.getMeetingBotService();if(e.isMeetingEventSent(t,a.$.InMeetingGreeting)||e.isMeetingEventSent(t,a.$.MeetingStart))return!1;e.setMeetingEventSent(t,a.$.InMeetingGreeting);return!!(yield e.postEventToBot({Scenario:a.$.InMeetingGreeting,MeetingInfo:{MeetingId:t,AbsentAttendee:d,OrganizerId:n,RecordingState:o,HasPresentedFile:r,HasProactiveAction:l,HasRecordingStarted:s,TimeElapedSinceMeetingStartedInMinutes:c,HasNextMeeting:u,EndTime:m,IsRecurrent:g,Subject:"Subject"}}))}))},tryStartMeetingBotPublisher(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{getMeetingBotService:e,loggerFactory:t}=n;t.newLogger("MeetingBot Resolver").log("tryStartMeetingBotPublisher");const i=yield e();return yield i.startPublisher(),!0}))},sendActionStatus(e,{botAction:t,isActionSucess:n,nextMeetingName:o},r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield r.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.InMeetingActionStatusUpdated,MeetingInfo:{InMeetingAction:t,IsActionSucceed:n,NextMeetingName:o}}),!0}))},sendRunningLateForNextMeetingNotification(e,{iCalUID:t,subject:n,objectId:o,conversationId:r},s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield s.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.RunningLate,MeetingInfo:{CallId:t,ThreadId:r,Subject:n,MeetingUid:o}}),!0}))},removeCalendarEvent(e,{eventId:t},n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield n.getMeetingBotService();return yield e.removeCalendarEvent(t),"Message sent"}))},sendMeetingBotMessage(e,{text:t,conversationId:n},a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield a.getMeetingBotService()).sendMeetingBotMessage(t,n)}))},sendMeetingObjectId(e,{meetingObjectId:t},n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield n.getMeetingBotService();return yield e.postEventToBot({Scenario:a.$.InMeetingShareFile,MeetingInfo:{MeetingId:t}}),!0}))},reportUsageToMeetingBot(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield n.getMeetingBotService()).reportUsageToMeetingBot()}))},triggerBotAction(e,{conversationId:t,botAction:n,actionId:a},o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield o.getMeetingBotService(),i=yield e.fetchChatIdForCalendarEvent(t);return o.pubsub.publish("meetingBotActionEvent",{meetingBotActionEvent:{conversationId:i,botAction:n,actionId:a},__typename:"meetingBotActionEvent"}),!0}))},sendMessageToConversation(e,{conversationId:t,message:n,files:a},o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(a&&!a.length)return!1;const e=yield o.getMeetingBotService();return yield e.sendToConversation(t,n,a),!0}))}}},s={Subscription:{meetingBotActionEvent:{subscribe:(0,o.OF)(((e,t,{pubsub:n})=>n.asyncIterator(["meetingBotActionEvent"])),((e,t)=>t.conversationId===e.meetingBotActionEvent.conversationId))}}}},918174:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserMeetingRoomMeetingRoomFrontOfRoomCallPanelsStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingRoomFrontOfRoomCallPanelsState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"rightPanel"}}]}}]}}]}},868693:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i="payment-service"},212693:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});var i=n(868693),a=n(317272);let o;const r={Mutation:{updatePaymentDetailsInCache:(e,{eventId:t,paymentDetails:n},{cache:r,loggerFactory:s})=>{var l;(e=>{o||(o=e.newLogger(i.k))})(s);try{const e=(null===(l=r.readQuery({query:a.Z,variables:{eventId:t}}))||void 0===l?void 0:l.paymentDetails)||{},i=Object.assign(Object.assign(Object.assign({},e),n),{__typename:"PaymentDetails"});return r.writeQuery({query:a.Z,variables:{eventId:t},data:{paymentDetails:i}}),Object.assign(Object.assign({},i),{__typename:"PaymentDetails"})}catch(e){throw o.error("Payment client resolver failed to update payment details in cache",e),e}}}}},317272:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"paymentDetails"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"eventId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paymentDetails"},arguments:[{kind:"Argument",name:{kind:"Name",value:"eventId"},value:{kind:"Variable",name:{kind:"Name",value:"eventId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"eventId"}},{kind:"Field",name:{kind:"Name",value:"paymentProvider"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"product"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"amount"}},{kind:"Field",name:{kind:"Name",value:"currency"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}}]}}]}}]}}]}}]}}]}},821452:(e,t,n)=>{"use strict";n.d(t,{w:()=>v});var i=n(231191),a=n(166706),o=n(395816),r=n(892891);function s(e,t){return t.isGeneral&&e.memberRole!==o.k_p.Admin&&function(e){return e.teamSettings&&e.teamSettings.generalChannelPosting===o.S1B.OwnersPost}(e)}function l(e,t){return e.isUserMuted?o.Jb0.MutedTeamMember:s(e,t)?o.Jb0.OnlyOwnersCanPost:o.Jb0.None}var d=n(660050);function c(e,t){var n,i;return{id:t.id,channelType:m(t.channelType),isGeneral:t.isGeneral||!1,displayName:t.displayName,disallowedToPostReason:l(e,t),consumptionHorizon:t.consumptionHorizon?Object.assign(Object.assign({},t.consumptionHorizon),{__typename:"ClientConsumptionHorizon"}):null,filesRelativePath:(null===(n=t.defaultFileSettings)||void 0===n?void 0:n.filesRelativePath)||null,memberRole:g(t.memberRole),isModerator:t.isModerator||!1,channelSettings:{__typename:"ChannelSettings",channelPostPermissions:p(null===(i=t.channelSettings)||void 0===i?void 0:i.channelPostPermissions)},sharepointSiteUrl:t.sharepointSiteUrl||null,team:{id:e.id,displayName:e.displayName,groupId:e.teamSiteInformation.groupId,sharepointSiteUrl:e.teamSiteInformation.sharepointSiteUrl||null,pictureETag:e.pictureETag||null,smtpAddress:e.smtpAddress,teamSettings:e.teamSettings,__typename:"ClientTeam"},isArchived:t.isArchived,isDeleted:t.isDeleted,__typename:"ChannelWithTeam"}}function u(e){return(0,r.flatMap)(e,(e=>e.filteredChannels.map(c.bind(void 0,e))))}function m(e){switch(e){case o.xuW.Standard:return o.kK_.Standard;case o.xuW.Private:return o.kK_.Private;case o.xuW.Shared:return o.kK_.Shared;default:return null}}const g=e=>{switch(e){case o.k_p.Admin:return o.k_p.Admin;case o.k_p.Guest:return o.k_p.Guest;case o.k_p.User:return o.k_p.User;case o.k_p.Undefined:default:return o.k_p.Undefined}},p=e=>{switch(e){case o.XIP.Moderators:return o.XIP.Moderators;case o.XIP.EveryoneButGuests:return o.XIP.EveryoneButGuests;case o.XIP.Everyone:default:return o.XIP.Everyone}},v={Query:{channelSearch:(e,{searchQuery:t},n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let e=yield h(n);if(0===e.length)return{__typename:"ChannelSearchResults",resultsByChannelName:[],resultsByTeamName:[]};e=e.filter((e=>!e.isDeleted)).map((e=>Object.assign(Object.assign({},e),{channels:e.channels.filter((e=>!e.isDeleted))})));const i=new RegExp((0,r.escapeRegExp)(t.toLowerCase())),a=(0,r.cloneDeep)(e).filter((e=>i.test(e.displayName.toLowerCase()))).map((e=>(e.filteredChannels=e.channels,e)));return{__typename:"ChannelSearchResults",resultsByChannelName:u(e.map((e=>(e.filteredChannels=e.channels.filter((e=>i.test(e.displayName.toLowerCase()))),e)))),resultsByTeamName:u(a)}})),channel:(e,{channelId:t},n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e=yield h(n);let i;return(0,r.forEach)(e,(e=>{const n=(0,r.find)(e.channels,{id:t});return!n||(i=c(e,n),!1)})),i}))}};function h(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,cache:n,coreSettings:i,localStorage:o,loggerFactory:r,scenarioFactory:s}=e;let l;try{({teams:l}=n.readQuery({query:a.TK}))}catch(e){r.newLogger("ClientResolvers").warn("Cache error, returning empty data instead");const c=t&&(yield(0,d.Qp)(t,i,o,s));if(c){const e=c.map(d.uX);n.writeQuery({query:a.TK,data:{teams:e}})}l=c||[]}return l}))}},166706:(e,t,n)=>{"use strict";n.d(t,{TK:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"teamsList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isUserMuted"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"smtpAddress"}},{kind:"Field",name:{kind:"Name",value:"pictureETag"}},{kind:"Field",name:{kind:"Name",value:"teamSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"generalChannelPosting"}}]}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"channels"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"isDeleted"}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}},{kind:"Field",name:{kind:"Name",value:"isShown"}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"channelSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelPostPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"isModerator"}}]}}]}}]}}]}},660050:(e,t,n)=>{"use strict";n.d(t,{uX:()=>f,Qp:()=>w,xm:()=>E,GC:()=>_});var i=n(231191),a=n(892891),o=n(118824),r=n(628235),s=n(912206),l=n(129350),d=n(907207),c=n(975652),u=n(903001),m=n(119423),g=n(395816);const p="conversations",v="teams-list";function h(e){var t,n;return Object.assign(Object.assign(Object.assign({__typename:"Channel"},(0,a.defaults)((0,a.pick)(e,["id","channelType","displayName","isArchived","isDeleted","isGeneral","isModerator","isShown","memberRole"]),{channelType:null,isArchived:null,isDeleted:null,isModerator:null,memberRole:null})),{channelSettings:(0,a.defaults)(e.channelSettings,{__typename:"ChannelSettings",channelPostPermissions:null}),defaultFileSettings:{__typename:"DefaultFileSettings",filesRelativePath:(null===(t=e.defaultFileSettings)||void 0===t?void 0:t.filesRelativePath)||null},sharepointSiteUrl:e.sharepointSiteUrl||null}),(null===(n=e.consumptionHorizon)||void 0===n?void 0:n.id)?{consumptionHorizon:{__typename:"ConsumptionHorizon",id:e.consumptionHorizon.id,timeStamp:e.consumptionHorizon.timeStamp||null}}:{consumptionHorizon:null})}function f(e){return Object.assign(Object.assign({__typename:"Team"},(0,a.defaults)((0,a.pick)(e,["id","displayName","isDeleted","isUserMuted","memberRole","smtpAddress","pictureETag","teamType"]),{isUserMuted:null,pictureETag:null,smtpAddress:null,teamType:null})),{teamSettings:{__typename:"TeamSettings",generalChannelPosting:e.teamSettings.generalChannelPosting||null},teamSiteInformation:Object.assign({__typename:"TeamSiteInformation"},(0,a.defaults)((0,a.pick)(e.teamSiteInformation,["groupId","sharepointSiteUrl"]),{groupId:null,sharepointSiteUrl:null})),channels:(e.channels||[]).map(h)})}function y(e){try{return JSON.parse(e)}catch(e){return}}function k(e){if(!e||0===e.length)return;const t=new Map,n=new Map;e.filter((e=>e&&(0,l.HU)(e))).map((e=>t.set(e.id,function(e){var t;const n=e.threadProperties;return Object.assign({id:e.id,displayName:n[d.Q5.SpaceThreadTopic]||"",isDeleted:(0,l.uY)(e),memberRole:C((null===(t=e.memberProperties)||void 0===t?void 0:t.role)||d.nL.None),teamSiteInformation:{groupId:n[d.Q5.GroupId]||"",sharepointSiteUrl:n[d.Q5.SiteUrl]},smtpAddress:n[d.Q5.TeamSmtpAddress],pictureETag:n[d.Q5.PictureETag],isFavorite:(0,l.Dq)(e),channels:[]},function(e){const t=y(e.threadProperties[d.Q5.TeamAdminSettings]);return t?{teamSettings:t.userSettings,teamGuestSettings:t.guestSettings}:{teamSettings:{}}}(e))}(e)))),e.filter((e=>e&&(0,l.J6)(e)&&e.threadProperties)).map((e=>n.set(e.id,{teamId:e.threadProperties[d.Q5.SpaceId],channel:S(e)}))),n.forEach((e=>{const{teamId:n,channel:i}=e,a=n&&t.get(n);a&&(i.team=a,a.channels.push(i))}));const i=Array.from(t.values());return i.length>0?i:void 0}function S(e){const t=e.threadProperties,n=t[d.Q5.SpaceTypes]===c.tG.Private;return{id:e.id,displayName:(n?t[d.Q5.SpaceThreadTopic]:(0,l.T7)(e))||"",description:t[d.Q5.TopicDescription]||"",isDeleted:(0,l.uY)(e),isGeneral:(0,l.HU)(e),channelType:b(t[d.Q5.SpaceTypes]),tabs:[],isShown:(0,l.Dq)(e),isShownByDefault:"true"===t[d.Q5.FavDefault],sharepointSiteUrl:n?t[d.Q5.SiteUrl]:void 0,defaultFileSettings:{filesRelativePath:t[d.Q5.FolderRelativeUrl]},consumptionHorizon:(0,u._l)(e.id,e.properties[d.Ff.ConsumptionHorizon])}}function b(e){switch(e){case c.tG.Private:return g.xuW.Private;case c.tG.Shared:return g.xuW.Shared;case c.tG.None:default:return g.xuW.Standard}}function C(e){switch(e){case d.nL.Admin:return g.k_p.Admin;case d.nL.Guest:return g.k_p.Guest;case d.nL.User:return g.k_p.User;case d.nL.None:default:return g.k_p.Undefined}}function w(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableChannelLocalCache:i,channelLocalCacheMaxDays:r,enableChannelIndexedDBCache:s,disableChannelIndexedDBNextCache:l}=t.get(o.J.Search);let d,c=!1;if(s&&(d=yield E(e.profile.objectId,e.profile.tenantId,a,!!l),c=void 0!==d),i&&(function(e,t){const n=A(e),i=new Date(Date.now()),a=new Date((null==n?void 0:n.timestamp)||0);a.setDate(a.getDate()+t),a<i&&e.remove(v)}(n,c?0:r||7),!d)){const e=A(n);d=null==e?void 0:e.teams}return d}))}let N;let T;const I=(0,m.J)();function E(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return N||(N=function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o=n.newScenario(r.RG.GetTeamsChannelsFromIndexedDB),l=a=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=function(e,t,n){return n?`Teams:conversation-manager:${t}:${e}`:`skypexspaces-${e}`}(e,t,n),o=function(e){return e?2:7}(n);return(0,s.q8)(i,o,p,"",a,!0)}))}(e,t,a,n)}catch(e){return void o.appendEventData({errors:JSON.stringify(e)})}}));let d;if(a||(d=yield l(!0)),d||(d=yield l(!1)),d)try{const e=k(d);return o.stop({message:e?"Successfully fetched.":"Conversations store does not contain any teams or channels."}),e}catch(e){return void o.fail({errors:"Fails to convert conversations to teams."})}else o.fail({errors:"unable to read conversations from indexedbd"})}))}(e,t,n,a),T=I.setTimeout((()=>{N=void 0,I.clearTimeout(T),T=void 0}),3e5),N)}))}function A(e){const t=e.get(v);if(t)return y(t)}function _(e,t){e.setSafe(v,JSON.stringify({timestamp:Date.now(),teams:t}))}},579580:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i="webinar-service"},974984:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinarImageQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinarImage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"}}]}}]}}]}},317456:(e,t,n)=>{"use strict";n.d(t,{HY:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"webinar"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"webinarId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webinar"},arguments:[{kind:"Argument",name:{kind:"Name",value:"webinarId"},value:{kind:"Variable",name:{kind:"Name",value:"webinarId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"allWebinarFiels"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"allWebinarFiels"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Webinar"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"accessPolicy"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"isFull"}},{kind:"Field",name:{kind:"Name",value:"privacyProfileStatementLink"}},{kind:"Field",name:{kind:"Name",value:"capacity"}},{kind:"Field",name:{kind:"Name",value:"price"}}]}},{kind:"Field",name:{kind:"Name",value:"speakerBios"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"speakerId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"questionnaire"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"questionId"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"isPredefined"}}]}},{kind:"Field",name:{kind:"Name",value:"isUserAlreadyRegistered"}},{kind:"Field",name:{kind:"Name",value:"joinLink"}},{kind:"Field",name:{kind:"Name",value:"participantRole"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registrationId"}},{kind:"Field",name:{kind:"Name",value:"paymentTransactionId"}}]}}]}},99068:(e,t,n)=>{"use strict";n.d(t,{O:()=>a,a:()=>o});var i=n(317456);const a=(e,t)=>{try{const n=e.readQuery({query:i.HY,variables:{webinarId:t}});if(!n||!n.webinar)throw new Error("Invalid cached webinar data");return n.webinar}catch(e){throw e}},o=(e,t,n,o)=>{try{const o=a(n,e),r=Object.assign(Object.assign({},o),{questionnaire:t.map((e=>{var t,n,i;return Object.assign(Object.assign({},e),{name:null!==(t=e.name)&&void 0!==t?t:null,displayName:null!==(n=e.displayName)&&void 0!==n?n:null,options:null!==(i=e.options)&&void 0!==i?i:null,__typename:"WebinarQuestion"})}))});n.writeQuery({variables:{webinarId:e},query:i.HY,data:{webinar:r}})}catch(e){throw o.error("Webinar resolver fails to update webinar questions in cache."),e}}},361286:(e,t,n)=>{"use strict";n.d(t,{s:()=>d});var i=n(579580),a=n(317456),o=n(974984),r=n(99068);let s;const l=e=>s||(s=e.newLogger(i.k)),d={Mutation:{updateWebinarDetails:(e,{webinarId:t,detailsInput:n},{cache:i,loggerFactory:o})=>{l(o);try{const e=(0,r.O)(i,t),o=Object.assign(Object.assign({},e),{eventDetails:Object.assign(Object.assign(Object.assign({},e.eventDetails),n),{__typename:"WebinarDetails"})});return i.writeQuery({variables:{webinarId:t},query:a.HY,data:{webinar:o}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar details in cache."),e}},updateWebinarQuestions:(e,{webinarId:t,questionsInput:n},{cache:i,loggerFactory:a})=>(l(a),(0,r.a)(t,n,i,s),{_:!0,__typename:"Webinar"}),updateWebinarSpeakers:(e,{webinarId:t,speakersInput:n},{cache:i,loggerFactory:o})=>{l(o);try{const e=(0,r.O)(i,t),o=Object.assign(Object.assign({},e),{speakerBios:n.map((e=>Object.assign(Object.assign({},e),{__typename:"WebinarSpeakerBio"})))});return i.writeQuery({variables:{webinarId:t},query:a.HY,data:{webinar:o}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar speakers in cache."),e}},updateWebinarImage:(e,{webinarId:t,webinarImageInput:n},{cache:i,loggerFactory:a})=>{l(a);try{return i.writeQuery({variables:{webinarId:t},query:o.C,data:{webinarImage:{image:n.image,__typename:"WebinarImage"}}}),{_:!0,__typename:"Webinar"}}catch(e){throw s.error("Webinar resolver fails to update webinar image in cache."),e}}}}},172887:(e,t,n)=>{"use strict";n.d(t,{kn:()=>i,JF:()=>a,up:()=>o,rS:()=>r});const i=3,a=3,o=3,r="MicrosoftTeams-EmailPost.eml"},660286:(e,t,n)=>{"use strict";n.d(t,{Mv:()=>r,kO:()=>s,a2:()=>d,LH:()=>c});var i=n(231191),a=n(892891),o=n(233090);function r(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return l(e,t)}))}function s(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return l(e,t,n)}))}function l(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT),s=yield Promise.all(r.map((e=>t.getPeopleProfilesByMris(e,n,!0,!1,!0))));let l=[];return s.forEach((e=>{l=l.concat(Array.from(e.values(),(e=>(0,o.ne)(e))))})),l}))}function d(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT);return(yield Promise.all(r.map((e=>t.getPeopleProfilesIncludeFederatedByMris(e,!0,!1,n))))).map((e=>Array.from(e.values(),(e=>(0,o.ne)(e))))).reduce(((e,t)=>e.concat(t)),[])}))}function c(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,a.uniqBy)(e,(e=>e)),r=(0,a.chunk)(i.map((e=>e)),t.MAX_PEOPLE_MRI_LIMIT);return(yield Promise.all(r.map((e=>t.getTflConsumerProfilesByMris(e,n||null))))).map((e=>Array.from(e.values(),(e=>(0,o.ne)(e))))).reduce(((e,t)=>e.concat(t)),[])}))}},903001:(e,t,n)=>{"use strict";n.d(t,{Hi:()=>U,xA:()=>B,FX:()=>j,Rx:()=>W,eH:()=>G,OB:()=>q,ts:()=>oe,is:()=>re,YU:()=>ge,it:()=>pe,H4:()=>fe,Ey:()=>ye,dx:()=>ke,zK:()=>Se,Th:()=>be,TK:()=>Ce,iB:()=>we,DP:()=>Ne,Gt:()=>Te,yU:()=>Ie,ac:()=>Ee,uA:()=>Ae,bv:()=>_e,_l:()=>Pe,wX:()=>Le,ob:()=>Ue,sf:()=>Be,$M:()=>je,fN:()=>$e,FH:()=>Qe,pR:()=>Je,b_:()=>Ye,zT:()=>Ke,C:()=>Ze,vI:()=>Xe,Qq:()=>et,I6:()=>tt,AY:()=>ot,nF:()=>st,Lr:()=>dt,_$:()=>ct,x6:()=>ut,Hl:()=>mt,lg:()=>gt,_S:()=>pt,ph:()=>vt,O5:()=>ft,eN:()=>kt,YX:()=>bt,im:()=>Ct,l0:()=>wt,D1:()=>Nt,Pi:()=>Tt,MB:()=>It,Go:()=>Et,xT:()=>At,RU:()=>_t,eY:()=>Dt,_V:()=>Ft,aw:()=>Mt,rP:()=>Pt,C6:()=>Ot,eX:()=>xt,qJ:()=>Lt,UL:()=>Ut,AK:()=>Bt,YD:()=>jt,wm:()=>Wt,nI:()=>Vt,fM:()=>Ht,GE:()=>zt,Eu:()=>Gt,NL:()=>qt,SX:()=>Zt});var i=n(231191),a=n(118824),o=n(266641),r=n(695276),s=n(896149),l=n(889454),d=n(907207),c=n(975652),u=n(870209),m=n(129350),g=n(275879),p=n(243517),v=n(298158),h=n(186930),f=n(990538),y=n(70404),k=n(967215),S=n(642115),b=n(281857),C=n(892891),w=n(742672),N=n(634437),T=n(233090),I=n(603167),E=n(523556),A=n(256998),_=n(413446),D=n(388734),F=n(395816),M=n(384742),R=n(528296);const P="http://schema.skype.com/StarredMessage",O=f.F,x=new Map([["sms",F.F6r.SMS],["email",F.F6r.Email],["call",F.F6r.Call],["teamscall",F.F6r.TeamsCall],["etnp",F.F6r.ETNP]]),L=new Set(["RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]);var U;!function(e){e.FAMILY="family",e.FRIENDS="friends",e.PROJECT="projectCoord",e.WORKPLACE="company",e.TRIP_PLANNING="tripPlanning",e.GET_TOGETHER="getTogether",e.LOCAL_COMMUNITY="localCommunity",e.HOLIDAY_PLANNING="holidayPlanning"}(U||(U={}));const B="preview-",j="newchat",W="welcomePage",V="deeplink",H=(e,t,n=!1)=>{if(!(null==e?void 0:e.emotions))return null;const i=e.emotions.map((({key:e,users:t})=>({key:e,users:t.map((({mri:e,time:t,value:n})=>({id:O(e),time:t,value:n}))).sort(((e,t)=>e.time-t.time))})));return n&&i.sort(((e,n)=>{var i,a,o,r,s,l;return(null!==(o=null!==(a=null===(i=null==t?void 0:t.emotions)||void 0===i?void 0:i[n.key])&&void 0!==a?a:n.users.length)&&void 0!==o?o:0)-(null!==(l=null!==(s=null===(r=null==t?void 0:t.emotions)||void 0===r?void 0:r[e.key])&&void 0!==s?s:e.users.length)&&void 0!==l?l:0)})),i},$=e=>{if(!e||!e.emotions)return null;const t=e.emotions;return Object.keys(t).map((e=>({key:e,count:t[e]})))},z=e=>{if(!e||!e.escalations)return null;return JSON.parse(e.escalations).map((({key:e,users:t})=>({key:x.get(e),users:t.map((({mri:e,time:t,value:n})=>({mri:O(e),time:t,value:n})))})))},G=(e,t)=>e&&e.mentions?J(e.mentions,t):null,q=(e,t)=>e&&e.onbehalfof?J(e.onbehalfof,t):null,Q=(e,t)=>{if(!t||!t.atp)return null;const n=t.atp;try{return"string"==typeof n?JSON.parse(n):n}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in toAtpSharepointData: ${t}`),null}},J=(e,t)=>{const n="string"==typeof e?JSON.parse(e):e;return n?n.map((({itemid:e,mri:n,displayName:i,mentionType:a})=>({id:`${t}_${e}_${n}`,userId:n,itemId:e,displayName:i,mentionType:a}))):null},Y=e=>{if(!e||!e.files)return null;try{let t=JSON.parse(null==e?void 0:e.files);return t=t.filter((e=>e.type===V)),t.map((({id:e,title:t,fileInfo:n,channelId:i,state:a})=>({id:e,title:t,state:a,serverRelativeUrl:n.serverRelativeUrl,channelId:i,siteUrl:n.siteUrl,objectUrl:n.fileUrl})))}catch(e){return null}},K=(e,t)=>{if(!t||!t.files)return null;try{let n=JSON.parse(t.files);n=n.filter((e=>e.type!==V));return(0,C.map)(n,(t=>Z(t,e)))}catch(e){return null}},Z=(e,t)=>{{const n=2,i=["http","https"],{filePreview:a,chicletBreadcrumbs:o,fileInfo:r,anchorFileId:s,progressComplete:l,isUploadError:d,fileChicletState:c,providerData:u}=e,{shareUrl:m,shareId:g,itemId:p}=r,v=a||{},h=null==c?void 0:c.serviceName,{id:f,baseUrl:k,objectUrl:S,type:b,title:C,state:w}=ae(e,n),N="active"!==w&&"hidden"!==w,T=ee(u,t);return Object.assign({id:f,itemId:p,chicletBreadcrumbs:o,baseUrl:(0,y.Nm)(k,i),objectUrl:(0,y.Nm)(S,i),shareId:g,shareUrl:m,type:b,title:C,fileId:f,isReferencedFile:N,anchorFileId:s,progressComplete:l&&parseInt(l,10)||null,serviceName:h&&F.a4b[h],state:w&&F.cj1[w],hasUploadFailed:d,providerDataV2:T},v)}},X=e=>{if(!e)return null;try{const t=(0,D.d)(e);return t.languages.split(":")[0]}catch(e){return null}},ee=(e,t)=>{try{const t=JSON.parse(e);if(!t||!t.code)return;const n=te(t.code);return{code:n,type:ie(parseInt(t.type,10))}}catch(e){return void t.newLogger("Chat Helper").log(`UnhandledException in message transformation: ${e}`)}},te=e=>{switch(e){case F.mFJ.BOX:return F.mFJ.BOX;case F.mFJ.DROPBOX:return F.mFJ.DROPBOX;case F.mFJ.EGNYTE:return F.mFJ.EGNYTE;case F.mFJ.GOOGLEDRIVE:return F.mFJ.GOOGLEDRIVE;case F.mFJ.SHAREFILE:return F.mFJ.SHAREFILE;default:throw new Error("Invalid provider code")}};var ne;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(ne||(ne={}));const ie=e=>{switch(e){case ne.Sharepoint:return F.RWp.Sharepoint;case ne.WOPI:return F.RWp.WOPI;case ne.Google:return F.RWp.Google;case ne.OneDrive:return F.RWp.OneDrive;case ne.Recent:return F.RWp.Recent;case ne.Aggregate:return F.RWp.Aggregate;case ne.FileSystem:return F.RWp.FileSystem;case ne.Search:return F.RWp.Search;case ne.AllFiles:return F.RWp.AllFiles;case ne.SharedWithMe:return F.RWp.SharedWithMe;default:throw new Error("Not a valid provider type")}},ae=(e,t)=>{var n;const{version:i}=e;let{id:a,baseUrl:o,objectUrl:r,type:s,title:l,state:d}=e;if(i!==t&&(({itemid:a,fileName:l,fileType:s,fileInfo:{fileUrl:r,siteUrl:o}}=e),d=null===(n=e.fileChicletState)||void 0===n?void 0:n.state),"string"!=typeof a)throw(0,S.Tr)("ChatHelpers",b.jK.Undefined,"toFiles",{id:a,version:i,type:s},"File id is missing");return{id:a,baseUrl:o,objectUrl:r,type:s,title:l,state:d}},oe=e=>JSON.stringify((0,C.map)(e,(({id:e,itemId:t,baseUrl:n,type:i,title:a,objectUrl:o,previewUrl:r,shareUrl:s,shareId:l,state:d,chicletBreadcrumbs:c,serviceName:u,previewHeight:m,previewWidth:g,progressComplete:p,hasUploadFailed:v,externalFileShareInfo:h})=>({itemid:e,fileName:a,fileType:i,fileInfo:{itemId:t,fileUrl:o,siteUrl:n,serverRelativeUrl:"",shareUrl:s,shareId:l},fileChicletState:{serviceName:u,state:d},"@type":"http://schema.skype.com/File",version:2,id:e,baseUrl:n,objectUrl:o,type:i,title:a,state:d,chicletBreadcrumbs:c,providerData:h,botFileProperties:{},isUploadError:v,progressComplete:p,filePreview:{previewUrl:r,previewHeight:m,previewWidth:g}})))),re=e=>e&&JSON.stringify((0,C.map)(e,(e=>{var{content:t}=e,n=(0,i.__rest)(e,["content"]);return Object.assign(Object.assign({},n),{content:JSON.parse(t)})}))),se=(e,t)=>{if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{const t=["http","https"],n=JSON.parse(e.links),i=[],a=[];return n.forEach((e=>{le(e,i,t),de(e,a,t)})),{urlPreview:a.length>0?a[0]:null,embeddedLinks:i}}catch(e){return t.newLogger("Chat Helper").log(`UnhandledException in message transformation: ${e}`),{urlPreview:null,embeddedLinks:null}}},le=(e,t,n)=>{const{url:i,fileShareUrlMeta:a,title:o,description:r}=e,s=(0,y.Nm)(i,n);a&&t.push({objectUrl:s,title:o,description:r,fileShareUrlMeta:a})},de=(e,t,n)=>{const{url:i,preview:a,previewenabled:o}=e,{previewurl:r,previewmeta:s,title:l,description:d}=a||{},c=(0,y.Nm)(i,n);t.push({url:c,thumbnail:(0,y.Nm)(r,n),title:l,description:d,previewEnabled:o,thumbnailMeta:s?{width:s.width,height:s.height}:null})},ce=(e,t,n)=>{if(!t||!t.cards)return null;try{let e=t.cards;n&&(e=n);return JSON.parse(e).map((({appIcon:e,appId:t,appName:n,cardClientId:i,content:a,contentType:o,locale:r,userSpecificContent:s})=>Object.assign({appIcon:e,appId:t||"",appName:n,cardClientId:i,content:JSON.stringify(a),contentType:o,locale:r},!!s&&{userSpecificContent:s})))}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in toCards: ${t}`),null}},ue=(e,t,n,i)=>{let a=i&&i.policyViolation;const o=i&&i.genericStreamMetadata;if(!a&&!o)return null;const r={};if("string"==typeof a)try{a=JSON.parse(a)}catch(n){e.newLogger("Chat Helper").log(`Exception in parsing PolicyViolation in message: ${t}. Error: ${n}`)}a&&(r.policyViolation=a);let s=o&&o.policyTip;if("string"==typeof o)try{s=JSON.parse(o).policyTip}catch(n){e.newLogger("Chat Helper").log(`Exception in parsing policy tip in message: ${t}. Error: ${n}`)}return s&&(r.dlpData={id:t,content:n,policyTip:s}),r},me=e=>{if(!e.scheduledmeetinginfo||(0,C.isNil)(e.scheduledmeetinginfo.eventType))return null;const t=e.scheduledmeetinginfo,{iCalUid:n}=t,a=(0,i.__rest)(t,["iCalUid"]);return Object.assign({iCalUID:n},a)},ge=e=>{const{itemId:t,meetingTitle:n,meetingActionType:a,scheduledMeetingInfo:o}=e,r=(0,i.__rest)(e,["itemId","meetingTitle","meetingActionType","scheduledMeetingInfo"]),s=Object.assign(Object.assign(Object.assign({},r),(e=>{const{iCalUID:t}=e,n=(0,i.__rest)(e,["iCalUID"]);return{scheduledmeetinginfo:Object.assign(Object.assign({},n),{iCalUid:t})}})(o)),{itemid:t,meetingtitle:n,"@type":a});return JSON.stringify(s)},pe=(e,t)=>{if(!t||!t.meeting)return null;try{const e=JSON.parse(t.meeting),{organizerId:n,tenantId:i,meetingJoinUrl:a,location:o,itemid:r,meetingtitle:s,rsvpTo:l,body:c}=e;return(0,A.w)({meetingActionType:e[d.BM.MeetingType],organizerId:n,tenantId:i,meetingJoinUrl:a,location:o,itemId:r,meetingTitle:s,rsvpTo:l,body:c,scheduledMeetingInfo:me(e)})}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in toMeeting: ${t}`),null}},ve=(e,t,n,i)=>{const a=t||n;if(a)return a;if(i&&L.has(e)){const e=i.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},he=(e,t)=>"-1"===e?t:e,fe=(0,l.Z)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),ye=(e,t)=>{if(e.length<=1)return e;const n=fe(t),i=[...e];return i.sort(((e,t)=>n.compare(e.displayName||"",t.displayName||""))),i},ke=(e,t,n)=>{const i=ye(e,n),a=[],o=[];return(0,C.forEach)(i,(e=>{const{id:n,displayName:i}=e;if(n!==t&&!E.eo.isTFLOffNetworkUser(n)&&i){if(o.push(i),20===o.length)return!1;a.length<3&&a.push(e)}return!0})),{membersLimited:a,memberDisplayNamesLimited:o}},Se=(e,t,n,i,a,o)=>{var s;if(!(null==e?void 0:e.id))return;const l=be(e,t,i,a,n,!!o),{id:d,clientmessageid:c,messagetype:m,properties:g,callId:p,skypeguid:v,composetime:h,content:f,conversationid:y,draftDetails:k,crossPostData:S}=e,b=(0,u.kw)(k),{callHistoryInput:C,isSlaCallHistory:N}=(0,w.fb)(g);return Object.assign(Object.assign({},l),{__typename:"Message",interopDeliveryState:Kt(null==g?void 0:g.deliveryState),smsDeliveryReports:g&&g.smsDeliveryReports?g.smsDeliveryReports:null,announcement:_e(g),escalations:z(g),notification:Qt(t,g),notifications:Yt(t,g),meeting:pe(t,g),onBehalfOf:q(g,d),callId:ve(m,p,v||g&&g.skypeguid,f),callLog:g&&(0,w.Hb)(he(d,c),C,y,m,f,t,N),skypeguid:v,composeTime:h,isCallStartedMessage:(0,r.LY)(f,m),replyPermission:null!==(s=null==g?void 0:g.replyPermission)&&void 0!==s?s:null,atpSharepointData:Q(t,g),isDeletedByAdmin:(null==g?void 0:g.adminDelete)||!1,suggestedActions:(null==g?void 0:g.suggestedActions)||null,scheduledSendTime:b?new Date(b).toISOString():null,draftId:(null==g?void 0:g.draftId)||(b?null==l?void 0:l.id:null),conversationId:y,crossPostStatus:S?(0,M.N)(S.status):void 0,crossPostFailedChannels:null==S?void 0:S.failedChannels})},be=({id:e,content:t,originalarrivaltime:n,from:i,messagetype:a,annotationsSummary:o,userHasStarred:r,properties:s,clientmessageid:l,version:d,imdisplayname:u,translation:m},g,p,v,h,f=!1)=>{let y=t;p&&(y=p);const k=ce(g,s,v),S=(e=>{const{body:t,subject:n,title:i,toggled:a,detectedLanguageName:o,sourceLanguageCode:r,targetLanguageCode:s,error:l}=e||{};return(void 0!==t||void 0!==l)&&o&&r&&s?{translationStatus:(()=>{if(!a)return F.C14.ShowOriginalMessage;if(!l)return F.C14.Done;switch(l){case c.AO.Success:return F.C14.Done;case c.AO.SkipTranslation:return F.C14.TranslationNotNeeded;case c.AO.MessageNotFound:return F.C14.MessageNotFound;case c.AO.VersionNotFound:return F.C14.VersionNotFound;case c.AO.LanguageDetectionFailed:return F.C14.LanguageDetectionFailed;case c.AO.UnsupportedSourceLanguage:return F.C14.UnsupportedSourceLanguage;default:return F.C14.UnknownError}})(),translatedSubject:n,translatedContent:t,translatedTitle:i,sourceLanguageName:o,sourceLanguageCode:r}:void 0})(m),b=(null==S?void 0:S.translationStatus)===F.C14.Done?(0,_.M)()[0].toString():d;return Object.assign(Object.assign(Object.assign({id:he(e,l),content:y,originalArrivalTime:n,from:O(i),messageType:Fe(g,a,s),isImportant:(0,N.wU)(null==s?void 0:s.importance),importance:(0,N.gy)(null==s?void 0:s.importance),emotionsSummary:$(o),emotions:H(s,o,f),mentions:G(s,e),cards:k,files:K(g,s),deeplinks:Y(s)},se(s,g)),{deleteTime:null==s?void 0:s.deletetime,editTime:null==s?void 0:s.edittime,version:b,userHasSaved:r,imDisplayName:u,clientMessageId:l,dlpContext:ue(g,e,t,s),atpSharepointData:Q(g,s),status:h||F.rJC.Delivered,hardDeleteReason:null==s?void 0:s.hardDeleteReason,hardDeleteTime:null==s?void 0:s.hardDeleteTime,onBehalfOf:q(s,e),sourceLanguageCode:X(null==s?void 0:s.languageStamp)}),S)},Ce=({content:e,id:t,messageType:n,originalArrivalTime:i,type:a,version:o})=>({__typename:"Message",content:e,id:t,messageType:n,originalArrivalTime:new Date(i).toISOString(),type:a,version:o}),we=(e,t,n)=>{const i=Se(e,t,Ft(e.state),void 0,void 0,!!(null==n?void 0:n.shouldSortReactions));if(!i)throw(0,S.Tr)("ChatHelpers",b.jK.Undefined,"toNewMessageSchema",{resource:e},"Bad shaped NewMessage");let a=null;if(e&&e.conversationLink){const t=(0,u.P5)(e);a=t===i.id?null:t}return{convId:e.conversationid||(0,u.o_)(e),replyChainId:a,threadType:e.threadtype,threadTopic:e.threadtopic,message:i}};function Ne(e,t){return{__typename:"Message",content:"",messageType:"Text",id:e,originalArrivalTime:t,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,embeddedLinks:null,callId:null,replyPermission:null,onBehalfOf:null,atpSharepointData:null,deeplinks:null,version:null,importance:null,interopDeliveryState:null,smsDeliveryReports:null,suggestedActions:null,emotions:null,emotionsSummary:null,escalations:null,mentions:null,status:null,diagnosticInfo:null,clientMessageId:e,urlPreview:null,dlpContext:null,editTime:null,deletionInfo:null,translation:null,userHasSaved:null}}function Te(e,t){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:t,timeStamp:t,clientMessageId:(0,I.K)()}}function Ie(e){const t=new Date,n=t.toISOString(),i=t.getTime().toString();return Object.assign(Object.assign({},{members:[],membersLimited:[],activeCallsCount:null,canBeDiscarded:null,canBeFavorited:null,canBeHidden:null,botMembers:null,canBeLeft:null,canBeMuted:null,canBePinned:null,canBotBeBlocked:null,canManageApps:null,canPopOut:null,canTagContact:null,chatSubType:null,isDisabled:!1,isOneOnOne:!1,isOneOnOneBotChat:!1,isRead:!0,datatid:null,displayName:null,hasActions:null,hasActiveCalls:null,hasFailedMessages:null,isBotBlocked:null,isBotUser:null,isContactTagged:null,isFederated:!1,isHidden:null,isHighImportance:null,isLastMessageFromMe:null,isLastMessageText:null,isMeeting:!1,isMuted:null,isNewChat:!0,isSfB:!1,isUrgentImportance:null,lastMessageSender:null,isUserMember:!0,creator:null,meetingInformation:null,userConsumptionHorizon:null,consumptionHorizonBookmark:null,lastMessageTime:null,lastContentMessageTime:null,longTitle:null,messagePreview:null,messagePreviewAria:null,otherMemberMris:null,pictureGroup:null,pictureUpn:null,pinnedIndex:null,plGroupKey:null,presenceSource:null,showAtMention:null,showMarkers:null,tooltipTitle:null,substrateGroupId:null}),{__typename:"Conversation",id:e,memberIds:[],memberDisplayNamesLimited:[],nonTeamsFederatedUserLimitedNames:[],hasFederatedUser:!1,chatHistoryHiddenTime:null,hasTflConsumerUser:!1,hasEnterpriseUser:!1,hasUnknownConsumerUser:!1,hasUnknownEnterpriseUser:!1,hasTflSmsUnverifiedUser:!1,hasTflSmsVerifiedUser:!1,tflOffNetworkUser:null,cfet:!1,consumerGroupId:null,tenantId:null,title:"",hasBotMember:!1,hasUnresolvedFederatedUser:!1,isChatDisabledForRecipients:!1,typingUsers:[],isPrivateChatPolicyDefinedScenario:null,meetingChatPolicy:null,me:null,tflOffNetworkUserLength:null,nonTeamsFederatedUsers:[],nonTeamsFederatedUsersLength:0,chatType:F.z_3.Chat,type:F.z_3.Chat,lastMessage:Ne(i,n),consumptionHorizon:Te(e,n),addedBy:null,addedByTenantId:null})}const Ee=(e,t,n,a)=>{var{annotationsSummary:o,id:r,from:s,messageType:l,properties:d,version:c}=e,u=(0,i.__rest)(e,["annotationsSummary","id","from","messageType","properties","version"]);if(void 0===a&&(a=!1),!r)return null;const{callHistoryInput:m,isSlaCallHistory:g}=(0,w.fb)(d);try{return Object.assign(Object.assign(Object.assign({__typename:"Message",id:r,from:s,messageType:Fe(n,l,d),version:(0,C.isNumber)(c)?c.toString():void 0,isImportant:(0,N.wU)(d&&d.importance),importance:(0,N.gy)(d&&d.importance),interopDeliveryState:Kt(null==d?void 0:d.deliveryState),smsDeliveryReports:(null==d?void 0:d.smsDeliveryReports)||null,emotions:H(d,o,a),emotionsSummary:$(o),announcement:_e(d),escalations:z(d),mentions:G(d,r),onBehalfOf:q(d,r),cards:ce(n,d),files:K(n,d),deeplinks:Y(d)},se(d,n)),{deleteTime:d&&d.deletetime,editTime:d&&d.edittime,isDeletedByAdmin:d&&d.adminDelete,scheduledSendTime:(null==d?void 0:d.sendAt)||null,draftId:(null==d?void 0:d.draftId)||null,hardDeleteTime:d&&d.hardDeleteTime,hardDeleteReason:d&&d.hardDeleteReason,suggestedActions:(null==d?void 0:d.suggestedActions)||null,status:F.rJC.Delivered,dlpContext:ue(n,r,u.content,d),meeting:pe(n,d),callId:d&&d.skypeguid,callLog:d&&(0,w.Hb)(r,m,t,l,u.content,n,g),sourceLanguageCode:X(null==d?void 0:d.languageStamp)}),u)}catch(e){return n.newLogger("Chat Helper").log(`UnhandledException in message transformation: ${e}`),Object.assign({id:r,from:s,messageType:Fe(n,l,d),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null},u)}},Ae=({originalArrivalTime:e,timeStamp:t,clientMessageId:n})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(t).toISOString(),clientMessageId:n}),_e=e=>{const t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e)return t;const n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;const i=n.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!i)return t;const a=De(i);return{title:e.title?e.title:"",originalImageUrl:a.originalImageUrl,croppedImageUrl:a.croppedImageUrl,colorTheme:a.colorTheme,croppedImageHeight:a.croppedImageHeight,croppedImageWidth:a.croppedImageWidth,croppedImageAltText:a.croppedImageAltText,isTeamsIllustration:a.isTeamsIllustration}},De=e=>{let t=(0,C.get)(e,"content.imageData.origImage.src",null),n=(0,C.get)(e,"content.imageData.croppedImage.src",null);const i=(0,C.get)(e,"content.imageData.croppedImage.imageHeight",null),a=(0,C.get)(e,"content.imageData.croppedImage.imageWidth",null),o=(0,C.get)(e,"content.imageData.croppedImage.imageAltText",null),r=(0,C.get)(e,"content.imageData.isTeamsIllustration",null);let s=(0,C.get)(e,"content.imageData.colorTheme",null)||(0,C.get)(e,"content.colorTheme",null);return t=void 0===t?null:t,n=void 0===n?null:n,s=void 0===s?null:s,{originalImageUrl:t,croppedImageUrl:n,croppedImageHeight:i,croppedImageWidth:a,croppedImageAltText:o,colorTheme:s,isTeamsIllustration:r}},Fe=(e,t,n)=>{if(t===d.Cs.HTML){if(Me(e,n))return d.Cs.Collaborate;if(Re(e,n))return d.Cs.Embed}return t},Me=(e,t)=>{const n=ce(e,t);if(!n)return!1;const i=(0,C.find)(n,(e=>"application/vnd.microsoft.card.fluid"===e.contentType));if(!i)return!1;return!!JSON.parse(i.content).componentUrl},Re=(e,t)=>{const n=ce(e,t);if(!n)return!1;const i=(0,C.find)(n,(e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));if(!i)return!1;return!!JSON.parse(i.content).componentUrl},Pe=(e,t)=>{if(!t||(0,C.isEmpty)(t))return null;const[n,i,a]=t.split(";"),o=parseInt(n,10),r=parseInt(i,10);return isNaN(o)||isNaN(r)?null:Object.assign({id:e},Ae({originalArrivalTime:o,timeStamp:r,clientMessageId:a}))},Oe=(e,t,n)=>{try{const n=xe(t),i=null==n?void 0:n.map((t=>({activityReplyToId:t.replyToId,activityTimestamp:t.timestamp,convId:e,suggestedReplies:t.suggestedActions.actions.filter((e=>{var t,n;return(null===(t=null==e?void 0:e.channelData)||void 0===t?void 0:t.id)&&(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.utcTime)})).map((e=>{var n,i;const a={targetMessageId:(null===(n=null==e?void 0:e.channelData)||void 0===n?void 0:n.targetMessageId)||t.replyToId,type:(null===(i=null==e?void 0:e.channelData)||void 0===i?void 0:i.type)||"reply"};return{suggestionChannelData:Object.assign(Object.assign({},null==e?void 0:e.channelData),a),value:e.value,whisperId:t.id}}))})));return i&&0!==i.length?{suggestedRepliesCollections:i}:null}catch(e){return n.newLogger("Chat Helper").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},xe=e=>{const t=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>{var t,n,i;return(null==e?void 0:e.type)===d.uV&&(null===(t=null==e?void 0:e.from)||void 0===t?void 0:t.id)===d.ZI&&(null==e?void 0:e.timestamp)&&(null===(i=null===(n=null==e?void 0:e.suggestedActions)||void 0===n?void 0:n.actions)||void 0===i?void 0:i.some((e=>e.type===d.qC||e.type===d.DC)))}));return t&&0!==t.length?t:null},Le=(e,t,n)=>{const i=t&&t[d.Ff.SmartReplies];return i&&"string"==typeof i?((e,t,n)=>{try{const i=JSON.parse(t);return Oe(e,i,n)}catch(e){return n.newLogger("Chat Helper").error(`formatQuickReplyAugmentationFromString: Exception in parsing quick reply augmentation. Error: ${e}`),null}})(e,i,n):null},Ue=e=>{switch(e){case c.wJ.None:return F.wJZ.Unknown;case c.wJ.Adhoc:return F.wJZ.Adhoc;case c.wJ.Scheduled:return F.wJZ.Scheduled;case c.wJ.Recurring:return F.wJZ.Recurring;case c.wJ.Broadcast:return F.wJZ.Broadcast;case c.wJ.MeetNow:return F.wJZ.MeetNow}},Be=e=>e&&e.map((e=>({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})))||null;var je;function We(e,t){if(!e||!t)return!1;return(0,m.hu)(e,t)>0}function Ve(e,t,n,i,o,r,s=!1,l=!1,d,c,m,g){const p=Ze(e,n),v=e.find((({id:e})=>e===t))||null,h=_t(e),f=(0,u.iK)(e,r,[]).members||[],y=function(e,t,n,i,o){const r=!(null==o?void 0:o.get(a.J.CdlWorker).disableLastMessageSenderCache);let s=i;switch(void 0===s&&(s=r?je.Cache:je.Runtime),s){case je.Noop:return null;case je.CacheOrNoop:return t&&t.id===n?t:null;case je.Cache:return t&&t.id===n?t:e.find((({id:e})=>e===n));case je.Runtime:return e.find((({id:e})=>e===n))}}(f,d,o,c,m);return Object.assign(Object.assign(Object.assign(Object.assign({memberIds:f.map((({id:e})=>e))},ke(f,t,i)),Je(p)),ot(t,f)),{me:v,isUserMember:!!v,lastMessageSender:y,tflOffNetworkUser:(0,C.first)(h),tflOffNetworkUserLength:h.length,hasBotMember:f.some((({id:e})=>(0,u.bl)(e))),hasFederatedUser:!!p.length||s,hasTflConsumerUser:et(f)||l,hasEnterpriseUser:at(f),hasUnknownEnterpriseUser:it(f),hasUnknownConsumerUser:nt(f),hasUnresolvedFederatedUser:p.some(E.eo.isUnknownUser),hasTflSmsUnverifiedUser:Xe(f),hasTflSmsVerifiedUser:tt(f),isRetentionHorizonSet:We(g,m)})}!function(e){e[e.Noop=0]="Noop",e[e.Cache=1]="Cache",e[e.CacheOrNoop=2]="CacheOrNoop",e[e.Runtime=3]="Runtime"}(je||(je={}));const He=e=>{switch(typeof e){case"string":return"true"===e.toLowerCase()}return e};function $e(e){const t=Object.keys(null!=e?e:{}).filter((e=>e.includes(d.Q5.Liveness))).map((t=>({key:t,value:String(e[t])})));return(0,C.isEmpty)(t)?null:t}function ze(e,t,n,i,o,r,s,l,h){var f,y,k,S,b,w;const{id:N,lastMessage:T}=e;let I;const E=!!(null===(y=null===(f=null==n?void 0:n.get(a.J.Messaging).expandedReactionsConfigs)||void 0===f?void 0:f.chat)||void 0===y?void 0:y.enableSend);T&&!(0,C.isEmpty)(T)&&(I=dt(Se(T,i,void 0,void 0,void 0,E)));const A=(null==r?void 0:r.id)||"",_=Ut(N),D=!!(0,m.YP)(e);let F={};if(I){let a=null==T?void 0:T.preview;if("string"!=typeof a&&!a){const r=(0,C.keyBy)(t,"id");n&&h&&(a=(0,p.t)({conversation:e,profilesMap:r,coreSettings:n,i18n:h,loggerFactory:i,currentUserMri:A,currentUserTenantId:null!=o?o:"",addSenderName:!0}))}F=Object.assign(Object.assign({},I),{preview:a,clientMessageId:_?Date.now().toString():null==I?void 0:I.clientMessageId,originalArrivalTime:_?e.clientArrivalTime:null==I?void 0:I.originalArrivalTime,isSystemMessage:(0,R.Ew)(I),hasMention:(0,R.aw)(I,A)})}const M=Ve(t,A,o,s,null==I?void 0:I.from,e.threadProperties,null===(k=e.usersProps)||void 0===k?void 0:k.hasFederatedUser,null===(S=e.usersProps)||void 0===S?void 0:S.hasConsumerUser,e.lastMessageSender,l,n,e),P=function(e,t){const{id:n,properties:i,threadProperties:a}=e,o=Pe(n,(0,g.zA)(e.properties));return{chatSubType:vt(a.threadType),chatType:ft(a.threadType),consumptionHorizon:Pe(n,i[d.Ff.ConsumptionHorizon]),consumptionHorizonBookmark:o,quickReplyAugmentation:Le(n,i,t),creator:a[d.Q5.Creator],importState:lt(a[d.Q5.ImportState]),isDisabled:Nt(a.isDisabled),disabledReason:st(a.disabledReason),isLastMessageFromMe:a.isLastMessageFromMe,meetingInformation:vt(a.threadType)===c.k2.Channel?void 0:Et(n,a[d.Q5.Meeting]),tenantId:a[d.Q5.TenantId],title:a.topic,userConsumptionHorizon:o,interopConversationStatus:kt(i[d.Ff.InteropConversationStatus]),gapDetectionEnabled:He(a.gapDetectionEnabled),cfet:Ke(a.cfet),consumerGroupId:a[d.Q5.ConsumerGroupId],guardianChatInfo:a[d.Q5.GuardianChatInfo],groupTemplate:$t(a[d.Q5.GroupTemplate]),themeId:a[d.Q5.ThemeId],picture:a[d.Q5.Picture],addedBy:(null==i?void 0:i.addedBy)||null,addedByTenantId:(null==i?void 0:i.addedByTenantId)||null,meetingChatPolicy:bt(a[d.Q5.MeetingChatPolicy]),chatScheduleSuggestionSuppressUntil:null==i?void 0:i.chatScheduleSuggestionSuppressUntil}}(e,i),O=Xt(e,(null==r?void 0:r.id)||""),x=e.properties.historyHiddenTime,L=(0,m.dO)(e,n).toString();return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),M),P),Ge(e.memberProperties)),{shortTitle:null===(b=e.chatTitle)||void 0===b?void 0:b.shortTitle,longTitle:null===(w=e.chatTitle)||void 0===w?void 0:w.longTitle,id:N,isRead:O,isHidden:(0,v.n)(x,null==I?void 0:I.originalArrivalTime,L),isMuted:(0,m.tl)(e),isOneOnOne:D,isOneOnOneBotChat:D&&M.hasBotMember,isFederated:xt(N),isMeeting:(0,u.e9)(N),isSfB:Ot(N),lastMessage:F,awarenessLiveState:$e(e.threadProperties),members:[],clearHistoryTime:L,chatHistoryHiddenTime:x,type:null}),At(e.threadProperties.pinnedItems))}const Ge=e=>{const t=null==e?void 0:e[d.e0.RelationshipState];return{extendedDirectoryRedemptionRequired:null==t?void 0:t.edRedemptionRequired}},qe=(e,t)=>(0,C.map)(t,(t=>e[t.id]||function(e){return(0,T.ne)(Object.assign(Object.assign({},e),{mri:e.id,objectId:"",type:"",userPrincipalName:"",isMuted:e.isReader,displayName:e.friendlyName}))}(t))),Qe=(e,t,n,i,a,o,r,s,l)=>{try{return ze(e,qe(t,e.members),n,i,a,o,r,s,l)}catch(t){return i.newLogger("Chat Helper").log(`UnhandledException in toConversationSchemaFromSkypeConversationLocal transformation: ${t}`),Object.assign(Object.assign({},e),{id:e.id,isUserMember:!1,members:[],membersLimited:[],memberDisplayNamesLimited:[],type:null})}},Je=e=>{const t=e.filter((e=>{var t;return!E.eo.isUnknownUser(e)&&(null===(t=e.featureSettings)||void 0===t?void 0:t.coExistenceMode)!==s.hN.TeamsOnly&&!!e.displayName}));return{nonTeamsFederatedUserLimitedNames:t.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:t.length}},Ye=(e,t,n)=>{try{const n=qe(t,e.members);return{id:e.id,members:n}}catch(t){return n.newLogger("Chat Helper").log(`UnhandledException in toConversationMembersSchemaFromSkypeConversationLocal transformation: ${t}`),{id:e.id,members:[]}}},Ke=e=>{switch(typeof e){case"string":return"true"===(null==e?void 0:e.toLowerCase())}return!!e},Ze=(e,t)=>e.filter((({tenantId:e,isFederated:n})=>n||t&&e&&e!==t)),Xe=e=>e.some((({id:e})=>(0,u.MR)(e))),et=e=>e.some((e=>E.eo.isTFLConsumerUser(e))),tt=e=>e.some((e=>E.eo.isTFLSmsVerifiedMri(null==e?void 0:e.id))),nt=e=>e.some((e=>(0,u.Nl)(e.id)&&E.eo.isUnknownUser(e))),it=e=>e.some((e=>E.eo.isEnterpriseUserMri(e.id)&&E.eo.isUnknownUser(e))),at=e=>e.some((e=>E.eo.isEnterpriseUserMri(e.id))),ot=(e,t)=>{let n=!0;const i=t&&t.some((t=>{if(!t.isFederated&&t.id!==e&&t.featureSettings){const e=t.featureSettings.isPrivateChatEnabled;return null==e?(n=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:n,isChatDisabledForRecipients:i}},rt={opted_out:F.Rdl.OptedOut,claimed:F.Rdl.Claimed,deprovisioned:F.Rdl.Deprovisioned},st=e=>{if(!e)return;const t=(0,k.D)(e);return{newlyCreatedUserId:t.userId,code:rt[t.code]}},lt=e=>{if(e)return F.B1J[e]},dt=e=>Object.assign(Object.assign({},e),{__typename:"LastMessage"}),ct=(e,t,n,a,o)=>{var{id:r,members:s,consumptionHorizon:l,userConsumptionHorizon:c,lastMessage:u,creator:m,meetingInformation:g,isDisabled:p,disabledReason:v,importState:h,isMuted:f,isLastMessageFromMe:y,isRead:k,isOneOnOne:S,isOneOnOneBotChat:b,isSticky:w,isExternal:N,consumerGroupId:I,templateType:E,chatType:A,historyHiddenTime:_,createdAt:D,interopConversationStatus:M,quickReplyAugmentation:R,meetingPolicy:P,addedBy:O,addedByTenantId:x}=e,L=(0,i.__rest)(e,["id","members","consumptionHorizon","userConsumptionHorizon","lastMessage","creator","meetingInformation","isDisabled","disabledReason","importState","isMuted","isLastMessageFromMe","isRead","isOneOnOne","isOneOnOneBotChat","isSticky","isExternal","consumerGroupId","templateType","chatType","historyHiddenTime","createdAt","interopConversationStatus","quickReplyAugmentation","meetingPolicy","addedBy","addedByTenantId"]);try{const e=(0,C.map)(s,(e=>(0,T.ne)(e))),i=u&&dt(Ee(u,r,t)),_=g&&{id:r,subject:g.subject,startTime:g.startTime,scenario:g.scenario,endTime:g.endTime,iCalUid:g.iCalUid,location:g.location,exchangeId:g.exchangeId,meetingType:g.meetingType?Ue(g.meetingType):F.wJZ.Unknown,resolvedSensitivityLabelId:g.resolvedSensitivityLabelId,isCopyRestrictionEnforced:g.isCopyRestrictionEnforced,meetingJoinUrl:g.meetingJoinUrl},D=!(!S&&!w&&E!==d.Q5.ImmutableRoster);return Object.assign(Object.assign(Object.assign({__typename:"Conversation"},Ve(e,(null==a?void 0:a.id)||"",n,o,null==i?void 0:i.from)),L),{id:r,consumptionHorizon:l&&Object.assign({__typename:"ConsumptionHorizon",id:r},Ae(l)),consumptionHorizonBookmark:c&&Object.assign({__typename:"ConsumptionHorizonBookmark",id:r},Ae(c)),userConsumptionHorizon:c&&Object.assign({__typename:"ConsumptionHorizonBookmark",id:r},Ae(c)),lastMessage:i,members:[],creator:m,meetingInformation:_,isDisabled:!!p,disabledReason:st(v),importState:lt(h),isMuted:f,isLastMessageFromMe:!!y,isRead:k,isOneOnOne:D,cfet:N,consumerGroupId:I,isOneOnOneBotChat:!!b,chatType:ft(A),interopConversationStatus:kt(M),quickReplyAugmentation:R&&Oe(r,R,t),addedBy:O,addedByTenantId:x,meetingChatPolicy:bt(P)})}catch(e){t.newLogger("Chat Helper").log(`UnhandledException in conversation object transformation: ${e}`);return Object.assign(Object.assign({},L),{id:r,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:_,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,chatType:null})}},ut=({id:e,members:t},n)=>{try{const n=(0,C.map)(t,(e=>(0,T.ne)(e)));return{__typename:"ConversationMembers",id:e,members:n}}catch(t){n.newLogger("Chat Helper").log(`UnhandledException in conversation object transformation: ${t}`);return{id:e,members:[]}}},mt=(e,t,n,i,a)=>({node:ct(e,t,n,i,a),cursor:e.createdAt||e.id}),gt=e=>({activities:e.activities,callLogs:e.callLogs,chats:e.chats,total:e.total});function pt(e){return JSON.stringify((0,C.map)(e,(e=>{const t=e.mentionType,n=e.displayName;return{"@type":"http://schema.skype.com/Mention",itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}const vt=e=>{if(e)return"space"===e||"topic"===e?c.k2.Channel:"meeting"===e?c.k2.Meeting:c.k2.None},ht=new Map([["chat",F.z_3.Chat],["phonechat",F.z_3.PhoneChat],["meeting",F.z_3.Meeting],["sfbinteropchat",F.z_3.SfBInteropChat]]),ft=e=>{let t=null;return null==e||(t=ht.get(e),void 0===t&&(t=null)),t},yt=new Map([["AcceptPending",F.uI5.AcceptPending],["ExtendedDirectoryAcceptPending",F.uI5.ExtendedDirectoryAcceptPending],["Accepted",F.uI5.Accepted],["Blocked",F.uI5.Blocked],["Quarantined",F.uI5.Quarantined]]),kt=e=>e&&yt.get(e)||null,St=new Map([["ChatEnabled",F.UOl.ChatEnabled],["ChatDisabled",F.UOl.ChatDisabled],["InMeeting",F.UOl.InMeeting],["ChatEnabledAnonymousDisabled",F.UOl.ChatEnabledAnonymousDisabled],["InMeetingAnonymousDisabled",F.UOl.InMeetingAnonymousDisabled]]),bt=e=>e&&St.get(e)||null,Ct=e=>!!e&&e===F.z_3.PhoneChat,wt=e=>{if(!e)return!1;switch(typeof e){case"string":e="true"===e.toLowerCase();case"boolean":return e;default:return!1}},Nt=e=>(0,C.isString)(e)?"true"===e.toLowerCase():e||!1,Tt=({id:e,conversationid:t,imdisplayname:n,from:i,composetime:a},o)=>e&&{"@type":P,mri:O(i),imdisplayname:n,messageId:e,parentMessageId:null!=o?o:e,threadId:t,isUnresolvedEmailUser:!1,originalComposeTime:a},It=(e,t,n)=>{const i=n.find((n=>{try{const i=JSON.parse((n.properties||{}).starred),a=i&&i["@type"]===P&&i.threadId===t?i.messageId:void 0;return e===a}catch(e){return!1}}));return i&&i.id},Et=(e,t)=>{if(!t)return;const n=JSON.parse(t);return Object.keys(t).length?Object.assign(Object.assign({id:e},n),{meetingJoinUrl:n.meetingJoinUrl||n.meetingJoinURL,meetingType:n.meetingType?Ue(c.wJ[n.meetingType]):F.wJZ.Unknown}):void 0},At=e=>{if(e)try{const t=JSON.parse(e);return{pinnedConversationItems:t.reduce(((e,t)=>(t.itemType===F.Voh.Message&&e.push({__typename:"Message",id:t.itemId}),e)),[])}}catch(e){return}},_t=e=>e.filter((({id:e})=>E.eo.isTFLOffNetworkUser(e))),Dt=(e,t,n)=>{const i=H(n.properties);return!!i&&i.some((n=>n.key===e&&!!n.users&&n.users.some((e=>e.id===t))))},Ft=e=>{let t;switch(e){case h.iv.Error:t=F.rJC.Error;break;case h.iv.Sending:t=F.rJC.Sending;break;default:t=F.rJC.Delivered}return t},Mt=({resourceType:e,resource:t},n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if("ThreadUpdate"===e)try{const{id:e="",members:i}=t,a=i?yield n(i,e):[];return{__typename:"ConversationMembers",id:e,members:a}}catch(e){a.newLogger("toChatMembersEvent").error(`Failed getting thread members: ${e}`)}}));var Rt;!function(e){e.SfBGatewayChat="@sfb.unq.gbl.spaces",e.OnPremFederatedGatewayChat="@sfbonprem.unq.gbl.spaces",e.FederatedGatewayChat="@fed.unq.gbl.spaces"}(Rt||(Rt={}));const Pt=e=>Ot(e)||xt(e)||(0,m.Bl)(e),Ot=e=>!!e&&e.endsWith(Rt.SfBGatewayChat),xt=e=>!!e&&(e.includes(":fed:preview")||e.endsWith(Rt.FederatedGatewayChat)||e.endsWith(Rt.OnPremFederatedGatewayChat)),Lt=(e,t)=>(0,C.filter)(e,(0,C.omit)(t,"__typename")),Ut=e=>!!e&&-1!==e.indexOf(B),Bt=e=>!!(null==e?void 0:e.startsWith("tfl:preview-")),jt=e=>!!e&&(-1!==e.indexOf(d.X2)||-1!==e.indexOf(d.At)),Wt=e=>e===j,Vt=e=>Wt(e)||Ut(e),Ht=e=>{switch(e){case U.FAMILY:case U.FRIENDS:case U.PROJECT:case U.WORKPLACE:case U.TRIP_PLANNING:case U.GET_TOGETHER:case U.LOCAL_COMMUNITY:case U.HOLIDAY_PLANNING:return!0}return!1},$t=e=>{const t=e&&(0,k.D)(e).id;return Ht(t)?t:void 0},zt=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),Gt=e=>!!e&&e.includes("meeting"),qt=(e,t,n,i,a,r,s)=>{if(e)return n?o.Th.Meeting:i?a?o.Th.Botchat:Ct(t)?o.Th.SMSOneOnOneChat:(0,m.Bl)(e)?o.Th.SfcInteropChat:Ot(e)?o.Th.SfbInteropChat:r?o.Th.NativeFederatedChat:s?o.Th.FederatedChat:o.Th.OneOnOneChat:(0,m.mB)(e)?o.Th.StreamOfNotes:o.Th.GroupChat},Qt=(e,t)=>{if(!t||!t.notification)return null;try{const e=t.notification;return{alertInMeeting:e.alertInMeeting,externalResourceUrl:e.externalResourceUrl}}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in chat message notification transformation: ${t}`),null}},Jt=e=>{if((0,C.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,C.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},Yt=(e,t)=>{if(!t||!t.notifications)return null;try{const e="string"==typeof t.notifications?JSON.parse(t.notifications):t.notifications;return e&&e.map((({surface:e,contentType:t,content:n})=>{var i,a,o;return{surface:e,contentType:t,content:{value:{height:null!==(i=Jt(n.value.height))&&void 0!==i?i:void 0,width:null!==(a=Jt(n.value.width))&&void 0!==a?a:void 0,title:n.value.title,url:null!==(o=n.value.url)&&void 0!==o?o:""}}}}))}catch(t){return e.newLogger("Chat Helper").log(`UnhandledException in message notifications parsing: ${t}`),null}};function Kt(e){if(e)return"string"==typeof e?e:e.state}const Zt=(e,t,n)=>{const i=n.get(a.J.Messaging).commCopilotSummarizationRequestConfig;return i?{gptVersion:i.gptVersion,summaryMode:i.summaryMode,input:{type:i.threadType,id:e,lookbackperiod:t},promptSetting:{temperature:"1.0"}}:null},Xt=(e,t)=>{if(Wt(e.id)||Ut(e.id))return!0;let n=(0,g.Hs)(e,t);if(!n&&Gt(e.id)&&e.lastContentMessageTime){const t=new Date(e.lastContentMessageTime).getTime(),i=(0,g.bf)(e),a=(0,g.BU)(e);n=t<=i.originalArrivalTime&&0===a.originalArrivalTime}return n}},603167:(e,t,n)=>{"use strict";n.d(t,{w:()=>s,K:()=>l,su:()=>d});var i=n(413446),a=n(118824),o=n(84574);const r=e=>e.slice(e.includes("_")?41:8),s=(e,t)=>{const n=[r(e),r(t)].sort();return`19:${n[0]}_${n[1]}@unq.gbl.spaces`};function l(){const[e,t]=(0,i.M)(2);return`${e}${t}`.substr(0,19)}function d(e){const{ageGroup:t}=e.get(a.J.AgeConsent);return t===o.zH.MinorWithMsaParentalConsent||t===o.zH.MinorWithoutMsaParentalConsent}},366606:(e,t,n)=>{"use strict";n.d(t,{B:()=>g,c:()=>p});var i=n(575754),a=n(306566),o=n(808947),r=n(109458),s=n(337210),l=n(139130),d=n(892891),c=n(758730),u=n(432327),m=n(170006);function g(e,t){const n=(0,d.castArray)(e),i=(0,u.yM)(n.map((e=>e.resolvers))),a=(null==t?void 0:t.enableClassBasedErrors)?"function"==typeof i?(...e)=>(0,o.o)(i(...e),"CDLResolver"):(0,o.o)(i,"CDLResolver"):i;return p({schema:(0,c.sJ)({resolvers:a,typeDefs:(0,u.c5)(n.map((e=>e.typeDefs))),directiveResolvers:(0,u.yM)(n.map((e=>e.directiveResolvers))),noExtensionExtraction:!0,updateResolversInPlace:!0,resolverValidationOptions:{requireResolversForResolveType:"ignore"},skipASTValidation:!0}),contextValue:n.reduceRight(((e,t)=>Object.assign(Object.assign({},e),t.contextValue)),{})})}function p(e){return new i.i((t=>{const{query:n,variables:i}=t,{operation:o}=(0,r.S)(n,null),d=t.getContext(),{schema:c,contextValue:u}=null!=e?e:d.incremental,g=Object.assign(Object.assign({},u),d);return"subscription"===o?(0,m.F)((()=>(0,s.L)({schema:c,document:n,contextValue:g,variableValues:i}))):new a.y((e=>{try{Promise.resolve((0,l.ht)({schema:c,document:n,variableValues:i,contextValue:g})).then((t=>{e.closed||(e.next(t),e.complete())}),(t=>{e.closed||e.error(t)}))}catch(t){e.closed||e.error(t)}}))}))}},233090:(e,t,n)=>{"use strict";n.d(t,{ne:()=>l,cx:()=>d,zP:()=>h});var i=n(142604),a=n(523556),o=n(9522),r=n(870209),s=n(892891);const l=(e,t,n,i)=>{const o=a.eo.getRequestCount(e),{mri:r,objectId:s,displayName:l,givenName:d,surname:p,type:h,jobTitle:y,userPrincipalName:k,email:S,tenantId:b,sipProxyAddress:C,mobile:w,telephoneNumber:N,tenantName:T,decoratedDisplayName:I,cid:E,description:A,externalCalendarEmailAddress:_,homeMri:D,homeTenantId:F,profileType:M}=e,R={__typename:"User",id:f(e),objectId:s,mri:r,displayName:l,givenName:d,surname:p,type:h,jobTitle:y,userPrincipalName:k,email:S,tenantId:n||b||null,sipProxyAddress:C,mobile:w,telephoneNumber:N,requestCount:o,preferredUserName:t,tenantName:T||null,decoratedDisplayName:I||null,cid:E,description:A,externalCalendarEmailAddress:_,emailForQuery:i,homeMri:D,homeTenantId:F,profileType:M};return function(e,t){const n=e.department;n&&(t.department=n)}(e,R),g(e,R),m(e,R),c(e,R),u(e,R),v(R),R},d=e=>{const{id:t,displayName:n,description:i,email:a,phone:o,mri:r,requestCount:s,syncSource:l}=e;return{__typename:"User",id:t,mri:r,objectId:r,displayName:n,userPrincipalName:r,givenName:n,surname:n,description:i,email:a,mobile:o,telephoneNumber:o,requestCount:s,syncSource:l}},c=(e,t)=>{var n;if(function(e){var t;const n=e;return void 0!==n.isFederated||void 0!==n.isAnonymousB2bUser||"federated"===(null===(t=n.type)||void 0===t?void 0:t.toLowerCase())}(e)){const{isFederated:i,fetchErrorCode:a,isAnonymousB2bUser:o}=e;t.isFederated=i||"federated"===(null===(n=e.type)||void 0===n?void 0:n.toLowerCase()),t.fetchErrorCode=a,t.isAnonymousB2bUser=o}else t.isFederated=null,t.fetchErrorCode=null,t.isAnonymousB2bUser=null},u=(e,t)=>{e.featureSettings&&(t.featureSettings=e.featureSettings),e.isBlocked&&(t.isBlocked=e.isBlocked),e.cid&&(t.cid=e.cid),e.isIbBarred&&(t.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(t.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(t.phonesInfo=(0,s.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(t.emailsInfo=(0,s.cloneDeep)(e.emailsInfo)),e.xtapUser&&(t.xtapUser=e.xtapUser),e.companyName&&(t.companyName=e.companyName),e.tenantName&&(t.tenantName=e.tenantName),e.imageUri&&(t.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(t.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),t.isShortProfile=e.isShortProfile},m=(e,t)=>{(function(e){return void 0!==e.userType}(e)||function(e){const t=e;return t.type?t.type===i.t.botType:(0,r.bl)(e.mri)}(e)||function(e){var t,n;return"aduser"===(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())||"aduser"===(null===(n=e.$$subType)||void 0===n?void 0:n.toLowerCase())}(e))&&(t.userType=e.userType,t.description=e.description,t.isUnified=e.isUnified,t.securityEnabled=e.securityEnabled,t.featureSettings=e.featureSettings,t.imageUri=e.imageUri,t.userLocation=e.userLocation)},g=(e,t)=>{const n=e.phones;n&&(t.phones=n.map((e=>p(e))))},p=e=>({number:e.number,type:e.type}),v=e=>{const{mri:t}=e;if((0,o.EG)(t)&&!e.displayName){const n=(0,o.Ol)(t);e.displayName=n,e.givenName=n}else if(t&&(0,r.MR)(t)&&!e.displayName){const n=(0,r.vq)(t);e.displayName=n,e.givenName=n}else e.displayName||(e.displayName="Unknown User");return e},h=e=>!!e&&!("string"!=typeof e||!a.eo.isTFLSmsVerifiedMri(e)),f=e=>e.mri||e.objectId||e.concatenatedId},754504:(e,t,n)=>{"use strict";n.r(t),n.d(t,{audienceViewSettingsId:()=>i.FR,coachSettingsId:()=>i.$C,streamingSettingsId:()=>i.Cs,resolvers:()=>i.s_,userExperiencePreferencesKey:()=>i.oJ,typeDefs:()=>a});var i=n(866067),a=n(56023)},866067:(e,t,n)=>{"use strict";n.d(t,{oJ:()=>u,$C:()=>g,Cs:()=>p,FR:()=>v,s_:()=>h});var i=n(231191),a=n(892891),o=n(695185),r=n(604781),s=n(65682),l=n(969626),d=n(878233),c=n(395816);const u="user-experience-preferences-key",m="user-experience-preferences-id",g="coach-settings-id",p="streaming-settings-id",v="audience-view-settings-id",h={Query:{allClientPreferences:(e,t,{clientPreferences:n})=>k(n.getAllPreferences()),clientPreferences:(e,{category:t},{clientPreferences:n})=>y(n.getPreferences(t),t),userExperiencePreferences(e,t,{localStorage:n}){const i=n.get(u,d.f.UserAndExperience);return i?S(JSON.parse(i)):{id:m}}},Mutation:{updateClientPreferences:(e,{value:t},{clientPreferences:n})=>(n.updatePreferences(t),k(n.getAllPreferences())),updateUserExperiencePreferences(e,{value:t},{localStorage:n}){var i,o,s,l,c,m;const g=f(n),p=(0,a.merge)({},g,Object.assign(Object.assign({},t),{tflGroupTemplatesHidden:Object.assign(Object.assign({},t.tflGroupTemplatesHidden),{items:(0,a.unionBy)(null===(i=g.tflGroupTemplatesHidden)||void 0===i?void 0:i.items,null===(o=t.tflGroupTemplatesHidden)||void 0===o?void 0:o.items,"groupTemplate")}),tflMeetingChicletPrivacyNoticeSettings:Object.assign({},t.tflMeetingChicletPrivacyNoticeSettings),prejoinSettings:Object.assign({},t.prejoinSettings),coachSettings:Object.assign({},t.coachSettings),streamingSettings:Object.assign({},t.streamingSettings),chatInfoPaneSettings:Object.assign({},t.chatInfoPaneSettings),channelInfoPaneSettings:Object.assign({},t.channelInfoPaneSettings),audienceViewSettings:Object.assign({},t.audienceViewSettings),newChatDraft:Object.assign({},t.newChatDraft),mtmaAppBannerSettings:Object.assign(Object.assign({},t.mtmaAppBannerSettings),{dismissedApps:(0,a.union)(null!==(l=null===(s=g.mtmaAppBannerSettings)||void 0===s?void 0:s.dismissedApps)&&void 0!==l?l:[],null!==(m=null===(c=t.mtmaAppBannerSettings)||void 0===c?void 0:c.dismissedApps)&&void 0!==m?m:[])})})),v=n.setSafe(u,(0,r.u4)(p),d.f.UserAndExperience);return S(v?p:g)},clearUserExperiencePreferences:(e,t,{localStorage:n})=>n.remove(u,d.f.UserAndExperience),clearUserExperiencePreferencesByCategory(e,{category:t},{localStorage:n}){const i=f(n);return delete i[t],n.setSafe(u,(0,r.u4)(i),d.f.UserAndExperience)}},Subscription:{clientPreferencesChangedEvent:{subscribe(e,{category:t},{clientPreferences:n}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let e;const i=new o((i=>{const a=n.getPreferenceObservable(t);return e=a.subscribe(i),()=>null==e?void 0:e.unsubscribe()}));return(0,s.TL)((0,l.Z)(i,void 0,void 0,"clientPreferencesChangedEvent"),(e=>({clientPreferencesChangedEvent:y(e,t)})))}))}}},Density:{comfy:"comfy",compact:"compact"},PerformanceMode:{normal:"normal",low:"low"},UserTheme:{light:"light",dark:"dark",contrast:"contrast"},ClientPreferenceCategoryTypes:{__resolveType:e=>e.hasOwnProperty("mode")?"PerformancePreferences":e.hasOwnProperty("disableAnimations")?"AnimationPreferences":e.hasOwnProperty("badgeActionComplete")||e.hasOwnProperty("labelActionComplete")?"PromoBadgePreferences":e.hasOwnProperty("chatDensity")?"DensityPreferences":e.hasOwnProperty("checkboxChecked")?"AppSwitcherPreferences":e.hasOwnProperty("userTheme")||e.hasOwnProperty("followOsTheme")?"ThemePreferences":e.hasOwnProperty("lastUsedBackgroundEffect")?"BackgroundEffectPreferences":e.hasOwnProperty("lastUsedBackgroundImage")||e.hasOwnProperty("lastUsedVideoFilter")?"VideoEffectPreferences":e.hasOwnProperty("lastUsedAvatarFilter")?"AvatarPreferences":e.hasOwnProperty("currentLayout")?"TeamLayoutPreferences":e.hasOwnProperty("chats")||e.hasOwnProperty("channels")||e.hasOwnProperty("chatContextualSearch")||e.hasOwnProperty("channelContextualSearch")||e.hasOwnProperty("chatHighlightsDetails")?"InfoPanePreferences":e.hasOwnProperty("cameraState")?"FlyoutCameraPreferences":e.hasOwnProperty("shouldPersistLogsIntoIDB")?"DiagnosticsLogsPreferences":null}},f=e=>{const t=e.get(u,d.f.UserAndExperience);return t?JSON.parse(t):{}},y=(e,t)=>{let n;switch(t){case c.wIZ.theme:n="theme-preferences-id";break;case c.wIZ.animation:n="animation-preferences-id";break;case c.wIZ.promo:n="promo-preferences-id";break;case c.wIZ.density:n="density-preferences-id";break;case c.wIZ.flyoutCamera:n="flyoutpane-preferences-id";break;case c.wIZ.infoPane:n="infopane-preferences-id";break;case c.wIZ.performance:n="perf-preferences-id";break;case c.wIZ.appSwitcher:n="app-switcher-preferences-id";break;case c.wIZ.videoEffect:n="videoeffect-preferences-id";break;case c.wIZ.backgroundEffect:n="background-effect-preferences-id";break;case c.wIZ.avatar:n="avatar-preferences-id";break;case c.wIZ.teamLayout:n="team-layout-id";break;case c.wIZ.diagnosticsLogs:n="diagnostics-logs-preferences-id"}return Object.assign({id:n},e)},k=e=>({id:"client-preferences-id",theme:Object.assign({},y(e.theme,c.wIZ.theme)),animation:Object.assign({},y(e.animation,c.wIZ.animation)),promo:Object.assign({},y(e.promo,c.wIZ.promo)),density:Object.assign({},y(e.density,c.wIZ.density)),flyoutCamera:Object.assign({},y(e.flyoutCamera,c.wIZ.flyoutCamera)),infoPane:Object.assign({},y(e.infoPane,c.wIZ.infoPane)),performance:Object.assign({},y(e.performance,c.wIZ.performance)),appSwitcher:Object.assign({},y(e.appSwitcher,c.wIZ.appSwitcher)),videoEffect:Object.assign({},y(e.videoEffect,c.wIZ.videoEffect)),backgroundEffect:Object.assign({},y(e.backgroundEffect,c.wIZ.backgroundEffect)),avatar:Object.assign({},y(e.avatar,c.wIZ.avatar)),teamLayout:Object.assign({},y(e.teamLayout,c.wIZ.teamLayout)),diagnosticsLogs:Object.assign({},y(e.diagnosticsLogs,c.wIZ.diagnosticsLogs))}),S=e=>({id:m,tflGroupTemplatesHidden:b(e.tflGroupTemplatesHidden,c.UZQ.tflGroupTemplatesHidden),tflMeetingChicletPrivacyNoticeSettings:b(e.tflMeetingChicletPrivacyNoticeSettings,c.UZQ.tflMeetingChicletPrivacyNoticeSettings),prejoinSettings:b(e.prejoinSettings,c.UZQ.prejoinSettings),coachSettings:b(e.coachSettings,c.UZQ.coachSettings),streamingSettings:b(e.streamingSettings,c.UZQ.streamingSettings),chatInfoPaneSettings:b(e.chatInfoPaneSettings,c.UZQ.chatInfoPaneSettings),channelInfoPaneSettings:b(e.channelInfoPaneSettings,c.UZQ.channelInfoPaneSettings),audienceViewSettings:b(e.audienceViewSettings,c.UZQ.audienceViewSettings),newChatDraft:b(e.newChatDraft,c.UZQ.newChatDraft),mtmaAppBannerSettings:b(e.mtmaAppBannerSettings,c.UZQ.mtmaAppBannerSettings)}),b=(e,t)=>{let n;switch(t){case c.UZQ.tflGroupTemplatesHidden:n="tfl-group-templates-hidden-id";break;case c.UZQ.tflMeetingChicletPrivacyNoticeSettings:n="tfl-meeting-chiclet-privacy-notice-settings-id";break;case c.UZQ.prejoinSettings:n="prejoin-settings";break;case c.UZQ.coachSettings:n=g;break;case c.UZQ.streamingSettings:n=p;break;case c.UZQ.chatInfoPaneSettings:n="chat-info-pane-settings-id";break;case c.UZQ.audienceViewSettings:n=v;break;case c.UZQ.newChatDraft:n="new-chat-draft-id";break;case c.UZQ.mtmaAppBannerSettings:n="mtma-app-banner-settings-id"}return Object.assign({id:n},e)}},477533:(e,t,n)=>{"use strict";n.r(t),n.d(t,{resolvers:()=>i.s,typeDefs:()=>a,ILocalizationSettingsVariables:()=>o.localizationSettingsQueryVariables,ILocalizationSettings:()=>o.localizationSettingsQuery,ILocalizationSettingsQuery:()=>o.y,IUpdateCurrentLocaleVariables:()=>r.updateCurrentLocaleMutation,IUpdateCurrentLocaleMutation:()=>r.W});var i=n(681663),a=n(80130),o=n(637051),r=n(558904)},637051:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"localizationSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localizationSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentLocale"}}]}}]}}]}},558904:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateCurrentLocale"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newLocale"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateCurrentLocale"},arguments:[{kind:"Argument",name:{kind:"Name",value:"newLocale"},value:{kind:"Variable",name:{kind:"Name",value:"newLocale"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentLocale"}}]}}]}}]}},681663:(e,t,n)=>{"use strict";n.d(t,{s:()=>s});var i=n(231191),a=n(637051),o=n(329371),r=n(142980);const s={Query:{localizationSettings(e,t,{hostCommunicationService:n,platformService:a,routingServices:s,i18n:l}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield c(s.state.getSearchState()||{});if(e)return{currentLocale:e};if(localStorage.getItem("localeCode"))return{currentLocale:localStorage.getItem("localeCode")};if(a.config.clientType===o.Bh.Web)return{currentLocale:l.locale};let t;try{const e=yield d(n);e?(t=(0,r.vw)(e).locale,yield l.setLocale(t)):t=l.locale}catch(e){t=l.locale}return{currentLocale:t}}))}},Mutation:{updateCurrentLocale(e,{newLocale:t},{cache:n,hostCommunicationService:r,loggerFactory:s,platformService:d,i18n:c}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const e={localizationSettings:{__typename:"LocalizationSettings",currentLocale:t}};return yield c.setLocale(t),localStorage.setItem("localeCode",t),n.writeQuery({query:a.y,data:e}),d.config.clientType!==o.Bh.Web&&(yield l(s,r,t)),{currentLocale:t}}catch(e){return{currentLocale:c.locale}}}))}}},l=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const a=e.newLogger("LocalizationSettingsResolvers");try{const e=yield t.loadModule("osutils");(yield null===(i=null==e?void 0:e.setAppLocale)||void 0===i?void 0:i.call(e,{localeName:n}))||a.warn("hostingCommunicationService language set has failed")}catch(e){a.warn("hostingCommunicationService failed to load")}})),d=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;const n=yield e.loadModule("osutils"),i=yield null===(t=null==n?void 0:n.getAppLocale)||void 0===t?void 0:t.call(n);return null==i?void 0:i.localeName})),c=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(e.localeCode)return e.localeCode;if(e.language)return e.language.toLowerCase();if(!e.setting)return;const t=e.setting;let n;if(Array.isArray(t)){for(const e of t)if(e.startsWith("localeCode:")){n=e;break}}else t.startsWith("localeCode:")&&(n=t);return n?n.split(":")[1]:void 0}))},838337:(e,t,n)=>{"use strict";n.d(t,{i:()=>a,s:()=>o});const i="CallHistory",a={addContact:(e,t)=>({originator:i,type:"addContact",data:()=>({mri:e,isFederatedUser:t})}),addSpeedDialContact:(e,t)=>({originator:i,type:"addSpeedDialContact",data:()=>({mri:e,isFederatedUser:t})})},o=e=>e.originator===i},248088:(e,t,n)=>{"use strict";n.d(t,{kn:()=>i,uS:()=>a,U3:()=>o});const i="Layout",a={collapseHeader:"collapseHeader",completeAppPhaseReached:"completeAppPhaseReached",criticalAppPhaseReached:"criticalAppPhaseReached",expandHeader:"expandHeader",expandTab:"expandTab",maximizeTab:"maximizeTab",postCriticalAppPhaseReached:"postCriticalAppPhaseReached",reset:"reset",resetLayoutOverrides:"resetLayoutOverrides",resizeSlot:"resizeSlot",updateAmsV2Domain:"updateAmsV2Domain",updateBaseImageUrl:"updateBaseImageUrl",updateIsImageAuthCookieValid:"updateIsImageAuthCookieValid"},o={collapseHeader:()=>({originator:i,type:a.collapseHeader}),completeAppPhaseReached:()=>({originator:i,type:a.completeAppPhaseReached}),criticalAppPhaseReached:()=>({originator:i,type:a.criticalAppPhaseReached}),expandHeader:()=>({originator:i,type:a.expandHeader}),expandTab:e=>({originator:i,type:a.expandTab,data:e}),maximizeTab:()=>({originator:i,type:a.maximizeTab}),postCriticalAppPhaseReached:()=>({originator:i,type:a.postCriticalAppPhaseReached}),resetLayoutOverrides:()=>({originator:i,type:a.resetLayoutOverrides}),resizeSlot:e=>({originator:i,type:a.resizeSlot,data:e}),updateAmsV2Domain:e=>({data:e,originator:i,type:a.updateAmsV2Domain}),updateBaseImageUrl:e=>({data:e,originator:i,type:a.updateBaseImageUrl}),updateIsImageAuthCookieValid:e=>({data:e,originator:i,type:a.updateIsImageAuthCookieValid})}},195479:(e,t,n)=>{"use strict";n.d(t,{uS:()=>a,U3:()=>o});const i="EntityMoreInfo",a={requestPersonMoreInfo:"requestPersonMoreInfo",requestTopicMoreInfo:"requestTopicMoreInfo"},o={requestPersonMoreInfo:e=>({originator:i,type:a.requestPersonMoreInfo,data:()=>Object.assign({},e)}),requestTopicMoreInfo:e=>({originator:i,type:a.requestTopicMoreInfo,data:()=>Object.assign({},e)})}},285648:(e,t,n)=>{"use strict";var i=n(231191);var a=n(892891),o=n(632735),r=n.t(o,2),s=n(808189),l=n(368596),d=n(25503),c=n(729788),u=n(760083);const m=e=>{if(g(e))return p(e)?{subNavEntity:v(e),headerEntity:h(e),startEntity:f(e),mainEntity:y(e),endEntity:k(e)}:null},g=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.agendapage].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},p=()=>!0,v=()=>null,h=()=>null,f=()=>null,y=({entity:e})=>e,k=()=>null,S={id:"com.microsoft.teams.agenda-page",name:"AgendaPageApp",supportedEntities:[u.p.agendapage],supportedRenderModes:[s.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},b=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(50611),n.e(60567),n.e(10440),n.e(75912),n.e(45746),n.e(19351),n.e(7983),n.e(1839),n.e(96421),n.e(67590),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(2205),n.e(12724),n.e(97901),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(54226),n.e(33493),n.e(25721),n.e(89386),n.e(71734),n.e(94101)]).then(n.bind(n,54283));function C(){const e=()=>null;return{getAppViewEntities:m,manifest:S,render:({appRenderMode:t,loggerFactory:n,onRenderEvent:a,scenarioFactory:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e=n.newLogger("AgendaPageApp"),t="agenda-page-app";a("ChunkLoadStarted",{chunkName:t});const{AgendaPage:i}=yield(0,d.mT)(b,t,r);return a("ChunkLoadSucceeded",{chunkName:t}),e.log("render: loading agendapage app"),o.createElement(l.f,{namespace:"calling",loaderRenderer:null},o.createElement(i,null))}return o.createElement(e,null)}))}}const w={id:"com.microsoft.teams.ai-insights",name:"AiInsightsApp",supportedEntities:[u.p.aiinsightscontent],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.aiinsightscontent,action:u.u.view}),windowFeatures:{width:1600,height:1e3,minWidth:1600,minHeight:1e3,offset:20}},N=e=>{if(T(e))return I(e)?{subNavEntity:E(e),headerEntity:A(e),startEntity:_(e),mainEntity:D(e),endEntity:F(e)}:null},T=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.aiinsightscontent].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},I=()=>!0,E=()=>null,A=()=>null,_=()=>null,D=({entity:e})=>e,F=()=>null,M="ai-insights-app",R=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(50611),n.e(60567),n.e(75912),n.e(10297),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(86363),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(54226),n.e(95019)]).then(n.bind(n,232293)),P=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,556620)),O=()=>w.windowFeatures||{};function x(){const e=()=>null;return{getAppViewEntities:N,getAppWindowFeatures:O,manifest:w,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){n("ChunkLoadStarted",{chunkName:M});const[{TranscriptAiInsights:e},{CallsTabContextProvider:t}]=yield Promise.all([(0,d.mT)(R,M,a),(0,d.mT)(P,M,a)]);return n("ChunkLoadSucceeded",{chunkName:M}),o.createElement(l.f,{namespaces:["calling","meetingAnalytics"],loaderRenderer:null},o.createElement(t,null,o.createElement(e,null)))}return o.createElement(e,null)}))}}var L=n(395816);const U=e=>{if(B(e))return j(e)?{subNavEntity:W(e),headerEntity:V(e),startEntity:H(e),mainEntity:$(e),endEntity:z(e)}:null},B=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.annotation].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},j=()=>!0,W=()=>null,V=()=>null,H=()=>null,$=({entity:e})=>e,z=()=>null,G=()=>({[L.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!0,isSlotBackgroundTransparent:!0,UNSAFE_enablePptProvider:!0}}}),q={id:"com.microsoft.teams.annotation",name:"AnnotationApp",supportedEntities:[u.p.annotation],supportedRenderModes:[s.S.Main],windowFeatures:{additionalFeatures:{alwaysOnTop:"true",excludeWindowFromScreenSharing:"true",transparent:"true",hideWindowControl:"true",resizable:"false"},top:0,left:0,height:360,width:640,minHeight:360,minWidth:640}},Q=()=>Promise.all([n.e(5576),n.e(44781),n.e(88357)]).then(n.bind(n,192077)),J=({windowOptions:e})=>e&&q.windowFeatures?{additionalFeatures:q.windowFeatures.additionalFeatures,top:e.top,left:e.left>0?e.left:e.left/2,width:q.windowFeatures.width,height:q.windowFeatures.height,minWidth:q.windowFeatures.minWidth,minHeight:q.windowFeatures.minHeight,fullscreen:!0}:Object.assign(Object.assign({},q.windowFeatures),{fullscreen:!0});function Y(){const e=()=>null;return{getAppViewEntities:U,getAppViewEntitiesProps:G,getAppWindowFeatures:J,manifest:q,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const{Annotation:e}=yield(0,d.mT)(Q,"annotation-app",n);return o.createElement(l.f,{namespace:"calling",loaderRenderer:null},o.createElement(e,null))}return o.createElement(e,null)}))}}var K=n(118824),Z=n(933740);const X=e=>{if(ee(e))return te(e)?{subNavEntity:ne(e),headerEntity:ie(e),startEntity:ae(e),mainEntity:oe(e),endEntity:re(e)}:null},ee=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.attendeeview].includes(i),r=n&&[u.u.default,u.u.create,u.u.view].includes(n);return!!(a&&o&&r)},te=()=>!0,ne=()=>null,ie=({entity:e})=>e,ae=()=>null,oe=({entity:e})=>e,re=()=>null,se=({coreSettings:e})=>{var t;const{enableLightThemeSupport:n=!1}=null!==(t=null==e?void 0:e.get(K.J.Calling))&&void 0!==t?t:{};return{[L.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!n}},[L.tF7.headerEntity]:{[s.S.HorizontalBar]:{doesHeaderOverlapMain:!1,isBackgroundTransparent:!0}}}},le={id:"com.microsoft.teams.attendee-view",name:"AteendeeViewApp",supportedEntities:[u.p.attendeeview],supportedRenderModes:[s.S.Main,s.S.HorizontalBar],windowFeatures:{height:360,width:640,minHeight:360,minWidth:640,offset:20}},de=()=>Promise.all([n.e(287),n.e(47113),n.e(15803),n.e(35235),n.e(35799),n.e(22681),n.e(60567),n.e(34983),n.e(83505),n.e(4759),n.e(20532),n.e(62514),n.e(21439),n.e(74632),n.e(84395),n.e(30585),n.e(69816),n.e(40705),n.e(65162),n.e(23594),n.e(17530)]).then(n.bind(n,617738)),ce=()=>Promise.all([n.e(287),n.e(47113),n.e(15803),n.e(35235),n.e(35799),n.e(22681),n.e(60567),n.e(34983),n.e(83505),n.e(4759),n.e(20532),n.e(62514),n.e(21439),n.e(74632),n.e(84395),n.e(30585),n.e(69816),n.e(40705),n.e(65162),n.e(23594),n.e(17530)]).then(n.bind(n,914482)),ue="attendee-view-app",me=(e,t,n,i)=>{const a=(e=>{const t=null==e?void 0:e.coreSettings.get(K.J.Host).disableOldDesktopCallMonitor;return(null==e?void 0:e.coreSettings.get(K.J.Calling).enableModernCallMonitor)||t?{width:304,height:247,cornerMargin:100}:{width:280,height:160,cornerMargin:16}})(i),o=a.cornerMargin,r=a.height+a.cornerMargin+16,s="availLeft"in e?e.availLeft:0,l=("availTop"in e?e.availTop:0)+e.availHeight-n-r,d=s+e.availWidth-t-o,c=l<0||d<0;return{top:c?0:l,left:c?0:d}},ge=({coreServices:e,host:t})=>{var n;const i=null==t?void 0:t.screen;if(!i)return null;const a=(null===(n=le.windowFeatures)||void 0===n?void 0:n.width)||640,o=(e=>e?360+(0,Z.fh)(e.windowProvider,6)+(0,Z.fh)(e.windowProvider,2.4):360)(e),{top:r,left:s}=me(i,a,o,e);return{additionalFeatures:{alwaysOnTop:"true",closable:"false",excludeWindowFromScreenSharing:"true",fullscreenable:"false",maximizable:"false",resizable:"false"},top:r,left:s,width:a,height:o,minWidth:a,minHeight:o}};function pe(){const e=()=>null;return{getAppViewEntities:X,getAppViewEntitiesProps:se,getAppWindowFeatures:ge,manifest:le,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const{AttendeeView:e}=yield(0,d.mT)(de,ue,n);return o.createElement(ve,null,o.createElement(e,null))}if(t===s.S.HorizontalBar){const{AttendeeToolbar:e}=yield(0,d.mT)(ce,ue,n);return o.createElement(ve,null,o.createElement(e,null))}return o.createElement(e,null)}))}}const ve=({children:e})=>o.createElement(l.f,{namespace:"calling",loaderRenderer:null},e),he={id:"com.microsoft.teams.biometric-enrollment",name:"BiometricEnrollmentApp",supportedRenderModes:[s.S.Main],supportedEntities:[u.p.voiceenrollment,u.p.faceenrollment],windowFeatures:{minWidth:900,width:900,minHeight:950,height:950}},fe=e=>{if(ye(e))return ke(e)?{subNavEntity:Se(e),headerEntity:be(e),startEntity:Ce(e),mainEntity:we(e),endEntity:Ne(e)}:null},ye=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.faceenrollment,u.p.voiceenrollment].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},ke=()=>!0,Se=()=>null,be=()=>null,Ce=()=>null,we=({entity:e})=>e,Ne=()=>null,Te=()=>Promise.all([n.e(17512),n.e(18861),n.e(287),n.e(47113),n.e(75916),n.e(13228),n.e(53386),n.e(62514),n.e(62541),n.e(80414)]).then(n.bind(n,238883)),Ie=()=>he.windowFeatures||{};function Ee(){const e=()=>null;return{getAppViewEntities:fe,getAppWindowFeatures:Ie,manifest:he,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="biometric-enrollment-entry",{BiometricEnrollmentEntry:t}=yield(0,d.mT)(Te,e,n);return o.createElement(t,null)}return o.createElement(e,null)}))}}var Ae=n(454948);class _e extends Ae.G{static fromExecutionError(e,t){return new _e({code:"EXECUTION_FAILURE",taskName:e,prevError:t})}static fromMissingDependencies(e,t){return new _e({code:"MISSING_DEPENDENCIES",taskName:e,dependencies:t,message:`${JSON.stringify(t)} are required, but not initialized.`})}constructor({code:e,taskName:t,prevError:n,dependencies:i,message:a}){super({type:"TaskError",code:e,prevError:n,message:a}),this.taskName=t,this.missingDependencies=i}getBoundaryProps(){return"EXECUTION_FAILURE"===this.code&&this.prevError instanceof Ae.G?this.prevError.getBoundaryProps():super.getBoundaryProps()}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{taskName:this.taskName,prevError:this.prevError,missingDependencies:JSON.stringify(this.missingDependencies)})}toTelemetryCode(){var e;return`[${this.type}::${this.taskName}::${this.code}::${null===(e=this.missingDependencies)||void 0===e?void 0:e.join()}]`}static fromSerialized(e){if("TaskError"!==(null==e?void 0:e.type))return null;const t=new _e({code:e.code,taskName:e.taskName,prevError:e.prevError,dependencies:e.dependencies});return t.deserialize(e),t}}var De=n(281857);class Fe{constructor(e,t){this.id=e,this.name=De.Yg[e],this.dependencies=t}executeSafe(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=[];for(const t of this.dependencies)null==e[t]&&n.push(t);if(n.length>0)throw _e.fromMissingDependencies(this.name,n);try{return yield this.execute(e,t)}catch(e){throw _e.fromExecutionError(this.name,e)}}))}}var Me=n(576265),Re=n(5317);class Pe extends Fe{constructor(){super(De.Yg.CreateAsyncMediaAuth,["gtmRegistry","discover","loggerFactory","coreSettings","windowProvider","platformService","endpointsManager","localStorage","authenticationService","config","authenticationUser"]),this.lifeCycleSubscriptions=[De.sM.OnUserAuthenticated,De.sM.OnUserAuthenticated_MTMA]}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.mediaAuthService||(e.mediaAuthService=new Re.b(Me.l,e.gtmRegistry,e.discover,e.loggerFactory,e.coreSettings,e.windowProvider,e.platformService,e.endpointsManager,e.localStorage,e.authenticationService,e.config,e.authenticationUser))}))}}const Oe={id:"com.microsoft.teams.breakout-rooms",name:"BreakoutRoomsApp",supportedEntities:[u.p.breakoutrooms,u.p.breakoutroomsassignment,u.p.breakoutroomsassignmenttype,u.p.breakoutroomscreaterooms,u.p.breakoutroomsdeleteroom,u.p.breakoutroomsdeleterooms,u.p.breakoutroomseditroom,u.p.breakoutroomssettings],supportedRenderModes:[s.S.Main,s.S.HorizontalBar,s.S.Rail],getDefaultCommand:()=>({type:u.p.breakoutrooms,action:u.u.view}),windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20}},xe=e=>{if(Le(e))return Ue(e)?{subNavEntity:Be(e),headerEntity:je(e),startEntity:We(e),mainEntity:Ve(e),endEntity:He(e)}:null},Le=({entity:e,layoutMode:t})=>{const{action:n=null,type:i}=Object.assign({},e),a=[c.lO.standard,c.lO.focus].includes(t),o=[u.u.view,null].includes(n),r=[u.p.breakoutrooms].includes(i);return!!(n&&a&&r&&o)},Ue=()=>!0,Be=({entity:e,layoutMode:t})=>[c.lO.standard].includes(t)?e:null,je=({entity:e,layoutMode:t})=>[c.lO.standard].includes(t)?e:null,We=()=>null,Ve=({layoutMode:e,entity:t})=>[c.lO.standard,c.lO.focus].includes(e)?t:null,He=()=>null,$e=({areEmptySlotsTransparent:e})=>({[L.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0}},[L.tF7.subNavEntity]:{[s.S.Rail]:{isBackgroundTransparent:e}},[L.tF7.headerEntity]:{[s.S.HorizontalBar]:{isBackgroundTransparent:e}}}),ze=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(10440),n.e(75912),n.e(45746),n.e(19351),n.e(7983),n.e(1839),n.e(94673),n.e(62514),n.e(21439),n.e(38393),n.e(21767),n.e(33876),n.e(2205),n.e(58163),n.e(69458),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(51959),n.e(84037)]).then(n.bind(n,166944)),Ge="breakout-rooms-northstar-app",qe=()=>Oe.windowFeatures||{};function Qe(){const e=()=>null;return{manifest:Oe,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){n("ChunkLoadStarted",{chunkName:Ge});const{BreakoutRoomsAppEntry:e}=yield(0,d.mT)(ze,Ge,a);return n("ChunkLoadSucceeded",{chunkName:Ge}),o.createElement(l.f,{namespaces:["breakoutRooms"],loaderRenderer:null},o.createElement(e,null))}return o.createElement(e,null)})),getAppViewEntities:xe,getAppViewEntitiesProps:$e,getAppWindowFeatures:qe,onRegister:e=>{e.registerTask(new Pe)}}}var Je=n(880200),Ye=n(329371),Ke=n(759207),Ze=n(119423);var Xe,et=n(505889),tt=n(451900);!function(e){e.EmptyDeeplinkUrl="empty-deeplink-url-received",e.EmptyContext="empty-context-received"}(Xe||(Xe={}));const nt=[{filter:e=>{const t=e.pathname.includes("/l/meetup-join"),n=new URLSearchParams(e.search).get("context");if(!n)return!1;const{IsBroadcastMeeting:i}=JSON.parse(n);return t&&i},execute:({deeplinkUrl:{pathname:e,search:t},context:{coreSettings:n,client:i}})=>{var a,o;const{allowBroadcastAttendeeMeetingJoinsInT2:r,conveneTemplateUrl:s,allowBroadcastPresenterJoinsInT2:l}=n.get(K.J.Broadcast);if(!e)return Promise.reject({message:Xe.EmptyDeeplinkUrl});const d=e.split(/[/?&]/),c=d.indexOf("meetup-join")+1,u=d[c],m=d[c+1],g=new URLSearchParams(t);g.set("anon","true");const p=g.get("deeplinkId"),v=g.get("context");if(!v)return Promise.reject({message:Xe.EmptyContext});const{Tid:h,Oid:f}=JSON.parse(v),y=`${e}?${g.toString()}`;let k;const S=((e,t)=>{if("null"!==e)return e;const n=t.get("fqdn");return n?`https://${n}`:void 0})(origin,g);S&&(k=`${S}/_#${e}?${g.toString()}`);const b={joinType:L.cku.Legacy,conversationId:u,messageId:m,rootMessageId:m,isChannel:"0"!==m,isAdhoc:!1,tenantId:h,organizerId:f,meetingCloud:g.get("fqdn")||(0,et.uO)(origin),broadcast:{role:tt.BroadcastParticipantRole.Contributor}},C=!(null===(a=JSON.parse(v))||void 0===a?void 0:a.role);return((e,t,n,i,a,o,r,s,l)=>{const{tenantId:d,organizerId:c,conversationId:u,rootMessageId:m}=a;if(t&&r)return Promise.resolve({entityCommand:{entity:{type:L.pyR.callingdeeplink,action:L.ukP.join,id:`${u}/${m}`},command:{visibilityState:L.feW.show,stateTransition:L.suD.new,layoutMode:L.lOW.focus},entityOptions:{deeplinkUrl:n,coordinates:a,directMeetingLink:l,deepLinkId:s}},metadata:{allowAnonymous:!1,tenantId:d}});if(e){const e=`${d}__${c}__${u}__${m}`;if(i&&i.config.clientType===Ye.Bh.Maglev)return Promise.resolve({entityCommand:{entity:{id:e,type:L.pyR.broadcasts,action:L.ukP.view},command:{visibilityState:L.feW.show,stateTransition:L.suD.new,layoutMode:L.lOW.focus},entityOptions:{threadId:u,messageId:m,tenantId:d,organizerId:c}},metadata:{allowAnonymous:!0,tenantId:d}});if(o&&i&&i.config.clientType===Ye.Bh.Web){const t=(0,Ze.J)(),n=(0,Ke.Dk)(e,o);return t.open(n,"_blank"),Promise.resolve(void 0)}return Promise.resolve({entityCommand:{entity:{type:L.pyR.unsupporteddeeplinkdialog,action:L.ukP.view},command:{layoutMode:L.lOW.standard,stateTransition:L.suD.extend,visibilityState:L.feW.show},entityOptions:{originalDeeplink:n}},metadata:{allowAnonymous:!1,userContextId:void 0}})}return Promise.resolve({entityCommand:{entity:{type:L.pyR.unsupporteddeeplinkdialog,action:L.ukP.view},command:{layoutMode:L.lOW.standard,stateTransition:L.suD.extend,visibilityState:L.feW.show},entityOptions:{originalDeeplink:n}},metadata:{allowAnonymous:!1,userContextId:void 0}})})(r||!1,l||!1,y,null===(o=null==i?void 0:i.ctx)||void 0===o?void 0:o.platformService,b,s||void 0,C||!1,p,k)}}],it=e=>{if(at(e))return ot(e)?{subNavEntity:rt(e),headerEntity:st(e),startEntity:lt(e),mainEntity:dt(e),endEntity:ct(e)}:null},at=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.broadcasts,u.p.broadcastqna].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view,u.u.info].includes(n);return!!(a&&o&&r)},ot=()=>!0,rt=()=>null,st=({entity:e})=>e,lt=()=>null,dt=({entity:e})=>e,ct=({contextEntity:e})=>{const{action:t,type:n}=e||{};return e&&(n===u.p.broadcasts&&t===u.u.info||n===u.p.broadcastqna)?e:null},ut={id:"com.microsoft.teams.broadcast",name:"Broadcast",supportedEntities:[u.p.broadcasts,u.p.broadcastfeedback],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600}};var mt=n(324819),gt=n(554738);const pt=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(10440),n.e(75912),n.e(45746),n.e(19351),n.e(7983),n.e(1839),n.e(50025),n.e(62514),n.e(21439),n.e(38393),n.e(2205),n.e(89962),n.e(62795),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(81433),n.e(31693),n.e(6075),n.e(42256),n.e(26891),n.e(9699),n.e(16550),n.e(91683),n.e(68557)]).then(n.bind(n,286965)),vt=({coreServices:e,host:t,isResize:n})=>{const{minHeight:i,minWidth:a}=ut.windowFeatures||{},o=null==t?void 0:t.screen;if(n&&!o)return ut.windowFeatures||null;if(!o)return null;let{height:r=1,width:s=1}=((e,t)=>{const{minHeight:n=0,minWidth:i=0}=ut.windowFeatures||{};let{width:a,height:o}=ut.windowFeatures||{};if(!t)return{height:o,width:a,minHeight:n,minWidth:i};const{orientation:{type:r}}=e,{landscapeScreenRatio:s,portraitScreenRatio:l,widthHeightRatio:d}=t.coreSettings.get(K.J.Broadcast);if(s&&l&&d)switch(r){case"landscape-primary":case"landscape-secondary":const t=s*e.availHeight;o=t>n?t:n,a=d*o;break;case"portrait-primary":case"portrait-secondary":const r=l*e.availWidth;a=r>i?r:i,o=1/d*a}return{height:o,width:a}})(o,e);const l=o.availHeight-20,d=s>=o.availWidth||r>=l;d&&(r=o.availHeight,s=o.availWidth);const{left:c,top:u}=((e,t,n,i,a)=>{if(i)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,r="availTop"in e?e.availTop:0,s=o+e.availWidth/2-t/2;let l;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":l=r+a;break;default:l=r+e.availHeight/2-n/2}return{left:s,top:l}})(o,s,r,d,20);return{additionalFeatures:{minHeight:`${i}`,minWidth:`${a}`},height:r,width:s,fullScreen:d,left:c,top:u,minHeight:i,minWidth:a}};function ht(){const e=()=>null;return{getAppViewEntities:it,getAppWindowFeatures:vt,onBeforeDeeplinkParsed:nt,manifest:ut,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,mt.v4)();switch(t){case s.S.HorizontalBar:case s.S.Main:case s.S.Rail:const a="broadcast-app",{BroadcastViewsRenderer:r}=yield(0,d.mT)(pt,a,n);return o.createElement(gt.vb,{joinId:i},o.createElement(l.f,{namespace:"broadcast",loaderRenderer:null},o.createElement(Je.yx,null,o.createElement(r,{appRenderMode:t}))));default:return o.createElement(e,null)}}))}}var ft=n(628235);const yt=e=>{if(kt(e))return St(e)?{subNavEntity:bt(e),headerEntity:Ct(e),startEntity:wt(e),mainEntity:Nt(e),endEntity:Tt(e)}:null},kt=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.standard,c.lO.focus].includes(e),o=n&&[u.u.create,u.u.default,u.u.view,u.u.list].includes(n),r=[u.p.calendar,u.p.schedulingform].includes(i),s=u.p.schedulingform!==i&&u.u.view===n&&c.lO.focus===e;return!(!(a&&r&&o)||s)},St=()=>!0,bt=()=>null,Ct=({entity:e,coreSettings:t})=>{const n=null==t?void 0:t.get(K.J.Calendar).enableCalendarSchedulingFormMultiSlot,i=null==t?void 0:t.get(K.J.Calendar).enableFluentCalendarSurface,a=!!n&&e.type===u.p.schedulingform,o=!!i&&e.type===u.p.calendar;return a||o?e:null},wt=()=>null,Nt=({contextEntity:e,entity:t})=>(null==e?void 0:e.type)&&[u.p.extensions,u.p.attendancereport,u.p.meetinganalytics,u.p.meetingrecap,u.p.transcriptcontent,u.p.aiinsightscontent].includes(e.type)?e:t,Tt=({contextEntity:e})=>e&&e.action&&e.type===u.p.meetingcollaboration?e:null,It="calendar",Et="viewCalendarApp",At=()=>({actor:It,action:Et}),_t={id:"com.microsoft.teams.calendar",name:"CalendarApp",getLocalizedName:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("calendar"),e.stringTranslate("calendar","calendar_app_name")})),actors:[It],supportedEntities:[u.p.calendar,u.p.schedulingform,u.p.connectedcalendardialog,u.p.channelcalendar],supportedRenderModes:[s.S.Main,s.S.HorizontalBar,s.S.Modal],getDefaultCommand:()=>({type:u.p.calendar,action:u.u.default}),windowFeatures:{minWidth:565,width:1241,minHeight:720,height:720}};var Dt=n(553106),Ft=n(291019);const Mt=({action:e,appRenderMode:t,type:n})=>{const i=new Dt.H,a=[],o=[];return n===u.p.calendar?function(e,t){switch(e){case s.S.Main:t.push(Ft.GZ.CALENDAR_VIEW_RENDERED);break;case s.S.HorizontalBar:t.push(Ft.GZ.CALENDAR_HEADER_RENDERED)}}(t,a):n===u.p.schedulingform&&function(e,t,n,i){t===s.S.Main&&(e===u.u.create?n.push(Ft.GZ.CALENDAR_SF_VIEW_RENDERED):e===u.u.view&&(n.push(Ft.GZ.CALENDAR_SF_VIEW_RENDERED),i.push(Ft.GZ.CALENDAR_SF_TRACKING_VIEW_RENDERED)))}(e,t,a,o),a.length>0&&i.registerAppPhase({phase:Ft.nh.CRITICAL,signals:a,timeout:1e4}),o.length>0&&i.registerAppPhase({phase:Ft.nh.POST_CRITICAL,signals:o,timeout:1e4}),i.appPhases},Rt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCalendarTryStartMeetingBotPublisherMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tryStartMeetingBotPublisher"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};function Pt(e){const{client:t,coreSettings:n,loggerFactory:i}=e,a=t,o=i.newLogger("[MeetingBot-StartJob]");return{id:"start-meeting-bot",runOncePerId:!0,job:()=>{n.get(K.J.MeetingBot).enableMeetingBot?a.mutate({mutation:Rt,fetchPolicy:"no-cache"}):o.log("meetingbot is disabled")}}}var Ot=n(519194);const xt=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("CalendarApp onCommandReceived");if(e.command.actor===It)switch(n){case Et:return{entity:{type:u.p.calendar,action:u.u.default},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at CalendarApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by CalendarApp.`)})),Lt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCalendarConnectedCalendarSettingsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectedCalendarSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"accountAddress"}},{kind:"Field",name:{kind:"Name",value:"accountId"}},{kind:"Field",name:{kind:"Name",value:"isSyncAllowed"}}]}}]}}]},Ut={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCalendarGetExternalAccountsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"connectedAccountRequestResource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConnectedAccountRequestSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getExternalAccounts"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"connectedAccountRequestResource"},value:{kind:"Variable",name:{kind:"Name",value:"connectedAccountRequestResource"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"oAuthProviderDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"oAuthProviderType"}}]}},{kind:"Field",name:{kind:"Name",value:"userAccount"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"alternateId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"emailAddress"}}]}},{kind:"Field",name:{kind:"Name",value:"refreshTokenExpirationUnixTimestamp"}}]}}]}}]},Bt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCalendarRefreshExternalAccountMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"refreshExternalAccount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accountId"},value:{kind:"Variable",name:{kind:"Name",value:"accountId"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]},jt=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){yield n.mutate({mutation:Bt,variables:{accountId:e,callerInfo:t}})})),Wt=(e,t)=>{if(!e||!t)return!0;const n=Number(e);if(isNaN(n))return!0;const i=Math.round(Date.now()/1e3);return(n-i)/86400<=t},Vt="createConnectedAccountRefreshSrtJob";function Ht(e){const{client:t,coreSettings:n,loggerFactory:a,scenarioFactory:o}=e,r=a.newLogger("connected-account-refresh-srt-job"),s=t,{numberOfDaysToWaitBeforeSrtExpires:l}=n.get(K.J.Calendar);return{id:"connected-account-refresh-srt-job",job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e,n;const a=o.newScenario(ft.RG.ConnectedAccountRefreshSrtJob);try{const n=yield((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n;let i;const{data:a}=yield t.query({query:Lt,fetchPolicy:"network-only",variables:{callerInfo:e}});return(null===(n=null==a?void 0:a.connectedCalendarSettings)||void 0===n?void 0:n.length)&&(i=a.connectedCalendarSettings.filter((e=>!1===e.isSyncAllowed))),i})))(Vt,t);if(a.mark(ft.ck.GetConnectedCalendarSettingsComplete),!n||0===n.length)return a.mark(ft.ck.NoUnsyncedConnectedCalendarSettingFound),void a.stop();const o=yield((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{data:n}=yield t.query({query:Ut,fetchPolicy:"network-only",variables:{callerInfo:e,connectedAccountRequestResource:L.dcg.TflCloudCache}});return null==n?void 0:n.getExternalAccounts})))(Vt,t);a.mark(ft.ck.GetExternalAccountsComplete),o&&0!==o.length||a.mark(ft.ck.NoExternalAccountsFound);for(let t=0;o&&t<o.length;t++){const i=o[t];if(!i)continue;const r=null===(e=i.userAccount)||void 0===e?void 0:e.id;if(n.find((e=>e.accountId===r))){const e=i.refreshTokenExpirationUnixTimestamp;Wt(e,l)?(yield jt(r,Vt,s),a.mark(ft.ck.RefreshExternalAccountComplete)):a.mark(ft.ck.NoSrtRefreshNeeded)}else a.mark(ft.ck.NoMatchingExternalAccountToRefresh)}a.stop()}catch(e){const t=`Failed createConnectedAccountRefreshSrtJob with error code: ${null==e?void 0:e.code}`;null===(n=r.errorToTelemetry)||void 0===n||n.call(r,t,"connected_account_refresh_srt_job"),a.fail({errors:t})}}))}}var $t=n(967215),zt=n(443732);const Gt="/scheduling-form/";var qt,Qt,Jt,Yt,Kt,Zt,Xt;!function(e){e[e.Channel=0]="Channel",e[e.PrivateChat=1]="PrivateChat"}(qt||(qt={})),function(e){e[e.UserEventUsingEventId=0]="UserEventUsingEventId",e[e.TeamEventUsingEventId=1]="TeamEventUsingEventId",e[e.UserEventUsingICalUId=2]="UserEventUsingICalUId",e[e.TeamEventUsingICalUId=3]="TeamEventUsingICalUId",e[e.UserSeriesEventUsingOccurenceEventId=4]="UserSeriesEventUsingOccurenceEventId"}(Qt||(Qt={})),function(e){e.newMeeting="/l/meeting/new",e.viewMeeting="/l/meeting/details",e.meetingDetails="/l/calendar/scheduling-form"}(Jt||(Jt={})),function(e){e.NoEventId="calendar_on_before_deep_link_parsed_no_event_id_error",e.FeatureNotEnabled="calendar_on_before_deep_link_parsed_feature_not_enabled_error",e.InvalidContext="calendar_on_before_deep_link_parsed_invalid_context_error"}(Yt||(Yt={})),function(e){e.NoEventId="Parsed calendar deep link does not contain the event id",e.FeatureNotEnabled="Feature for parsing T1 calendar deep links in T2.1 is not enabled",e.InvalidContext="Parsed calendar deep link does not contain valid context query param"}(Kt||(Kt={})),function(e){e.StartTime="startTime",e.EndTime="endTime",e.Subject="subject",e.Content="content",e.Attendees="attendees"}(Zt||(Zt={})),function(e){e.EventId="eventId",e.Context="context"}(Xt||(Xt={}));const en=({deeplinkUrl:e,parsedDeeplinkHash:t,preferredCommandInput:n,context:{coreSettings:i,loggerFactory:a}})=>{var o,r,s,l;const d=a.newLogger("CalendarApp onBeforeDeeplinkParsed"),{enableParseT1CalendarDeeplinks:m}=i.get(K.J.Calendar);if(!m)throw null===(o=d.errorToTelemetry)||void 0===o||o.call(d,Kt.FeatureNotEnabled,Yt.FeatureNotEnabled),Error(Kt.FeatureNotEnabled);let g,p,v,h,f;if(null==t?void 0:t.search){const{search:e}=t;g=e.eventId,p=e.conversationId,v=parseInt(e.providerType,10)||Qt.UserEventUsingEventId,h=parseInt(e.opener,10)||qt.PrivateChat,f=tn(e.context,d)}else{const{search:t}=e,n=new URLSearchParams(t);g=n.get(Xt.EventId)||void 0,v=Qt.UserEventUsingEventId,h=qt.PrivateChat;const i=n.get(Xt.Context);f=tn(i,d)}const y=(null==n?void 0:n.correlation.source)===Ot.D.ActivityFeed?zt.kH.NOTIFICATION_POPOVER:zt.kH.DEEP_LINK;if(g)return Promise.resolve({entityCommand:{entity:{type:u.p.schedulingform,action:u.u.view,id:g},command:{stateTransition:null!==(r=null==n?void 0:n.stateTransition)&&void 0!==r?r:c.su.flush,visibilityState:null!==(s=null==n?void 0:n.visibilityState)&&void 0!==s?s:c.fe.show},entityOptions:Object.assign({navCtx:y,eventId:g,opener:h,conversationId:p,providerType:v},f)},metadata:{allowAnonymous:!1}});throw null===(l=d.errorToTelemetry)||void 0===l||l.call(d,Kt.NoEventId,Yt.NoEventId),Error(Kt.NoEventId)},tn=(e,t)=>e&&(0,$t.D)(e,{},(()=>{var e;throw null===(e=t.errorToTelemetry)||void 0===e||e.call(t,Kt.InvalidContext,Yt.InvalidContext),Error(Kt.InvalidContext)})),nn=({deeplinkUrl:e,parsedDeeplinkHash:t,context:{coreSettings:n,loggerFactory:i}})=>{var a;const o=i.newLogger("CalendarApp onBeforeDeeplinkParsed"),{enableParseT1CalendarDeeplinks:r}=n.get(K.J.Calendar);if(!r)throw null===(a=o.errorToTelemetry)||void 0===a||a.call(o,Kt.FeatureNotEnabled,Yt.FeatureNotEnabled),Error(Kt.FeatureNotEnabled);let s,l,d,m,g;if(null==t?void 0:t.search){const{search:e}=t;s=e.startTime&&new Date(e.startTime)||void 0,l=e.endTime&&new Date(e.endTime)||void 0,d=e.subject,m=e.content,g=e.attendees}else{const{search:t}=e,n=new URLSearchParams(t),i=n.get(Zt.StartTime),a=n.get(Zt.EndTime);s=i&&new Date(i)||void 0,l=a&&new Date(a)||void 0,d=n.get(Zt.Subject)||void 0,m=n.get(Zt.Content)||void 0,g=n.get(Zt.Attendees)||void 0}return Promise.resolve({entityCommand:{entity:{type:u.p.schedulingform,action:u.u.create,id:(0,mt.v4)()},command:{stateTransition:c.su.flush,visibilityState:c.fe.show},entityOptions:{navCtx:zt.kH.DEEP_LINK,startTime:s,endTime:l,subject:d,content:m,attendees:g,opener:1}},metadata:{allowAnonymous:!1}})},an={filter:(e,t)=>{var n;return!!e.hash&&(null==t?void 0:t.pathname)===Gt&&!(null===(n=null==t?void 0:t.search)||void 0===n?void 0:n.eventId)},execute:nn},on={filter:(e,t)=>{var n;return!!e.hash&&(null==t?void 0:t.pathname)===Gt&&!!(null===(n=null==t?void 0:t.search)||void 0===n?void 0:n.eventId)},execute:en},rn=[{filter:Jt.newMeeting,execute:nn},{filter:Jt.viewMeeting,execute:en},an,on,{filter:Jt.meetingDetails,execute:({deeplinkUrl:e,preferredCommandInput:t,context:{coreSettings:n,loggerFactory:i}})=>{var a,o,r,s;const l=i.newLogger("CalendarApp onBeforeDeeplinkParsed"),{enableParseT1CalendarDeeplinks:d}=n.get(K.J.Calendar);if(!d)throw null===(a=l.errorToTelemetry)||void 0===a||a.call(l,Kt.FeatureNotEnabled,Yt.FeatureNotEnabled),Error(Kt.FeatureNotEnabled);const{pathname:m,searchParams:g}=e,p=m.split("/")[4],v=(0,$t.D)(g.get("context"),{},(()=>{var e;throw null===(e=l.errorToTelemetry)||void 0===e||e.call(l,Kt.InvalidContext,Yt.InvalidContext),Error(Kt.InvalidContext)}));if(!p)throw null===(o=l.errorToTelemetry)||void 0===o||o.call(l,Kt.NoEventId,Yt.NoEventId),Error(Kt.NoEventId);return Promise.resolve({entityCommand:{entity:{type:u.p.schedulingform,action:u.u.view,id:p},command:{stateTransition:null!==(r=null==t?void 0:t.stateTransition)&&void 0!==r?r:c.su.flush,visibilityState:null!==(s=null==t?void 0:t.visibilityState)&&void 0!==s?s:c.fe.show},entityOptions:Object.assign({navCtx:zt.kH.DEEP_LINK,opener:qt.PrivateChat,eventId:p},v)},metadata:{allowAnonymous:!1}})}}],sn=()=>Promise.all([n.e(47113),n.e(13228),n.e(49095),n.e(68778)]).then(n.bind(n,3232)),ln=()=>_t.windowFeatures||{};function dn(){return{getAppViewEntities:yt,getAppWindowFeatures:ln,getCommandScenarioName:cn,getPlatformAppIdForEntity:e=>e.type===u.p.calendar||e.type===u.p.schedulingform?"ef56c0de-36fc-4ef8-b417-3d82ba9d073c":void 0,manifest:_t,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="calendar-app";t("ChunkLoadStarted",{chunkName:i});const{CalendarViewsRenderer:a}=yield(0,d.mT)(sn,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(l.f,{namespaces:["calendar","compose","extensibility","files"],loaderRenderer:null},o.createElement(a,{appRenderMode:e,onRenderEvent:t,scenarioFactory:n}))})),onBeforeDeeplinkParsed:rn,onCommandReceived:xt,onPreWarm:e=>{const{context:t}=e,n=t.coreSettings,{enableConnectedAccountSrtRefresh:i}=n.get(K.J.Calendar),a=[Pt(t)];return i&&a.push(Ht(t)),a},getAppPhases:Mt}}const cn=e=>{const{command:t,entity:n}=e;switch(n.type){case u.p.schedulingform:if(t.visibilityState===c.fe.hide)return;return n.action===u.u.create?ft.RG.CalSchedulingFormLoadForCreateMode:ft.RG.CalSchedulingFormLoad;case u.p.calendar:return ft.RG.CalendarSurfaceLoad;case u.p.channelcalendar:return ft.RG.ChannelCalendarLoad;case u.p.connectedcalendardialog:return ft.RG.ConnectedCalendarDialogLoad;default:return}};var un=n(195479);const mn="entitymoreinfo",gn="requestPersonMoreInfo",pn="requestTopicMoreInfo",vn=e=>({actor:mn,action:gn,data:e}),hn=e=>({actor:mn,action:pn,data:e}),fn={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case un.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:vn(i)})}return Promise.resolve(void 0)}};var yn=n(126297);const kn=e=>{if(Sn(e))return bn(e)?{subNavEntity:Cn(e),headerEntity:wn(e),startEntity:Nn(e),mainEntity:Tn(e),endEntity:In(e)}:null},Sn=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.callablechannels].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view].includes(n);return!!(a&&o&&r)},bn=()=>!0,Cn=({entity:e})=>e,wn=({entity:e})=>e,Nn=()=>null,Tn=({entity:e})=>e,In=()=>null,En={id:"com.microsoft.teams.callable-channel",name:"CallableChannelApp",supportedEntities:[u.p.callablechannels],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},An=()=>Promise.all([n.e(55575),n.e(33493),n.e(8914),n.e(24526)]).then(n.bind(n,497018)),_n=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,556620)),Dn=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,334814));function Fn(){const e=()=>null;return{eventHandlers:fn,getAppViewEntities:kn,manifest:En,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a,coreSettings:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="callable-channels-app";n("ChunkLoadStarted",{chunkName:e});const{enableEntityMoreInfo:t}=r.get(K.J.Core),i=({children:e})=>o.createElement(o.Fragment,null,e),{LPC:s}=t?{LPC:i}:yield(0,d.mT)(Dn,e,a),c=t?i:yn.p3;n("ChunkLoadSucceeded",{chunkName:e});const[{CallableChannelEntryContainer:u},{CallsTabContextProvider:m}]=yield Promise.all([(0,d.mT)(An,e,a),(0,d.mT)(_n,e,a)]);return o.createElement(l.f,{namespaces:["calling","hololens","messaging"],loaderRenderer:null},o.createElement(s,null,o.createElement(c,null,o.createElement(m,null,o.createElement(u,null)))))}return o.createElement(e,null)}))}}var Mn=n(642115),Rn=n(215235);const Pn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"InitCallingService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entryPoint"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingServiceEntrypointType"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"initCallingService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entryPoint"},value:{kind:"Variable",name:{kind:"Name",value:"entryPoint"}}}]}]}}]},On={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingDisposeCallingServiceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposeReason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeReason"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposeSource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"disposeCallingService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"disposeReason"},value:{kind:"Variable",name:{kind:"Name",value:"disposeReason"}}},{kind:"Argument",name:{kind:"Name",value:"disposeSource"},value:{kind:"Variable",name:{kind:"Name",value:"disposeSource"}}}]}]}}]};var xn;!function(e){e.DisposeMutationGenericJobError="DisposeMutationGenericJobError"}(xn||(xn={}));const Ln=(e,t,n,a,o)=>({id:"standup-calling",runOncePerId:!0,job:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const r=a.newScenario(ft.RG.StandupCallingAppExecute);r.appendEventData({context:n}),r.mark(ft.ck.ExecuteJob);const s=t.newLogger("getStandupCallingJob");s.log("[getStandupCallingJob] Initializing calling service");const{enableCallingSignOut:l,callingServiceDisposeTimeoutInMs:d}=o.get(K.J.Calling);try{const t=(e=>{switch(e){case ft.ck.OnAppPreWarm:return L.cCY.onAppPreWarm;case ft.ck.OnAppPreInit:return L.cCY.onAppPreInit;default:throw new Error(`StandupCallingJob - ${ft.ck} is not on_app_pre_warm or on_app_pre_init`)}})(n);r.pause({reason:De.jK.WaitingForResponse}),yield e.mutate({mutation:Pn,variables:{entryPoint:t}}),r.resume()}catch(e){throw s.error(`[getStandupCallingJob] Error initializing calling service [error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`),r.fail({errors:e.name,message:`${ft.ck.ExecuteJob} failed with ${e.message}`}),(0,Mn.Tr)(n,De.jK.StandupCallingJobError,e.name,void 0,e.message)}if(r.mark(ft.ck.JobCompleted),s.log("[getStandupCallingJob] Calling service initialized"),r.stop(),l)return()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return Un(e,s,a,n,d||45e3)}))}))}),Un=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const r=L.pMG.SignOut,s=L.QuG.StandupCallingAppJob,l=n.newScenario(ft.RG.CallingServiceDispose);l.appendEventData({context:r,dataSource:s,origin:a}),null===(i=n.hoistScenarioToCore)||void 0===i||i.call(n,l),t.log(`[getStandupCallingJob] Calling service disposal initiated. [step: ${a}, reason:${r}, source:${s}, timeout:${o}]`);try{const t=e.mutate({mutation:On,variables:{disposeReason:r,disposeSource:s}});yield(0,Rn.E)(t,o,`Dispose mutation timed out. [timeoutAmount:${o}]`)}catch(e){throw t.error(`[getStandupCallingJob] Error disposing calling service [error.name=${null==e?void 0:e.name}, error.code=${null==e?void 0:e.code}, error.message=${null==e?void 0:e.message}, timeout:${o}]`),l.fail({reason:(null==e?void 0:e.code)||xn.DisposeMutationGenericJobError,message:(null==e?void 0:e.message)||e}),(0,Mn.Tr)(ft.RG.CallingServiceDispose,De.jK.StandupCallingJobError,r,void 0,null==e?void 0:e.message)}l.stop(),t.log("[getStandupCallingJob] Calling service disposed")})),Bn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsCallingCallingAppEventsSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAppEvents"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEvent"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"event"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingContentEvent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppSetupEvent"}}]}},{kind:"Field",name:{kind:"Name",value:"context"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"source"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingContentEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingContentEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibility"}}]}},{kind:"Field",name:{kind:"Name",value:"content"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingBannerContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingWindowingContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingDialogContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingNotificationContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatListContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToSettingsPaneContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToCallListContent"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingBannerContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingBannerContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"intentLevel"}},{kind:"Field",name:{kind:"Name",value:"dismissable"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"bannerScenario"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"}},{kind:"Field",name:{kind:"Name",value:"joinButtonText"}},{kind:"Field",name:{kind:"Name",value:"bannerActions"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingWindowingContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingWindowingContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"coordsType"}},{kind:"Field",name:{kind:"Name",value:"windowingMode"}},{kind:"Field",name:{kind:"Name",value:"linkedContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingDialogContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingDialogContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"dialogActions"}},{kind:"Field",name:{kind:"Name",value:"dialogStrings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"text"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingNotificationContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingNotificationContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"crossClientScenarioName"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"subtitle"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"toastType"}},{kind:"Field",name:{kind:"Name",value:"image"}},{kind:"Field",name:{kind:"Name",value:"ringtoneAssetUrl"}},{kind:"Field",name:{kind:"Name",value:"time"}},{kind:"Field",name:{kind:"Name",value:"userid"}},{kind:"Field",name:{kind:"Name",value:"primaryAction"}},{kind:"Field",name:{kind:"Name",value:"actions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"icon"}},{kind:"Field",name:{kind:"Name",value:"actionType"}}]}},{kind:"Field",name:{kind:"Name",value:"header"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"defaultImageDataUrl"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"subtitle"}},{kind:"Field",name:{kind:"Name",value:"mri"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"messageId"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToSettingsPaneContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToSettingsPaneContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"tabItemId"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToCallListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToCallListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppSetupEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppSetupEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEventsSetupSuccess"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEventsSetupSuccess"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventsSetupSuccess"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"}}]}}]}.definitions]}.definitions]};var jn,Wn,Vn,Hn,$n,zn;function Gn(e,t,n){const{id:i,title:a,callId:o,crossClientScenarioName:r,subtitle:s,image:l,time:d,actions:c,type:u,primaryAction:m,header:g,toastType:p,ringtoneAssetUrl:v}=e,h=parseInt(d,10),f=g?{alt:g.subtitle,src:g.defaultImageDataUrl}:void 0;return{command:{correlation:{source:Ot.D.Notifications,id:n},stateTransition:L.suD.new,visibilityState:L.feW.show},entityOptions:{buttons:null==c?void 0:c.map((e=>function(e,t,n,i,a){const{actionType:o,label:r,icon:s}=t;return Object.assign(Object.assign({},s&&{image:{alt:r,src:s}}),{targetEntity:{action:Hn.mutate,dataOptions:{actionType:o,toastId:e,toastType:a},id:e,type:Wn.calls},text:r,preferImageOnly:n.get(K.J.Calling).forceTextOnT2Notifications?void 0:!!s,style:Qn(o,i)})}(i,e,t,u,p))),callId:o,crossClientScenarioName:r,isIncomingCall:qn(u),mainImage:{alt:a,src:l},ringtone:v,targetEntity:{action:Hn.mutate,dataOptions:{actionType:m,toastId:i,toastType:p},id:i,type:Wn.calls},text:s,time:new Date(h),title:a,headerImage:f,headerTitle:null==g?void 0:g.title,headerSubtitle:null==g?void 0:g.subtitle}}}!function(e){e.toastFromWeb="toastFromWeb",e.toastFromHost="toastFromHost"}(jn||(jn={})),function(e){e.calls="calls",e.chats="chats",e.toasts="toasts",e.signout="signout",e.extensions="extensions",e.reminders="reminders",e.channels="channels",e.activity="activity",e.campaignnotifications="campaignnotifications",e.communities="communities"}(Wn||(Wn={})),function(e){e.hide="hide",e.show="show"}(Vn||(Vn={})),function(e){e.mutate="mutate",e.view="view",e.list="list"}(Hn||(Hn={})),function(e){e.success="success",e.critical="critical"}($n||($n={})),function(e){e.start="start",e.quit="quit",e.restart="restart"}(zn||(zn={}));const qn=e=>e!==L.k$E.MeetingWentLive&&e!==L.k$E.CallAnsweredElsewhere;function Qn(e,t){if(t!==L.k$E.Meeting)switch(e){case"ReplyIncomingCall":return;case"RejectIncomingCall":return $n.critical;default:return $n.success}}function Jn(e,t,n,i){const{id:a,coordsType:o,windowingMode:r,linkedContent:s}=n,{action:{visibility:l}}=t,{source:d,timeStamp:m}=i,g=function(e){return e===L.KRy.Show?c.fe.show:c.fe.hide}(l),p=function(e){return e===L.lCV.SingleWindow?c.su.flush:c.su.new}(r),v=s&&function(e){if(!e.id)return;return{id:e.id,type:u.p.chats}}(s);return{entity:{id:a,type:function(e){switch(e){case L.cAL.RigelGallery:return u.p.callsgallery;case L.cAL.RigelContent:return u.p.callscontent;case L.cAL.RigelGalleryAndContent:return u.p.callsgalleryandcontent;default:return u.p.calls}}(o),action:u.u.view,linkedEntity:v},command:{visibilityState:g,stateTransition:p,correlation:{id:e,startTimestamp:m||void 0,source:`${Ot.D.CallingAppEvent}::${d.name}::${d.description}`}}}}function Yn(e,t){switch(e){case L.KRy.Show:return c.fe.show;case L.KRy.Hide:return c.fe.hide;default:return t.warn(`${e} cannot be converted to visibility state, defaulting to hide`),c.fe.hide}}var Kn,Zn=n(845479);!function(e){e.Calling="Calling",e.Notifications="Notifications",e.Devices="Devices",e.PremiumBenefits="PremiumBenefits",e.Privacy="Privacy"}(Kn||(Kn={}));const Xn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},ei={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingPriorityContactsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldFetchFromNetwork"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"priorityContacts"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shouldFetchFromNetwork"},value:{kind:"Variable",name:{kind:"Name",value:"shouldFetchFromNetwork"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"jobTitle"}}]}}]}}]},ti={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};const ni=new class{constructor(){this.deeplinkEntitySet=!1,this.callingAppEventsSubscribed=!1,this.unlockDeeplinkEntity=()=>{const e=this.deeplinkEntityId;return this.deeplinkEntityId=void 0,this.resolvePromise&&this.resolvePromise(),e},this.lockDeeplinkEntity=e=>{this.deeplinkEntitySet||(this.initializingPromise=new Promise((e=>{this.resolvePromise=()=>{e()}})),this.deeplinkEntityId=e,this.deeplinkEntitySet=!0)},this.getDeeplinkEntityLocked=()=>this.deeplinkEntitySet,this.getDeeplinkReady=()=>this.initializingPromise,this.getCallingAppEventsSubscribed=()=>this.callingAppEventsSubscribed,this.setCallingAppEventsSubscribed=e=>{this.callingAppEventsSubscribed=e}}},ii={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"resolveCallingAppEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventResolution"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolveCallingAppEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingAppEventResolution"},value:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}}}]}]}}]};function ai(e,t,n){const{eventId:i,resolution:a,context:o}=e,{source:r}=o;return n.log(`[resolveCallingAppEvent] Resolving calling app event [eventId=${i}, source.name=${r.name}, source.description=${r.description}]`),t.mutate({mutation:ii,variables:{callingAppEventResolution:{eventId:i,resolution:a,context:o}},fetchPolicy:"no-cache"})}var oi,ri=n(455048),si=n(296546);!function(e){e[e.SingleAccount=0]="SingleAccount",e[e.MultipleAccounts=1]="MultipleAccounts"}(oi||(oi={}));var li=n(798703);function di(e,t,n){if(e&&t)return t.getAccountMode()===oi.MultipleAccounts?(n.log(ri.f.ReturningUserKeyForToastCollection),(0,li.b)(e)):void n.error(ri.f.CollectionIdUndefined);n.error(ri.f.NoAutheticatedUserOrTrackingService)}function ci(e,t,n){const{id:i,name:a,dialogActions:o,dialogStrings:r}=t,{action:{visibility:s}}=e,{timeStamp:l}=n;let d;if(s===L.KRy.Show)d=c.fe.show;else{if(s!==L.KRy.Hide)return;d=c.fe.hide}const m={visibilityState:d,stateTransition:c.su.extend,correlation:{id:i,startTimestamp:l||void 0,source:a}},g=function(e){switch(e){case L.WBC.WindowingError:return u.p.windowingerrordialog;case L.WBC.CallingRestartRecomendedError:return u.p.restartrecomendeddialog;case L.WBC.Alert:return u.p.callingalertdialog;case L.WBC.CallingUnparkCall:return u.p.unparkcalldialog;case L.WBC.CallingConfirm:return u.p.callingconfirmdialog;case L.WBC.OptionsSettings:return u.p.optionssettingsdialog;case L.WBC.PrejoinOverlay:return u.p.prejoinoverlaydialog;case L.WBC.UserMedia:return u.p.usermediadialog;default:return}}(a);if(!g)return;const p={dialogActions:o,dialogStrings:r};return{entity:{id:i,type:g,action:u.u.create},entityOptions:p,command:m}}const ui={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingTriggerDialogActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dialogId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DialogAction"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerDialogAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"dialogId"},value:{kind:"Variable",name:{kind:"Name",value:"dialogId"}}},{kind:"Argument",name:{kind:"Name",value:"actionName"},value:{kind:"Variable",name:{kind:"Name",value:"actionName"}}}]}]}}]};function mi(e,t,n){const{id:i,bannerScenario:a,bannerActions:o}=t,{action:{visibility:r}}=e,{timeStamp:s}=n,l=function(e){let t;if(e===L.KRy.Show)t=c.fe.show;else{if(e!==L.KRy.Hide)return;t=c.fe.hide}return t}(r);if(void 0===l)return;const d={visibilityState:l,stateTransition:c.su.extend,correlation:{id:i,startTimestamp:s||void 0,source:a}},m=function(e){switch(e){case L.XDy.EndpointTransfer:return u.p.callingbannernotification;default:return}}(a),g=function(e){let t;e===c.fe.show&&(t=u.u.join);e===c.fe.hide&&(t=u.u.delete);return t}(l);return m&&g?{bannerPrimaryActionEntity:{id:i,type:m,action:g},entityOptions:{bannerActions:o},command:d,bannerDismissCommandEntity:{id:i,type:u.p.callingbannernotification,action:u.u.delete}}:void 0}function gi(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const{eventId:i,resolution:a,context:o}=e;yield ai({eventId:i,resolution:a,context:o},t,n)}catch(e){n.error(a,`error: [errorName=${e.name}, errorMessage=${e.message}]]`)}}))}function pi(e,t,n,i,a){let o={success:{_:!0}};return i&&a&&(o={error:{name:i,message:a}}),{eventId:e,resolution:o,context:{source:{name:t,description:n}}}}const vi=(e,t,n,a,o,r,s,l)=>()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const d=n.newLogger("getSetupAppEventsJob"),{enableCallingAppEventSubscriptionTelemetry:c}=a.get(K.J.Calling);let u=!1;const m=(0,si.P)();let g;return c&&(g=o.newScenario(ft.RG.CallingAppEventsSubscribe)),ni.setCallingAppEventsSubscribed(!0),e.subscribe({query:Bn,fetchPolicy:"no-cache"}).map((({data:e})=>null==e?void 0:e.callingAppEvents)).subscribe({next:r=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let i;if(c&&(i=o.newScenario(ft.RG.CallingAppEventSubscriptionNext,{clientId:null==r?void 0:r.id})),!r)return d.error("[getSetupAppEventsInnerJob] Received undefined calling app event"),void(null==i||i.fail({reason:"undefined-calling-app-event"}));if("CallingAppSetupEvent"===r.event.__typename&&r.event.result&&"CallingAppEventsSetupSuccess"===r.event.result.__typename)return d.log("[getSetupAppEventsInnerJob] Successfully subscribed."),u=!0,m.resolve(),void(null==g||g.stop());const{context:p}=r,{source:v}=p;d.log(`[getSetupAppEventsInnerJob] Received calling app event [event.id=${r.id}][context.externalId=${p.externalId}][source.name=${v.name}][source.description=${v.description}]`);try{yield hi(s,r,a,e,t,n,o,l),null==i||i.stop()}catch(t){d.error(`Calling app event handler threw error. [error.name=${null==t?void 0:t.name}][error.message=${null==t?void 0:t.message}]`),null==i||i.fail({errorCode:t.name,message:t.message,reason:"job-subscription-next-error"}),ai({eventId:r.id,resolution:{error:{name:(null==t?void 0:t.errorCode)||De.jK.HandleCallingAppEventError,message:(null==t?void 0:t.errorMessage)||`Unhandled exception while handling calling app events in job [eventId=${r.id}]`}},context:{source:{name:L.BHj.CallingAppEventJobHandlerError,description:`Error handling event in app job setup calling app events [eventId=${r.id} error.errorCode=${null==t?void 0:t.errorCode}, error.message=${null==t?void 0:t.errorMessage}]`}}},e,d)}})),error:e=>{if(d.error(`[getSetupAppEventsInnerJob] Error in calling app events subscription [error.name=${null==e?void 0:e.name}][error.message=${null==e?void 0:e.message}]`),!u){const t=(0,Mn.Tr)(r,De.jK.SetupCallingAppEventsJobError,"",{},`[getSetupAppEventsInnerJob] error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}`);m.reject(t)}if(c){let t=o.findScenario(ft.RG.CallingAppEventsSubscribe);t||(t=o.newScenario(ft.RG.CallingAppEventsSubscribe)),t.fail({errorCode:null==e?void 0:e.name,message:null==e?void 0:e.message,reason:"app-job-subscription-error"})}},complete:()=>{if(c){o.newScenario(ft.RG.CallingAppEventsUnsubscribe).stop()}}}),m.promise})),hi=(e,t,n,a,o,r,s,l)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{id:d,event:m,context:g}=t;if(!("action"in m)||!("content"in m)){throw r.newLogger("appEventsHandler").error("[getSetupAppEventsInnerJob] Expected event of type CallingAppEvent, not CallingAppSetupEvent."),new Error("IncorrectCallingAppEventTypeError")}switch(m.content.__typename){case"CallingWindowingContent":!function(e,t,n,a,o,r,s,l){var d;(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingWindowingContentEvent"),{entity:c,command:u}=Jn(a,o,r,s),m=ni.unlockDeeplinkEntity();try{yield t.call.callById(c.id,{visibilityState:u.visibilityState,stateTransition:u.stateTransition,correlation:u.correlation},null===(d=null==c?void 0:c.linkedEntity)||void 0===d?void 0:d.id,c.type,m)}catch(e){const t=(null==e?void 0:e.name)||"unknown-windowing-commanding-error-name",o=(null==e?void 0:e.message)||"unknown-windowing-commanding-error-message";i.error(`[handleCallingWindowingContentEvent] Windowing commanding error [entity.id=${c.id}, errorName=${t}, errorMessage=${o}]`);try{yield ai({eventId:a,resolution:{error:{name:t,message:o}},context:{source:{name:L.BHj.WindowingCommandingTriggerError,description:`Error triggering windowing command [eventId=${a}, entity.id=${c.id}]`}}},n,i)}catch(e){i.error(`[handleCallingWindowingContentEvent] Error when reporting event "error" [eventId=${a}, entity.id=${c.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}return}const{enableCallingAppCommandResolvedHook:g}=l.get(K.J.Calling);if(!g){i.log(`[handleCallingWindowingContentEvent] Windowing commanding success [eventId=${a}, entity.id=${c.id}]`);try{yield ai({eventId:a,resolution:{success:{_:!0}},context:{source:{name:L.BHj.WindowingCommandingSuccess,description:`Windowing command resolved successfully [eventId=${a}, entity.id=${c.id}]`}}},n,i)}catch(e){i.error(`[handleCallingWindowingContentEvent] Error when reporting event "success" [entity.id=${c.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}}))}(r,o,a,d,m,m.content,g,n);break;case"CallingToChatContent":!function(e,t,n,a,o){var r;(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingToChatContentEvent"),{entity:s,command:l}=function(e,t,n,i){const a=t.id,{action:{visibility:o}}=e,{externalId:r,timeStamp:s}=i,l=Yn(o,n),d=t.messageId?{id:t.messageId,type:u.p.messages}:void 0;return{entity:{id:a,type:u.p.chats,action:u.u.view,linkedEntity:d},command:{visibilityState:l,stateTransition:c.su.new,correlation:{id:r||void 0,startTimestamp:s||void 0,source:Ot.D.CallingAppEvent}}}}(n,a,i,o);try{yield t.chat.chatById(s.id,{entityCommand:{visibilityState:l.visibilityState,stateTransition:l.stateTransition,correlation:l.correlation},entityOptions:{messageId:null===(r=s.linkedEntity)||void 0===r?void 0:r.id}})}catch(e){i.error(`[getSetupAppEventsInnerJob] Navigation to chat commanding error [entity.id: ${s.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}i.log(`[getSetupAppEventsInnerJob] Navigation to chat commanding success [entity.id: ${s.id}]`)}))}(r,o,m,m.content,g);break;case"CallingToChatListContent":!function(e,t,n,a){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingToChatListContentEvent"),{command:o}=function(e,t,n){const{action:{visibility:i}}=e,{externalId:a,timeStamp:o}=n,r=Yn(i,t);return{entity:{type:u.p.chats,action:u.u.view},command:{visibilityState:r,stateTransition:c.su.none,correlation:{id:a||void 0,startTimestamp:o||void 0,source:Ot.D.CallingAppEvent}}}}(n,i,a);try{yield t.chat.chatList({visibilityState:o.visibilityState,stateTransition:o.stateTransition,correlation:o.correlation})}catch(e){i.error(`[getSetupAppEventsInnerJob] Navigation to chat list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}i.log("[getSetupAppEventsInnerJob] Navigation to chat list commanding success")}))}(r,o,m,g);break;case"CallingToCallListContent":!function(e,t,n,a){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingToCallListContentEvent"),{command:o}=function(e,t,n){const{action:{visibility:i}}=e,{externalId:a,timeStamp:o}=n,r=Yn(i,t);return{entity:{type:u.p.callsmain,action:u.u.view},command:{visibilityState:r,stateTransition:c.su.none,correlation:{id:a||void 0,startTimestamp:o||void 0,source:Ot.D.CallingAppEvent}}}}(n,i,a);try{yield t.call.callList({visibilityState:o.visibilityState,stateTransition:o.stateTransition,correlation:o.correlation})}catch(e){i.error(`[getSetupAppEventsInnerJob] Navigation to call list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}i.log("[getSetupAppEventsInnerJob] Navigation to call list commanding success")}))}(r,o,m,g);break;case"CallingToSettingsPaneContent":!function(e,t,n){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingToSettingsPaneContentEvent"),a=function(e){const t=new Map([[Kn.Calling,Zn.Y.Calls],[Kn.Notifications,Zn.Y.Notifications],[Kn.Devices,Zn.Y.Devices],[Kn.PremiumBenefits,Zn.Y.Benefits],[Kn.Privacy,Zn.Y.Privacy]]);return{id:e.tabItemId?t.get(e.tabItemId):void 0,command:{stateTransition:c.su.flush,visibilityState:c.fe.show,correlation:{source:Ot.D.CallingAppEvent}}}}(n),{id:o,command:r}=a;try{yield t.settings.launchSection(o,r)}catch(e){i.error(`[getSetupAppEventsInnerJob] setting commanding error [entity.id: ${o}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(r,o,m.content);break;case"CallingBannerContent":!function(e,t,n,a,o,r,s,l){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingBannerContentEvent"),{enableCallingBannerContent:d}=l.get(K.J.Calling);if(!d)return;const c=mi(o,r,s);if(!c){i.error("[handleCallingBannerContentEvent] Banner commanding error - no command to fire, visibility state is undefined");const e="Unknown-banner-commanding-error-name",t=`Unhandled exception while handling calling app events in job, error in converting banner content to command, visibility state is undefined [eventId=${a}]`,o=L.BHj.BannerContentToCommandingConversionError,r=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to undefined commanding with [eventId=${a},`,s=pi(a,o,`Error converting banner content to commanding [eventId=${a}]`,e,t);return void(yield gi(s,n,i,r))}const{bannerPrimaryActionEntity:u,entityOptions:m,command:g,bannerDismissCommandEntity:p}=c,{action:{visibility:v}}=o;if(v===L.KRy.Show)try{yield t.shell.showBanner({id:r.id,text:r.text,intentLevel:r.intentLevel,action:{text:r.joinButtonText,command:{entity:u,entityOptions:m,command:g},dismissOnAction:r.dismissOnAction},dismissable:r.dismissable||void 0,dismissActionCommand:{entity:p,entityOptions:m,command:g},duration:r.duration,bannerScenario:r.bannerScenario,source:r.source});const e=L.BHj.ShowBannerSuccess,o=`Show banner command resolved successfully [eventId=${a}, entity.id=${u.id}]`,s=`[handleCallingBannerContentEvent] Error when reporting show banner event "success" with [eventId=${a}, entity.id=${u.id},`,l=pi(a,e,o);yield gi(l,n,i,s)}catch(e){i.error(`Error is displaying banner through shell.showBanner with [entity.id: ${u.id}, error.name: ${e.name}, error.message: ${e.message}]`);const t="Unknown-show-banner-error-name",o=`Unhandled exception while handling calling app events in job, failed to trigger shell.showBanner function, error in showing banner [eventId=${a}]`,r=L.BHj.ShowBannerError,s=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to failure of shell.showBanner with [eventId=${a},`,l=pi(a,r,`Error in showing banner through shell.showBanner [eventId=${a}]`,t,o);yield gi(l,n,i,s)}if(v===L.KRy.Hide)try{yield t.shell.dismissBanner(r.id,r.source),i.log(`[dismissBanner] Successfully hiding the banner with [bannerId: ${r.id}] when call is no longer active.`);const e=L.BHj.DismissBannerSuccess,o=`Dismiss banner command resolved successfully [eventId=${a}, entity.id=${p.id}]`,s=`[handleCallingBannerContentEvent] Error when reporting dismiss banner event "success" with [eventId=${a}, entity.id=${p.id},`,l=pi(a,e,o);yield gi(l,n,i,s)}catch(e){i.error(`Error in dismissing the banner when call is no longer active. entity.id: ${p.id}, entity.action: ${p.action}, error.name=${e.name}, error.message=${e.message}]`);const t="Unknown-dismiss-banner-error-name",o=`Unhandled exception while handling calling app events in job, failed to trigger shell.dimissBanner function, error in dismissing banner [eventId=${a}]`,r=L.BHj.DismissBannerError,s=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to failure of shell.dismissBanner with [eventId=${a},`,l=pi(a,r,`Error in dismissing banner through shell.dismissBanner [eventId=${a}]`,t,o);yield gi(l,n,i,s)}}))}(r,o,a,d,m,m.content,g,n);break;case"CallingDialogContent":!function(e,t,n,a,o,r,s){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingDialogContentEvent"),{id:l}=o,d=s.findScenarioByNameAndId(ft.RG.CallingDialogOpen,l);d||i.error(`[getSetupAppEventsInnerJob] Cannot find calling_dialog_open scenario [dialogId: ${l}]`),null==d||d.mark(ft.ck.CallingDialogCallingAppEventReceived);const u=ci(a,o,r);if(!u){const e="[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, command is undefined";return i.error(e),void(null==d||d.fail({errors:e,errorCode:"command-is-undefined"}))}const{entity:m,entityOptions:g,command:p}=u;if(!m.type){const e=`[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, entity type is undefined [entity.id: ${m.id}]`;return i.error(e),void(null==d||d.fail({errors:e,errorCode:"entity-type-is-undefined"}))}let v;null==d||d.mark(ft.ck.BeforeCallingDialogEntityCommandTriggered);try{v=yield n.call.openDialog(m,p,g)}catch(e){const t=`[getSetupAppEventsInnerJob] Dialog commanding error [entity.id: ${m.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`;return i.error(t),void(null==d||d.fail({errors:t,errorCode:"open-dialog-commanding-error"}))}null==d||d.mark(ft.ck.AfterCallingDialogEntityCommandTriggered);const h=v.subscribe({next:({containerState:e})=>{switch(e){case c.oq.Closed:t.mutate({mutation:ui,variables:{dialogId:o.id,actionName:L.Liy.PostClose}}),h.unsubscribe();break;case c.oq.Open:null==d||d.stop({reason:`Dialog container opened [dialogId: ${l}]`})}}});i.log(`[getSetupAppEventsInnerJob] Dialog commanding success [entity.id: ${m.id}]`),null==d||d.mark(ft.ck.SubscribedToDialogObservable)}))}(r,a,o,m,m.content,g,s);break;case"CallingNotificationContent":!function(e,t,n,a,o,r,s,l,d){var c;(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingNotificationContentEvent");let m;const g=(0,mt.v4)(),{enableIncomingCallCrossClientTelemetry:p}=r.get(K.J.Calling);p&&n.callId&&n.crossClientScenarioName&&(m=s.findScenarioByNameAndId(n.crossClientScenarioName,n.callId)),m&&(null==m?void 0:m.isHoisted)||(m=s.newScenario(ft.RG.CrossClientToastView),m.clientId=g,m.appendEventData({mainEntityType:u.p.calls}),null===(c=s.hoistScenarioToCore)||void 0===c||c.call(s,m));const v=Gn(n,r,g);yield Promise.all([ki(n,o,v,i,m),fi(n,o,v,i,m)]),v.entityOptions&&r.get(K.J.Notifications).enableToastCollections&&(v.entityOptions.collectionId=di(l,d,i));try{yield t.call.callNotification(v,n.id,g,a===L.KRy.Hide?L.KRy.Hide:L.KRy.Show)}catch(e){m.fail({errorCode:ri.f.SubscriptionFailed}),i.error(`[handleCallingNotificationContentEvent] Notification commanding error [[content.id: ${n.id}], entity.id: toasts , visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}m.mark(ft.ck.CrossClientEntityCommandTriggered),i.log(`[handleCallingNotificationContentEvent] Notification commanding success [content.id: ${n.id}][entity.id: toasts][visibility: ${a.toString()}]`)}))}(r,o,m.content,m.action.visibility,a,n,s,e,l)}}));function fi(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const r=yield function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield e.query({query:ei,fetchPolicy:"network-only"});return n?n.data.priorityContacts.map((e=>e.id)):(t.error("[handleCallingNotificationContentEvent] Failed to fetch priority contacts"),[])}catch(e){return t.error("[handleCallingNotificationContentEvent] Failed to fetch priority contacts"),[]}}))}(t,a);n.entityOptions.isUrgent=r.includes(e.userid),o.mark(ft.ck.PriorityContactsFetched)}catch(e){a.error(`[handleCallingNotificationContentEvent] Error when fetching priority contacts. Error: ${e}`)}}))}function yi(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield e.query({query:Xn,variables:{userId:t,displayName:n,profilePictureSize:"HR64x64"}});if(!i)return void a.error("[handleCallingNotificationContentEvent] Failed to generate avatar image url");const o=yield e.query({query:ti,variables:{url:i.data.msaUserProfilePicture}});return(null==o?void 0:o.data.toastImageAsDataUri)||void 0}catch(e){return void a.error("[handleCallingNotificationContentEvent] failed to fetch avatar image")}}))}function ki(e,t,n,a,o){var r,s,l,d,c,u;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{let i,m;e.userid&&(null===(r=n.entityOptions)||void 0===r?void 0:r.mainImage)?i=yi(t,e.userid,e.title,a):a.log("[handleCallingNotificationContentEvent] Primary avatar not fetched, user id or main image property is not present on the content."),(null===(s=e.header)||void 0===s?void 0:s.mri)&&(null===(l=n.entityOptions)||void 0===l?void 0:l.headerImage)&&(m=yi(t,e.header.mri,e.header.subtitle,a));const[g,p]=yield Promise.all([i,m]);g&&(n.entityOptions.mainImage={src:g,alt:null!==(d=e.title)&&void 0!==d?d:""},o.mark(ft.ck.CrossClientAvatarFetched)),p&&(n.entityOptions.headerImage={src:p,alt:null!==(u=null===(c=e.header)||void 0===c?void 0:c.subtitle)&&void 0!==u?u:""})}catch(e){a.error(`[handleCallingNotificationContentEvent] failed handle avatar fetches. Error: ${e}`)}}))}const Si={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingClientStateEvent"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"callingClientStateEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingClientStateEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"inCall"}},{kind:"Field",name:{kind:"Name",value:"isScreenSharing"}}]}}]},bi={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateClientStateVeryActive"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateClientStateSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateClientStateVeryActive"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isVeryActive"},value:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}]}]}}]};var Ci=n(604781);const wi={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingSetCallStatePresenceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"endpointPresenceRequest"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EndpointPresenceRequest"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setCallStatePresence"},arguments:[{kind:"Argument",name:{kind:"Name",value:"endpointPresenceRequest"},value:{kind:"Variable",name:{kind:"Name",value:"endpointPresenceRequest"}}}]}]}}]};var Ni=n(258705);const Ti=(e,t)=>()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=t.newLogger("getCallingClientEventsJob");e.subscribe({query:Si,fetchPolicy:"no-cache"}).subscribe((({data:a,errors:o})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(o){const e=o.map((e=>e.message));n.error(`handleCallingClientStateEvent: Error receiving callingClientStateEvent [Errors: ${e.join()}]`)}else a&&(n.log(`handleCallingClientStateEvent: Processing callingClientStateEvent [Received: ${(0,Ci.u4)(a)}]`),function(e,t,n){(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("handleCallingClientStateEvent");i.log(`Event received: ${(0,Ci.u4)(t)}`);try{yield n.mutate({mutation:bi,variables:{isVeryActive:t.inCall||t.isScreenSharing,source:L.HRk.Calling}})}catch(e){i.error(`mutation updateClientStateVeryActiveDocument error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(t,a.callingClientStateEvent,e),a.callingClientStateEvent.isScreenSharing?(Ii(t,{availability:L.a8y.DoNotDisturb,activity:L.cS$.Presenting},e),Ei(L.rsL.ScreenSharing,e)):a.callingClientStateEvent.inCall?(Ii(t,{availability:L.a8y.Busy,activity:L.cS$.InACall},e),Ei(L.rsL.InCall,e)):Ei(L.rsL.None,e))}))))}));function Ii(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("setCallStatePresence");i.log(`Call state presence received: ${(0,Ci.u4)(t)}`);try{yield n.mutate({mutation:wi,variables:{endpointPresenceRequest:t}})}catch(e){i.error(`mutation AppsCallingSetCallStatePresenceMutationDocument error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}function Ei(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield t.mutate({mutation:Ni.b,variables:{newState:e},fetchPolicy:"no-cache"})}))}const Ai=(e,t,n,i,a,o,r,s)=>{const{enableCallingStackInitialization:l,enableCallingClientEvents:d,enableCallingAppEvents:c}=a.get(K.J.Calling),u=[];if(l){const t=_i(i,ft.RG.StandupCallingAppJob,o);u.push(Ln(e,n,o,i,a)),t.mark(ft.ck.JobAdded),t.stop()}return c&&u.push(((e,t,n,i,a,o,r,s)=>({id:"setup-calling-app-events",runOncePerId:!0,job:vi(e,t,n,i,a,o,r,s)}))(e,t,n,a,i,o,s,r)),d&&u.push(((e,t)=>({id:"calling-client-events",runOncePerId:!0,job:Ti(e,t)}))(e,n)),u},_i=(e,t,n)=>{let i=e.findScenario(t);return i||(i=e.newScenario(t)),i.mark(n),i},Di=({context:{authenticationUser:e,client:t,coreSettings:n,entityCommanding:i,loggerFactory:a,scenarioFactory:o,userTrackingService:r}})=>Ai(t,i,a,o,n,ft.ck.OnAppPreWarm,r,e),Fi=({context:{client:e,coreSettings:t,entityCommanding:n,loggerFactory:i,scenarioFactory:a}})=>Ai(e,n,i,a,t,ft.ck.OnAppPreInit),Mi=e=>"tel:"===e,Ri={filter:({protocol:e})=>Mi(e),execute:({deeplinkUrl:{pathname:e,protocol:t},context:{coreSettings:n,loggerFactory:a}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,o;const r=a.newLogger("[Calling][OnBeforeDeeplinkParsed][CallingProtocol]"),{enableCallWithUsersDeeplink:s}=n.get(K.J.Calling);if(!s||!Mi(t)){const e=`enableCallWithUsersDeeplink=${s} or protocol=${t} is not supported`;throw null===(i=r.warnToTelemetry)||void 0===i||i.call(r,e,"calling_protocol_deeplink_condition",void 0,!0),new Error(e)}return null===(o=r.infoToTelemetry)||void 0===o||o.call(r,`Returning calling protocol dialog intent for protocol=${t}`,"calling_protocol_deeplink_condition",void 0,!0),{entityCommand:{entity:{type:u.p.callingprotocoldeeplinkdialog,action:u.u.create},command:{visibilityState:c.fe.show,stateTransition:c.su.extend,layoutMode:c.lO.standard},entityOptions:{protocol:"tel",target:e}},metadata:{allowAnonymous:!1}}}))};var Pi;!function(e){e.EmptyDeeplinkUrl="empty-deeplink-url-received",e.MeetingCodeParse="meeting-code-parse-error",e.LegacyCoordinatesParse="legacy-coordinates-parse-error",e.EmptyContext="empty-context-received",e.EmptyParsedUrlParams="empty-parsed-url-params",e.None="no-entity-command-expected",e.PresentDeepLinkT2Disabled="present-deeplink-t2-disabled",e.EmptySearch="empty-search-url"}(Pi||(Pi={}));const Oi={visibilityState:c.fe.show,stateTransition:c.su.new,layoutMode:c.lO.focus},xi=(e,t)=>{if("null"!==e)return e;const n=t.get("fqdn");return n?`https://${n}`:void 0},Li={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingHandlePresentDeeplinkMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ver"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pptContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"handlePresentDeepLink"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ver"},value:{kind:"Variable",name:{kind:"Name",value:"ver"}}},{kind:"Argument",name:{kind:"Name",value:"deeplinkId"},value:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}}},{kind:"Argument",name:{kind:"Name",value:"pptContext"},value:{kind:"Variable",name:{kind:"Name",value:"pptContext"}}}]}]}}]},Ui=[Ri,{filter:e=>{const t=e.pathname.includes("/l/meetup-join"),n=new URLSearchParams(e.search).get("context");if(!n)return!1;const{IsBroadcastMeeting:i}=JSON.parse(n);return t&&!i},execute:({deeplinkUrl:{pathname:e,search:t,origin:n},context:{coreSettings:i,loggerFactory:a}})=>{const o=a.newLogger("[Calling][onBeforeDeeplinkParsed][/l/meetup-join]"),{allowAnonymousMeetingJoin:r}=i.get(K.J.Calling);if(o.log(`Parsing pathname: ${e}, search: ${t}, allowAnonymousMeetingJoin: ${r}`),!e)return Promise.reject({message:Pi.EmptyDeeplinkUrl});const s=e.split(/[/?&]/),l=s.indexOf("meetup-join")+1,d=s[l],c=s[l+1],m=new URLSearchParams(t);m.set("anon","true");const g=m.get("context");if(!g)return Promise.reject({message:Pi.EmptyContext});const{Tid:p,Oid:v,MessageId:h,prid:f,isPublic:y}=JSON.parse(g);if(!(d&&c&&p&&v)){const e=`${d?"":"empty-conversationId"} ${c?"":"empty-rootMessageId"} ${p?"":"empty-tenantId"} ${v?"":"empty-organizerId"}`;return Promise.reject({message:Pi.LegacyCoordinatesParse,reason:e})}let k;const S=xi(n,m);S&&(k=`${S}/_#${e}?${m.toString()}`);const b={joinType:L.cku.Legacy,conversationId:d,messageId:h||c,rootMessageId:c,isChannel:"0"!==c,isAdhoc:!1,tenantId:p,organizerId:v,registration:f?{participantRegistrationId:f,isPublicEvent:y||!1}:null,meetingCloud:m.get("fqdn")||(0,et.uO)(n)};return o.log(`Resolving ${JSON.stringify(b)}`),Promise.resolve({entityCommand:{entity:{type:u.p.callingdeeplink,action:u.u.join,id:`${d}/${c}`},command:Oi,entityOptions:{deeplinkUrl:e,coordinates:b,directMeetingLink:k,deeplinkId:m.get("deeplinkId")}},metadata:{allowAnonymous:r||!1,tenantId:p}})}},{filter:"/meet",execute:({deeplinkUrl:{pathname:e,search:t,origin:n},context:{coreSettings:i,loggerFactory:a}})=>{const o=a.newLogger("[Calling][onBeforeDeeplinkParsed][/meet]"),{allowAnonymousMeetingJoin:r,defaultAnonTenantId:s}=i.get(K.J.Calling),{enableXboxWatchparties:l}=i.get(K.J.WindowsSignatureExperiences);if(o.log(`Parsing pathname: ${e}, search: ${t}, allowAnonymousMeetingJoin: ${r}`),!e)return Promise.reject({message:Pi.EmptyDeeplinkUrl});const d=e.split(/[/?&]/),c=d.indexOf("meet"),m=d[c+1];if(!m||-1===c)return Promise.reject({message:Pi.MeetingCodeParse});const g=new URLSearchParams(t);let p,v;g.set("anon","true");const h=xi(n,g);return h&&(p=`${h}/_#${e}?${g.toString()}`,v=`${h}${e}${t}`),o.log(`Resolving ${m}`),Promise.resolve({entityCommand:{entity:{type:u.p.callingdeeplink,action:u.u.join,id:m},command:Oi,entityOptions:{deeplinkUrl:e,coordinates:{joinType:L.cku.MeetingData,meetingData:{meetingCode:m,passcode:g.get("p"),meetingUrl:v},isAdhoc:!1},directMeetingLink:p,deeplinkId:g.get("deeplinkId"),isWatchParty:"true"===g.get("isWatchParty")&&l}},metadata:{allowAnonymous:r||!1,tenantId:s||void 0}})}},{filter:"/l/present",execute:({deeplinkUrl:{search:e},context:{coreSettings:t,loggerFactory:n,client:a}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const{enablePresentDeepLinkForMTMA:o}=t.get(K.J.Calling),r=n.newLogger("[Calling][onBeforeDeeplinkParsed][/present]");if(r.log(`EnablePresentToTeamsT2: ${o}. Parsing search length: ${e.length}`),!o)return Promise.reject({message:Pi.PresentDeepLinkT2Disabled});if(""===e)return Promise.reject({message:Pi.EmptySearch});const s=new URLSearchParams(e),l=s.get("ver"),d=s.get("deeplinkId"),m=s.get("pptContext");if(r.log(`Parsed params ver: ${l}, deeplinkId: ${d}`),!l||!d||!m)return Promise.reject({message:Pi.EmptyParsedUrlParams});let g;try{g=yield a.mutate({mutation:Li,variables:{ver:l,deeplinkId:d,pptContext:m}})}catch(e){throw null===(i=r.errorToTelemetry)||void 0===i||i.call(r,e.message,"cmd_meetings_pptsharing_handle_present_deeplink_mutation_error"),new Error(e.message)}return g&&g.data&&!g.data.handlePresentDeepLink?Promise.resolve({entityCommand:{entity:{type:u.p.presentdeeplinknomeetingcontextdialog,action:u.u.create},command:{visibilityState:c.fe.show,stateTransition:c.su.extend,layoutMode:c.lO.standard}},metadata:{allowAnonymous:!1}}):void 0}))}],Bi={shouldAddEntitiesToWindowHistory:e=>{var t,n;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.callingdeeplink&&(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==u.p.calls},shouldRestoreClientToEntities:e=>{var t,n;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.callingdeeplink&&(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==u.p.calls}},ji={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case un.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:vn(i)})}return Promise.resolve(void 0)}},Wi=({appRenderMode:e,coreSettings:t})=>{const n=new Dt.H,{criticalPhaseTimeout:i}=t.get(K.J.Calling);return e!==s.S.Main||n.registerAppPhase({phase:Ft.nh.CRITICAL,signals:[Ft.GZ.CALLING_SCREEN_RENDERED],timeout:i||9e4}),n.appPhases},Vi=e=>{if(Hi(e))return $i(e)?{subNavEntity:zi(e),headerEntity:Gi(e),startEntity:qi(e),mainEntity:Qi(e),endEntity:Ji(e)}:null},Hi=({layoutMode:e,entity:t,contextEntity:n})=>{const{action:i=null,type:a}=Object.assign({},t),o=[c.lO.focus,c.lO.standard].includes(e),r=[u.p.callingdeeplink,u.p.calls,u.p.callsmonitor,u.p.meetings,u.p.meetingroomallinonecall].includes(a),s=i&&[u.u.create,u.u.default,u.u.list,u.u.view,u.u.join].includes(i)||a===u.p.callingdeeplink&&!i&&!!n;return!!(o&&r&&s)},$i=({contextEntity:e})=>!e||![u.p.identity,u.p.tflfre].includes(e.type),zi=()=>null,Gi=({entity:e,contextEntity:t})=>e.type===u.p.callingdeeplink?t||null:e,qi=()=>null,Qi=({entity:e,contextEntity:t})=>e.type===u.p.callingdeeplink&&(null==t?void 0:t.type)===u.p.calls?t:e,Ji=({contextEntity:e})=>e&&e.action&&(e.type===u.p.chats||e.type===u.p.devicesettings||e.type===u.p.meetings||e.type===u.p.extensions||e.type===u.p.transcript||e.type===u.p.meetingdetails||e.type===u.p.roster||e.type===u.p.accessibilitypanel)?e:null,Yi=({entity:e,coreSettings:t})=>{var n;const{enableLightThemeSupport:i=!1}=null!==(n=null==t?void 0:t.get(K.J.Calling))&&void 0!==n?n:{};return(null==e?void 0:e.type)===u.p.callsmonitor?{[L.tF7.mainEntity]:{[s.S.Main]:{doesHeaderOverlapMain:!1,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!i,UNSAFE_enablePptProvider:!0}},[L.tF7.headerEntity]:{[s.S.HorizontalBar]:{slotHeightOverrides:"5.4rem",doesHeaderOverlapMain:!1,isBackgroundTransparent:!0}}}:{[L.tF7.mainEntity]:{[s.S.Main]:{doesHeaderOverlapMain:!1,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!i,UNSAFE_enablePptProvider:!0}},[L.tF7.headerEntity]:{[s.S.HorizontalBar]:{slotHeightOverrides:"auto",doesHeaderOverlapMain:!1,isBackgroundTransparent:!1}},[L.tF7.endEntity]:{[s.S.Rail]:{doesHeaderOverlapMain:(null==e?void 0:e.type)===u.p.videobackgrounds,isBackgroundTransparent:!!e&&Ki.includes(e.type)}}}},Ki=[u.p.videobackgrounds,u.p.videoeffectsandavatar,u.p.videoeffectscustomization,u.p.videoeffectsmoreview],Zi={id:"com.microsoft.teams.calling",name:"Calls",supportedEntities:[u.p.callingdeeplink,u.p.callingprotocoldeeplinkdialog,u.p.calls,u.p.callscontent,u.p.callsgallery,u.p.callsgalleryandcontent,u.p.meetingroomallinonecall,u.p.callsmonitor,u.p.cameraeffects,u.p.contentcamerasetup,u.p.callingalertdialog,u.p.callingbannernotification,u.p.callingconfirmdialog,u.p.unparkcalldialog,u.p.usermediadialog,u.p.devicesettings,u.p.notes,u.p.mediastreams,u.p.meetingdetails,u.p.meetings,u.p.meetingstream,u.p.roster,u.p.pstncallmedialog,u.p.videobackgrounds,u.p.broadcastqna,u.p.transcript,u.p.shareMeetingInfo,u.p.stagecontent,u.p.breakoutroomspanel,u.p.invisionwhiteboard,u.p.videoeffectscustomization,u.p.videoeffectsmoreview,u.p.videoeffectsandavatar,u.p.windowingerrordialog,u.p.restartrecomendeddialog,u.p.stagingroomstartmeetingconfirmationdialog,u.p.meshavatar,u.p.yammerqna,u.p.roomremote,u.p.accessibilitypanel,u.p.closedcaptionssettings,u.p.meetingcollaboration,u.p.presentdeeplinknomeetingcontextdialog],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Modal,s.S.Rail],windowFeatures:{otherEntityTypes:{minWidth:800,width:800,minHeight:670,height:600},[u.p.callsmonitor]:{height:247,width:304,additionalFeatures:{alwaysOnTop:"true",resizable:"false",fullscreenable:"false",maximizable:"false",closable:"false",hideWindowControl:"true",frame:"false",contentprotection:"true",excludeWindowFromScreenSharing:"true"}}},shouldErrorOnEntityCommandTimeout:!0},Xi={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"triggerCallingToastAction"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"notificationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerCallingToastAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"notificationId"},value:{kind:"Variable",name:{kind:"Name",value:"notificationId"}}},{kind:"Argument",name:{kind:"Name",value:"actionType"},value:{kind:"Variable",name:{kind:"Name",value:"actionType"}}}]}]}}]},ea={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"fireCallingIntent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var ta=n(11574),na=n(410061),ia=n(303493);const aa={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingTriggerBannerActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bannerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BannerAction"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerBannerAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bannerId"},value:{kind:"Variable",name:{kind:"Name",value:"bannerId"}}},{kind:"Argument",name:{kind:"Name",value:"actionName"},value:{kind:"Variable",name:{kind:"Name",value:"actionName"}}}]}]}}]},oa=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:n,action:i},dataOptions:a},requestContext:o,requestContext:{client:r}}=e,s=o.loggerFactory.newLogger("CallingOnBeforeCommandHandled");if(da(n,i))return ca(o,t,s);if(((e,t)=>e===u.p.callingbannernotification&&t===u.u.join)(n,i))return((e,t)=>{const n=e.loggerFactory.newLogger("CallingBannerCommandHandler[handleBannerPrimaryAction]");if(!t.entityOptions){const e=`Error when handling banner's primary action, join click since entity options is undefined for entityId=${t.entity.id}, entityType=${t.entity.type} and entityAction=${t.entity.action}`;return n.error(e),Promise.reject(new Error(e))}return e.client.mutate({mutation:aa,variables:{bannerId:t.entity.id,actionName:L.sRD.PrimaryAction}})})(o,t);if(((e,t)=>e===u.p.callingbannernotification&&t===u.u.delete)(n,i))return((e,t)=>{const n=e.loggerFactory.newLogger("CallingBannerCommandHandler[handleBannerDismiss]");if(!t.entityOptions){const e=`Error when handling banner dismiss since entity options is undefined for entityId=${t.entity.id}, entityType=${t.entity.type} and entityAction=${t.entity.action}`;return n.error(e),Promise.reject(new Error(e))}return e.client.mutate({mutation:aa,variables:{bannerId:t.entity.id,actionName:L.sRD.DismissAction}})})(o,t);if(la(n,i)){const{coordinates:e}=t.entityOptions,n=ni.getDeeplinkEntityLocked();if(n||!n&&ni.getCallingAppEventsSubscribed())return ni.getDeeplinkReady()&&(s.log("[handleDeeplink] awaiting getDeeplinkReady"),yield ni.getDeeplinkReady()),ua(o,t,s);const i=(0,na.N6)(e)?`${e.conversationId}/${e.rootMessageId}`:e.meetingData.meetingCode||(e.meetingData.meetingUrl?(e=>{const t=e.split(/[/?&]/);return t[t.indexOf("meet")+1]})(e.meetingData.meetingUrl):void 0);if(!i){const e="[handleDeeplink] Deeplink entity cannot be locked because lockId is undefined";return s.error(e),Promise.reject(e)}s.log("[handleDeeplink] lockDeeplinkEntity"),ni.lockDeeplinkEntity(i)}if(!a)return Promise.resolve(t);if(ra(n,i,a)){const e=a,t=e.toastId,n=e.actionType;return n?r.mutate({mutation:Xi,variables:{notificationId:t,actionType:n}}).then((()=>{})).catch((()=>Promise.reject(ri.f.CallingToastActionMutationFailed))):Promise.reject(ri.f.CallsActionTypeToNotificationActionFailed)}return Promise.resolve(t)})),ra=(e,t,n)=>!!sa(n)&&(!!n.toastId&&e===u.p.calls&&t===u.u.mutate&&"Unknown"!==n.actionType),sa=e=>void 0!==e.toastId,la=(e,t)=>e===u.p.callingdeeplink&&t===u.u.join,da=(e,t)=>e===u.p.meetings&&t===u.u.join,ca=(e,t,n)=>{if(!t.entityOptions||!t.entityOptions.callingIntent){const e=`entityOptions must be of type IMeetingJoinOptions. entity.id=${t.entity.id} - correlationId=${t.command.correlation.id} - source=${t.command.correlation.source}`;return n.error(e),Promise.reject(e)}const{callingIntent:i}=t.entityOptions;return n.log("[handleMeetingJoin] triggering fireCallingIntent mutation"),e.client.mutate({mutation:ea,variables:{callingIntent:i}}).then((()=>{n.log("[handleMeetingJoin] fireCallingIntent succeeded")})).catch((e=>{var t;return null===(t=n.errorToTelemetry)||void 0===t||t.call(n,`failed to fireCallingintent with ${(0,ta.A)(e)}`,"cmd_meeting_before_join",void 0,!0),Promise.reject(e)}))},ua=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!t.entityOptions){const e="[handleDeeplink] No entity options";return n.error(e),Promise.reject(e)}const i=t.entityOptions,{coordinates:a,deeplinkId:o,isWatchParty:r}=i;let s;return s=r?(0,ia.W5)(o):(0,ia.sM)(a,o),n.log("[handleDeeplink] triggering fireCallingIntent mutation"),e.client.mutate({mutation:ea,variables:{callingIntent:s}}).then((()=>{n.log("[handleDeeplink] fireCallingIntent succeeded")})).catch((e=>{var t;return null===(t=n.errorToTelemetry)||void 0===t||t.call(n,`failed to fireCallingintent with ${(0,ta.A)(e)}`,"cmd_meeting_before_join",void 0,!0),Promise.reject(e)}))}));var ma,ga;!function(e){e[e.Canceled=0]="Canceled",e[e.Failure=1]="Failure",e[e.Incomplete=2]="Incomplete",e[e.Success=3]="Success"}(ma||(ma={})),function(e){e.Success="Success",e.Failure="Failure"}(ga||(ga={}));const pa=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:{entity:{type:t,action:n},command:{visibilityState:i}},requestContext:{coreSettings:a,loggerFactory:o}}=e,r=o.newLogger("CallingApp[onCommandResult]"),{enableCallingAppCommandResolvedHook:s}=a.get(K.J.Calling);if(s)return t===u.p.calls&&n===u.u.view&&(r.log(`[onCommandResult] Windowing command with visibilityState: ${i}`),i===c.fe.show)?va(e):void 0})),va=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:{entity:{id:t},command:{correlation:{id:n}}},result:i,requestContext:{client:a,loggerFactory:o,scenarioFactory:r,error:s}}=e,l=o.newLogger("CallingApp[onCommandResult]");let d,c;if(i===ma.Failure){d=ga.Failure;const e=t?r.findScenarioByNameAndId(ft.RG.CallingWindowPopoutIntent,t):void 0;null==e||e.mark("OnAfterCommandResolved"),null==e||e.appendEventData({errorCode:(null==s?void 0:s.errorCode)||De.jK.CallingCallsViewCommandError,message:(null==s?void 0:s.errorMessage)||"[onCommandResult] Window Rendering command for a call resulted in Failure or Incomplete.",context:"CallingApp"}),c=ha(d,n,t,s)}else d=ga.Success,c=ha(d,n,t);try{yield ai(c,a,l)}catch(s){throw l.error(`[handleCallingWindowingContentEvent] Error when reporting event "${d}" [entity.id=${t}, error.name=${s.name}, error.message=${s.message}]`),new Error(`onCommandResult[error.name=${s.name},error.message=${s.message}]::resolveCallingAppEvent::${d}`)}})),ha=(e,t,n,i)=>e===ga.Success?{eventId:t,resolution:{success:{_:!0}},context:{source:{name:L.BHj.WindowingCommandingSuccess,description:`Windowing command resolved successfully [eventId=${t}, entity.id=${n}]`}}}:{eventId:t,resolution:{error:{name:(null==i?void 0:i.errorCode)||De.jK.CallingCallsViewCommandError,message:(null==i?void 0:i.errorMessage)||`[onCommandResult] calls-view command resolved with an error [eventId=${t}][entity.id=${n}]`}},context:{source:{name:L.BHj.WindowingCommandingTriggerError,description:`Error processing windowing command [eventId=${t}, entity.id=${n}, error.errorCode=${null==i?void 0:i.errorCode}, error.message=${null==i?void 0:i.errorMessage}]`}}};var fa=n(493401);const ya=e=>{const{entity:{type:t,action:n}}=e;if(t===u.p.calls&&n===u.u.view)return ft.RG.CallingEntityCommandCallsView},ka=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(61130),n.e(79058),n.e(83505),n.e(96271),n.e(7983),n.e(1839),n.e(14085),n.e(19570),n.e(14768),n.e(4759),n.e(88450),n.e(94864),n.e(58278),n.e(17134),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(94333),n.e(33876),n.e(98935),n.e(2205),n.e(12724),n.e(89962),n.e(48753),n.e(97087),n.e(79850),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(2116),n.e(42256),n.e(64891),n.e(72780),n.e(34814),n.e(26891),n.e(97191),n.e(43806),n.e(6482),n.e(11965),n.e(50468),n.e(9699),n.e(75988),n.e(30585),n.e(43164),n.e(69816),n.e(86034),n.e(4788),n.e(40705),n.e(25143),n.e(55867),n.e(88972),n.e(65162),n.e(35160),n.e(47844),n.e(10591),n.e(70971),n.e(54134),n.e(54724),n.e(55374),n.e(23594),n.e(70326)]).then(n.bind(n,751632)),Sa=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(61130),n.e(79058),n.e(83505),n.e(96271),n.e(7983),n.e(1839),n.e(14085),n.e(19570),n.e(14768),n.e(4759),n.e(88450),n.e(94864),n.e(58278),n.e(17134),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(94333),n.e(33876),n.e(98935),n.e(2205),n.e(12724),n.e(89962),n.e(48753),n.e(97087),n.e(79850),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(2116),n.e(42256),n.e(64891),n.e(72780),n.e(34814),n.e(26891),n.e(97191),n.e(43806),n.e(6482),n.e(11965),n.e(50468),n.e(9699),n.e(75988),n.e(30585),n.e(43164),n.e(69816),n.e(86034),n.e(4788),n.e(40705),n.e(25143),n.e(55867),n.e(88972),n.e(65162),n.e(35160),n.e(47844),n.e(10591),n.e(70971),n.e(54134),n.e(54724),n.e(55374),n.e(23594),n.e(70326)]).then(n.bind(n,549415)),ba=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(61130),n.e(79058),n.e(83505),n.e(96271),n.e(7983),n.e(1839),n.e(14085),n.e(19570),n.e(14768),n.e(4759),n.e(88450),n.e(94864),n.e(58278),n.e(17134),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(94333),n.e(33876),n.e(98935),n.e(2205),n.e(12724),n.e(89962),n.e(48753),n.e(97087),n.e(79850),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(2116),n.e(42256),n.e(64891),n.e(72780),n.e(34814),n.e(26891),n.e(97191),n.e(43806),n.e(6482),n.e(11965),n.e(50468),n.e(9699),n.e(75988),n.e(30585),n.e(43164),n.e(69816),n.e(86034),n.e(4788),n.e(40705),n.e(25143),n.e(55867),n.e(88972),n.e(65162),n.e(35160),n.e(47844),n.e(10591),n.e(70971),n.e(54134),n.e(54724),n.e(55374),n.e(23594),n.e(70326)]).then(n.bind(n,334814)),Ca="calling-app-LPC",wa="calling-app",Na=({appRenderMode:e,coreSettings:t,host:n,isHeader:a,isMainPanel:o,logger:r,onRenderEvent:l,scenarioFactory:c})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){r.log(`renderWithLPC: import LPC: isMainPanel=${o} isHeader=${a}`);const{enableCallingAppChunkLoadEventLog:i}=t.get(K.J.Calling),u=(0,d.mT)(ba,i?Ca:wa,c);if(e===s.S.Main){l("ChunkLoadStarted",i?{chunkName:Ca}:{chunkName:wa});const{chunkLoadTimerPromise:e,chunkLoadTimer:s}=(({coreSettings:e,host:t})=>{let n=0;return{chunkLoadTimerPromise:new Promise(((i,a)=>{let{chunkLoadTimeout:o}=e.get(K.J.Calling);o||(o=Number.MAX_SAFE_INTEGER),n=t.setTimeout(a,o,(0,Mn.Tr)("CallingApp",De.jK.ChunkLoadTimedOut,"renderMain"))})),chunkLoadTimer:n}})({coreSettings:t,host:n});yield Promise.race([u,e]).then((()=>clearTimeout(s))).catch((e=>{throw r.error(`renderWithLPC: ChunkLoadTimedOut: isMainPanel=${o} isHeader=${a}`),e})),l("ChunkLoadSucceeded",i?{chunkName:Ca}:{chunkName:wa})}const{LPC:m}=yield u;return r.log(`renderWithLPC: construct the slot element: isMainPanel=${o} isHeader=${a}`),m})),Ta=({coreServices:e,host:t,isResize:n,entityType:i,windowOptions:a})=>{var o,r;const{minHeight:s,minWidth:l}=(null===(o=Zi.windowFeatures)||void 0===o?void 0:o.otherEntityTypes)||{},d=null==t?void 0:t.screen;if(i===u.p.callsmonitor)return(({host:e,windowOptions:t})=>{var n,i;const a=null!==(i=null===(n=Zi.windowFeatures)||void 0===n?void 0:n[u.p.callsmonitor])&&void 0!==i?i:{},o={width:a.width||0,height:a.height||0};return t&&(o.width=t.width||o.width,o.height=t.height||o.height),e&&e.screen&&o.width&&o.height&&(a.top=0===(null==t?void 0:t.top)||(null==t?void 0:t.top)?t.top:e.screen.availHeight-(o.height+100),a.left=0===(null==t?void 0:t.left)||(null==t?void 0:t.left)?t.left:e.screen.availWidth-(o.width+100)),Object.assign(Object.assign({},a),o)})({host:t,windowOptions:a});if(n&&!d)return(null===(r=Zi.windowFeatures)||void 0===r?void 0:r.otherEntityTypes)||null;if(!d)return null;let{height:c=1,width:m=1}=((e,t)=>{var n,i;const{minHeight:a=0,minWidth:o=0}=(null===(n=Zi.windowFeatures)||void 0===n?void 0:n.otherEntityTypes)||{};let{width:r,height:s}=(null===(i=Zi.windowFeatures)||void 0===i?void 0:i.otherEntityTypes)||{};if(!t)return{height:s,width:r,minHeight:a,minWidth:o};const{orientation:{type:l}}=e,{landscapeScreenRatio:d,portraitScreenRatio:c,widthHeightRatio:u}=t.coreSettings.get(K.J.Calling);if(d&&c&&u)switch(l){case"landscape-primary":case"landscape-secondary":const t=d*e.availHeight;s=t>a?t:a,r=u*s;break;case"portrait-primary":case"portrait-secondary":const n=c*e.availWidth;r=n>o?n:o,s=1/u*r}return{height:s,width:r}})(d,e);const g=d.availHeight-20,p=m>=d.availWidth||c>=g;p&&(c=d.availHeight,m=d.availWidth);const{left:v,top:h}=((e,t,n,i,a)=>{if(i)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,r="availTop"in e?e.availTop:0,s=o+e.availWidth/2-t/2;let l;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":l=r+a;break;default:l=r+e.availHeight/2-n/2}return{left:s,top:l}})(d,m,c,p,20);return{additionalFeatures:{minHeight:`${s}`,minWidth:`${l}`},height:c,width:m,fullScreen:p,left:v,top:h,minHeight:s,minWidth:l}},Ia=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{logger:t,scenarioFactory:n,isMainPanel:i,isHeader:a,isModal:o,coreSettings:r,onRenderEvent:s}=e,{enableCallingAppChunkLoadEventLog:l}=r.get(K.J.Calling);l&&s("ChunkLoadStarted",{chunkName:wa}),t.log(`render: import the necessary subcomponents: isMainPanel=${i} isHeader=${a} isModal=${o}`);const[{CallingViewsRenderer:c},{CallingContextProvider:u}]=yield Promise.all([(0,d.mT)(ka,wa,n),(0,d.mT)(Sa,wa,n)]);return l&&s("ChunkLoadSucceeded",{chunkName:wa}),{CallingViewsRenderer:c,CallingContextProvider:u}})),Ea=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{isMainPanel:t,isHeader:n,isModal:i,logger:a}=e,{CallingViewsRenderer:r,CallingContextProvider:s}=yield Ia(e);return a.log(`render: construct the slot element: isMainPanel=${t} isHeader=${n} isModal=${i}`),o.createElement(_a,null,o.createElement(s,null,o.createElement(r,{isMainPanel:t,isHeader:n,isModal:i})))}));function Aa(){return{eventHandlers:ji,getAppPhases:Wi,getAppViewEntities:Vi,getAppViewEntitiesProps:Yi,getAppWindowFeatures:Ta,getCommandScenarioName:ya,manifest:Zi,render:e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var{appRenderMode:t,entity:n,loggerFactory:a}=e,r=(0,i.__rest)(e,["appRenderMode","entity","loggerFactory"]);const l=a.newLogger("CallingApp");if(n.type===u.p.callsmonitor)return(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var{appRenderMode:t,loggerFactory:n,host:a,scenarioFactory:r}=e,l=(0,i.__rest)(e,["appRenderMode","loggerFactory","host","scenarioFactory"]);if(t===s.S.HorizontalBar||t===s.S.Main){const e=n.newLogger("CallingApp"),i=t===s.S.HorizontalBar;return Ea(Object.assign({isMainPanel:!0,isHeader:i,isModal:!1,logger:e,scenarioFactory:r,appRenderMode:t,host:a},l))}return o.createElement(fa.e,null)})))(Object.assign({appRenderMode:t,entity:n,loggerFactory:a},r));if(t===s.S.HorizontalBar||t===s.S.Modal){const e=t===s.S.HorizontalBar,n=t===s.S.HorizontalBar,i=t===s.S.Modal;return Ea(Object.assign({isMainPanel:e,isHeader:n,isModal:i,logger:l,appRenderMode:t},r))}if(t===s.S.Main||t===s.S.Rail){const e=t===s.S.Main,n=!1,a=!1;return d=Object.assign({isMainPanel:e,isHeader:n,isModal:a,appRenderMode:t,logger:l},r),(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{isMainPanel:e,isHeader:t,isModal:n,logger:i,coreSettings:a}=d,{CallingViewsRenderer:r,CallingContextProvider:s}=yield Ia(d);i.log(`render: construct the slot element: isMainPanel=${e} isHeader=${t} isModal=${n}`);const{enableEntityMoreInfo:l=!1}=a.get(K.J.Core),c=({children:e})=>o.createElement(o.Fragment,null,e),u=l?c:yield Na(d),m=l?c:yn.p3;return o.createElement(_a,null,o.createElement(u,null,o.createElement(m,null,o.createElement(s,null,o.createElement(r,{isMainPanel:e,isHeader:t,isModal:n})))))}))}var d;return o.createElement(fa.e,null)})),onPreWarm:Di,onPreInit:Fi,onBeforeAddToNavigation:Bi,onBeforeCommandHandled:oa,onBeforeDeeplinkParsed:Ui,onCommandResult:pa}}const _a=({children:e})=>o.createElement(l.f,{namespaces:["calling","broadcast","extensibility","hololens","messaging","meetingOptions","datepicker"],loaderRenderer:null},e);var Da=n(266641),Fa=n(838337);const Ma="LivePersonaEditor",Ra="openLivePersonaEditorDialog",Pa=e=>({actor:Ma,action:Ra,data:e}),Oa={onEventReceived:({eventInput:{event:e}})=>{if(xa(e)){const t=e.data();return Promise.resolve({command:vn(t)})}if((0,Fa.s)(e)){const{mri:t,isFederatedUser:n}=e.data();switch(e.type){case"addSpeedDialContact":return Promise.resolve({command:Pa({mri:t,isFederatedUser:n,isInSpeedDialMode:!0})});case"addContact":return Promise.resolve({command:Pa({mri:t,isFederatedUser:n})})}}return Promise.resolve(void 0)}},xa=e=>e.type===un.uS.requestPersonMoreInfo,La=e=>{if(Ua(e))return Ba(e)?{subNavEntity:ja(e),headerEntity:Wa(e),startEntity:Va(e),mainEntity:Ha(e),endEntity:$a(e)}:null},Ua=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.callsmain,u.p.locationnotification].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view].includes(n);return!!(a&&o&&r)},Ba=()=>!0,ja=()=>null,Wa=({entity:e})=>e,Va=()=>null,Ha=({entity:e})=>e,$a=()=>null,za="calls-main",Ga="viewCallsMainApp",qa=()=>({actor:za,action:Ga}),Qa={id:"com.microsoft.teams.callsmain",name:"CallsMain",actors:[za],supportedEntities:[u.p.callsmain,u.p.locationnotification],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail,s.S.Modal],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600}},Ja=({appRenderMode:e,coreSettings:t})=>{const{callsAppPhaseTimeouts:n,enableCallsAppPhaseStateMachine:i}=t.get(K.J.Calling),a=new Dt.H;if(!i)return a.appPhases;const o=[],r=[];switch(e){case s.S.Main:o.push(Ft.GZ.DIALPAD_RENDERED),r.push(Ft.GZ.CALL_GROUP_OWNERS_RENDERED),r.push(Ft.GZ.CALL_FORWARDING_SETTINGS_RENDERED),r.push(Ft.GZ.AUDIO_DEVICE_SETTINGS_RENDERED),o.push(Ft.GZ.CALL_HISTORY_RENDERED);break;case s.S.Rail:o.push(Ft.GZ.SPEED_DIAL_RENDERED)}return a.registerAppPhase({phase:Ft.nh.CRITICAL,signals:o,timeout:(null==n?void 0:n.critical)||1e4}),a.registerAppPhase({phase:Ft.nh.POST_CRITICAL,signals:r,timeout:(null==n?void 0:n.postCritical)||1e4}),a.appPhases},Ya=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("CallsMainApp onCommandReceived");if(e.command.actor===za)switch(n){case Ga:return{entity:{type:u.p.callsmain,action:u.u.view},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at CallsMainApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by CallsMainApp.`)})),Ka=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,659574)),Za=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,556620)),Xa=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,915118)),eo=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,334814)),to=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,107975)),no=()=>Qa.windowFeatures||{},io=()=>ft.RG.CallsAppSwitch,ao="calls-main-app";function oo(){const e=()=>null;return{eventHandlers:Oa,getAppPhases:Ja,getAppViewEntities:La,getAppWindowFeatures:no,getCommandScenarioName:io,getPlatformAppIdForEntity:e=>e.type===u.p.callsmain?"20c3440d-c67e-4420-9f80-0e50c39693df":void 0,manifest:Qa,onCommandReceived:Ya,render:({appRenderMode:t,coreSettings:n,onRenderEvent:a,scenarioFactory:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let i=!0;const c=e=>i=e,{enableLocationNotificationPopup:u}=n.get(K.J.Calling);if(t===s.S.Rail||t===s.S.Main){const e=t===s.S.Main;e&&a("ChunkLoadStarted",{chunkName:ao}),e&&a("ChunkLoadSucceeded",{chunkName:ao});const{enableEntityMoreInfo:i}=n.get(K.J.Core),c=({children:e})=>o.createElement(o.Fragment,null,e),{LPC:u}=i?{LPC:c}:yield(0,d.mT)(eo,ao,r),m=i?c:yn.p3,[{CallsMainViewsRenderer:g},{CallsTabContextProvider:p}]=yield Promise.all([(0,d.mT)(Ka,ao,r),(0,d.mT)(Za,ao,r)]);return o.createElement(l.f,{namespaces:["calling","hololens","messaging"],loaderRenderer:null},o.createElement(u,null,o.createElement(m,null,o.createElement(p,null,o.createElement(g,{isMainPanel:e})))))}if(t===s.S.Modal&&u){const e="calls-main-app";a("ChunkLoadStarted",{chunkName:ao});const{EditEmergencyAddressDialogComponent:t}=yield(0,d.mT)(to,e,r);return a("ChunkLoadSucceeded",{chunkName:ao}),o.createElement(t,{showEditAddressDialog:i,setShowEditAddressDialog:c,moduleName:Da.rA.emergencyLocationManageLocationButton})}const{enableCallsAppHeader:m}=n.get(K.J.Calling);if(m&&t===s.S.HorizontalBar){a("ChunkLoadStarted",{chunkName:ao});const[{CallsHeaderRenderer:e},{CallsTabContextProvider:t}]=yield Promise.all([(0,d.mT)(Xa,ao,r),(0,d.mT)(Za,ao,r)]);return a("ChunkLoadSucceeded",{chunkName:ao}),o.createElement(t,null,o.createElement(e,null))}return o.createElement(e,null)}))}}const ro={id:"com.microsoft.teams.cast",name:"CastApp",supportedEntities:[u.p.cast],supportedRenderModes:[s.S.Main],windowFeatures:{width:640,height:720,minWidth:640,minHeight:720}},so=e=>{if(lo(e))return co(e)?{subNavEntity:uo(e),headerEntity:mo(e),startEntity:go(e),mainEntity:po(e),endEntity:vo(e)}:null},lo=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.cast].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},co=()=>!0,uo=()=>null,mo=()=>null,go=()=>null,po=({entity:e})=>e,vo=()=>null,ho=()=>({[L.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!1,isThemePinnedToDarkOrHighContrast:!0,UNSAFE_enablePptProvider:!0}}}),fo={shouldAddEntitiesToWindowHistory:e=>{var t;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.cast},shouldRestoreClientToEntities:()=>!0},yo=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(50611),n.e(84460),n.e(79058),n.e(40963),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(62808),n.e(15370),n.e(5592),n.e(46263),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(30141),n.e(50153),n.e(43806),n.e(43164),n.e(35160),n.e(76657)]).then(n.bind(n,808835)),ko=({host:e})=>{const t=null==e?void 0:e.screen;if(!t)return{};if(!ro.windowFeatures)return{};const{minHeight:n,minWidth:i}=ro.windowFeatures,{height:a=1,width:o=1}=ro.windowFeatures,{left:r,top:s}=((e,t,n,i)=>{const a=e.availLeft+e.availWidth/2-t/2;let o;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":o=e.availTop+i;break;default:o=e.availTop+e.availHeight/2-n/2}return{left:a,top:o}})(t,o,a,20);return{additionalFeatures:{minHeight:`${n}`,minWidth:`${i}`},height:a,width:o,left:r,top:s,minHeight:n,minWidth:i}};function So(){const e=()=>null;return{getAppViewEntities:so,getAppViewEntitiesProps:ho,getAppWindowFeatures:ko,manifest:ro,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="cast-app";n("ChunkLoadStarted",{chunkName:e});const{CastWizard:t}=yield(0,d.mT)(yo,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)})),onBeforeAddToNavigation:fo}}var bo,Co=n(903001);!function(e){e.quickReply="quickReply",e.unknown="unknown",e.view="view"}(bo||(bo={}));const wo={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"sendMessage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendMessage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}},{kind:"Argument",name:{kind:"Name",value:"correlationId"},value:{kind:"Variable",name:{kind:"Name",value:"correlationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},No={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsChatNotifyActiveContextChangedMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activeContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activeContextType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActiveContextType"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notifyActiveContextChangedToCDLWorker"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activeContextId"},value:{kind:"Variable",name:{kind:"Name",value:"activeContextId"}}},{kind:"Argument",name:{kind:"Name",value:"activeContextType"},value:{kind:"Variable",name:{kind:"Name",value:"activeContextType"}}}]}]}}]};var To=n(603167),Io=n(907207);const Eo=e=>{const{entityCommand:t,entityCommand:{entity:{type:n,action:i,id:a},dataOptions:o},requestContext:r}=e,s=r.client;return Fo(s,r.coreSettings,n,i,a),Ao(s,o,t,n,i)},Ao=(e,t,n,i,a)=>t&&_o(i,a)?Do(t)&&t.convId&&t.message?e.mutate({mutation:wo,variables:{convId:t.convId,message:{clientMessageId:(0,To.K)(),messageType:Io.Cs.HTML,content:t.message},action:L.xyM.Create}}).then((()=>{})).catch((()=>Promise.reject(ri.f.ChatToastActionMutationFailed))):Promise.reject(ri.f.ChatActionTypeToNotificationActionFailed):Promise.resolve(n),_o=(e,t)=>e===u.p.chats&&t===u.u.mutate,Do=e=>e.actionType===bo.quickReply,Fo=(e,t,n,i,a)=>{t.get(K.J.CdlWorker).enableNotifyActiveContextChangedToCDLWorker&&a&&n===u.p.chats&&i===u.u.view&&e.mutate({mutation:No,fetchPolicy:"no-cache",variables:{activeContextId:a,activeContextType:L.xz$.chat}})},Mo=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(89760),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(70946),n.e(68227),n.e(94864),n.e(31142),n.e(97424),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(89962),n.e(88978),n.e(44413),n.e(16087),n.e(76420),n.e(28030),n.e(19215),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(34814),n.e(78684),n.e(17027),n.e(78290),n.e(97191),n.e(35166),n.e(43806),n.e(6482),n.e(88204),n.e(94339),n.e(26599),n.e(11965),n.e(1910),n.e(69827),n.e(93880),n.e(75988),n.e(88369),n.e(98998),n.e(24998),n.e(25670),n.e(13465),n.e(24548),n.e(50295),n.e(76022),n.e(80941),n.e(46782),n.e(84203),n.e(99149),n.e(80097),n.e(59885),n.e(24974),n.e(81647)]).then(n.bind(n,979628)),Ro=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(89760),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(70946),n.e(68227),n.e(94864),n.e(31142),n.e(97424),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(89962),n.e(88978),n.e(44413),n.e(16087),n.e(76420),n.e(28030),n.e(19215),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(34814),n.e(78684),n.e(17027),n.e(78290),n.e(97191),n.e(35166),n.e(43806),n.e(6482),n.e(88204),n.e(94339),n.e(26599),n.e(11965),n.e(1910),n.e(69827),n.e(93880),n.e(75988),n.e(88369),n.e(98998),n.e(24998),n.e(25670),n.e(13465),n.e(24548),n.e(50295),n.e(76022),n.e(80941),n.e(46782),n.e(84203),n.e(99149),n.e(80097),n.e(59885),n.e(24974),n.e(81647)]).then(n.bind(n,334814)),Po=({action:e,appRenderMode:t,coreSettings:n})=>{const i=new Dt.H,{isHeaderDisabled:a=!1}=n.get(K.J.Core),{chatAppPhaseTimeouts:o,enableComposeCriticalPhaseLoad:r=!1,enableComposeCriticalPhaseLoadSecondaryViewport:l=!1,enableComposeCriticalPhaseLoadSecondaryViewportGate:d=!1}=n.get(K.J.Messaging),c=[],u=[];switch(t){case s.S.HorizontalBar:Oo({criticalSignals:c,featureFlags:{isHeaderDisabled:a},postCriticalSignals:u});break;case s.S.Main:xo({action:e,criticalSignals:c,featureFlags:{enableComposeCriticalPhaseLoad:r},postCriticalSignals:u});break;case s.S.Rail:Lo({action:e,criticalSignals:c,featureFlags:{enableComposeCriticalPhaseLoad:r,enableComposeCriticalPhaseLoadSecondaryViewport:l,enableComposeCriticalPhaseLoadSecondaryViewportGate:d},postCriticalSignals:u})}return i.registerAppPhase({phase:Ft.nh.CRITICAL,signals:c,timeout:(null==o?void 0:o.critical)||6e4}),i.registerAppPhase({phase:Ft.nh.POST_CRITICAL,signals:u,timeout:(null==o?void 0:o.postCritical)||1e4}),i.appPhases},Oo=({featureFlags:{isHeaderDisabled:e},criticalSignals:t,postCriticalSignals:n})=>{!e&&t.push(Ft.GZ.CHAT_HEADER_TITLE_RENDERED),!e&&n.push(Ft.GZ.CHAT_HEADER_BUTTONS_RENDERED)},xo=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:n},postCriticalSignals:i})=>{if(e===u.u.join)return;t.push(Ft.GZ.MESSAGES_RENDERED);const a=n;a&&t.push(Ft.GZ.COMPOSE_LOADED),i.push(Ft.GZ.MESSAGE_REACTIONS_RENDERED,Ft.GZ.PRESENCES_RENDERED,Ft.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED),!a&&i.push(Ft.GZ.COMPOSE_LOADED)},Lo=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:n,enableComposeCriticalPhaseLoadSecondaryViewport:i,enableComposeCriticalPhaseLoadSecondaryViewportGate:a},postCriticalSignals:o})=>{if(e===u.u.list)t.push(Ft.GZ.CHAT_LIST_ITEMS_RENDERED),o.push(Ft.GZ.PRESENCES_RENDERED);else if(e===u.u.view){t.push(Ft.GZ.MESSAGES_RENDERED);const e=a&&i,r=n||e;r&&t.push(Ft.GZ.COMPOSE_LOADED),o.push(Ft.GZ.MESSAGE_REACTIONS_RENDERED,Ft.GZ.PRESENCES_RENDERED,Ft.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED),!r&&o.push(Ft.GZ.COMPOSE_LOADED)}},Uo={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"discardDuringMeetingsAndCalls"}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"members"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"parentEntityTitle"}},{kind:"Field",name:{kind:"Name",value:"reaction"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderDecoratedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderId"}},{kind:"Field",name:{kind:"Name",value:"subtype"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"topic"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"fromExternalUser"}},{kind:"Field",name:{kind:"Name",value:"activityId"}},{kind:"Field",name:{kind:"Name",value:"isUrgent"}}]}}]}}]};var Bo,jo;!function(e){e.GroupMessage="GroupMessage",e.Message="Message",e.Mention="Mention",e.Reaction="Reaction",e.InviteJoined="InviteJoined",e.TeamsTasks="TeamsTasks",e.Reminder="Reminder",e.Priority="Priority"}(Bo||(Bo={})),function(e){e.Small="HR64x64"}(jo||(jo={}));const Wo="topic",Vo="text",Ho="buttonText";var $o=n(619886);const zo={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},Go={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaGroupProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]},qo={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};var Qo=n(769088);const Jo={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsChatEmoticonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchEmoticons"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}}},{kind:"Argument",name:{kind:"Name",value:"exactMatch"},value:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}}},{kind:"Argument",name:{kind:"Name",value:"includeShortCuts"},value:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}}},{kind:"Argument",name:{kind:"Name",value:"includeKeywords"},value:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}}},{kind:"Argument",name:{kind:"Name",value:"maxResultCount"},value:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}}},{kind:"Argument",name:{kind:"Name",value:"categoryId"},value:{kind:"Variable",name:{kind:"Name",value:"categoryId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsChatEmoticonFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsChatEmoticonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"unicode"}},{kind:"Field",name:{kind:"Name",value:"animation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsChatEmoticonFragment_animation"}}]}},{kind:"Field",name:{kind:"Name",value:"etag"}},{kind:"Field",name:{kind:"Name",value:"diverse"}},{kind:"Field",name:{kind:"Name",value:"shortcuts"}},{kind:"Field",name:{kind:"Name",value:"searchMatch"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsChatEmoticonFragment_animation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fps"}},{kind:"Field",name:{kind:"Name",value:"framesCount"}},{kind:"Field",name:{kind:"Name",value:"firstFrame"}}]}}]}.definitions]};var Yo=n(523556),Ko=n(580980),Zo=n(694785),Xo=n(788594);function er(e,t){const n=e.senderGivenName||e.senderDisplayName||or(t);if(e.subtype)return t.stringTranslate("toastNotifications","new_task_list_added_toast_title",{sender:n})}function tr(e,t){const n=function(e,t){var n,i;const a=t.topic;if(a)return a;if(!(null===(n=t.members)||void 0===n?void 0:n.length))return;return null===(i=wr(e,t.members))||void 0===i?void 0:i.displayName}(e,t);return t.subtype===Xo.YQ.tFLPlanCreated&&n&&t.text?e.stringTranslate("toastNotifications","task_list_in_group_chat_added_text",{groupChatTitle:n,taskListTitle:t.text}):t.text||void 0}function nr(e,t,n){const{enableInviteeJoinedActivity:i}=n.get(K.J.Activity),a=ar(e,i?t.senderDisplayName:t.senderGivenName);return e.stringTranslate("toastNotifications",i?"toast_invite_joined_with_activity_feed_title":"toast_invite_joined",{sender:a})}function ir(e,t,n,i){const{enableInviteeJoinedActivity:a}=i.get(K.J.Activity);if(a){const t=ar(e,n.senderDisplayName);return e.stringTranslate("toastNotifications","toast_invite_joined_with_activity_feed_text",{sender:t})}return n.members&&n.members.length?n.topic||t(e,n.members):void 0}function ar(e,t){return t||or(e)}function or(e){return e.stringTranslate("toastNotifications","toast_unknown_user")}var rr=n(353915),sr=n(84237),lr=n(499367);function dr(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{if(n.type===Bo.Priority)return t.log(`${ri.f.ReturningHardcodedImage}: Returning default priority message avatar for toast ${n.correlationId}`),rr.ap;if(1===(null===(a=n.members)||void 0===a?void 0:a.length)&&n.type===Bo.GroupMessage)return t.log(`${ri.f.ReturningHardcodedImage} Returning default group message avatar for toast ${n.correlationId} as there is just one member`),rr.dA;const o=n.type===Bo.GroupMessage?yield function(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!(null===(n=t.members)||void 0===n?void 0:n.length))return null;const{data:i}=yield e.query({query:Go,variables:{msaGroupInfo:{pictureReadyUsers:t.members.map((({id:e,displayName:t})=>({userId:e,displayName:t}))).slice(0,Qo.gT.FOUR),conversationId:t.conversationId}}});return i.msaGroupProfilePicture}))}(e,n):yield function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{data:n}=yield e.query({query:zo,variables:{userId:t.senderId,displayName:t.senderDisplayName,profilePictureSize:jo.Small}});return n.msaUserProfilePicture}))}(e,n);if(!o)return void t.error(ri.f.ImageUrlGenerationFailed);const r=yield e.query({query:qo,variables:{url:o}}),s=null==r?void 0:r.data.toastImageAsDataUri;return s?(t.log(ri.f.ReturningFetchedImage),t.log(`Returning fetched image for toast ${n.correlationId}`),s):void t.error(ri.f.ToastImageAsDataUriIsUndefined)}catch(e){return void t.error(ri.f.ImageFetchFailed)}}))}function cr(e,t){const{i18n:n,missedConversationsNumber:i,sender:a,otherSenders:o}=t;switch(e){case Wo:return o>=1?n.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_group_topic",{sender:a,otherSenders:o}):n.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_topic",{sender:a});case Ho:return n.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_button_text");case Vo:default:return n.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_text",{number:i})}}function ur(e,t,n){const{enableToastMediaTextPreview:i}=e.get(K.J.Notifications);return n.interopConversationStatus===Io.uI.AcceptPending||n.interopConversationStatus===Io.uI.ExtendedDirectoryAcceptPending?t.stringTranslate("people","invite_free_quarantined_notification_content"):i?mr(t,n):gr(n.text||"")}function mr(e,t){switch(t.contentType){case lr.zc.FILE:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_file");case lr.zc.VOICE:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_voice_message");case lr.zc.IMAGE:return e.stringTranslate("toastNotifications","toast_messaging_sent_an_image");case lr.zc.LOCATION:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_location_message");default:return gr(t.text||"")}}function gr(e){const t=(0,Ko.S)(e,!0).trim().replace(/\s\s+/g," ");return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g,"").replace(/&quot;/g,'"')}function pr(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(o.log(`${ri.f.MappingCommandOptions}: Generating command options for type ${n.type}`),n.type){case Bo.Message:case Bo.Priority:return function(e,t,n){return Object.assign(Object.assign(Object.assign({},Sr(n)),kr(t,n.interopConversationStatus)),{text:ur(e,t,n),title:vr(t,n),isUrgent:!!n.isUrgent})}(e,t,n);case Bo.GroupMessage:return function(e,t,n){return Object.assign(Object.assign(Object.assign({},Sr(n)),kr(t,n.interopConversationStatus)),{text:fr(e,t,n),title:n.topic||Cr(t,n.members)})}(e,t,n);case Bo.Mention:case Bo.Reaction:return function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o=t.type===Bo.Reaction?yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const{id:t}=(0,sr.M)(null==n?void 0:n.toLocaleLowerCase().trim());if(!t)return;const{data:i}=yield e.query({query:Jo,variables:{searchFilter:t,exactMatch:!0}});return((null==i?void 0:i.searchEmoticons)||[])[0]}catch(e){return void t.error(ri.f.ChatToastEmoticonsQueryFailed)}}))}(n,a,t.reaction):void 0;return Object.assign(Object.assign({},Sr(t)),{text:t.topic||br(e,t.senderGivenName||t.senderDisplayName,t.members),isUrgent:!!t.isUrgent,title:hr(e,t,(null==o?void 0:o.unicode)||void 0)})}))}(t,n,a,o);case Bo.InviteJoined:return function(e,t,n){return Object.assign(Object.assign({},Sr(n)),{text:ir(t,Cr,n,e),title:nr(t,n,e)})}(e,t,n);case Bo.TeamsTasks:return function(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const r=yield function(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!a)return;const i=yield e.query({query:Zo.br,variables:{id:n,queryType:L.rtK.QueryByThread},fetchPolicy:"network-only"}).catch((()=>{t.error(ri.f.ChatTabsFetchFailed)})),r=null===(o=null==i?void 0:i.data.platformTabs)||void 0===o?void 0:o.find((e=>(null==e?void 0:e.entityId)&&(null==e?void 0:e.entityId.toLowerCase().includes(a.toLowerCase()))));return r||t.log(ri.f.ToastNavigationDataNotFound),r}))}(n,a,t.conversationId,t.tabId);return Object.assign(Object.assign({},Sr(t)),{text:tr(e,t)||"",title:null!==(o=er(t,e))&&void 0!==o?o:"",type:Bo.TeamsTasks,tabId:JSON.stringify({tabId:null==r?void 0:r.baseInfo.id,threadId:t.conversationId,appId:null==r?void 0:r.baseInfo.appId,tabEntityId:null==r?void 0:r.entityId})})}))}(t,n,a,o);default:return}}))}function vr(e,t){const n=yr(e,t),i=t.fromExternalUser&&t.senderDecoratedDisplayName;return Yo.eo.isTFLSmsMri(t.senderId)?e.stringTranslate("toastNotifications","toast_messaging_sms_user_given_name",{sender:n}):i&&t.senderDecoratedDisplayName||n}function hr(e,t,n){switch(t.type){case Bo.Mention:return`@ ${e.stringTranslate("toastNotifications","toast_messaging_mention",{sender:t.senderDisplayName})}`;case Bo.Reaction:return e.stringTranslate("toastNotifications","toast_messaging_reaction",{sender:t.senderDisplayName,emoji:n})}}function fr(e,t,n){const{enableToastMediaTextPreview:i}=e.get(K.J.Notifications);if(!n.text)return;const a=i?mr(t,n):gr(n.text);if(!a)return;const o=n.senderGivenName||yr(t,n);if(Yo.eo.isTFLSmsMri(n.senderId))return t.stringTranslate("toastNotifications","toast_messaging_sms_group_text_with_sender",{sender:o,text:a});const{enableGroupChatInviteFlow:r}=e.get(K.J.Messaging);return r&&n.interopConversationStatus===Io.uI.AcceptPending?t.stringTranslate("toastNotifications","toast_messaging_group_chat_invite_flow_text_with_sender",{displayName:o}):t.stringTranslate("toastNotifications","toast_messaging_group_text_with_sender",{sender:o,text:a})}function yr(e,t){return!t.senderDisplayName||Yo.eo.isDisplayNameUnknownUser(t.senderDisplayName)?e.stringTranslate("toastNotifications","toast_unknown_user"):t.senderDisplayName}function kr(e,t){return t===Io.uI.AcceptPending||t===Io.uI.ExtendedDirectoryAcceptPending||t===Io.uI.Quarantined?{quickReply:!1}:{quickReply:!0,quickReplyPlaceholder:e.stringTranslate("toastNotifications","toast_messaging_quickreply_placeholder_text"),quickReplyButton:e.stringTranslate("toastNotifications","toast_messaging_quickreply_button_text")}}function Sr(e){return{conversationId:e.conversationId,messageId:e.messageId,quickReply:!1,time:new Date(+e.timestamp),discardDuringMeetingsAndCalls:!!e.discardDuringMeetingsAndCalls}}function br(e,t,n){const i=wr(e,n);return i?e.stringTranslate("toastNotifications",i.count?"toast_messaging_activity_text_with_count":"toast_messaging_activity_text",{participants:i.displayName,count:i.count}):t?e.stringTranslate("toastNotifications","toast_messaging_activity_text",{participants:t}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function Cr(e,t){const n=wr(e,t);return n?e.stringTranslate("toastNotifications",n.count?"toast_messaging_group_topic_with_count":"toast_messaging_group_topic",{participants:n.displayName,count:n.count}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function wr(e,t){if(!t||!Array.isArray(t)||0===t.length)return;const n=e.stringTranslate("toastNotifications","toast_unknown_user"),i=t.map((e=>e.givenName||n));return(0,$o.N)(i,t.length)}function Nr(e,t,n,a,o,r,s,l,d){const{enableCommandToHostCommService:c}=t.get(K.J.Core);return{id:"toast-event-subscription",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const m=s.newLogger("ToastEventSubscription");c?(m.log(ri.f.Subscribing),n.subscribe({query:Uo,fetchPolicy:"no-cache"}).forEach(function(e,t,n,a,o,r,s,l,d){const{enableToastCollections:c}=t.get(K.J.Notifications);return m=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,g;if(m.errors){const e=(0,Ci.u4)(m.errors.map((e=>e.message)).join());return s.error(`${ri.f.SubscriptionFailed} ${e}`),void Tr(l,{errorCode:ri.f.SubscriptionFailed,errors:e})}if(!(null===(i=m.data)||void 0===i?void 0:i.toastEvent))return s.error(ri.f.EmptyEvent),void Tr(l,{errorCode:ri.f.EmptyEvent});s.log(`${ri.f.ToastEventReceivedInJob}: Received a valid event in the toast subscription job, correlationId:${m.data.toastEvent.correlationId}, activityId:${m.data.toastEvent.activityId}`);const{toastEvent:p}=m.data,v=l.newScenario(ft.RG.CrossClientToastView,{startTime:+p.timestamp});v.clientId=p.correlationId,v.appendEventData({activityId:m.data.toastEvent.activityId,isUrgent:!!m.data.toastEvent.isUrgent,mainEntityType:u.p.chats,mainEntitySubtype:m.data.toastEvent.type,messageId:m.data.toastEvent.messageId}),v.mark(ft.ck.CrossClientToastEventReceived),s.log(`${ri.f.LogToastInfo}: ${JSON.stringify(v.eventData)}`);const h=yield pr(t,o,p,n,s);if(!h)return s.log(`${ri.f.UnhandledType} ${p.type}`),void v.incomplete({reason:ri.f.UnhandledType});const f=yield r({id:h.conversationId,type:u.p.chats,action:u.u.view,linkedEntity:null},n);if(v.mark(ft.ck.CrossClientConversationFocusChecked),f)return s.log(ri.f.ToastSuppressedForWindowInFocus),void v.incomplete({reason:ri.f.ToastSuppressedForWindowInFocus});const y=yield dr(n,s,p);v.mark(ft.ck.CrossClientAvatarFetched),y&&(h.mainImage={alt:"",src:y}),null===(g=l.hoistScenarioToCore)||void 0===g||g.call(l,v),c&&(h.collectionId=di(e,d,s)),h.type===Bo.TeamsTasks?a.toasts.showChatTabEntityNotification(p.correlationId,h):a.toasts.showMessage(p.correlationId,h),v.mark(ft.ck.CrossClientEntityCommandTriggered),s.log(`${ri.f.ToastCommandSent} type:${h.type} correlationId:${p.correlationId} activityId:${p.activityId}`)}))}(e,t,n,a,o,r,m,l,d))):m.log(ri.f.NotEnabled)}))}}function Tr(e,t){const n=e.newScenario(ft.RG.CrossClientToastView);n.appendEventData({mainEntityType:u.p.chats}),n.fail(t)}const Ir={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"TaskbarBadgeUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"taskbarBadgeUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"badgeCount"}}]}}]}}]};var Er=n(46694),Ar=n(946286);function _r(e,t,n,a,o){return{id:"taskbar-badge-event-subscription",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const r=t.newLogger("TaskbarBadgeEventSubscription");if(a.config.clientType!==Ye.Bh.Maglev)return void r.log(Er.vc.NotEnabled);const s=new Ar.a(t,o,n),l=e.subscribe({query:Ir,fetchPolicy:"no-cache"}).subscribe(function(e,t){return n=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i;if(n.errors){const t=n.errors.map((e=>e.message)).join();return void e.error(`${Er.vc.SubscriptionFailed} ${(0,Ci.u4)(t)}`)}if(!(null===(i=n.data)||void 0===i?void 0:i.taskbarBadgeUpdatedEvent))return void e.log(Er.vc.EmptyEvent);const{taskbarBadgeUpdatedEvent:a}=n.data,{badgeCount:o}=a;return e.log(`${Er.Bd.UpdatedEvent} badgeCount: ${o}`),t.showBadgeCount(o)}))}(r,s));return e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(l.unsubscribe(),e){case"quit":case"signout":yield s.resetBadge()}}))}))}}const Dr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsChatConversationsReminderEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationsReminderUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"lastMessageAuthor"}},{kind:"Field",name:{kind:"Name",value:"lastMessageId"}},{kind:"Field",name:{kind:"Name",value:"lastMessageComposeTime"}},{kind:"Field",name:{kind:"Name",value:"missedThreadsCount"}},{kind:"Field",name:{kind:"Name",value:"userNames"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}}]}}]}}]},Fr="life_web_and_desktop_growth_notification_reminders_info",Mr="life_web_and_desktop_growth_notification_reminders_error";function Rr(e,t,n,a,o,r){const s="ConversationsReminderEventSubscription",l=t.newLogger(s);return{id:"conversations-reminder-event-subscription",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;const d=o.get(K.J.CdlWorker).enableConversationReminderEngine;if(null===(t=l.debugToTelemetry)||void 0===t||t.call(l,`Conversation Reminder Engine ${d?"is":"is not"} enabled`,Fr,void 0,!0),!d)return;const c=e.watchQuery({query:Dr,fetchPolicy:"no-cache"}).subscribe(function(e,t,n,a){return o=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,r,s,l,d;const c=null===(i=o.data)||void 0===i?void 0:i.conversationsReminderUpdatedEvent;if(!c)return void(null===(r=e.errorToTelemetry)||void 0===r||r.call(e,"Received empty conversationsReminderUpdatedEvent.",Mr,void 0,!0));const u=a.newScenario(ft.RG.ConversationsReminderSubscriptionJob);try{const{threadId:i,lastMessageAuthor:a,lastMessageId:o,lastMessageComposeTime:r,userNames:d,missedThreadsCount:m,timestamp:g,correlationId:p}=c,v=`Received conversationsReminderUpdatedEvent with ${m} unread conversations. Event id ${p}`;if(e.log(v),null===(s=e.infoToTelemetry)||void 0===s||s.call(e,v,Fr,void 0,!0),u.appendEventData({correlationId:p}),u.mark(ft.ck.ConversationsReminderEventReceived),!(i&&a&&o&&r&&m&&(null==d?void 0:d.length)&&g&&p))return null===(l=e.errorToTelemetry)||void 0===l||l.call(e,`${ri.f.EmptyEvent}. Event id ${p}`,Mr,void 0,!0),void u.fail({reason:`conversationsReminderUpdatedEvent missed values: ${JSON.stringify(Object.assign(Object.assign({},c),{lastMessageAuthor:a?"FULFILLED":"MISSED",userNames:(null==d?void 0:d.length)?"FULFILLED":"MISSED"}))}`});u.mark(ft.ck.ConversationsReminderEventChecked);const h=function(e,t){const n={i18n:e,missedConversationsNumber:t.missedThreadsCount,sender:t.lastMessageAuthor,otherSenders:t.userNames.length-1};return{text:cr(Vo,n),title:cr(Wo,n),buttonText:cr(Ho,n),mainImage:{alt:t.lastMessageAuthor,src:rr.dA},conversationId:t.threadId,messageId:t.lastMessageId,time:new Date(t.lastMessageComposeTime),quickReply:!1,type:Bo.Reminder}}(n,c);yield t.toasts.showReminder(p,h),u.stop({reason:"conversationsReminderUpdatedEvent was triggered"})}catch(t){const n="Something failed while processing the event.";null===(d=e.errorToTelemetry)||void 0===d||d.call(e,n,Mr,void 0,!0),u.fail({reason:n})}}))}(l,n,a,r));return()=>{l.log(`${s} unsubscribed`),c.unsubscribe()}}))}}const Pr=({context:{authenticationUser:e,client:t,coreSettings:n,entityCommanding:i,hostCommunicationService:a,i18n:o,isEntityInView:r,loggerFactory:s,platformService:l,scenarioFactory:d,userTrackingService:c}})=>{const u=t;return[Nr(e,n,u,i,o,r,s,d,c),_r(u,s,a,l,n),Rr(u,s,i,o,n,d)]},Or=({context:{scenarioFactory:e}})=>[{id:"import-chat-bundle",runOncePerId:!0,job:()=>(({scenarioFactory:e})=>{(0,d.mT)(Mo,"chat-app",e)})({scenarioFactory:e})}];var xr=n(464776),Lr=n(84574),Ur=n(41058);const Br=e=>{if(jr(e))return Wr(e)?{subNavEntity:Vr(e),headerEntity:Hr(e),startEntity:$r(e),mainEntity:zr(e),endEntity:Gr(e)}:null},jr=({contextEntity:e,entity:t,layoutMode:n})=>{const{action:i=null,type:a}=Object.assign({},t),{type:o,action:r}=e||{},s=[c.lO.standard,c.lO.focus].includes(n),l=i&&[u.u.create,u.u.default,u.u.empty,u.u.info,u.u.infoDetails,u.u.join,u.u.list,u.u.view,u.u.manage].includes(i),d=r&&o,m=[u.p.chats,u.p.chatsInfo,u.p.chatContextualSearch,u.p.chatsInfoView,u.p.chatManageApps].includes(a),g=n===c.lO.focus&&i===u.u.list;return!(!s||!m||!l&&!d||g)},Wr=({entity:e,contextEntity:t})=>{const{type:n}=t||{},{action:i=null,type:a}=Object.assign({},e);return!(a!==u.p.chats||!(i||n&&![u.p.calls,u.p.callsgalleryandcontent,u.p.callsgallery,u.p.callscontent,u.p.platformStage,u.p.meetingroomallinonecall].includes(n)))},Vr=({entity:e,layoutMode:t})=>{if(t===c.lO.focus)return null;const{type:n,action:i}=e;return{action:u.u.list,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:n===u.p.chats&&i===u.u.default?JSON.stringify({focusOnLoad:xr.Y.LeftRailSelectedItem}):null,type:n,windowOptions:null}},Hr=({entity:e})=>{let t=u.u.view;const{action:n=null}=Object.assign({},e);return n&&[u.u.create,u.u.default,u.u.empty,u.u.join].includes(n)&&(t=n),Object.assign(Object.assign({},e),{action:t})},$r=()=>null,zr=({entity:e,contextEntity:t})=>{let n=u.u.view;const{action:i=null}=Object.assign({},e);return i&&[u.u.create,u.u.default,u.u.empty,u.u.join,u.u.manage].includes(i)&&(n=i),t||Object.assign(Object.assign({},e),{action:n})},Gr=({entity:e,contextEntity:t,coreSettings:n,layoutMode:i,userPreferences:a})=>{const{enableChatInfoPane:o,enableChatInfoPaneForMeeting:r,chatInfoPaneVisibilityState:s}=(null==n?void 0:n.get(K.J.Host))||{},{enableChatInfoPaneSearch:l,enableChatHighlightsSmartAction:d}=(null==n?void 0:n.get(K.J.Messaging))||{},m=Qr(n),g=Yr(s,a,m);let p,v,h;if(t?({id:p,type:v,options:h}=t):(({id:p,type:v}=e),"options"in e&&(h=e.options)),!((e,t,n,i,a,o)=>{var r;return!(!n&&!i||n&&o!==u.p.chatContextualSearch&&o!==u.p.chatHighlightsDetails&&(t!==c.lO.standard||e||!(null===(r=null==a?void 0:a.get(K.J.Core))||void 0===r?void 0:r.enableInfoPaneAsResponsiveMenu))||i&&t!==c.lO.standard)})(g,i,o,l,n,v))return null;const f=Jr(p),y=(0,Co.fM)(p),k=Zr(p,r),S=qr(v);if(!f&&!y&&!k&&ns(v,l,d)){return{action:u.u.info,id:p||"",type:v,options:h}}if(!f&&!y&&!k&&S&&o){return{action:u.u.info,id:p||"",type:u.p.chatsInfoView}}if(!f&&!y&&!k&&v===u.p.chatsInfo&&o){return{action:u.u.infoDetails,id:p||"",type:v,options:h}}return null},qr=e=>e===u.p.chats||e===u.p.chatsInfoView,Qr=e=>{if(e){const{enableChatInfoPaneDefaultOpen:t}=e.get(K.J.Messaging),{enableChatInfoPaneDefaultOpen:n}=e.get(K.J.Host);return t||n}return!1},Jr=e=>(0,Co.wm)(e)||(0,Co.UL)(e),Yr=(e,t,n)=>{var i,a;return(null!==(a=null!=e?e:null===(i=null==t?void 0:t.infoPane)||void 0===i?void 0:i.chats)&&void 0!==a?a:n?L.MwA.hidden:L.MwA.closed)===L.MwA.closed},Kr=e=>new Map([[Ur.Rd.IS_GREATER_THAN_0,e],[Ur.Rd.IS_AT_LEAST_947,e],[Ur.Rd.IS_AT_LEAST_1350,e],[Ur.Rd.IS_AT_LEAST_1500,e]]),Zr=(e,t)=>!t&&(0,Co.Eu)(e),Xr="41rem",es="32rem",ts=({areEmptySlotsTransparent:e,coreSettings:t,entity:n})=>{var i,a,o,r;const{isFlyoutChat:l}=null!==(i=null==t?void 0:t.get(K.J.Flyout))&&void 0!==i?i:{},{isNonInteractiveMeetingChat:d}=null!==(a=null==t?void 0:t.get(K.J.Calling))&&void 0!==a?a:{};let c=[Lr.oj.Teacher,Lr.oj.Student].includes(null==t?void 0:t.get(K.J.UserResources).licenseType)?Kr("32rem"):void 0;if(!c&&d){const{enableResponsiveChatPanel:e}=null!==(o=null==t?void 0:t.get(K.J.Calling))&&void 0!==o?o:{};c=e?new Map([[Ur.Rd.IS_GREATER_THAN_0,es],[Ur.Rd.IS_AT_LEAST_1350,Xr]]):Kr(Xr)}const{chatInfoPaneVisibilityState:m}=null!==(r=null==t?void 0:t.get(K.J.Host))&&void 0!==r?r:{};return c=m&&m===L.MwA.hidden?new Map([[Ur.Rd.IS_GREATER_THAN_0,"0"],[Ur.Rd.IS_AT_LEAST_947,"0"],[Ur.Rd.IS_AT_LEAST_1350,es],[Ur.Rd.IS_AT_LEAST_1500,es]]):c,{[L.tF7.endEntity]:{[s.S.Rail]:{slotWidthOverrides:c,isHideInfoPaneDisabled:(null==n?void 0:n.type)===u.p.chatContextualSearch||(null==n?void 0:n.type)===u.p.chatHighlightsDetails,infoPaneVisibilityStateInHybrid:m}},[L.tF7.subNavEntity]:{[s.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==t?void 0:t.get(K.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}},[L.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!!l,infoPaneVisibilityStateInHybrid:m}},[L.tF7.headerEntity]:{[s.S.HorizontalBar]:{isBackgroundTransparent:e}}}},ns=(e,t,n)=>e===u.p.chatHighlightsDetails&&n||e===u.p.chatContextualSearch&&t;var is=n(727765);const as="/l/invite/",os="/l/claim",rs={[os]:is.DL.Claim,[as]:is.DL.Invite},ss=new Set([os,as]),ls=(e,t)=>Promise.resolve({entityCommand:{entity:{type:u.p.chats,action:u.u.join},command:{visibilityState:c.fe.show,stateTransition:c.su.flush},entityOptions:{inviteLinkType:t,inviteLinkUrl:e.toString()}},metadata:{allowAnonymous:!1}}),ds="chat",cs="viewChatApp",us=()=>({actor:ds,action:cs});var ms=n(356898);const gs={id:"com.microsoft.teams.chat",name:"Chat",getLocalizedName:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("messaging"),e.stringTranslate("messaging","messaging_app_name")})),actors:[ds],supportedEntities:[u.p.alttext,u.p.chats,u.p.chatContextualSearch,u.p.chatHighlightsDetails,u.p.chatManageApps,u.p.chatsInfo,u.p.chatsInfoView,u.p.codesnippet,u.p.deletechat,u.p.dlp,u.p.fluid,u.p.giphyconsent,u.p.hyperlink,u.p.chatInviteConfirmation,u.p.leavechat,u.p.messagedraft,u.p.pinnedchatsmaxreached,u.p.pinnedconversationitems,u.p.removechatuser,u.p.reportConcern,u.p.reportConcernForTFW,u.p.sharechatlink,u.p.streamcamera,u.p.translationfeedback,u.p.twowaysmsfriendlyname,u.p.updategroupchatavatar,u.p.blockChat,u.p.leaveGroupAndBlockUser],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Modal,s.S.Rail],getDefaultCommand:e=>{const{enableFilterPinnedAppsBasedOnPolicy:t}=e.get(K.J.Extensibility);if(!t||(0,ms.t3)(e.get(K.J.Messaging))!==ms.i1.Disabled)return{action:u.u.default,type:u.p.chats}},windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125}},ps={shouldAddEntitiesToWindowHistory:e=>{var t,n;return!(0,Co.UL)(null===(t=null==e?void 0:e.mainEntity)||void 0===t?void 0:t.id)&&(null===(n=null==e?void 0:e.mainEntity)||void 0===n?void 0:n.action)!==u.u.create},shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:()=>!0},vs={onEventReceived:({eventInput:e})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;switch(e.event.type){case un.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:vn(i)})}return Promise.resolve(void 0)}))},hs=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("ChatApp onCommandReceived");if(e.command.actor===ds)switch(n){case cs:return{entity:{type:u.p.chats,action:u.u.default},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at ChatApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by ChatApp.`)})),fs=({appViewState:e,availableEntities:t})=>{var n,i,a,o,r,s,l;const{selectedChatId:d}=e;if((null===(n=t.mainEntity)||void 0===n?void 0:n.type)===u.p.chats&&((null===(i=t.mainEntity)||void 0===i?void 0:i.action)===u.u.view||(null===(a=t.mainEntity)||void 0===a?void 0:a.action)===u.u.create||(null===(o=t.mainEntity)||void 0===o?void 0:o.action)===u.u.default)){const e=null===(r=t.mainEntity)||void 0===r?void 0:r.id;(null==d?void 0:d.read())!==e&&(null==d||d.update((null===(s=t.mainEntity)||void 0===s?void 0:s.action)===u.u.create||null===(l=t.mainEntity)||void 0===l?void 0:l.id))}return Promise.resolve(void 0)},ys={gqlTypeName:"ChatAppViewState",queryFieldName:"chatAppViewState",computedValues:void 0,navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{selectedChatId:null}},ks=({children:e})=>o.createElement(o.Fragment,null,e),Ss=(e,t,n)=>{const i=e.command.correlation.source,{entity:a,command:o}=e;if(a.type===u.p.chats&&o.stateTransition===c.su.new&&o.visibilityState===c.fe.show)return ft.RG.ChatPopOut;if(a.type===u.p.chats&&(a.action===u.u.view||a.action===u.u.default)&&o.visibilityState===c.fe.show&&i!==Ot.D.StandAlone){if(a.id===Co.FX)return ft.RG.NewChat;if(i===Ot.D.ChatListMeetingItem||i===Ot.D.Calendar)return ft.RG.MeetingChatSwitch;const{isFlyoutChat:e}=n.get(K.J.Flyout);if(e)return ft.RG.InlineChatSwitch;const{chatSwitchInPopOut:t}=n.get(K.J.Chat);return t?ft.RG.ChatSwitchPopOut:ft.RG.ChatSwitch}return a.type===u.p.chatContextualSearch&&a.action===u.u.info&&o.visibilityState!==c.fe.hide?ft.RG.ContextualSearchStart:ft.RG.EntityCommand},bs=({coreServices:e,host:t,prevEntityType:n,screenState:i,windowOptions:a})=>{if(n===u.p.chats)return null;const{height:o,minHeight:r,minWidth:s,offset:l,width:d}=gs.windowFeatures||{},c={left:(null==t?void 0:t.screenX)||0,top:(null==t?void 0:t.screenY)||0},m=((null==i?void 0:i.numOpenWindows)||1)*(l||1);return Object.assign(Object.assign({additionalFeatures:{minHeight:`${r}`,minWidth:`${s}`},height:o,left:(null==c?void 0:c.left)+m,minHeight:r,minWidth:s,top:(null==c?void 0:c.top)+m,width:d},(null==e?void 0:e.coreSettings.get(K.J.Core).enableRatioToScreenBasedSizing)&&function(e,t){const{widthToScreenWidthRatio:n,heightToWidthRatio:i}=t||{};if(!e||!i||!n)return{};const a=n*e.screen.availWidth;return{height:a*i,width:a}}(t,gs.windowFeatures)),a)};function Cs(){const e=({deeplinkUrl:e,context:t})=>{const n=t.loggerFactory.newLogger("ChatApp");return((e,t,n)=>{const{pathname:i}=n,{enableInviteLinks:a}=e.get(K.J.InviteLinks);for(const e of Array.from(ss))if(i.startsWith(e)){if(!a){const e="Invite link redemption is disabled for this experience";return t.error(e),Promise.reject(e)}const i=rs[e];if(void 0===i){const e="No Invite link type found for the specified prefixType";return t.error(e),Promise.reject(e)}return ls(n,i)}const o="No DeeplinkPrefixType found for the specified deeplinkUrl";return t.error(o),Promise.reject(o)})(t.coreSettings,n,e)};return{eventHandlers:vs,getAppPhases:Po,getAppViewEntities:Br,getAppViewEntitiesProps:ts,getAppWindowFeatures:bs,getCommandScenarioName:Ss,getPlatformAppIdForEntity:e=>e.type===u.p.chats?"86fcd49b-61a2-4701-b771-54728cd291fb":void 0,manifest:gs,onBeforeAddToNavigation:ps,onBeforeCommandHandled:Eo,onBeforeDeeplinkParsed:[{filter:"/l/claim",execute:e},{filter:"/l/invite/",execute:e},{filter:"/l/chat/0/0",execute:({deeplinkUrl:e,context:{loggerFactory:t,scenarioFactory:n,coreSettings:i}})=>((e,t,n,i)=>{var a;const o=i.newScenario(ft.RG.ExtDeeplinkToChat);if(!e.pathname.startsWith("/l/chat/0/0"))return o.stop({reason:ft.ck.ExtDeeplinkToChatPathNotFound}),n.log("ext_deeplink_to_chat_path_not_found"),Promise.reject("Deeplink to chat path not found");const r=new URLSearchParams(e.search),s=null===(a=r.get("users"))||void 0===a?void 0:a.split(",").map((e=>e.trim())),l=r.get("message"),d=r.get("topicName"),{enableDeepLinkToChat:m}=t.get(K.J.Extensibility);return o.mark(ft.ck.ExtDeeplinkToChatParamsReceived,{userCount:null==s?void 0:s.length,isMessagePresent:!!l,isTopicNamePresent:!!d}),n.log("deeplink_to_chat_qsp_received"),m?Promise.resolve({entityCommand:{entity:{type:u.p.chats,action:u.u.view},command:{visibilityState:c.fe.show,stateTransition:c.su.new},entityOptions:{initialComposeMessage:l,groupName:d,users:s,isViewFromChatDeeplink:!0}},metadata:{allowAnonymous:!1}}):(o.stop({reason:ft.ck.ExtDeeplinkToChatFeatureFlagDisabled,userCount:null==s?void 0:s.length,isMessagePresent:!!l,isTopicNamePresent:!!d}),n.log("ext_deeplink_to_chat_featureflag_disabled"),Promise.reject("Deeplink to chat feature flag is disabled"))})(e,i,t.newLogger("ChatApp_parseChatDeeplink"),n)},{filter:e=>{var t;if(null===(t=e.pathname)||void 0===t?void 0:t.startsWith("/l/message")){const t=new URLSearchParams(e.search).get("context");try{const e=null==t?null:JSON.parse(t);return"chat"===(null==e?void 0:e.contextType)}catch(e){return!1}}return!1},execute:({deeplinkUrl:e,preferredCommandInput:t,context:{loggerFactory:n,scenarioFactory:i,coreSettings:a}})=>((e,t,n,i,a)=>{var o,r;const s=i.newScenario(ft.RG.ExtDeeplinkToChatMessage);if(!e.pathname.startsWith("/l/message"))return s.stop({reason:ft.ck.ExtDeeplinkToChatMessagePathNotFound}),n.log("ext_deeplink_to_chat_message_path_not_found"),Promise.reject("Deeplink to chat message path not found");const l=e.pathname.split("/");if(l.length>3&&!l[3].startsWith(Io.at.SkypeSpacesThread)&&!l[3].startsWith(Io.at.PrivateFeed))return s.stop({reason:ft.ck.ExtDeeplinkToChatMessageTypeNotSupported}),n.log("ext_deeplink_to_chat_message_type_not_supported"),Promise.reject("Deeplink to chat message type not supported");const d=l[3];let m=4<=l.length?l[4]:void 0;m="0"===m?void 0:m,s.mark(ft.ck.ExtDeeplinkToChatMessageParamsReceived),n.log("ext_deeplink_to_chat_message_params_received");const{enableDeepLinkToChatMessage:g}=t.get(K.J.Extensibility);return g?(s.stop({reason:ft.ck.ExtDeeplinkToChatMessageResolved}),n.log("ext_deeplink_to_chat_message_resolved"),Promise.resolve({entityCommand:{entity:{type:u.p.chats,action:u.u.view,id:d},command:{visibilityState:null!==(o=null==a?void 0:a.visibilityState)&&void 0!==o?o:c.fe.show,stateTransition:null!==(r=null==a?void 0:a.stateTransition)&&void 0!==r?r:c.su.new},entityOptions:{messageId:m}},metadata:{allowAnonymous:!1}})):(s.stop({reason:ft.ck.ExtDeeplinkToChatMessageFeatureFlagDisabled}),n.log("ext_deeplink_to_chat_message_featureflag_disabled"),Promise.reject("Deeplink to chat message feature flag is disabled"))})(e,a,n.newLogger("ChatApp_parseChatDeeplink"),i,t)}],onCommandReceived:hs,onPreInit:Or,onPreWarm:Pr,onRegister:e=>{e.registerTask(new Pe)},onViewUpdateCommandResolved:fs,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n,coreSettings:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableEntityMoreInfo:r=!1}=a.get(K.J.Core),{ChatViewsRenderer:s,LPC:c}=yield((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i="chat-app";t("ChunkLoadStarted",{chunkName:i});const{ChatViewsRenderer:a}=yield(0,d.mT)(Mo,i,e),{LPC:o}=n?{LPC:ks}:yield(0,d.mT)(Ro,i,e);return t("ChunkLoadSucceeded",{chunkName:i}),{ChatViewsRenderer:a,LPC:o}})))(n,t,!!r),u=r?ks:yn.p3;return o.createElement(l.f,{namespaces:["calling","chatList","compose","extensibility","files","lightbox","messaging","meetingAnalytics","urlPreview","datepicker"],loaderRenderer:null},o.createElement(c,null,o.createElement(u,null,o.createElement(s,{appRenderMode:e}))))})),viewStateRegistration:ys}}const ws=e=>{if(Ns(e))return Ts(e)?{subNavEntity:Is(e),headerEntity:Es(e),startEntity:As(e),mainEntity:_s(e),endEntity:Ds(e)}:null},Ns=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.coachreport].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},Ts=()=>!0,Is=()=>null,Es=()=>null,As=()=>null,_s=({entity:e})=>e,Ds=()=>null,Fs={id:"com.microsoft.teams.coachreport",name:"CoachReport",supportedEntities:[u.p.coachreport],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.coachreport,action:u.u.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},Ms=()=>Promise.all([n.e(17512),n.e(18861),n.e(287),n.e(47113),n.e(75916),n.e(13228),n.e(91856),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(71154)]).then(n.bind(n,548719)),Rs=()=>Fs.windowFeatures||{};function Ps(){const e=()=>null;return{getAppViewEntities:ws,getAppWindowFeatures:Rs,manifest:Fs,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="coach-report-app";n("ChunkLoadStarted",{chunkName:e});const{CoachReportRenderer:t}=yield(0,d.mT)(Ms,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespaces:["calling","messaging","meetingAnalytics","coachReport"],loaderRenderer:null},o.createElement(t,null))}return o.createElement(e,null)}))}}const Os=e=>xs(e)?{subNavEntity:Ls(e),headerEntity:Us(e),startEntity:Bs(e),mainEntity:js(e),endEntity:Ws(e)}:null,xs=({entity:e})=>{const{type:t}=Object.assign({},e);return t!==u.p.platformstageinactivemeeting},Ls=()=>null,Us=({entity:e})=>e,Bs=()=>null,js=({entity:e})=>e,Ws=({contextEntity:e,entity:t})=>{const n=t.linkedEntity,i=t.options;return n?e||t.type!==u.p.platformStage||n.type!==u.p.chats?null:Object.assign(Object.assign({},n),{action:u.u.view,options:i}):null},Vs={id:"com.microsoft.teams.collab-stage-view",name:"CollabStageViewApp",supportedEntities:[u.p.platformStage,u.p.platformstageinactivemeeting],supportedRenderModes:[s.S.Main,s.S.HorizontalBar],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600,offset:20}},Hs={shouldAddEntitiesToWindowHistory:e=>{var t;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.platformStage},shouldRestoreClientToEntities:e=>{var t;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.platformStage}},$s=({appRenderMode:e,coreSettings:t})=>{const n=new Dt.H,{platformAppCriticalPhaseTimeout:i}=t.get(K.J.Extensibility);switch(e){case s.S.Main:n.registerAppPhase({phase:Ft.nh.CRITICAL,signals:[Ft.GZ.PLATFORM_APP_FRAME_CONTENT_RENDERED],timeout:i||35e3})}return n.appPhases},zs=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(50611),n.e(14576),n.e(62514),n.e(21439),n.e(99352),n.e(51150),n.e(34801),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(79e3),n.e(81433),n.e(31693),n.e(6075),n.e(42256),n.e(26891),n.e(67638),n.e(22568),n.e(82110)]).then(n.bind(n,717377)),Gs=({coreServices:e,host:t,prevEntityType:n,entityType:i,screenState:a,isResize:o})=>{if((n===u.p.platformStage||n===u.p.calls)&&i===u.p.platformStage)return null;const{minHeight:r,minWidth:s,offset:l=1}=Vs.windowFeatures||{},d=null==t?void 0:t.screen;if(o)return Vs.windowFeatures||null;if(!d)return null;let{height:c=1,width:m=1}=((e,t)=>{const{minHeight:n=0,minWidth:i=0}=Vs.windowFeatures||{};let{width:a,height:o}=Vs.windowFeatures||{};if(!t)return{height:o,width:a,minHeight:n,minWidth:i};const{orientation:{type:r}}=e,{landscapeScreenRatio:s,portraitScreenRatio:l,widthHeightRatio:d}=t.coreSettings.get(K.J.Calling);if(s&&l&&d)switch(r){case"landscape-primary":case"landscape-secondary":const t=s*e.availHeight;o=t>n?t:n,a=d*o;break;case"portrait-primary":case"portrait-secondary":const r=l*e.availWidth;a=r>i?r:i,o=1/d*a}return{height:o,width:a}})(d,e);const g=d.availHeight-l,p=m>=d.availWidth||c>=g;p&&(c=d.availHeight,m=d.availWidth);const{left:v,top:h}=((e,t,n,i,a)=>{if(i)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,r="availTop"in e?e.availTop:0,s=o+e.availWidth/2-t/2;let l;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":l=r+a;break;default:l=r+e.availHeight/2-n/2}return{left:s,top:l}})(d,m,c,p,l),f=p?0:((null==a?void 0:a.numOpenWindows)||1)*l;return{additionalFeatures:{minHeight:`${r}`,minWidth:`${s}`},height:c,left:v+f,minHeight:r,minWidth:s,top:h+f,width:m}};function qs(){return{getAppViewEntities:Os,getAppPhases:$s,getAppWindowFeatures:Gs,manifest:Vs,render:({appRenderMode:e,scenarioFactory:t,onRenderEvent:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="collab-stage-view-app";n("ChunkLoadStarted",{chunkName:i});const{StageViewEntry:a}=yield(0,d.mT)(zs,i,t);return o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(a,{appRenderMode:e}))})),onBeforeAddToNavigation:Hs}}const Qs="communities",Js="viewCommunitiesApp",Ys=()=>({actor:Qs,action:Js}),Ks={id:"com.microsoft.teams.communities",name:"CommunitiesApp",actors:[Qs],supportedEntities:[u.p.communities,u.p.communitiesonboarding,u.p.sharecommunitieslink,u.p.reportconcerncommunities,u.p.communitiesaddmember,u.p.communitiesevents,u.p.communitiesguidelinesdialog],supportedRenderModes:[s.S.Main,s.S.HorizontalBar,s.S.Rail,s.S.Modal],getDefaultCommand:()=>({type:u.p.communitiesonboarding,action:u.u.default})},Zs=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("CommunitiesApp onCommandReceived");if(e.command.actor===Qs)switch(n){case Js:return{entity:{type:u.p.communitiesonboarding,action:u.u.default},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at CommunitiesApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by CommunitiesApp.`)}));var Xs=n(963097);const el=e=>{if(tl(e))return nl(e)?{subNavEntity:il(e),headerEntity:al(e),startEntity:ol(e),mainEntity:rl(e),endEntity:sl(e)}:null},tl=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.standard].includes(e),o=[u.p.communities,u.p.communitiesonboarding,u.p.communitiesevents].includes(i),r=n&&[u.u.default,u.u.view,u.u.join].includes(n);return!!(a&&o&&r)},nl=()=>!0,il=({entity:e})=>e.type===u.p.communitiesonboarding?null:e,al=({entity:e})=>e.type===u.p.communitiesonboarding?null:e,ol=()=>null,rl=({entity:e})=>e,sl=()=>null,ll=({areEmptySlotsTransparent:e,coreSettings:t})=>({[L.tF7.subNavEntity]:{[s.S.Rail]:{areSlotShadowsDisabled:!1,isBackgroundTransparent:!!(null==t?void 0:t.get(K.J.Core).enableTransparentLeftRail)||e}},[L.tF7.mainEntity]:{[s.S.Main]:{isColorSchemeDefaultBackground2:!0}}});var dl,cl=n(724648),ul=n(62415),ml=n(200218);!function(e){e.invitecommunity="/l/community/invite",e.message="/l/message",e.community="/l/community"}(dl||(dl={}));const gl=Object.values(dl),pl=gl.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:is.DL.Community})),{}),vl=new Set(gl),hl=(e,t)=>{const n=(0,ml.q)(),i=n?{channelId:n}:null;return Promise.resolve({entityCommand:{entity:Object.assign({type:u.p.communities,action:u.u.join},i?{id:JSON.stringify(i)}:{}),command:{visibilityState:c.fe.show,stateTransition:c.su.forceFlush},entityOptions:{inviteLinkType:t,inviteLinkUrl:e.toString()}},metadata:{allowAnonymous:!1}})};var fl,yl;!function(e){e.NoChannelId="Parsed communities deep link does not contain the channel id",e.NoJoinCode="Parsed communities join link does not contain the join code",e.MinorAccount="Communities use is forbidden for the minor"}(fl||(fl={})),function(e){e.NoChannelId="channel_on_before_deep_link_parsed_no_channel_id_error",e.NoJoinCode="communities_join_no_join_code_failure",e.MinorAccount="channel_on_before_deep_link_parsed_feature_not_enabled_error"}(yl||(yl={}));const kl=(e,t,n)=>Promise.resolve({entityCommand:{entity:{type:u.p.communities,action:u.u.view,id:JSON.stringify({channelId:e,replyChainId:t})},command:{stateTransition:c.su.forceFlush,visibilityState:c.fe.show},entityOptions:{deepLinkId:n}},metadata:{allowAnonymous:!1}}),Sl={filter:dl.message,execute:({deeplinkUrl:e,context:{loggerFactory:t,coreSettings:n}})=>{var i,a;const o=t.newLogger("CommunitiesApp onBeforeDeeplinkParsed"),{pathname:r,search:s}=e;o.log(`Parsing deeplinkUrl - pathname: ${r}, search: ${s}`);const l=r.split("/"),d=l.findIndex((e=>e.startsWith("19:"))),c=new URLSearchParams(s),u=l[d],m=l[d+1],g=c.get("parentMessageId")||void 0;if((0,ul.su)(n))throw null===(i=o.errorToTelemetry)||void 0===i||i.call(o,fl.MinorAccount,yl.MinorAccount),Error(fl.MinorAccount);if(u)return o.log(`toNavigationIntent - channelId: ${u}, messageId: ${m}`),kl(u,g,m);throw null===(a=o.errorToTelemetry)||void 0===a||a.call(o,fl.NoChannelId,yl.NoChannelId),Error(fl.NoChannelId)}},bl=({deeplinkUrl:e,context:t})=>{var n,i;const a=t.loggerFactory.newLogger("CommunitiesApp"),{pathname:o}=e,r=o.split("/")[3];if((0,ul.su)(t.coreSettings))throw null===(n=a.errorToTelemetry)||void 0===n||n.call(a,fl.MinorAccount,yl.MinorAccount),Error(fl.MinorAccount);if(r)return((e,t,n)=>{const{pathname:i}=n,{enableCommunitiesLinkJoin:a}=e.get(K.J.Communities);if(!a){const e="Invite link redemption is disabled for this experience";return t.error(e),Promise.reject(e)}for(const e of Array.from(vl)){const t=pl[e];if(i.startsWith(e)&&t)return hl(n,t)}const o="No DeeplinkPrefixType found for the specified deeplinkUrl";return t.error(o),Promise.reject(o)})(t.coreSettings,a,e);throw null===(i=a.errorToTelemetry)||void 0===i||i.call(a,fl.NoJoinCode,yl.NoJoinCode),Error(fl.NoJoinCode)},Cl=({deeplinkUrl:e,context:t})=>bl({deeplinkUrl:e,context:t}),wl=[Sl,{filter:dl.community,execute:Cl},{filter:dl.invitecommunity,execute:Cl}],Nl={shouldAddEntitiesToWindowHistory:e=>{var t;return(null===(t=e.mainEntity)||void 0===t?void 0:t.type)!==u.p.communitiesonboarding},shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:e=>{const{replyChainId:t}=(0,Xs.jd)((null==e?void 0:e.id)||"");return(null==e?void 0:e.type)===u.p.communities&&(null==e?void 0:e.action)===u.u.view&&!t}},Tl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsCommunitiesToastEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"communitiesToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"reaction"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderMri"}},{kind:"Field",name:{kind:"Name",value:"subtype"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}}]}}]}}]};var Il,El,Al;!function(e){e.Follow="Follow",e.Reply="Reply",e.MentionInCommunity="MentionInCommunity",e.CommunitiesInviteJoined="CommunitiesInviteJoined"}(Il||(Il={})),function(e){e.Person="Person",e.Team="Team"}(El||(El={})),function(e){e.L1="L1",e.L2="L2"}(Al||(Al={}));const _l="new_community_post_toast_header",Dl="community_reply_toast_header",Fl="community_mention_person_toast_header",Ml="community_invite_joined",Rl="communities_toast_event_subscription_job";var Pl=n(326476);const Ol={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesMsaUserProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},xl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};function Ll(e,t,n,a){var o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const r=yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{data:i}=yield e.query({query:Ol,variables:{userId:t,displayName:n,profilePictureSize:Pl.$D.Small}});return i.msaUserProfilePicture}))}(e,n,a);if(!r)return void(null===(o=t.errorToTelemetry)||void 0===o||o.call(t,ri.f.ImageUrlGenerationFailed,Rl,void 0,!0));const s=yield e.query({query:xl,variables:{url:r}});return(null==s?void 0:s.data.toastImageAsDataUri)||void 0}catch(e){return void(null===(r=t.errorToTelemetry)||void 0===r||r.call(t,ri.f.ImageFetchFailed,Rl,void 0,!0))}}))}function Ul(e,{emoji:t,teamName:n,senderDisplayName:i},a){return a.stringTranslate("toastNotifications",e,{emoji:t,senderDisplayName:i,teamName:n})}function Bl(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{conversationId:o,messageId:r,startTimestamp:s,teamName:l,senderMri:d,senderDisplayName:c,type:u,replyChainId:m}=e,g=yield Ll(n,a,d,c||""),p=function(e){switch(e){case Il.Follow:return Al.L1;case Il.Reply:case Il.MentionInCommunity:return Al.L2;default:return Al.L1}}(u),v=m&&p===Al.L2?m:void 0,h=yield function({teamName:e,type:t,senderDisplayName:n,senderGivenName:a,subtype:o},r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=n||a;if(!i)return"";const s={senderDisplayName:i,teamName:e};switch(t){case Il.Follow:return Ul(_l,s,r);case Il.Reply:return Ul(Dl,s,r);case Il.MentionInCommunity:return o===El.Person?Ul(Fl,s,r):"";case Il.CommunitiesInviteJoined:return Ul(Ml,s,r);default:return""}}))}(e,t);return{conversationId:o,quickReply:!1,messageId:r,time:new Date(+s),replyChainId:v,text:l,title:h,mainImage:g?{alt:"",src:g}:void 0,type:u}}))}function jl(e,t,n,a,o,r,s,l,d){const{enableCommandToHostCommService:c}=t.get(K.J.Core);return{id:"communities-toast-event-subscription",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var m,g;const p=a.newLogger("CommunitiesToastEventSubscription");c?(null===(g=p.debugToTelemetry)||void 0===g||g.call(p,"CommunitiesToastEventSubscription Job started",Rl,void 0,!0),n.subscribe({query:Tl,fetchPolicy:"no-cache"}).subscribe(function(e,t,n,a,o,r,s,l,d){const{enableToastCollections:c}=t.get(K.J.Notifications);return t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,m,g,p,v,h;if(t.errors)return void(null===(i=n.errorToTelemetry)||void 0===i||i.call(n,`${ri.f.SubscriptionFailed}`,Rl,void 0,!0));const f=null===(m=null==t?void 0:t.data)||void 0===m?void 0:m.communitiesToastEvent;if(!f)return void(null===(g=n.errorToTelemetry)||void 0===g||g.call(n,ri.f.EmptyEvent,Rl,void 0,!0));const y=a.newScenario(ft.RG.CrossClientToastView,{startTime:+f.startTimestamp});y.clientId=f.correlationId,y.appendEventData({mainEntityType:u.p.communities}),y.mark("get_communities_toast_display_data_started");const k={channelId:f.conversationId,replyChainId:f.replyChainId},S=yield d({id:JSON.stringify(k),type:u.p.communities,action:u.u.view},s);if(y.mark(ft.ck.CrossClientConversationFocusChecked),S)return null===(p=n.debugToTelemetry)||void 0===p||p.call(n,ri.f.ToastSuppressedForWindowInFocus,Rl,void 0,!0),void y.stop({reason:ri.f.ToastSuppressedForWindowInFocus});const b=yield Bl(f,o,s,n);return y.mark("get_communities_toast_display_data_completed"),(null==b?void 0:b.title)?(c&&(b.collectionId=di(e,l,n)),null===(h=a.hoistScenarioToCore)||void 0===h||h.call(a,y),r.toasts.showCommunitiesNotifications(f.correlationId,b)):(y.mark("unhandled_type_in_communities_toast"),null===(v=n.errorToTelemetry)||void 0===v||v.call(n,`${ri.f.UnhandledType} ${f.type}`,Rl,void 0,!0),void y.stop({reason:ri.f.UnhandledType}))}))}(e,t,p,o,r,s,n,l,d))):null===(m=p.debugToTelemetry)||void 0===m||m.call(p,ri.f.NotEnabled,Rl,void 0,!0)}))}}const Wl=({context:{authenticationUser:e,client:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,i18n:o,entityCommanding:r,userTrackingService:s,isEntityInView:l}})=>[jl(e,n,t,i,a,o,r,s,l)],Vl=({action:e,appRenderMode:t,coreSettings:n,type:i})=>{const a=new Dt.H,{enableComposeCriticalPhaseLoad:o=!1}=n.get(K.J.Messaging),{channelPhaseTimeoutSettings:r}=n.get(K.J.TeamsAndChannels),l=[],d=[];switch(t){case s.S.HorizontalBar:Hl({type:i,criticalSignals:l,featureFlags:{},postCriticalSignals:d});break;case s.S.Main:$l({type:i,criticalSignals:l,featureFlags:{enableComposeCriticalPhaseLoad:o},postCriticalSignals:d});break;case s.S.Rail:zl({action:e,criticalSignals:l,postCriticalSignals:d,type:i,featureFlags:{}})}return a.registerAppPhase({phase:Ft.nh.CRITICAL,signals:l,timeout:(null==r?void 0:r.critical)||25e3}),a.registerAppPhase({phase:Ft.nh.POST_CRITICAL,signals:d,timeout:(null==r?void 0:r.postCritical)||1e4}),a.appPhases},Hl=({criticalSignals:e,type:t})=>{t===u.p.communities&&e.push(Ft.GZ.COMMUNITIES_HEADER_RENDERED)},$l=({criticalSignals:e,featureFlags:{enableComposeCriticalPhaseLoad:t},postCriticalSignals:n,type:i})=>{i===u.p.communities&&(e.push(Ft.GZ.MESSAGES_RENDERED),t?e.push(Ft.GZ.COMPOSE_LOADED):n.push(Ft.GZ.COMPOSE_LOADED),n.push(Ft.GZ.MESSAGE_REACTIONS_RENDERED,Ft.GZ.PRESENCES_RENDERED,Ft.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED))},zl=({action:e,criticalSignals:t,type:n})=>{n!==u.p.communities||e!==u.u.view&&e!==u.u.default||t.push(Ft.GZ.CHANNEL_LIST_ITEMS_RENDERED)},Gl=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(68227),n.e(37908),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(88978),n.e(28030),n.e(90883),n.e(87273),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(6482),n.e(94339),n.e(26599),n.e(11965),n.e(1910),n.e(93880),n.e(28974),n.e(75988),n.e(58257),n.e(24998),n.e(23183),n.e(50295),n.e(99826),n.e(86382),n.e(75171),n.e(41219),n.e(40085)]).then(n.bind(n,881778)),ql=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(68227),n.e(37908),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(88978),n.e(28030),n.e(90883),n.e(87273),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(6482),n.e(94339),n.e(26599),n.e(11965),n.e(1910),n.e(93880),n.e(28974),n.e(75988),n.e(58257),n.e(24998),n.e(23183),n.e(50295),n.e(99826),n.e(86382),n.e(75171),n.e(41219),n.e(40085)]).then(n.bind(n,334814)),Ql=(e,t)=>{const{entity:n,command:i}=e,a=i.stateTransition===c.su.flush||i.stateTransition===c.su.forceFlush||i.stateTransition===c.su.new;if(n.type===u.p.communitiesonboarding&&n.action===u.u.default)return ft.RG.CommunitiesAppInitiate;if(n.type===u.p.communities&&n.action===u.u.default)return ft.RG.CommunitiesAppLoad;if(n.type===u.p.communities&&n.action===u.u.view&&i.visibilityState===c.fe.show&&a&&n.id){const e=(0,Xs.jd)(n.id,t);if(e)return i.stateTransition===c.su.new?e.replyChainId?ft.RG.CommunitiesSwitchL2Popout:void 0:e.replyChainId?ft.RG.CommunitiesSwitchL2:ft.RG.CommunitiesSwitchL1}};function Jl(){return{getAppPhases:Vl,getAppViewEntitiesProps:ll,getPlatformAppIdForEntity:e=>e.type===u.p.communities||e.type===u.p.communitiesonboarding?cl.n.communities:void 0,onBeforeAddToNavigation:Nl,getAppViewEntities:el,manifest:Ks,onCommandReceived:Zs,onBeforeDeeplinkParsed:wl,getCommandScenarioName:Ql,render:({appRenderMode:e,onRenderEvent:t})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n="communities-app";t("ChunkLoadStarted",{chunkName:n});const[{CommunitiesAppViews:i},{LPC:a}]=yield Promise.all([(0,d.mT)(Gl,n),(0,d.mT)(ql,n)]);return t("ChunkLoadSucceeded",{chunkName:n}),o.createElement(a,null,o.createElement(yn.p3,null,o.createElement(l.f,{namespace:"communities",loaderRenderer:null},o.createElement(i,{appRenderMode:e}))))})),onPreWarm:Wl}}const Yl={id:"com.microsoft.teams.discover-surface",name:"DiscoverSurfaceApp",supportedEntities:[u.p.discoversurface],supportedRenderModes:[s.S.Main,s.S.Rail,s.S.HorizontalBar],getDefaultCommand:()=>({type:u.p.discoversurface,action:u.u.default})},Kl=e=>{if(Zl(e))return Xl(e)?{subNavEntity:ed(e),headerEntity:td(e),startEntity:nd(e),mainEntity:id(e),endEntity:ad(e)}:null},Zl=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.standard].includes(e),o=n&&[u.u.view,u.u.default].includes(n),r=[u.p.discoversurface].includes(i);return!!(a&&r&&o)},Xl=()=>!0,ed=({coreSettings:e})=>{const{enableHybridChannelList:t}=(null==e?void 0:e.get(K.J.Host))||{};return t?{action:u.u.list,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:null,type:u.p.channels,windowOptions:null}:null},td=({entity:e})=>e,nd=()=>null,id=({entity:e})=>e,ad=()=>null,od=()=>({}),rd=({coreSettings:e})=>{const t=new Dt.H,{criticalPhaseTimeout:n,postCriticalPhaseTimeout:i}=e.get(K.J.DiscoverSurface);return t.registerAppPhase({phase:Ft.nh.CRITICAL,signals:[],timeout:n||25e3}),t.registerAppPhase({phase:Ft.nh.POST_CRITICAL,signals:[],timeout:i||1e4}),t.appPhases};var sd=n(167523);const ld=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(56845),n.e(78998),n.e(45746),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(68227),n.e(59541),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(28030),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(6482),n.e(11965),n.e(1910),n.e(93880),n.e(75988),n.e(58257),n.e(50295),n.e(99826),n.e(96583)]).then(n.bind(n,870098)),dd=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(56845),n.e(78998),n.e(45746),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(68227),n.e(59541),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(28030),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(6482),n.e(11965),n.e(1910),n.e(93880),n.e(75988),n.e(58257),n.e(50295),n.e(99826),n.e(96583)]).then(n.bind(n,334814)),cd="discover-surface-app";function ud(){const e=()=>null;return{manifest:Yl,render:({appRenderMode:t,scenarioFactory:n,onRenderEvent:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){a("ChunkLoadStarted",{chunkName:cd});const[{DiscoverFeed:i,DiscoverSurfaceHeader:r},{LPC:c}]=yield Promise.all([(0,d.mT)(ld,cd,n),(0,d.mT)(dd,cd,n)]);return a("ChunkLoadSucceeded",{chunkName:cd}),t===s.S.Main||t===s.S.HorizontalBar?o.createElement(l.f,{namespaces:["channels","teamsAndChannels","funstuff","discoverSurface"],loaderRenderer:null},t===s.S.Main&&o.createElement(c,null,o.createElement(yn.p3,null,o.createElement(sd.l8,null,o.createElement(i,null)))),t===s.S.HorizontalBar&&o.createElement(r,null)):o.createElement(e,null)})),getAppPhases:rd,getAppViewEntities:Kl,getAppViewEntitiesProps:od}}const md={id:"com.microsoft.teams.esp",name:"EspApp",supportedEntities:[u.p.esp],supportedRenderModes:[s.S.Modal],getDefaultCommand:()=>({type:u.p.esp,action:u.u.default}),windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}};var gd=n(38421);const pd=()=>Promise.all([n.e(51778),n.e(61724),n.e(35874),n.e(66725)]).then(n.bind(n,58057)),vd=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return(0,d.mT)(pd,"esp-engine",e)}));var hd=n(121557),fd=n(224782);class yd{constructor(e,t){this.userBiService=e,this.logger=t.newLogger("esp-bi-telemetry")}recordEspPanelView(e,t,n){var i,a,o;const r=null===(a=null===(i=this.userBiService)||void 0===i?void 0:i.createDatabag)||void 0===a?void 0:a.call(i);r&&(r.identifier=t);const s={panelType:n?Da.wh.EligibleEngagementSurface:Da.wh.DisplayedEngagementSurface,panelRegion:(0,fd.v)(e),dataBag:r};null===(o=this.userBiService)||void 0===o||o.recordPanelView(s,this.logger),r&&r.dispose()}}function kd(e){const{client:t,coreSettings:n,entityCommanding:a,loggerFactory:o,platformService:r,scenarioFactory:s,userBiService:l}=e;return{id:"start-esp",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e;const{enableEsp:d,enableEspAppReadyTrigger:c,enableEspWindowRenderTrigger:u,enableSetFirstLoginInformation:m}=n.get(K.J.Esp);if(m){const n="growth_growthplatform_start_esp_job",a=o.newLogger(n);a.debug("start-esp started");const s=yield(0,hd.I1)(t,a);try{const e=yield function(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientType:i}=null!==(n=null==t?void 0:t.config)&&void 0!==n?n:{},a=i===Ye.Bh.Maglev&&!(null==e?void 0:e.maglev),o=i===Ye.Bh.Web&&!(null==e?void 0:e.WebNorthStar);return a?"maglev":o?"WebNorthStar":void 0}))}(s,r);e&&(yield(0,hd.Zm)(t,e,new Date,s,a))}catch(t){null===(e=a.errorToTelemetry)||void 0===e||e.call(a,"Failed to update first login information",n)}}if(!d||!c||u)return;const g=s.newScenario(ft.RG.EspAppReady);try{const{displayEspSurface:e}=yield vd(s),i=yield e(t,n,o,r,gd.LQ.AppReady,new yd(l,o));if(g.stop(),i){const{entity:{id:e,type:t}}=i;e&&a.esp.launchDialog(e,t)}}catch(e){g.fail()}}))}}function Sd(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:n,coreSettings:i,entityCommanding:a,loggerFactory:o,platformService:r,scenarioFactory:s,userBiService:l}=t,{enableEsp:d,enableEspWindowRenderTrigger:c}=i.get(K.J.Esp);if(!d||!c||"main_window_rendered"!==e.type)return;const u=s.newScenario(ft.RG.EspWindowRender);try{const{displayEspSurface:e}=yield vd(s),t=yield e(n,i,o,r,gd.LQ.AppReady,new yd(l,o));if(u.stop(),t){const{entity:{id:e,type:n}}=t;e&&a.esp.launchDialog(e,n)}}catch(e){u.fail()}}))}const bd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsEspTriggerSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espTriggerEvent"}}]}}]};function Cd(e){const{client:t,coreSettings:n}=e;return{id:"esp-time-based-trigger-job",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableEsp:a,enableTimeBasedEspTrigger:o}=n.get(K.J.Esp);if(!a||!o)return;const r=t.subscribe({query:bd,fetchPolicy:"no-cache"}).subscribe((()=>function(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:t,coreSettings:n,loggerFactory:i,platformService:a,scenarioFactory:o,userBiService:r}=e,s="esp_time_based_trigger_job",l=i.newLogger(s);try{const{displayEspSurface:e}=yield vd(o);yield e(t,n,i,a,gd.LQ.Daily,new yd(r,i)),l.infoToTelemetry?l.infoToTelemetry("Daily Trigger was invoked",s):l.log("Daily Trigger was invoked")}catch(e){l.errorToTelemetry?l.errorToTelemetry("Daily Trigger has an error",s):l.error("Daily Trigger has an error")}}))}(e)));return()=>{r.unsubscribe()}}))}}const wd=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:n,action:i,id:a},entityOptions:o},requestContext:{client:r,coreSettings:s,loggerFactory:l,platformService:d,scenarioFactory:c,userBiService:m}}=e,{enableEsp:g}=s.get(K.J.Esp),p=a||void 0;if(n===u.p.esp&&i===u.u.create){let e;if(g){const t=c.newScenario(ft.RG.EspDisplaySurface);try{const{displayEspSurface:n}=yield vd(c),{forceShow:i,triggerType:a,customParams:u}=o||{};e=yield n(r,s,l,d,a===gd.LQ.FollowUp?gd.LQ.FollowUp:gd.LQ.Manual,new yd(m,l),{surfaceId:p,forceShow:i,customParams:u}),t.stop({surfaceId:p})}catch(e){t.fail({surfaceId:p})}}return e}return t})),Nd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsEspSyntheticNotificationToastSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"syntheticNotificationToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderId"}},{kind:"Field",name:{kind:"Name",value:"subtype"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"campaignType"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}}]}}]}}]},Td={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEspToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};var Id;function Ed(e){const{client:t,coreSettings:n,i18n:a,entityCommanding:o,loggerFactory:r}=e;return{id:"esp-synthetic-notification-toast-subscription-job",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableEsp:e,enableSyntheticNotificationToast:s}=n.get(K.J.Esp);if(!e||!s)return;const l=t.subscribe({query:Nd,fetchPolicy:"no-cache"}).subscribe(function(e,t,n,a){return o=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i;const r=n.newLogger("SyntheticNotificationToastEventSubscription");if(o.errors){const e=(0,Ci.u4)(o.errors.map((e=>e.message)).join());return void r.error(`${ri.f.SubscriptionFailed} ${e}`)}if(!(null===(i=o.data)||void 0===i?void 0:i.syntheticNotificationToastEvent))return void r.error(ri.f.EmptyEvent);const{syntheticNotificationToastEvent:s}=o.data,l=function(e,t,n){var i;return{conversationId:t.messageId,messageId:t.messageId,quickReply:!1,time:new Date(+t.timestamp),text:Ad(e,t,"description",n),title:Ad(e,t,"title",n),type:"SyntheticNotification",campaignType:null!==(i=t.campaignType)&&void 0!==i?i:void 0}}(t,s,r),d=yield _d(a,r,s.imageUrl||void 0);return d&&(l.mainImage={alt:"",src:d}),e.toasts.showEspSyntheticNotification(s.correlationId,l)}))}(o,a,r,t));return()=>{l.unsubscribe()}}))}}function Ad(e,t,n,i){const a=(()=>{switch(t.campaignType){case Id.meeting:return`activity_esp_meeting_recommendation_${n}`;case Id.chat:return`activity_esp_chat_recommendation_${n}`;case Id.upgrade:return`activity_esp_upgrade_recommendation_${n}`;default:return void i.error(`Campaign Type is not valid ${t.campaignType}`)}})();return a?e.stringTranslate("activity",a):""}!function(e){e.chat="chatCampaign",e.meeting="meetingCampaign",e.upgrade="upgradeCampaign"}(Id||(Id={}));const _d=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(n)try{const t=yield e.query({query:Td,fetchPolicy:"no-cache",variables:{url:n}});return(null==t?void 0:t.data.toastImageAsDataUri)||void 0}catch(e){return void t.error(ri.f.ImageFetchFailed)}}));class Dd{constructor(e,t,n,a,o,r,s){this.logger=n,this.entityCommanding=a,this.parseExpression=o,this.displaySurface=s;const l=t.getObservable(K.J.Esp);this.biSurfaces=this.toBiSurfaces(e),this.configSubscription=l.subscribe((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{surfaces:e}=yield r();this.biSurfaces=this.toBiSurfaces(e)}))))}onSignal(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=this.biSurfaces.filter((t=>t.invoke(e))).map((e=>e.id));if(!t.length)return;const n=e.data["Panel.WindowID"],i=yield this.displaySurface(t,n);if(i){const{entity:{id:e,type:t}}=i;e&&this.entityCommanding.esp.launchDialog(e,t)}}))}unsubscribe(){this.configSubscription.unsubscribe()}toBiSurfaces(e){return e.filter((e=>-1===e.recur||e.recur>e.displayed.length)).filter((e=>e.trigger===gd.LQ.BIEvent)).map((e=>{try{const t=this.parseExpression(e.triggerFilter||"");return{id:e.id,invoke:e=>t.evaluate(e)}}catch(t){return void this.logger.error(`invalid BITrigger trigger filter value for surface ${e.id} with triggerFilter ${e.triggerFilter}`)}})).filter((e=>!!e))}}const Fd=[{action:"ShareFile",expression:"eventName == 'panelaction' && data['Panel.Type'] =~ 'channel' && data['DataBag.attachments'] > 0"}],Md={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsEspRecordCompletedActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actions"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recordEspCompletedActions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"actions"},value:{kind:"Variable",name:{kind:"Name",value:"actions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"completedActions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}}]}}]};var Rd=n(628033);class Pd{constructor(e,t,n,i,a){this.client=i,this.coreSettings=a;const o=e.userState.completedActions.reduce(((e,t)=>e.add(t.action)),new Set);this.actionRegistrations=Fd.filter((e=>!o.has(e.action))).map((e=>{try{const t=n(e.expression);return{action:e.action,invoke:e=>t.evaluate(e)}}catch(n){return void t.error(`invalid data registration expression for action ${e.action} with expression ${e.expression}`)}})).filter((e=>!!e))}onSignal(e){const t=this.actionRegistrations.filter((t=>t.invoke(e))).map((e=>e.action));if(t.length){this.actionRegistrations=this.actionRegistrations.filter((e=>-1===t.indexOf(e.action)));const{enableEspStateApolloCache:e}=this.coreSettings.get(K.J.Esp);this.client.mutate({mutation:Md,variables:{actions:t},refetchQueries:e?[{query:Rd.$,fetchPolicy:"no-cache"}]:void 0})}}}class Od{onSignal(e){}unsubscribe(){}}function xd(e){const{coreSettings:t,userBiService:n,scenarioFactory:a,client:o,loggerFactory:r,platformService:s,entityCommanding:l}=e;return{id:"esp-signal-handler-job",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e;const{enableEsp:d,enableEspBiEventTrigger:c,enableEspCompletedActions:u}=t.get(K.J.Esp);if(!d)return;if(!c&&!u)return;const{getConfig:m,parseExpression:g,displayEspSurface:p}=yield vd(a),v=r.newLogger("esp-signal-handler-job"),{surfaces:h,espState:f}=yield m(o,t,v),y=c?new Dd(h,t,v,l,g,(()=>m(o,t,v)),((e,i)=>p(o,t,r,s,gd.LQ.BIEvent,new yd(n,r),{surfaceIds:e},i))):new Od,k=u?new Pd(f,v,g,o,t):new Od,S=null===(e=null==n?void 0:n.observe)||void 0===e?void 0:e.call(n).subscribe({next:e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){k.onSignal(e),y.onSignal(e)}))});return()=>{null==S||S.unsubscribe(),y.unsubscribe()}}))}}const Ld=()=>Promise.all([n.e(47113),n.e(13228),n.e(2765),n.e(91104),n.e(33944),n.e(49736)]).then(n.bind(n,336714));function Ud(){const e=()=>null;return{manifest:md,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Modal){const e="esp-dialog";n("ChunkLoadStarted",{chunkName:e});const{EspDialogComponent:t}=yield(0,d.mT)(Ld,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)})),onPreWarm:e=>{const{context:t}=e;return[kd(t),Cd(t),Ed(t),xd(t)]},onBeforeCommandHandled:wd,UNSAFE_onSignal:Sd}}const Bd={id:"com.microsoft.teams.filePicker",name:"FilePickerApp",supportedEntities:[u.p.filepicker],supportedRenderModes:[s.S.Modal]},jd=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(61130),n.e(79058),n.e(83505),n.e(7983),n.e(1839),n.e(19570),n.e(14768),n.e(33235),n.e(84005),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(68865),n.e(94333),n.e(98935),n.e(2205),n.e(58163),n.e(79825),n.e(47936),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(64891),n.e(34814),n.e(78290),n.e(43806),n.e(6482),n.e(88204),n.e(43164),n.e(70450),n.e(68123)]).then(n.bind(n,214009));function Wd(){const e=()=>null;return{manifest:Bd,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a,loggerFactory:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=r.newLogger("FilePickerApp");if(t===s.S.Modal){const e="file-picker-app";i.log("chunk load start"),n("ChunkLoadStarted",{chunkName:e}),i.log("experimental import start");const{FilePickerComposeDialogRenderer:t}=yield(0,d.mT)(jd,e,a);return i.log("report chunk load success"),n("ChunkLoadSucceeded",{chunkName:e}),i.log("Rendering file picker compose dialog"),o.createElement(t,null)}return o.createElement(e,null)}))}}const Vd={id:"com.microsoft.teams.files",name:"FilesApp",supportedEntities:[u.p.file],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.file,action:u.u.error}),windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Hd=({appRenderMode:e,coreSettings:t})=>{const n=new Dt.H,{criticalPhaseTimeout:i,postCriticalPhaseTimeout:a}=t.get(K.J.Files),o=[];switch(e){case s.S.Main:o.push(Ft.GZ.P2P_FILES_LIST_VIEW_RENDERED)}return n.registerAppPhase({phase:Ft.nh.CRITICAL,signals:o,timeout:i||1e4}),n.registerAppPhase({phase:Ft.nh.POST_CRITICAL,signals:[],timeout:a||1e4}),n.appPhases},$d=({entity:e})=>e.type===u.p.file&&e.action===u.u.list?ft.RG.P2PFilesListSwitch:ft.RG.FilesAppSwitch,zd=e=>{if(Gd(e))return qd(e)?{subNavEntity:Qd(e),headerEntity:Jd(e),startEntity:Yd(e),mainEntity:Kd(e),endEntity:Zd(e)}:null},Gd=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=i===u.p.file,r=n&&[u.u.list,u.u.error].includes(n);return!!(a&&o&&r)},qd=()=>!0,Qd=()=>null,Jd=()=>null,Yd=()=>null,Kd=({entity:e})=>e,Zd=()=>null,Xd={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case un.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:vn(i)})}return Promise.resolve(void 0)}},ec=()=>Promise.all([n.e(17512),n.e(287),n.e(70724),n.e(47113),n.e(15803),n.e(35235),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(79058),n.e(25430),n.e(51778),n.e(61724),n.e(62514),n.e(58016),n.e(68865),n.e(94333),n.e(98935),n.e(15370),n.e(5592),n.e(84395),n.e(81433),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(64891),n.e(34814),n.e(43806),n.e(88369),n.e(5892),n.e(59139)]).then(n.bind(n,862354)),tc=()=>Promise.all([n.e(17512),n.e(287),n.e(70724),n.e(47113),n.e(15803),n.e(35235),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(79058),n.e(25430),n.e(51778),n.e(61724),n.e(62514),n.e(58016),n.e(68865),n.e(94333),n.e(98935),n.e(15370),n.e(5592),n.e(84395),n.e(81433),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(64891),n.e(34814),n.e(43806),n.e(88369),n.e(5892),n.e(59139)]).then(n.bind(n,334814));function nc(){const e=()=>null,t="apps-files",n={chunkName:t};return{eventHandlers:Xd,getAppPhases:Hd,getAppViewEntities:zd,getCommandScenarioName:$d,manifest:Vd,render:({appRenderMode:a,coreSettings:r,onRenderEvent:s,scenarioFactory:l,entity:c})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(c.type===u.p.file&&c.action===u.u.list){s("ChunkLoadStarted",n);const{enableEntityMoreInfo:e}=r.get(K.J.Core),i=({children:e})=>o.createElement(o.Fragment,null,e),{P2PFilesListViewsRenderer:c}=yield(0,d.mT)(ec,t,l),{LPC:u}=e?{LPC:i}:yield(0,d.mT)(tc,t,l),m=e?i:yn.p3;return s("ChunkLoadSucceeded",n),o.createElement(u,null,o.createElement(m,null,o.createElement(c,{appRenderMode:a})))}return o.createElement(e,null)}))}}const ic={id:"com.microsoft.teams.filesoneupviewer",name:"FilesoneupviewerApp",supportedEntities:[u.p.filesoneupviewer],supportedRenderModes:[s.S.HorizontalBar,s.S.Main]},ac=e=>{if(oc(e))return rc(e)?{subNavEntity:sc(e),headerEntity:lc(e),startEntity:dc(e),mainEntity:cc(e),endEntity:uc(e)}:null},oc=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.filesoneupviewer].includes(i),r=n&&[u.u.view].includes(n);return!!(a&&o&&r)},rc=()=>!0,sc=({entity:e,layoutMode:t})=>t===c.lO.focus?null:e,lc=({entity:e})=>e,dc=()=>null,cc=({entity:e})=>e,uc=()=>null,mc=()=>Promise.all([n.e(17512),n.e(27284),n.e(95037)]).then(n.bind(n,609885));function gc(){return{getAppViewEntities:ac,manifest:ic,render:({appRenderMode:e,onRenderEvent:t})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n="files-viewer-oneup";t("ChunkLoadStarted",{chunkName:n});const[{FilesViewerOneupViewsRenderer:i}]=yield Promise.all([(0,d.mT)(mc,n)]);return t("ChunkLoadSucceeded",{chunkName:n}),o.createElement(i,{appRenderMode:e})}))}}const pc={id:"com.microsoft.teams.freemium-upgrade",name:"FreemiumUpgradeApp",supportedEntities:[u.p.freemiumupgrade],supportedRenderModes:[s.S.Main]},vc=()=>Promise.all([n.e(18861),n.e(2213),n.e(77233)]).then(n.bind(n,116057));function hc(){const e=()=>null;return{manifest:pc,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="freemium-upgrade";n("ChunkLoadStarted",{chunkName:e});const{FreemiumUpgradeNotification:t}=yield(0,d.mT)(vc,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)}))}}const fc={id:"com.microsoft.teams.gallery",name:"GalleryApp",supportedEntities:[u.p.gallery],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.gallery,action:u.u.view}),windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},yc=e=>{if(kc(e))return Sc(e)?{subNavEntity:bc(e),headerEntity:Cc(e),startEntity:wc(e),mainEntity:Nc(e),endEntity:Tc(e)}:null},kc=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.gallery].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},Sc=()=>!0,bc=()=>null,Cc=()=>null,wc=()=>null,Nc=({entity:e})=>e,Tc=()=>null,Ic=()=>Promise.all([n.e(50633),n.e(84029),n.e(88978),n.e(18524),n.e(51909),n.e(19753)]).then(n.bind(n,639499));function Ec(){const e=()=>null;return{getAppViewEntities:yc,manifest:fc,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="gallery-app";n("ChunkLoadStarted",{chunkName:e});const{Gallery:t}=yield(0,d.mT)(Ic,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)}))}}const Ac={id:"com.microsoft.teams.guardians",name:"GuardiansApp",supportedEntities:[u.p.guardians],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},_c=e=>{if(Dc(e))return Fc(e)?{subNavEntity:Mc(e),headerEntity:Rc(e),startEntity:Pc(e),mainEntity:Oc(e),endEntity:xc(e)}:null},Dc=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.guardians].includes(i),r=n&&[u.u.list].includes(n);return!!(a&&o&&r)},Fc=()=>!0,Mc=({entity:e,layoutMode:t})=>t===c.lO.focus?null:e,Rc=({entity:e})=>e,Pc=()=>null,Oc=({entity:e})=>e,xc=()=>null,Lc={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case un.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:vn(i)})}return Promise.resolve(void 0)}},Uc=({appRenderMode:e})=>{const t=new Dt.H,n=[],i=[];switch(e){case s.S.Main:Bc({criticalSignals:n,postCriticalSignals:i,featureFlags:{}});break;case s.S.HorizontalBar:case s.S.Rail:}return t.registerAppPhase({phase:Ft.nh.CRITICAL,signals:n,timeout:3e4}),t.appPhases},Bc=({criticalSignals:e})=>{e.push(Ft.GZ.GUARDIANS_APP_RENDERED)},jc=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(68227),n.e(1461),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(88978),n.e(28030),n.e(44669),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(6482),n.e(26599),n.e(11965),n.e(1910),n.e(93880),n.e(28974),n.e(75988),n.e(58257),n.e(24998),n.e(50295),n.e(99826),n.e(75171),n.e(32731),n.e(29861)]).then(n.bind(n,796767)),Wc=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(68227),n.e(1461),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(88978),n.e(28030),n.e(44669),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(6482),n.e(26599),n.e(11965),n.e(1910),n.e(93880),n.e(28974),n.e(75988),n.e(58257),n.e(24998),n.e(50295),n.e(99826),n.e(75171),n.e(32731),n.e(29861)]).then(n.bind(n,334814));function Vc(){return{eventHandlers:Lc,getAppPhases:Uc,getAppViewEntities:_c,getCommandScenarioName:()=>ft.RG.GuardiansAppLoad,manifest:Ac,render:({appRenderMode:e,coreSettings:t,onRenderEvent:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="guardians-app";n("ChunkLoadStarted",{chunkName:i});const{enableEntityMoreInfo:a}=t.get(K.J.Core),r=({children:e})=>o.createElement(o.Fragment,null,e),{GuardiansAppViews:s}=yield(0,d.mT)(jc,i),{LPC:l}=a?{LPC:r}:yield(0,d.mT)(Wc,i),c=a?r:yn.p3;return n("ChunkLoadSucceeded",{chunkName:i}),o.createElement(l,null,o.createElement(c,null,o.createElement(s,{appRenderMode:e})))}))}}const Hc={id:"com.microsoft.teams.hybrid",name:"HybridApp",supportedEntities:[u.p.blank],supportedRenderModes:[s.S.Main]},$c=e=>{if(zc(e))return Gc(e)?{subNavEntity:qc(e),headerEntity:Qc(e),startEntity:Jc(e),mainEntity:Yc(e),endEntity:Kc(e)}:null},zc=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.standard].includes(e),o={[u.p.blank]:[u.u.default,u.u.view]},r=n&&(o[i]||[]).includes(n);return!(!a||!r)},Gc=()=>!0,qc=()=>null,Qc=()=>null,Jc=()=>null,Yc=({entity:e})=>e,Kc=()=>null,Zc=({areEmptySlotsTransparent:e})=>({[L.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:e}}});function Xc(){const e=()=>null;return{getAppViewEntities:$c,getAppViewEntitiesProps:Zc,manifest:Hc,render:({onRenderEvent:t,entity:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return t("CriticalInitRender",{isBlanked:n.type===u.p.blank}),o.createElement(e,null)}))}}const eu={id:"com.microsoft.teams.linkedin",name:"LinkedInApp",supportedEntities:[u.p.linkedin],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},tu=e=>{if(nu(e))return iu(e)?{subNavEntity:au(e),headerEntity:ou(e),startEntity:ru(e),mainEntity:su(e),endEntity:lu(e)}:null},nu=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.linkedin].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view].includes(n);return!!(a&&o&&r)},iu=()=>!0,au=({entity:e,layoutMode:t})=>t===c.lO.focus?null:e,ou=({entity:e})=>e,ru=()=>null,su=({entity:e})=>e,lu=()=>null,du=()=>Promise.all([n.e(48177),n.e(51494),n.e(50840),n.e(82998),n.e(35444),n.e(33586)]).then(n.bind(n,658877));function cu(){const e=()=>null;return{getAppViewEntities:tu,manifest:eu,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="apps-linkedin";n("ChunkLoadStarted",{chunkName:e});const{LinkedIn:t}=yield(0,d.mT)(du,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)}))}}const uu="meet",mu="viewMeetApp",gu=()=>({actor:uu,action:mu}),pu={id:"com.microsoft.teams.meet",name:"MeetApp",actors:[uu],supportedEntities:[u.p.meet],supportedRenderModes:[s.S.Main]},vu=e=>{if(hu(e))return fu(e)?{subNavEntity:yu(e),headerEntity:ku(e),startEntity:Su(e),mainEntity:bu(e),endEntity:Cu(e)}:null},hu=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.meet].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},fu=()=>!0,yu=()=>null,ku=()=>null,Su=()=>null,bu=({entity:e})=>e,Cu=()=>null,wu=()=>({[L.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0}}}),Nu={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case un.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:vn(i)})}return Promise.resolve(void 0)}},Tu=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("MeetApp onCommandReceived");if(e.command.actor===uu)switch(n){case mu:return{entity:{type:u.p.meet,action:u.u.default},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at MeetApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by MeetApp.`)})),Iu=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(61130),n.e(79058),n.e(83505),n.e(7983),n.e(1839),n.e(19570),n.e(14768),n.e(33235),n.e(84005),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(68865),n.e(94333),n.e(98935),n.e(2205),n.e(58163),n.e(79825),n.e(47936),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(64891),n.e(34814),n.e(78290),n.e(43806),n.e(6482),n.e(88204),n.e(43164),n.e(70450),n.e(68123)]).then(n.bind(n,691311)),Eu=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(61130),n.e(79058),n.e(83505),n.e(7983),n.e(1839),n.e(19570),n.e(14768),n.e(33235),n.e(84005),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(68865),n.e(94333),n.e(98935),n.e(2205),n.e(58163),n.e(79825),n.e(47936),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(64891),n.e(34814),n.e(78290),n.e(43806),n.e(6482),n.e(88204),n.e(43164),n.e(70450),n.e(68123)]).then(n.bind(n,334814));function Au(){const e=()=>null;return{eventHandlers:Nu,getAppViewEntities:vu,getAppViewEntitiesProps:wu,getPlatformAppIdForEntity:e=>e.type===u.p.meet?"957ed0e3-e5ca-4c82-9676-fd037185c4d8":void 0,manifest:pu,onCommandReceived:Tu,render:({appRenderMode:t,coreSettings:n,onRenderEvent:a,scenarioFactory:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="meet-app";a("ChunkLoadStarted",{chunkName:e});const{enableEntityMoreInfo:t}=n.get(K.J.Core),i=({children:e})=>o.createElement(o.Fragment,null,e),{Meet:s}=yield(0,d.mT)(Iu,e,r),{LPC:l}=t?{LPC:i}:yield(0,d.mT)(Eu,e,r),c=t?i:yn.p3;return a("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l,null,o.createElement(c,null,o.createElement(s,null)))}return o.createElement(e,null)})),getCommandScenarioName:_u}}const _u=()=>ft.RG.MeetAppLaunch,Du=e=>{if(Fu(e))return Mu(e)?{subNavEntity:Ru(e),headerEntity:Pu(e),startEntity:Ou(e),mainEntity:xu(e),endEntity:Lu(e)}:null},Fu=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.attendancereport,u.p.meetinganalytics].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},Mu=()=>!0,Ru=()=>null,Pu=()=>null,Ou=()=>null,xu=({entity:e})=>e,Lu=()=>null,Uu={id:"com.microsoft.teams.meetinganalytics",name:"MeetingAnalytics",supportedEntities:[u.p.attendancereport,u.p.meetinganalytics],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.meetinganalytics,action:u.u.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},Bu=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(10440),n.e(19312),n.e(51778),n.e(61724),n.e(62514),n.e(38393),n.e(21767),n.e(33876),n.e(51951),n.e(15370),n.e(5592),n.e(46263),n.e(78290),n.e(85474),n.e(98368)]).then(n.bind(n,36889)),ju=()=>Uu.windowFeatures||{};function Wu(){const e=()=>null;return{getAppViewEntities:Du,getAppWindowFeatures:ju,manifest:Uu,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="meeting-analytics-app";n("ChunkLoadStarted",{chunkName:e});const{MeetingAnalyticsRenderer:t}=yield(0,d.mT)(Bu,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespaces:["meetingAnalytics"],loaderRenderer:null},o.createElement(t,null))}return o.createElement(e,null)}))}}const Vu={getDefaultCommand:()=>({type:u.p.meetings,action:u.u.view}),id:"com.microsoft.teams.meeting-options",name:"MeetingOptionsApp",supportedRenderModes:[s.S.Main,s.S.Modal],supportedEntities:[u.p.meetings,u.p.meetingsettings,u.p.licenses,u.p.meetingoptionscreatedialog],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Hu=e=>{if($u(e))return zu(e)?{subNavEntity:Gu(e),headerEntity:qu(e),startEntity:Qu(e),mainEntity:Ju(e),endEntity:Yu(e)}:null},$u=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.meetings,u.p.meetingsettings,u.p.licenses,u.p.meetingoptionscreatedialog].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},zu=()=>!0,Gu=()=>null,qu=()=>null,Qu=()=>null,Ju=({entity:e})=>e,Yu=()=>null,Ku=()=>({[L.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!0}}}),Zu=()=>Promise.all([n.e(70197),n.e(17512),n.e(18861),n.e(287),n.e(47113),n.e(35235),n.e(75916),n.e(35799),n.e(22681),n.e(34983),n.e(91768),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(54489),n.e(84395),n.e(54684),n.e(75558)]).then(n.bind(n,40155));function Xu(){return{getAppViewEntities:Hu,getAppViewEntitiesProps:Ku,manifest:Vu,onRegister:e=>{e.registerTask(new Pe)},render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="meeting-options-app";t("ChunkLoadStarted",{chunkName:i});const{MeetingOptions:a}=yield(0,d.mT)(Zu,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(em,{scenarioFactory:n},o.createElement(a,{appRenderMode:e}))}))}}const em=({scenarioFactory:e,children:t})=>(tm(e),o.createElement(o.Fragment,null,t)),tm=e=>{const t=o.useRef(e.findScenario(ft.RG.MeetingOptionsStart));o.useEffect((()=>{t.current||(t.current=e.cancelExistingAndCreateScenario(ft.RG.MeetingOptionsStart,"remount"))}),[e])},nm=e=>{if(im(e))return am(e)?{subNavEntity:om(e),headerEntity:rm(e),startEntity:sm(e),mainEntity:lm(e),endEntity:dm(e)}:null},im=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.meetingrecap].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},am=()=>!0,om=()=>null,rm=()=>null,sm=()=>null,lm=({entity:e})=>e,dm=({contextEntity:e})=>e&&e.action&&e.type===u.p.meetingcollaboration?e:null,cm={id:"com.microsoft.teams.meeting-recap",name:"MeetingRecap",supportedEntities:[u.p.meetingrecap],supportedRenderModes:[s.S.Main],getDefaultCommand:()=>({type:u.p.meetingrecap,action:u.u.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},um=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(79058),n.e(83505),n.e(14722),n.e(10344),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(94333),n.e(98935),n.e(89962),n.e(16087),n.e(44346),n.e(61333),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(64891),n.e(34814),n.e(78290),n.e(88204),n.e(50468),n.e(92473),n.e(70450),n.e(85894),n.e(57960)]).then(n.bind(n,260115)),mm=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(79058),n.e(83505),n.e(14722),n.e(10344),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(94333),n.e(98935),n.e(89962),n.e(16087),n.e(44346),n.e(61333),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(84577),n.e(64891),n.e(34814),n.e(78290),n.e(88204),n.e(50468),n.e(92473),n.e(70450),n.e(85894),n.e(57960)]).then(n.bind(n,334814)),gm=()=>cm.windowFeatures||{};function pm(){const e=()=>null;return{getAppViewEntities:nm,getAppWindowFeatures:gm,manifest:cm,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a,coreSettings:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(a.cancelExistingAndCreateScenario(ft.RG.MrNavigateSkeleton,"abandon",1e4),t===s.S.Main){const{MeetingRecapRenderer:e}=yield((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n="meeting-recap-app";t("ChunkLoadStarted",{chunkName:n});const[{MeetingRecapRenderer:i},{LPC:a}]=yield Promise.all([(0,d.mT)(um,n,e),(0,d.mT)(mm,n,e)]);return t("ChunkLoadSucceeded",{chunkName:n}),{MeetingRecapRenderer:i,LPC:a}})))(a,n),{enableEntityMoreInfo:t}=r.get(K.J.Core),s=({children:e})=>o.createElement(o.Fragment,null,e),{LPC:c}=t?{LPC:s}:yield(0,d.mT)(mm,"meeting-recap-app",a),u=t?s:yn.p3;return o.createElement(l.f,{namespaces:["meetingAnalytics","meetingRecap"],loaderRenderer:null},o.createElement(c,null,o.createElement(u,null,o.createElement(e,null))))}return o.createElement(e,null)}))}}const vm={id:"com.microsoft.teams.meeting-room-console",name:"MeetingRoomConsoleApp",supportedEntities:[u.p.meetingroomconsolecall,u.p.meetingroomallinone],supportedRenderModes:[s.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},hm=e=>{if(fm(e))return ym(e)?{subNavEntity:km(e),headerEntity:Sm(e),startEntity:bm(e),mainEntity:Cm(e),endEntity:wm(e)}:null},fm=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.meetingroomconsolecall,u.p.meetingroomallinone].includes(i),r=n&&[u.u.default,u.u.view,u.u.share].includes(n);return!!(a&&o&&r)},ym=()=>!0,km=()=>null,Sm=()=>null,bm=()=>null,Cm=({entity:e})=>e,wm=()=>null,Nm=()=>Promise.all([n.e(72865),n.e(39319),n.e(34249)]).then(n.bind(n,739282));function Tm(){const e=()=>null;return{getAppViewEntities:hm,manifest:vm,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="meeting-room-console-app";n("ChunkLoadStarted",{chunkName:e});const{MeetingRoomEntry:t}=yield(0,d.mT)(Nm,e,a);return o.createElement(t,null)}return o.createElement(e,null)}))}}const Im={id:"com.microsoft.teams.meeting-room-front-of-room",name:"MeetingRoomFrontOfRoomApp",supportedEntities:[u.p.meetingroomfrontofroom,u.p.meetingroomfrontofroomcontent,u.p.meetingroomfrontofroomgallery],supportedRenderModes:[s.S.Main]},Em=e=>{if(Am(e))return _m(e)?{subNavEntity:Dm(e),headerEntity:Fm(e),startEntity:Mm(e),mainEntity:Rm(e),endEntity:Pm(e)}:null},Am=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.meetingroomfrontofroom,u.p.meetingroomfrontofroomcontent,u.p.meetingroomfrontofroomgallery].includes(i),r=n&&[u.u.create].includes(n);return!!(a&&o&&r)},_m=()=>!0,Dm=()=>null,Fm=()=>null,Mm=()=>null,Rm=({entity:e})=>e,Pm=()=>null,Om=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(41520),n.e(62514),n.e(21439),n.e(17896),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(81433),n.e(31693),n.e(6075),n.e(42256),n.e(26891),n.e(16550),n.e(240)]).then(n.bind(n,65810));function xm(){const e=()=>null;return{getAppViewEntities:Em,manifest:Im,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="meeting-room-front-of-room-app";n("ChunkLoadStarted",{chunkName:e});const{MeetingRoomFrontOfRoomEntry:t}=yield(0,d.mT)(Om,e,a);return o.createElement(t,null)}return o.createElement(e,null)}))}}var Lm=n(786152);const Um=(e,t,n,i,a,o,r,s)=>{var l,d;return{entity:{type:u.p.extensions,id:JSON.stringify({appId:e,tabEntityId:i,subEntityId:o}),action:u.u.view},command:{visibilityState:null!==(l=null==a?void 0:a.visibilityState)&&void 0!==l?l:c.fe.show,stateTransition:t?c.su.new:null!==(d=null==a?void 0:a.stateTransition)&&void 0!==d?d:c.su.flush,correlation:{source:null!=n?n:Ot.D.Unknown,startTimestamp:Date.now()}},entityOptions:{entryPoint:Lm.mQ.personalApp,isMultiWindow:t,subEntityId:o,isAppSelected:r,source:n,deeplinkStartedTime:s?Date.now():void 0}}},Bm="/l/entity",jm={[Bm]:is.DL.PlatformExtension},Wm=e=>{const{pathname:t,search:n}=e,i=new URLSearchParams(n),a=i.get("context"),o=i.get("tenantId"),r=a&&JSON.parse(a),s=null==r?void 0:r.channelId,l=null==r?void 0:r.chatId,d=null==t?void 0:t.split(/[/?&]/),c=null==d?void 0:d.indexOf("entity");return{tenantId:o,appId:null==d?void 0:d[c+1],entityId:null==d?void 0:d[c+2],channelId:s,chatId:l,deeplinkContext:r,pathname:t}},Vm=new Set([Bm]),Hm=(e,t,n,i,a,o,r)=>{null==o||o.mark("create_deeplink_command"),i.log(`create_deeplink_command with appId: ${e} tabEntityId:${t} context: ${n}`);const s=(null==n?void 0:n.channelId)?((e,t,n,i,a)=>{var o,r;return{entity:{type:u.p.extensions,id:JSON.stringify({appId:e,threadId:t,tabId:null,tabEntityId:n}),action:u.u.view,linkedEntity:{id:JSON.stringify({channelId:t}),type:u.p.channels,action:u.u.view}},command:{visibilityState:null!==(o=null==i?void 0:i.visibilityState)&&void 0!==o?o:c.fe.show,stateTransition:null!==(r=null==i?void 0:i.stateTransition)&&void 0!==r?r:c.su.forceFlush,correlation:{source:Ot.D.PlatformTabDeepLink,startTimestamp:Date.now()}},entityOptions:{entryPoint:Lm.mQ.channelTab,source:Ot.D.PlatformTabDeepLink,subEntityId:a,deeplinkStartedTime:Date.now()}}})(e,n.channelId,t,a,null==n?void 0:n.subEntityId):Um(e,!1,Ot.D.PlatformPersonalAppDeepLink,void 0,a,null==n?void 0:n.subEntityId,void 0,!0),l={entityCommand:Object.assign({},s),metadata:{allowAnonymous:!1,tenantId:null!=r?r:void 0}};return null==o||o.mark("return_deeplink_command"),null==o||o.appendEventData({"PlatformTabDeeplink.generatedCommand":l.toString()}),Promise.resolve(l)},$m=()=>n.e(22463).then(n.bind(n,478920)),zm=[{filter:e=>{const{appId:t}=Wm(e);return!!t},execute:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{deeplinkUrl:t,preferredCommandInput:n,context:{coreSettings:i,loggerFactory:a,scenarioFactory:o}}=e,{enablePlatformDeepLinkRouting:r,appIdList:s,disabledTabAppIds:l,handleDeepLinkToMeetingSidePanel:c}=i.get(K.J.Extensibility),{appId:u}=Wm(t),m=s&&JSON.parse(s),g=(null==l?void 0:l.includes(u))||m&&!(null==m?void 0:m.includes(u)),p=new URLSearchParams(t.search).get("context"),v=p&&JSON.parse(p);if(!r&&(null==v?void 0:v.channelId))return Promise.reject("Feature for parsing teams and channels deep links in T2.1 is not enabled");if(r&&g)return Promise.reject(`App ${u} is not supported for deeplink navigation in T2.1`);if(c)try{const{executeDeepLinkToSidePanel:t}=yield(0,d.mT)($m,"platform-app-deeplink-to-sidepanel-execute");return t(e)}catch(e){if(!i.get(K.J.Core).handleInternalDeepLinks)throw new Error("T2 deeplink hooks disabled in T1")}return((e,t,n,i,a)=>{var o,r,s,l;const{appId:d,entityId:c,deeplinkContext:u,pathname:m,tenantId:g}=Wm(e);let p;t.log(`Parsing deepLink for platform app - appId: ${d}, pathname: ${m}`),n&&(null===(o=null==a?void 0:a.findScenario(ft.RG.PlatformTabDeeplinkHandling))||void 0===o||o.cancel(),p=null==a?void 0:a.newScenario(ft.RG.PlatformTabDeeplinkHandling),p&&(null===(r=null==a?void 0:a.hoistScenarioToCore)||void 0===r||r.call(a,p)),null==p||p.appendEventData({"PlatformTabDeeplink.pathname":e.pathname,"PlatformTabDeeplink.search":e.search}));for(const e of Array.from(Vm))if(null==m?void 0:m.startsWith(e)){if(void 0===jm[e]){const e="No deep link type found for the specified prefixType";return null===(s=t.errorToTelemetry)||void 0===s||s.call(t,e,"platform_deeplink_prefix_type"),Promise.reject(e)}return Hm(d,c,u,t,i,p,g)}const v="No DeeplinkPrefixType found for the specified deeplinkUrl";return null===(l=t.errorToTelemetry)||void 0===l||l.call(t,v,"platform_deeplink_prefix_type"),Promise.reject(v)})(t,a.newLogger("platform-app"),!!r,n,o)}))}];var Gm=n(851726);const qm={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformAppButtonMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAppButtonSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},Qm="platform",Jm="viewPlatformApp",Ym="loadPlatformChunks",Km=e=>({actor:Qm,action:Jm,data:{appId:e}}),Zm=()=>({actor:Qm,action:Ym}),{getIsFirstFlyoutClickAfterAppLoad:Xm,setIsFirstFlyoutClickAfterAppLoad:eg}=(()=>{let e=!0;return{getIsFirstFlyoutClickAfterAppLoad:()=>e,setIsFirstFlyoutClickAfterAppLoad:t=>{e=t}}})(),tg=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(7983),n.e(1839),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(70946),n.e(68227),n.e(45470),n.e(32094),n.e(8207),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(2205),n.e(58163),n.e(89962),n.e(88978),n.e(44413),n.e(99352),n.e(51150),n.e(88591),n.e(98495),n.e(34487),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(31693),n.e(95544),n.e(6075),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(64511),n.e(84577),n.e(2116),n.e(42256),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(78684),n.e(26891),n.e(17027),n.e(78290),n.e(97191),n.e(35166),n.e(43806),n.e(6482),n.e(88204),n.e(67638),n.e(11965),n.e(1910),n.e(69827),n.e(93880),n.e(75988),n.e(88369),n.e(98998),n.e(24998),n.e(25670),n.e(22568),n.e(13465),n.e(24548),n.e(76022),n.e(80941),n.e(4788),n.e(84203),n.e(26155),n.e(59067)]).then(n.bind(n,222884)),ng=({commandInput:e,requestContext:{loggerFactory:t,scenarioFactory:n,executionContext:a,client:o,coreSettings:r}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const s=e.command,l=s.action,{viewEntities:{mainEntity:c}}=a,u=t.newLogger("PlatformApp onCommandReceived");var m;if(e.command.actor===Qm)switch(l){case Jm:if("object"!=typeof(m=s.data)||null===m||!("appId"in m))return void u.error(`Command for action '${e.command.action}' requires an appId.`);const t=ig(null==c?void 0:c.id,null==c?void 0:c.type,s.data.appId,u);return t?((e,t,n,a)=>{(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!t)return;const i={appId:t,action:n};yield e.mutate({mutation:qm,variables:i}).catch((()=>{var e;return null===(e=a.errorToTelemetry)||void 0===e?void 0:e.call(a,`[AppId: ${t}] Failed to register app button to cache`,"platform_personal_app_app_button_api",void 0,!0)}))}))})(o,s.data.appId,l,u):(0,Gm.ui)(n,s.data.appId,Lm.mQ.personalApp),Um(s.data.appId,!1,Ot.D.Nova,void 0,void 0,void 0,t);case Ym:const{enablePrewarmPlatformChunk:a}=r.get(K.J.Extensibility);return void(a&&Xm()&&(u.log("enablePrewarmPlatformChunk is enabled."),(0,d.mT)(tg,"platform-app",n),eg(!1)));default:u.error(`Command action '${l}' is not supported at PlatformApp.`)}else u.error(`Command for actor '${e.command.actor}' cannot be handled by PlatformApp.`)})),ig=(e,t,n,i)=>{var a;try{if(t===u.p.extensions&&e){return JSON.parse(e).appId===n}return!1}catch(t){return null===(a=i.errorToTelemetry)||void 0===a||a.call(i,`failed to parse main entity id ${e}`,"platform_personal_app_main_entity_parse",void 0,!0),!1}};var ag=n(829333),og=n(248088);const rg={onEventReceived:({eventInput:e})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;switch(e.event.type){case og.uS.expandTab:{const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:ag.CN.expandTab(i)})}case og.uS.resetLayoutOverrides:return Promise.resolve({command:ag.CN.resetLayoutOverrides()});case og.uS.maximizeTab:return Promise.resolve({command:ag.CN.maximizeTab()})}return Promise.resolve(void 0)}))},sg=e=>{if(lg(e))return dg(e)?{subNavEntity:cg(e),headerEntity:ug(e),startEntity:mg(e),mainEntity:gg(e),endEntity:pg(e)}:null},lg=({contextEntity:e,entity:t,coreSettings:n,layoutMode:i})=>{const{action:a=null,type:o}=Object.assign({},t);if(vg(t,e,n))return!1;const r=[c.lO.focus,c.lO.standard].includes(i),s=[u.p.platformapp,u.p.platformappdetails,u.p.incontextstore,u.p.platformapps,u.p.extensions].includes(o),l=a&&[u.u.create,u.u.default,u.u.list,u.u.view,u.u.update].includes(a),d=e&&e.action;return!(!r||!s||!l&&!d)},dg=()=>!0,cg=()=>null,ug=({contextEntity:e,entity:t,coreSettings:n})=>{const i=null==n?void 0:n.get(K.J.Extensibility).enablePlatformHeaderEntry;if(e&&e.action){if(e.type===u.p.chats)return t;if(e.type===u.p.extensions&&i)return e}return i?t:null},mg=()=>null,gg=({entity:e,contextEntity:t})=>t&&t.action&&(t.type===u.p.chats||t.type===u.p.extensions)?t:e,pg=()=>null,vg=(e,t,n)=>{const i=null==n?void 0:n.get(K.J.Extensibility).enablePlatformHeaderEntry;return e.type===u.p.extensions&&(null==t?void 0:t.type)===u.p.extensions&&!i},hg=({coreSettings:e})=>{var t;return{[L.tF7.headerEntity]:{[s.S.HorizontalBar]:{slotHeightOverrides:(null===(t=null==e?void 0:e.get(K.J.Extensibility))||void 0===t?void 0:t.enablePlatformPersonalAppHeaderLayout)?"auto":void 0}}}},fg={id:"com.microsoft.teams.platform-app",name:"Platform App",actors:[Qm],supportedEntities:[u.p.extensions,u.p.taskmodule,u.p.hwctaskmodule,u.p.platformapp,u.p.platformappdetails,u.p.platformappconsent,u.p.platformapps,u.p.platformsubscriptionplans,u.p.customapp,u.p.platformauthconsentdialog,u.p.workflows,u.p.selectMediaApi,u.p.viewImagesApi,u.p.platformtab,u.p.locationapi,u.p.selectpeoplepicker,u.p.stagedapps,u.p.platformTabGallery,u.p.manageapps,u.p.manageappswebhook,u.p.incontextstore,u.p.platformappdevicepermissions,u.p.settingsdialog],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Modal,s.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},yg=({appRenderMode:e,coreSettings:t})=>{const n=new Dt.H,{platformAppCriticalPhaseTimeout:i}=t.get(K.J.Extensibility);return"Main"===e&&n.registerAppPhase({phase:Ft.nh.CRITICAL,signals:[Ft.GZ.PLATFORM_APP_CONTAINER_RENDERED,Ft.GZ.PLATFORM_APP_FRAME_RENDERED,Ft.GZ.PLATFORM_APP_FRAME_CONTENT_RENDERED],timeout:i||35e3}),n.appPhases},kg=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(50611),n.e(10440),n.e(66787),n.e(62514),n.e(21439),n.e(38393),n.e(89962),n.e(99352),n.e(51150),n.e(72222),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(79e3),n.e(81433),n.e(31693),n.e(6075),n.e(42256),n.e(26891),n.e(67638),n.e(9699),n.e(22568),n.e(60941)]).then(n.bind(n,757163)),Sg=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(7983),n.e(1839),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(70946),n.e(68227),n.e(45470),n.e(32094),n.e(8207),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(2205),n.e(58163),n.e(89962),n.e(88978),n.e(44413),n.e(99352),n.e(51150),n.e(88591),n.e(98495),n.e(34487),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(31693),n.e(95544),n.e(6075),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(64511),n.e(84577),n.e(2116),n.e(42256),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(78684),n.e(26891),n.e(17027),n.e(78290),n.e(97191),n.e(35166),n.e(43806),n.e(6482),n.e(88204),n.e(67638),n.e(11965),n.e(1910),n.e(69827),n.e(93880),n.e(75988),n.e(88369),n.e(98998),n.e(24998),n.e(25670),n.e(22568),n.e(13465),n.e(24548),n.e(76022),n.e(80941),n.e(4788),n.e(84203),n.e(26155),n.e(59067)]).then(n.bind(n,222884)),bg=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(96271),n.e(7983),n.e(1839),n.e(14085),n.e(45470),n.e(47333),n.e(32094),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(21767),n.e(33876),n.e(2205),n.e(58163),n.e(44413),n.e(99352),n.e(51150),n.e(88591),n.e(98495),n.e(9078),n.e(96837),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(31693),n.e(95544),n.e(6075),n.e(60739),n.e(64511),n.e(2116),n.e(42256),n.e(67215),n.e(26891),n.e(67638),n.e(50468),n.e(69827),n.e(22568),n.e(4788),n.e(26155),n.e(57990),n.e(6089),n.e(88919)]).then(n.bind(n,36272)),Cg=({coreServices:e})=>{var t,n;const i=null!==(t=fg.windowFeatures)&&void 0!==t?t:{};return(null===(n=null==e?void 0:e.coreSettings.get(K.J.Extensibility))||void 0===n?void 0:n.disablePlatformAppWindowFeatures)?null:i};function wg(){const e=()=>null;return{getAppPhases:yg,getAppViewEntities:sg,getAppWindowFeatures:Cg,getPlatformAppIdForEntity:e=>{if(e.type===u.p.extensions){const{appId:t}=e.id&&JSON.parse(e.id);return t}},getAppViewEntitiesProps:hg,onBeforeDeeplinkParsed:zm,manifest:fg,onCommandReceived:ng,onRegister:e=>{e.registerTask(new Pe)},render:({appRenderMode:t,scenarioFactory:n,onRenderEvent:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,r;switch(t){case s.S.Modal:{const e="platform-modal",{Modal:t}=yield(0,d.mT)(bg,e,n);return o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(t,null))}case s.S.HorizontalBar:case s.S.Main:{const e="platform-app";null===(i=null==n?void 0:n.findScenario(ft.RG.PlatformTabFrameLoading))||void 0===i||i.mark(ft.ck.PlatformTabRenderBeforeChunkLoad),a("ChunkLoadStarted",{chunkName:e});const{PlatformAppViewsEntryRenderer:s}=yield(0,d.mT)(Sg,e,n);return a("ChunkLoadSucceeded",{chunkName:e}),null===(r=null==n?void 0:n.findScenario(ft.RG.PlatformTabFrameLoading))||void 0===r||r.mark(ft.ck.PlatformTabRenderAfterChunkLoad),o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(s,{appRenderMode:t}))}case s.S.Rail:{const e="platform-app-rail",{PlatformTabPanel:t}=yield(0,d.mT)(kg,e,n);return o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(t,null))}default:return o.createElement(e,null)}})),eventHandlers:rg}}const Ng={onEventReceived:({eventInput:e})=>{var t,n;switch(e.event.type){case un.uS.requestPersonMoreInfo:const i=null===(n=(t=e.event).data)||void 0===n?void 0:n.call(t);return Promise.resolve({command:vn(i)})}return Promise.resolve(void 0)}};var Tg=n(941355);const Ig=()=>Promise.all([n.e(86854),n.e(45129),n.e(39341),n.e(86060)]).then(n.bind(n,679474)),Eg=e=>({id:"search-data-load",runOncePerId:!0,job:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.newLogger("dataResolverSearchJob");t.log("[dataResolversSearchJob] Initializing calling service");try{yield(0,d.mT)(Ig,"search-data-resolvers")}catch(e){t.error("[dataResolversSearch] Error initializing bundle")}t.log("[dataResolversSearch] Calling service initialized")}))}),Ag=({context:{loggerFactory:e}})=>[Eg(e)],_g=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(92983),n.e(35799),n.e(89760),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(56845),n.e(78998),n.e(45746),n.e(79058),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(90081),n.e(52249),n.e(16654),n.e(4793),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(50840),n.e(68865),n.e(94333),n.e(93215),n.e(98935),n.e(44413),n.e(60987),n.e(59288),n.e(61167),n.e(5911),n.e(52596),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(69827),n.e(35444),n.e(45129),n.e(78760),n.e(25814),n.e(56904)]).then(n.bind(n,212408)),Dg=()=>Promise.all([n.e(51778),n.e(61724),n.e(86854),n.e(45129),n.e(79506)]).then(n.bind(n,697312)),Fg=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:t,entityCommand:{entity:{type:n,action:i},command:{stateTransition:a}},requestContext:{loggerFactory:o,client:r,coreSettings:s}}=e,l=o.newLogger("SearchAppOnBeforeCommandHandled"),{enablePretriggerImprovement:c}=null==s?void 0:s.get(K.J.Serp),m=t.entityOptions||{},g=m.loadBundle,p=m.substrateSearchWarmUpInExpRenderer,v="search-app";if(n===u.p.search&&i===u.u.view&&g){const{pingSearch:e}=yield(0,d.mT)(_g,v),{enableSerpServiceToPrewarm:t}=null==s?void 0:s.get(K.J.Serp);try{t&&(yield r.mutate({mutation:e,variables:{correlationId:(0,mt.v4)()}}))}catch(e){l.error(`mutation pingSearch error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}return Promise.resolve(void 0)}if(n===u.p.search&&i===u.u.view&&p){const{searchWarmup:e}=yield(0,d.mT)(_g,v);return yield r.query({query:e,variables:{scenario:"powerbar",cvid:m.conversationId}}),Promise.resolve(void 0)}if(c&&n===u.p.search&&i===u.u.view&&"flush"===a&&m.searchQuery){const{searchQuery:e,logicalId:t,conversationId:n,entrySource:i,navLocationContext:a,currentTab:o,filterSet:l}=m,{enableNavLocationContext:c}=null==s?void 0:s.get(K.J.Serp),u="backButton"===i,{searchServiceCache:g,Tabs:p}=yield(0,d.mT)(Dg,"services-io-search");g.clearAll(),c&&a&&g.setNavLocationContext(a);const h=(0,mt.v4)(),f=(0,mt.v4)();g.setUpstreamTelmetryIds(h,f);const{searchPreTriggerQuery:y,numberOfAllPageResults:k}=yield(0,d.mT)(_g,v);yield r.query({query:y,variables:{searchTerm:e,noOfResults:k,pageNumber:0,correlationId:h,allFilters:l?l[p.All]:{},messageFilters:l?l[p.All]:{},searchStartCorrelationId:f,currentTab:o,isBackButton:u,conversationId:n,logicalId:t}})}return Promise.resolve(t)})),Mg=({appRenderMode:e})=>{const t=new Dt.H,n=[],i=[];switch(e){case s.S.Main:Rg({featureFlags:{},criticalSignals:n,postCriticalSignals:i})}return t.registerAppPhase({phase:Ft.nh.CRITICAL,signals:n,timeout:1e4}),t.registerAppPhase({phase:Ft.nh.POST_CRITICAL,signals:i,timeout:1e4}),t.appPhases},Rg=({criticalSignals:e})=>{e.push(Ft.GZ.SEARCH_RESULTS_RENDERED)},Pg=e=>{if(Og(e))return xg(e)?{subNavEntity:Lg(e),headerEntity:Ug(e),startEntity:Bg(e),mainEntity:jg(e),endEntity:Wg(e)}:null},Og=({contextEntity:e,entity:t,layoutMode:n})=>{const{action:i=null,type:a}=Object.assign({},t),o=[c.lO.focus,c.lO.standard].includes(n),r=[u.p.search].includes(a),s=i&&[u.u.default,u.u.view].includes(i),l=e&&e.action&&e.type===u.p.chats;return!(!o||!r||!s&&!l)},xg=()=>!0,Lg=()=>null,Ug=({contextEntity:e})=>e&&e.action&&e.type===u.p.chats?e:null,Bg=()=>null,jg=({entity:e,contextEntity:t})=>t&&t.action&&t.type===u.p.chats?t:e,Wg=()=>null,Vg={id:"com.microsoft.teams.search",name:"Search",getLocalizedName:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("search"),e.stringTranslate("search","search_app_name")})),supportedEntities:[u.p.search],supportedRenderModes:[s.S.Main],windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3}},Hg={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsSearchFloodgateLogActivityMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activityName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"increment"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"floodgateLogActivity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activityName"},value:{kind:"Variable",name:{kind:"Name",value:"activityName"}}},{kind:"Argument",name:{kind:"Name",value:"increment"},value:{kind:"Variable",name:{kind:"Name",value:"increment"}}}]}]}}]};class $g extends Fe{constructor(){super(De.Yg.LogActivityTask,["client","hostCommunicationService","coreSettings","loggerFactory"])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:n,hostCommunicationService:i,coreSettings:a,loggerFactory:o}=e,r=(null==a?void 0:a.get(K.J.Serp).enableAutosuggestFps)||!1,s=null==a?void 0:a.get(K.J.SurveyForm).enableCsatTaskRegistration;if(r&&!s){const e=yield null==i?void 0:i.loadModule("search"),a=o.newLogger("LogActivityTaskRegistered");null===(t=null==e?void 0:e.registerForLogActivity)||void 0===t||t.call(e,(e=>{a.log(`activity ${e.activityName} and increment ${e.incrementValue}`),"teamsSearchFps"===e.activityName&&(e=>{e.mutate({mutation:Hg,variables:{activityName:"teamsSearchFps",increment:1}})})(n)}))}}))}}const zg=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(92983),n.e(35799),n.e(89760),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(56845),n.e(78998),n.e(45746),n.e(79058),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(90081),n.e(52249),n.e(16654),n.e(4793),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(50840),n.e(68865),n.e(94333),n.e(93215),n.e(98935),n.e(44413),n.e(60987),n.e(59288),n.e(61167),n.e(5911),n.e(52596),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(69827),n.e(35444),n.e(45129),n.e(78760),n.e(25814),n.e(56904)]).then(n.bind(n,212408)),Gg=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(92983),n.e(35799),n.e(89760),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(56845),n.e(78998),n.e(45746),n.e(79058),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(90081),n.e(52249),n.e(16654),n.e(4793),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(50840),n.e(68865),n.e(94333),n.e(93215),n.e(98935),n.e(44413),n.e(60987),n.e(59288),n.e(61167),n.e(5911),n.e(52596),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(95544),n.e(23956),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(69827),n.e(35444),n.e(45129),n.e(78760),n.e(25814),n.e(56904)]).then(n.bind(n,334814)),qg=()=>Vg.windowFeatures||{};function Qg(){const e=()=>null;return{eventHandlers:Ng,getAppPhases:Mg,onRegister:e=>{e.registerTask(new Pe),e.registerTask(new $g)},getAppViewEntities:Pg,getAppWindowFeatures:qg,manifest:Vg,render:({appRenderMode:t,coreSettings:n,onRenderEvent:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="search-app";a("ChunkLoadStarted",{chunkName:e});const{SearchViewsRenderer:t}=yield(0,d.mT)(zg,e),{enableEntityMoreInfo:i}=n.get(K.J.Core),r=({children:e})=>o.createElement(o.Fragment,null,e),{LPC:s}=i?{LPC:r}:yield(0,d.mT)(Gg,e),c=i?r:yn.p3;a("ChunkLoadSucceeded",{chunkName:e});const u="search";return o.createElement(l.f,{namespace:"messaging",loaderRenderer:null},o.createElement(s,{appName:u},o.createElement(c,null,o.createElement(Tg.r,null,o.createElement(t,null)))))}return o.createElement(e,null)})),onPreWarm:Ag,onBeforeCommandHandled:Fg}}const Jg={getDefaultCommand:()=>({type:u.p.messages,action:u.u.create}),id:"com.microsoft.teams.share",name:"ShareApp",supportedEntities:[u.p.messages,u.p.shareformdialog],supportedRenderModes:[s.S.Main,s.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}};var Yg=n(892685),Kg=n(907310),Zg=n(767008);const Xg=({children:e})=>{const t=Yg.YM,{unblockOutlookDesktopIE11:n,unblockSafari:i}=(0,Zg.NC)(K.J.Outlook);if(n&&(t.ie=`>=${Yg.Zz}`),i&&(t.safari=`>=${Yg.hh}`),!((0,Kg.H$)(t)||(0,Kg.L5)()&&i))throw(0,Mn.Tr)("UnsupportedBrowserCheck",De.jK.FeatureNotSupported,"render",void 0,"Unsupported Browser");if(!i&&(0,Kg.Qh)())throw(0,Mn.Tr)("UnsupportedBrowserCheck",De.jK.FeatureNotSupported,"render",{itpError:!0},"Unsupported Browser (ITP Enabled)");return o.createElement(o.Fragment,null,e)},ep=e=>{if(tp(e))return np(e)?{subNavEntity:ip(e),headerEntity:ap(e),startEntity:op(e),mainEntity:rp(e),endEntity:sp(e)}:null},tp=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.messages,u.p.shareformdialog].includes(i),r=n&&[u.u.default,u.u.view,u.u.create].includes(n);return!!(a&&o&&r)},np=()=>!0,ip=()=>null,ap=()=>null,op=()=>null,rp=({entity:e})=>e,sp=()=>null,lp=({appRenderMode:e})=>{const t=new Dt.H,n=[];return e===s.S.Main&&n.push(Ft.GZ.SHARE_PAGE_RENDERED),t.registerAppPhase({phase:Ft.nh.CRITICAL,signals:n,timeout:2e4}),t.appPhases},dp=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(96271),n.e(19432),n.e(32398),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(50840),n.e(68865),n.e(94333),n.e(93215),n.e(55669),n.e(25624),n.e(33994),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(81433),n.e(50352),n.e(46163),n.e(31693),n.e(6075),n.e(23956),n.e(54226),n.e(60739),n.e(30509),n.e(92549),n.e(64511),n.e(84577),n.e(2116),n.e(42256),n.e(78802),n.e(67215),n.e(26891),n.e(26599),n.e(28974),n.e(95630),n.e(84728),n.e(51143),n.e(7139),n.e(28729)]).then(n.bind(n,88886)),cp=()=>null;function up(){return{getAppPhases:lp,getAppViewEntities:ep,manifest:Jg,onRegister:e=>{e.registerTask(new Pe)},render:({appRenderMode:e,scenarioFactory:t})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e===s.S.Modal||e===s.S.Main){const e=yield(0,d.mT)(dp,"share-form",t),{ShareForm:n}=e;return o.createElement(Xg,null,o.createElement(n,null))}return o.createElement(cp,null)}))}}const mp={getDefaultCommand:()=>({type:u.p.email,action:u.u.create}),id:"com.microsoft.teams.share-email",name:"ShareEmailApp",supportedEntities:[u.p.email],supportedRenderModes:[s.S.Main],windowFeatures:{minWidth:530,width:748,minHeight:490,height:691}},gp=e=>{if(pp(e))return vp(e)?{subNavEntity:hp(e),headerEntity:fp(e),startEntity:yp(e),mainEntity:kp(e),endEntity:Sp(e)}:null},pp=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.email].includes(i),r=n&&[u.u.default,u.u.create].includes(n);return!!(a&&o&&r)},vp=()=>!0,hp=()=>null,fp=()=>null,yp=()=>null,kp=({entity:e})=>e,Sp=()=>null,bp=({appRenderMode:e})=>{const t=new Dt.H,n=[];return e===s.S.Main&&n.push(Ft.GZ.SHARE_PAGE_RENDERED),t.registerAppPhase({phase:Ft.nh.CRITICAL,signals:n,timeout:2e4}),t.appPhases},Cp=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(50611),n.e(60567),n.e(19432),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(93215),n.e(55669),n.e(25624),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(46163),n.e(54226),n.e(92549),n.e(78802),n.e(26599),n.e(28974),n.e(95630),n.e(84728),n.e(7139),n.e(63686)]).then(n.bind(n,869665)),wp=e=>{e.registerTask(new Pe)},Np=({windowOptions:e})=>{var t,n,i,a;return e?{height:e.height,left:e.left,top:e.top,width:e.width}:{minHeight:null===(t=mp.windowFeatures)||void 0===t?void 0:t.height,minWidth:null===(n=mp.windowFeatures)||void 0===n?void 0:n.width,height:null===(i=mp.windowFeatures)||void 0===i?void 0:i.height,width:null===(a=mp.windowFeatures)||void 0===a?void 0:a.width}};function Tp(){const e=()=>null;return{getAppPhases:bp,getAppViewEntities:gp,getAppWindowFeatures:Np,manifest:mp,onRegister:wp,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const{ShareFormEmail:e}=yield(0,d.mT)(Cp,"share-form-email-entry",n);return o.createElement(e,null)}return o.createElement(e,null)}))}}const Ip=e=>{if(Ep(e))return Ap(e)?{subNavEntity:_p(e),headerEntity:Dp(e),startEntity:Fp(e),mainEntity:Mp(e),endEntity:Rp(e)}:null},Ep=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.standard].includes(e),o={[u.p.brbfeedbackdialog]:[u.u.default,u.u.view],[u.p.tpndialog]:[u.u.default,u.u.view],[u.p.activecalldialog]:[u.u.default,u.u.view],[u.p.signoutdialog]:[u.u.default,u.u.view],[u.p.identitydialog]:[u.u.create],[u.p.joinlinkdialog]:[u.u.default,u.u.view],[u.p.bannerNotification]:[u.u.create,u.u.delete],[u.p.hybridplaceholder]:[u.u.default,u.u.view],[u.p.updatemsaprofileavatardialog]:[u.u.default,u.u.view],[u.p.updatemsaprofilenamedialog]:[u.u.default,u.u.view],[u.p.autobrbconfirmationdialog]:[u.u.default,u.u.view],[u.p.pearnotdefaultapp]:[u.u.view]},r=n&&(o[i]||[]).includes(n);return!(!a||!r)},Ap=()=>!0,_p=({entity:e})=>e.type===u.p.pearnotdefaultapp?null:e,Dp=({entity:e})=>e.type===u.p.pearnotdefaultapp?null:e,Fp=({entity:e})=>e.type===u.p.pearnotdefaultapp?null:e,Mp=({entity:e})=>e,Rp=({entity:e})=>e.type===u.p.pearnotdefaultapp?null:e,Pp=({areEmptySlotsTransparent:e,coreSettings:t})=>({[L.tF7.subNavEntity]:{[L.OQr.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e},[L.OQr.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==t?void 0:t.get(K.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}},[L.tF7.headerEntity]:{[L.OQr.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},[L.tF7.startEntity]:{[L.OQr.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},[L.tF7.mainEntity]:{[L.OQr.ThinHorizontalBar]:{isBackgroundTransparent:e},[L.OQr.TitleBar]:{isBackgroundTransparent:!0},[L.OQr.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==t?void 0:t.get(K.J.Core).enableTransparentAppBar)||e,isColorSchemeDefaultBackground6:!e}},[L.tF7.endEntity]:{[L.OQr.Rail]:{isBackgroundTransparent:e}}});var Op=n(200353);const xp="viewActivityApp",Lp=()=>({actor:"activity",action:xp}),Up="teamsandchannels",Bp="viewTeamsAndChannelsApp",jp=()=>({actor:Up,action:Bp}),Wp="store",Vp="viewStoreApp",Hp=()=>({actor:Wp,action:Vp}),$p="viewHomepageApp",zp=()=>({actor:"homepage",action:$p}),Gp=(e,t)=>{if("platform"===e.platformType)return{appName:"platformApp",appViewCommand:{command:Km(e.tileID)}};switch(e.tileID){case qp.store:return{appName:"store",appViewCommand:{command:Hp()}};case qp.activity:return{appName:"activity",appViewCommand:{command:Lp()}};case qp.calendar:return{appName:"calendar",appViewCommand:{command:At()}};case qp.callsmain:return{appName:"callsmain",appViewCommand:{command:qa()}};case qp.channel:return{appName:"channel",appViewCommand:{command:jp()}};case qp.chat:return{appName:"chat",appViewCommand:{command:us()}};case qp.communities:return{appName:"communities",appViewCommand:{command:Ys()}};case qp.meet:return{appName:"meet",appViewCommand:{command:gu()}};case qp.assignments:return{appName:"assignments",appViewCommand:{command:Km(qp.assignments)}};case qp.homepage:return{appName:"homepage",appViewCommand:{command:zp()}};default:return void t.error(`Received an unknown core app id. Cannot launch app with id ${e.tileID}.`)}},qp={activity:"14d6962d-6eeb-4f48-8890-de55454bb136",chat:"86fcd49b-61a2-4701-b771-54728cd291fb",calendar:"ef56c0de-36fc-4ef8-b417-3d82ba9d073c",channel:"2a84919f-59d8-4441-a975-2a8c2643b741",callsmain:"20c3440d-c67e-4420-9f80-0e50c39693df",files:"5af6a76b-40fc-4ba1-af29-8f49b08e44fd",meet:"957ed0e3-e5ca-4c82-9676-fd037185c4d8",communities:"3b95919f-59d8-4441-a975-2a8c2643c852",assignments:"66aeee93-507d-479a-a3ef-8f494af43945",store:"ac40aa4a-fef1-4896-aea2-46d1c14dbfd5",homepage:"7133fca9-0853-4e7a-bb5d-32d4e5f6020a"},Qp=e=>{const t=Ot.D.Nova;switch(e.tileID){case qp.activity:return{scenarioName:ft.RG.ActivitySwitch,source:t};case qp.calendar:return{scenarioName:ft.RG.CalendarSurfaceLoad,source:t};case qp.channel:return{scenarioName:ft.RG.ChannelSwitchL1,source:t};case qp.chat:return{scenarioName:ft.RG.ChatSwitch,source:t};case qp.callsmain:return{scenarioName:ft.RG.CallsAppSwitch,source:t};default:return{scenarioName:ft.RG.EntityCommand,source:t}}},Jp=(e,t)=>{const n=e.event;if(n.originator===Op.DQ)return((e,t)=>{switch(e.type){case Op.iC.launch:if(!e.data)return void t.error("Received a launch event without data!");const n=e.data();return Qp(n);default:return void t.warn(`Received an unhandled Launch tile event, type: ${e.type}`)}})(n,t)},Yp={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellGetBannerNotificationQueueQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bannerNotificationQueue"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bannerId"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"bannerScenario"}},{kind:"Field",name:{kind:"Name",value:"intentLevel"}},{kind:"Field",name:{kind:"Name",value:"cause"}},{kind:"Field",name:{kind:"Name",value:"props"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"command"}},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"behavior"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissable"}},{kind:"Field",name:{kind:"Name",value:"dismissActionCommand"}},{kind:"Field",name:{kind:"Name",value:"duration"}}]}}]}}]}}]},Kp={[L.XuV.MostSevere]:0,[L.XuV.Live]:1,[L.XuV.Severe]:2,[L.XuV.Positive]:3,[L.XuV.Neutral]:4},Zp=e=>{var t,n,i,a;const{bannerId:o,source:r,bannerScenario:s,intentLevel:l,cause:d,props:{text:c,action:u},behavior:m}=e;return{__typename:"BannerNotification",bannerId:o,source:r,bannerScenario:null!=s?s:null,intentLevel:l,cause:null!=d?d:null,props:{__typename:"BannerNotificationProperties",text:null!=c?c:null,action:u?{__typename:"NotificationAction",command:u.command,text:null!==(t=u.text)&&void 0!==t?t:null,dismissOnAction:u.dismissOnAction}:null},behavior:{__typename:"BannerNotificationBehavior",dismissable:null!==(n=null==m?void 0:m.dismissable)&&void 0!==n&&n,dismissActionCommand:null!==(i=null==m?void 0:m.dismissActionCommand)&&void 0!==i?i:null,duration:null!==(a=null==m?void 0:m.duration)&&void 0!==a?a:0}}},Xp=(e,t)=>{var n,i;let a=[];try{a=null!==(i=null===(n=t.readQuery({query:Yp}))||void 0===n?void 0:n.bannerNotificationQueue)&&void 0!==i?i:[]}catch(t){e.error("Failed to read banner queue from data client cache. ",t)}return a.map(Zp)},ev=(e,t,n)=>{const i={bannerNotificationQueue:n.map(Zp)};try{t.writeQuery({query:Yp,data:i})}catch(t){e.error("Failed to write banner queue to data client cache. ",t)}},tv=(e,t,n)=>{let i=Xp(e,t);i=i.filter((e=>e.bannerId!==n)),ev(e,t,i)},nv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsShellReauthenticateMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"reauthenticateUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},iv=(e,t)=>{var n;return null===(n=t.mutate({mutation:nv}))||void 0===n?void 0:n.then((e=>{var t,n;return null===(n=null===(t=e.data)||void 0===t?void 0:t.reauthenticateUser)||void 0===n?void 0:n.success})).catch((t=>(e.error("Failed to perform reauthentication. ",t),Promise.resolve(void 0))))},av={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellGetToastNotificationQueueQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastNotificationQueue"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"intent"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"command"}},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}}]},ov=e=>{var t;return e?{__typename:"NotificationAction",command:e.command,text:null!==(t=e.text)&&void 0!==t?t:null,dismissOnAction:e.dismissOnAction}:null},rv=e=>e?{__typename:"ConfirmationToastProperties",action:ov(e.action)}:null,sv=e=>{const{id:t,source:n,intent:i,title:a,body:o,duration:r}=e;return{__typename:"ToastNotification",id:t,intent:i,title:a,body:rv(null!=o?o:void 0),duration:null!=r?r:0,source:n}},lv=(e,t)=>{var n,i;let a=[];try{a=null!==(i=null===(n=t.readQuery({query:av}))||void 0===n?void 0:n.toastNotificationQueue)&&void 0!==i?i:[]}catch(t){e.error("Failed to read toasts queue from data client cache. ",t)}return a.map(sv)},dv=(e,t,n)=>{const i={toastNotificationQueue:n.map(sv)};try{t.writeQuery({query:av,data:i})}catch(t){e.error("Failed to write toast notifications queue to data client cache. ",t)}},cv={[u.u.create]:(e,t)=>{const{command:{correlation:{source:n}},entityOptions:a,entity:{id:o}}=t,{client:r,loggerFactory:s}=e,l=s.newLogger("addBannerNotificationToQueue"),d=a;if(d){const{text:e,action:t,dismissable:a,dismissActionCommand:s,duration:c}=d,u=(0,i.__rest)(d,["text","action","dismissable","dismissActionCommand","duration"]);let m;t&&(m=Object.assign(Object.assign({},t),{command:JSON.stringify(t.command)})),((e,t,n)=>{let i=Xp(e,t);i=i.filter((e=>e.bannerId!==n.bannerId)),i.unshift(n),i=i.sort(((e,t)=>Kp[e.intentLevel]-Kp[t.intentLevel])),ev(e,t,i)})(l,r,Object.assign(Object.assign({},u),{bannerId:o||"no-id",source:n,props:{text:e,action:m},behavior:{dismissable:a,dismissActionCommand:s?JSON.stringify(s):void 0,duration:c}}))}else l.error("entityOptions is missing IBannerNotificationOptions fields. ",a);return Promise.resolve(void 0)},[u.u.delete]:(e,t)=>{const{entity:{id:n}}=t,{client:i,loggerFactory:a}=e,o=a.newLogger("removeBannerNotificationFromQueue");return n&&tv(o,i,n),Promise.resolve(void 0)},[u.u.signin]:(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{entityOptions:n}=t,{client:i,loggerFactory:a}=e,o=a.newLogger("handleSignInBannerActionCommand"),r=n;return(yield iv(o,i))&&(null==r?void 0:r.bannerId)&&tv(o,i,r.bannerId),Promise.resolve(void 0)}))},uv={[u.u.create]:(e,t)=>{const{command:{correlation:{source:n}},entityOptions:a,entity:{id:o}}=t,{client:r,loggerFactory:s}=e,l=s.newLogger("addToastNotificationToQueue"),d=a;if(o&&d){const{body:e}=d,t=(0,i.__rest)(d,["body"]);let a;(null==e?void 0:e.action)&&(a=Object.assign(Object.assign({},null==e?void 0:e.action),{command:JSON.stringify(null==e?void 0:e.action.command)})),((e,t,n)=>{let i=lv(e,t);i=i.filter((e=>e.id!==n.id)),i.push(n),dv(e,t,i)})(l,r,Object.assign(Object.assign({},t),{id:o,source:n,body:{action:a}}))}else l.error("entityOptions is missing IToastNotificationParams fields. ",a);return Promise.resolve(void 0)},[u.u.delete]:(e,t)=>{const{entity:{id:n}}=t,{client:i,loggerFactory:a}=e,o=a.newLogger("removeToastNotificationFromQueue");return n&&((e,t,n)=>{let i=lv(e,t);i=i.filter((e=>e.id!==n)),dv(e,t,i)})(o,i,n),Promise.resolve(void 0)},[u.u.update]:(e,t)=>{const{command:{correlation:{source:n}},entityOptions:a,entity:{id:o}}=t,{client:r,loggerFactory:s}=e,l=s.newLogger("addToastNotificationToQueue"),d=a;if(o&&d){const{body:e}=d,t=(0,i.__rest)(d,["body"]);let a;(null==e?void 0:e.action)&&(a=Object.assign(Object.assign({},null==e?void 0:e.action),{command:JSON.stringify(null==e?void 0:e.action.command)})),((e,t,n)=>{const i=lv(e,t);let a=!1;for(let e=0;e<i.length;e++)if(i[e].id===n.id){i[e]=n,a=!0;break}a||i.push(n),dv(e,t,i)})(l,r,Object.assign(Object.assign({},t),{id:o,source:n,body:{action:a}}))}else l.error("entityOptions is missing IToastNotificationParams fields. ",a);return Promise.resolve(void 0)}},mv=e=>{const{entityCommand:t,entityCommand:{entity:{type:n,action:i}},requestContext:a}=e;if(n===u.p.bannerNotification){const e=cv[i];if(e)return e(a,t)}else if(n===u.p.inAppToast){const e=uv[i];if(e)return e(a,t)}return Promise.resolve(t)},gv=[{filter:"/notdefaultapp",execute:({context:{coreSettings:e,loggerFactory:t}})=>{const{enableAppSwitcher:n}=e.get(K.J.Core),i=t.newLogger("Shell:BeforeDeeplinkParsedCondition");return n?(i.log("execute command onBeforeDeeplinkParsed"),Promise.resolve({entityCommand:{entity:{type:u.p.pearnotdefaultapp,action:u.u.view},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,layoutMode:c.lO.standard}},metadata:{allowAnonymous:!0}})):(i.log(`app switcher is not enabled, enableAppSwitcher value is ${n}`),Promise.reject({message:"app-switcher-not-enabled"}))}}];var pv;!function(e){e[e.NoOverride=0]="NoOverride",e[e.OverrideCloud=1]="OverrideCloud",e[e.OverrideIntent=2]="OverrideIntent",e[e.OverrideUserContext=3]="OverrideUserContext",e[e.TerminateNavigation=4]="TerminateNavigation"}(pv||(pv={}));const vv={filter:new Set([u.p.pearnotdefaultapp]),execute:({intent:e})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return{overrideType:pv.OverrideIntent,intent:e}}))};function hv(e){const{hostCommunicationService:t,loggerFactory:n}=e,a=n.newLogger("auth-notification-job");return{id:"auth-notification",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e;const n=(0,mt.v4)();try{a.debug(`Sending webAuthSucceeded notification start. CorrelationId: ${n}.`);const i=yield t.loadModule("auth");null===(e=null==i?void 0:i.webAuthSucceeded)||void 0===e||e.call(i,{correlationId:n}),a.debug(`Sending webAuthSucceeded notification complete. CorrelationId: ${n}.`)}catch(e){throw a.error(`Sending webAuthSucceeded notification failed. CorrelationId: ${n}. Error: ${(0,Ci.u4)(e)}`),e}}))}}const fv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"OnAuthenticationStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationState"}}]}}]}}]},yv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}}]}}]};function kv(e,t){const{client:n,entityCommanding:a,i18n:o,loggerFactory:r}=e,s=r.newLogger("auth-state-job"),l=n,d="auth-banner";let c=!0;return{id:"auth-state-subscription",job:()=>{l.subscribe({query:fv}).filter((e=>{var t,n;return!!(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.authenticationStateChanged)||void 0===n?void 0:n.authenticationState)})).subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var n,i,r,u;const m=yield l.query({query:yv});if(0===(null===(i=null===(n=null==m?void 0:m.data)||void 0===n?void 0:n.authenticationUsers)||void 0===i?void 0:i.length))return void s.warn("No authenticated user found, not displaying auth-banner.");const g=null===(u=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.authenticationStateChanged)||void 0===u?void 0:u.authenticationState;switch(g){case L.zGj.AADReconnecting:case L.zGj.SkypeReconnecting:!function(e,t,n,i){let a="",o="";t===L.zGj.AADReconnecting?(a=n.stringTranslate("auth","aad_reconnecting_text"),o="auth_aad_reconnecting"):t===L.zGj.SkypeReconnecting&&(a=n.stringTranslate("auth","skype_reconnecting_text"),o="auth_skype_reconnecting");i.shell.showBanner({id:e,source:Ot.D.ShellAuthState,intentLevel:L.XuV.Neutral,text:a,dismissable:!0,duration:0,bannerScenario:o})}(d,g,o,a);break;case L.zGj.InteractionRequired:!function(e,t,n){n.shell.showBanner({id:e,source:Ot.D.ShellAuthState,bannerScenario:"auth_sign_in_required",intentLevel:L.XuV.MostSevere,cause:L.lFB.AuthError,text:t.stringTranslate("auth","sign_in_required_text"),action:{text:t.stringTranslate("auth","sign_in_required_cta_text"),command:{entity:{type:L.pyR.bannerNotification,action:L.ukP.signin}},dismissOnAction:!1},dismissable:!1,duration:0})}(d,o,a);break;case L.zGj.Up:default:!c&&a.shell.dismissBanner(d,Ot.D.ShellAuthState)}t&&t(),c=!1}))))}}}var Sv=n(915271);const bv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsShellCdlServicesStateSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appServiceStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appService"}},{kind:"Field",name:{kind:"Name",value:"previousState"}},{kind:"Field",name:{kind:"Name",value:"currentStateChangeTimestamp"}},{kind:"Field",name:{kind:"Name",value:"currentStateChangeReason"}},{kind:"Field",name:{kind:"Name",value:"currentStateChangeCode"}},{kind:"Field",name:{kind:"Name",value:"currentState"}}]}}]}}]};function Cv(e,t){const{client:n,entityCommanding:a,i18n:o,loggerFactory:r,coreSettings:s,networkState:l}=e,d=n,c="cdl-services-state-banner",u=r.newLogger("cdl-services-state-job");let m=!1;const g=(e,t,n,a,o,r)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield o.shell.showBanner({id:e,source:Ot.D.ShellCDLServicesState,intentLevel:L.XuV.Neutral,text:n.stringTranslate("errors","chatsync_app_service_disconnected"),dismissable:!0,duration:0,bannerScenario:"cdl-service-state-disconnected-banner"}),a.infoToTelemetry&&a.infoToTelemetry("ChatSync app service is OFFLINE; displaying disconnected banner","cdl_app_state_chatsync_disconnected_banner_show",wv(t),!0),m=!0,r&&r(m)})),p=(e,t,n,a,o,r=!0)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield a.shell.dismissBanner(e,Ot.D.ShellCDLServicesState),r&&n.infoToTelemetry&&n.infoToTelemetry("ChatSync app service is back up; dismissing existing banner","cdl_app_state_chatsync_disconnected_banner_dismiss",wv(t),!0),m=!1,o&&o(m)}));return{id:"cdl-services-state-subscription",job:()=>{const e=s.get(K.J.CdlWorker).disableTrouterDisconnectedBannerT2,n=!!s.get(K.J.CdlWorker).enableCdlAppStateService;if(e||!n)return void(u.infoToTelemetry&&u.infoToTelemetry("disableTrouterDisconnectedBanner killswitch is enabled or enableCdlAppStateService is disabled; not listening to app service state change events","cdl_app_state_chatsync_disconnected_banner"));const r=d.subscribe({query:bv}).subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var n;if(!(null==e?void 0:e.data))return void(t&&t());const i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.appServiceStateChanged,{appService:r,currentState:s}=i;if(l.getState()===Sv.G.Online)switch(r){case"ChatSync":m||s!==L.YHP.OFFLINE?m&&s===L.YHP.ONLINE&&(yield p(c,i,u,a,t)):yield g(c,i,o,u,a,t)}else yield p(c,i,u,a,t,!1)}))));return()=>{r.unsubscribe()}}}}function wv(e){const{appService:t,currentState:n,currentStateChangeReason:i,currentStateChangeCode:a,previousState:o}=e;return{appService:t,currentState:n.toString(),currentStateChangeReason:i,currentStateChangeCode:a,previousState:null==o?void 0:o.toString()}}const Nv="offline banner";function Tv(e){const{coreSettings:t,entityCommanding:n,i18n:i,loggerFactory:a,networkState:o}=e,r=a.newLogger("network-state-subscription-logger");let s=!0;return{id:"network-state-subscription",job:()=>{if(!t.get(K.J.Core).enableNetworkStateBannerSubscription)return void r.log("network state banner subscription is disabled");const e=o.observe().subscribe((e=>{e===Sv.G.Offline?(r.debug("showing offline banner"),n.shell.showBanner({id:Nv,source:Ot.D.ShellNetworkState,bannerScenario:"framework_offline_banner",intentLevel:L.XuV.Severe,cause:L.lFB.Offline,text:i.stringTranslate("framework","offline_banner_message"),dismissable:!1,duration:0})):s||(r.debug("dismissing offline banner"),n.shell.dismissBanner(Nv,Ot.D.ShellNetworkState)),s=!1}));return()=>{e.unsubscribe()}}}}const Iv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"notifyWorkerSyncCanStart"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notifyWorkerSyncCanStart"}}]}}]};const Ev={id:"com.microsoft.teams.shell",name:"Shell",supportedEntities:[u.p.activecalldialog,u.p.bannerNotification,u.p.brbfeedbackdialog,u.p.hybridplaceholder,u.p.identitydialog,u.p.pearnotdefaultapp,u.p.signoutdialog,u.p.inAppToast,u.p.tpndialog,u.p.unsupporteddeeplinkdialog,u.p.updatemsaprofileavatardialog,u.p.updatemsaprofilenamedialog,u.p.joinlinkdialog,u.p.autobrbconfirmationdialog,u.p.framework,u.p.officeintegrationfredialog],supportedRenderModes:[L.OQr.Main,L.OQr.Modal,L.OQr.Rail,L.OQr.ThinHorizontalBar,L.OQr.TitleBar,L.OQr.VerticalBar],windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20}},Av="identity",_v="addNewAccount",Dv="switchAccount",Fv="switchTenants",Mv="manageTenant",Rv="openMeControl",Pv={onEventReceived:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.requestContext.loggerFactory.newLogger("apps-shell-event-handler"),n=e.requestContext.userBiService,i=e.requestContext.scenarioFactory,a=e.eventInput.event;if(a.originator===Op.DQ)return((e,t,n)=>{var i,a;switch(e.type){case Op.iC.launch:if(!e.data)return void t.error("Received a launch event without data!");const o=e.data(),r=Gp(o,t),s=null===(i=n.createDatabag)||void 0===i?void 0:i.call(n);return s&&(s.launchTileId=o.tileID,s.launchTilePosition=o.tilePosition,s.launchTileEventType=null===(a=o.reactEvent)||void 0===a?void 0:a.type,s.launchTileAppName=null==r?void 0:r.appName),n.recordPanelAction({actionGesture:Da.uS.click,actionOutcome:Da.$K.submit,actionScenario:Da.Tk.openAppFromAppBar,actionScenarioType:Da.Yu.appBar,moduleName:Da.rA.novaAppBar,panelRegion:Da.Ai.left,dataBag:s},t),null==s||s.dispose(),null==r?void 0:r.appViewCommand;default:return void t.warn(`Received an unhandled Launch tile event, type: ${e.type}`)}})(a,t,n);if(a.originator===Op.tL)return{command:Hp()};if(a.originator===Op.Ug&&a.type===Op.iC.appBarImpression&&i.stopScenarioIfActive(ft.RG.AppBarLoad),a.originator!==Op.Ug||a.type!==Op.iC.renderError){if(a.originator===Op.Ug&&a.type===Op.iC.flyoutOpened)return{command:Zm()};if("MeControl"===a.originator)switch(a.type){case _v:return{command:{actor:Av,action:_v,data:{commandSource:Ot.D.AddAccountFromMeMenu}}};case Fv:return{command:{actor:Av,action:Fv,data:a.data?a.data():void 0}};case Mv:return{command:{actor:Av,action:Mv,data:a.data?a.data():void 0}};case Dv:return{command:{actor:Av,action:Dv,data:a.data?a.data():void 0}};case Rv:return{command:{actor:Av,action:Rv}};default:return Promise.resolve(void 0)}}else{let e;a.data&&(e=a.data()),t.errorToTelemetry&&t.errorToTelemetry("AppBar render failed!","webclient_framework_shell_appbar_render_failure_event"),t.error("AppBar Render Error:",null==e?void 0:e.error),t.error("AppBar React Error Info:",null==e?void 0:e.errorInfo);const n=i.findScenario(ft.RG.AppBarLoad);n&&n.fail()}}))},Ov=({type:e,appRenderMode:t})=>{const n=new Dt.H,i=[];return e===u.p.pearnotdefaultapp&&t===s.S.Main&&i.push(Ft.GZ.APP_SWITCHER_CONFIRMATION_RENDERED),n.registerAppPhase({phase:Ft.nh.CRITICAL,signals:i,timeout:5e3}),n.appPhases};function xv(e){const{coreSettings:t,i18n:n,entityCommanding:a,loggerFactory:o}=e,r=o.newLogger("DesktopUnsupportedVersionCheckJob"),{enableDesktopMinimumVersionBanner:s}=t.get(K.J.Core);if(s)return{id:"desktop-minimum-version-check-job",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){(function(e,t){const{minimumDesktopVersion:n}=t.get(K.J.Core),{desktopVersion:i}=t.get(K.J.Host);var a;if(n&&i)return a=n,-1===i.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"})&&(e.log("Unsupported desktop version detected."),!0);e.log("Desktop versions not found. Desktop version check skipped.")})(r,t)&&function(e,t,n,i,a,o){t.shell.showBanner({id:e,source:Ot.D.ShellVersionCheck,bannerScenario:a,intentLevel:L.XuV.Severe,cause:L.lFB.UnsupportedAppVersionDetected,text:n.stringTranslate("framework",a),action:{text:n.stringTranslate("framework",o),command:{entity:{type:u.p.externalnavigation,action:u.u.confirm,id:Zn.Y.Notifications}},dismissOnAction:!0},dismissable:!0,duration:0}),i.log("Desktop sedimentation banner displayed")}("DesktopSedimentationBanner",a,n,r,"desktopapp_version_unsupported_generic_banner","more_options_menu_initiate_update")}))};r.log("Sedimentation banner disabled by feature flag")}const Lv=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(34983),n.e(48177),n.e(56845),n.e(78998),n.e(61130),n.e(87568),n.e(70946),n.e(17353),n.e(63167),n.e(3273),n.e(11023),n.e(84733),n.e(5227),n.e(23948),n.e(31810),n.e(62514),n.e(21439),n.e(50840),n.e(44413),n.e(23054),n.e(23810),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(79e3),n.e(50352),n.e(14295),n.e(5271)]).then(n.bind(n,885360)),Uv=()=>Promise.all([n.e(287),n.e(47113),n.e(15803),n.e(35235),n.e(35799),n.e(50611),n.e(22681),n.e(34983),n.e(2555),n.e(62514),n.e(84395),n.e(50352),n.e(97526)]).then(n.bind(n,702370)),Bv=({host:e,screenState:t,isResize:n})=>{if(n){if(!Ev.windowFeatures)return null;const e=Ev.windowFeatures,{offset:t}=e;return(0,i.__rest)(e,["offset"])}const{height:a,minHeight:o,minWidth:r,offset:s,width:l}=Ev.windowFeatures||{},d={left:(null==e?void 0:e.screenX)||0,top:(null==e?void 0:e.screenY)||0},c=((null==t?void 0:t.numOpenWindows)||1)*(s||1);return{additionalFeatures:{minHeight:`${o}`,minWidth:`${r}`},height:a,left:(null==d?void 0:d.left)+c,minHeight:o,minWidth:r,top:(null==d?void 0:d.top)+c,width:l}};function jv(e){const t=null==e?void 0:e.isMainWindow;t&&(()=>{var e,t;null===(e=Ev.supportedRenderModes)||void 0===e||e.push(L.OQr.PartialOverlay),null===(t=Ev.supportedRenderModes)||void 0===t||t.push(L.OQr.OverlayThinHorizontalBar)})();return{getAppPhases:Ov,getAppViewEntities:Ip,getAppViewEntitiesProps:Pp,getAppWindowFeatures:Bv,getEventScenarioData:Jp,manifest:Ev,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;if(t){const e="shell-app";n("ChunkLoadStarted",{chunkName:e}),i=(yield(0,d.mT)(Lv,e,a)).T2ShellViewsRenderer,n("ChunkLoadSucceeded",{chunkName:e})}else{const e="mw-shell-app";n("ChunkLoadStarted",{chunkName:e}),i=(yield(0,d.mT)(Uv,e,a)).T1ShellViewsRenderer,n("ChunkLoadSucceeded",{chunkName:e})}return o.createElement(i,{appRenderMode:e})})),onPreWarm:e=>{const{context:t}=e,n=[hv(t),kv(t),Cv(t),Tv(t)],i=function(e){const{client:t,coreSettings:n}=e,i=t;if(n.get(K.J.CdlWorker).enableStartupDeferral)return{id:"worker-start-sync",runOncePerId:!0,job:()=>{i.mutate({mutation:Iv,fetchPolicy:"no-cache",variables:{}})}}}(t);i&&n.push(i);const a=xv(t);return a&&n.push(a),n},onBeforeDeeplinkParsed:gv,eventHandlers:Pv,onBeforeIntentAuthenticated:vv,onBeforeCommandHandled:mv}}const Wv=e=>{if(Vv(e))return Hv(e)?{subNavEntity:$v(e),headerEntity:zv(e),startEntity:Gv(e),mainEntity:qv(e),endEntity:Qv(e)}:null},Vv=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.signoutdialog,u.p.smartdeviceagendapage,u.p.smartdevicelogin].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},Hv=()=>!0,$v=()=>null,zv=()=>null,Gv=()=>null,qv=({entity:e})=>e,Qv=()=>null,Jv={id:"com.microsoft.teams.smart-devices",name:"SmartDevicesApp",supportedEntities:[u.p.smartdeviceagendapage,u.p.smartdevicelogin,u.p.smartdevicelogoutdialog],supportedRenderModes:[s.S.Main,s.S.Modal]},Yv=()=>Promise.all([n.e(86191),n.e(79188)]).then(n.bind(n,170037)),Kv=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(92983),n.e(64380),n.e(51778),n.e(61724),n.e(62514),n.e(58016),n.e(15370),n.e(5592),n.e(46263),n.e(89386),n.e(92338)]).then(n.bind(n,502491)),Zv=()=>Promise.all([n.e(47113),n.e(13228),n.e(73198),n.e(80859)]).then(n.bind(n,293138));function Xv(){const e=()=>null;return{getAppViewEntities:Wv,manifest:Jv,render:({appRenderMode:t,loggerFactory:n,onRenderEvent:a,scenarioFactory:r,entity:c})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{type:i}=c,m=n.newLogger("SmartDevicesApp"),g="smart-devices-app";if(t===s.S.Modal){const{SmartDeviceModal:e}=yield(0,d.mT)(Zv,g,r);return o.createElement(e,{entityType:i})}if(t===s.S.Main){let t;switch(i){case u.p.smartdeviceagendapage:const{SmartDeviceAgendaPage:e}=yield(0,d.mT)(Kv,g,r);t=o.createElement(e,null);break;case u.p.smartdevicelogin:const{SmartDeviceLogin:n}=yield(0,d.mT)(Yv,g,r);t=o.createElement(n,null)}return t?(a("ChunkLoadStarted",{chunkName:g}),a("ChunkLoadSucceeded",{chunkName:g}),m.log("render: loading smart devices app"),o.createElement(l.f,{namespace:"smartDevice",loaderRenderer:null},o.createElement(l.f,{namespace:"calling",loaderRenderer:null},t))):o.createElement(e,null)}return o.createElement(e,null)}))}}const eh={id:"com.microsoft.teams.spaces",name:"SpacesApp",supportedEntities:[u.p.spaces],supportedRenderModes:[s.S.Main]},th=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(92983),n.e(50611),n.e(2555),n.e(34554),n.e(62514),n.e(21439),n.e(96147),n.e(15370),n.e(5592),n.e(46263),n.e(20749)]).then(n.bind(n,734030));function nh(){const e=()=>null;return{manifest:eh,render:({appRenderMode:t,coreSettings:n,onRenderEvent:a,scenarioFactory:r})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main&&n.get(K.J.DropInSpaces).enableDropInSpacesApp){const e="spaces";a("ChunkLoadStarted",{chunkName:e});const{Spaces:t}=yield(0,d.mT)(th,e,r);return a("ChunkLoadSucceeded",{chunkName:e}),o.createElement(t,null)}return o.createElement(e,null)}))}}const ih=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("StoreApp onCommandReceived");if(e.command.actor===Wp)switch(n){case Vp:return{entity:{type:u.p.store,action:u.u.view},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.Unknown}}};default:i.error(`Command action '${n}' is not supported by StoreApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by StoreApp.`)})),ah=e=>{if(oh(e))return rh(e)?{subNavEntity:sh(e),headerEntity:lh(e),startEntity:dh(e),mainEntity:ch(e),endEntity:uh(e)}:null},oh=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.store].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},rh=()=>!0,sh=()=>null,lh=()=>null,dh=()=>null,ch=({entity:e})=>e,uh=()=>null,mh={id:"com.microsoft.teams.store",name:"StoreApp",actors:[Wp],supportedEntities:[u.p.store,u.p.storefre],supportedRenderModes:[s.S.Main,s.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},gh=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(60567),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(75912),n.e(45746),n.e(19351),n.e(96271),n.e(7983),n.e(1839),n.e(14085),n.e(45470),n.e(47333),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(38393),n.e(50840),n.e(21767),n.e(33876),n.e(2205),n.e(58163),n.e(99352),n.e(51150),n.e(88591),n.e(9078),n.e(84616),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(79e3),n.e(81433),n.e(50352),n.e(31693),n.e(6075),n.e(2116),n.e(42256),n.e(26891),n.e(94339),n.e(67638),n.e(22568),n.e(80097),n.e(57990),n.e(97130)]).then(n.bind(n,143014)),ph=()=>Promise.all([n.e(70724),n.e(47113),n.e(13228),n.e(2765),n.e(23102),n.e(5592),n.e(91104),n.e(33944),n.e(22099)]).then(n.bind(n,947200)),vh=()=>n.e(25270).then(n.bind(n,968643)),hh=()=>Promise.all([n.e(88591),n.e(59098)]).then(n.bind(n,49106));function fh(){const e=()=>null;return{getPlatformAppIdForEntity:e=>e.type===u.p.store?"ac40aa4a-fef1-4896-aea2-46d1c14dbfd5":void 0,onCommandReceived:ih,getAppViewEntities:ah,manifest:mh,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="store-app";n("ChunkLoadStarted",{chunkName:e});const[{StoreEntryRenderer:t}]=yield Promise.all([(0,d.mT)(gh,e,a),(0,d.mT)(vh,e,a),(0,d.mT)(hh,e,a)]);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(t,null))}if(t===s.S.Modal){const e="store-fre-modal";n("ChunkLoadStarted",{chunkName:e});const{Modal:t}=yield(0,d.mT)(ph,e,a);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(t,null))}return o.createElement(e,null)}))}}const yh={id:"com.microsoft.teams.survey-form",name:"SurveyFormApp",supportedEntities:[u.p.survey,u.p.givefeedbackchoices],supportedRenderModes:[s.S.Main,s.S.Modal],windowFeatures:{[u.p.survey]:{minWidth:600,width:800,minHeight:400,height:640,offset:20},[u.p.givefeedbackchoices]:{minWidth:602,width:602,minHeight:500,height:500,offset:20}}},kh=e=>{if(Sh(e))return bh(e)?{subNavEntity:Ch(e),headerEntity:wh(e),startEntity:Nh(e),mainEntity:Th(e),endEntity:Ih(e)}:null},Sh=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o={[u.p.givefeedbackchoices]:[u.u.default,u.u.view],[u.p.survey]:[u.u.default,u.u.view]},r=n&&(o[i]||[]).includes(n);return!(!a||!r)},bh=()=>!0,Ch=()=>null,wh=()=>null,Nh=()=>null,Th=({entity:e})=>e,Ih=()=>null,Eh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"bootstrapFloodgate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"firstLoginInformation"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bootstrapFloodgate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"firstLoginInformation"},value:{kind:"Variable",name:{kind:"Name",value:"firstLoginInformation"}}},{kind:"Argument",name:{kind:"Name",value:"userSurveyNotificationEnabled"},value:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}}}]}]}}]},Ah={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"onSurveySend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"onSurveySend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"coachmarkId"}}]}}]}}]},_h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategorySubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferencesChangedEventForCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userEnableSurveysNotification"}}]}}]}}]},Dh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsSurveyFormFloodgateUpdateUserSurveyNotificationEnabledMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"floodgateUpdateUserSurveyNotificationEnabled"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userSurveyNotificationEnabled"},value:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}}}]}]}}]},Fh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfo"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"firstLoginInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"}}]}}]},Mh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategoryQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferencesForCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformationValue"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategoryFragment"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserEnableSurveysNotificationValue"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userEnableSurveysNotification"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategoryFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"}}]}}]},Rh="telemetry_instrumentation_feedback_platform_app_job_setup_floodgate",Ph=(e,t,n,a,o)=>({id:"bootstrap-floodgate",runOncePerId:!0,job:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var r,s,l;const d=n.newLogger("getBootstrapFloodgateJob");d.log("[getBootstrapFloodgateJob] Initializing floodgate");try{let n;n=o?yield(c=e,(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e,t;const n=yield c.query({query:Mh,variables:{category:"firstLoginInformation"}});return"FirstLoginInformationValue"===(null===(e=n.data)||void 0===e?void 0:e.userPreferencesForCategory.__typename)?null===(t=n.data)||void 0===t?void 0:t.userPreferencesForCategory.firstLoginInformation:null}))):yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;return null===(n=null===(t=(yield e.query({query:Fh})).data)||void 0===t?void 0:t.userPreferences)||void 0===n?void 0:n.firstLoginInformation})))(e);const u=null!==(r=null==n?void 0:n.Web)&&void 0!==r?r:"",m=yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;const i=yield e.query({query:Mh,variables:{category:"userEnableSurveysNotification"}});return"UserEnableSurveysNotificationValue"===(null===(t=i.data)||void 0===t?void 0:t.userPreferencesForCategory.__typename)?null===(n=i.data)||void 0===n?void 0:n.userPreferencesForCategory.userEnableSurveysNotification:null})))(e);u?null===(l=d.log)||void 0===l||l.call(d,"First login information is available! with enableUserPreferencesForCategoryQuery : "+(o?"enabled":"disabled"),Rh):null===(s=d.errorToTelemetry)||void 0===s||s.call(d,"First login information is not available! with enableUserPreferencesForCategoryQuery : "+(o?"enabled":"disabled"),Rh);const g=yield e.subscribe({query:Ah,fetchPolicy:"no-cache"}).subscribe((({data:e,errors:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;if(n){d.error("[getBootstrapFloodgateJob] Error subscribing to floodgate. Stopping the subscription");try{g.unsubscribe()}catch(e){d.error("[getBootstrapFloodgateJob] Error stopping floodgate")}}null===(i=d.log)||void 0===i||i.call(d,`Activated survey: ${null==e?void 0:e.onSurveySend.id} with coachmark ${null==e?void 0:e.onSurveySend.coachmarkId}`,Rh),(null==e?void 0:e.onSurveySend.coachmarkId)&&(yield t.esp.displaySurface(e.onSurveySend.coachmarkId),a.newScenario(ft.RG.FloodgateSurvey).stop({context:JSON.stringify({surveyId:null==e?void 0:e.onSurveySend.id,coachmarkId:null==e?void 0:e.onSurveySend.coachmarkId})}))}))));yield e.mutate({mutation:Eh,variables:{firstLoginInformation:u,userSurveyNotificationEnabled:m}});const p=yield e.subscribe({query:_h,variables:{category:"userEnableSurveysNotification"},fetchPolicy:"no-cache"}).subscribe((({data:t,errors:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;if(n){d.error("[getBootstrapFloodgateJob] Error subscribing to userSettings. Stopping the subscription");try{p.unsubscribe()}catch(e){d.error("[getBootstrapFloodgateJob] Error stopping userSurveyNotificationEnabledSubscription")}}yield e.mutate({mutation:Dh,variables:{userSurveyNotificationEnabled:null===(i=null==t?void 0:t.userPreferencesChangedEventForCategory)||void 0===i?void 0:i.userEnableSurveysNotification}})}))))}catch(e){d.error(`[getBootstrapFloodgateJob] Error initializing floodgate [error.name=${null==e?void 0:e.name}]`)}var c;d.log("[getBootstrapFloodgateJob] Floodgate initialized")}))}),Oh=({context:{client:e,coreSettings:t,loggerFactory:n,entityCommanding:i,scenarioFactory:a}})=>{const{enableFloodgateService:o,enableUserPreferencesForCategoryQuery:r}=t.get(K.J.Feedback),s=[],l=e;return o&&s.push(Ph(l,i,n,a,r)),s},xh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsSurveyFormFloodgateLogActivityMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activityName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"increment"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"floodgateLogActivity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activityName"},value:{kind:"Variable",name:{kind:"Name",value:"activityName"}}},{kind:"Argument",name:{kind:"Name",value:"increment"},value:{kind:"Variable",name:{kind:"Name",value:"increment"}}}]}]}}]};class Lh extends Fe{constructor(){super(De.Yg.GeneralizedLogActivityTask,["client","hostCommunicationService","coreSettings","loggerFactory"])}execute(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:i,hostCommunicationService:a,coreSettings:o,loggerFactory:r}=e,s=r.newLogger("generalizedLogActivityTask");if(null==o?void 0:o.get(K.J.SurveyForm).enableCsatTaskRegistration){if(!a)return;try{const e=yield a.loadModule("surveyform"),n=null===(t=null==e?void 0:e.registerForLogActivity)||void 0===t?void 0:t.call(e,(e=>{((e,t,n)=>{e.mutate({mutation:xh,variables:{activityName:t,increment:n}})})(i.client,e.activityName,e.incrementValue)}));return()=>{n&&n()}}catch(e){return void(null===(n=s.errorToTelemetry)||void 0===n||n.call(s,`Loading module surveyform failed with errorCode: ${e.errorCode}`,"generalized_log_activity_task"))}}}))}}const Uh=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(287),n.e(47113),n.e(15803),n.e(35235),n.e(35799),n.e(22681),n.e(60567),n.e(34983),n.e(73208),n.e(62514),n.e(98557),n.e(98234),n.e(84395),n.e(14295),n.e(11286)]).then(n.bind(n,728031)),Bh=({host:e,entityType:t})=>{if(!e)return null;const{windowFeatures:n}=yh,i=t&&n&&n[t]?n[t]:null!=n?n:void 0,{height:a=1,width:o=1,minHeight:r,minWidth:s}=i||{},l={left:e.screenX,top:e.screenY};if(e.screen){return{left:l.left+e.screen.availWidth/2-o,top:l.top+e.screen.availHeight/2-a,additionalFeatures:{minHeight:`${r}`,minWidth:`${s}`},minHeight:r,minWidth:s,height:a,width:o}}return{left:l.left,top:l.top,additionalFeatures:{minHeight:`${r}`,minWidth:`${s}`},minHeight:r,minWidth:s,height:a,width:o}};function jh(){return{getAppViewEntities:kh,getAppWindowFeatures:Bh,manifest:yh,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="survey-form-entry";t("ChunkLoadStarted",{chunkName:i});const a=(yield(0,d.mT)(Uh,i,n)).SurveyAppViewsRenderer;return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(l.f,{namespace:"survey",loaderRenderer:null},o.createElement(a,{appRenderMode:e}))})),onPreWarm:Oh,onRegister:e=>{e.registerTask(new Lh)}}}const Wh={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}}]}}]}}]},Vh={onEventReceived:({eventInput:e,requestContext:{client:t,viewEntity:n}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a,o,r,s,l;switch(e.event.type){case og.uS.expandTab:{const t=null===(a=(i=e.event).data)||void 0===a?void 0:a.call(i);return Promise.resolve({command:ag.CN.expandTab(t)})}case og.uS.resetLayoutOverrides:return Promise.resolve({command:ag.CN.resetLayoutOverrides()});case un.uS.requestPersonMoreInfo:{const i=null===(r=(o=e.event).data)||void 0===r?void 0:r.call(o);let a=!1,s="";if(null==n?void 0:n.id){const{data:{chat:e}}=yield t.query({query:Wh,variables:{convId:null==n?void 0:n.id}});a=!!(null==e?void 0:e.substrateGroupId),s=(null==e?void 0:e.tenantId)||""}const l=vn(Object.assign(Object.assign(Object.assign(Object.assign({},i),s&&{tenantId:s}),(null==n?void 0:n.id)&&{conversationId:null==n?void 0:n.id}),{isSharedChannel:a}));return Promise.resolve({command:l})}case un.uS.requestTopicMoreInfo:{const t=null===(l=(s=e.event).data)||void 0===l?void 0:l.call(s);return Promise.resolve({command:hn(Object.assign({},t))})}}return Promise.resolve(void 0)}))};var Hh,$h,zh,Gh,qh;!function(e){e.teamDashboard="/l/team-dashboard",e.channelDashboard="/l/channel-dashboard",e.pendingInvites="/l/manage-teams/myinvites",e.channel="/l/channel",e.replyChain="/l/message",e.team="/l/team"}(Hh||(Hh={})),function(e){e.FeatureNotEnabled="Feature for parsing T1 teams and channels deep links in T2.1 is not enabled",e.NoChannelId="Parsed teams and channels deep link does not contain the channel id",e.NoThreadId="Parsed teams and channels deep link does not contain the thread id",e.InvalidDeeplinkType="Parsed teams and channels deep link does not contain a valid deeplink type",e.NoTabId="Parsed teams and channels deep link does not contain the tab id"}($h||($h={})),function(e){e.FeatureNotEnabled="channel_on_before_deep_link_parsed_feature_not_enabled_error",e.NoChannelId="channel_on_before_deep_link_parsed_no_channel_id_error",e.NoThreadId="channel_on_before_deep_link_parsed_no_thread_id_error",e.InvalidDeeplinkType="channel_on_before_deep_link_parsed_invalid_deeplink_type_error",e.NoTabId="channel_on_before_deep_link_parsed_no_tab_id_error"}(zh||(zh={})),function(e){e.TeamDashboard="team-dashboard",e.ChannelDashboard="channel-dashboard",e.TeamsDashboard="manage-teams"}(Gh||(Gh={})),function(e){e.MembersId="td.members",e.SettingsId="td.settings",e.AppsId="td.apps",e.PendingRequestsId="td.joinRequests",e.ChannelsId="td.channels",e.AnalyticsId="td.analytics",e.SharedChannelPendingRequestsId="sharedChannelPendingRequests",e.TagsId="td.tags"}(qh||(qh={}));const Qh=({deeplinkUrl:e,parsedDeeplinkHash:t,context:{coreSettings:n,loggerFactory:i,scenarioFactory:a}})=>{var o,r;const s=i.newLogger("TeamsAndChannelsApp onBeforeDeeplinkParsed"),{enablePlatformDeepLinkRouting:l}=n.get(K.J.Extensibility),{enableParseT1TeamsAndChannelsDeeplinks:d}=n.get(K.J.Channels);if(!d)throw null===(o=s.errorToTelemetry)||void 0===o||o.call(s,$h.FeatureNotEnabled,zh.FeatureNotEnabled),Error($h.FeatureNotEnabled);let c,u,m,g,p,v={};if(null==t?void 0:t.search){const{search:e}=t;s.log(`Parsing parsedDeeplinkHash - channelId: ${e.threadId}, replyChainId: ${e.replyChainId}, messageId: ${e.messageId}, tenantId: ${e.tenantId}`),c=e.threadId,u=e.replyChainId,m=e.messageId,g=e.tenantId}else{const{pathname:t,search:n}=e;s.log(`Parsing deeplinkUrl - pathname: ${t}, search: ${n}`);const i=t.split("/"),a=null==t?void 0:t.split(/[/?&]/),o=null==a?void 0:a.indexOf("channel");p=null==a?void 0:a[o+2];const r=i.findIndex((e=>e.startsWith(Io.at.SkypeSpacesThread)));c=i[r];const l=new URLSearchParams(n),d=l.get("context");v=d&&JSON.parse(d),u=l.get("parentMessageId")||void 0,m=u&&r+1<i.length?i[r+1]:void 0,g=l.get("tenantId")||void 0}if(c)return l&&(null==p?void 0:p.includes("tab::"))?(s.log(`toPlatformTabNavigationIntent - tabId: ${p} channelId: ${c}, deeplinkContext: ${v}, tenantId: ${g}`),Kh(c,e,g,v,p,a)):(s.log(`toNavigationIntent - channelId: ${c}, replyChainId: ${u}, messageId: ${m}, tenantId: ${g}`),Yh(c,u,m,g));throw null===(r=s.errorToTelemetry)||void 0===r||r.call(s,$h.NoChannelId,zh.NoChannelId),Error($h.NoChannelId)},Jh=({deeplinkUrl:e,preferredCommandInput:t,context:{loggerFactory:n}})=>{var i,a,o;const r=n.newLogger("TeamsAndChannelsApp onBeforeDeeplinkParsed"),{pathname:s}=e;r.log(`Parsing deeplinkUrl - pathname: ${s}`);const l=s.split("/"),d=l[2];let c;switch(d){case Gh.TeamsDashboard:return r.log(`toNavigationTeamsDashboard - deeplinkType: ${d}`),tf(t);case Gh.TeamDashboard:case Gh.ChannelDashboard:const e=l.findIndex((e=>e.startsWith(Io.at.SkypeSpacesThread))),n=l[e];if(!n)throw null===(i=r.errorToTelemetry)||void 0===i||i.call(r,$h.NoThreadId,zh.NoThreadId),Error($h.NoThreadId);if(c=l[4],!c)throw null===(a=r.errorToTelemetry)||void 0===a||a.call(r,$h.NoTabId,zh.NoTabId),Error($h.NoTabId);return r.log(`toNavigationThreadDashboard - deeplinkType: ${d}, threadId: ${n}, tab: ${c}`),Zh(d,n,c,t);default:throw null===(o=r.errorToTelemetry)||void 0===o||o.call(r,$h.InvalidDeeplinkType,zh.InvalidDeeplinkType),Error($h.InvalidDeeplinkType)}},Yh=(e,t,n,i)=>Promise.resolve({entityCommand:{entity:{type:u.p.channels,action:u.u.view,id:JSON.stringify({channelId:e,replyChainId:t})},command:{stateTransition:c.su.new,visibilityState:c.fe.show},entityOptions:{deepLinkId:n}},metadata:{allowAnonymous:!1,tenantId:i}}),Kh=(e,t,n,i,a,o)=>{var r,s;null===(r=null==o?void 0:o.findScenario(ft.RG.PlatformTabDeeplinkHandling))||void 0===r||r.cancel();const l=null==o?void 0:o.newScenario(ft.RG.PlatformTabDeeplinkHandling);l&&(null===(s=null==o?void 0:o.hoistScenarioToCore)||void 0===s||s.call(o,l)),null==l||l.appendEventData({"PlatformTabDeeplink.pathname":t.pathname,"PlatformTabDeeplink.search":t.search}),null==l||l.mark("create_deeplink_command");const d={entityCommand:{entity:{type:u.p.extensions,action:u.u.view,id:JSON.stringify({appId:null,threadId:e,tabId:a,tabEntityId:null}),linkedEntity:{id:JSON.stringify({channelId:e}),type:u.p.channels,action:u.u.view}},command:{stateTransition:c.su.forceFlush,visibilityState:c.fe.show},entityOptions:{subEntityId:null==i?void 0:i.subEntityId,entryPoint:Lm.mQ.channelTab,source:Ot.D.PlatformTabDeepLink,deeplinkStartedTime:Date.now(),originalDeeplink:t}},metadata:{allowAnonymous:!1,tenantId:n}};return null==l||l.mark("return_deeplink_command"),null==l||l.appendEventData({"PlatformTabDeeplink.generatedCommand":d.toString()}),Promise.resolve(d)},Zh=(e,t,n,i)=>{var a,o;const r=e===Gh.TeamDashboard?Xh(n):ef(n);return Promise.resolve({entityCommand:{entity:{type:r,action:u.u.view,id:t},command:{stateTransition:null!==(a=null==i?void 0:i.stateTransition)&&void 0!==a?a:c.su.flush,visibilityState:null!==(o=null==i?void 0:i.visibilityState)&&void 0!==o?o:c.fe.show}},metadata:{allowAnonymous:!1}})},Xh=e=>{switch(e){case qh.AnalyticsId:return u.p.teamanalytics;case qh.ChannelsId:return u.p.teamchannels;case qh.SettingsId:return u.p.teamsettings;case qh.AppsId:return u.p.teammanageapps;case qh.PendingRequestsId:return u.p.teampendingrequests;case qh.TagsId:return u.p.teammanagetags;default:return u.p.teammanage}},ef=e=>{switch(e){case qh.AnalyticsId:return u.p.channelanalytics;case qh.SettingsId:return u.p.channelsettings;case qh.SharedChannelPendingRequestsId:return u.p.channelinvitations;case qh.MembersId:return u.p.channelmembers;case qh.TagsId:return u.p.channeltags;default:return u.p.channelmanage}},tf=e=>{var t,n;return Promise.resolve({entityCommand:{entity:{type:u.p.sharedchannelspendinginvites,action:u.u.view},command:{stateTransition:null!==(t=null==e?void 0:e.stateTransition)&&void 0!==t?t:c.su.flush,visibilityState:null!==(n=null==e?void 0:e.visibilityState)&&void 0!==n?n:c.fe.show}},metadata:{allowAnonymous:!1}})},nf=[{filter:Hh.teamDashboard,execute:Jh},{filter:Hh.channelDashboard,execute:Jh},{filter:Hh.pendingInvites,execute:Jh},{filter:Hh.channel,execute:Qh},{filter:Hh.replyChain,execute:Qh},{filter:Hh.team,execute:Qh},{filter:(e,t)=>{var n;return!!e.hash&&"channel"===(null===(n=null==t?void 0:t.search)||void 0===n?void 0:n.ctx)},execute:Qh}],af={shouldAddEntitiesToWindowHistory:()=>!0,shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:e=>{if((null==e?void 0:e.type)===u.p.schoolteams)return!0;if((null==e?void 0:e.type)!==u.p.channels)return!1;const{replyChainId:t}=(0,Xs.jd)((null==e?void 0:e.id)||"");return!t}},of=[u.p.teammanage,u.p.teamchannels,u.p.teampendingrequests],rf=[u.p.channelmanage,u.p.channelmembers,u.p.channelinvitations],sf=[u.p.sharedchannelspendinginvites],lf=({action:e,appRenderMode:t,coreSettings:n,type:i,logger:a})=>{const o=new Dt.H,{enableComposeCriticalPhaseLoad:r=!1,enableComposeCriticalPhaseLoadForPopout:l=!1,enableComposeCriticalPhaseLoadSecondaryViewport:d=!1,enableComposeCriticalPhaseLoadSecondaryViewportGate:c=!1}=n.get(K.J.Messaging),{enableHybridChannelList:u=!1,msgEnableChannelsV2:m=!1,msgEnableChannelsV2Header:g=!1}=n.get(K.J.Host),{channelPhaseTimeoutSettings:p}=n.get(K.J.TeamsAndChannels),v=[],h=[];switch(t){case s.S.HorizontalBar:df({action:e,type:i,logger:a,criticalSignals:v,featureFlags:{msgEnableChannelsV2Header:g,msgEnableChannelsV2:m},postCriticalSignals:h});break;case s.S.Main:cf({action:e,type:i,logger:a,criticalSignals:v,featureFlags:{enableComposeCriticalPhaseLoad:r,enableComposeCriticalPhaseLoadForPopout:l,enableComposeCriticalPhaseLoadSecondaryViewport:d,enableComposeCriticalPhaseLoadSecondaryViewportGate:c,msgEnableChannelsV2:m},postCriticalSignals:h});break;case s.S.Rail:uf({action:e,criticalSignals:v,featureFlags:{enableHybridChannelList:u},postCriticalSignals:h,type:i})}return o.registerAppPhase({phase:Ft.nh.CRITICAL,signals:v,timeout:(null==p?void 0:p.critical)||25e3}),o.registerAppPhase({phase:Ft.nh.POST_CRITICAL,signals:h,timeout:(null==p?void 0:p.postCritical)||1e4}),o.appPhases},df=({action:e,criticalSignals:t,featureFlags:{msgEnableChannelsV2Header:n,msgEnableChannelsV2:i},type:a,logger:o})=>{a===u.p.schoolteams&&e===u.u.list?t.push(Ft.GZ.TEAMS_GRID_VIEW_HEADER_RENDERED):i&&n&&a===u.p.channels&&(e===u.u.default||e===u.u.view)?t.push(Ft.GZ.CHANNEL_HEADER_RENDERED):a&&of.includes(a)?t.push(Ft.GZ.TEAM_DASHBOARD_HEADER_RENDERED):a&&rf.includes(a)?t.push(Ft.GZ.CHANNEL_DASHBOARD_HEADER_RENDERED):a&&sf.includes(a)?t.push(Ft.GZ.TEAMS_DASHBOARD_HEADER_RENDERED):null==o||o.log(`Not adding header slot phase signals for action: ${e}, type: ${a}, msgEnableChannelsV2: ${i}, msgEnableChannelsV2Header: ${n}`)},cf=({action:e,criticalSignals:t,featureFlags:{enableComposeCriticalPhaseLoad:n,enableComposeCriticalPhaseLoadForPopout:i,enableComposeCriticalPhaseLoadSecondaryViewport:a,enableComposeCriticalPhaseLoadSecondaryViewportGate:o,msgEnableChannelsV2:r},postCriticalSignals:s,type:l,logger:d})=>{if(l===u.p.schoolteams&&e===u.u.list)t.push(Ft.GZ.TEAMS_GRID_VIEW_RENDERED);else if(!r||l!==u.p.channels||e!==u.u.default&&e!==u.u.view)l&&of.includes(l)?t.push(Ft.GZ.TEAM_DASHBOARD_VIEW_RENDERED):l&&rf.includes(l)?t.push(Ft.GZ.CHANNEL_DASHBOARD_VIEW_RENDERED):l&&sf.includes(l)?t.push(Ft.GZ.TEAMS_DASHBOARD_VIEW_RENDERED):null==d||d.log(`Not adding main slot phase signals for action: ${e}, type: ${l}, msgEnableChannelsV2: ${r}`);else{t.push(Ft.GZ.MESSAGES_RENDERED);const e=i&&o&&a;n||e?t.push(Ft.GZ.COMPOSE_LOADED):s.push(Ft.GZ.COMPOSE_LOADED),s.push(Ft.GZ.MESSAGE_REACTIONS_RENDERED,Ft.GZ.PRESENCES_RENDERED,Ft.GZ.VIRTUAL_LIST_RENDER_BUFFER_FILLED)}},uf=({action:e,criticalSignals:t,featureFlags:{enableHybridChannelList:n},type:i})=>{i===u.p.channels&&e===u.u.list?n&&t.push(Ft.GZ.CHANNEL_LIST_ITEMS_RENDERED):i===u.p.schoolteams&&e===u.u.view&&t.push(Ft.GZ.SINGLE_TEAM_VIEW_LEFT_RAIL_LOADED)};class mf{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}default(e){return this.commandHandler({entity:{type:u.p.channels,action:u.u.default},command:e})}channelDeeplinkWithMessageId(e,t,n){return this.commandHandler({entity:{type:u.p.channels,action:u.u.view,id:e},command:t,entityOptions:n})}channelMessagesById(e,t,n,i,a,o){const r={channelId:e,replyChainId:t};return this.commandHandler({entity:{type:u.p.channels,action:u.u.view,id:JSON.stringify(r)},command:i,entityOptions:Object.assign(Object.assign({},a),{deepLinkId:n}),scenarioEventData:null==o?void 0:o.scenarioEventData})}toggleChannelInfoPane(e,t){const{channelId:n}=gf(e),i=JSON.stringify({channelId:n});return this.commandHandler({entity:{type:u.p.channels,action:u.u.info,id:i},command:t})}toggleChannelInfoPaneExpandedView(e,t,n){const{channelId:i,replyChainId:a}=gf(e),o=JSON.stringify({channelId:i,replyChainId:a});return this.commandHandler({entity:{type:n,action:u.u.info,id:o,linkedEntity:{id:e,type:u.p.channels}},command:t})}showDefaultNavigationDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.defaultchannelnavdialog,action:u.u.view},{entityCommand:t,entityOptions:e})}launchCrossPostChannelSelectionDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.crosspostchannelselectiondialog,action:u.u.view},{entityCommand:this.getDefaultEntityCommand(t,c.su.extend),entityOptions:{selectedChannelIds:e}})}launchCrossPostChannelSelectionDialogV2(e,t){return this.extensionCommanding.executeCommand({type:u.p.crosspostchannelselectiondialogV2,action:u.u.view},{entityCommand:{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:t}},entityOptions:{selectedChannelIds:e}})}launchCrossPostDeleteDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.crosspostdeletedialog,action:u.u.view},{entityCommand:this.getDefaultEntityCommand(t,c.su.extend),entityOptions:e})}getDefaultEntityCommand(e,t=c.su.flush){return{stateTransition:t,visibilityState:c.fe.show,correlation:{source:e}}}}const gf=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0};try{const{teamId:t,channelId:n,replyChainId:i}=JSON.parse(e);return{teamId:t,channelId:n,replyChainId:i}}catch(t){return{channelId:e}}},pf=e=>{if(vf(e))return hf(e)?{subNavEntity:kf(e),headerEntity:Nf(e),startEntity:Tf(e),mainEntity:If(e),endEntity:Ef(e)}:null},vf=({layoutMode:e,contextEntity:t,entity:n})=>{const{action:i=null,type:a}=Object.assign({},n),{type:o,action:r}=t||{},s=[c.lO.standard,c.lO.focus].includes(e),l=[u.p.callablechannels,u.p.channelanalytics,u.p.channelcalendar,u.p.channelemailerror,u.p.channelemailv2,u.p.channelmanage,u.p.channelmembers,u.p.channels,u.p.channelsPinnedPost,u.p.channelsSystemMessage,u.p.channelsettings,u.p.channelinvitations,u.p.channeltags,u.p.channelcontextualsearch,u.p.crosspostchannelselectiondialog,u.p.crosspostchannelselectiondialogV2,u.p.filesoneupviewer,u.p.removechannelemail,u.p.schoolteams,u.p.sharedchanneldenyinvitation,u.p.sharedchannelspendinginvites,u.p.crossTeamAnalytics,u.p.teamslist,u.p.teamanalytics,u.p.teamchannels,u.p.teamdiscover,u.p.teammanage,u.p.teammanageapps,u.p.teammanagetags,u.p.teampendingrequests,u.p.teams,u.p.teamsettings,u.p.wiki].includes(a),d=i&&[u.u.create,u.u.default,u.u.info,u.u.list,u.u.view].includes(i),m=o&&[u.p.extensions,u.p.guardians,u.p.channelcalendar,u.p.callablechannels,u.p.filesoneupviewer,u.p.wiki].includes(o),g=r&&[u.u.view,u.u.list].includes(r);return!(!s||!l||!d&&!(g&&m))},hf=()=>!0,ff=({coreSettings:e,userPreferences:t})=>{var n,i,a,o;if(!(null===(n=null==e?void 0:e.get(K.J.TeamsAndChannels))||void 0===n?void 0:n.enableTeamLayoutSetting)&&!(null===(i=null==e?void 0:e.get(K.J.TeamsAndChannels))||void 0===i?void 0:i.enableTeamLayoutSettingOverride))return!1;switch(null===(a=null==t?void 0:t.teamLayout)||void 0===a?void 0:a.currentLayout){case L.$lW.grid:return!0;case L.$lW.list:return!1;default:return null===(o=null==e?void 0:e.get(K.J.TeamsAndChannels))||void 0===o?void 0:o.defaultTeamLayoutSettingIsGrid}},yf=e=>({action:u.u.list,type:u.p.schoolteams,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:e.options,windowOptions:null}),kf=({layoutMode:e,entity:t,coreSettings:n,userPreferences:i,contextEntity:a})=>{var o,r,s,l,d;if(e===c.lO.focus)return null;if(t.type===u.p.teams&&t.action===u.u.create)return t;if(t.type===u.p.schoolteams&&(t.action===u.u.list||t.action===u.u.join))return null;if(!(null===(o=null==n?void 0:n.get(K.J.Host))||void 0===o?void 0:o.msgEnableChannelsV2))return null;const m=Sf(t,a);if(ff({coreSettings:n,userPreferences:i})||(null===(r=null==n?void 0:n.get(K.J.Host))||void 0===r?void 0:r.isGridNavigationLayoutActive)){if(t.action===u.u.default)return null;const e=null!==(l=null!==(s=wf(a))&&void 0!==s?s:wf(t))&&void 0!==l?l:m,n=null!==(d=Cf(a))&&void 0!==d?d:Cf(t),i=n&&n!==e?(0,Ci.u4)({teamId:n,channelId:e}):e;return{action:u.u.view,type:u.p.schoolteams,entityState:{flushableByLinkedEntity:!0},id:i,linkedEntity:null,options:t.options,windowOptions:null}}return{action:u.u.list,entityState:{flushableByLinkedEntity:!0},id:m,linkedEntity:null,options:t.options,type:u.p.channels,windowOptions:null}},Sf=(e,t)=>{if(t&&t.action===u.u.view)switch(t.type){case u.p.channelmanage:case u.p.teammanage:case u.p.teammanagetags:case u.p.teammanageapps:case u.p.teamsettings:case u.p.teamanalytics:case u.p.teampendingrequests:case u.p.teamchannels:case u.p.channelmembers:case u.p.channelsettings:case u.p.channelanalytics:case u.p.teamslist:case u.p.crossTeamAnalytics:case u.p.sharedchannelspendinginvites:return e.id}const n=e.type===u.p.channels&&e.action===u.u.view?e.id:null;if(!n)return null;const{channelId:i}=(0,Xs.jd)(n);return i},bf=[u.p.teamanalytics,u.p.teammanage,u.p.teammanagetags,u.p.teammanageapps,u.p.teampendingrequests,u.p.teamsettings,u.p.teamchannels],Cf=e=>{if(!e)return;if(bf.includes(e.type))return e.id;if(e.hasOwnProperty("options")&&null!==e.options){return JSON.parse(e.options).parentTeamId}},wf=e=>{if(e&&e.id)try{const{channelId:t}=(0,Xs.jd)(e.id);return t}catch(e){return}},Nf=({contextEntity:e,entity:t,coreSettings:n,userPreferences:i})=>{if(e&&e.action===u.u.view)switch(e.type){case u.p.channelmanage:case u.p.teammanage:case u.p.teammanagetags:case u.p.teammanageapps:case u.p.teamsettings:case u.p.teamanalytics:case u.p.teampendingrequests:case u.p.teamchannels:case u.p.channelmembers:case u.p.channelsettings:case u.p.channelanalytics:case u.p.teamslist:case u.p.crossTeamAnalytics:case u.p.sharedchannelspendinginvites:return e}return e&&t.type===u.p.schoolteams?e.type&&[u.p.guardians].includes(e.type)?Object.assign(Object.assign({},e),{action:u.u.view,type:u.p.extensions}):e:t.type===u.p.channels&&t.action===u.u.default&&ff({coreSettings:n,userPreferences:i})?yf(t):t},Tf=()=>null,If=({contextEntity:e,entity:t,coreSettings:n,userPreferences:i})=>{var a;return(null==e?void 0:e.type)&&[u.p.extensions,u.p.guardians,u.p.callablechannels,u.p.channelcalendar,u.p.filesoneupviewer,u.p.wiki,u.p.teammanage,u.p.teammanagetags,u.p.teammanageapps,u.p.teamsettings,u.p.teamanalytics,u.p.teampendingrequests,u.p.teamchannels,u.p.channelemailv2,u.p.channelmembers,u.p.channelmanage,u.p.channelsettings,u.p.channelanalytics,u.p.removechannelemail,u.p.teamslist,u.p.crossTeamAnalytics,u.p.sharedchannelspendinginvites].includes(e.type)?e:t.type===u.p.channels&&t.action===u.u.view?(null===(a=null==n?void 0:n.get(K.J.Host))||void 0===a?void 0:a.msgEnableChannelsV2)?t:null:t.type===u.p.channels&&t.action===u.u.default&&ff({coreSettings:n,userPreferences:i})?yf(t):t},Ef=({entity:e,contextEntity:t,coreSettings:n,layoutMode:i,userPreferences:a})=>{var o,r,s,l;const d=(null==t?void 0:t.id)||e.id,m=JSON.parse(null!==(o=e.options)&&void 0!==o?o:"{}"),g=(null===(r=null==a?void 0:a.infoPane)||void 0===r?void 0:r.channels)?a.infoPane.channels===L.MwA.closed:!!(null===(s=null==n?void 0:n.get(K.J.Channels))||void 0===s?void 0:s.disableChannelInfoPaneOpenByDefault);if(!((e,t,n,i,a,o,r)=>{var s,l;const{enableChannelInfoPaneSearch:d,enableChannelInfoPane:m=!1}=null!==(s=null==i?void 0:i.get(K.J.Channels))&&void 0!==s?s:{},{enableInfoPaneAsResponsiveMenu:g=!1}=null!==(l=null==i?void 0:i.get(K.J.Core))&&void 0!==l?l:{};return!(!e||a!==c.lO.standard||t!==u.p.channels||(!d||r!==Ot.D.ChannelContextualSearch&&(null==n?void 0:n.type)!==u.p.channelcontextualsearch)&&(o||!m||!g))})(d,e.type,t,n,i,g,m.source))return null;const{enableChannelInfoPaneSearch:p}=null!==(l=null==n?void 0:n.get(K.J.Channels))&&void 0!==l?l:{};if(m.source===Ot.D.ChannelContextualSearch)return{id:d,action:u.u.info,type:u.p.channelcontextualsearch};const{replyChainId:v}=(e=>{if(!e)return{replyChainId:void 0};try{const{replyChainId:t}=JSON.parse(e);return{replyChainId:t}}catch(e){return{replyChainId:void 0}}})(null!=d?d:"");if(v&&(!p||(null==t?void 0:t.type)!==u.p.channelcontextualsearch))return null;if(t){const{action:e,type:n}=t;if(e===u.u.info&&Af(n,!!p))return t;if(n!==u.p.channels)return null}const{channelId:h}=(0,Xs.jd)(null!=d?d:"");return{id:(0,Ci.u4)({channelId:h}),action:u.u.info,type:u.p.channels}},Af=(e,t)=>{switch(e){case u.p.channelsPinnedPost:case u.p.channelsSystemMessage:return!0;case u.p.channelcontextualsearch:return t;default:return!1}},_f=({areEmptySlotsTransparent:e,coreSettings:t})=>({[L.tF7.mainEntity]:{[s.S.Main]:{isBackgroundTransparent:!!(null==t?void 0:t.get(K.J.Channels).enableMicaBackgroundForChannelPane)||e}},[L.tF7.headerEntity]:{[s.S.HorizontalBar]:{isBackgroundTransparent:!!(null==t?void 0:t.get(K.J.Channels).enableMicaBackgroundForChannelPane)||e}},[L.tF7.subNavEntity]:{[s.S.Rail]:{areSlotShadowsDisabled:!1,isBackgroundTransparent:!!(null==t?void 0:t.get(K.J.Core).enableTransparentLeftRail)||e}}});var Df=n(79647);const Ff={id:Df.Hm,name:"TeamsAndChannelsApp",getLocalizedName:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("teamsAndChannels"),e.stringTranslate("teamsAndChannels","teams_and_channels_app_name")})),actors:[Up],supportedEntities:[u.p.channelanalytics,u.p.channelemailerror,u.p.channelemailv2,u.p.channelmanage,u.p.channelmembers,u.p.channels,u.p.channelsPinnedPost,u.p.channelsSystemMessage,u.p.channelcontextualsearch,u.p.channelsettings,u.p.channelinvitations,u.p.channeltags,u.p.crosspostchannelselectiondialog,u.p.crosspostchannelselectiondialogV2,u.p.crosspostdeletedialog,u.p.defaultchannelnavdialog,u.p.removechannelemail,u.p.schoolteams,u.p.sharedchanneldenyinvitation,u.p.sharedchannelspendinginvites,u.p.crossTeamAnalytics,u.p.teamchannels,u.p.teamdiscover,u.p.teammanage,u.p.teammanageapps,u.p.teammanagetags,u.p.teampendingrequests,u.p.teams,u.p.teamsettings,u.p.teamanalytics,u.p.pinunpinpost,u.p.teamslist],supportedRenderModes:[s.S.HorizontalBar,s.S.Main,s.S.Rail,s.S.Modal],getDefaultCommand:e=>{const{enableHybridChannelList:t,msgEnableChannelsV2:n}=e.get(K.J.Host);if(t&&n)return{type:u.p.channels,action:u.u.default}},windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125}},Mf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"}},{kind:"Field",name:{kind:"Name",value:"channelName"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"discardDuringMeetingsAndCalls"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"reaction"}},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"}},{kind:"Field",name:{kind:"Name",value:"senderGivenName"}},{kind:"Field",name:{kind:"Name",value:"senderMri"}},{kind:"Field",name:{kind:"Name",value:"subtype"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}}]}}]}}]};var Rf,Pf;!function(e){e.Follow="Follow",e.Mention="Mention",e.Reaction="Reaction",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.TeamMembershipChange="TeamMembershipChange"}(Rf||(Rf={})),function(e){e.Person="Person",e.Team="Team",e.AddedToSharedChannel="AddedToSharedChannel",e.TeamShareTeamOwnerNotify="TeamShareTeamOwnerNotify",e.PromotedToSharedChannelOwner="PromotedToSharedChannelOwner",e.ChannelOwnerUnshareTeamOwnerNotify="ChannelOwnerUnshareTeamOwnerNotify",e.TeamOwnerUnshareChannelOwnerNotify="TeamOwnerUnshareChannelOwnerNotify"}(Pf||(Pf={}));const Of="new_channel_post_toast_header",xf="channel_reaction_toast_header",Lf="channel_reply_toast_header",Uf="channel_reply_to_reply_toast_header",Bf="channel_mention_team_toast_header",jf="channel_mention_person_toast_header",Wf="shared_channel_shared_with_a_user_header",Vf="shared_channel_sharing_stopped_by_owner_header",Hf="shared_channel_shared_with_a_team_header",$f="shared_channel_sharing_stopped_by_team_owner_header",zf="shared_channel_role_promotion_header",Gf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsMsaUserProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}}]}]}}]},qf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}]}]}}]};function Qf(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const o=yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{data:i}=yield e.query({query:Gf,variables:{userId:t,displayName:n,profilePictureSize:Pl.$D.Small}});return i.msaUserProfilePicture}))}(e,n,a);if(!o)return void t.error(ri.f.ImageUrlGenerationFailed);const r=yield e.query({query:qf,variables:{url:o}});return(null==r?void 0:r.data.toastImageAsDataUri)||void 0}catch(e){return void t.error(ri.f.ImageFetchFailed)}}))}const Jf={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchEmoticons"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}}},{kind:"Argument",name:{kind:"Name",value:"exactMatch"},value:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}}},{kind:"Argument",name:{kind:"Name",value:"includeShortCuts"},value:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}}},{kind:"Argument",name:{kind:"Name",value:"includeKeywords"},value:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}}},{kind:"Argument",name:{kind:"Name",value:"maxResultCount"},value:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}}},{kind:"Argument",name:{kind:"Name",value:"categoryId"},value:{kind:"Variable",name:{kind:"Name",value:"categoryId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"unicode"}},{kind:"Field",name:{kind:"Name",value:"animation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment_animation"}}]}},{kind:"Field",name:{kind:"Name",value:"etag"}},{kind:"Field",name:{kind:"Name",value:"diverse"}},{kind:"Field",name:{kind:"Name",value:"shortcuts"}},{kind:"Field",name:{kind:"Name",value:"searchMatch"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment_animation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fps"}},{kind:"Field",name:{kind:"Name",value:"framesCount"}},{kind:"Field",name:{kind:"Name",value:"firstFrame"}}]}}]}.definitions]};function Yf({reaction:e,channelName:t,teamName:n,type:a,subtype:o,senderDisplayName:r,senderGivenName:s},l,d,c){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const u=r||s;if(!u)return"";if(a===Rf.Mention&&!o)return"";if(a===Rf.Reaction&&!e)return"";const m={channelName:t,senderDisplayName:u,teamName:n};switch(a){case Rf.Follow:return Kf(Of,m,l);case Rf.Reply:return Kf(Lf,m,l);case Rf.ReplyToReply:return Kf(Uf,m,l);case Rf.Mention:return o===Pf.Person?Kf(jf,m,l):Kf(Bf,m,l);case Rf.Reaction:const t=yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const{id:t}=(0,sr.M)(null==n?void 0:n.toLocaleLowerCase().trim());if(!t)return;const{data:i}=yield e.query({query:Jf,variables:{searchFilter:t,exactMatch:!0}});return((null==i?void 0:i.searchEmoticons)||[])[0]}catch(e){return void t.error(ri.f.ChannelToastEmoticonsQueryFailed)}}))}(d,c,e),n=(null==t?void 0:t.unicode)||void 0;return Kf(xf,Object.assign(Object.assign({},m),{emoji:n}),l);case Rf.TeamMembershipChange:return function(e,t,n){switch(e){case Pf.AddedToSharedChannel:return Kf(Wf,t,n);case Pf.ChannelOwnerUnshareTeamOwnerNotify:return Kf(Vf,t,n);case Pf.PromotedToSharedChannelOwner:return Kf(zf,t,n);case Pf.TeamOwnerUnshareChannelOwnerNotify:return Kf($f,t,n);case Pf.TeamShareTeamOwnerNotify:return Kf(Hf,t,n);default:return""}}(o,m,l);default:return""}}))}function Kf(e,{emoji:t,channelName:n,teamName:i,senderDisplayName:a},o){return o.stringTranslate("toastNotifications",e,{channelName:n,emoji:t,senderDisplayName:a,teamName:i})}function Zf(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{conversationId:i,messageId:o,startTimestamp:r,replyChainId:s,teamName:l,channelName:d,senderMri:c,senderDisplayName:u}=e,m=yield Qf(n,a,c,u||""),g=yield Yf(e,t,n,a),p=function(e,t,n,i){switch(e.subtype){case Pf.ChannelOwnerUnshareTeamOwnerNotify:return i.stringTranslate("toastNotifications","shared_channel_owner_unshare_team_owner_notify_text",{teamName:t});case Pf.TeamOwnerUnshareChannelOwnerNotify:return i.stringTranslate("toastNotifications","shared_channel_team_owner_unshare_channel_owner_notify_text",{channelName:n});default:return i.stringTranslate("toastNotifications","channel_toasts_text",{teamName:t,channelName:n})}}(e,l,d,t);return{conversationId:i,quickReply:!1,discardDuringMeetingsAndCalls:!!e.discardDuringMeetingsAndCalls,messageId:o,time:new Date(+r),replyChainId:s||"",text:p,title:g,mainImage:m?{alt:"",src:m}:void 0}}))}function Xf(e,t){const n=e.newScenario(ft.RG.CrossClientToastView);n.appendEventData({mainEntityType:u.p.channels}),n.fail(t)}function ey(e,t,n,a,o,r,s,l){const{enableCommandToHostCommService:d}=t.get(K.J.Core),{enableChannelsNotifications:c}=t.get(K.J.Notifications);return{id:"channel-toast-event-subscription",runOncePerId:!0,job:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const m=a.newLogger("ChannelToastEventSubscription");d?c?(m.log(`${ri.f.Subscribing}: subscribing to channel toasts resolver`),n.subscribe({query:Mf,fetchPolicy:"no-cache"}).subscribe(function(e,t,n,a,o,r,s,l){const{enableToastCollections:d}=t.get(K.J.Notifications);return t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,c;if(t.errors){const e=(0,Ci.u4)(t.errors.map((e=>e.message)).join());return n.error(`${ri.f.SubscriptionFailed} ${e}`),void Xf(a,{errorCode:ri.f.SubscriptionFailed,errors:e})}const m=null===(i=t.data)||void 0===i?void 0:i.channelToastEvent;if(!m)return n.error(ri.f.EmptyEvent),void Xf(a,{errorCode:ri.f.EmptyEvent});const g=a.newScenario(ft.RG.CrossClientToastView,{startTime:+m.startTimestamp});g.clientId=m.correlationId,g.appendEventData({mainEntityType:u.p.channels,mainEntitySubtype:m.type});const p=yield Zf(m,o,s,n);if(!p.title)return n.error(`${ri.f.UnhandledType}: Dropping channel toast with type ${m.type}`),void g.incomplete({reason:ri.f.UnhandledType});d&&(p.collectionId=di(e,l,n)),null===(c=a.hoistScenarioToCore)||void 0===c||c.call(a,g),r.toasts.showChannelsNotification(m.correlationId,p),g.mark(ft.ck.CrossClientEntityCommandTriggered),n.log(`${ri.f.ToastCommandSent} type:${m.type} correlationId:${m.correlationId}`)}))}(e,t,m,o,r,s,n,l))):m.log(`${ri.f.NotEnabled}: channel notifications are off`):m.log(ri.f.NotEnabled)}))}}const ty=({context:{authenticationUser:e,client:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,i18n:o,entityCommanding:r,userTrackingService:s}})=>[ey(e,n,t,i,a,o,r,s)],ny=({commandInput:e,requestContext:{loggerFactory:t}})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:n}}=e,i=t.newLogger("TeamsAndChannelsApp onCommandReceived");if(e.command.actor===Up)switch(n){case Bp:return{entity:{type:u.p.channels,action:u.u.default},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.Unknown}}};default:i.error(`Command action '${n}' is not supported at TeamsAndChannelsApp.`)}else i.error(`Command for actor '${e.command.actor}' cannot be handled by TeamsAndChannelsApp.`)})),iy=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(68227),n.e(94864),n.e(31142),n.e(42178),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(88978),n.e(44413),n.e(76420),n.e(28030),n.e(90883),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(31693),n.e(95544),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(43806),n.e(6482),n.e(94339),n.e(26599),n.e(11965),n.e(1910),n.e(69827),n.e(93880),n.e(28974),n.e(75988),n.e(88369),n.e(58257),n.e(24998),n.e(25670),n.e(50295),n.e(99826),n.e(86382),n.e(10751),n.e(75171),n.e(59885),n.e(41219),n.e(62030)]).then(n.bind(n,77430)),ay=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(48177),n.e(10440),n.e(56845),n.e(78998),n.e(45746),n.e(19351),n.e(79058),n.e(83505),n.e(96271),n.e(14085),n.e(2720),n.e(96418),n.e(14768),n.e(68227),n.e(94864),n.e(31142),n.e(42178),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(50840),n.e(68865),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(98935),n.e(88978),n.e(44413),n.e(76420),n.e(28030),n.e(90883),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(81433),n.e(50352),n.e(46163),n.e(31693),n.e(95544),n.e(23956),n.e(54226),n.e(60739),n.e(1122),n.e(30141),n.e(30509),n.e(92549),n.e(50153),n.e(47459),n.e(64511),n.e(84577),n.e(2116),n.e(78802),n.e(67215),n.e(71626),n.e(64891),n.e(72780),n.e(34814),n.e(78684),n.e(17027),n.e(97191),n.e(35166),n.e(43806),n.e(6482),n.e(94339),n.e(26599),n.e(11965),n.e(1910),n.e(69827),n.e(93880),n.e(28974),n.e(75988),n.e(88369),n.e(58257),n.e(24998),n.e(25670),n.e(50295),n.e(99826),n.e(86382),n.e(10751),n.e(75171),n.e(59885),n.e(41219),n.e(62030)]).then(n.bind(n,334814)),oy=({coreServices:e,host:t,screenState:n,windowOptions:i})=>{const{height:a,minHeight:o,minWidth:r,offset:s,width:l}=Ff.windowFeatures||{},d={left:(null==t?void 0:t.screenX)||0,top:(null==t?void 0:t.screenY)||0},c=((null==n?void 0:n.numOpenWindows)||1)*(s||1);return Object.assign(Object.assign(Object.assign({additionalFeatures:{minHeight:`${o}`,minWidth:`${r}`},height:a,left:(null==d?void 0:d.left)+c,minHeight:o,minWidth:r,top:(null==d?void 0:d.top)+c,width:l},Ff.windowFeatures),(null==e?void 0:e.coreSettings.get(K.J.Core).enableRatioToScreenBasedSizing)&&function(e,t){const{widthToScreenWidthRatio:n,heightToWidthRatio:i}=t||{};if(!e||!i||!n)return{};const a=n*e.screen.availWidth;return{height:a*i,width:a}}(t,Ff.windowFeatures)),i)};function ry(){return{eventHandlers:Vh,getAppPhases:lf,getAppViewEntities:pf,getAppViewEntitiesProps:_f,getAppWindowFeatures:oy,getCommandScenarioName:(e,t)=>{const{entity:n,command:i}=e,a=i.stateTransition===c.su.flush||i.stateTransition===c.su.forceFlush||i.stateTransition===c.su.new;if(n.type===u.p.channels&&(n.action===u.u.view||n.action===u.u.default)&&i.visibilityState===c.fe.show&&a)if(n.id){const e=(0,Xs.jd)(n.id,t);if(e)return i.stateTransition===c.su.new?e.replyChainId?ft.RG.ChannelSwitchL2Popout:void 0:e.replyChainId?ft.RG.ChannelSwitchL2:ft.RG.ChannelSwitchL1}else if(n.action===u.u.default)return ft.RG.ChannelSwitchL1;return n.type===u.p.schoolteams&&n.action===u.u.list?ft.RG.TeamsGridLoad:n.type===u.p.channelcontextualsearch&&n.action===u.u.info&&i.visibilityState!==c.fe.hide?ft.RG.ContextualSearchStart:void 0},getPlatformAppIdForEntity:e=>e.type===u.p.channels||e.type===u.p.schoolteams?"2a84919f-59d8-4441-a975-2a8c2643b741":void 0,onBeforeAddToNavigation:af,manifest:Ff,onBeforeDeeplinkParsed:nf,render:({appRenderMode:e,coreSettings:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="teams-and-channels-app";n("ChunkLoadStarted",{chunkName:i});const{enableEntityMoreInfo:r}=t.get(K.J.Core),s=({children:e})=>o.createElement(o.Fragment,null,e),l=r?s:yn.p3,{TeamsAndChannelsViewsRenderer:c}=yield(0,d.mT)(iy,i,a),{LPC:u}=r?{LPC:s}:yield(0,d.mT)(ay,i,a);return n("ChunkLoadSucceeded",{chunkName:i}),o.createElement(u,null,o.createElement(l,null,o.createElement(sd.l8,null,o.createElement(c,{appRenderMode:e,coreSettings:t}))))})),onCommandReceived:ny,onPreWarm:ty}}const sy={id:"com.microsoft.teams.store.notifications.app",name:"TeamsStoreNotificationsApp",supportedEntities:[u.p.lobnotifications,u.p.onboardingnotifications,u.p.discoverappsnotifications,u.p.autoinstallnotification],supportedRenderModes:[s.S.Main,s.S.Rail]},ly=e=>{if(dy(e))return cy(e)?{subNavEntity:uy(e),headerEntity:my(e),startEntity:gy(e),mainEntity:py(e),endEntity:vy(e)}:null},dy=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.lobnotifications,u.p.onboardingnotifications].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},cy=()=>!0,uy=({entity:e})=>e,my=()=>null,gy=()=>null,py=({entity:e})=>e,vy=()=>null,hy=()=>Promise.all([n.e(18861),n.e(70724),n.e(5924),n.e(5592),n.e(33493),n.e(8914),n.e(63027),n.e(4171)]).then(n.bind(n,744511)),fy=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,556620));function yy(){const e=()=>null;return{getAppViewEntities:ly,manifest:sy,render:({appRenderMode:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="teamsStoreNotifications";n("ChunkLoadStarted",{chunkName:e});const[{NotificationsEntry:t},{CallsTabContextProvider:i}]=yield Promise.all([(0,d.mT)(hy,e,a),(0,d.mT)(fy,e,a)]);return n("ChunkLoadSucceeded",{chunkName:e}),o.createElement(l.f,{namespace:"extensibility",loaderRenderer:null},o.createElement(i,null,o.createElement(t,null)))}return o.createElement(e,null)}))}}const ky=e=>{if(Sy(e))return by(e)?{subNavEntity:Cy(e),headerEntity:wy(e),startEntity:Ny(e),mainEntity:Ty(e),endEntity:Iy(e)}:null},Sy=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.transcriptcontent].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},by=()=>!0,Cy=()=>null,wy=()=>null,Ny=()=>null,Ty=({entity:e})=>e,Iy=()=>null,Ey={id:"com.microsoft.teams.transcript-content",name:"TranscriptContentApp",supportedEntities:[u.p.transcriptcontent],supportedRenderModes:[s.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Ay="transcript-content-app",_y=()=>Promise.all([n.e(33493),n.e(8914),n.e(3275)]).then(n.bind(n,381087)),Dy=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(56845),n.e(78998),n.e(53198),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(68865),n.e(94333),n.e(98935),n.e(12724),n.e(37767),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(72780),n.e(34814),n.e(33493),n.e(68740)]).then(n.bind(n,556620));function Fy(){const e=()=>null;return{getAppViewEntities:ky,manifest:Ey,render:({appRenderMode:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const[{TranscriptContentViews:e},{CallsTabContextProvider:t}]=yield Promise.all([(0,d.mT)(_y,Ay,n),(0,d.mT)(Dy,Ay,n)]);return o.createElement(l.f,{namespace:"calling",loaderRenderer:null},o.createElement(t,null,o.createElement(e,null)))}return o.createElement(e,null)}))}}const My={id:"com.microsoft.teams.virtual-events",name:"VirtualEventsApp",supportedEntities:[u.p.virtualevents],supportedRenderModes:[s.S.Main,s.S.Modal,s.S.HorizontalBar],windowFeatures:{minWidth:1158,width:1158,minHeight:683,height:683}},Ry=e=>{if(Py(e))return Oy(e)?{subNavEntity:xy(e),headerEntity:Ly(e),startEntity:Uy(e),mainEntity:By(e),endEntity:jy(e)}:null},Py=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.virtualevents].includes(i),r=n&&[u.u.default,u.u.view,u.u.create,u.u.list].includes(n);return!!(a&&o&&r)},Oy=()=>!0,xy=()=>null,Ly=({entity:e})=>e,Uy=()=>null,By=({entity:e})=>e,jy=()=>null,Wy=()=>({[L.tF7.headerEntity]:{[s.S.HorizontalBar]:{slotHeightOverrides:"6.1rem"}}}),Vy=({prevEntityType:e})=>e===u.p.virtualevents?null:My.windowFeatures,Hy=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(75916),n.e(92983),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(10440),n.e(75912),n.e(61130),n.e(19570),n.e(63735),n.e(33235),n.e(56369),n.e(1246),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(58016),n.e(38393),n.e(21767),n.e(94333),n.e(33876),n.e(93215),n.e(55669),n.e(73136),n.e(79825),n.e(57526),n.e(15370),n.e(5592),n.e(46263),n.e(6523),n.e(84395),n.e(79e3),n.e(50352),n.e(46163),n.e(23956),n.e(54226),n.e(78802),n.e(78290),n.e(95630),n.e(18876),n.e(85474),n.e(82382),n.e(5108)]).then(n.bind(n,829731));function $y(){return{getAppViewEntities:Ry,getAppViewEntitiesProps:Wy,getAppWindowFeatures:Vy,manifest:My,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="virtual-events-app";t("ChunkLoadStarted",{chunkName:i});const{VirtualEventsViewsRenderer:a}=yield(0,d.mT)(Hy,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(l.f,{namespaces:["virtualEvents","webinar","messaging","meetingAnalytics","compose","calendar","extensibility"],loaderRenderer:null},o.createElement(a,{appRenderMode:e}))})),onRegister:e=>{e.registerTask(new Pe)}}}const zy=e=>{if(Gy(e))return qy(e)?{subNavEntity:Qy(e),headerEntity:Jy(e),startEntity:Yy(e),mainEntity:Ky(e),endEntity:Zy(e)}:null},Gy=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.registration].includes(i),r=n&&[u.u.default,u.u.view].includes(n);return!!(a&&o&&r)},qy=()=>!0,Qy=()=>null,Jy=()=>null,Yy=()=>null,Ky=({entity:e})=>e,Zy=()=>null,Xy={getDefaultCommand:()=>({type:u.p.registration,action:u.u.view}),id:"com.microsoft.teams.webinar-registration",name:"WebinarRegistrationApp",supportedRenderModes:[s.S.Main],supportedEntities:[u.p.registration],windowFeatures:{minWidth:1140,width:1140,minHeight:720,height:720}},ek=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(47113),n.e(15803),n.e(35235),n.e(75916),n.e(35799),n.e(50611),n.e(22681),n.e(60567),n.e(34983),n.e(84460),n.e(10440),n.e(75912),n.e(45746),n.e(19351),n.e(7983),n.e(1839),n.e(63735),n.e(56369),n.e(73840),n.e(51778),n.e(61724),n.e(62514),n.e(21439),n.e(38393),n.e(68865),n.e(94333),n.e(93215),n.e(2205),n.e(55669),n.e(73136),n.e(84395),n.e(79e3),n.e(50352),n.e(46163),n.e(23956),n.e(78802),n.e(78290),n.e(95630),n.e(18876),n.e(82382),n.e(54937)]).then(n.bind(n,739727)),tk=()=>Xy.windowFeatures||{};function nk(){const e=()=>null;return{getAppViewEntities:zy,getAppWindowFeatures:tk,manifest:Xy,render:({appRenderMode:t})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(t===s.S.Main){const e="webinar-registration-app",{WebinarRegistrationViewsRenderer:t}=yield(0,d.mT)(ek,e);return o.createElement(l.f,{namespaces:["compose","webinar"],loaderRenderer:null},o.createElement(t,null))}return o.createElement(e,null)}))}}const ik={id:"com.microsoft.teamspace.tab.wiki",name:"WikiApp",supportedEntities:[u.p.wiki],supportedRenderModes:[s.S.Main]},ak=e=>{if(ok(e))return rk(e)?{subNavEntity:sk(e),headerEntity:lk(e),startEntity:dk(e),mainEntity:ck(e),endEntity:uk(e)}:null},ok=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.wiki].includes(i),r=n&&[u.u.view].includes(n);return!!(a&&o&&r)},rk=()=>!0,sk=()=>null,lk=()=>null,dk=()=>null,ck=({entity:e})=>e,uk=()=>null,mk=()=>Promise.all([n.e(70724),n.e(48807),n.e(5592),n.e(75931)]).then(n.bind(n,209146)),gk=()=>ik.windowFeatures||{};function pk(){return{getAppViewEntities:ak,getAppWindowFeatures:gk,getCommandScenarioName:vk,manifest:ik,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="wiki-app";t("ChunkLoadStarted",{chunkName:i});const{WikiViewsRenderer:a}=yield(0,d.mT)(mk,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(a,{appRenderMode:e})}))}}const vk=()=>ft.RG.WikiMigration,hk={id:"com.microsoft.teams.entitymoreinfo",actors:["entitymoreinfo"],name:"EntityMoreInfoApp",supportedRenderModes:[s.S.Configurations]},fk={gqlTypeName:"EntityMoreInfoAppViewState",queryFieldName:"entityMoreInfoAppViewState",navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{readyToBootstrapLPC:!1},computedValues:void 0},yk={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEntityMoreInfoUsersForConversationQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"PeoplePickerFiltersInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsersForConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriArray"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"isShortProfileRequested"},value:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"peoplePickerFilters"},value:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}}},{kind:"Argument",name:{kind:"Name",value:"isSharedChannel"},value:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}}},{kind:"Argument",name:{kind:"Name",value:"hostTenantId"},value:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"companyName"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"xtapUser"}}]}}]}}]},kk={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEntityMoreInfoLpcStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}}]}}]}}]},Sk={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEntityMoreInfoAuthenticationUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}}]}}]};var bk=n(9522),Ck=n(252794),wk=n(740223);const Nk=e=>{const{ariaLabel:t,coreSettings:n,eventType:i,externalAppSessionCorrelationId:a,host:o,hostConversationId:r,hostTenantId:s,isSharedChannel:l,logger:d,personaType:c,shouldDeferCardOpenToParentWindow:u,tabIndex:m,userBiService:g,userId:p}=e;let v,h="Card";switch(i){case"mouseout":case"mousedown":v=Ck.MW.MouseHover;break;case"click":case"dblclick":v=Ck.MW.MouseClick,h="ExpandedView";break;case"keydown":v=Ck.MW.KeyboardPress,h="ExpandedView";break;default:v=Ck.MW.MouseHover}const f=!!n.get(K.J.People).isInIframe,y=void 0!==u?u:f,k=()=>{null==o||o.document.dispatchEvent(new MouseEvent("mousemove"))};return{cardParameters:{personaInfo:{identifiers:{PersonaType:c||"NotResolved",HostAppPersonaId:(0,wk.Bg)({userId:p,isSharedChannel:!!l,hostTenantId:s,hostConversationId:r}),TeamsMri:p}},behavior:{cardPlacementMode:"AnchorSide",locationToOpen:h,onCardOpen:()=>{null==o||o.document.addEventListener("mouseleave",k);const e={panelRegion:Da.Ai.popover,panelType:Da.wh.LivePersonaCard};null==g||g.recordPanelView(e,d)},onCardClose:()=>{null==o||o.document.removeEventListener("mouseleave",k);const e={actionGesture:Da.uS.mouseleave,actionOutcome:Da.$K.closePanel,actionScenarioType:Da.Yu.people,actionScenario:Da.Tk.closePanel,moduleName:Da.rA.lpcClose,panelRegion:Da.Ai.popover,panelType:Da.wh.LivePersonaCard};null==g||g.recordPanelAction(e,d)},shouldDeferCardOpenToParentWindow:y},externalAppSessionCorrelationId:a,ariaLabel:t,clientScenario:"MicrosoftTeams_MultiWindow",openCardTriggerType:v},tabIndex:m}},Tk=({commandData:{userId:e,isSharedChannel:t,conversationId:n},tenantId:a,coreSettings:o,client:r,logger:s,host:l})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const d=yield((e,t,n,a,o,r,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{enableTflSms:i}=o.get(K.J.Messaging),{showPersonCardForSMSUser:l,showPersonCardForXTapUser:d}=o.get(K.J.People),{isCallingScreenInteractive:c,disablePstnPersonaCard:u}=o.get(K.J.Calling),{enableFlyoutInlineChat:m,enableSimplifiedFeaturesInFlyoutChat:g}=o.get(K.J.Flyout);if(!c||m&&g)return!1;if(e&&Yo.eo.isTFLSmsMri(e))return!!i&&!!l;if(e&&Yo.eo.isTFLOffNetworkUser(e))return!1;if(u&&(0,bk.EG)(e))return!1;if(t&&!d){const t=(0,wk.we)(e,n,a,"lpc-persona-container",s);if(!t)return s.warn("xTap profile Query variables are not defined for a shared channel"),!1;const{data:i}=yield r.query({query:yk,variables:t});if(!i||!i.getUsersForConversation)return s.warn("xTap profile Query returned null data"),!1;const o=i.getUsersForConversation,l=!!(o.length>0&&o[0]&&Yo.eo.isFederatedUser(o[0])&&o[0].xtapUser);return!l||!!d&&l}return!0})))(e,!!t,n,a,o,r,s),{data:{lpcState:c}}=yield r.query({query:kk});return!!(e&&d&&(null==c?void 0:c.isLivePersonaCardInitialized)&&(null==l?void 0:l.LPC))||(s.warn(`Lpc is not ready, \n          userId: ${e},\n          isLpcAllowed: ${!d},\n          isLivePersonaCardInitialized: ${null==c?void 0:c.isLivePersonaCardInitialized}, \n          host.LPC:${!(null==l?void 0:l.LPC)}\n        `),!1)})),Ik=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;const{data:{authenticationUsers:i}}=yield e.query({query:Sk,variables:{filter:{isAuthenticated:!0}}});return null===(n=null===(t=i[0])||void 0===t?void 0:t.profile)||void 0===n?void 0:n.tenantId})),Ek=(e,t,n)=>null==n?void 0:n.LPC.openCard(new n.DOMRect(e.left,e.top,e.width,e.height),t);var Ak=n(409478),_k=n(903589);const Dk={onCommandReceived:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n,a;const{appViewState:o,commandInput:r,host:s,requestContext:{client:l,coreSettings:d,loggerFactory:c},userBiService:u}=e,{command:{action:m,actor:g,data:p}}=r,v=c.newLogger("EntityMoreInfo onCommandReceived");if(v.log(`Command {action:${r.command.action}} received.`),!(null===(t=hk.actors)||void 0===t?void 0:t.includes(g)))return void v.error(`Command {action:${r.command.action}, actor:${r.command.actor}} is sent to the wrong App.`);const h=o;if(!(null===(n=h.readyToBootstrapLPC)||void 0===n?void 0:n.read()))return v.error(`Command failed, LPC is not bootstrapped for command: {action:${r.command.action}}}.`),void(null===(a=h.readyToBootstrapLPC)||void 0===a||a.update(!0));const f=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return!!(yield Tk({client:l,commandData:e,coreSettings:d,host:s,logger:v,tenantId:t}))||(v.error(`Command failed, LPC is not ready for command: {action:${r.command.action}}}.`),!1)}));switch(m){case gn:{const e=p,t=e.tenantId||(yield Ik(l));if(!(yield f(e,t)))return;const n=Nk(Object.assign(Object.assign(Object.assign({},e),t&&{tenantId:t}),{coreSettings:d,externalAppSessionCorrelationId:(0,mt.v4)(),host:s,logger:v,userBiService:u}));return void Ek(e,n.cardParameters,s)}case pn:{const e=p,t=e.tenantId||(yield Ik(l));if(!(yield f(e,t)))return;const n=(({ariaLabel:e,contextId:t,conversationId:n,coreSettings:i,eventType:a,externalAppSessionCorrelationId:o,highlightedText:r,host:s,isSharedChannel:l,logger:d,tenantId:c,topicId:u,userBiService:m,userId:g,clientRequestId:p})=>{const v=Nk({ariaLabel:e,coreSettings:i,eventType:a,externalAppSessionCorrelationId:o,host:s,hostConversationId:n,hostTenantId:c,isSharedChannel:l,logger:d,userBiService:m,userId:g}),h={contextId:t,highlightedText:r,hideEntityAndContextQuestion:!0,clientRequestId:p};return Object.assign(Object.assign({},v),{cardParameters:Object.assign(Object.assign({},v.cardParameters),{personaInfo:Object.assign(Object.assign({},v.cardParameters.personaInfo),{identifiers:Object.assign(Object.assign({},v.cardParameters.personaInfo.identifiers),{PersonaType:"Topic",TeamsMri:void 0,TopicId:u}),topicMetadata:h}),behavior:Object.assign(Object.assign({},v.cardParameters.behavior),{onCardOpen:()=>{var e,t;if(null===(t=(e=v.cardParameters.behavior).onCardOpen)||void 0===t||t.call(e),u){const e=(0,_k.I6)({userAadObjectId:g,tenantAadObjectId:c});null==e||e.logEvent(Ak.z.TopicCardOpen,{topicId:u})}}})})})})(Object.assign(Object.assign(Object.assign({},e),t&&{tenantId:t}),{coreSettings:d,externalAppSessionCorrelationId:(0,mt.v4)(),host:s,logger:v,userBiService:u}));return void Ek(e,n.cardParameters,s)}default:v.error(`Command action ${m} is not supported at EntityMoreInfoApp.`)}})),viewStateRegistration:fk};var Fk=n(15616),Mk=n(592827),Rk=n(134056);const{useRef:Pk,useEffect:Ok}=r,xk=()=>Promise.all([n.e(287),n.e(70724),n.e(47113),n.e(15803),n.e(35235),n.e(35799),n.e(22681),n.e(34983),n.e(84460),n.e(51778),n.e(61724),n.e(62514),n.e(68865),n.e(94333),n.e(98935),n.e(15370),n.e(5592),n.e(84395),n.e(50352),n.e(46163),n.e(23956),n.e(60739),n.e(1122),n.e(30509),n.e(92549),n.e(47459),n.e(84577),n.e(64891),n.e(34814),n.e(85883)]).then(n.bind(n,334814)),Lk=({logger:e,onRenderEvent:t,scenarioFactory:a})=>{const r=(0,Fk.I)("readyToBootstrapLPC");e.log(`LpcLazyLoader: shouldBootstrapLPC=${r}`);const[s,l]=(0,o.useState)(null);return(e=>{const t=Pk(),a=Pk(),o=(0,Mk.WD)(Ft.nh.COMPLETE),{host:r,scenarioFactory:s}=(0,Rk.SE)();Ok((()=>{e&&o&&(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e=()=>n.e(57969).then(n.t.bind(n,847377,23));try{const{freeBootstrapperMemory:n}=yield(0,d.mT)(e,"midgard-bootstrapper",s);t.current=n,a.current=r.__lpcWindowProxy}catch(e){}}))}),[r,o,s,e]),Ok((()=>()=>t.current&&a.current&&t.current(a.current)),[])})(!!r),(0,o.useEffect)((()=>{if(r){const e="entity-more-info-app";t("ChunkLoadStarted",{chunkName:e}),(0,d.mT)(xk,e,a).then((e=>l((()=>e.LPC)))),t("ChunkLoadSucceeded",{chunkName:e})}}),[t,a,r]),s&&o.createElement(s,null)};function Uk(){return Object.assign(Object.assign({},Dk),{manifest:hk,render:({coreSettings:e,loggerFactory:t,onRenderEvent:n,scenarioFactory:a})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=t.newLogger("EntityMoreInfoApp"),{enableEntityMoreInfo:r}=e.get(K.J.Core);return i.log(`render: loading EntityMoreInfoApp with enableEntityMoreInfo=${r}`),r?o.createElement(Lk,{logger:i,onRenderEvent:n,scenarioFactory:a}):o.createElement(o.Fragment,null)}))})}const Bk={id:Df.x8,name:"TeamsGalleryApp",supportedEntities:[u.p.teamsgallery],supportedRenderModes:[s.S.Main,s.S.Rail],getDefaultCommand:()=>({action:u.u.view,type:u.p.teamsgallery})},jk=e=>{if(Wk(e))return Vk(e)?{subNavEntity:Hk(e),headerEntity:$k(e),startEntity:zk(e),mainEntity:Gk(e),endEntity:qk(e)}:null},Wk=({layoutMode:e,entity:t})=>{const{action:n=null,type:i}=Object.assign({},t),a=[c.lO.focus,c.lO.standard].includes(e),o=[u.p.teamsgallery].includes(i),r=n&&[u.u.create,u.u.default,u.u.list,u.u.view].includes(n);return!!(a&&o&&r)},Vk=()=>!0,Hk=({entity:e})=>e,$k=()=>null,zk=()=>null,Gk=({entity:e})=>e,qk=()=>null,Qk=({areEmptySlotsTransparent:e,coreSettings:t})=>({[L.tF7.subNavEntity]:{[s.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==t?void 0:t.get(K.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}}}),Jk=()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(70724),n.e(47113),n.e(15803),n.e(19335),n.e(35235),n.e(92983),n.e(35799),n.e(22681),n.e(34983),n.e(15691),n.e(62514),n.e(42402),n.e(15370),n.e(5592),n.e(46263),n.e(84395),n.e(86382),n.e(15369)]).then(n.bind(n,912210));function Yk(){return{getAppViewEntities:jk,getAppViewEntitiesProps:Qk,manifest:Bk,render:({appRenderMode:e,onRenderEvent:t,scenarioFactory:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i="teams-gallery-app";t("ChunkLoadStarted",{chunkName:i});const{TeamsGallery:a}=yield(0,d.mT)(Jk,i,n);return t("ChunkLoadSucceeded",{chunkName:i}),o.createElement(a,{appRenderMode:e})}))}}var Kk=n(32693),Zk=n(130806),Xk=n(879098),eS=n(843149),tS=n(880727),nS=n(136295),iS=n(193646),aS=n(895725),oS=n(15710),rS=n(860467),sS=n(276053),lS=n(119351),dS=n(676586),cS=n(917801);const uS="core_life_cycle_start_",mS="core_task_end_",gS="core_init_complete";var pS;!function(e){e.activity="activity",e.alarm="alarm",e.alert="alert",e.attention="attention",e.busy="busy",e.error="error"}(pS||(pS={}));var vS=n(668816),hS=n(506864),fS=n(153909),yS=n(431657),kS=n(954249);const SS=(e,t,n,a)=>(0,nS.z)((0,yS.fU)(((n,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e[Symbol.iterator](),o=t[Symbol.iterator]();let r=i.next(),s=o.next();const l=[];for(;!s.done||!r.done;)s.done||!r.done&&s.value.id>r.value[0].id?(yield a(r.value[1]),r=i.next()):r.done||s.value.id<r.value[0].id?(l.push([s.value,n(s.value)]),s=o.next()):(l.push([s.value,r.value[1]]),r=i.next(),s=o.next());return l}))}(n,Array.from(o).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>bS(t,e,a)),(e=>CS(e,t)))}))),[]),(0,aS.U)((e=>wS(e,n))),(0,kS.b)((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e;return Promise.all(t)}))))),bS=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{return{type:"value",value:yield t(e)}}catch(t){return n&&n(e,t),{type:"error",error:t}}})),CS=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield e;if("error"!==n.type)return t(Promise.resolve(n.value))})),wS=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=[],i=yield Promise.all(e);for(const e of i){const i=yield e[1];"value"===i.type&&n.push(t(e[0],Promise.resolve(i.value)))}return n}));var NS=n(247170);var TS=n(533354);function IS(e){return Object.keys(e).reduce(((t,n)=>(t[n]=function(e){const t=(0,TS.QS)(e);return{update:e=>t(e),read:()=>t(),ref:t}}(e[n]),t)),{})}const ES=new Set([c.ab,c.Xt]);class AS{constructor(e,t,n){this._logger=e.newLogger("ReactiveValuesService"),this._appViewStateForWindowMap=new Map,this._servicesAppsRegistry=t,this._config=n}getAppViewStateForWindow(e,t){var n,i,a;this._config.enableEmbedDataClient&&(e=De.ew);const o=null===(n=this._appViewStateForWindowMap.get(e))||void 0===n?void 0:n.get(t);if(!o){const n=this._servicesAppsRegistry.getAppByID(t);n&&"viewStateRegistration"in n&&n.viewStateRegistration&&(null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,`Unable to find appViewState for window ${e} app ${t}, registeredApps: ${this._appViewStateForWindowMap.get(e)}`,"webclient_framework_foundation_core_services_activator"))}return o}resetAllViewState(e){const t=this._appViewStateForWindowMap.get(e);t&&t.forEach(((e,t)=>{ES.has(t)||this.resetViewStateForApp(t,e)}))}setReactiveValuesForApp(e,t,n){var i;const a=null===(i=this._appViewStateForWindowMap.get(e))||void 0===i?void 0:i.get(t);if(this._logger.log(`Setting view state to apollo cache value for windowId ${e}, app ${t}`),a){const{navigationalReactiveValues:e,nonNavigationalReactiveValues:t}=a;Object.keys(n).forEach((i=>{let a=e[i];a||(a=t[i]),a.update(n[i])}))}}getRegisteredAppsTypePolicies(e){const t={typePolicies:{},defaultTypeName:[]};return this._appViewStateForWindowMap.set(e,new Map),this._servicesAppsRegistry.registeredApps.forEach((n=>{const i=n.manifest.id,a=n;if(a.viewStateRegistration){const{computedValues:n,navigationalFieldDefaultValues:o,nonNavigationalFieldDefaultValues:r,gqlTypeName:s,queryFieldName:l}=a.viewStateRegistration,d=IS(o),c=IS(r),u=this._appViewStateForWindowMap.get(e);null==u||u.set(i,{navigationalReactiveValues:d,nonNavigationalReactiveValues:c});const m=function(...e){const[t,n,i]=e,a={};for(const e of Object.keys(n)){const t=e,i=()=>n[t].read();a[t]={read:i}}if(i)for(const e of Object.keys(i)){const t=e,o=(e,a)=>{const{args:o}=a||{};return i[t](n,o)};a[t]={read:o}}return{[t]:{fields:a}}}(s,Object.assign(Object.assign({},d),c),n);t.typePolicies=Object.assign(Object.assign({},t.typePolicies),m),t.defaultTypeName.push({gqlTypeName:s,queryFieldName:l})}})),t}removeWindowViewState(e){this._appViewStateForWindowMap.delete(e)}resetViewStateForApp(e,t,n){const i=this._servicesAppsRegistry.getAppByID(e);if(i&&t&&"viewStateRegistration"in i&&i.viewStateRegistration){this._logger.log(`Resetting view state for app ${e}`);const{navigationalFieldDefaultValues:a,nonNavigationalFieldDefaultValues:o}=i.viewStateRegistration;Object.keys(a||{}).forEach((e=>{(null==n?void 0:n.includes(e))||t.navigationalReactiveValues[e].update(a[e])})),Object.keys(o).forEach((e=>{(null==n?void 0:n.includes(e))||t.nonNavigationalReactiveValues[e].update(o[e])}))}}}const _S={id:"com.microsoft.teams.corelayout",actors:["corelayout"],name:"CoreLayoutApp"},DS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutResizeSlotDimensionsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"width"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"slotName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SlotName"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resizeSlotDimensions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"Variable",name:{kind:"Name",value:"width"}}},{kind:"Argument",name:{kind:"Name",value:"slotName"},value:{kind:"Variable",name:{kind:"Name",value:"slotName"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};const FS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutResizeHeaderMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"height"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resizeHeaderSlot"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"height"},value:{kind:"Variable",name:{kind:"Name",value:"height"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},MS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCoreLayoutChangeSlotsVisibilityMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"slotNames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SlotName"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isHidden"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSlotsVisibility"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"slotNames"},value:{kind:"Variable",name:{kind:"Name",value:"slotNames"}}},{kind:"Argument",name:{kind:"Name",value:"isHidden"},value:{kind:"Variable",name:{kind:"Name",value:"isHidden"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},RS={eventHandlers:{onEventReceived:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,n,i;const{appViewState:a,eventInput:o,requestContext:{client:r,loggerFactory:s},windowId:l}=e,d=s.newLogger("apps-core-layout"),c=o.event;if(!function(e){if(e.originator!==og.kn)return!1;for(const t in og.uS)if(t===e.type)return!0;return!1}(c))return d.error(`Unhandled event ${o} is not a core layout event`),Promise.reject(new Error(`Unhandled event ${o.event.type} is not a core layout event`));switch(c.type){case og.uS.criticalAppPhaseReached:return a.postCriticalPhaseReached.update(!1),void a.completePhaseReached.update(!1);case og.uS.postCriticalAppPhaseReached:return void a.postCriticalPhaseReached.update(!0);case og.uS.completeAppPhaseReached:return void a.completePhaseReached.update(!0);case og.uS.resizeSlot:return void r.mutate({mutation:DS,variables:{slotName:null===(t=c.data)||void 0===t?void 0:t.call(c).slotName,width:null===(n=c.data)||void 0===n?void 0:n.call(c).width,windowId:l}});case og.uS.updateAmsV2Domain:const{amsV2Domain:e}=c.data();return void(a.amsV2Domain.read()!==e&&a.amsV2Domain.update(e||""));case og.uS.updateBaseImageUrl:const{baseImageUrl:s}=c.data();return d.log(`Received baseImageUrl core-layout event with data ${s}`),void(a.baseImageUrl.read()!==s&&(d.log(`Updating baseImageUrl app view state ${s}`),a.baseImageUrl.update(s||"")));case og.uS.updateIsImageAuthCookieValid:const{isImageAuthCookieValid:u}=(null===(i=c.data)||void 0===i?void 0:i.call(c))||{};return void(void 0!==u&&a.isImageAuthCookieValid.read()!==u&&a.isImageAuthCookieValid.update(u));default:return d.error(`Unhandled event ${o}`),Promise.reject(new Error(`Unhandled event ${o.event.type}`))}}))},onCommandReceived:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{commandInput:n,requestContext:{client:i,loggerFactory:a},slotDimensionsOptions:o,windowId:r}=e,{command:{action:s,actor:l,data:d}}=n,c=a.newLogger("CoreLayoutApp onCommandReceived");if(!(null===(t=_S.actors)||void 0===t?void 0:t.includes(l)))return void c.error(`Command  ${n.command} is sent to the wrong App.`);const{header:{height:u}}=o,{collapsed:m,expanded:g}=u||{};switch(s){case ag.Nw.collapseHeader:i.mutate({mutation:FS,variables:{height:m,windowId:r}});break;case ag.Nw.expandHeader:i.mutate({mutation:FS,variables:{height:g,windowId:r}});break;case ag.Nw.expandTab:{const{excludeHeader:e}=d||{},t=e?[Ft.WL.NOTIFICATIONS,Ft.WL.SUBNAV]:[Ft.WL.HEADER,Ft.WL.NOTIFICATIONS,Ft.WL.SUBNAV];i.mutate({mutation:MS,variables:{slotNames:t,windowId:r,isHidden:!0}});break}case ag.Nw.maximizeTab:i.mutate({mutation:MS,variables:{slotNames:[Ft.WL.HEADER,Ft.WL.NAV,Ft.WL.NOTIFICATIONS,Ft.WL.SUBNAV,Ft.WL.TITLE_BAR],windowId:r,isHidden:!0}});break;case ag.Nw.resetLayoutOverrides:i.mutate({mutation:MS,variables:{slotNames:[Ft.WL.HEADER,Ft.WL.NAV,Ft.WL.NOTIFICATIONS,Ft.WL.SUBNAV,Ft.WL.TITLE_BAR],windowId:r,isHidden:!1}});break;default:c.error(`Command action ${s} is not supported at CoreLayoutApp.`)}})),onViewUpdateCommandResolved:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){})),viewStateRegistration:{gqlTypeName:"CoreLayoutAppViewState",queryFieldName:"coreLayoutAppViewState",navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{amsV2Domain:"",baseImageUrl:"",completePhaseReached:!1,isImageAuthCookieValid:!1,postCriticalPhaseReached:!1},computedValues:void 0}};const PS={[u.p.meetings]:["com.microsoft.teams.calling","com.microsoft.teams.meeting-options"]},OS=function(){const e=()=>null;return Object.assign(Object.assign({},RS),{manifest:_S,render:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return o.createElement(e,null)}))})}();class xS{constructor(e,t,n){this._loadedTasksMap=new Map,this._appIdToAppMap=void 0,this._logger=e.newLogger("AppsRegistryService"),this._loadedApps=[],this._entityTypeToAppMap=new Map,this.initialize(n),this._reactiveValuesService=new AS(e,this,t)}get registeredApps(){return this._loadedApps}get registeredAppManifests(){return this._loadedApps.map((e=>e.manifest))}get registeredTasks(){return Array.from(this._loadedTasksMap.values())}getApp({entityType:e,renderMode:t}){if(e||t)return this.registeredApps.find((n=>(!e||function({supportedEntities:e},t){return!(!e||-1===e.indexOf(t))}(n.manifest,e))&&(!t||function({supportedRenderModes:e},t){return!(!e||-1===e.indexOf(t))}(n.manifest,t))))}getAppViewStateForWindow(e,t){return this._reactiveValuesService.getAppViewStateForWindow(e,t)}getAppByID(e){var t;return null===(t=this._appIdToAppMap)||void 0===t?void 0:t.get(e)}getPlatformAppIdForEntity(e){const t=this._entityTypeToAppMap.get(e.type);if(void 0===t)return void this._logger.error("getPlatformAppIdForEntity: Platform id requested for entity which has no registered app in this experience.",{entityType:e.type});if(void 0===t.getPlatformAppIdForEntity)return void this._logger.debug("getPlatformAppIdForEntity: An app is registered for this entity but has no function for getPlatformAppIdForEntity.",{appName:t.manifest.name,entityType:e.type});let n;try{n=t.getPlatformAppIdForEntity(e)}catch(n){this._logger.error("getPlatformAppIdForEntity: Error caught from app handler while mapping the id for this entity.",{appName:t.manifest.name,entityType:e.type})}if(void 0!==n)return n;this._logger.debug("getPlatformAppIdForEntity: App mapped the id for this entity to undefined.",{appName:t.manifest.name,entityType:e.type})}getAppByActor(e){if(e)return this.registeredApps.find((t=>function({actors:e},t){return!(!e||-1===e.indexOf(t))}(t.manifest,e)))}getDefaultCommand(e){var t,n;const{coldBootAppId:i}=e.get(K.J.Edu),{coreColdBootAppId:a,enableEDUColdBootApp:o}=e.get(K.J.Core),r=o?i:a;if(r){this._logger.debug(`Using cold boot appId of ${r} with enableEDUColdBootApp ${o}`);const i=this.getAppByID(r),a=null===(n=null==i?void 0:(t=i.manifest).getDefaultCommand)||void 0===n?void 0:n.call(t,e);if(a)return a;this._logger.debug(`No default command found ${r}`)}for(const t of this.registeredAppManifests)if(t.getDefaultCommand){const n=t.getDefaultCommand(e);if(n)return this._logger.debug(`Found a default command in ${t.name}`),n}}resetAllViewState(e){this._reactiveValuesService.resetAllViewState(e)}setReactiveValuesForApp(e,t,n){this._reactiveValuesService.setReactiveValuesForApp(e,t,n)}getRegisteredAppsTypePolicies(e){return this._reactiveValuesService.getRegisteredAppsTypePolicies(e)}removeWindowViewState(e){this._reactiveValuesService.removeWindowViewState(e)}registerTask(e){this._loadedTasksMap.set(e.id,e)}initialize(e){const t=new Map;if(!(e&&e.length>0))throw new Error(`initialize::${De.jK.Empty} - No apps registered`);-1===e.findIndex((e=>e.manifest.id===OS.manifest.id))&&e.length>0&&e.push(OS),e.forEach((e=>{var n;if(t.has(e.manifest.id))throw new Error(`Multiple apps found for appId ${e.manifest.id}`);t.set(e.manifest.id,e),null===(n=e.manifest.supportedEntities)||void 0===n||n.forEach((t=>{const n=PS[t];if(!n||!n.includes(e.manifest.id)){if(this._entityTypeToAppMap.has(t))throw new Error(`Multiple apps found for entity ${t}`);this._entityTypeToAppMap.set(t,e)}})),e.onRegister&&e.onRegister({registerTask:this.registerTask.bind(this)})})),this._loadedApps=Array.from(t.values()),this._appIdToAppMap=t}}class LS{constructor(e,t,n,i,a,o,r,s,l,d,c,u){this._loggerFactory=e,this._appsRegistryService=t,this._config=n,this._configLoader=i,this._coreTasks=o,this._diagnosticsService=r,this._logsCollectorService=s,this._waitForRenderingContextReady=l,this._isEntityInView=d,this._criticalDynamicImports=c,this._getPlatformConfigurationOverrides=u,this._logger=e.newLogger("TaskManagerService"),this._appsRegistryService=t,this._taskContext=this.createNewContext(a)}notifyLifeCycleEvent(e,t={},n){var a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this.extractApplicableTasks(this._appsRegistryService.registeredTasks,e);this._logger.log(`notify::starting - lifeCycleEvent=${e}, taskCount=${i.length}`);const r=Object.assign(Object.assign({},this._taskContext),t);this.markCoreLifeCycleEventStart(r,e);const s={},l=null===(a=null===performance||void 0===performance?void 0:performance.timing)||void 0===a?void 0:a.navigationStart,d=new Map,c=[];let u=0;for(const t of i){const i=null===(o=null===performance||void 0===performance?void 0:performance.now)||void 0===o?void 0:o.call(performance),a=e=>{this._logger.error(`notify:: Task Execute Error - taskId ${De.Yg[t.id]}, code=${e.code} errorMsg=${(0,Mn.B9)((null==e?void 0:e.prevError)||e)}\n          .`),d.set(t.id,e)},m=()=>t instanceof Fe?t.executeSafe(r,s):t.execute(r,s),g=e=>e?(0,Rn.E)(m(),e,`${De.Yg[t.id]} timed out.`):m(),p=yield g(this._config.coreTasksTimeoutMs).catch(a);p&&c.push({taskId:t.id,cleanupFn:p}),this.markCoreLifeCycleTaskCompleted(r,e,t,d,i,l,++u),null==n||n(t.id)}return this.handleErrors(e,d),this._logger.log(`notify::tasks complete - lifeCycleEvent=${e}, taskCount=${i.length}`),Object.assign(Object.assign(Object.assign({},s),r),{coreTaskErrors:Array.from(d.values()),cleanupFns:c})}))}destroyContext(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=e.cleanupFns.length;let i,a=0;for(;i=e.cleanupFns.pop();)try{yield i.cleanupFn(t),a++}catch(e){this._logger.error(`Cleanup failed for task: ${De.Yg[i.taskId]}`)}this._logger.log(`destroyContext complete: ${a}/${n} tasks succeeded.`)}))}hasTasks(e){return this.extractApplicableTasks(this._appsRegistryService.registeredTasks,e).length>0}markCoreLifeCycleEventStart(e,t){var n,i,a;const o=null===(n=e.altScenarioService)||void 0===n?void 0:n.altScenario,r=null===(i=e.altScenarioService)||void 0===i?void 0:i.clientStartScenario,s=`${uS}${t}`;o||r?(o&&o.mark(s),r&&r.mark(s)):null===(a=null===performance||void 0===performance?void 0:performance.mark)||void 0===a||a.call(performance,s)}markCoreLifeCycleTaskCompleted(e,t,n,i,a,o,r){var s,l,d;const c=null===(s=e.altScenarioService)||void 0===s?void 0:s.altScenario,u=null===(l=e.altScenarioService)||void 0===l?void 0:l.clientStartScenario,m=`${t}_${De.Yg[n.id]}`;c||u?(c&&c.mark(`core_task_${m}`),u&&u.mark(`core_task_${m}`)):null===(d=null===performance||void 0===performance?void 0:performance.mark)||void 0===d||d.call(performance,`${mS}${m}`),this.addTaskDetailsToLocalStorage(i,a,o,m,n,r,e)}addTaskDetailsToLocalStorage(e,t,n,i,a,o,r){var s;try{const{windowProvider:l,config:d}=r;if(d.shouldTrackCoreInitTasks){const r=e.get(a.id)||{};null==l||l.localStorage.setItem(i,(0,Ci.u4)({index:o,startTime:new Date(n+t).toISOString(),duration:(null===(s=null===performance||void 0===performance?void 0:performance.now)||void 0===s?void 0:s.call(performance))-t,error:r}))}}catch(e){e.code===DOMException.QUOTA_EXCEEDED_ERR?this._logger.error("Error: Quota exceeded while writing core task details to local storage."):this._logger.warn(`Couldn't write core init task details to local storage: ${(0,Mn.B9)(e)}`)}}createNewContext(e){return{correlation:e,diagnosticsService:this._diagnosticsService,logsCollectorService:this._logsCollectorService,loggerFactory:this._loggerFactory,appsRegistryService:this._appsRegistryService,config:this._config,configLoader:this._configLoader,waitForRenderingContextReady:this._waitForRenderingContextReady,isEntityInView:this._isEntityInView,criticalDynamicImports:this._criticalDynamicImports,getPlatformConfigurationOverrides:this._getPlatformConfigurationOverrides}}extractApplicableTasks(e,t){var n,i;const a=[];if(e){const n=e.filter((e=>!e.lifeCycleSubscriptions&&t===De.sM.Initialization||e.lifeCycleSubscriptions&&-1!==e.lifeCycleSubscriptions.indexOf(t)));a.push(...n)}return((null===(i=(n=this._coreTasks)[t])||void 0===i?void 0:i.call(n))||[]).concat(a)}handleErrors(e,t){if(t.size>0){const n=(0,Mn.Tr)("TaskManagerService",De.jK.NotInitialized,`lifeCycleEvent=${e}`,{failedTaskErrors:t});this._logger.error(`Failed ${t.size} core tasks: ${Array.from(t.keys()).map((e=>De.Yg[e])).join()}, lifeCycleEvent=${e}: `,n)}}}const US={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"windowOptionsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]},BS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindows"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"isInitialWindowStateHidden"}},{kind:"Field",name:{kind:"Name",value:"userContextId"}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}}]}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindows"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"windowOptionsFields"}}]}}]}},...US.definitions]}.definitions,...US.definitions]},jS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsersEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cloud"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}},{kind:"Field",name:{kind:"Name",value:"homeAccountId"}}]}}]}}]}}]},WS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cloud"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"loginUserName"}},{kind:"Field",name:{kind:"Name",value:"homeAccountId"}}]}}]}}]};var VS=n(358272);const HS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowForEntity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindowForEntity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"entityFieldsForActiveWindow"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"entityFieldsForActiveWindow"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}}]}}]};var $S=n(316951),zS=n(843211),GS=n(154923),qS=n(546889);const QS={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"executeEntityCommand"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"executionContext"}},type:{kind:"NamedType",name:{kind:"Name",value:"ExecutionContextInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"command"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityCommandInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"WindowOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"executeEntityCommand"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"executionContext"},value:{kind:"Variable",name:{kind:"Name",value:"executionContext"}}},{kind:"Argument",name:{kind:"Name",value:"command"},value:{kind:"Variable",name:{kind:"Name",value:"command"}}},{kind:"Argument",name:{kind:"Name",value:"clientLaunchId"},value:{kind:"Variable",name:{kind:"Name",value:"clientLaunchId"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"windowOptions"},value:{kind:"Variable",name:{kind:"Name",value:"windowOptions"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};function JS(e){return Object.assign(Object.assign({},e),{id:(t=e,t&&t.id||(0,mt.v4)()),startTimestamp:YS(e),source:(null==e?void 0:e.source)||Ot.D.StandAlone});var t}function YS(e){return e&&e.startTimestamp||Date.now()}function KS({appName:e,commandChangeReportingService:t,entityCommand:n,getCommandScenarioName:i,logger:a,coreSettings:o}){const r=n.command.correlation,s=void 0===r.scenarioName||r.scenarioName===ft.RG.EntityCommand;if(i&&s){try{r.scenarioName=i(n,a,o)}catch(n){t.report({type:GS.B.Failure,context:{errorInfo:qS.y.GetCommandScenarioNameHookFailed,errorMessage:`App ${e} failed to execute entity command hook GetCommandScenarioName with ${n.name}`,target:"internal-command-handler"},correlationId:r.id})}a.log(`App ${e} is overwriting default scenario name to ${r.scenarioName} for command with entityType ${n.entity.type}`)}}function ZS(e){return Object.assign(Object.assign({},e),{command:XS(e.command)})}function XS(e){return Object.assign(Object.assign({},e),{correlation:JS(e.correlation)})}function eb(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield t.query({query:HS,variables:{entity:e},fetchPolicy:"no-cache"});return null===(a=n.data.activeWindowForEntity)||void 0===a?void 0:a.id}catch(t){return void n.error(`query for entity failed. Entity: ${JSON.stringify(e)}, Error: ${t}`)}}))}function tb(e,t,n,i){const a=t.getValue().find((t=>t.id===e)),o=!(!a||!a.window.document.hasFocus()),r=n.getState(),s=r===VS.pk.LongInactive||r===VS.pk.Inactive,l=o&&!s;return l||i.log(`isWindowInView: Window considered to be not in view. Window is inactive ${s}, window has focus: ${o}`),l}function nb(e){return function(e,t){return(0,$S.sanitize)(e,t)}(e,function(e,t){return{ADD_ATTR:e,ADD_TAGS:t,RETURN_TRUSTED_TYPE:!0,WHOLE_DOCUMENT:!0}}(["content","focusable","nonce","onclick"],["link","meta","script","#comment","!doctype"]))}function ib(e){var t,n;return[null!==(t=null==e?void 0:e.findScenario(ft.RG.ClientStart))&&void 0!==t?t:null,null!==(n=null==e?void 0:e.findScenario(ft.RG.ExperienceReady))&&void 0!==n?n:null]}function ab(e,t){return e instanceof Ae.G?e:new zS.G(zS.$.UNKNOWN,e,t)}function ob(e,t,n,i){return rb.bind(void 0,e,t,n,i)}function rb(e,t,n,a){var o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i="";const s=null==e?void 0:e.host;s&&(i=`SessionId:\t${s.sessionId}\r\nDeviceId:\t${s.deviceId}\r\nHostVersion:\t${s.hostAppVersion}\r\n`);const l=null==e?void 0:e.config;l&&(i=`${i}WebVersion:\t${null==l?void 0:l.clientVersion}\r\n`);const d=null==t?void 0:t.locale;d&&(i=`${i}Language:\t${d}\r\n`);const c=null==a?void 0:a.get(K.J.Metadata);(null===(o=null==c?void 0:c.ring)||void 0===o?void 0:o.id)&&(i=`${i}Ring:\t${c.ring.id}\r\n`);const u=yield null===(r=null==n?void 0:n.getCachedUsers)||void 0===r?void 0:r.call(n,Object.assign(Object.assign({},JS({source:Ot.D.Core})),{scenarioName:ft.RG.AuthWebCachedUser}));if(null==u?void 0:u.length){i=`${i}Logged in users:\r\n`;for(const e of u)i=`${i}\t${e.userName}  ${e.profile.name}  TId:${e.profile.tid}  OId:${e.profile.oid}  UserId:${e.id}\r\n`}return i}))}var sb=n(649189);const lb=new Set([zn.quit,zn.restart]);function db({hostCommunicationService:e,logger:t,reason:n,renderingContextManager:a}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let o;const r=a.getDefaultRenderingContext();switch((null==r?void 0:r.scenarioFactory)&&(o=ub(n,r.scenarioFactory)),n){case"quit":try{yield a.removeAllRenderingContexts(n),null==o||o.mark(ft.ck.RemoveAllRenderingContexts),yield function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o;try{i=yield t.loadModule("core")}catch(e){o="LoadModuleCoreFailed"}try{yield null===(a=null==i?void 0:i.reportReadyToQuit)||void 0===a?void 0:a.call(i)}catch(e){o="ReportReadyToQuitFailed"}o&&pb(o,e,n)}))}(t,e,o),null==o||o.stop()}catch(e){gb(e,t,o)}break;case"restart":try{yield a.cleanupWithPriority(n),null==o||o.stop()}catch(e){gb(e,t,o)}break;default:return}}))}function cb({coreSettings:e,logger:t,reason:n,renderingContextManager:a,user:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;try{const t=o&&(0,li.b)(o);if(!t)throw new zS.G(zS.$.CLEANUP,new Error("signout::UserContextIdNotFound"));const r=yield a.getUserRenderingContext(t);(null==r?void 0:r.scenarioFactory)&&(i=ub(n,r.scenarioFactory)),yield a.removeUserRenderingContext(n,t),null==i||i.mark(ft.ck.RemoveUserRenderingContext);if(!e.get(K.J.Auth).isLegacyCleanupCodeFlag){const e=["TestCookie","ringFinder"];!function(e){try{(0,Ze.J)().sessionStorage.clear()}catch(t){mb(e,"ClearSessionStorageFailed")}}(i),function(e,t){try{Object.keys(sb.getJSON()).forEach((t=>{e.includes(t)||sb.remove(t)}))}catch(e){mb(t,"DeleteCookiesFailed")}}(e,i)}null==i||i.stop()}catch(e){gb(e,t,i)}}))}function ub(e,t){const n=t.newScenario(ft.RG.CoreCleanup),i={reason:e};return n.appendEventData(i),n}function mb(e,t){const n={errorCode:t};e&&e.fail(n)}function gb(e,t,n){let i;i=e instanceof zS.G&&Ae.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():e instanceof Error?`${zS.$.CLEANUP}::UnknownCleanupFailure::${null==e?void 0:e.name}::${null==e?void 0:e.message}`:`${zS.$.CLEANUP}::UnknownCleanupFailure::${(0,Ci.u4)(e)}`,pb(i,t,n)}function pb(e,t,n){var i;n&&mb(n,e),null===(i=t.errorToTelemetry)||void 0===i||i.call(t,e,"webclient_framework_foundation_core_services",void 0,!0)}var vb=n(646261),hb=n(575082),fb=n(125901),yb=n(884766),kb=n(42103),Sb=n(723373),bb=n(815053);class Cb{constructor(e,t,n){this.eventHandler=e,this.commandHandler=t,this.commandDelegator=n}bubble(e){return this.eventHandler(e,this.commandHandler,this.commandDelegator)}}const wb=new Set([c.ab,c.Xt]),Nb=e=>"viewStateRegistration"in e,Tb=e=>wb.has(e.manifest.id),Ib=e=>{var t,n,i,a,o,r,s;return null!==(r=null!==(a=null!==(n=null===(t=e.current)||void 0===t?void 0:t.subNavEntity)&&void 0!==n?n:null===(i=e.current)||void 0===i?void 0:i.headerEntity)&&void 0!==a?a:null===(o=e.current)||void 0===o?void 0:o.startEntity)&&void 0!==r?r:null===(s=e.current)||void 0===s?void 0:s.mainEntity};const Eb="internal-event-handler",Ab=({commandChangeReportingService:e,correlation:t,type:n})=>{switch(n){case GS.B.DelegatedCommandReceived:e.report({type:n,correlationId:t.id,context:{target:Eb,correlation:t}});break;default:e.report({type:n,correlationId:t.id,context:{target:Eb}})}},_b=({commandChangeReportingService:e,correlation:t,errorInfo:n=qS.y.DelegatedCommandError,errorMessage:i,logger:a})=>{var o;null===(o=a.errorToTelemetry)||void 0===o||o.call(a,i,"webclient_framework_foundation_core_services_internal_command_delegator",void 0,!0),e.report({correlationId:t.id,type:GS.B.Failure,context:{target:Eb,errorMessage:i,errorInfo:n}})};var Db=n(594178);const Fb=({appsRegistryService:e,client:t,commandChangeReportingService:n,commandHandler:a,commandInput:o,coreSettings:r,executionContext:s,loggerFactory:l,scenarioFactory:d,windowId:c,host:u,userBiService:m})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const g=l.newLogger("internalCommandDelegator"),p=o.correlation||JS();Ab({commandChangeReportingService:n,correlation:p,type:GS.B.DelegatedCommandReceived});const v=function(e,t){return e.getAppByActor(t.command.actor)}(e,o);if(!v){const e=`Command for actor ${o.command.actor} does not map to any registered app.`;return _b({commandChangeReportingService:n,correlation:p,errorMessage:e,logger:g}),Promise.resolve(void 0)}if(!v.onCommandReceived){const e=`Command for actor ${o.command.actor} maps to app ${v.manifest.name}, but the app hasn't registered onCommandReceived handler.`;return _b({commandChangeReportingService:n,correlation:p,errorMessage:e,logger:g}),Promise.resolve(void 0)}const{navigationalReactiveValues:h,nonNavigationalReactiveValues:f}=e.getAppViewStateForWindow(c||De.ew,v.manifest.id)||{};let y=!1,k={};h&&(k=Object.keys(h).reduce(((e,t)=>{const n=h[t];return Object.assign(Object.assign({},e),{[t]:{read:n.read,update:e=>{e!==n.read()&&(n.update(e),y=!0)}}})}),{}));const S=function(e,t,n,i,a,{viewEntitiesRef:o,viewEntity:r}={},s){var l,d,c;const u=o&&Ib(o);return{client:e,coreSettings:t,loggerFactory:n,scenarioFactory:i,executionContext:{viewEntities:{endEntity:null===(l=null==o?void 0:o.current)||void 0===l?void 0:l.endEntity,mainEntity:null===(d=null==o?void 0:o.current)||void 0===d?void 0:d.mainEntity},viewEntity:r,isHandlingAppActiveApp:!!u&&(null===(c=a.getApp({entityType:u.type}))||void 0===c?void 0:c.manifest.id)===s}}}(t,r,l,d,e,s,v.manifest.id);let b;try{const e={commandInput:o,requestContext:S};Ab({commandChangeReportingService:n,correlation:p,type:GS.B.BeforeOnCommandReceived});const a=Object.assign(Object.assign({},k),f);b=yield(({delegatedApp:e,reactiveValues:t,hookOptions:n,host:a,windowId:o,userBiService:r})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!e.onCommandReceived)return Promise.resolve(void 0);if(Nb(e)&&Tb(e)){if(t){const i=Object.assign(Object.assign({},n),{appViewState:t,host:a,slotDimensionsOptions:Ft.Vi,windowId:o,userBiService:r});return e.onCommandReceived(i)}}else{if(!Nb(e)){if(Tb(e)){const t=Object.assign(Object.assign({},n),{windowId:o,slotDimensionsOptions:Ft.Vi});return e.onCommandReceived(t)}return e.onCommandReceived(n)}if(t){const i=Object.assign(Object.assign({},n),{appViewState:t});return e.onCommandReceived(i)}}return Promise.resolve(void 0)})))({delegatedApp:v,reactiveValues:a,hookOptions:e,host:u,windowId:c,userBiService:m}),y&&(t.mutate({mutation:Db.E,variables:{windowId:c,appIds:[v.manifest.id]}}).catch((e=>{g.warn(`saveReactiveVarToHistory failed ${e.message}`)})),y=!1),Ab({commandChangeReportingService:n,correlation:p,type:GS.B.AfterOnCommandReceived})}catch(e){const t=`Command for actor ${o.command.actor} encountered an error inside onCommandReceived of ${v.manifest.name}.`;return _b({commandChangeReportingService:n,correlation:p,errorMessage:t,logger:g}),Promise.reject(e)}if(!b)return Ab({correlation:p,commandChangeReportingService:n,type:GS.B.CommandHandledByOnCommandReceived}),Promise.resolve(void 0);const C=Object.assign(Object.assign({},b),{command:Object.assign(Object.assign({},b.command),{correlation:p})});a(C)}));const Mb="internal-event-handler",Rb=({commandChangeReportingService:e,correlation:t,type:n})=>{switch(n){case GS.B.EventBubbled:e.report({type:n,correlationId:t.id,context:{target:Mb,correlation:t}});break;default:e.report({type:n,correlationId:t.id,context:{target:Mb}})}},Pb=({commandChangeReportingService:e,correlation:t,errorMessage:n,logger:i})=>{var a;const o=qS.y.EventError;null===(a=i.errorToTelemetry)||void 0===a||a.call(i,n,"webclient_framework_foundation_core_services_internal_event_handler",void 0,!0),e.report({correlationId:t.id,type:GS.B.Failure,context:{target:Mb,errorMessage:n,errorInfo:o}})},Ob=({appsRegistryService:e,client:t,commandChangeReportingService:n,commandDelegator:a,commandHandler:o,coreSettings:r,eventInput:s,executionContext:l,loggerFactory:d,scenarioFactory:u,userBiService:m,windowId:g})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var p;const v=d.newLogger("internalEventHandler");let h=function(e,t){var n;return t?t&&e.getApp({entityType:null===(n=t.viewEntity)||void 0===n?void 0:n.type}):e.getAppByID(c.ab)}(e,l);const f=((e,t,n,i)=>{var a;const{scenarioName:o,id:r,source:s}=(null===(a=null==t?void 0:t.getEventScenarioData)||void 0===a?void 0:a.call(t,e,i))||{},l=JS({id:r,scenarioName:o,source:s,startTimestamp:Date.now()});return Rb({commandChangeReportingService:n,correlation:l,type:GS.B.EventBubbled}),l})(s,h,n,v);if("com.microsoft.teams.search"===(null==h?void 0:h.manifest.id)&&"MeControl"===s.event.originator&&(h=e.getApp({renderMode:L.OQr.TitleBar})),!h){return Pb({commandChangeReportingService:n,correlation:f,errorMessage:"Error mapping event to slot.",logger:v}),Promise.resolve(void 0)}if(!(null===(p=h.eventHandlers)||void 0===p?void 0:p.onEventReceived)){const e=`Event '${s.event.type}' was received for app ${h.manifest.name}, but it hasn't registered an event handler.`;return Pb({commandChangeReportingService:n,correlation:f,errorMessage:e,logger:v}),Promise.resolve(void 0)}const y=function(e,t,n,i,a,o,{viewEntitiesRef:r,viewEntity:s}={},l){var d,c,u;const m=r&&Ib(r);return{client:e,coreSettings:t,loggerFactory:n,scenarioFactory:i,userBiService:a,executionContext:{viewEntities:{endEntity:null===(d=null==r?void 0:r.current)||void 0===d?void 0:d.endEntity,mainEntity:null===(c=null==r?void 0:r.current)||void 0===c?void 0:c.mainEntity},viewEntity:s,isHandlingAppActiveApp:!!m&&(null===(u=o.getApp({entityType:m.type}))||void 0===u?void 0:u.manifest.id)===l}}}(t,r,d,u,m,e,l,h.manifest.id);let k;try{const a={eventInput:s,requestContext:y};Rb({correlation:f,commandChangeReportingService:n,type:GS.B.BeforeOnEventReceived});const{navigationalReactiveValues:o,nonNavigationalReactiveValues:r}=e.getAppViewStateForWindow(g||De.ew,h.manifest.id)||{};let l=!1,d={};o&&(d=Object.keys(o).reduce(((e,t)=>{const n=o[t];return Object.assign(Object.assign({},e),{[t]:{read:n.read,update:e=>{e!==n.read()&&(n.update(e),l=!0)}}})}),{}));const c=(d||r)&&Object.assign(Object.assign({},d),r);k=yield(({sourceApp:e,reactiveValues:t,hookOptions:n,windowId:a})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;let o;if(!(null===(i=e.eventHandlers)||void 0===i?void 0:i.onEventReceived))return Promise.resolve(void 0);if(Nb(e)&&Tb(e)){if(t){const i=Object.assign(Object.assign({},n),{appViewState:t,windowId:a});o=yield e.eventHandlers.onEventReceived(i)}}else if(Nb(e)){if(t){const i=Object.assign(Object.assign({},n),{appViewState:t});o=yield e.eventHandlers.onEventReceived(i)}}else if(Tb(e)){const t=Object.assign(Object.assign({},n),{windowId:a});o=yield e.eventHandlers.onEventReceived(t)}else o=yield e.eventHandlers.onEventReceived(n);return Promise.resolve(o)})))({sourceApp:h,reactiveValues:c,hookOptions:a,windowId:g}),l&&(t.mutate({mutation:Db.E,variables:{windowId:g,appIds:[h.manifest.id]}}).catch((e=>{v.warn(`saveReactiveVarToHistory mutation failed ${e.message}`)})),l=!1),Rb({correlation:f,commandChangeReportingService:n,type:GS.B.AfterOnEventReceived})}catch(e){const t=`Event '${s.event.type}' encountered an error inside onEventReceived of ${h.manifest.name}.`;return Pb({commandChangeReportingService:n,correlation:f,errorMessage:t,logger:v}),Promise.reject(e)}if(!k)return Rb({correlation:f,commandChangeReportingService:n,type:GS.B.EventHandled}),Promise.resolve(void 0);const S=Object.assign(Object.assign({},k),{correlation:f});return a(S,o)}));var xb=n(957701);const Lb="DeepLink:: ";var Ub,Bb;!function(e){e.DecodeURIComponentFailed="DecodeURIComponentFailed",e.DeeplinkNotHandledByRegisteredApps="DeeplinkNotHandledByRegisteredApps",e.DeeplinkTerminatedByApp="DeeplinkTerminatedByApp",e.ExecuteFromUrlFailed="ExecuteFromUrlFailed",e.IntentServiceExecutionFailed="IntentServiceExecutionFailed",e.InvalidDeepLinkUrl="InvalidDeepLinkUrl",e.OnBeforeDeeplinkParsedFailed="OnBeforeDeeplinkParsedFailed",e.ToNavigationIntentFailed="ToNavigationIntentFailed",e.InvalidOrigin="InvalidOrigin"}(Ub||(Ub={})),function(e){e.NavigationIntentNotFound="NavigationIntentNotFound"}(Bb||(Bb={}));var jb=n(338316),Wb=n(118115);const Vb="https://teams.microsoft.com/l",Hb="/task/",$b="/stage/",zb="/entity/",Gb="context",qb="application/vnd.microsoft.card.adaptive",Qb=(e,t,n)=>{const i=e=>null==n?void 0:n(e);return e.executeCommand(t.entity,{entityCommand:t.command,entityOptions:t.entityOptions}).subscribe({complete:i,error:i}),Promise.resolve()},Jb=(e,t,n,i,a,o)=>{const r=e.executeCommand(t.entity,{entityCommand:t.command,entityOptions:t.entityOptions}),s=n.newScenario(ft.RG.ExtTaskModuleLaunch),l=jb.gV.DeepLink;return r.subscribe({complete:()=>{i.log(`task module complete for entrypoint ${l}`),s.stop(Zb(a,l)),o&&o()},error:e=>{i.error(`error launching task module for entry point ${l}.  Error:`,e),s.fail(Zb(a,l,e)),o&&o(e)},next:e=>{e.containerState===c.oq.Open&&s.stop(Zb(a,l))}}),Promise.resolve()},Yb=(e,t)=>{const n=new URL(e).pathname.split("/");if(n.length===t){const[,,e,t,i]=n;return!(!e||!t)}return!1},Kb=e=>!(!e||!e.startsWith(Vb)),Zb=(e,t,n)=>{const i={};return e&&(i["App.Id"]=e),t&&(i["App.EntryPoint"]=jb.gV[t]),n&&(i.errors=n),i},Xb=(e,t)=>{if(!t)throw new Error("Could not find app context");switch(e.type){case u.p.extensions:return Object.assign(Object.assign({},t),{type:Wb.p.tab});case u.p.channels:return Object.assign(Object.assign({},t),{type:Wb.p.channel});case u.p.chats:return Object.assign(Object.assign({},t),{type:Wb.p.chat});default:throw new Error("unsupported launch context")}},eC=e=>!!e&&"0"!==e,tC=e=>e?JSON.parse(e):{},nC=(e,t)=>{switch(e&&e.type){case u.p.extensions:return oC(e);case u.p.chats:return{chatId:e.id||""};case u.p.channels:{const{channelId:n,replyChainId:i}=tC(e.id);return{channelId:n,parentMessageId:i,chatId:aC(i,n,t),meetingId:iC(n,i)}}default:return}},iC=(e,t)=>e?eC(t)?btoa(`0#${e}#${t}`):btoa(`0#${e}#0`):"",aC=(e,t,n)=>eC(e)&&n?t.includes("messageid")?t:`${t};messageid=${e}`:t,oC=e=>{if(e.linkedEntity)switch(e.linkedEntity.type){case u.p.chats:return{chatId:e.linkedEntity.id};case u.p.channels:{const{channelId:t,replyChainId:n}=tC(e.linkedEntity.id);return{channelId:t,parentMessageId:n}}case u.p.extensions:return e.linkedEntity.id?JSON.parse(e.linkedEntity.id):void 0}},rC=(e,t)=>{const n=e.search.indexOf("=")+1,i=e.search.substring(n)||"",a=decodeURIComponent(i),{contentUrl:o,websiteUrl:r,removeUrl:s,name:l}=JSON.parse(a);return{type:"tab/tabInfoAction",tabInfo:{contentUrl:o,websiteUrl:r,removeUrl:s,name:l,entityId:t}}},sC=e=>{const t=e.search.indexOf("?")+1;return(e.search.substring(t)||"").split("&").reduce(((e,t)=>{const[n,i]=t.split("="),o=decodeURIComponent(i);return Object.assign(Object.assign({},e),{[n]:(0,a.isString)(n)&&"card"===n.toLowerCase()?lC(o):o})}),{})},lC=e=>{try{const t=JSON.parse(e),n=(0,a.isString)(t.contentType)&&t.contentType.toLowerCase()===qb.toLowerCase(),i=(0,a.isString)(t.type)&&"adaptivecard"===t.type.toLowerCase();return n?{content:JSON.stringify(t.content),contentType:t.contentType}:i?{content:e,contentType:qb}:null}catch(e){return null}};class dC{constructor(e,t,n,i,a,o,r,s,l,d){this.host=e,this.commandHandler=t,this.extensionCommandingService=n,this.scenarioFactory=i,this.deeplinkService=o,this.coreSettings=r,this.userContextId=s,this.sourceViewEntity=l,this.clientLaunchId=d,this.logger=a.newLogger("DeepLinkCommandingService")}checkForPendingDeeplink(e,t){return this.deeplinkService.checkForPendingIntent(e,this.clientLaunchId,null!=t?t:this.userContextId)}launchMainApp(e,t){return this.deeplinkService.launchMainApp(e,this.clientLaunchId,t)}switchAccount(e,t,n,i){return this.deeplinkService.switchAccount(e,t,this.clientLaunchId,n,i)}prewarmFlyout(e){return this.deeplinkService.prewarmFlyout(e)}executeFromUrlV2(e,t,n){var a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.allowV2Flow(e))return!1;try{return yield this.deeplinkService.executeFromUrlAsync(e,t,n,this.clientLaunchId,this.userContextId,this.sourceViewEntity)}catch(e){const t=`DeepLinkCommanding:: ${Ub.ExecuteFromUrlFailed} ${(0,Ci.u4)(e)}`;throw null===(o=(a=this.logger).errorToTelemetry)||void 0===o||o.call(a,t,"webclient_framework_foundation_core_services_deeplink",void 0,!0),new Error(t)}}))}executeDeepLinkFromUrl(e,t,n,a){var o,r,s,l;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=!!(null===(o=this.coreSettings.get(K.J.Core))||void 0===o?void 0:o.handleInternalDeepLinks),d=!!(null===(r=this.coreSettings.get(K.J.Extensibility))||void 0===r?void 0:r.enableChatIdChangeInGetContextCall);try{if(yield this.executeFromUrlV2(e,n))return}catch(e){null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,null==e?void 0:e.message,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}const c=this.createEntityCommandFromDeepLink(e,t,d);return c?((e,t,n,i,a,o,r)=>{switch(e.entity.type){case u.p.taskmodule:const s=new URL(t),[,,,l]=s.pathname.split("/");return Jb(i,e,o,a,l,r);case u.p.platformStage:return Qb(i,e,r);default:return n(e)}})(c,e,this.commandHandler,this.extensionCommandingService,this.logger,this.scenarioFactory,a):i?void this.host.open(e):this.host.opener.open(xb.B.OpenOnMainRenderer,xb._.DeepLink,{url:e})}))}executeIntent(e){return this.deeplinkService.executeIntent(e)}createEntityCommandFromDeepLink(e,t,n){return Yb(e,4)&&(e=>{if(Kb(e))return e.substr(Vb.length).toLowerCase().substring(0,Hb.length)===Hb;return!1})(e)?((e,t,n)=>{const i=(0,mt.v4)(),a=new URL(e),[,,,o]=a.pathname.split("/"),r={entryPoint:jb.gV.DeepLink,appId:o,taskInfo:sC(new URL(e))};return{entity:{id:i,type:u.p.taskmodule,action:u.u.create},command:{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:Ot.D.ExtensionCommanding}},entityOptions:{input:r,launchContext:Xb(t,nC(t,n))}}})(e,t,n):(e=>Yb(e,5))(e)&&(e=>!!Kb(e)&&e.substr(Vb.length).toLowerCase().substring(0,$b.length)===$b)(e)?(e=>{try{const t=new URL(e),[,,,n]=t.pathname.split("/"),i=(0,mt.v4)();return{entity:{id:i,type:u.p.platformStage,action:u.u.view},command:{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:Ot.D.ExtensionCommanding}},entityOptions:{appId:n,tabInfo:JSON.stringify(rC(t,i))}}}catch(e){return null}})(e):null}allowV2Flow(e){var t,n;return!!(this.coreSettings.get(K.J.Extensibility).handleDeepLinkToMeetingSidePanel&&(e=>{if(!Yb(e,5))return!1;const{searchParams:t}=new URL(e),n=t.has(Gb)&&t.get(Gb);if(!n)return!1;try{const e=JSON.parse(decodeURIComponent(n));return!(!e||!e.chatId||"chat"!==e.contextType&&"meeting"!==e.contextType||"false"===t.get("openInMeeting"))}catch(e){return!1}})(e)&&(n=e,Kb(n)&&n.substring(Vb.length).toLowerCase().substring(0,zb.length)===zb))||!!(null===(t=this.coreSettings.get(K.J.Core))||void 0===t?void 0:t.handleInternalDeepLinks)}}var cC=n(95717),uC=n(516175),mC=n(520410),gC=n(632585),pC=n(58646);const vC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesEntityCommandingActiveWindowContainerStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}}]}}]},hC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindowBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]},fC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addBlockingExtension"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entity"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntityInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addBlockingExtension"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entity"},value:{kind:"Variable",name:{kind:"Name",value:"entity"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"entityOptions"},value:{kind:"Variable",name:{kind:"Name",value:"entityOptions"}}},{kind:"Argument",name:{kind:"Name",value:"removeBlock"},value:{kind:"Variable",name:{kind:"Name",value:"removeBlock"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class yC{constructor(e,t,n,i,a){this.commandHandler=e,this.client=t,this.windowId=n,this.scenarioFactory=i,this.onDestroy=new gC.xQ,this.logger=a.newLogger("ExtensionCommandingService")}destroy(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{this.onDestroy.next(),this.reset()}catch(e){this.logger.warn(`Unable to destroy, error ocurred in persisting delete of extension entity. e.name: ${e.name}, e.message: ${e.message}`)}}))}executeCommand(e,t){const n=(null==t?void 0:t.entityCommand)||{stateTransition:c.su.none,visibilityState:c.fe.show,correlation:{source:Ot.D.ExtensionCommanding}};n.stateTransition=c.su.extend;const i={entity:e,command:n,entityOptions:null==t?void 0:t.entityOptions};return this.processRequest(i)}addBlockingExtension(e,t,n=!1){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!n&&(yield this.isWindowBlocked()))return void this.logger.log("Window is currently blocked, addBlockingExtension no-op");this.logger.log(`addBlockingExtension, requesting an extension of type ${e.type} to block the window`);const i={entity:e,entityOptions:JSON.stringify(t),windowId:this.windowId,removeBlock:n};yield this.client.mutate({mutation:fC,variables:i})}))}isWindowBlocked(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{data:e}=yield this.client.query({query:hC,variables:{windowId:this.windowId}});return!!e.activeWindow.blockingEntityExtension}))}pipeWhileStateIsValid(e){return e.pipe((0,cC.R)(this.onDestroy),(0,uC.o)((e=>e.hasEntityExtension),!0),(0,mC.G)(),(0,uC.o)((([e,t])=>{const n=t.containerState,i=t.hasEntityExtension,a=e.containerState,o=n===c.oq.Confirmed,r=n===c.oq.Cancelled,s=n===c.oq.Error,l=n===c.oq.Closed,d=a===c.oq.Open;return i&&!o&&!r&&!s&&!(d&&l)}),!0),(0,aS.U)((([,e])=>({containerState:e.containerState}))))}processRequest(e){this.scenarioFactory.newScenario(ft.RG.ExtensionOpen);const t=this.observeContainerState(this.client,this.windowId),n=this.pipeWhileStateIsValid(t);this.commandHandler(e).then((()=>{n.subscribe({next:e=>{this.stopActiveScenario(e.containerState),this.nextSubscriber(e),e.containerState===c.oq.Error&&this.resetSubscriber((0,Mn.Tr)("ExtensionCommanding",De.jK.Unknown,`ExtendedContainerState ${e.containerState}`,void 0,"Error processing entity extension"))},complete:()=>{this.resetSubscriber()},error:e=>{this.resetSubscriber(e)}})})).catch((e=>{this.resetSubscriber(e)}));return new pC.y((e=>{this.subscriber=e}))}nextSubscriber(e){this.subscriber&&this.subscriber.next(e)}resetSubscriber(e){const t=this.subscriber;this.reset(),e?(this.failActiveScenarios(),t&&t.error(e)):(this.stopActiveScenarios(),t&&t.complete())}reset(){this.subscriber=void 0}stopActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(ft.RG.ExtensionClose))||void 0===e||e.stop(),null===(t=this.scenarioFactory.findScenario(ft.RG.ExtensionOpen))||void 0===t||t.stop()}failActiveScenarios(){var e,t;null===(e=this.scenarioFactory.findScenario(ft.RG.ExtensionClose))||void 0===e||e.fail(),null===(t=this.scenarioFactory.findScenario(ft.RG.ExtensionOpen))||void 0===t||t.fail()}stopActiveScenario(e){switch(e){case c.oq.Error:this.failActiveScenarios();break;case c.oq.Open:case c.oq.Closed:case c.oq.Cancelled:case c.oq.Confirmed:this.stopActiveScenarios();break;default:this.logger.errorToTelemetry&&this.logger.errorToTelemetry(`Unable to stop active scenario, no case mapped to container state provided: ${e}`,"webclient_framework_foundation_core_services_extension_commanding",void 0,!0)}}observeContainerState(e,t){return(0,NS.G)(this.watchActiveWindow(e,t)).pipe((0,aS.U)((({data:e})=>{var t;return{containerState:e.activeWindow.extendedEntityContainerState.containerState,hasEntityExtension:!!(null===(t=e.activeWindow.activeEntities.entityExtension)||void 0===t?void 0:t.type)}})))}watchActiveWindow(e,t){return e.watchQuery({query:vC,variables:{windowId:t}})}}const kC=({appsRegistryService:e,client:t,commandChangeReportingService:n,coreSettings:a,entityCommandInput:o,executionContext:r,loggerFactory:s,platformService:l,scenarioFactory:d,windowId:m,clientLaunchId:g,windowProvider:p,userBiService:v})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var h,f;const y=s.newLogger("internalCommandHandler"),k=null!==(f=null===(h=o.command)||void 0===h?void 0:h.__UNSAFE_windowId)&&void 0!==f?f:m;k!==m&&y.log(`window id overridden to ${k}`);let S=ZS(function(e){const t=e.command||XS({stateTransition:c.su.none,visibilityState:c.fe.show,correlation:{source:Ot.D.Unknown}});return Object.assign(Object.assign({},e),{command:t})}(o));const b=function(e,t){var n;return t&&e.getApp({entityType:null===(n=t.viewEntity)||void 0===n?void 0:n.type})}(e,r),C=function(e,t){return e.getApp({entityType:t.entity.type})}(e,S);!function({commandChangeReportingService:e,entityCommand:t,logger:n,sourceApp:i,renderingApp:a,coreSettings:o}){t.entity.type===u.p.default&&(t.command.correlation.scenarioName=ft.RG.DefaultCommand),i&&KS({appName:i.manifest.name,commandChangeReportingService:e,entityCommand:t,getCommandScenarioName:i.getCommandScenarioNameFromSource,logger:n,coreSettings:o}),a&&KS({appName:a.manifest.name,commandChangeReportingService:e,entityCommand:t,getCommandScenarioName:a.getCommandScenarioName,logger:n,coreSettings:o})}({commandChangeReportingService:n,entityCommand:S,renderingApp:C,sourceApp:b,logger:y,coreSettings:a});const w=S.command.correlation.id;if(function({commandChangeReportingService:e,entityCommand:t,executionContextEntity:n}){const i=t.command.correlation.id;e.report({type:GS.B.CommandStart,correlationId:i,context:{target:"internal-command-handler",entityCommand:t,executionContextEntity:n}})}({commandChangeReportingService:n,entityCommand:S,executionContextEntity:null==r?void 0:r.viewEntity}),C){const e=function(e,t,n,i,a,o){return{client:e,coreSettings:t,loggerFactory:n,platformService:i,scenarioFactory:a,userBiService:o}}(t,a,s,l,d,v),o=p||void 0;S=yield function({app:e,commandChangeReportingService:t,entityCommand:n,hookRequestContext:a,logger:o,windowProvider:r}){var s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i=n;if(e.onBeforeCommandHandled){const l=n.command.correlation,d=l.id,c="internal-command-handler-execute-before-command-handled-hook";t.report({type:GS.B.ApplicationHookReceivedCommand,context:{target:c},correlationId:d});try{const t={entityCommand:n,requestContext:a,windowProvider:r||void 0};i=yield e.onBeforeCommandHandled(t)}catch(n){const i=`Command 'onBeforeCommandHandled' rejected. An attempt to handle the command was made by app:${e.manifest.name}, but failed. Error: ${(0,ta.A)((0,Mn.VK)(n))}`;return null===(s=o.errorToTelemetry)||void 0===s||s.call(o,i,"webclient_framework_foundation_core_services_internal_command_handler",void 0,!0),t.report({type:GS.B.Failure,context:{errorInfo:qS.y.OnBeforeCommandHandledRejected,errorMessage:i,target:c},correlationId:d}),Promise.reject(n)}void 0!==i&&(t.report({type:GS.B.ApplicationHookContinuedCommand,context:{target:c},correlationId:d}),i.command.correlation=l,t.report({type:GS.B.CommandStart,correlationId:d,context:{target:c,entityCommand:i}}))}return Promise.resolve(i)}))}({app:C,commandChangeReportingService:n,entityCommand:S,hookRequestContext:e,logger:y,windowProvider:o})}return S?function({entityCommand:e,mutateContext:{client:t,executionContext:n,windowId:i,clientLaunchId:a}}){return t.mutate({mutation:QS,variables:Object.assign(Object.assign({},e),{entityOptions:JSON.stringify(e.entityOptions),executionContext:n,windowId:i,clientLaunchId:a}),fetchPolicy:"no-cache"}).then((e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.executeEntityCommand)||void 0===n?void 0:n.id}))}({entityCommand:S,mutateContext:{client:t,executionContext:r,windowId:k,clientLaunchId:g}}):(n.report({type:GS.B.CommandHandledPriorToResolution,context:{target:"internal-command-handler"},correlationId:w}),Promise.resolve(void 0))}));var SC=n(141330);class bC{constructor(e){this.commandHandler=e}trigger(e){return this.commandHandler({entity:wC(e.entity),command:EC(e.command)})}}const CC=e=>{switch(e){case SC.uk.view:return u.u.view;case SC.uk.list:return u.u.list;case SC.uk.default:return u.u.default;default:throw(0,Mn.Tr)(De.w5.Commanding,De.jK.NotImplemented,"Nova",void 0,`Mapping for Nova action type ${e} not implemented in Teams!`)}},wC=e=>{switch(e.type){case SC.py.identity:return NC(e);case SC.py.teams_chat:return{type:u.p.chats,id:e.entityId,action:CC(e.action)};case SC.py.teams_channel:return{type:u.p.channels,id:e.entityId,action:CC(e.action)};case SC.py.office_home:return{type:u.p.communitiesonboarding,id:e.entityId,action:CC(e.action)};case SC.py.office_people:return{type:u.p.homepage,id:e.entityId,action:CC(e.action)};case SC.py.teams_activity:return{type:u.p.activity,id:e.entityId,action:CC(e.action)};case SC.py.teams_calendar:return{type:u.p.calendar,id:e.entityId,action:CC(e.action)};case SC.py.teams_meet:return{type:u.p.meet,id:e.entityId,action:CC(e.action)};case SC.py.m365_app:return{type:u.p.extensions,id:e.entityId,action:CC(e.action)};case SC.py.teams_calling:return{type:u.p.callsmain,id:e.entityId,action:u.u.view};default:throw(0,Mn.Tr)(De.w5.Commanding,De.jK.NotImplemented,"Nova",void 0,`Mapping for Nova entity type ${e.type} not implemented in Teams!`)}},NC=e=>{switch(e.action){case SC.uk.signout:return{type:u.p.signoutdialog,id:e.entityId,action:u.u.view};case SC.uk.updateProfilePicture:return{type:u.p.updatemsaprofileavatardialog,id:e.entityId,action:u.u.view};case SC.uk.updateDisplayName:return{type:u.p.updatemsaprofilenamedialog,id:e.entityId,action:u.u.view};default:throw(0,Mn.Tr)(De.w5.Commanding,De.jK.NotImplemented,"Nova",void 0,`Mapping for Nova identity entity with action type ${e.action} not implemented in Teams!`)}},TC=e=>{switch(e){case SC.fe.hide:return c.fe.hide;case SC.fe.show:return c.fe.show;case SC.fe.toggle:return c.fe.toggle}},IC=e=>{switch(e){case SC.su.extend:return c.su.extend;case SC.su.flush:return c.su.flush;case SC.su.forceFlush:return c.su.forceFlush;case SC.su.new:return c.su.new;case SC.su.none:return c.su.none}},EC=e=>({visibilityState:TC(e.visibilityState),stateTransition:IC(e.stateTransition),correlation:{source:Ot.D.Nova}});var AC=n(987896),_C=n(791273),DC=n(928908);class FC{constructor(e,t,n,i,a,o,r){this.commandHandler=e,this.extensionCommanding=t,this.hostCommunicationService=n,this.windowId=i,this.host=a,this.coreSettings=o,this._logger=r.newLogger("ShellCommandingService")}activeCallDialog(e){return this.extensionCommanding.executeCommand({type:u.p.activecalldialog,action:u.u.view},{entityCommand:e})}bringWindowToFront(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("osutils");return this._logger.log(`Performing action: bringWindowToFront on ${e}`),(null===(t=null==n?void 0:n.bringWindowToFront)||void 0===t?void 0:t.call(n,e))||Promise.resolve(!1)}))}desktopNotice(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("osutils");return this._logger.log("Performing action: desktopNotice"),null===(e=null==t?void 0:t.openThirdPartyNotice)||void 0===e?void 0:e.call(t)}))}dismissBanner(e,t=Ot.D.Unknown){return this.dismissNotification(e,u.p.bannerNotification,t)}dismissToast(e,t=Ot.D.Unknown){return this.dismissNotification(e,u.p.inAppToast,t)}executeNotificationAction(e,t,n,i,a){var o,r;let s;try{s=JSON.parse(i)}catch(e){return null===(r=(o=this._logger).errorNoPii)||void 0===r||r.call(o,`Notification command can't be parsed: ${i}`),Promise.resolve()}return a?this.dismissNotification(e,t,n):t===u.p.bannerNotification&&(s.entityOptions=Object.assign(Object.assign({},s.entityOptions),{bannerId:e})),this.commandHandler(s)}installAndLaunchT1(){var e,t,n,a,o,r,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("appswitcher"),l=yield null===(e=null==i?void 0:i.downloadAndInstallPearApp)||void 0===e?void 0:e.call(i,AC.OP.Teams1);switch(null==l?void 0:l.status){case AC.cw.DownloadedAndInstalled:yield this.launchT1AndQuitT2(!0),this._logger.log("T1 is downloaded and installed");break;case AC.cw.FailedToDownload:null===(n=(t=this._logger).errorNoPii)||void 0===n||n.call(t,`T1 failed to download: ${null==l?void 0:l.errorMessage}`);break;case AC.cw.FailedToInstall:null===(o=(a=this._logger).errorNoPii)||void 0===o||o.call(a,`T1 failed to install: ${null==l?void 0:l.errorMessage}`);break;default:null===(s=(r=this._logger).errorNoPii)||void 0===s||s.call(r,`T1 download and install failed: ${null==l?void 0:l.errorMessage}`)}}))}joinLinkDialog(e){return this.extensionCommanding.executeCommand({type:u.p.joinlinkdialog,action:u.u.view},{entityCommand:e})}launchT1AndQuitT2(e,t){var n,a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("appswitcher");e&&(this._logger.log("launchT1AndQuitT2, Switcher default app to T1"),yield null===(n=null==i?void 0:i.switchDefaultAppTo)||void 0===n?void 0:n.call(i,AC.OP.Teams1)),this._logger.log("launchT1AndQuitT2, launch T1"),yield null===(a=null==i?void 0:i.launchPearApp)||void 0===a?void 0:a.call(i,AC.OP.Teams1,t),this._logger.log("Flushing T2 telemetry events"),yield(0,DC.G)().flush(),this._logger.log("launchT1AndQuitT2, quit T2"),yield null===(o=null==i?void 0:i.quitApp)||void 0===o?void 0:o.call(i)}))}maximizeWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(K.J.Core).routeWindowActionsThroughHostComms)return this.host.maximize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: maximizeWindow on ${this.windowId}`),null===(e=null==t?void 0:t.maximize)||void 0===e?void 0:e.call(t,this.windowId)}))}minimizeWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(K.J.Core).routeWindowActionsThroughHostComms)return this.host.minimize();const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: maximizeWindow on ${this.windowId}`),null===(e=null==t?void 0:t.minimize)||void 0===e?void 0:e.call(t,this.windowId)}))}msaProfileAvatarUpdateDialog(e){return this.extensionCommanding.executeCommand({type:u.p.updatemsaprofileavatardialog,action:u.u.view},{entityCommand:e})}msaProfileNameUpdateDialog(e){return this.extensionCommanding.executeCommand({type:u.p.updatemsaprofilenamedialog,action:u.u.view},{entityCommand:e})}noticeDialog(e){return this.extensionCommanding.executeCommand({type:u.p.tpndialog,action:u.u.view},{entityCommand:e})}openFreDialog(e){return this.extensionCommanding.executeCommand({type:u.p.officeintegrationfredialog,action:u.u.info},{entityCommand:e})}removeTitleBarOverlay(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: setCustomFrameOptions on ${this.windowId}`),null===(e=null==t?void 0:t.setCustomFrameOptions)||void 0===e?void 0:e.call(t,this.windowId,{titleBarMode:_C.i$.ButtonsOnly})}))}restoreWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: restoreWindow on ${this.windowId}`),null===(e=null==t?void 0:t.restore)||void 0===e?void 0:e.call(t,this.windowId)}))}setMinimumWindowSize(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(n=null==i?void 0:i.setMinimumWindowSize)||void 0===n?void 0:n.call(i,this.windowId,e,t)}))}setWindowBounds(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return null===(o=null==i?void 0:i.setWindowBounds)||void 0===o?void 0:o.call(i,this.windowId,e,t,n,a)}))}showContextMenu(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: showContextMenu on ${this.windowId} and position ${e}`),null===(t=null==n?void 0:n.showTitleBarContextMenu)||void 0===t?void 0:t.call(n,this.windowId,e)}))}showBanner(e){var{id:t,dismissable:n=!0,duration:a=4,source:o=Ot.D.Unknown}=e,r=(0,i.__rest)(e,["id","dismissable","duration","source"]);return this.commandHandler({command:{correlation:{source:o},stateTransition:c.su.none,visibilityState:c.fe.show},entity:{type:u.p.bannerNotification,action:u.u.create,id:t},entityOptions:Object.assign(Object.assign({},r),{dismissable:n,duration:a})})}showToast(e){var{id:t,duration:n=7e3,source:a=Ot.D.Unknown}=e,o=(0,i.__rest)(e,["id","duration","source"]);return this.commandHandler({command:{correlation:{source:a},stateTransition:c.su.none,visibilityState:c.fe.show},entity:{type:u.p.inAppToast,action:u.u.create,id:t},entityOptions:Object.assign(Object.assign({},o),{duration:n})})}signOutDialog(e){return this.extensionCommanding.executeCommand({type:u.p.signoutdialog,action:u.u.view},{entityCommand:e})}startWindowDragListener(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: startWindowDragListener on ${this.windowId}`),null===(e=null==t?void 0:t.startWindowDragListener)||void 0===e?void 0:e.call(t,this.windowId)}))}swapMeetingRoomFrontOfRoomWindows(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log("Performing action: swapMeetingRoomFrontOfRoomWindows"),null===(e=null==t?void 0:t.swapMeetingRoomFrontOfRoomWindows)||void 0===e?void 0:e.call(t)}))}switchDefaultAppTo(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("appswitcher");this._logger.log(`switchDefaultAppTo ${e}`),yield null===(t=null==n?void 0:n.switchDefaultAppTo)||void 0===t?void 0:t.call(n,e)}))}zoomInWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomInWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomIn)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomOutWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomOutWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomOut)||void 0===e?void 0:e.call(t,this.windowId)}))}zoomResetWindow(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: zoomResetWindow on ${this.windowId}`),null===(e=null==t?void 0:t.zoomReset)||void 0===e?void 0:e.call(t,this.windowId)}))}getScreenshots(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("windowcontrols");return this._logger.log(`Performing action: getScreenshots on ${this.windowId}`),null===(n=null==i?void 0:i.getScreenshots)||void 0===n?void 0:n.call(i,e,t)}))}dismissNotification(e,t,n=Ot.D.Unknown){return this.commandHandler({command:{correlation:{source:n},stateTransition:c.su.none,visibilityState:c.fe.hide},entity:{type:t,action:u.u.delete,id:e}})}}class MC{constructor(e,t){this.commandHandler=e,this.userContextId=t}showMessage(e,{collectionId:t,conversationId:n,mainImage:i,discardDuringMeetingsAndCalls:a,messageId:o,quickReply:r,quickReplyButton:s,quickReplyPlaceholder:l,text:d,time:m,title:g,isUrgent:p}){const v={collectionId:t,isUrgent:p,mainImage:i,discardDuringMeetingsAndCalls:a,targetEntity:{action:Hn.view,dataOptions:{actionType:bo.view,messageId:o,userContextId:this.userContextId},id:n,type:Wn.chats},textInput:r?RC(n,s,l,this.userContextId):void 0,text:d,time:m,title:g},h={command:{correlation:{id:e,source:Ot.D.Notifications,startTimestamp:m.valueOf()},stateTransition:c.su.new,visibilityState:c.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:v};return this.commandHandler(h)}showReminder(e,{collectionId:t,conversationId:n,mainImage:i,messageId:a,text:o,time:r,title:s,buttonText:l}){const d={collectionId:t,mainImage:i,targetEntity:{action:Hn.view,dataOptions:{actionType:bo.view,messageId:a,userContextId:this.userContextId},id:n,type:Wn.reminders},textInput:void 0,text:o,time:r,title:s,buttons:[{targetEntity:{action:Hn.view,dataOptions:{actionType:bo.view,messageId:a,userContextId:this.userContextId},id:n,type:Wn.reminders},text:l}]},m={command:{correlation:{id:e,source:Ot.D.Notifications,startTimestamp:r.valueOf()},stateTransition:c.su.new,visibilityState:c.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:d};return this.commandHandler(m)}showChatTabEntityNotification(e,{collectionId:t,conversationId:n,mainImage:i,tabId:a,text:o,time:r,title:s}){const l={collectionId:t,mainImage:i,targetEntity:{id:a,type:Wn.extensions,action:Hn.view,dataOptions:{actionType:bo.unknown,userContextId:this.userContextId},linkedEntity:{id:n,action:Hn.view,type:Wn.chats}},text:o,time:r,title:s},d={command:{correlation:{id:e,source:Ot.D.Notifications,startTimestamp:r.valueOf()},stateTransition:c.su.flush,visibilityState:c.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:l};return this.commandHandler(d)}showChannelsNotification(e,{collectionId:t,conversationId:n,mainImage:i,discardDuringMeetingsAndCalls:a,messageId:o,text:r,time:s,title:l,replyChainId:d}){const m={collectionId:t,mainImage:i,discardDuringMeetingsAndCalls:a,targetEntity:{action:Hn.view,dataOptions:{actionType:bo.view,messageId:o,userContextId:this.userContextId,focusOnLoad:xr.t.DoNotMove},id:JSON.stringify({channelId:n,replyChainId:d,deepLinkId:d}),type:Wn.channels},text:r,time:s,title:l},g={command:{correlation:{id:e,source:Ot.D.Notifications,startTimestamp:s.valueOf()},stateTransition:c.su.new,visibilityState:c.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:m};return this.commandHandler(g)}showCommunitiesNotifications(e,{collectionId:t,conversationId:n,mainImage:i,messageId:a,text:o,time:r,title:s,replyChainId:l,type:d}){const m={collectionId:t,mainImage:i,targetEntity:{action:Hn.view,dataOptions:{actionType:bo.view,messageId:a,userContextId:this.userContextId,toastType:d,teamId:n,deepLinkId:a},id:JSON.stringify({channelId:n,replyChainId:l}),type:Wn.communities},text:o,time:r,title:s},g={command:{correlation:{id:e,source:Ot.D.Notifications,startTimestamp:r.valueOf()},stateTransition:c.su.new,visibilityState:c.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:m};return this.commandHandler(g)}showEspSyntheticNotification(e,{collectionId:t,mainImage:n,text:i,time:a,title:o,campaignType:r}){const s={collectionId:t,mainImage:n,targetEntity:{type:Wn.campaignnotifications,action:Hn.view,id:r,dataOptions:{actionType:"Unknown",userContextId:this.userContextId}},text:i,time:a,title:o},l={command:{correlation:{id:e,source:Ot.D.Notifications,startTimestamp:a.valueOf()},stateTransition:c.su.flush,visibilityState:c.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:s};return this.commandHandler(l)}showReEngageNudge(e,{conversationId:t,text:n,time:i,title:a,type:o}){const r={targetEntity:{action:Hn.view,dataOptions:{actionType:bo.view,userContextId:this.userContextId,toastType:o},id:t,type:Wn.reminders},textInput:void 0,text:n,time:i,title:a},s={command:{correlation:{id:e,source:Ot.D.Notifications,startTimestamp:i.valueOf()},stateTransition:c.su.new,visibilityState:c.fe.show},entity:{action:u.u.view,type:u.p.toasts},entityOptions:r};return this.commandHandler(s)}}const RC=(e,t,n,i)=>({placeholderText:n||"Send a quick reply",sendButton:{text:t||"Send",targetEntity:{action:Hn.mutate,type:Wn.chats,dataOptions:{actionType:bo.quickReply,convId:e,userContextId:i}}}});class PC{constructor(e){this.commandHandler=e}showAccounts(){return this.commandHandler({entity:{type:u.p.accounts,action:u.u.list}})}}class OC{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}default(e){return this.commandHandler({entity:{type:u.p.activity,action:u.u.default},command:e})}empty(e){return this.commandHandler({entity:{type:u.p.activity,action:u.u.empty},command:e})}launchDeleteActivityFeedItemDialog(e){return this.extensionCommanding.executeCommand({type:u.p.activity,action:u.u.delete},{entityCommand:e})}launchActivityErrorDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.activity,action:u.u.error},{entityCommand:t})}}var xC=n(468043);class LC{constructor(e){this.commandHandler=e}openAIInsightsTab({entityCommand:e,messageId:t,threadId:n,transcriptId:i,meetingTitle:a,meetingTenantId:o,meetingOrganizerId:r},s){return this.commandHandler({entity:{type:u.p.aiinsightscontent,action:u.u.view},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,eventId:(0,xC.cW)(s),meetingTitle:a,meetingTenantId:o,meetingOrganizerId:r}})}openAIInsightsTabInSchedulingForm({entityCommand:e,messageId:t,threadId:n,transcriptId:i,meetingTenantId:a,meetingOrganizerId:o},r,s){const l=(0,xC.cW)(r);return this.commandHandler({entity:{type:u.p.aiinsightscontent,action:u.u.view,linkedEntity:{type:u.p.schedulingform,action:u.u.view,id:JSON.stringify({eventId:l,providerType:s})}},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,providerType:s,eventId:l,meetingTenantId:a,meetingOrganizerId:o}})}}var UC=n(648062);const BC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataAuthUserAuthStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userAuthState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"reason"}},{kind:"Field",name:{kind:"Name",value:"customError"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorCode"}},{kind:"Field",name:{kind:"Name",value:"isExpected"}},{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}}]}}]}}]};class jC{constructor(e,t,n,i){this.commandHandler=e,this.extensionCommanding=t,this.deeplinkCommandingService=n,this.client=i}signinPage(e){return this.commandHandler({entity:{type:u.p.identity,action:u.u.default},command:e})}accountList(e){return this.commandHandler({entity:{type:u.p.identity,action:u.u.list},command:e})}switchAccount({correlation:e,userContextId:t,targetEntity:n}){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.client)throw new Error("client missing in switch account commanding");const{data:i}=(yield this.client.query({query:BC,variables:{userContextId:t},context:{correlation:e}}))||{},o=null==i?void 0:i.userAuthState;if(o&&o.state!==L.JEq.Up){let n;if(o.state===L.JEq.UnRedeemed&&(n=u.u.tenantRedemption),o.state===L.JEq.LoginError)switch(null===(a=o.customError)||void 0===a?void 0:a.errorCode){case UC.SM.TenantUnredeemed:n=u.u.tenantRedemption;break;case UC.SM.InteractionRequired:n=u.u.tenantLogin;break;default:n=u.u.error}if(n)return this.commandHandler({entity:{type:u.p.identitydialog,action:n},command:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:e},entityOptions:{correlation:e,userContextId:t,userAuthState:null==i?void 0:i.userAuthState}})}return this.deeplinkCommandingService.switchAccount(e,t,n)}))}signOutDialog(e){return this.extensionCommanding.executeCommand({type:u.p.signoutdialog,action:u.u.view},{entityCommand:e})}smartDeviceSignOutDialog(e){return this.extensionCommanding.executeCommand({type:u.p.smartdevicelogoutdialog,action:u.u.view},{entityCommand:e})}addAccountDialog(e){return this.commandHandler({entity:{type:u.p.identitydialog,action:u.u.create},command:{visibilityState:c.fe.show,stateTransition:c.su.extend,layoutMode:c.lO.focus,correlation:e},entityOptions:{correlation:e}})}addAccount(e){return this.commandHandler({entity:{type:u.p.identity,action:u.u.create},command:{visibilityState:c.fe.show,stateTransition:c.su.new,layoutMode:c.lO.focus,correlation:e},entityOptions:{correlation:e}})}closeAccountListDialog(e){return this.commandHandler({entity:{type:u.p.identitydialog,action:u.u.create},command:{visibilityState:c.fe.hide,stateTransition:c.su.flush,layoutMode:c.lO.focus,correlation:{source:e}}})}closeAccountLoginDialog(e){return this.commandHandler({entity:{type:u.p.identitydialog,action:u.u.tenantLogin},command:{visibilityState:c.fe.hide,stateTransition:c.su.flush,layoutMode:c.lO.focus,correlation:{source:e}}})}closeAddAccountListWindow(e){return this.commandHandler({entity:{type:u.p.identity,action:u.u.create},command:{visibilityState:c.fe.hide,stateTransition:c.su.flush,layoutMode:c.lO.focus,correlation:{source:e}}})}closeAccountListWindow(e){return this.commandHandler({entity:{id:c.lO.focus,type:u.p.identity,action:u.u.list},command:{visibilityState:c.fe.hide,stateTransition:c.su.flush,layoutMode:c.lO.focus,correlation:{source:e}}})}showAuthEndPage(e,t,n){return this.commandHandler({entity:{type:n?u.p.identitydialog:u.p.identity,action:u.u.error},command:{visibilityState:c.fe.show,stateTransition:n?c.su.extend:c.su.flush,layoutMode:c.lO.focus,correlation:{source:e}},entityOptions:{error:t.error}})}}class WC{constructor(e){this.commandHandler=e}viewAutoInstallNotification(e,t){return this.commandHandler({entity:{type:u.p.autoinstallnotification,action:u.u.view},command:t,entityOptions:e})}}class VC{constructor(e){this.commandHandler=e}navigateToFaceEnrollment(){return this.commandHandler({entity:{type:u.p.faceenrollment,action:u.u.view},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{startTimestamp:Date.now(),source:Ot.D.FaceEnrollmentGetStartedButton}}})}}class HC{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}brbFeedbackDialogInMainWindow(e,t){return this.commandHandler({entity:{type:u.p.brbfeedbackdialog,action:u.u.view},command:e,entityOptions:t})}brbFeedbackDialog(e){return this.extensionCommanding.executeCommand({type:u.p.brbfeedbackdialog,action:u.u.view},{entityCommand:e})}autoBrbConfirmationDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.autobrbconfirmationdialog,action:u.u.view},{entityCommand:e,entityOptions:t})}}class $C{constructor(e){this.commandHandler=e}openBreakoutRooms(e,t){return this.commandHandler({entity:{type:u.p.breakoutrooms,action:u.u.view},entityOptions:t,command:e})}showAssignmentDialog(e){return this.showDialog(u.p.breakoutroomsassignment,e)}showAssignmentTypeDialog(e){return this.showDialog(u.p.breakoutroomsassignmenttype,e)}showCreateRoomsDialog(e){return this.showDialog(u.p.breakoutroomscreaterooms,e)}showDeleteRoomDialog(e){return this.showDialog(u.p.breakoutroomsdeleteroom,e)}showDeleteRoomsDialog(e){return this.showDialog(u.p.breakoutroomsdeleterooms,e)}showEditRoomDialog(e){return this.showDialog(u.p.breakoutroomseditroom,e)}showSettingsDialog(e){return this.showDialog(u.p.breakoutroomssettings,e)}showDialog(e,t){return this.commandHandler({entity:{type:e,action:u.u.view},command:{stateTransition:c.su.extend,correlation:{source:Ot.D.ExtensionCommanding},visibilityState:t}})}}class zC{constructor(e){this.commandHandler=e}qnaPanelById(e,t){return this.commandHandler({entity:{type:u.p.broadcastqna,action:u.u.view,id:e,linkedEntity:{type:u.p.calls,id:e}},command:t})}infoPanelById(e,t){return this.commandHandler({entity:{type:u.p.broadcasts,action:u.u.info,id:e,linkedEntity:{type:u.p.calls,id:e}},command:t})}broadcastById(e,t,n){return this.commandHandler({entity:{type:u.p.broadcasts,action:u.u.view,id:e},command:t,entityOptions:n})}broadcastFeedbackById(e,t,n){return this.commandHandler({entity:{type:u.p.broadcastfeedback,action:u.u.view,id:e},command:t,entityOptions:n})}broadcastLeave(e,t,n){return this.commandHandler({entity:{type:u.p.broadcasts,action:u.u.leave,id:e},command:t,entityOptions:n})}}class GC{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}meetingDetails(e,t,n){return this.commandHandler({entity:{type:u.p.schedulingform,action:u.u.view,id:e},command:t,entityOptions:n})}openCalendarSurface(e,t,n,i){return this.commandHandler({entity:{type:u.p.calendar,action:u.u.view,id:e,linkedEntity:i},command:t,entityOptions:n})}openCalendarAgendaView(e,t,n){return this.commandHandler({entity:{type:u.p.calendar,action:u.u.list,linkedEntity:n},command:e,entityOptions:t})}openChannelCalendarSurface(e,t,n,i){const a={entity:{action:u.u.view,id:e,linkedEntity:i,type:u.p.channelcalendar},command:t,entityOptions:n};return this.commandHandler(a)}openSchedulingFormInMainWindow(e,t,n){return this.commandHandler({entity:{type:u.p.schedulingform,action:u.u.create,id:e},command:t,entityOptions:n})}openBroadcast(e,t,n,i){const a={type:u.p.broadcastliveevent,id:e,action:t};return this.extensionCommanding.executeCommand(a,{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.none,correlation:{source:n}},entityOptions:i})}closeSchedulingForm(e,t,n){return this.commandHandler({entity:e,command:t,entityOptions:n})}showCalendarErrorModal(e){return this.extensionCommanding.executeCommand({type:u.p.calendar,action:u.u.error},{entityCommand:{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:Ot.D.CalendarEventAction}},entityOptions:e})}addBlockingConfirmationDialog(e,t){return this.extensionCommanding.addBlockingExtension({type:u.p.calendar,action:u.u.confirm},e,t)}showConfirmationDialog(e){return this.extensionCommanding.executeCommand({type:u.p.calendar,action:u.u.confirm},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:Ot.D.CalendarEventAction}},entityOptions:e})}showShareDialog(e){return this.extensionCommanding.executeCommand({type:u.p.calendar,action:u.u.share},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:Ot.D.CalendarEventAction}},entityOptions:e})}showEmbedDialog(e){return this.extensionCommanding.executeCommand({type:u.p.calendar,action:u.u.info},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:Ot.D.CalendarEventAction}},entityOptions:e})}openConnectedCalendarDialog(e){return this.extensionCommanding.executeCommand({type:u.p.connectedcalendardialog,action:u.u.view},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:Ot.D.CalendarSettings}},entityOptions:e})}}class qC{constructor(e,t,n){this.commandHandler=e,this.extensionCommanding=t,this.userContextId=n}call(e,t){return this.commandHandler({entity:{type:u.p.calls,action:u.u.list,id:e},command:t})}callDebug(e){return this.commandHandler({entity:{type:u.p.calls,action:u.u.info},command:e})}dialPad(e){return this.commandHandler({entity:{type:u.p.calls,action:u.u.join},command:e})}callById(e,t,n,i,a){let o;return n&&(o={type:u.p.chats,id:n}),a&&(o={type:u.p.callingdeeplink,id:a}),this.commandHandler({entity:{type:i||u.p.calls,action:u.u.view,id:e,linkedEntity:o},command:t})}callStageContentById(e,t){return this.commandHandler({entity:{type:u.p.stagecontent,action:u.u.view},entityOptions:t,command:e})}callList(e){return this.commandHandler({entity:{type:u.p.calls,action:u.u.list},command:e})}deviceSettingsById(e,t,n={useCall:!0}){return this.commandHandler({entity:{type:u.p.devicesettings,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},entityOptions:n,command:t})}callNotification(e,t,n,i){var a;const o=e.entityOptions;return o.targetEntity.dataOptions.userContextId=this.userContextId,null===(a=o.buttons)||void 0===a||a.forEach((e=>{e.targetEntity.dataOptions.userContextId=this.userContextId})),i===L.KRy.Hide?this.commandHandler({entity:{id:t,action:u.u.view,type:u.p.toasts},command:{correlation:{id:n,source:Ot.D.Calling},stateTransition:c.su.new,visibilityState:c.fe.hide},entityOptions:o}):this.commandHandler({entity:{action:u.u.view,type:u.p.toasts,id:t},command:e.command,entityOptions:o})}cameraEffectsSettingsById(e,t){return this.commandHandler({entity:{type:u.p.cameraeffects,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},entityOptions:{commandSource:null==t?void 0:t.correlation.source},command:t})}customVideoBackgroundSettingsById(e,t){return this.commandHandler({entity:{type:u.p.videobackgrounds,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callRosterById(e,t){return this.commandHandler({entity:{type:u.p.roster,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callDetailsById(e,t,n){return this.commandHandler({entity:{type:u.p.meetingdetails,action:u.u.view,linkedEntity:{type:u.p.calls,id:e},id:e},entityOptions:{didMeetingNotesAutoOpen:n},command:t})}callInfoById(e,t){return this.commandHandler({entity:{type:u.p.calls,action:u.u.info,linkedEntity:{type:u.p.calls,id:e}},command:t})}callNotesById(e,t){return this.commandHandler({entity:{type:u.p.notes,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}transcriptPanelById(e,t){return this.commandHandler({entity:{type:u.p.transcript,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callHealthPanelById(e,t){return this.commandHandler({entity:{type:u.p.calls,action:u.u.health,linkedEntity:{type:u.p.calls,id:e}},command:t})}mediaStreamsPanelById(e,t){return this.commandHandler({entity:{type:u.p.mediastreams,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callBreakoutRoomById(e,t){return this.commandHandler({entity:{type:u.p.breakoutroomspanel,action:u.u.view,linkedEntity:{type:u.p.calls,id:e},id:e},command:t})}createById(e,t,n,i){return this.commandHandler({entity:{id:e,type:t,action:u.u.create},command:n,windowOptions:i})}callMonitorById(e,t,n){return this.commandHandler({entity:{type:u.p.callsmonitor,action:u.u.view},entityOptions:e&&{callingIntentId:e},command:t,windowOptions:n})}callShareMeetingInviteDialogById(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:t,entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:n}}})}callsKeypad(e,t){return this.commandHandler({entity:{type:u.p.callskeypad,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callMeetingOptionsById(e,t){return this.commandHandler({entity:{type:u.p.meetings,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}callsTransfer(e,t){return this.commandHandler({entity:{type:u.p.callstransfer,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}contentCameraSetupDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.contentcamerasetup,action:u.u.create},{entityOptions:t,entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.none,correlation:{source:n}}})}startMeetingStream(e,t){return this.extensionCommanding.executeCommand({type:u.p.meetingstream,action:u.u.create},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.none,correlation:{source:e}},entityOptions:t})}stagingRoomStartMeetingConfirmationDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.stagingroomstartmeetingconfirmationdialog,action:u.u.create},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:t}},entityOptions:n})}openDialog(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:n,entityCommand:t})}callableChannelById(e,t,n){return this.commandHandler({entity:{id:t,type:u.p.callablechannels,action:u.u.list,linkedEntity:{id:e,type:u.p.channels,action:u.u.view}},command:n})}toggleRoomRemote(e,t,n){return this.commandHandler({entity:{type:u.p.roomremote,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},entityOptions:n,command:t})}accessibilityPanelById(e,t){return this.commandHandler({entity:{type:u.p.accessibilitypanel,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}closedCaptionsSettingsPanelById(e,t,n={allowTranslatedCaptions:!1}){return this.commandHandler({entity:{type:u.p.closedcaptionssettings,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},entityOptions:n,command:t})}meetingCollab(e,t,n){return this.commandHandler({entity:{type:u.p.meetingcollaboration,action:u.u.view,id:t||e.callId,linkedEntity:{type:u.p.calls,id:t||e.callId}},entityOptions:e,command:n})}presenterToolbarById(e,t){return this.commandHandler({entity:{type:u.p.presentertoolbar,action:u.u.view},entityOptions:e&&{callingIntentId:e},command:t})}pstnCallMeDialogToggle(e,t,n){return this.extensionCommanding.executeCommand(e,{entityOptions:n,entityCommand:t})}}class QC{constructor(e){this.commandHandler=e}navigateById(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.commandHandler({entity:{type:u.p.campaignnotifications,action:u.u.view,id:e},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData})}))}}class JC{constructor(e,t,n,i){this.commandHandler=e,this.extensionCommanding=t,this.coreSettings=n,this._logger=i.newLogger("ChatCommandingService")}default(e){return this.handleCommandWithChecks({entity:{type:u.p.chats,action:u.u.default},command:e})}empty(e){return this.handleCommandWithChecks({entity:{type:u.p.chats,action:u.u.empty},command:e})}chatList(e,t){return this.handleCommandWithChecks({entity:{type:u.p.chats,action:u.u.list},entityOptions:null==t?void 0:t.entityOptions,command:e})}chatById(e,t){return this.handleCommandWithChecks({entity:{type:u.p.chats,action:u.u.view,id:e},entityOptions:null==t?void 0:t.entityOptions,command:null==t?void 0:t.entityCommand,scenarioEventData:null==t?void 0:t.scenarioEventData})}chatWithUsers(e){const t=(0,xC.Mf)((null==e?void 0:e.userIds)||[],null==e?void 0:e.entityCommand);return this.handleCommandWithChecks(Object.assign(Object.assign({},t),{entityOptions:null==e?void 0:e.entityOptions}))}chatWithGuardians(e,t,n,i,a,o){const r=(0,xC.Mf)(t||[],o),s={groupName:n,isGuardiansChat:!0,guardiansChatGroupId:e,guardiansChatStudentId:i,guardiansPreferredToAlternateMriMappings:a};return this.handleCommandWithChecks(Object.assign(Object.assign({},r),{entityOptions:s}))}orgChat(e,t){return this.handleCommandWithChecks({entity:{type:u.p.extensions,action:u.u.view,id:c.oz.organization,linkedEntity:{type:u.p.chats,id:(0,xC.f$)([e])}},command:t})}linkedIn(e,t){return this.handleCommandWithChecks({entity:{type:u.p.extensions,action:u.u.view,id:c.oz.linkedin,linkedEntity:{type:u.p.chats,id:(0,xC.f$)([e])}},command:t})}openLpcInMainWindow(e,t){return this.commandHandler({entity:{type:u.p.livepersonacard,action:u.u.view},command:t,entityOptions:e})}launchAltText(e,t){return this.extensionCommanding.executeCommand({type:u.p.alttext,action:u.u.view},{entityCommand:t,entityOptions:{element:e}})}launchInsertHyperlink(e,t,n){return this.extensionCommanding.executeCommand({type:u.p.hyperlink,action:u.u.view},{entityCommand:n,entityOptions:{displayText:e,address:t}})}launchDiscardCodeSnippet(e){return this.extensionCommanding.executeCommand({type:u.p.codesnippet,action:u.u.delete},{entityCommand:e})}launchTranslationFeedbackDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.translationfeedback,action:u.u.view},{entityCommand:t,entityOptions:e})}launchTwoWaySmsFriendlyNameDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.twowaysmsfriendlyname,action:u.u.view},{entityCommand:t,entityOptions:e})}launchDeleteChat(e,t){return this.extensionCommanding.executeCommand({type:u.p.deletechat,action:u.u.delete},{entityCommand:t,entityOptions:e})}launchDiscardFluid(e,t){return this.extensionCommanding.executeCommand({type:u.p.fluid,action:u.u.delete},{entityCommand:t,entityOptions:{isCompose:e}})}launchUpdatePermissionsFluid(e,t){return this.extensionCommanding.executeCommand({type:u.p.fluid,action:u.u.update},{entityCommand:t,entityOptions:{recipientList:e}})}launchUnpinMessageFromChat(e){return this.extensionCommanding.executeCommand({type:u.p.pinnedconversationitems,action:u.u.delete},{entityCommand:e})}launchReplaceMessageFromChat(e){return this.extensionCommanding.executeCommand({type:u.p.pinnedconversationitems,action:u.u.update},{entityCommand:e})}launchDiscardMessageDraft(e,t){return this.extensionCommanding.executeCommand({type:u.p.messagedraft,action:u.u.delete},{entityCommand:t,entityOptions:{isBranded:e}})}launchGiphyConsent(e){return this.extensionCommanding.executeCommand({type:u.p.giphyconsent,action:u.u.view},{entityCommand:e})}launchLeaveChat(e){return this.extensionCommanding.executeCommand({type:u.p.leavechat,action:u.u.delete},{entityCommand:e})}launchChatInviteConfirmation(e){return this.extensionCommanding.executeCommand({type:u.p.chatInviteConfirmation,action:u.u.view},{entityCommand:e})}launchMaxPinnedChatsReached(e,t){return this.extensionCommanding.executeCommand({type:u.p.pinnedchatsmaxreached,action:u.u.view},{entityCommand:t,entityOptions:{maxPinnedChats:e}})}launchUpdateGroupChatAvatar(e,t){return this.extensionCommanding.executeCommand({type:u.p.updategroupchatavatar,action:u.u.view},{entityCommand:t,entityOptions:{threadId:e}})}launchRemoveChatUser(e,t,n){return this.extensionCommanding.executeCommand({type:u.p.removechatuser,action:u.u.delete},{entityCommand:n,entityOptions:{userName:e,isRemoveTfwUserInTflChat:t}})}launchShareChatLink(e,t,n,i,a,o,r){return this.extensionCommanding.executeCommand({action:u.u.view,id:e,type:u.p.sharechatlink},{entityCommand:r,entityOptions:{chatTitle:t,hasError:n,sharedLink:i,cfet:a,panelType:o}})}launchChatError(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.chats,action:u.u.error},{entityCommand:t})}launchStreamCamera(e){return this.extensionCommanding.executeCommand({type:u.p.streamcamera,action:u.u.default,id:null==e?void 0:e.correlation.id},{entityCommand:e})}meetingRecapTab(e,t,n,i,a,o,r,s,l,d){return this.handleCommandWithChecks({entity:{type:u.p.meetingrecaptab,action:u.u.view,id:e},entityOptions:{threadId:e,subType:t,callId:n,tenantId:i,organizerId:a,recordingId:o,externalEntityKey:r,seriesExternalEntityKey:s,defaultRightTab:l,meetingType:d}})}transcriptTab(e,t,n,i,a,o,r){return this.handleCommandWithChecks({entity:{type:u.p.transcripttab,action:u.u.view,id:t},entityOptions:{conversationId:e,storageId:n,teamsCallId:i,meetingOrganizerId:a,meetingTenantId:o,eventId:r}})}launchReportConcern(e,t){return this.extensionCommanding.executeCommand({type:u.p.reportConcern,action:u.u.create},{entityCommand:t,entityOptions:e})}launchReportConcernV2(e,t){return this.extensionCommanding.executeCommand({type:u.p.reportConcernForTFW,action:u.u.create},{entityCommand:t,entityOptions:e})}launchReportConcernTY(e){return this.extensionCommanding.executeCommand({type:u.p.reportConcern,action:u.u.info},{entityCommand:e})}launchReportConcernV2Confirmation(e){return this.extensionCommanding.executeCommand({type:u.p.reportConcernForTFW,action:u.u.info},{entityCommand:e})}launchDlpDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.dlp,action:u.u.view},{entityCommand:t,entityOptions:e})}chatInfoPane(e,t,n){return this.handleCommandWithChecks({entity:{type:u.p.chatsInfoView,action:u.u.info,id:e},command:t,entityOptions:n})}chatContextualSearch(e,t,n){return this.handleCommandWithChecks({entity:{type:u.p.chatContextualSearch,action:u.u.info,id:e},command:t,entityOptions:n})}chatHighlightsDetails(e,t,n){return this.handleCommandWithChecks({entity:{type:u.p.chatHighlightsDetails,action:u.u.info,id:e},command:t,entityOptions:n})}manage(e,t){return this.handleCommandWithChecks({entity:{type:u.p.chatManageApps,action:u.u.manage,id:e,linkedEntity:{type:u.p.chats,id:e}},command:t})}chatInfoPaneDetails(e,t,n){return this.handleCommandWithChecks({entity:{type:u.p.chatsInfo,action:u.u.infoDetails,id:e},command:t,entityOptions:n})}launchBlockChatDialog(e){return this.extensionCommanding.executeCommand({type:u.p.blockChat,action:u.u.view},{entityCommand:e})}launchLeaveGroupAndBlockUserDialog(e,t){return this.extensionCommanding.executeCommand({type:u.p.leaveGroupAndBlockUser,action:u.u.view},{entityCommand:t,entityOptions:e})}handleCommandWithChecks(e){return this.checkPolicies(e),this.commandHandler(e)}checkPolicies(e){var t,n,i;if(this.coreSettings.get(K.J.Messaging).allowUserChat||(null===(t=e.entity.id)||void 0===t?void 0:t.startsWith("19:meeting")))return;const{type:a,action:o}=e.entity,r=`${De.w5.Commanding}::${De.jK.PolicyCheckFailed}::Chat command not allowed due to policy (allowUserChat=false)`;null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,r,"messaging_command_policy_violation",{mainEntityType:a,mainEntityAction:o})}}class YC{constructor(e){this.commandHandler=e}coachReport(e,t){return this.commandHandler({entity:{type:u.p.coachreport,action:u.u.view},command:e,entityOptions:t})}}class KC{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}showAddMemberDialog(e,t){return this.commandHandler({entity:{id:e,type:u.p.communitiesaddmember,action:u.u.view},entityOptions:{},command:t})}showCommunityLinkDialog(e,t){return this.commandHandler({entity:{action:u.u.view,id:e,type:u.p.sharecommunitieslink},entityOptions:{},command:t})}showCommunityGuidelinesDialog(e,t){return this.commandHandler({entity:{action:u.u.view,id:e,type:u.p.communitiesguidelinesdialog},entityOptions:{},command:t})}showReportConcernDialog(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.reportconcerncommunities,action:u.u.create},{entityCommand:t})}showReportConcernTY(e,t){return this.commandHandler({entity:{type:u.p.reportconcerncommunities,action:u.u.view,id:e},entityOptions:{},command:t})}communityMessagesById(e,t,n,i,a,o,r){const s={channelId:e,replyChainId:t};return localStorage.setItem("communities-selected-id",e),this.commandHandler({entity:{type:u.p.communities,action:null!=r?r:u.u.view,id:JSON.stringify(s)},command:i,entityOptions:Object.assign(Object.assign({},a),{deepLinkId:n}),scenarioEventData:null==o?void 0:o.scenarioEventData})}getCommunityView(){return this.getView(u.p.communities)}getCommunityEvents(e){const t={stateTransition:c.su.flush,visibilityState:c.fe.show,correlation:{source:Ot.D.CommunitiesEventsButton}};return this.commandHandler({entity:{type:u.p.communitiesevents,action:u.u.view,id:JSON.stringify({channelId:e})},command:t})}getOnboardingView(e,t,n){return this.getView(u.p.communitiesonboarding,null!=e?e:u.u.view,t,n)}navigateToCommunityId(e,t){const n={stateTransition:c.su.flush,visibilityState:c.fe.show,correlation:{source:Ot.D.ChannelListItem}};return this.communityMessagesById(e,void 0,void 0,n,void 0,void 0,t?u.u.default:void 0)}getView(e,t,n,i){return this.commandHandler(Object.assign({entity:{type:e,action:null!=t?t:u.u.default},command:{stateTransition:c.su.flush,visibilityState:c.fe.show,correlation:{source:Ot.D.ChannelListItem}}},t===u.u.join?{entityOptions:{inviteLinkType:n,inviteLinkUrl:i}}:{}))}}class ZC{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}openContactsSyncPopout(e){return this.commandHandler({entity:{type:u.p.contactssync,action:u.u.default,id:"default"},command:(null==e?void 0:e.entityCommand)||{stateTransition:c.su.new,visibilityState:c.fe.show,correlation:{source:Ot.D.Flyout}},windowOptions:null==e?void 0:e.windowOptions})}openContactsSyncModal(){return this.extensionCommanding.executeCommand({type:u.p.contactssync,action:u.u.view,id:"default"})}launchContactsModal(e,t){return this.extensionCommanding.executeCommand({type:u.p.contactssync,action:u.u.info,id:e},{entityCommand:{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:t}})}showHideContactsView(e,t,n){return this.commandHandler({entity:{type:u.p.contactssync,action:u.u.view,id:e},command:{stateTransition:c.su.flush,visibilityState:n?c.fe.show:c.fe.hide,correlation:t}})}}class XC{constructor(e){this.commandHandler=e}discoverApps(e,t){return this.commandHandler({entity:{type:u.p.discoverappsnotifications,action:u.u.view},command:t,entityOptions:e})}}class ew{constructor(e,t){this.commandHandler=e,this.loggerFactory=t,this.logger=this.loggerFactory.newLogger("DiscoverSurfaceCommandingService")}showDiscoverSurface(e){return this.logger.log(`showDiscoverSurface: called with - ${u.p.discoversurface}:${u.u.view}`),this.commandHandler({entity:{type:u.p.discoversurface,action:u.u.view},command:null==e?void 0:e.entityCommand,entityOptions:null==e?void 0:e.entityOptions})}}class tw{constructor(e){this.commandHandler=e}launchErrorApp(e){return this.commandHandler({entity:{type:u.p.error,action:u.u.view},command:{stateTransition:c.su.forceFlush,visibilityState:c.fe.show,correlation:{source:Ot.D.LayoutError}},entityOptions:{errorReason:e.code}})}}class nw{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t,this.entityAllowList=[u.p.esp,u.p.help,u.p.storefre,u.p.whatsnewdialog]}displaySurface(e,t,n){return this.commandHandler({entity:{type:u.p.esp,action:u.u.create,id:e},entityOptions:{forceShow:t,customParams:n}})}displayFollowUpSurface(e,t){const n=L.LQM.FollowUp;return this.commandHandler({entity:{type:u.p.esp,action:u.u.create,id:e},entityOptions:{forceShow:t,espTrigger:n}})}launchDialog(e,t){let n=u.p.esp;if(t){if(!this.entityAllowList.includes(t))throw new Error("launchDialog must be called with Entity from the allow list.");n=t}return this.extensionCommanding.executeCommand({id:e,type:n,action:u.u.view})}navigate(e,t,n){return this.commandHandler({entity:e,command:t,entityOptions:n})}}class iw{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}surveyDialogWithObserver(e,t){return this.extensionCommanding.executeCommand({action:u.u.view,type:u.p.survey,id:e},{entityCommand:t})}surveyDialog(e,t){var n;const i={source:null===(n=null==t?void 0:t.correlation)||void 0===n?void 0:n.source,entityStateTransition:null==t?void 0:t.stateTransition};return this.commandHandler({entity:{type:u.p.survey,action:u.u.view,id:e},command:t,entityOptions:i})}giveFeedbackDialog(e){return this.commandHandler({entity:{type:u.p.givefeedbackchoices,action:u.u.view},command:e})}}class aw{constructor(e,t){this.extensionCommanding=e,this.commandHandler=t}galleryImage(e,t){const n=e.galleryId,i={type:u.p.galleryImages,action:u.u.view,id:n};return this.commandHandler({entity:i,command:t,entityOptions:e})}galleryImageExtended(e,t){const n=e.galleryId,i={type:u.p.galleryImages,action:u.u.view,id:n};return this.extensionCommanding.executeCommand(i,{entityCommand:t,entityOptions:e})}fileById(e){const t=e.fileId;return this.commandHandler({entity:{type:u.p.file,action:u.u.view,id:t},entityOptions:e})}launchFileViewApp(e,t,n=Ot.D.FileViewer){const i={subEntityId:JSON.stringify(t)};return this.commandHandler({entity:{type:u.p.extensions,action:u.u.view,id:JSON.stringify({appId:e}),linkedEntity:{id:JSON.stringify(i),type:u.p.extensions}},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:n}}})}openInOneup(e,t=Ot.D.FileViewer){const n=e.fileId;let i,a;if("channelsPDFTab"===e.context){const t={channelId:e.threadId,replyChainId:void 0};a={type:u.p.filesoneupviewer,action:u.u.view,id:e.entityId,linkedEntity:{id:JSON.stringify(t),type:u.p.channels}},i=Ot.D.ChannelHeader}else a={type:u.p.filesoneupviewer,action:u.u.view,id:n},i=t;return this.commandHandler({entity:a,command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{id:(0,mt.v4)(),source:i}},entityOptions:e})}closeOneup(e,t=Ot.D.FileViewer){return this.commandHandler({entity:{type:u.p.filesoneupviewer,action:u.u.view,id:e},command:{visibilityState:c.fe.hide,stateTransition:c.su.flush,correlation:{source:t}}})}fileOpenSettingsSuggestion(e){return this.commandHandler({entity:{type:u.p.fileopensettings,action:u.u.info},entityOptions:e})}fileOpenSettingsUpdate(e){return this.commandHandler({entity:{type:u.p.fileopensettings,action:u.u.update},entityOptions:e})}chatFilesList(e,t){return this.commandHandler({entity:{id:null,type:u.p.file,action:u.u.list,linkedEntity:{type:u.p.chats,id:e}},command:t})}photosList(e,t){return this.commandHandler({entity:{id:null,type:u.p.gallery,action:u.u.view,linkedEntity:{type:u.p.chats,id:e}},command:t})}launchFilePicker(e,t,n){return this.extensionCommanding.executeCommand({type:u.p.filepicker,action:u.u.view},{entityCommand:n,entityOptions:{fileContainerKey:e,filePickerContext:t}})}}class ow{constructor(e){this.commandHandler=e}launchFlyoutHomePage(){const e={id:(0,mt.v4)(),source:Ot.D.Flyout,startTimestamp:Date.now()};return this.commandHandler({entity:{type:u.p.flyout,action:u.u.default},command:{correlation:e,stateTransition:c.su.flush,visibilityState:c.fe.show,layoutMode:c.lO.minimal}})}}class rw{constructor(e){this.commandHandler=e}freemiumUpgrade(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.commandHandler({entity:{type:u.p.freemiumupgrade,action:u.u.view},command:e,entityOptions:t})}))}}class sw{constructor(e){this.commandHandler=e}guardiansTabInChannelById(e,t,n,i){const a={type:u.p.guardians,action:u.u.list,id:e,linkedEntity:n};return this.commandHandler({entity:a,command:t,entityOptions:i})}}class lw{constructor(e){this.extensionCommanding=e}showCreatePostDialog(e,t,n,i){return this.extensionCommanding.executeCommand({type:u.p.classesintegrationcontent,action:u.u.create},{entityCommand:{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:Ot.D.LmsCourseTeams}},entityOptions:{teamId:e,teamName:t,groupId:n,tenantId:i}})}}class dw{constructor(e){this.commandHandler=e}viewLobNotifications(e,t){return this.commandHandler({entity:{type:u.p.lobnotifications,action:u.u.view},command:t,entityOptions:e})}}class cw{constructor(e){this.commandHandler=e}analytics(e,t){return this.commandHandler({entity:{type:u.p.meetinganalytics,action:u.u.view},command:e,entityOptions:t})}openAttendanceTabInSchedulingForm(e,t,n="",i=0){return this.commandHandler({entity:{type:u.p.attendancereport,action:u.u.view,linkedEntity:{type:u.p.schedulingform,action:u.u.view,id:JSON.stringify({eventId:(0,xC.cW)(n),providerType:i})}},command:e,entityOptions:Object.assign(Object.assign({},t),{eventId:(0,xC.cW)(n)})})}openAnalyticsInSchedulingForm(e,t,n="",i=0){return this.commandHandler({entity:{type:u.p.meetinganalytics,action:u.u.view,linkedEntity:{type:u.p.schedulingform,action:u.u.view,id:JSON.stringify({eventId:(0,xC.cW)(n),providerType:i})}},command:e,entityOptions:Object.assign(Object.assign({},t),{eventId:(0,xC.cW)(n)})})}openAttendanceTabInMeetingChat(e,t){return this.commandHandler({entity:{type:u.p.meetinganalytics,action:u.u.view},command:e,entityOptions:{threadId:t}})}}class uw{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}meetingOptionsFormView(e,t,n,i,a,o){return this.commandHandler({entity:{type:u.p.meetings,action:u.u.view,id:this.serializeMeetingCoordinates(e,t,n,i,a)},command:o})}meetingOptionsCreateViewDialog(e,t,n){const i={type:u.p.meetingoptionscreatedialog,id:e.id,action:e.action};return this.extensionCommanding.executeCommand(i,{entityCommand:t,entityOptions:n})}serializeMeetingCoordinates(e,t,n,i,a){return JSON.stringify({tenantId:e,organizerId:t,threadId:n,messageId:i,additionalMessageId:a})}}class mw{constructor(e){this.commandHandler=e}recapTabInMeetingChat(e,t,n){return this.commandHandler({entity:{type:u.p.meetingrecap,action:u.u.view,linkedEntity:n?{type:u.p.chats,action:u.u.view,id:(null==t?void 0:t.threadId)||""}:null},command:e,entityOptions:t})}recapTabInSchedulingForm(e,t,n){return this.commandHandler({entity:{type:u.p.meetingrecap,action:u.u.view,linkedEntity:{type:u.p.schedulingform,action:u.u.view,id:JSON.stringify({eventId:(0,xC.cW)((null==t?void 0:t.externalEntityKey)||""),providerType:n})}},command:e,entityOptions:t})}popOutMeetingRecap(e,t,n){const i={id:(0,mt.v4)(),source:Ot.D.ChatListItem,startTimestamp:Date.now()};return this.commandHandler({entity:{type:u.p.meetingrecap,action:u.u.view},command:{stateTransition:c.su.new,visibilityState:c.fe.show,correlation:i},entityOptions:{threadId:e,subType:"popup",externalEntityKey:t,defaultRightTab:n}})}}class gw{constructor(e){this.commandHandler=e}meetingRoomConsoleInCallById(e,t,n){return this.commandHandler({entity:{type:u.p.meetingroomconsolecall,action:u.u.view,id:e},entityOptions:t,command:n})}meetingRoomNewCall(){return this.commandHandler({entity:{type:u.p.meetingroomconsolecall,action:u.u.create},entityOptions:{stateParams:{isPstnCall:!0},createCallType:is.fX.Dialpad},command:{stateTransition:c.su.flush,visibilityState:c.fe.show,correlation:{source:Ot.D.Calling}}})}meetingRoomSmartDeviceJoinByCode(e){return this.commandHandler({entity:{type:u.p.meetingroomconsolecall,action:u.u.create},entityOptions:{createCallType:is.fX.SmartDeviceJoinByCode},command:e})}meetingRoomJoinByCode(e){return this.commandHandler({entity:{type:u.p.meetingroomconsolecall,action:u.u.create},entityOptions:{createCallType:is.fX.JoinByCode},command:e})}}class pw{constructor(e){this.commandHandler=e}viewOnboardingNotifications(e,t){return this.commandHandler({entity:{type:u.p.onboardingnotifications,action:u.u.view},command:t,entityOptions:e})}}class vw{constructor(e,t,n){this.commandHandler=e,this.extensionCommanding=t,this.coreSettings=n}launchTaskModule(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.taskmodule,action:u.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.taskModuleOptions})}launchHWCTaskModule(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.hwctaskmodule,action:u.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.taskModuleOptions})}launchStage(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformStage,action:u.u.view},{entityCommand:t,entityOptions:null==e?void 0:e.stageOptions})}launchStageMW(e){return this.commandHandler({entity:{id:e.id,type:u.p.platformStage,action:u.u.create,linkedEntity:e.linkedEntity},command:{stateTransition:c.su.new,visibilityState:c.fe.show,correlation:{source:Ot.D.PlatformExtension}},entityOptions:e.stageOptions})}launchTabGallery(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformTabGallery,action:u.u.view},{entityCommand:t,entityOptions:null==e?void 0:e.tabGalleryOptions})}launchUnsupportedDeeplinkDialog(e){return this.extensionCommanding.executeCommand({type:u.p.unsupporteddeeplinkdialog,action:u.u.view},{entityOptions:{originalDeeplink:e}})}launchAppDetails(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformapp,action:u.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.platformAppDetailsOptions})}launchAppDetailsTutorial(e){const t=this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformappdetails,action:u.u.info},{entityCommand:t,entityOptions:e})}launchAppRevokeConsent(e){const t=this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformappconsent,action:u.u.delete},{entityCommand:t,entityOptions:e})}appDetailsPostInstall(e){const t=this.getDefaultCommand();return t.stateTransition=c.su.none,this.commandHandler({entity:{type:u.p.platformappdetails,action:u.u.config},command:t,entityOptions:e})}appDetailsOnDone(e,t){const n=this.getDefaultCommand();return n.stateTransition=c.su.none,this.commandHandler({entity:{id:e,type:u.p.platformappdetails,action:u.u.update},command:n,entityOptions:t})}launchInContextStore(e){const t=this.getDefaultCommand();return this.extensionCommanding.executeCommand({type:u.p.incontextstore,action:u.u.view},{entityCommand:t,entityOptions:e})}inContextStorePostInstall(e){const t=this.getDefaultCommand();return t.stateTransition=c.su.none,this.commandHandler({entity:{type:u.p.incontextstore,action:u.u.config},command:t,entityOptions:e})}inContextStoreOnDone(e,t){const n=this.getDefaultCommand();return n.stateTransition=c.su.none,this.commandHandler({entity:{id:e,type:u.p.incontextstore,action:u.u.update},command:n,entityOptions:t})}launchAppStore(e,t){return this.commandHandler({entity:{type:u.p.platformapps,action:u.u.list},command:t,entityOptions:e})}launchPersonalApp(e){const t=this.getDefaultCommand();return t.stateTransition=c.su.none,this.commandHandler({entity:{type:u.p.platformapp,action:u.u.view},command:t,entityOptions:e})}launchAppUninstall(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformapp,action:u.u.delete},{entityCommand:n,entityOptions:null==t?void 0:t.uninstallOptions})}launchAppError(e){const t=this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformapp,action:u.u.error},{entityCommand:t,entityOptions:e})}launchUploadCustomApp(){const e=this.getDefaultCommand();return e.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.customapp,action:u.u.view},{entityCommand:e})}launchRequestSubmittedDialog(){const e=this.getDefaultCommand();return e.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.customapp,action:u.u.info},{entityCommand:e})}launchLocationDialog(e){const t=this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.locationapi,action:u.u.create},{entityCommand:t,entityOptions:e})}launchSelectMediaDialog(e){const t=this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.selectMediaApi,action:u.u.create},{entityCommand:t,entityOptions:e})}launchViewImagesDialog(e){const t=this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.viewImagesApi,action:u.u.create},{entityCommand:t,entityOptions:e})}launchSelectPeoplePickerDialog(e){const t=this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.selectpeoplepicker,action:u.u.view},{entityCommand:t,entityOptions:e})}launchAppConfig(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformapp,action:u.u.config},{entityCommand:n,entityOptions:null==t?void 0:t.launchAppConfigOptions})}launchTabInfo(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformtab,action:u.u.info},{entityCommand:n,entityOptions:null==t?void 0:t.launchTabInfoOptions})}launchStagedApps(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.stagedapps,action:u.u.info},{entityCommand:t,entityOptions:null==e?void 0:e.launchStagedAppsOptions})}launchAppAuthConsent(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformauthconsentdialog,action:u.u.create},{entityCommand:n,entityOptions:null==t?void 0:t.launchAuthConsentOptions})}platformTabById(e,t,n,i){return this.commandHandler({entity:{id:e,type:u.p.extensions,action:u.u.view,linkedEntity:n},command:t,entityOptions:i})}launchPersonalPlatformApp(e,t,n,i,a){return this.commandHandler({entity:{id:JSON.stringify({appId:e,tabEntityId:n}),type:u.p.extensions,action:u.u.view,linkedEntity:a},command:{visibilityState:c.fe.show,stateTransition:t?c.su.new:c.su.flush,correlation:{source:null!=i?i:Ot.D.Nova,startTimestamp:Date.now()}},entityOptions:{isMultiWindow:t,entryPoint:Lm.mQ.personalApp}})}platformAppById(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.extensions,action:u.u.view,linkedEntity:n},command:t})}navigateToManageApps(e){return this.commandHandler({entity:{type:u.p.platformapps,action:u.u.manage},entityOptions:e})}launchSubscriptionPlansDialog(e,t,n){const i=n||this.getDefaultCommand();return i.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformsubscriptionplans,action:u.u.info},{entityCommand:i,entityOptions:t})}launchAngularAppDetails(e,t,n){const{enableAppDetailsAngularFeatureParity:i}=this.coreSettings.get(K.J.Host);if(i)return this.launchAppDetails(e,{platformAppDetailsOptions:t,entityCommand:n});const a=n||this.getDefaultCommand();return a.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.platformapp,action:u.u.info},{entityCommand:a,entityOptions:t})}launchCustomAppFilePicker(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.customapp,action:u.u.create},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:n||Ot.D.Store}},entityOptions:t})}launchWorkflowsDialog(e,t,n){return this.extensionCommanding.executeCommand({id:e,type:u.p.workflows,action:u.u.create},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:n||Ot.D.Store}},entityOptions:t})}launchManageWorkflows(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.workflows,action:u.u.manage},entityOptions:t,command:{visibilityState:c.fe.show,stateTransition:c.su.none,correlation:{source:n||Ot.D.Store}}})}launchSettingsDialog(e,t,n){const i={visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:n||Ot.D.Card}};return this.extensionCommanding.executeCommand({id:e,type:u.p.settingsdialog,action:u.u.view},{entityCommand:i,entityOptions:t})}updatePlatformTabById(e,t,n,i){return this.commandHandler({entity:{id:e,type:u.p.extensions,action:u.u.update,linkedEntity:n},command:t,entityOptions:i})}videoEffectsCustomizationPanelById(e,t){return this.commandHandler({entity:{type:u.p.videoeffectscustomization,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}videoEffectsMoreViewPanelById(e,t,n){return this.commandHandler({entity:{type:u.p.videoeffectsmoreview,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t,entityOptions:n})}videoEffectsAndAvatarPanelById(e,t){return this.commandHandler({entity:{type:u.p.videoeffectsandavatar,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}meshAvatarPanelById(e,t){return this.commandHandler({entity:{type:u.p.meshavatar,action:u.u.view,linkedEntity:{type:u.p.calls,id:e}},command:t})}launchManageAppsUninstall(e,t){const n=this.getDefaultCommand();return n.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({id:e,type:u.p.manageapps,action:u.u.delete},{entityCommand:n,entityOptions:t})}launchManageAppsWebhook(e,t){const n=this.getDefaultCommand();n.visibilityState=c.fe.show;const i=t.editMode?u.u.update:u.u.create;return this.extensionCommanding.executeCommand({id:e,type:u.p.manageappswebhook,action:i},{entityCommand:n,entityOptions:t})}launchManageAppsWebhookConfirmation(e){const t=this.getDefaultCommand(),n={webhookToken:e};return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.manageappswebhook,action:u.u.info},{entityCommand:t,entityOptions:n})}selectAppEntity(e){const t=(null==e?void 0:e.entityCommand)||this.getDefaultCommand();return t.visibilityState=c.fe.show,this.extensionCommanding.executeCommand({type:u.p.platformTabGallery,action:u.u.create},{entityCommand:t,entityOptions:null==e?void 0:e.selectAppEntityOptions})}launchAppDevicePermissions(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.platformappdevicepermissions,action:u.u.create},{entityCommand:this.getDefaultCommand(),entityOptions:t})}launchAppDevicePermissionsFirstRun(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.platformappdevicepermissions,action:u.u.update},{entityCommand:this.getDefaultCommand(),entityOptions:t})}launchRefreshConfirmationAfterAppDevicePermissionsUpdate(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.platformappdevicepermissions,action:u.u.confirm},{entityCommand:this.getDefaultCommand(),entityOptions:t})}getDefaultCommand(){return{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:Ot.D.ExtensionCommanding}}}}class hw{constructor(e,t){this.commandHandler=e,this.coreSettings=t}registration(e){const{enableMultiWindowWebinarRegistration:t}=this.coreSettings.get(K.J.WebinarRegistration);return t?this.commandHandler({entity:{action:u.u.view,id:e,type:u.p.registration},command:{visibilityState:c.fe.show,stateTransition:c.su.new,correlation:{source:Ot.D.Calendar}}}):((0,Ze.J)().open(`${(0,Ze.J)().location.origin}/registration/${e}?mode=edit`,"_blank"),Promise.resolve())}}class fw{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}showTeamsGrid(){return this.commandHandler({entity:{type:u.p.schoolteams,action:u.u.list},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.SchoolTeams}}})}gridTeamDiscover(){return this.commandHandler({entity:{type:u.p.schoolteams,action:u.u.join},command:{stateTransition:c.su.flush,visibilityState:c.fe.show,correlation:{source:Ot.D.SchoolTeams}}})}showSingleTeam(e){return this.commandHandler({entity:{type:u.p.channels,action:u.u.view,id:e},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.SchoolTeams}}})}eduCreateTeam(){return this.extensionCommanding.executeCommand({type:u.p.eduteamcreate,action:u.u.view})}showUnlockDialog(e){return this.extensionCommanding.executeCommand({type:u.p.schoolteams,action:u.u.update,id:e},{entityCommand:{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:Ot.D.UnlockTeam}}})}}class yw{constructor(e){this.commandHandler=e,this.updateSearchState=e=>this.commandHandler({entity:{id:e&&e.searchQuery,type:u.p.search,action:u.u.view},command:{correlation:{id:(0,mt.v4)(),startTimestamp:Date.now(),source:Ot.D.Search},stateTransition:c.su.none,visibilityState:c.fe.show},entityOptions:e}),this.updateSearchStateRW=e=>this.commandHandler({entity:{id:e&&e.searchQuery,type:u.p.search,action:u.u.view},command:{correlation:{id:(0,mt.v4)(),startTimestamp:Date.now(),source:Ot.D.Search},stateTransition:c.su.flush,visibilityState:c.fe.show},entityOptions:e}),this.open3SFeedback=e=>this.commandHandler({entity:{type:u.p.open3sfeedback,action:u.u.view},command:{correlation:{source:Ot.D.Search},stateTransition:c.su.new,visibilityState:c.fe.show},entityOptions:e}),this.exitSearchState=()=>this.commandHandler({entity:{type:u.p.search,action:u.u.view,id:"search"},command:{correlation:{source:Ot.D.Search},stateTransition:c.su.forceFlush,visibilityState:c.fe.hide}})}}class kw{constructor(e){this.commandHandler=e}launch(e){return this.commandHandler({entity:{type:u.p.settingsstore,action:u.u.default},command:e})}launchSection(e,t,n,i){return this.commandHandler({entity:{type:null!=i?i:u.p.settingsstore,action:u.u.view,id:e},command:t,entityOptions:Object.assign(Object.assign({},n),{commandSource:null==t?void 0:t.correlation.source})})}}class Sw{constructor(e){this.extensionCommanding=e}launchShareFormDialog(e,t){const n=(null==t?void 0:t.entityCommand)||this.getDefaultCommand();return n.visibilityState=c.fe.show,n.stateTransition=c.su.extend,this.extensionCommanding.executeCommand({id:e,type:u.p.shareformdialog,action:u.u.view},{entityCommand:n,entityOptions:null==t?void 0:t.entityOptions})}getDefaultCommand(){return{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:Ot.D.ExtensionCommanding}}}}class bw{constructor(e){this.commandHandler=e}viewStore(e,t,n){return this.commandHandler({entity:{type:u.p.store,action:u.u.view,id:e},command:n,entityOptions:t})}showStoreFre(e,t){return this.commandHandler({entity:{type:u.p.storefre,action:u.u.view,id:t},command:{visibilityState:e?c.fe.show:c.fe.hide,stateTransition:c.su.extend,correlation:{source:Ot.D.ExtensionCommanding}}})}viewManageAppsTab(e,t){return this.commandHandler({entity:{type:u.p.store,action:u.u.manage},command:t,entityOptions:e})}}var Cw;!function(e){e.User="user",e.Team="team",e.TeamOwned="teamowned"}(Cw||(Cw={}));class ww{constructor(e,t){this.commandHandler=e,this.extensionCommanding=t}editTeamPicture(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teampicture,action:u.u.view})}viewTeamJoinCode(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamjoincode,action:u.u.view},{entityOptions:{teamJoinCode:t}})}viewTeamRenewal(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamrenewal,action:u.u.view},{entityOptions:{expiryTime:t}})}channelById(e,t){const n={channelId:e};return this.commandHandler({entity:{type:u.p.channels,action:u.u.view,id:JSON.stringify(n)},entityOptions:Object.assign(Object.assign({},null==t?void 0:t.entityOptions),{parentTeamId:null==t?void 0:t.parentTeamId,pinned:null==t?void 0:t.pinned}),command:null==t?void 0:t.entityCommand})}editTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamedit,action:u.u.view},{entityOptions:t})}addMember(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.addmember,action:u.u.view})}addMemberToNewTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.addmembernewteam,action:u.u.view},{entityOptions:t})}addChannel(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.addchannel,action:u.u.view})}manageApps(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teammanageapps,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTags(e,t,n,i){return this.commandHandler({entity:{id:e,type:u.p.teammanagetags,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:Object.assign(Object.assign({},null==i?void 0:i.entityOptions),{tagId:n}),scenarioEventData:null==i?void 0:i.scenarioEventData,command:(null==i?void 0:i.entityCommand)||this.getDefaultEntityCommand(null!=t?t:Ot.D.ChannelListItem)})}leaveTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamleave,action:u.u.view})}createTeam(){return this.extensionCommanding.executeCommand({type:u.p.teamcreate,action:u.u.view})}archiveTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamarchive,action:u.u.view})}restoreTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamrestore,action:u.u.view})}launchConfirmPinUnpinPost(e,t){return this.extensionCommanding.executeCommand({type:u.p.pinunpinpost,action:u.u.view},{entityCommand:t,entityOptions:e})}createTeamOnMainView(e,t){return this.commandHandler({entity:{type:u.p.teams,action:u.u.create},entityOptions:e,command:this.getDefaultEntityCommand(null!=t?t:Ot.D.ChannelList)})}showListView(){return this.commandHandler({entity:{type:u.p.channels,action:u.u.view},command:this.getDefaultEntityCommand(Ot.D.SchoolTeams)})}teamDiscover(){return this.commandHandler({entity:{type:u.p.teamdiscover,action:u.u.view},command:this.getDefaultEntityCommand(Ot.D.ChannelListItem)})}manageTeam(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teammanage,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeams(e){return this.commandHandler({entity:{type:u.p.teams,action:u.u.config},command:this.getDefaultEntityCommand(e)})}manageSharedChannelsPendingInvites(e,t,n){return this.commandHandler({entity:{id:n,type:u.p.sharedchannelspendinginvites,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(n)},command:(null==t?void 0:t.entityCommand)||this.getDefaultEntityCommand(e),scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:null==t?void 0:t.entityOptions})}manageTeamsList(e,t,n){return this.commandHandler({entity:{id:n,type:u.p.teamslist,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(n)},command:(null==t?void 0:t.entityCommand)||this.getDefaultEntityCommand(e),scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:null==t?void 0:t.entityOptions})}crossTeamAnalytics(e,t,n){return this.commandHandler({entity:{id:n,type:u.p.crossTeamAnalytics,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(n)},command:(null==t?void 0:t.entityCommand)||this.getDefaultEntityCommand(e),scenarioEventData:null==t?void 0:t.scenarioEventData,entityOptions:null==t?void 0:t.entityOptions})}acceptInvitation(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.sharedchannelacceptinvitation,action:u.u.view},{entityOptions:t})}declineInvitation(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.sharedchanneldeclineinvitation,action:u.u.view},{entityOptions:t})}teamDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teamdeeplink,action:u.u.view})}channelDeepLink(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channeldeeplink,action:u.u.view})}viewChannelEmail(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelemail,action:u.u.view})}viewChannelEmailV2(e,t){return this.extensionCommanding.executeCommand({type:u.p.channelemailv2,action:u.u.view},{entityCommand:t,entityOptions:e})}removeChannelEmail(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.removechannelemail,action:u.u.view},{entityCommand:t})}launchChannelEmailErrorDialog(e){return this.extensionCommanding.executeCommand({type:u.p.channelemailerror,action:u.u.view},{entityCommand:{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:Ot.D.ChannelEmail}},entityOptions:{errorCode:e}})}manageChannelConnectors(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelconnectors,action:u.u.view})}deleteChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.channeldelete,action:u.u.view},{entityOptions:t})}editChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.channeledit,action:u.u.view},{entityOptions:t})}channelModerators(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelmoderators,action:u.u.view})}manageChannel(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelmanage,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:{parentTeamId:null==t?void 0:t.parentTeamId},command:this.getDefaultEntityCommand(n||Ot.D.ChannelListItem)})}manageChannelAnalytics(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelanalytics,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelMembers(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelmembers,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelSettings(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelsettings,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelInvitations(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channelinvitations,action:u.u.view},entityOptions:Object.assign(Object.assign({},null==n?void 0:n.entityOptions),{parentTeamId:null==n?void 0:n.parentTeamId}),command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData})}manageChannelTags(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.channeltags,action:u.u.view},entityOptions:{parentTeamId:null==n?void 0:n.parentTeamId,tagId:null==n?void 0:n.tagId},command:this.getDefaultEntityCommand(t)})}addChannelMember(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelroster,action:u.u.manage})}leaveChannel(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channels,action:u.u.leave})}channelNotificationSettings(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.channelnotificationsettings,action:u.u.view},{entityCommand:this.getDefaultEntityCommand(t||Ot.D.ChannelListItem)})}shareChannelWithUser(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channels,action:u.u.share},{entityOptions:{shareWith:Cw.User}})}shareChannelWithTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channels,action:u.u.share},{entityOptions:{shareWith:Cw.Team}})}shareChannelWithTeamOwned(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.channels,action:u.u.share},{entityOptions:{shareWith:Cw.TeamOwned}})}manageTeamSettings(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teamsettings,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeamAnalytics(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teamanalytics,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeamChannels(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teamchannels,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}manageTeamPendingJoinRequest(e,t,n){return this.commandHandler({entity:{id:e,type:u.p.teampendingrequests,action:u.u.view,linkedEntity:this.getChannelLinkedEntity(e)},command:(null==n?void 0:n.entityCommand)||this.getDefaultEntityCommand(t),scenarioEventData:null==n?void 0:n.scenarioEventData,entityOptions:null==n?void 0:n.entityOptions})}deleteTeam(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.teams,action:u.u.delete})}restoreChannel(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.restorechannel,action:u.u.view},{entityOptions:null==t?void 0:t.entityOptions})}showChannelOwners(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.showChannelOwners,action:u.u.view},{entityOptions:t})}showForMemberDialog(e){return this.extensionCommanding.executeCommand({id:e,type:u.p.showformemberdialog,action:u.u.view})}getChannelLinkedEntity(e){return{id:e||"",type:u.p.channels,action:u.u.list}}getDefaultEntityCommand(e,t=c.su.flush){return{stateTransition:t,visibilityState:c.fe.show,correlation:{source:e}}}}class Nw{constructor(e){this.commandHandler=e}openTranscriptTab({entityCommand:e,messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r},s){return this.commandHandler({entity:{type:u.p.transcriptcontent,action:u.u.view},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r,eventId:s}})}openTranscriptInSchedulingForm({entityCommand:e,messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r},s,l){return this.commandHandler({entity:{type:u.p.transcriptcontent,action:u.u.view,linkedEntity:{type:u.p.schedulingform,action:u.u.view,id:JSON.stringify({eventId:(0,xC.cW)(s),providerType:l})}},command:e,entityOptions:{messageId:t,threadId:n,transcriptId:i,isOrganizer:a,eventId:(0,xC.cW)(s),meetingOrganizerId:o,meetingTenantId:r}})}openTranscriptInChatApp({entityCommand:e,messageId:t,threadId:n,transcriptId:i,isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r},s,l){return this.commandHandler({entity:{id:i,type:u.p.transcriptcontent,action:u.u.view,linkedEntity:l?{type:u.p.chats,action:u.u.view,id:n||""}:null},command:e,entityOptions:{eventId:s?(0,xC.cW)(s):"",isOrganizer:a,meetingOrganizerId:o,meetingTenantId:r,messageId:t,threadId:n,transcriptId:i}})}}class Tw{constructor(e,t,n,i){this.extensionCommanding=e,this.commandHandler=t,this.host=n,this.coreSettings=i}virtualEventsList(e){return this.commandHandler({entity:{type:u.p.virtualevents,action:u.u.list},command:e})}virtualEventById(e,t){const{useMeetingExperienceForSchedulingVirtualEvents:n,virtualEventByIdLinkUrl:i}=this.coreSettings.get(K.J.VirtualEvents);return n&&(null==t?void 0:t.stateTransition)===c.su.new?(this.host.open(null==i?void 0:i.replace("{eventId}",e)),Promise.resolve()):this.commandHandler({entity:{type:u.p.virtualevents,action:u.u.view,id:e},command:t})}createVirtualEvent(e,t){const{eventType:n}=e,{useMeetingExperienceForSchedulingVirtualEvents:i,createVirtualEventsLinkUrl:a}=this.coreSettings.get(K.J.VirtualEvents);return i?(this.host.open(null==a?void 0:a.replace("{eventType}",n)),Promise.resolve()):this.commandHandler({entity:{type:u.p.virtualevents,action:u.u.create},command:t,entityOptions:e})}showConfirmationDialog(e){return this.extensionCommanding.executeCommand({type:u.p.virtualevents,action:u.u.confirm},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:Ot.D.VirtualEventDetails}},entityOptions:e})}showShareDialog(e){return this.extensionCommanding.executeCommand({type:u.p.virtualevents,action:u.u.share},{entityCommand:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:Ot.D.VirtualEventDetails}},entityOptions:e})}}class Iw{constructor(e){this.commandHandler=e}openWikiTab(e,t,n,i){const a={entity:{action:u.u.view,id:e,linkedEntity:i,type:u.p.wiki},command:t,entityOptions:n};return this.commandHandler(a)}}class Ew{constructor(e){this.commandHandler=e}qnaById(e,t,n){return this.commandHandler({entity:{type:u.p.yammerqna,action:u.u.view,id:e},command:t,entityOptions:n})}}class Aw{constructor(e){this.commandHandler=e}launch(e){return this.commandHandler({entity:{type:u.p.teamsgallery,action:u.u.view},command:e})}launchSection(e){return this.commandHandler({entity:{type:u.p.teamsgallery,action:u.u.view,id:e},command:{stateTransition:c.su.flush,visibilityState:c.fe.show,correlation:{source:Ot.D.TeamsGallery}}})}launchTeamsGallery(){return this.commandHandler({entity:{type:u.p.teamsgallery,action:u.u.view,id:""},command:{stateTransition:c.su.flush,visibilityState:c.fe.show,correlation:{source:Ot.D.TeamsGallery}}})}}class _w{constructor(e){this.commandHandler=e}callList(e,t){return this.commandHandler({entity:{id:e,type:u.p.callsmain,action:u.u.view},command:t})}contactList(e,t){return this.commandHandler({entity:{type:u.p.callsmain,action:u.u.list},command:e,entityOptions:null==t?void 0:t.entityOptions,scenarioEventData:null==t?void 0:t.scenarioEventData})}}class Dw{constructor(e){this.extensionCommanding=e}launchUnifiedConsent(e){this.extensionCommanding.executeCommand({type:u.p.unifiedconsentdialog,action:u.u.view},{entityOptions:Object.assign({},e)})}}class Fw{constructor(e){this.extensionCommanding=e}stopSharingChannelWithTeam(e,t){return this.extensionCommanding.executeCommand({id:e,type:u.p.stopsharingchannelwithteam,action:u.u.view},{entityOptions:null==t?void 0:t.entityOptions})}}class Mw{constructor(e){this.extensionCommanding=e}denyInvitationConfirmDialog(){return this.extensionCommanding.executeCommand({type:u.p.sharedchanneldenyinvitation,action:u.u.view},{entityCommand:{stateTransition:c.su.extend,visibilityState:c.fe.show,correlation:{source:Ot.D.ChannelInvitations}}})}}const Rw=(e,t,n,i,a,o,r,s,l,d,c,u=De.ew,m,g)=>{const p=new yC(e,i,u,r,s),v=new dC(o,e,p,r,s,l,a,c,m,g);return{entityCommanding:{account:new PC(e),activity:new OC(e,p),aiInsights:new LC(e),authentication:new jC(e,p,v,i),autoinstallnotification:new WC(e),biometricEnrollment:new VC(e),brbFeedback:new HC(e,p),breakoutRooms:new $C(e),broadcast:new zC(e),calendar:new GC(p,e),call:new qC(e,p,c),callsMain:new _w(e),campaignNotifications:new QC(e),channel:new mf(e,p),chat:new JC(e,p,a,s),coachReport:new YC(e),contacts:new ZC(e,p),deepLink:v,destroy:()=>p.destroy(),discoverSurface:new ew(e,s),discoverappsnotifications:new XC(e),error:new tw(e),esp:new nw(e,p),feedback:new iw(e,p),file:new aw(p,e),flyout:new ow(e),freemiumUpgrade:new rw(e),guardians:new sw(e),meetingAnalytics:new cw(e),meetingRecap:new mw(e),meetingRoom:new gw(e),meetingOptions:new uw(e,p),nova:new bC(e),platform:new vw(e,p,a),registration:new hw(e,a),school:new fw(e,p),search:new yw(e),settings:new kw(e),shareForm:new Sw(p),shell:new FC(e,p,d,u,o,a,s),store:new bw(e),lobnotifications:new dw(e),lms:new lw(p),onboardingnotifications:new pw(e),teamsAndChannels:new ww(e,p),teamsAndChannelsDialogs:new Fw(p),teamsAndChannelsConfirmationDialogs:new Mw(p),teamsGallery:new Aw(e),toasts:new MC(e,c),transcript:new Nw(e),unifiedConsent:new Dw(p),virtualEvents:new Tw(p,e,o,a),yammerQna:new Ew(e),wiki:new Iw(e),communities:new KC(e,p)},eventing:new Cb(n,e,t)}},Pw=new Set(["com.microsoft.teams.activity","com.microsoft.teams.calling"]);class Ow{constructor(e,t,n,i,a,o,r,s){this._appsRegistry=e,this._client=t,this._commandResultChangeReportingService=n,this._coreSettings=i,this._entityCommanding=a,this._loggerFactory=o,this._scenarioFactory=r,this._userContextId=s}init(){this._changes&&this.destroy(),this._changes=this._commandResultChangeReportingService.observeChanges().pipe((0,rS.h)((e=>e.userContextId===this._userContextId))).subscribe((e=>this.executeOnCommandResultAppHooks(e)))}destroy(){var e;null===(e=this._changes)||void 0===e||e.unsubscribe(),this._changes=void 0}executeOnCommandResultAppHooks({context:{entityCommand:e,error:t},type:n}){var i,a;if(!e)return;const o=e.command.correlation.scenarioName===ft.RG.ActivitySwitch,r=e.entity.type,s=r&&this._appsRegistry.getApp({entityType:o?u.p.activity:r}),l=null==s?void 0:s.onCommandResult;if(s&&Pw.has(s.manifest.id)&&l)try{l({requestContext:{client:this._client,coreSettings:this._coreSettings,entityCommanding:this._entityCommanding,error:t,loggerFactory:this._loggerFactory,scenarioFactory:this._scenarioFactory},entityCommand:e,result:n})}catch(e){null===(a=(i=this._loggerFactory.newLogger("command-result-hooks-service")).errorToTelemetry)||void 0===a||a.call(i,`App ${null==s?void 0:s.manifest.name} failed to execute entity command hook 'OnAfterCommandResolved' with ""${e.name}"" error`,"entity_command_hook",{errors:`${e.name}`},!0)}}}var xw=n(988645),Lw=n(644174),Uw=n(351497);function Bw(e){return function(e){const t=Ww(e),n=1,i=2,a=3;if(!t)return e;if(t[a])return t[n].replace(t[i],t[a]);return t[n]}(e)}function jw(e){return e.message&&(e.message=Bw(e.message)),e.stack&&(e.stack=function(e){if(Ww(e.message))return"Sanitized due to potential PII leaks.";return e.stack}(e)),e}function Ww(e){return new RegExp(/(Can't find field ((chat)\(.*\)|.*) on object)/).exec(e)}const Vw=/-extension:\/\//;function Hw(e){return e===De.jK.TimedOut}class $w{constructor(e,t,n,a,o,r){this.host=e,this.scenarioFactory=t,this.platformService=n,this.networkStateProvider=a,this.diagnosticsService=o,this.coreSettings=r,this._onWindowError=e=>{if(function(e){return e&&("resizeobserver loop limit exceeded"===e.message.toLowerCase()||Vw.test(e.filename))}(e))return!0;const{colno:t,filename:n,lineno:i,message:a}=e;let{error:o}=e;const r=!!o&&Hw(o.code);return o=o?jw(o):new Error(Bw(a)),this._reportError(ft.RG.GlobalWindowError,Object.assign(o,{colno:t,filename:n,lineno:i}),De.jK.UndefinedWindowError,r),!0},this._onUnhandledPromiseRejection=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{reason:t}=e,n=!!t&&Hw(t.code);return this._reportError(ft.RG.UnhandledRejection,t,De.jK.UnhandledPromiseRejection,n)})),e.addEventListener(vb.cr.UnhandledRejection,this._onUnhandledPromiseRejection),e.addEventListener(vb.cr.GlobalWindowError,this._onWindowError)}dispose(){this.host.removeEventListener(vb.cr.UnhandledRejection,this._onUnhandledPromiseRejection),this.host.removeEventListener(vb.cr.GlobalWindowError,this._onWindowError)}set error(e){this.persistDiagnostics(),void 0!==e&&(this._error=e,this._reportError(ft.RG.FatalError,e,De.jK.UndefinedGlobalError,!0))}get error(){return this._error}_reportError(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{code:o=n,context:r=""}=t||{},s=""===r?`${o}`:`${r}:${o}`,l=(0,Mn._S)((0,ta.A)((0,Mn.B9)(t)));let d="";try{d=this.extractError(t)}catch(e){d="Stringifying error failed"}const c=`[${d}]`;this.scenarioFactory.newScenario(e).fail({message:l,errorCode:s,errors:c,showOops:a,"AppInfo.NetworkState":this.networkStateProvider.isOnline()?"Online":"Offline"});let u=Promise.resolve();if(a){const e=1e3;u=(0,Rn.E)(Lw.ip.getInstance().flush(),e),this.persistDiagnostics()}const m=this.platformService.config.clientVersion;return u.catch((()=>this.diagnosticsService.pushDiagnosticsEvent(xw.i.Warn,"Could not flush telemetry logs in time",!0))).then((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{disableSendingLogsToHost:e}=this.coreSettings.get(K.J.Diagnostics);if(!e){const e=yield this.diagnosticsService.getDiagnosticsEvents(1e3);this.host.opener.postMessage(vb.rY.WindowErrored,{errorCode:s,errorDescription:l,errorMsg:d,logs:e,showOops:a,clientVersion:m})}}))))}))}extractError(e){const{scrubStackTrace:t}=this.coreSettings.get(K.J.Core),n=t?[]:[Uw.A4.SmtpAddress,Uw.A4.IPV4Address,Uw.A4.IPv6Address,Uw.A4.PhoneNumber];return(0,ta.A)(JSON.stringify(e,(0,Mn.cm)()),n)}persistDiagnostics(){this.diagnosticsService.persistDiagnostics()}}var zw,Gw=n(609330);!function(e){e.JobChange="job_change"}(zw||(zw={}));class qw{constructor(e,t,n,i,a,o,r){this._jobHandle=e,this._changes=t,this._meta=n,this._job=i,this._windowId=o,this._correlationId=r,this._timing={received:0,started:0,completed:0,canceled:0},this._execution=Gw.Tf.None,this._logger=a.newLogger("Scheduled Job")}receive(){this._timing.received=Date.now(),this._execution=Gw.Tf.Received,this.reportJobChange()}execute(){if(this._execution===Gw.Tf.Canceled)return;if(this._execution!==Gw.Tf.Received)throw new Error("Unable to execute a job that has not been received");let e;this._timing.started=Date.now(),this._execution=Gw.Tf.Started;try{this.reportJobChange();const t=this._job();e=t instanceof Promise?t:Promise.resolve(t)}catch(t){this._logger.error(`Job with ID:${this._meta.id} failed to execute or rejected with error: ${t.message?t.message:t}`),e=Promise.reject(t)}this.complete(e)}equals(e){return this._jobHandle===e}cancel(){return this._timing.canceled=Date.now(),this._execution=Gw.Tf.Canceled,this.reportJobChange(),{meta:this._meta,job:this._job}}complete(e){const t=e=>{let t;return this._timing.completed=Date.now(),this._execution=Gw.Tf.Complete,this.isError(e)&&(t={message:e.message,code:e.code,context:e.context,name:e.name}),this.reportJobChange(t),e};e.then(t).catch(t)}isError(e){return!!e&&e instanceof Error}reportJobChange(e){this._changes.report({correlationId:this._correlationId,type:zw.JobChange,context:Object.assign(Object.assign({},this.toChangeState()),{target:"job",error:e}),windowId:this._windowId})}toChangeState(){return{handle:this._jobHandle,timing:this._timing,execution:this._execution,meta:this._meta}}}var Qw=n(744448);class Jw extends Qw.default{remove(e,t){const n=[];let i;return this.forEach((a=>{t(a,e)?i=a:n.push(a)})),i&&(this.clear(),n.forEach((e=>this.enqueue(e)))),i}}const Yw=(e,t)=>e.equals(t),Kw=()=>0;class Zw{constructor(e,t,n,i){this._jobExecutor=e,this._supportedPriority=t,this._changes=n,this._loggerFactory=i,this._logger=i.newLogger("GreedyJobExecutionQueue"),this._queue=new Jw(Kw)}clearExecutionSchedule(){this._jobExecutor.clearExecutionSchedule(),this._queue.clear()}cancel(e){const t=this._queue.remove(e,Yw);return t&&t.cancel()}enqueue(e,t,n,i,a){if(n.priority!==this._supportedPriority)return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job priroty [${Gw.vW[n.priority]}] not supported by this queue, this queue supports [${Gw.vW[this._supportedPriority]}]`,"webclient_framework_foundation_core_services_scheduling",void 0,!0),!1;const o=new qw(e,this._changes,n,t,this._loggerFactory,i,a);return this._queue.enqueue(o)?(o.receive(),this._jobExecutor.scheduleExecution({getJob:()=>this._queue.dequeue()}),!0):(this._logger.errorToTelemetry&&this._logger.errorToTelemetry("PriorityQueue did not enqueue the job","webclient_framework_foundation_core_services_scheduling",void 0,!0),!1)}}class Xw{constructor(e,t,n){this._schedule=e,this._clearSchedule=t,this._logger=n}clearExecutionSchedule(){this._executionHandle&&this._clearSchedule(this._executionHandle)}scheduleExecution(e){this._executionHandle||(this._executionHandle=this._schedule((()=>{this._executionHandle=void 0,this.execute(e)})))}execute({getJob:e}){let t;for(;t=e();)try{t.execute()}catch(e){this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job executor caught an exception executing a job. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}}}class eN{constructor(e,t,n,i){this._changes=e,this._loggerFactory=n,this._windowId=i,this._logger=n.newLogger("Scheduler"),this._queues=new Map,this.createQueues(t)}destroy(){this._queues.forEach((e=>{e.clearExecutionSchedule()}))}schedule(e,t,n){const i=this._queues.get(t.priority);if(!i)return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(`Job priority [${Gw.vW[t.priority]}] supplied by ${t.scheduledById} not supported by scheduling`,"webclient_framework_foundation_core_services_scheduling",void 0,!0),Gw.o_;const a=eN.nextJobHandle;return i.enqueue(a,e,t,this._windowId,n),a}cancel(e){let t;if(e===Gw.o_)return t;const n=Array.from(this._queues.values());for(const i of n)if(t=i.cancel(e),t)break;return t}createQueues(e){this.createQueue(Gw.vW.Macro,(t=>e.setTimeout(t)),(t=>e.clearTimeout(t))),this.createQueue(Gw.vW.RenderBlocking,(t=>e.requestAnimationFrame(t)),(t=>e.cancelAnimationFrame(t)))}createQueue(e,t,n){const i=new Xw(t,n,this._logger),a=new Zw(i,e,this._changes,this._loggerFactory);this._queues.set(e,a)}static get nextJobHandle(){return this._nextJobHandle===Number.MAX_SAFE_INTEGER&&(this._nextJobHandle=0),this._nextJobHandle++,this._nextJobHandle}}eN._nextJobHandle=0;const tN=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const[i,o]=yield Promise.all([t.getUser({correlation:n}),nN(t,n,a)]);if(o)for(const t of o)e.setContext("UserInfo.IsMRU",void 0,void 0,t.id);e.setContext("UserInfo.IsMRU",!0,void 0,i.id)})),nN=(e,t,n)=>{if(n)return Promise.resolve(n);const i=e.getCachedUsers;return i?i(t):void 0},iN=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,r,s;const l={id:a.id,source:a.source,scenarioName:ft.RG.AuthWebUser};try{const[a,o]=yield Promise.all([null===(i=n.getCachedUsers)||void 0===i?void 0:i.call(n,l,{isAllCachedUsers:!0}),null===(r=n.getCachedUsers)||void 0===r?void 0:r.call(n,l,{isPrimaryUser:!0})]);if(tN(t,n,l,a),Array.isArray(a)){for(const e of a)t.setContext("UserInfo.IsPrimary",void 0,void 0,e.id);const e=a.filter((e=>e.profile.isHomeAccount)).length;t.setCoreContext("uniqueCredentialCount",e),t.setCoreContext("mtmaAccounts",a.length)}if(Array.isArray(o)){const[n,i]=o;e?t.setContext("UserInfo.IsPrimary",!0,void 0,n.id):(t.setCoreContext("primaryUserInfoId",n.profile.oid),t.setCoreContext("primaryUserInfoTenantId",n.profile.tid))}}catch(e){null===(s=o.errorToTelemetry)||void 0===s||s.call(o,"Failed to update MRU or sync mtma context","telemetry_instrumentation_update_user_context")}})),aN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"performWindowHistoryNavigation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NavigationDirection"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"performWindowHistoryNavigation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"navigationDirection"},value:{kind:"Variable",name:{kind:"Name",value:"navigationDirection"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},oN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"navigateToWindowHistoryIndex"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"windowHistoryIndex"},value:{kind:"Variable",name:{kind:"Name",value:"windowHistoryIndex"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};class rN{constructor(e,t,n,a){this._client=e,this._host=t,this._coreSettings=n,this._windowId=a,this.onPopState=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;this.navigateTo((null===(t=e.state)||void 0===t?void 0:t.windowHistoryIndex)||0)}))}init(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.addEventListener("popstate",this.onPopState)}))}destroy(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.hostHistoryNavigationEnabled&&this._host.removeEventListener("popstate",this.onPopState)}))}navigate(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.mutate(aN,{navigationDirection:e})}))}navigateTo(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.mutate(oN,{windowHistoryIndex:e})}))}get hostHistoryNavigationEnabled(){var e;return(null===(e=this._coreSettings.get(K.J.Core))||void 0===e?void 0:e.enableHostHistoryNavigation)||!1}mutate(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this._client.mutate({mutation:e,variables:Object.assign(Object.assign({},t),{windowId:this._windowId}),fetchPolicy:"no-cache"})}))}}var sN=n(92293);const lN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},dN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"windowStateEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowStateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isFocused"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"shouldClose"}}]}}]}}]};class cN{report(e){if(!this._changes||0===this._changes.observers.length)return;const t=e.changeCorrelationId||(0,mt.v4)();this.changes.next(Object.assign(Object.assign({},e),{changeCorrelationId:t}))}observeChanges(){return this.changes.asObservable()}get changes(){return this._changes||(this._changes=new gC.xQ),this._changes}}class uN{constructor(e,t){this.parentContext=e,this.pulsarLibraryInstance=t}startSignal(e,t){return this.pulsarLibraryInstance.startSignal(e,t,this.parentContext)}}class mN{constructor(e,t,n,i){this.logger=e,this.span=t,this.pulsarLibraryInstance=i,this.pulsarLibraryInstance.otlDependencies?this.signalContext=this.pulsarLibraryInstance.otlDependencies.trace.setSpan(n,t):this.logger.error("PulsarSignal: otlDependencies is not defined")}stop(e){this.span.setStatus(e),this.span.end()}appendEventData(e,t){this.span.setAttributes(mN.eventDataToAttributes(e,t))}addEvent(e){this.span.addEvent(e)}getPulsarContext(){return new uN(this.signalContext,this.pulsarLibraryInstance)}propagate(){if(!this.signalContext)return void this.logger.error("propagate: signalContext is not defined");const{W3CTraceContextPropagator:e,defaultTextMapSetter:t}=this.pulsarLibraryInstance.otlDependencies,n={};return(new e).inject(this.signalContext,n,t),n}static eventDataToAttributes(e,t){const n={};return Object.keys(t).forEach((i=>{n[`${e}.${i}`]=t[i]})),n}}var gN,pN,vN;!function(e){e.TEAMS_CORE="Teams.Core",e.TEAMS_RENDERING="Teams.Rendering",e.TEAMS_RESOLVER="Teams.Resolver"}(gN||(gN={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(pN||(pN={})),function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(vN||(vN={}));class hN{constructor(e,t){this.exporter=e,this.otlDependencies=t,this._shutdownOnce=new this.otlDependencies.BindOnceFuture(this._shutdown,this)}forceFlush(){return Promise.resolve()}onStart(e){this.export(e,"onStart")}onEnd(e){this._shutdownOnce.isCalled||0!=(e.spanContext().traceFlags&vN.SAMPLED)&&this.export(e,"onEnd")}shutdown(){return this._shutdownOnce.call()}export(e,t){const{context:n,suppressTracing:i,ExportResultCode:a,globalErrorHandler:o}=this.otlDependencies;n.with(i(n.active()),(()=>{this.exporter.export([e],(e=>{var t;e.code!==a.SUCCESS&&o(null!==(t=e.error)&&void 0!==t?t:new Error(`PulsarSpanProcessor: span export failed (status ${e})`))}),t)}))}_shutdown(){return this.exporter.shutdown()}}var fN=n(117772);class yN{constructor(e,t){this.serviceName=e,this.config=t,this.consumerNotificationObserver=new gC.xQ,this.logger=t.loggerFactory.newLogger("PulsarLib"),this.sessionId=t.sessionId}initialize(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield this.importOTLDependencies(),this.initOTL()}))}shutdown(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield null===(e=this.provider)||void 0===e?void 0:e.shutdown()}))}startSignal(e,t,n){if(!this.tracer)return void this.logger.error("startSignal: tracer is not initialized");const i=n||this.otlDependencies.ROOT_CONTEXT,a=this.tracer.startSpan(e,t,i);return a.setAttribute("sessionId",this.sessionId),new mN(this.logger,a,i,this)}startSignalFromCarrier(e,t,n){if(!t)return;if(!this.otlDependencies)return void this.logger.error("startSignalFromCarrier: OTL dependencies are not initialized");const{W3CTraceContextPropagator:i,ROOT_CONTEXT:a,defaultTextMapGetter:o}=this.otlDependencies,r=(new i).extract(a,t,o);return this.startSignal(e,n,r)}observeConsumerNotifications(){return this.consumerNotificationObserver.asObservable()}initOTL(){if(!this.otlDependencies)return void this.logger.error("initOTL: OTL dependencies are not initialized");const{WebTracerProvider:e,Resource:t,SemanticResourceAttributes:n,SimpleSpanProcessor:i,OTLPTraceExporter:a}=this.otlDependencies;this.provider=new e({resource:new t({[n.SERVICE_NAME]:this.serviceName})}),this.config.spanExporter.registerConsumerNotificationCallback((e=>{this.consumerNotificationObserver.next(e)})),this.provider.addSpanProcessor(new hN(this.config.spanExporter,this.otlDependencies)),this.config.logToOTLCollector&&this.provider.addSpanProcessor(new i(new a({url:"http://localhost:4318/v1/traces"}))),this.tracer=this.provider.getTracer("pulsar-tracer")}importOTLDependencies(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.otlDependencies=yield(0,fN.m)()}))}}class kN{constructor(){this.hasShutdown=!1,this.telemetryProvider=(0,DC.G)(),this.telemetryProvider.registerPulsarBackchannelListener(this.notify.bind(this))}export(e,t,n){this.hasShutdown||e.forEach((e=>{switch(n){case"onStart":this.telemetryProvider.sendPulsarSignal({type:"onStart",span:this.sanitizeSpan(e)});break;case"onEnd":this.telemetryProvider.sendPulsarSignal({type:"onEnd",span:this.sanitizeSpan(e)})}}))}registerConsumerNotificationCallback(e){this.consumerNotificationCallback=e}shutdown(){return this.hasShutdown=!0,Promise.resolve()}notify(e){var t;null===(t=this.consumerNotificationCallback)||void 0===t||t.call(this,e)}sanitizeSpan(e){return Object.assign(Object.assign({},e),{_spanProcessor:void 0,_clock:void 0})}}const SN=(e,t,n)=>{const{enableThemePreferenceResolution:i}=t.get(K.J.Core),{environment:a}=t.get(K.J.Metadata);if(i){const t=(0,sN.R6)(null!=a?a:Sb.s.prod);return(0,sN.u_)(e,n,t)}return t.get(K.J.Host).theme||"default"},bN=(e,t)=>e.subscribe({query:dN,variables:{windowId:t}}),CN=(e,t,n,i,a,o,r)=>{const{isFocused:s,shouldClose:l,correlation:d}=e&&e.data&&e.data.windowStateEvent;let c;const u=null==d?void 0:d.id;l?(t.close(),r.log(`host.close() called through window state event with correlationId ${u}`),c=GS.B.Close):s&&(t.isFocused()?(r.log(`host.isFocused() returns true with correlationId ${u}`),c=GS.B.AlreadyFocused):(t.focus(),r.log(`host.focus() called through window state event with correlationId ${u}`),c=GS.B.Focus,o.loadModule("windowcontrols").then((e=>{var t;null===(t=null==e?void 0:e.focus)||void 0===t||t.call(e,n),r.log(`HostComms focus() called through window state event with correlationId ${u}`)})))),c&&u&&(i.report({context:{target:"handle-window-state-event"},correlationId:u,type:c}),a.report({type:bb.FV.WindowStateChange,context:{target:"context-providers-handle-window-event"},correlationId:u,windowId:n}))},wN=(e,t)=>(0,aS.U)((n=>((e,t,n)=>(n&&(e._cleanupFns||(e._cleanupFns=[]),e._cleanupFns.push(n)),Object.assign(Object.assign({},e),t)))(n,e(n),t))),NN=e=>wN((t=>({regenerateEntityCommandingServices:(n,i,a)=>(({appsRegistryService:e,client:t,clientLaunchId:n,commandChangeReportingService:i,coreSettings:a,deeplinkService:o,hostCommunicationService:r,loggerFactory:s,platformService:l,scenarioFactory:d,userContextId:c,viewEntitiesRef:u,viewEntity:m,viewEntityName:g,windowId:p,windowProvider:v,userBiService:h})=>Rw((o=>kC({appsRegistryService:e,client:t,clientLaunchId:n,commandChangeReportingService:i,coreSettings:a,entityCommandInput:o,loggerFactory:s,platformService:l,scenarioFactory:d,windowId:p,executionContext:{userContextId:c,viewEntity:m,viewEntityName:g},windowProvider:v,userBiService:h})),((o,r)=>Fb({appsRegistryService:e,client:t,clientLaunchId:n,commandChangeReportingService:i,coreSettings:a,commandInput:o,commandHandler:r,loggerFactory:s,scenarioFactory:d,windowId:p,executionContext:{userContextId:c,viewEntitiesRef:u,viewEntity:m,viewEntityName:g},host:v,userBiService:h})),((o,r,l)=>Ob({appsRegistryService:e,client:t,clientLaunchId:n,commandChangeReportingService:i,coreSettings:a,eventInput:o,commandDelegator:l,commandHandler:r,loggerFactory:s,scenarioFactory:d,userBiService:h,windowId:p,executionContext:{userContextId:c,viewEntitiesRef:u,viewEntity:m,viewEntityName:g}})),t,a,v,d,s,o,r,c,p,m,n))({appsRegistryService:t.appsRegistryService,client:t.client,clientLaunchId:t.correlation.clientLaunchId||void 0,commandChangeReportingService:t.commandChangeReportingService,coreSettings:t.coreSettings,deeplinkService:t.deeplinkService,hostCommunicationService:t.hostCommunicationService,loggerFactory:t.loggerFactory,platformService:t.platformService,scenarioFactory:t.scenarioFactory,userContextId:t.authenticationUser?(0,li.b)(t.authenticationUser):void 0,viewEntitiesRef:n,viewEntity:i,viewEntityName:a,cdlWorkerRegistrarService:t.cdlWorkerRegistrarService,windowId:e,windowProvider:t.windowProvider,userBiService:t.userBiService})}))),TN=(e,t,n,i,a,o,r)=>e.pipe((e=>e.pipe((e=>wN((()=>({windowProvider:e}))))(a),(e=>wN((t=>({loggerFactory:new hS.m(t.diagnosticsService,e)}))))(n),((e,t)=>wN((({loggerFactory:n})=>({scheduler:new eN(new cN,t,n,e)})),(({scheduler:e})=>e.destroy())))(n,a),((e,t)=>wN((n=>{const i=n.windowProvider.viewportContext,a=t.type,o=n.coreSettingsContext.createContextForViewport({id:e,viewportContext:i,entityType:a}),r=o.getCoreSettings();return{coreSettingsContext:o,coreSettings:r}}),(({coreSettingsContext:e})=>e.cleanup())))(n,r),(e=>wN((()=>({scenarioFactory:e})),(({scenarioFactory:e})=>e.destroy())))(t),(e=>wN((t=>({userBiService:t.telemetryService.createUserBiService(t,e,{id:t.correlation.id,startTimestamp:+t.correlation.startTimestamp||0,source:t.correlation.source})})),(({userBiService:e})=>e.destroy())))(n),((e,t)=>wN((({experienceChangeReportingService:n,authenticationUser:i})=>({experienceChangeReportingService:Object.assign(Object.assign({},n),{report:a=>{n.report(Object.assign({windowId:e,isMainWindow:t,userContextId:i?(0,li.b)(i):void 0},a))}})}))))(n,i),((e,t)=>wN((({appBarService:n,appsRegistryService:i,appStateService:a,authenticationService:o,authenticationUser:r,cacheStorage:s,cdlWorkerService:l,client:d,clientPreferences:c,clientState:u,commandChangeReportingService:m,coreSettings:g,dataCleanupService:p,discover:v,experienceChangeReportingService:h,hostCommunicationService:f,localStorage:y,loggerFactory:k,offlineCacheManager:S,platformService:b,rebootService:C,scenarioFactory:w,user:N,userBiService:T,windowProvider:I,i18n:E,brbServiceManager:A,entityCommanding:_,pulsar:D,cdlAppStateService:F})=>{var M,R;const P=d,O={appBarService:n,appsRegistryService:i,appStateService:a,authenticationService:o,authenticationUser:r,cacheStorage:s,cdlWorkerService:l,clientPreferences:c,clientState:u,commandChangeReportingService:m,coreSettings:g,dataCleanupService:p,discover:v,entityType:t,experienceChangeReportingService:h,hostCommunicationService:f,localStorage:y,loggerFactory:k,offlineCacheManager:S,platformService:b,pubsub:P.getServices().pubsub,rebootService:C,scenarioFactory:w,user:N,userBiService:T,windowId:e,windowProvider:I,i18n:E,brbServiceManager:A,entityCommanding:_,pulsar:D,cdlAppStateService:F},{enableViewSchema:x}=g.get(K.J.Core);return{client:P.clone(O),viewSchemaClient:x?null===(R=(M=P).cloneForViewSchema)||void 0===R?void 0:R.call(M,O):null}}),(({client:e,entityCommanding:t,viewSchemaClient:n,coreSettings:i})=>(null==n||n.destroy(),e.destroy(),i.get(K.J.Core).enableMTMA&&(null==e||e.clearCache()),t.destroy()))))(n,r.type))),(e=>e.pipe(((e,t)=>wN((n=>{var i;const{appsRegistryService:a,authenticationUser:o,client:r,commandResultChangeReportingService:s,coreSettings:l,correlation:{clientLaunchId:d},deeplinkService:c,hostCommunicationService:u,loggerFactory:m,scenarioFactory:g}=n,{entityCommanding:p,eventing:v}=Rw((t=>kC({appsRegistryService:n.appsRegistryService,client:n.client,clientLaunchId:n.correlation.clientLaunchId||void 0,commandChangeReportingService:n.commandChangeReportingService,coreSettings:n.coreSettings,entityCommandInput:t,loggerFactory:n.loggerFactory,platformService:n.platformService,scenarioFactory:n.scenarioFactory,executionContext:{userContextId:n.authenticationUser?(0,li.b)(n.authenticationUser):void 0},windowId:e,userBiService:n.userBiService}).then()),((i,a)=>Fb({appsRegistryService:n.appsRegistryService,client:n.client,commandChangeReportingService:n.commandChangeReportingService,coreSettings:n.coreSettings,commandInput:i,commandHandler:a,loggerFactory:n.loggerFactory,scenarioFactory:n.scenarioFactory,windowId:e,host:t,userBiService:n.userBiService})),((t,i,a)=>Ob({appsRegistryService:n.appsRegistryService,client:n.client,commandChangeReportingService:n.commandChangeReportingService,commandDelegator:a,commandHandler:i,coreSettings:n.coreSettings,eventInput:t,loggerFactory:n.loggerFactory,scenarioFactory:n.scenarioFactory,userBiService:n.userBiService,windowId:e})),r,l,t,g,m,c,u,o?(0,li.b)(o):void 0,e,void 0,d||void 0);let h=n.commandResultHooksService;return h&&(null===(i=l.get(K.J.Core))||void 0===i?void 0:i.enableStandaloneCommandReportingService)&&(h=new Ow(a,r,s,l,p,m,g,n.authenticationUser&&(0,li.b)(n.authenticationUser)),h.init()),{entityCommanding:p,eventing:v,commandResultHooksService:h}}),(({commandResultHooksService:e})=>null==e?void 0:e.destroy())))(n,a),wN((e=>({errorState:new $w(e.windowProvider,e.scenarioFactory,e.platformService,e.networkState,e.diagnosticsService,e.coreSettings)})),(({errorState:e})=>e.dispose())),(e=>wN((()=>({clientState:e}))))(o),NN(n),(e=>wN((t=>{const n=new rN(t.client,t.windowProvider,t.coreSettings,e);return n.init(),{windowHistoryNavigationService:n}}),(({windowHistoryNavigationService:e})=>e.destroy())))(n),wN((e=>{const{enablePulsarTelemetry:t,logToOTLCollector:n}=e.coreSettings.get(K.J.Pulsar),i=new yN(gN.TEAMS_RENDERING,{sessionId:e.platformService.host.sessionId,spanExporter:new kN,loggerFactory:e.loggerFactory,logToOTLCollector:!!n});return t&&i.initialize(),{pulsar:i}}),(({pulsar:e})=>e.shutdown())))),(e=>e.pipe(((e,t)=>wN((n=>{var i;return n.experienceLifecycleManager.manageWindow(e,null===(i=n.authenticationUser)||void 0===i?void 0:i.id,Object.assign(Object.assign({},n),{isMainWindow:t})),{}}),(t=>t.experienceLifecycleManager.removeWindow(e,"window_closed"))))(n,i)))),IN=(e,t,n,i,a,o,r,s)=>{const l=r.pipe((0,yb.g)("userContextId"),(0,kb.w)((({userContextId:e,correlation:t})=>s(e||void 0).pipe((0,aS.U)((e=>({context:e,correlation:t})))))),(0,yb.g)("context"),(0,lS.b)((({context:e,correlation:t})=>o&&EN(e,t))),(0,aS.U)((({context:e,correlation:t})=>Object.assign(Object.assign({},e),{correlation:t}))));return TN(l,e,t,o,n,i,a)},EN=(e,t)=>{var n,i,a,o;const{coreSettings:r,cdlWorkerRegistrarService:s}=e,l=null===(n=null==r?void 0:r.get(K.J.Core))||void 0===n?void 0:n.enableMTMA,d=!!(null===(i=null==r?void 0:r.get(K.J.CdlWorker))||void 0===i?void 0:i.enableUserContextWorkerRegistration),c={id:t.id,source:t.source,scenarioName:t.scenarioName||"auth_switch_account"};e.authenticationUser&&l&&(null===(o=(a=e.authenticationService).updateMostRecentUser)||void 0===o||o.call(a,{accountId:(0,li.b)(e.authenticationUser),correlation:c}).then((()=>{c.scenarioName=ft.RG.AuthWebUser,tN(e.telemetryContextService,e.authenticationService,c)})).then((()=>{d&&e.authenticationUser&&s.setMainWindowWorkerByUserId((0,li.b)(e.authenticationUser))})))},AN=(e,t,n)=>{n.log(`Removing window ${e} from apollo cache`),t.client.mutate({mutation:lN,variables:{windowId:e}}).catch((e=>n.error("Error in removing window: ",e)))},_N=(e,t,n,i,a="")=>{var o;return e.telemetryService.createScenarioFactory(e,t,{id:n.id,startTimestamp:parseInt(n.startTimestamp,10)||0,source:n.source},null!==(o=n.clientLaunchId)&&void 0!==o?o:void 0,i,a)},DN=(e,t)=>e.markStep(ft.RG.WindowLaunchTime,t);var FN=n(584487);const MN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"setWindowFullscreen"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isFullscreen"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setWindowFullscreen"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"isFullscreen"},value:{kind:"Variable",name:{kind:"Name",value:"isFullscreen"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};const RN=(e,t)=>e.opener.postMessage(vb.Gx.Destroy,{windowId:t});function PN(e,t,n,a,o,r,s,l){return(0,i.__awaiter)(this,void 0,void 0,(function*(){DN(a,ft.ck.BeginWindowCreation);const i=e.windowProvider;if(t===De.ew)return i;const d=yield function(e,t,n,i){return new Promise(((a,o)=>{const r=e.setTimeout((()=>{o("New Frame did not report in 10000ms")}),1e4),s=e.self;return s.frameResolvers=s.frameResolvers||{},s.frameResolvers[t]=n=>{e.clearTimeout(r),VN(e,t),a(n)},e.opener.postMessage(vb.Gx.Create,{windowId:t,correlation:n,activeEntities:i})}))}(i,t,o,l);if(!d)return i;const c=(0,FN.dP)(d,e,t,r,s),u=c.getHostedWindowContext();return Object.assign(c,{getHostedWindowContext:()=>Object.assign(Object.assign({},u),{windowId:t}),viewportContext:hb.R.iFrame}),DN(a,ft.ck.EndWindowCreation),xN(c,e,t,n),c.close=()=>RN(i,t),c}))}function ON(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{window:n,subscription:i,clientState:a}=yield e,o=null===(t=n.location.hash)||void 0===t?void 0:t.slice(1);o?RN(n,o):n.close(),i&&i.unsubscribe(),a&&a.dispose()}))}const xN=(e,t,n,i,a)=>{const o="onpagehide"in e?"pagehide":"unload",r=e.onFullscreen().subscribe((e=>{t.client.mutate({mutation:MN,variables:{isFullscreen:e,windowId:n}})})),s=()=>{AN(n,t,i),a&&a(),e.removeEventListener(o,s),r.unsubscribe()};e.addEventListener(o,s)},LN=({id:e,activeEntities:t},n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{window:i,context$:a}=yield n;return{id:e,window:i,context$:a,activeEntities:t}})),UN=(e,t,n)=>(0,nS.z)(SS((a=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return jN(a,e,t,n)}))),ON,LN,((e,n)=>((e,t,n)=>{const i=n.loggerFactory.newLogger("IframeStateManager");i.error(`Creation for window ${e.id} failed with ${t}. Removing window from cache`),n.commandChangeReportingService.report({context:{target:"iframe-state-manager",errorInfo:qS.y.CreateWindowError},correlationId:e.correlation.id,type:GS.B.Failure}),AN(e.id,n,i)})(e,n,t)))),BN=(e,t,n,a,o,r,s,l,d,c,u)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return e&&t?Promise.resolve(((e,t,n,i,a,o,r)=>{const s=t.windowProvider,l=s.open(void 0,e,"width=600px,height=500px,toolbar=no,menubar=no,location=no");if(r){const{clientPreferences:e,coreSettings:n}=t,i=r({theme:SN(e,n,s),viewportContext:hb.R.iFrame});l.document.write(i),l.document.close()}const d=()=>{const e=new URL(s.location.href);e.searchParams.append("random",Date.now().toString()),e.hash=[s.location.pathname,i.mainEntity.type,encodeURIComponent(i.mainEntity.id)].join("/"),l.location.href=decodeURIComponent(e.href)};s.addEventListener("unload",d);let c=(0,FN.dP)(l,t,e,a,o);return c=Object.assign(c,{getHostedWindowContext:()=>({startReason:fb.zF.userInitiated,panelContext:fb.QP.secondary})}),xN(c,t,e,n,(()=>{s.removeEventListener("unload",d)})),c})(a,n,o,l,d,c,u)):PN(n,a,o,r,s,d,c,l)})),jN=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{id:i,correlation:o,activeEntities:r,isMainWindow:s,layoutConfig:{layoutMode:l}}=e,{coreSettings:d}=n,c=o.source===Ot.D.PopOutButton,{enablePopOutChats:u}=d.get(K.J.Messaging),m=new hS.m(n.diagnosticsService,i),g=m.newLogger("IframeStateManager"),p=Object.assign(Object.assign({},n),{loggerFactory:m}),v=_N(p,i,o,hb.R.iFrame);return WN(t,p,g,i,o,r,c,u,v,s,l,a)})),WN=(e,t,n,a,o,r,s,l,d,c,u,m)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=yield BN(l,s,t,a,n,d,o,r,c,u,m),g=bN(t.client,a).subscribe((e=>CN(e,i,a,t.commandChangeReportingService,t.experienceChangeReportingService,t.hostCommunicationService,n))),p=t.clientState.getChildWindowStateProvider(i,t.loggerFactory,t.coreSettings),{mainEntity:v}=r,h=HN(i,a,c,g,p,e,d,o,v);return DN(d,ft.ck.WindowContextProvider),h})),VN=(e,t)=>e.opener.postMessage(vb.Gx.Acquired,{windowId:t}),HN=(e,t,n,i,a,o,r,s,l)=>({window:e,subscription:i,clientState:a,context$:TN(o(void 0).pipe((0,aS.U)((e=>Object.assign(Object.assign({},e),{correlation:s})))),r,t,n,e,a,l)});var $N=n(558388),zN=n(697950);const GN=(e,t,n)=>{e.opener.postMessage(vb.rY.ShouldShowChatNotification,{shouldShowChatNotification:t,windowId:n})};var qN=n(365380),QN=n(226568),JN=n(651459),YN=n(70404),KN=n(659387),ZN=n(389957);const XN=(e,t)=>!!(e===t||!e&&!t||e&&t&&e.id===t.id&&e.type===t.type&&e.action===t.action);function eT(e,t){var n,i;if(!t||!t.activeEntities)return!1;const a=null===(n=t.activeEntities)||void 0===n?void 0:n.mainEntity,o=null===(i=e.activeEntities)||void 0===i?void 0:i.mainEntity;return!XN(o,a)&&!function(e,t){const n=["subNavEntity","headerEntity","startEntity","mainEntity","endEntity"];for(const i of n)if(e[i]||t[i])return XN(e[i],t[i]);return!1}(e.activeEntities,t.activeEntities)}const tT=e=>({isChanged:nT,execute:t=>{e.dataCleanupService.markDataForWindowAsInactive(t.id)}});function nT(e,t){return function(e){var t;return!!e.isMainWindow&&(null===(t=e.layoutConfig)||void 0===t?void 0:t.layoutMode)===c.lO.standard}(e)&&function(e,t){var n,i;if(!t||!t.activeEntities)return!1;const a=null===(n=t.activeEntities)||void 0===n?void 0:n.mainEntity,o=null===(i=e.activeEntities)||void 0===i?void 0:i.mainEntity;return!XN(o,a)}(e,t)}const iT=e=>({isChanged:(e,t)=>!e.isMainWindow&&eT(e,t),execute:(t,n)=>function(e,t,n){var i;const a=t.activeEntities.mainEntity,o=null==n?void 0:n.activeEntities.mainEntity,r=e.appsRegistryService.getApp({entityType:a.type});if(!r)throw new Error("Entity does not match to an existing app");const s=null===(i=r.getAppWindowFeatures)||void 0===i?void 0:i.call(r,{coreServices:e,host:t.window,isResize:!0,prevEntityType:null==o?void 0:o.type,entityType:null==a?void 0:a.type});if(!s)return;const{width:l,height:d,minWidth:c,minHeight:u}=s,{window:m}=t;e.loggerFactory.newLogger("WindowResizeCommand").log(`From ${null==o?void 0:o.type} of height ${m.innerHeight} and width ${m.innerWidth}, to ${a.type} of height ${d} and width ${l}`),c&&u&&(m.setMinimumSize&&m.setMinimumSize(c,u),e.hostCommunicationService.loadModule("windowcontrols").then((e=>{var n;return null===(n=null==e?void 0:e.setMinimumWindowSize)||void 0===n?void 0:n.call(e,t.id,c,u)})));l&&d&&(m.setBounds&&m.setBounds({x:m.screenX,y:m.screenY,width:l,height:d}),e.hostCommunicationService.loadModule("windowcontrols").then((e=>{var n;return null===(n=null==e?void 0:e.setWindowBounds)||void 0===n?void 0:n.call(e,t.id,m.screenX,m.screenY,l,d)})))}(e,t,n)});const aT=e=>({isChanged:(e,t)=>!(!e.isMainWindow||e.layoutConfig&&e.layoutConfig.layoutMode!==c.lO.standard||e.userContextId===(null==t?void 0:t.userContextId)),execute:t=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var n;if((0,KN._)(e.coreSettings,e.platformService)){const i=yield e.hostCommunicationService.loadModule("core");null===(n=null==i?void 0:i.setUserContextIdOnWindow)||void 0===n||n.call(i,t.userContextId,t.id)}}))});const oT=(e,t)=>{switch(t){case L.lOW.standard:return(0,YN.ZN)(e,"window",fb.d.main);case L.lOW.minimal:return(0,YN.ZN)(e,"window",fb.d.flyout);default:return e}},rT=(e,t,n,a,o,r,s,l,d,c,u,m,g,p)=>{var v,h;let f="",y="about:blank";const{coreSettings:k,platformService:S}=t;y=S.config.clientType!==Ye.Bh.Web?(0,YN.ZN)(y,"entityType",s.type):y;const b={url:y,windowId:n,windowFeatures:f,globalWindow:e,coreServices:t,logger:a,scenarioFactory:o,windowState:r,isMainWindow:d,layoutMode:c,userContextId$:m,templateGenerator:p};if(S.config.clientType===Ye.Bh.Maglev){const{addWindowIdQsp:e,enableTitleBarOverlayDuringLaunch:i}=t.coreSettings.get(K.J.Core);e&&(y=(0,YN.ZN)(y,"windowId",n));const a=m.value.userContextId;if((0,KN._)(k,S)&&a&&(y=(0,YN.ZN)(y,"userContextId",a)),i&&(y=(0,YN.ZN)(y,"customframetitlebarmode","fullwidth")),y=((e,t)=>t?(0,YN.ZN)(e,"show","false"):e)(y,u),d){if(c===L.lOW.standard){const{flushViewSchemaClient:e}=t.coreSettings.get(K.J.Core);e&&(null===(h=null===(v=t.client)||void 0===v?void 0:v.viewSchemaClient)||void 0===h||h.clearStore()),y=(0,YN.ZN)(y,"customframetheme","main")}return sT(Object.assign(Object.assign({},b),{url:oT(y,c)}))}y=(0,YN.ZN)(y,"customframetheme","default")}return({url:y,windowFeatures:f}=function(e,t,n,a,o,r,s){var l;const d=e.appsRegistryService.getApp({entityType:n});if(!d)throw new Error("Entity does not match to an existing app");const c=(null===(l=d.getAppWindowFeatures)||void 0===l?void 0:l.call(d,{coreServices:e,host:t,screenState:o,windowOptions:a,entityType:n}))||{},{additionalFeatures:u={}}=c,m=(0,i.__rest)(c,["additionalFeatures"]);let g=Object.keys(m).reduce(((e,t)=>`${e}${e?",":""}${t}=${m[t]}`),"");return g=e.platformService.config.clientType===Ye.Bh.Web?`${g},toolbar=no,menubar=no,location=no`:g,s=Object.keys(u).reduce(((e,t)=>u?(0,YN.ZN)(e,t,u[t]):e),s),r.log(`windowFeatures: ${g}, url: ${s}`),{url:s,windowFeatures:g}}(t,e,s.type,null!=g?g:s.windowOptions,l,a,y)),sT(Object.assign(Object.assign({},b),{url:y,windowFeatures:f}))},sT=({url:e,windowId:t,windowFeatures:n,globalWindow:i,coreServices:a,logger:o,scenarioFactory:r,windowState:s,isMainWindow:l,layoutMode:d,userContextId$:c,templateGenerator:u})=>{const m=i.open(e,t,n||void 0);if(!m)throw new zS.G(zS.$.WINDOW_UNDEFINED);const g=(0,FN.dP)(m,a,t,l,d);CT(g,t,e),o.log(`windowState: ${JSON.stringify(s)}`);const{minWidth:p=0,minHeight:v=0}=s;return g.setMinimumSize&&g.setMinimumSize(p,v),lT(i,g,a,u),DN(r,ft.ck.EndWindowCreation),dT(g,a,d,r,c,t,o),cT(a,g),g},lT=(e,t,n,i)=>{if(!i)return;if(!!t.document.getElementById("app"))return;const{clientPreferences:a,coreSettings:o,platformService:r}=n,s=r.config.clientVersion.split("/").pop(),l=nb(i({theme:SN(a,o,e),osPlatform:r.config.osPlatform,cspNonce:e.__webpack_nonce__,publicPathScript:`window.__webpack_public_path__="${r.config.publicPath}"`,containerVer:s,environment:o.get(K.J.Metadata).environment||"",viewportContext:t.viewportContext,shouldStubConsoleError:!0}));t.document.write(l),t.document.close()},dT=(e,t,n,i,a,o,r)=>{const{disableMainWindowMouseListeners:s,enableActiveWindowsHistoryRecovery:l}=t.coreSettings.get(K.J.Core),d=()=>{e.opener.postMessage(vb.rY.UnhandledMouseEvent,{type:"mousemove"})},c=()=>{e.opener.postMessage(vb.rY.UnhandledMouseEvent,{type:"click"})},u=e=>{if(!(e=>{var t,n;const i=e.target,a=null===(t=i.nodeName)||void 0===t?void 0:t.toLowerCase(),o=null===(n=i.type)||void 0===n?void 0:n.toLowerCase();return!(!i||!(i.isContentEditable||"textarea"===a||"input"===a&&/^(?:text|email|number|search|tel|url|password)$/i.test(o)))})(e))return e.preventDefault(),!1},m="onpagehide"in e?"pagehide":"unload",g=(e=>{const{disableContextMenu:t}=e.coreSettings.get(K.J.Core);return!!t})(t),p=e.onFullscreen().subscribe((e=>{t.client.mutate({mutation:MN,variables:{isFullscreen:e,windowId:o}})})),v=()=>{if(a.isStopped)return;const{correlation:{id:n},userContextId:i}=a.value;t.experienceChangeReportingService.report({correlationId:n,type:bb.FV.WindowOptionsChange,userContextId:i||void 0,windowId:o,context:{target:"window-state-manager",height:e.innerHeight,left:e.screenX,top:e.screenY,width:e.innerWidth}})},h=l&&t.platformService.config.clientType===Ye.Bh.Maglev&&n===L.lOW.focus&&o!==De.ew,f=h&&(0,$N.R)(e,"resize").pipe((0,qN.b)(500)).subscribe(v),y=h&&a.pipe((0,qN.b)(500)).subscribe(v),k=()=>{r.log(`${m} called for window ${o}`),wT(e),ST(i),AN(o,t,r),e.document.removeEventListener("mouseenter",d),e.document.removeEventListener("click",c),g&&e.removeEventListener("contextmenu",u),e.removeEventListener(m,k),r.log(`blur/unload listeners removed for windowId: ${o}`),bT(t,e,r,o),p.unsubscribe(),f&&f.unsubscribe(),y&&y.unsubscribe()};o!==De.ew||s||(e.document.addEventListener("mouseenter",d),e.document.addEventListener("click",c)),e.addEventListener(m,k),g&&e.addEventListener("contextmenu",u)},cT=(e,t)=>{var n,i;null===(i=null===(n=e.leakDetectorService)||void 0===n?void 0:n.create())||void 0===i||i.track(JN.I.UnwrappedWindow,t)},uT=(e,t,n)=>{return(0,nS.z)((0,ZN.j)((i=>mT(i,e,t,n)),(e=>vT(e,t)),hT,((e,n)=>((e,t,n)=>{let i,a;const o=n.loggerFactory.newLogger("WindowStateManager");t instanceof zS.G&&Ae.G.isFunction(t.toTelemetryEntry)?(i=t.code,a=t.toTelemetryEntry()):(i=qS.y.CreateWindowError,a=(0,Ci.u4)(t)),o.error(`Creation for window ${e.id} failed with ${a}. Removing window from cache`),n.commandChangeReportingService.report({context:{target:"window-state-manager",errorInfo:i,errorMessage:a},correlationId:e.correlation.id,type:GS.B.Failure}),AN(e.id,n,o)})(e,n,t))),kT([aT(t),iT(t),tT(t)]),(i=t.platformService.config.clientType===Ye.Bh.Web,a=e=>yT(e,t),e=>i?e.pipe((0,lS.b)((e=>a(e)))):e));var i,a},mT=(e,t,n,i)=>{const{id:a,activeEntities:o,correlation:r,screenState:s,isMainWindow:l,layoutConfig:{layoutMode:d},isInitialWindowStateHidden:c,userContextId:u,windowOptions:m}=e,{mainEntity:g,endEntity:p}=o,v=new hS.m(n.diagnosticsService,a),h=v.newLogger("WindowStateManager"),f=Object.assign(Object.assign({},n),{loggerFactory:v}),y=_N(f,a,r,(0,FN.YR)(l,d),u||""),k=y.findScenario(ft.RG.WindowLaunchTime);null==k||k.appendEventData({mainEntityType:g.type,endEntityType:null==p?void 0:p.type});const S=((e,t,n)=>{var i;const a=e.appsRegistryService.getApp({entityType:t.type});return(null===(i=null==a?void 0:a.getAppWindowFeatures)||void 0===i?void 0:i.call(a,{coreServices:e,isResize:!0,entityType:t.type,windowOptions:n}))||{}})(f,g,null!=m?m:g.windowOptions);return gT(t,u,f,a,g,h,y,S,r,s,l,d,c,m,i)},gT=(e,t,n,i,a,o,r,s,l,d,c,u,m,g,p)=>{const v=new eS.X({userContextId:t,correlation:l}),h=((e,t,n,i,a,o,r,s,l,d,c,u,m)=>{DN(i,ft.ck.BeginWindowCreation),n.log(`mainEntityId: ${o.id}, mainEntityType: ${o.type}, mainEntityAction: ${o.action}`);const g=e.windowProvider;return t===De.ew?(dT(g,e,l,i,c,t,n),g):rT(g,e,t,n,i,a,o,r,s,l,d,c,u,m)})(n,i,o,r,s,a,d,c,u,m,v,g,p),f=((e,t,n,i)=>bN(e.client,t).subscribe((a=>CN(a,n,t,e.commandChangeReportingService,e.experienceChangeReportingService,e.hostCommunicationService,i))))(n,i,h,o),y=n.clientState.getChildWindowStateProvider(h,n.loggerFactory,n.coreSettings),k=pT(h,i,v,f,y,e,r,a,c&&u===L.lOW.standard,n.loggerFactory,n.leakDetectorService);return DN(r,ft.ck.WindowContextProvider),n.commandChangeReportingService.report({context:{target:"window-state-manager-create-window",layoutMode:u},correlationId:l.id,type:GS.B.WindowCreated,isMainWindow:c,userContextId:t}),k},pT=(e,t,n,i,a,o,r,s,l,d,c)=>({id:t,window:e,windowStateSubscription:i,clientState:a,leakDetectorService:c,loggerFactory:d,userContextId$:n,context$:IN(r,t,e,a,s,l,n,o)}),vT=({clientState:e,id:t,window:n,windowStateSubscription:i,loggerFactory:a,leakDetectorService:o},r)=>{const s=a.newLogger("WindowStateManager");s.log(`Destroy called on window ${t}`),t!==De.ew&&(n&&n.close(),s.log(`Window.close() called for window ${t}`)),null==i||i.unsubscribe(),null==o||o.cleanup(),e.dispose(),r.appsRegistryService.removeWindowViewState(t)},hT=({activeEntities:e,correlation:t,id:n,isMainWindow:i,layoutConfig:a,userContextId:o},{context$:r,window:s,userContextId$:l})=>(l.next({userContextId:o,correlation:t}),{activeEntities:e,context$:r,id:n,isMainWindow:i,layoutConfig:a,userContextId:o,window:s});let fT;const yT=(e,t)=>{const n=t.loggerFactory.newLogger("WindowStateManager"),{isChatHybridArchitectureEnabled:i}=t.coreSettings.get(K.J.Host);if(i){if(!e.find((e=>e.id===De.ew)))return}const a=t.windowProvider,o="onpagehide"in a?"pagehide":"unload";a.removeEventListener(o,fT),fT=()=>{n.log(`Global window unload handler called for ${e.length} windows`),e.forEach((e=>{e.id!==De.ew&&e.window.close()}))},a.addEventListener(o,fT,{once:!0})},kT=e=>(0,QN.R)(((t,n)=>(n.forEach((n=>{const i=t.find((e=>e.id===n.id));e.forEach((e=>{e.isChanged(n,i)&&e.execute(n,i)}))})),n)),[]),ST=e=>{e.stopScenarioIfActive(ft.RG.WindowLaunchTime,{},"abandoned")},bT=(e,t,n,i)=>{(e=>{const{enableCdlRegistration:t}=e.coreSettings.get(K.J.Core);return!!t})(e)&&(t.opener.postMessage(vb.rY.CdlRegistration,{childWindowId:i,eventType:"unregister"}),n.log(`CdlRegistration: windowId: '${i}', eventType: unregister`))},CT=(e,t,n)=>{const i=new URL(n);e.windowLeakInfo={windowLeakInfoStartTime:(new Date).toUTCString(),windowLeakInfoEntityType:i.searchParams.get("entityType")||n,windowLeakInfoViewportContext:e.viewportContext,windowLeakInfoWindowId:t}},wT=e=>{e.windowLeakInfo||(e.windowLeakInfo={}),e.windowLeakInfo.windowLeakInfoEndTime=(new Date).toUTCString()};var NT=n(878233);const TT=["/convene","/embed-client/chats","/l/auth/google","/l/calendar/scheduling-form","/l/channel-dashboard","/l/channel","/l/chat/0/0","/l/claim","/l/community/invite","/l/community","/l/entity","/l/fileshare","/l/invite/","/l/manage-teams/myinvites","/l/meeting/new","/l/meeting/details","/l/meetup-join","/l/message","/l/present","/l/team-dashboard","/l/team","/meet","/notdefaultapp"];var IT;!function(e){e.core="core",e.flyout="flyout",e.default="default"}(IT||(IT={}));var ET=n(695975),AT=n(972124),_T=n(136497);function DT(e,t,n,i){const{deepLink:a}=e;let o=a;if(function(e,t){const{deepLink:n,crash:i,relaunch:a,relaunchSource:o}=e;if(i||a){const e=i?"crash":"relaunch";if(t.log(`Recovering from a ${e}: ${e} QSP present.`),!i&&o&&!function(e){switch(e){case ET.d.ReloadAppTask:case ET.d.RemoveAuthenticatedUserResolver:return!0;default:return!1}}(o))return t.log(`Recovering from a ${e}: Do not restore deeplink for reload source: ${o}`),!1;switch(IT[n]){case IT.default:case IT.core:return!0;case IT.flyout:return t.log(`Recovering from a ${e}: flyout requested, do not recover a persisted deeplink.`),!1;default:return t.log(`Recovering from a ${e}: new deeplink present, do not recover a persisted one.`),!1}}return!1}(e,i)){const e=function(e,t){const n=e.getAllStoredDeeplinks();let i;return t.registeredApps.forEach((e=>{n[e.manifest.id]&&(i=n[e.manifest.id])})),i}(t,n);e?(o=e,i.log("Found deeplink from the previous session.")):i.log("No deeplink found to restore.")}return t.clear(),o}const FT=new Map,MT=/^\/|\/$/g;function RT(e){if(!e||0===e.length)return;const t=FT.get(e);if(t)return t;const n=e.replace(MT,"");if(0===n.length)return;const i=n.split("/");try{let t;if(i){let e=i.length-1;for(;e>=0;){const t=i[e].toLowerCase();if(u.p[t])break;e--}e>=0&&(t=function(e){let t;switch(e.length){case 3:t={type:OT(e[0]),id:e[1],action:PT(e[2])};break;case 2:{const n=e[1].toLowerCase();t=u.u[n]?{type:OT(e[0]),action:PT(e[1])}:{type:OT(e[0]),id:e[1],action:u.u.view};break}default:throw new Error("Invalid entity fragment format found. Valid type, id or action is required.")}return t}(i.splice(e)))}return FT.size<=1e3&&t&&FT.set(e,t),t}catch(e){throw new Error(`Unable to parse path into proper command. ${e.message}`)}}function PT(e){return e.toLowerCase()}function OT(e){return e.toLowerCase()}function xT(e){return decodeURIComponent(e).replace(/[^A-Za-z0-9/.?&=#\+\-,_:@{}"]/g,"")}function LT(e,t,n,i,a,o=c.su.flush,r){return i?{shouldRenderContent:!0,scenarioCorrelation:e,entityCommand:ZS({entity:i,command:{visibilityState:c.fe.show,stateTransition:o,layoutMode:a,correlation:e.correlation},entityOptions:r,metadata:{deepLink:n}}),metadata:{allowAnonymous:!1,deepLink:n,userContextId:t}}:{shouldRenderContent:!1,scenarioCorrelation:e,metadata:{allowAnonymous:!1,deepLink:IT.core,userContextId:t}}}function UT({appsRegistryService:e,client:t,commandChangeReportingService:n,coreSettings:a,decodedLink:o,hostCommunicationService:r,isInternalDeeplink:s,logger:l,loggerFactory:d,scenarioCorrelation:m,scenarioFactory:g,userBiService:p,userContextId:v,preferredCommandInput:h,sourceViewEntity:f}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const y=new URL(o,a.get(K.J.Host).deepLinkDomain||void 0);!function(e,t,n,i){const{pathname:a,search:o}=i,r="/"===a[0]?a.substr(1):a,s=TT.find((e=>{const t="/"===e[0]?e.substr(1):e;return r.startsWith(t)}));if(!s)return;const l={};l["DataBag.joinLinkType"]=s.toString();const d=new URLSearchParams(o);l["DataBag.deeplinkId"]=d.get("deeplinkId"),l["DataBag.joinLinkVariant"]=d.get("v"),e.recordPanelAction({actionGesture:Da.uS.open,actionOutcome:Da.$K.open,actionScenario:Da.Tk.deeplink,actionScenarioType:Da.Yu.deeplink,moduleType:Da.PO.deeplink,moduleName:Da.rA.deeplinkService,panelType:n?Da.wh.Internal:Da.wh.External,dataBag:{id:"",data:Object.assign({},l),dispose:()=>{}}},t)}(p,l,s,y);const{matchType:k,terminateDeeplink:S,intent:b,errorCode:C,reason:w}=yield function(e,t,n,a,o,r,s,l,d,c,u){var m;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,g,p,v,h=!1;if(t.get(K.J.Core).enableOriginValidationForIncomingIntents&&!(0,_T.H)(n.toString(),t,!0))return{terminateDeeplink:!1,matchType:"originValidationForIncomingIntents",intent:void 0,reason:"Not a valid deeplink",errorCode:Ub.InvalidOrigin};try{let r;const{pathname:m}=n,v="/"===m[0]?m.substr(1):m,f=function(e){if(e.hash){const t=new URL(e.hash.substring(1),e.origin),n={pathname:t.pathname};return t.search&&(n.search=(0,AT.Qc)(t.search)),n}return}(n);for(const t of e.registeredApps){const{match:e,matchType:a,matchingCondition:o}=BT(t,v,n,f);if(e){r=o,i=a;break}}if(r){const e=yield r.execute({context:{client:s,coreSettings:t,loggerFactory:o,scenarioFactory:l},deeplinkUrl:n,preferredCommandInput:d,sourceViewEntity:u,parsedDeeplinkHash:f});e?g=Object.assign(Object.assign({},e),{shouldRenderContent:!0,entityCommand:Object.assign(Object.assign(Object.assign({},e.entityCommand),{command:Object.assign(Object.assign({},e.entityCommand.command),{correlation:a.correlation})}),n&&{metadata:{deepLink:n.toString()}}),scenarioCorrelation:a,metadata:Object.assign(Object.assign({userContextId:c},e.metadata),{deepLink:n.toString()})}):(h=!0,p=Ub.DeeplinkTerminatedByApp)}else p=Ub.DeeplinkNotHandledByRegisteredApps}catch(e){p=Ub.OnBeforeDeeplinkParsedFailed,v=e.message;const t=e.reason,n=`DeepLink:: /${p}/${(0,ta.A)(v)}/${t}`;null===(m=r.errorToTelemetry)||void 0===m||m.call(r,n,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}return{matchType:i,terminateDeeplink:h,intent:g,errorCode:p,reason:v}}))}(e,a,y,m,d,l,t,g,h,v,f);(null==b?void 0:b.shouldRenderContent)?l.log(`Deeplink parsed to intent: { type: ${b.entityCommand.entity.type}, action: ${b.entityCommand.entity.action} }`):l.log("Returning default entity to be executed as fallback");let N=b;return S||N||(N=yield function(e,t,n,a,o,r){var s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableUnsupportedDeeplinkDialog:i}=t.get(K.J.Core);if(a.log(`enableUnsupportedDeeplinkDialog: ${i}`),i){const t=yield n.loadModule("appswitcher"),i=yield null===(s=null==t?void 0:t.getPearInstallState)||void 0===s?void 0:s.call(t,AC.OP.Teams1);if(a.log(`t1InstallState: ${i}`),i===AC.Jv.InstalledNotActive||i===AC.Jv.InstalledActive)return a.log("Returning unsupported deeplink command"),LT(o,r,e.toString(),{type:u.p.unsupporteddeeplinkdialog,action:u.u.view},c.lO.standard,c.su.extend,{originalDeeplink:e})}}))}(y,a,r,l,m,v)),WT(n,m.correlation.id,k,null==N?void 0:N.entityCommand.entity.type,null==N?void 0:N.entityCommand.entity.action,C,w),{terminateDeeplink:S,intent:N}}))}function BT(e,t,n,i){if(!e.onBeforeDeeplinkParsed)return{match:!1};for(const a of e.onBeforeDeeplinkParsed){const{filter:o}=a;if(jT(o)){if(o(n,i))return{match:!0,matchType:`${e.manifest.name}#filterFn`,matchingCondition:a}}else{const e="/"===o[0]?o.substr(1):o;if(t.startsWith(e))return{match:!0,matchType:e,matchingCondition:a}}}return{match:!1}}function jT(e){return(0,a.isFunction)(e)}function WT(e,t,n,i,a,o,r){const s="deeplink-parsing";e.report({correlationId:t,type:GS.B.DeeplinkParsed,context:{target:s,eventData:{deeplinkType:n,mainEntityType:i,mainEntityAction:a,errorCode:o,reason:r}}}),e.report({type:GS.B.ScenarioEventDataAppended,correlationId:t,context:{target:s,eventData:{deeplinkType:n,mainEntityType:i,mainEntityAction:a,errorCode:o,reason:r}}})}function VT({appsRegistryService:e,coreSettings:t,hostCommunicationService:n,location:o,scenarioCorrelation:r,scenarioFactory:s,loggerFactory:l,userBiService:d,isInternalDeeplink:m,commandChangeReportingService:g,intentPersistenceService:p,userContextId:v,client:h,preferredCommandInput:f,sourceViewEntity:y}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const k=l.newLogger("DeeplinkUtilities"),S=function(e,t){var n,i;const{hash:a,href:o,pathname:r}=e;if(!a&&!o&&!r)return;if(a){const{deepLink:e,crash:t,relaunch:n,source:i,userContextId:o}=$T(a);if(e)return{deepLink:e,crash:t,relaunch:n,relaunchSource:i,isDesktopDeeplink:!0,userContextId:o}}if(o){let e;try{e=decodeURIComponent(o)}catch(e){const a=`${Ub.DecodeURIComponentFailed}::${null==e?void 0:e.name}`;return void(null===(i=(n=t.newLogger(Lb)).errorToTelemetry)||void 0===i||i.call(n,a,"webclient_framework_foundation_core_services_deeplink",void 0,!0))}return{deepLink:e,crash:!1,relaunch:!1,relaunchSource:void 0}}return}(o,l);let b;if(S&&S.isDesktopDeeplink){const a=DT(S,p,e,k);return function({appsRegistryService:e,client:t,commandChangeReportingService:n,coreSettings:a,deepLink:o,hostCommunicationService:r,isInternalDeeplink:s,logger:l,loggerFactory:d,scenarioCorrelation:m,scenarioFactory:g,userBiService:p,userContextId:v,preferredCommandInput:h,sourceViewEntity:f}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=IT[o];if(i){let e;switch(l.log(`Static deeplink: ${i}`),o){case IT.flyout:e=LT(m,v,o,{type:u.p.flyout,action:u.u.view},c.lO.minimal);break;case IT.default:e=LT(m,v,o,QT(),c.lO.standard);break;case IT.core:e=LT(m,v,o,void 0)}return WT(n,m.correlation.id,i,(null==e?void 0:e.shouldRenderContent)?null==e?void 0:e.entityCommand.entity.type:void 0,(null==e?void 0:e.shouldRenderContent)?null==e?void 0:e.entityCommand.entity.action:void 0),{terminateDeeplink:!1,intent:e}}return UT({decodedLink:xT(o),scenarioCorrelation:m,scenarioFactory:g,coreSettings:a,hostCommunicationService:r,appsRegistryService:e,loggerFactory:d,logger:l,userBiService:p,isInternalDeeplink:s,commandChangeReportingService:n,userContextId:v,client:t,preferredCommandInput:h,sourceViewEntity:f})}))}({appsRegistryService:e,coreSettings:t,deepLink:a,hostCommunicationService:n,scenarioCorrelation:r,scenarioFactory:s,loggerFactory:l,logger:k,userBiService:d,isInternalDeeplink:m,commandChangeReportingService:g,userContextId:v||S.userContextId,client:h,preferredCommandInput:f,sourceViewEntity:y})}if(S){const{terminateDeeplink:i,intent:a}=yield UT({decodedLink:S.deepLink,scenarioCorrelation:r,scenarioFactory:s,coreSettings:t,hostCommunicationService:n,appsRegistryService:e,loggerFactory:l,logger:k,userBiService:d,isInternalDeeplink:m,commandChangeReportingService:g,client:h,userContextId:v||S.userContextId,preferredCommandInput:f,sourceViewEntity:y});if(i)return{terminateDeeplink:i,intent:a};b=a}return b||(b=function(e,t,n){const{hash:i,pathname:o}=e;let r,s;if(i&&!(0,a.isEmpty)(i)){const e=i.indexOf("?");r=e>=0?i.substr(0,e):i}else r=o;const l=RT(r);l&&(s=LT(t,n,xT(r||IT.default),l));return s}(o,r,v)),{terminateDeeplink:!1,intent:b}}))}function HT(e,t){let n=function(e){const{hash:t,search:n}=e;let i=n;if(t&&!(0,a.isEmpty)(t)){const e=t.indexOf("?");e>=0&&(i=t.substr(e+1,t.length-1))}const o=function(e){return(0,AT.Qc)(e||"")}(i);let r;o.correlationId&&o.startTimestamp&&o.source&&(r={id:o.correlationId,startTimestamp:o.startTimestamp,source:o.source});return r}(e);return n=n||JS({scenarioName:ft.RG.NavigationCommand,source:t}),n}function $T(e){const{deepLink:t,crash:n,relaunch:i,source:a,clientId:o,deeplinkId:r,userContextId:s}=(0,AT.Qc)(e);return{deepLink:t,crash:"true"===n,relaunch:"true"===i,source:a&&ET.d[a],clientId:o,deeplinkId:r,userContextId:s}}function zT(e){const{action:t,id:n,type:i}=e;if(t===u.u.default)switch(e.type){case u.p.default:return IT.default;case u.p.flyout:return IT.flyout}return n?`/${i}/${n}/${t}`:`/${i}/${t}`}function GT({clientLaunchId:e,location:t}){var n;return null!==(n=null!=e?e:t&&qT(t,"clientId"))&&void 0!==n?n:(0,mt.v4)()}function qT(e,t){const{hash:n}=e;if(n){const e=$T(n);return e&&e[t]}}function QT(){return{action:u.u.default,type:u.p.default}}var JT=n(757185);const YT=new Set([L.pyR.chats,L.pyR.channels]),KT="active_windows_history";class ZT{constructor(e,t,n,i,a,o,r,s){this._client=t,this._experienceChangeReportingService=n,this._localStorage=i,this._rebootService=a,this._scenarioFactory=o,this._userContextId=r,this._windowProvider=s,this.cleanup=e=>{switch(e){case"quit":case"restart":this.unsubscribe();break;case"signout":default:this.unsubscribe(),this.clearCache()}},this.unsubscribe=()=>{var e,t;null===(e=this._activeWindowsSubscription)||void 0===e||e.unsubscribe(),null===(t=this._windowOptionsSubscription)||void 0===t||t.unsubscribe()},this._logger=e.newLogger("ActiveWindowsHistoryService"),this._logger.log("ActiveWindowsHistoryService:: constructed")}initialize(){const e=this.cleanup;this._rebootService.registerCleanupCallback(e);const{crash:t,relaunch:n}=$T(this._windowProvider.location.hash);this._logger.log(`ActiveWindowsHistoryService:: crash: ${t} or relaunch: ${n}`),this.restoreWindows(t||n)&&this.subscribeWindows()}restoreWindows(e){if(!e)return this.clearCache(),!0;const t=this._scenarioFactory.newScenario(ft.RG.ActiveWindowsHistoryRestore),n=e=>{this.cleanup();const n={reason:e};t.fail(n)},i=(0,JT.F$)(this._client);if(!i)return n("Failed to read activeWindows from Apollo."),!1;const a=this.filterWindows(i),o=this.readCache();if(!o)return n("Failed to read from localStorage."),!1;const r=o.filter((e=>!a.find((t=>t.activeEntities.mainEntity.id===e.activeEntities.mainEntity.id))));return r.length&&(r.forEach((e=>{e.activeEntities.entityExtension=null})),!(0,JT.bF)(this._client,i.concat(r)))?(n("Failed to write activeWindows to Apollo."),!1):a.length&&!this.persistCache(a.concat(r))?(n("Failed to write to localStorage."),!1):(t.stop(),!0)}subscribeWindows(){this._activeWindowsSubscription=(0,JT.OB)(this._client).subscribe((({errors:e,loading:t,data:n})=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,a,o,r;if(t)return;if(e)return void(null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,`subscribeWindows::watchActiveWindows::${(0,Ci.u4)(e)}`,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0));const{activeWindows:s=[]}=n,l=this.filterWindows(s);this.persistCache(l)||(this.cleanup(),null===(r=(o=this._logger).errorToTelemetry)||void 0===r||r.call(o,`Failed to write ${l.length} windows to localStorage.`,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0))})))),this._windowOptionsSubscription=this._experienceChangeReportingService.observeChanges().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e.type!==bb.FV.WindowOptionsChange||!e.windowId||this._userContextId&&e.userContextId!==this._userContextId)return;const t=e=>{var t,n;this.cleanup(),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,e,"webclient_framework_foundation_core_services_active_windows_history",void 0,!0)},n=this.readCache();if(!n)return void t("subscribeWindows::windowOptions::Failed to read from localStorage.");const i=n.find((t=>t.id===e.windowId));if(!i)return;const{height:a,left:o,top:r,width:s}=e.context;i.windowOptions={__typename:"WindowOptions",height:a,left:o,top:r,width:s},this.persistCache(n)||t(`subscribeWindows::windowOptions::Failed to write ${n.length} windows to localStorage.`)}))))}filterWindows(e){return e.filter((e=>((e,t)=>e.layoutConfig.layoutMode===L.lOW.focus&&!e.isMainWindow&&(!t||t===e.userContextId)&&YT.has(e.activeEntities.mainEntity.type))(e,this._userContextId)))}clearCache(){this._logger.log("ClearCache::ACTIVE_WINDOWS_HISTORY_STORAGE_KEY"),this._localStorage.remove(KT,NT.f.UserAndExperience)}persistCache(e){return this._logger.debug(`Persist ${e.length} windows to cache.`),this._localStorage.setSafe(KT,JSON.stringify(e),NT.f.UserAndExperience)}readCache(){try{const e=JSON.parse(this._localStorage.get(KT,NT.f.UserAndExperience)||"[]");return this._logger.debug(`Read ${e.length} windows from cache.`),e}catch(e){return}}}var XT=n(69226);class eI extends Fe{constructor(){super(De.Yg.CreateActiveWindowsHistoryTask,["authenticationUser","coreSettings","client","experienceChangeReportingService","localStorage","loggerFactory","rebootService","scenarioFactory","windowProvider"]),this.isAuthenticatedUser=e=>(null==e?void 0:e.role)===XT.w4.Member||(null==e?void 0:e.role)===XT.w4.Guest}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n}=e,i=null==n?void 0:n.get(K.J.Core);if(!(null==i?void 0:i.enableActiveWindowsHistoryRecovery)||!this.isAuthenticatedUser(t))return;const{client:a,experienceChangeReportingService:o,localStorage:r,loggerFactory:s,rebootService:l,scenarioFactory:d,windowProvider:c}=e,u=(0,li.b)(t);e.activeWindowsHistoryService=new ZT(s,a,o,r,l,d,u,c)}))}}var tI=n(798741);class nI{constructor(e,t){this._experienceChangeReportingService=e,this._userContextId=t,this._appBarObservable=this._experienceChangeReportingService.observeChanges().pipe((0,rS.h)((e=>e.userContextId===this._userContextId&&e.type===bb.yU.AppSelectionChanged&&e.context.appId!==this._currentValue)),(0,aS.U)((e=>{this._previousValue=this._currentValue;const t=e;return this._currentValue=t.context.appId,{previousApplicationSelection:this._previousValue,newApplicationSelection:this._currentValue}}))).pipe((0,tI.B)()),this._appBarSubscription=this._appBarObservable.subscribe()}cleanup(){var e;null===(e=this._appBarSubscription)||void 0===e||e.unsubscribe()}observe(){return this._appBarObservable}current(){return this._currentValue}}class iI extends Fe{constructor(){super(De.Yg.CreateAppBarServiceTask,["authenticationUser","experienceChangeReportingService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t}=e,{experienceChangeReportingService:n}=e,i=new nI(n,(0,li.b)(t));return e.appBarService=i,()=>{i.cleanup()}}))}}var aI=n(713153);function oI(e){switch(e){case De.eT.InCall:case De.eT.InBroadcast:case De.eT.Presenting:return VS.pk.VeryActive;case De.eT.Interactive:return VS.pk.Active;case De.eT.Inactive:return VS.pk.Inactive;case De.eT.LongInactive:return VS.pk.LongInactive;case De.eT.Disabled:return VS.pk.Unrecoverable;default:return}}var rI,sI=n(929331);class lI{constructor(e,t,n,i,a){this._host=t,this.timesToSendUntilIdle=2,this._logger=n.newLogger("ClientStateSender");const{appIdleTimeoutInMs:o}=i.get(K.J.Core);this.msUntilResend=o?Math.round(o/this.timesToSendUntilIdle):a,this._subscriptionToStateChange=e.pipe((0,sI.x)()).subscribe((e=>this.handleStateChange(e))),this._logger.log("Initialized")}dispose(){this.stopRecurringSending(),this._subscriptionToStateChange.unsubscribe()}handleStateChange(e){try{e===VS.pk.Active||e===VS.pk.VeryActive?this.sendStateRecurringly(e):(this.stopRecurringSending(),this.sendState(e))}catch(t){this._logger.error(`Failed to send client state update: ClientState=${e}, Error: ${t}`)}}sendStateRecurringly(e){this._logger.log(`Starting recurring sending of client state: ${e}`);try{this.sendStateAndStartTimer(e)}catch(t){this._logger.error(`Failed to start recurring sending of client state: ClientState=${e}, Error: ${t}`)}}stopRecurringSending(){this.stopTimer(),this._logger.log("Stopped recurring client state sending")}stopTimer(){if(void 0!==this._recurringSendCountdownTimer)try{this._host.clearInterval(this._recurringSendCountdownTimer),this._recurringSendCountdownTimer=void 0}catch(e){this._logger.error(`Failed to stop sending of client state: ${e}`)}}sendStateAndStartTimer(e){this.sendState(e),this.stopTimer(),this._recurringSendCountdownTimer=this._host.setInterval((()=>this.sendState(e)),this.msUntilResend)}sendState(e){const t=function(e){switch(e){case VS.pk.Unrecoverable:return De.eT.Disabled;case VS.pk.Inactive:return De.eT.Inactive;case VS.pk.LongInactive:return De.eT.LongInactive;case VS.pk.VeryActive:return De.eT.InCall;default:return De.eT.Interactive}}(e);this._logger.log(`Sending state to main window: ${t} (ClientState=${e})`),this._host.opener.postMessage(vb.rY.UpdateWindowState,{childSettings:{appState:t}})}}class dI{constructor(e,t,n,i){this._coreClientStateObservable=e,this._idleTracker=n,this._initialClientState=i,this._coreClientStateSubscription=null,this._logger=t.newLogger("ChildClientStateProvider"),this._logger.log(`Initializing clientState with state=${this._initialClientState}`),this._childClientStateBehaviorSubject=new eS.X(this._initialClientState),this._coreClientStateSubscription=this._coreClientStateObservable.subscribe((e=>{e!==this.getState()&&(this._logger.log(`Client state is ${e}.`),this._childClientStateBehaviorSubject.next(e))})),this._logger.log("Initialized")}observe(){return this._childClientStateBehaviorSubject.asObservable()}getState(){return this._childClientStateBehaviorSubject.value}getChildWindowStateProvider(e,t,n){const i=this._idleTracker.createChildWindowIdleTracker(e,t,n);return new dI(this._coreClientStateObservable,t,i,this.getState())}dispose(){var e;this._idleTracker.dispose(),null===(e=this._coreClientStateSubscription)||void 0===e||e.unsubscribe(),this._childClientStateBehaviorSubject.complete()}}class cI{constructor(e,t,n,i,a,o){this._host=e,this._idleTracker=n,this._defaultClientState=VS.pk.Active,this._initializing=!0,this._clientStateSubscription=null,this._idleTrackerStateSubscription=null,this.handleAppStateSyncMessage=e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;void 0!==n&&(this._logger.log(`Handling pushed host appState update change to ${n}.`),this.handleMainWindowStateChange(n))},this._logger=t.newLogger("ClientStateProvider");let r=this._defaultClientState;if(void 0!==o){const e=oI(o);void 0!==e&&(r=e)}this._logger.log(`Initializing clientState with state=${r}`),this._clientStateBehaviorSubject=new eS.X(r),this._setupEventHandlers(t,i,a),this.restartIdleTimerWhenActiveState(),this._initializing=!1,this._logger.log("Initialized")}observe(){return this._clientStateBehaviorSubject.asObservable()}getState(){return this._clientStateBehaviorSubject.value}getChildWindowStateProvider(e,t,n){const i=this._idleTracker.createChildWindowIdleTracker(e,t,n);return new dI(this.observe(),t,i,this.getState())}dispose(){var e,t;this._host.opener.removeEventListener(vb.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTracker.dispose(),this._stateSender&&this._stateSender.dispose(),this._clientStateBehaviorSubject.complete(),null===(e=this._clientStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this._idleTrackerStateSubscription)||void 0===t||t.unsubscribe()}startVeryActive(e){this._logger.log(`startVeryActive(): Client state is set to very active by ${e}.`),this.setClientState(VS.pk.VeryActive)}stopVeryActive(e){this._logger.log(`stopVeryActive(): Client state is set to active by ${e}.`),this.setClientState(VS.pk.Active)}_setupEventHandlers(e,t,n){var i;this._clientStateSubscription=this.observe().subscribe((e=>{this._logger.log(`Client state is ${e}.`)})),this._host.opener.addEventListener(vb.rY.AppStateSyncMessage,this.handleAppStateSyncMessage),this._idleTrackerStateSubscription=this._idleTracker.observe().subscribe((e=>this.handleIdleChange(e))),n&&t&&(null===(i=t.get(K.J.Core))||void 0===i?void 0:i.enableUpdateAngularOnClientStateChange)&&(this._stateSender=new lI(this.observe(),this._host,e,t,aI.u.MsUntilIdleDefault))}handleIdleChange(e){this._logger.log(`Handling idleness change to ${e}.`),this._clientStateBehaviorSubject.value!==VS.pk.VeryActive&&(this._initializing||this.setClientState(function(e){switch(e){case aI.R.Inactive:return VS.pk.Inactive;case aI.R.LongInactive:return VS.pk.LongInactive;default:return VS.pk.Active}}(e),!1))}setClientState(e,t=!0){e!==VS.pk.Active&&e!==VS.pk.VeryActive||!t||this._idleTracker.restartIdleTimer(),e===VS.pk.Inactive&&this._clientStateBehaviorSubject.value===VS.pk.LongInactive||this._clientStateBehaviorSubject.value!==e&&(this._logger.log(`Updating client state from=${this._clientStateBehaviorSubject.value} to=${e}.`),this._clientStateBehaviorSubject.next(e))}handleMainWindowStateChange(e){const t=oI(e);t!==VS.pk.Active&&t!==VS.pk.VeryActive||this.setClientState(t)}restartIdleTimerWhenActiveState(){this.getState()!==VS.pk.Active&&this.getState()!==VS.pk.VeryActive||this._idleTracker.restartIdleTimer()}}!function(e){e.Initializing="Initializing",e.Unrecoverable="Unrecoverable",e.LongInactive="LongInactive",e.Inactive="Inactive",e.Active="Active",e.VeryActive="VeryActive"}(rI||(rI={}));class uI{constructor(e=De.eT.Interactive){this._appState$=new eS.X(e);(0,Ze.J)().opener.addEventListener(vb.rY.AppStateSyncMessage,(e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.appState;this.setAppState(n)}))}observe(){return this._appState$.asObservable().pipe((0,sI.x)())}getState(){return this._appState$.value}setAppState(e){void 0!==e&&e!==this.getState()&&this._appState$.next(e)}}var mI,gI;!function(e){e.LoadModuleCoreFailed="LoadModuleCoreFailed",e.LoadModuleOsUtilsFailed="LoadModuleOsUtilsFailed",e.LoadModuleScenarioFailed="LoadModuleScenarioFailed",e.LoadModuleTelemetryFailed="LoadModuleTelemetryFailed",e.LoadModuleWebClientStatesFailed="LoadModuleWebClientStatesFailed",e.ExecuteCommandFailed="ExecuteCommandFailed",e.RegisterForAppStateChangedFailed="RegisterForAppStateChangedFailed",e.ReportReadyToQuitFailed="ReportReadyToQuitFailed"}(mI||(mI={})),function(e){e.LoadModuleCoreSuccess="LoadModuleCoreSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}(gI||(gI={}));var pI=n(231776);class vI{constructor(e,t,n){this.handleMachineLockUpdate=e=>{var t;const n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.isMachineLocked;void 0!==n&&(this._logger.log(`Handling pushed machineLock update change: isMachineLocked = ${n}.`),this.updateMachineLockState(n))},this._logger=t.newLogger("HostStateProvider"),this._hostStateSubject=new eS.X({windowState:VS.kZ.InFocus,machineLockState:VS.UV.Active,suspendedState:VS.V9.Resumed}),this.registerForStateChanges(e,n)}observe(){return this._hostStateSubject.asObservable()}getState(){return Object.assign({},this._hostStateSubject.value)}dispose(){var e;null===(e=this._machineStateChangedSubscription)||void 0===e||e.call(this)}registerForStateChanges(e,t){e.opener.addEventListener(vb.rY.AppStateSyncMessage,this.handleMachineLockUpdate),t.loadModule("osutils").then((e=>{var t;this._machineStateChangedSubscription=null===(t=null==e?void 0:e.registerForSessionStateChanged)||void 0===t?void 0:t.call(e,(e=>{this._logger.log(`Handling pushed machineLock update change: machine SessionStatus= ${e.status}.`),e.status===pI.$.Suspending||e.status===pI.$.Resumed?this.updateSuspendedState(e.status===pI.$.Suspending):this.updateMachineLockState(e.status===pI.$.Locked)}))}))}updateMachineLockState(e){const t=e?VS.UV.Locked:VS.UV.Active,n=this.getState().machineLockState;if(t!==n){this._logger.log(`Updating machine lock state from=${n} to=${t}.`);const e=this.getState();e.machineLockState=t,this._hostStateSubject.next(e)}}updateSuspendedState(e){const t=e?VS.V9.Suspending:VS.V9.Resumed,n=this.getState().suspendedState;if(t!==n){this._logger.log(`Updating machine suspended state from=${n} to=${t}.`);const e=this.getState();e.suspendedState=t,this._hostStateSubject.next(e)}}}var hI=n(270607),fI=n(567170);class yI extends fI.c{constructor(e,t,n){super(e),this.label=t,this.onOverrideLastState=n,this.handleNetworkStateNotification=e=>{this.logger.debug(`${this.label} received ${Sv.G[e]}`),this.getLastState()!==e&&(this.logger.log(`${this.label} network state is ${Sv.G[e]}`),this.notifyAboutStateChange(e))}}overrideLastState(e){const t=this.getLastState();this.logger.debug(`EndpointsNetworkStateListener state is overriden from ${void 0===t?"undefined":Sv.G[t]} to ${Sv.G[e]}`),this.doOverrideOfLastState(e),this.onOverrideLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions()}}var kI=n(761509),SI=n(661564),bI=n(781540);class CI extends fI.c{constructor(e){super(e),this.failed_to_fetch_subContext="rejectHttpError",this.processResponse=e=>{void 0!==e.status&&e.status!==SI.qb.NOT_MODIFIED&&e.status!==SI.qb.GATEWAY_TIMEOUT&&this.handleNetworkStateNotification(Sv.G.Online)},this.processResponseError=e=>{e&&(e.serverResponse?this.handleNetworkStateNotification(Sv.G.Online):e.context===De.w5.RejectHttpError&&e.code===De.jK.RemoteOperationFailed&&e.subContext===this.failed_to_fetch_subContext?this.handleNetworkStateNotification(Sv.G.Offline):this.logger.log(`Not network related error: ${e.message||e}`))},this.handleNetworkStateNotification=e=>{this.logger.debug(`Send network state is ${Sv.G[e]}`),this.getLastState()!==e&&(this.logger.log(`Send network state listener is ${Sv.G[e]}`),this.notifyAboutStateChange(e))},this.unsubscribeFromSendTracking=(0,bI.z)(this.processResponse,this.processResponseError)}overrideLastState(e){const t=this.getLastState();this.logger.debug(`Send state listener's state is overriden from ${void 0===t?"undefined":Sv.G[t]} to ${Sv.G[e]}`),this.doOverrideOfLastState(e)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.unsubscribeFromSendTracking&&this.unsubscribeFromSendTracking(),this.unsubscribeFromSendTracking=void 0}}var wI=n(893088);const NI=(e,t)=>Promise.resolve({apiName:t,constructRequest:n=>{const i=e();return i.searchParams.set("cb",Date.now().toString()),{apiName:t,url:i.href,method:"HEAD",timeout:1e4,headers:{"cache-control":"no-store"},cancellationToken:n.token}},transformResponse:e=>e.status===SI.qb.GATEWAY_TIMEOUT?Promise.reject("GATEWAY_TIMEOUT"):Promise.resolve()}),TI=e=>{const{coreSettings:t,platformService:n}=e;return{serviceName:wI.EJ.NetworkPing,models:{getNetworkStatus:NI((()=>new URL(t.get(K.J.Core).networkPingUrl||"/diagnostics/network",n.config.currentUrl)),"networkPing"),getNetworkStatusFallback:NI((()=>new URL(t.get(K.J.Core).networkPingFallbackPingUrl||"/evergreen-assets/icons/1x1-000000ff.png",n.config.staticsPath)),"networkFallbackPing")}}};var II=n(467757),EI=n(220011);const AI=[5e3,1e4,3e4],_I="cancelled_ping";class DI{constructor(e,t,n,a,o){this.coreSettings=e,this.endpointsManager=t,this.scenarioFactory=n,this.host=a,this.ping=()=>{const e=this.coreSettings.get(K.J.Core).networkPingDisableFallback||!1,t=this.scenarioFactory.newScenario(ft.RG.NetworkPing);let n=this.endpointsManager.createCancelToken(),i=!1;const a=()=>i;return{promise:this.pingEndpoint("initial ping",(()=>this.endpoints.getNetworkStatus(n)),t,!e,a).then((i=>i||e?Promise.resolve(i):(n=this.endpointsManager.createCancelToken(),this.pingEndpoint("fallback ping",(()=>this.endpoints.getNetworkStatusFallback(n)),t,!1,a)))),cancel:()=>(n.cancel(),void(i=!0))}},this.pingEndpoint=(e,t,n,a,o)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){n.appendEventData({operation:e});try{return yield t(),o()?this.markPingScenarioCancelled(e,n):this.markPingScenarioSuccess(e,n)}catch(t){return o()?this.markPingScenarioCancelled(e,n):(null==t?void 0:t.serverResponse)?this.markPingScenarioSuccess(e,n):((null==t?void 0:t.reason)===II.A.TimedOut?this.logger.log(`${e} timed out`):this.logger.log(`${e} failed`),!a&&this.markPingScenarioFailed(e,t,n))}})),this.getRetryIntervals=()=>{const e=this.coreSettings.get(K.J.Core).networkPingRetryIntervals||AI;return Object.assign([],e)},this.updatePingResult=e=>{this.latestPingResult={isOnline:e,timestamp:Date.now()}},this.logger=o.newLogger("NetworkPingService"),this.endpoints=t.createApi(TI),this.logger.log("Initialized")}detectCurrentNetworkStatus(){const e=this.coreSettings.get(K.J.Core).networkPingDebounceDelay||3e4;return!(this.coreSettings.get(K.J.Core).networkPingDisableDebounce||!1)&&this.latestPingResult&&this.latestPingResult.isOnline&&this.latestPingResult.timestamp&&Date.now()-this.latestPingResult.timestamp<e?(this.logger.log(`Skipping network detection as last online check succeeded less than ${e}ms ago.`),{promise:Promise.resolve(!0),cancel:()=>{}}):(this.logger.log("doing network ping"),this.ping())}whenNetworkOnline(){if(this.whenNetworkOnlinePromise)return this.whenNetworkOnlinePromise;const e=this.getRetryIntervals();let t=!1;const n=()=>{this.whenNetworkOnlinePromise=void 0,t=!0};let a;const o=new Promise(((o,r)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;a=()=>{null==i||i(),n(),r(_I)};let s=e[0];for(let n=0;!t;n++){const{promise:a,cancel:o}=this.ping();i=()=>{null==o||o(),i=()=>{}};try{const o=yield a;if(i=()=>{},o||t)break;n<e.length&&(s=e[n]),yield(0,EI._)(s,this.host)}catch(e){this.logger.log("whenNetworkOnline ping rejected")}}n(),o()}))));return this.whenNetworkOnlinePromise={promise:o,cancel:()=>null==a?void 0:a()},this.whenNetworkOnlinePromise}markPingScenarioSuccess(e,t){return t.stop({message:`${e} successful!`},"success"),this.logger.log(`${e} successful!`),this.updatePingResult(!0),!0}markPingScenarioFailed(e,t,n){var i;const a=(null==t?void 0:t.reason)?t.reason:"undefined",o=null===(i=null==t?void 0:t.serverResponse)||void 0===i?void 0:i.status;return n.fail({errors:`${e} failed. error reason: ${a}. Response status: ${o}`}),this.updatePingResult(!1),!1}markPingScenarioCancelled(e,t){return t.stop({message:`${e} cancelled`},"abandoned"),this.logger.log(`${e} cancelled`),this.updatePingResult(!0),Promise.reject(_I)}}class FI extends hI.s{constructor(e,t,n,i,a,o){var r,s;super(e,"NetworkStateProvider",n),this.loggerFactory=e,this.coreSettings=t,this.host=i,this.clientStateProvider=a,this._defaultNetworkOnlineDetectionTimeoutInMs=15e3,this.coreContextID="",this._contextListeners=new Map,this._isFirstSignal=!0,this.createNetworkStateTracker=(e,t,n)=>{const i=new yI(this.logger,t,n),a={next:i.handleNetworkStateNotification,dispose:i.cleanUpSubscriptions};return this._addToContextListeners(e,i),i.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`${t} network state is ${Sv.G[e]}`))),a},this._handleNetworkStateUpdate=(e,t)=>{if(this.logger.debug(`Update network to ${Sv.G[e]} due to ${t}`),e===Sv.G.Offline){if(this.getState()===Sv.G.Offline)return;this._suspectOffline()}else this._cancelNetworkOnlineDetection(t),this.getState()!==e?this.setNetworkState(e,t):(this.setDetailedNetworkState(Sv.T.Online),this._updateAllListenersTo(Sv.G.Online));this._isFirstSignal&&(this._isFirstSignal=!1)},this._handleWindowOnline=()=>{this.logger.log("browser network online"),this.isOnline()||(this._updateAllListenersTo(Sv.G.Offline),this._kickOffNetworkOnlineDetection(Sv.G.Online))},this._handleWindowOffline=()=>{if(this.logger.log("browser network offline"),this.coreSettings.get(K.J.Core).disableWindowEventsNetworkDetectionV2){if(this.getState()===Sv.G.Offline)return;this.setNetworkState(Sv.G.Offline,"browser offline"),this._updateAllListenersTo(Sv.G.Offline),this._kickOffNetworkOnlineDetection(Sv.G.Offline)}else this._suspectOffline()},this._subscribeToSendNetworkState(),this.subscribeToEndpointsNetworkStateTracking(this.coreContextID,o.networkState),this._subscribeToWindowNetworkEvents();try{this._networkPingService=new DI(this.coreSettings,o,n,this.host,this.loggerFactory)}catch(e){null===(s=(r=this.logger).errorNoPii)||void 0===s||s.call(r,"NetworkPingService initialization has failed")}}dispose(){super.dispose(),this._cancelNetworkOnlineDetection("dispose"),this.disposeAllContexts(),this._unsubscribeFromWindowNetworkEvents()}disposeContext(e){const t=this._contextListeners.get(e);t&&(t.forEach((e=>{e.cleanUpSubscriptions()})),this._contextListeners.delete(e))}subscribeToEndpointsNetworkStateTracking(e,t){const n=new kI.f(this.logger,t);return this._addToContextListeners(e,n),n.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Endpoints network state is ${Sv.G[e]}`)))}setNetworkState(e,t){super.setNetworkState(e,t),this._updateAllListenersTo(e)}_subscribeToSendNetworkState(){const e=new CI(this.logger);this._addToContextListeners(this.coreContextID,e),e.subscribeToStateChange((e=>this._handleNetworkStateUpdate(e,`Send network state is ${Sv.G[e]}`)))}_subscribeToWindowNetworkEvents(){this.host.addEventListener("online",this._handleWindowOnline),this.host.addEventListener("offline",this._handleWindowOffline)}_unsubscribeFromWindowNetworkEvents(){this.host.removeEventListener("online",this._handleWindowOnline),this.host.removeEventListener("offline",this._handleWindowOffline)}_updateAllListenersTo(e){this._contextListeners.forEach((t=>t.forEach((t=>{var n;return null===(n=t.overrideLastState)||void 0===n?void 0:n.call(t,e)}))))}_addToContextListeners(e,t){var n;this._contextListeners.has(e)?null===(n=this._contextListeners.get(e))||void 0===n||n.push(t):this._contextListeners.set(e,[t])}_suspectOffline(){const{enableSkipNetworkDetectionTimeoutOnOfflineStart:e,useVeryActiveForNetworkOnlineDetection:t,enableNetworkOnlineDetectionTimeout:n,networkOnlineDetectionTimeoutInMs:i}=this.coreSettings.get(K.J.Core);if(t&&this.clientStateProvider.getState()===VS.pk.VeryActive)return this.logger.log("Network detection cancelled due to VeryActive client state."),this._updateAllListenersTo(Sv.G.Online),void this.setDetailedNetworkState(Sv.T.Online);const a=this._isFirstSignal&&!!e;if(!(this._networkDetectionTimeout&&!a||this._detectCurrentNetworkStatusPromise||this._networkPing))if(this._updateAllListenersTo(Sv.G.Offline),this.setDetailedNetworkState(Sv.T.SuspectedOffline),n&&!a){const e=i||this._defaultNetworkOnlineDetectionTimeoutInMs;void 0!==this._networkDetectionTimeout||this._detectCurrentNetworkStatusPromise||(this.logger.log(`Starting ${e}ms timeout before kicking off network online detection.`),this._networkDetectionTimeout=this.host.setTimeout((()=>{this._networkDetectionTimeout=void 0,this.logger.log("Timeout expired."),this._kickOffNetworkOnlineDetection(Sv.G.Offline)}),e))}else this._kickOffNetworkOnlineDetection(Sv.G.Offline)}_kickOffNetworkOnlineDetection(e){if(!this._networkPingService||!this._canPerformPing())return void(this.getState()!==e&&this.setNetworkState(e));if(this._detectCurrentNetworkStatusPromise||this._networkPing)return;this.logger.log("Kicking off network status detection.");const t=this._networkPingService;this._detectCurrentNetworkStatusPromise=t.detectCurrentNetworkStatus(),this._detectCurrentNetworkStatusPromise.promise.then((e=>{void 0!==this._detectCurrentNetworkStatusPromise?(this._detectCurrentNetworkStatusPromise=void 0,e?(this.logger.log("Network status verified as online."),this.setNetworkState(Sv.G.Online,"http online")):(this.setNetworkState(Sv.G.Offline,"http offline"),this._startNetworkPing(t))):this.logger.log("Network detection cancelled, ignoring result.")})).catch((e=>{e===_I?this.logger.log("Network detection is cancelled"):this.logger.warn(`Network status verification error: ${e}`),this._detectCurrentNetworkStatusPromise=void 0}))}_canPerformPing(){const{enablePingService:e}=this.coreSettings.get(K.J.Core);return!!e||(this.logger.warn("Network detection is disabled."),!1)}_startNetworkPing(e){this.logger.log("Started recurring network ping."),this._networkPing=e.whenNetworkOnline(),this._networkPing.promise.then((()=>{this._networkPing?(this._networkPing=void 0,this.getState()!==Sv.G.Online&&this.setNetworkState(Sv.G.Online,"Network ping succeded")):this.logger.log("Network ping cancelled, ignoring result.")})).catch((e=>{this.logger.log(`network detection by ping terminated due to ${(null==e?void 0:e.message)?e.message:e}`)}))}_cancelNetworkPing(e){var t,n;this._networkPing&&(this.logger.log(`Cancelling network ping due to ${e}`),null===(n=(t=this._networkPing).cancel)||void 0===n||n.call(t),this._networkPing=void 0)}_cancelNetworkOnlineDetection(e){var t,n;void 0!==this._networkDetectionTimeout&&(this.logger.log(`Cancelling network detection timeout due to ${e}`),this.host.clearTimeout(this._networkDetectionTimeout),this._networkDetectionTimeout=void 0),this._detectCurrentNetworkStatusPromise&&(this.logger.log(`Cancelling network detection due to ${e}`),null===(n=(t=this._detectCurrentNetworkStatusPromise).cancel)||void 0===n||n.call(t),this._detectCurrentNetworkStatusPromise=void 0),this._cancelNetworkPing(e)}disposeAllContexts(){this._contextListeners.forEach((e=>{e.forEach((e=>{e.cleanUpSubscriptions()}))})),this._contextListeners.clear()}}class MI extends fI.c{constructor(e,t){super(e),this.handleLegacyApplicationStateChange=e=>{const t=this.isOnlineAndConnectedInternal(e);this.logger.log(`LegacyApplicationState changed to ${De.eT[e]}`),this.notifyAboutStateChange(t)},this.isOnlineAndConnectedInternal=e=>{switch(e){case De.eT.Disabled:case De.eT.Offline:return Sv.G.Offline;default:return Sv.G.Online}},this.legacyApplicationStateSubscription=t.observe().pipe((0,sI.x)()).subscribe(this.handleLegacyApplicationStateChange)}cleanUpSubscriptions(){super.cleanUpSubscriptions(),this.legacyApplicationStateSubscription&&(this.legacyApplicationStateSubscription.unsubscribe(),this.legacyApplicationStateSubscription=void 0)}}class RI extends hI.s{constructor(e,t,n,o,r,s){super(t,"LegacyNetworkStateProvider",n),this.hostCommunicationService=s,this._legacyAppStateListener=void 0,this._suspectedStateListeners=[],this._handleNetworkListenerUpdate=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){e!==this.getState()?(this.logger.debug(`Network suspected ${Sv.G[e]}${t?" due to ":""}${t}`),yield this._sendSuspectedNetworkStateThrottled(this._convertToIsOnline(e))):void 0!==this._suspectedIsOnline&&this.convertToIsOnline(e)!==this._suspectedIsOnline&&this._resetSuspectedState()})),this._sendSuspectedNetworkState=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log(`Sending network state to main window: ${e}`);const t=yield this.hostCommunicationService.loadModule("core");(null==t?void 0:t.notifyCoreStateChanged)?t.notifyCoreStateChanged({isNetworkOnline:e}):this.logger.warn("notifyCoreStateChanged is missing in HostComms")})),this._initSuspectedThrottleFunc=()=>{this._throttledSuspectedIsOnline=(0,a.throttle)(this._sendSuspectedNetworkState,2e3)},this._convertToIsOnline=e=>e!==Sv.G.Offline,this._updateSuspectedStateListenersTo=e=>this._suspectedStateListeners.forEach((t=>{var n;return null===(n=t.overrideLastState)||void 0===n?void 0:n.call(t,e)})),this._subscribeToLegacyAppStateTracking(e),this._subscribeToSuspectedNetworkState(r,o)}dispose(){var e;super.dispose(),null===(e=this._legacyAppStateListener)||void 0===e||e.cleanUpSubscriptions(),this._legacyAppStateListener=void 0,this._suspectedStateListeners.forEach((e=>e.cleanUpSubscriptions())),this._suspectedStateListeners=[],this._clearSuspectedState(),this._throttledSuspectedIsOnline=void 0}_subscribeToLegacyAppStateTracking(e){this._legacyAppStateListener=new MI(this.logger,e);const t=this;this._legacyAppStateListener.subscribeToStateChange((e=>t._updateNetworkState(e,`LegacyApplicationState changed to ${Sv.G[e]}`)));const n=this._legacyAppStateListener.getLastState();void 0!==n&&this._updateNetworkState(n,"initial LegacyApplicationState")}_subscribeToSuspectedNetworkState(e,t){const{enableNetworkTrackingForLegacyNetworkState:n}=t.get(K.J.Core);n&&(this._initSuspectedThrottleFunc(),this._subscribeToSendNetworkState(),this._subscribeToEndpointsNetworkStateTracking(e.networkState))}_subscribeToSendNetworkState(){const e=new CI(this.logger);this._suspectedStateListeners.push(e),e.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Send network state is ${Sv.G[e]}`)))}_subscribeToEndpointsNetworkStateTracking(e){const t=new kI.f(this.logger,e);this._suspectedStateListeners.push(t),t.subscribeToStateChange((e=>this._handleNetworkListenerUpdate(e,`Endpoints network state is ${Sv.G[e]}`)))}_updateNetworkState(e,t){this.logger.log(`Update network to ${Sv.G[e]}${t?" due to ":""}${t}`),this.getState()!==e&&(this.setNetworkState(e),this._resetSuspectedState())}_sendSuspectedNetworkStateThrottled(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e!==this._suspectedIsOnline?(this._resetSuspectedState(),this._suspectedIsOnline=e):this._updateSuspectedStateListenersTo(this.getState()),this._throttledSuspectedIsOnline&&(yield this._throttledSuspectedIsOnline(e))}))}_clearSuspectedState(){var e;void 0!==this._suspectedIsOnline&&(this._suspectedIsOnline=void 0),null===(e=this._throttledSuspectedIsOnline)||void 0===e||e.cancel(),this._updateSuspectedStateListenersTo(this.getState())}_resetSuspectedState(){this._clearSuspectedState(),this._initSuspectedThrottleFunc()}}class PI extends Fe{constructor(){super(De.Yg.CreateAppState,[]),this.clientStateStorageKey="tmp.clientState",this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.ClientState",e)}))},this._updateTelemetryOnNetworkStateChange=(e,t)=>{e.observeIsOnline().subscribe((e=>{const n=e?"Online":"Offline";t.setCoreContext("AppInfo.NetworkState",n)}));e.observeDetailedNetworkState().subscribe((e=>{t.setCoreContext("AppInfo.DetailedNetworkState",e)}))},this._updateHostOnClientStateChange=(e,t,n)=>{const i=n.newLogger("updateHostOnClientStateChange");e.observe().subscribe((e=>t.loadModule("webclientstates").then((t=>{if(t&&t.notifyWebClientStateChange){const n=rI[e];t.notifyWebClientStateChange(n),i.log(`messaged host new ClientState (${e}). WebClientState sent: ${n}`)}else i.warn(`${mI.LoadModuleWebClientStatesFailed} or webclientstates.notifyWebClientStateChange is not loaded`)})).catch((e=>{i.errorToTelemetry&&i.errorToTelemetry(`Error happened: ${e.message||e}`,"webclient_framework_host_comms",void 0,!0)}))))},this._trackClientStateForGlassjar=(e,t)=>{e.observe().subscribe((e=>t.localStorage.setItem(this.clientStateStorageKey,e)))}}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:n,hostCommunicationService:i,hostSettings:a,loggerFactory:o,platformService:r,scenarioFactory:s,telemetryService:l,windowProvider:d}=e,c=null===(t=null==a?void 0:a.hostSettings)||void 0===t?void 0:t.appState,u=void 0!==c?c:De.eT.Inactive;e.appStateService=new uI(u);const m=new aI.u(d,o,n);e.hostState=new vI(d,o,i),e.clientState=new cI(d,o,m,n,e.hostState,c);const g=this._createNetworkStateProvider(e,e.clientState,e.appStateService);e.networkState=g,e.errorState=new $w(d,s,r,g,e.diagnosticsService,n),this._updateTelemetryOnClientStateChange(e.clientState,l),this._updateTelemetryOnNetworkStateChange(g,l);const{enableUpdateHostOnClientStateChange:p}=n.get(K.J.Core);p&&this._updateHostOnClientStateChange(e.clientState,i,o);const{isRunningGlassjar:v}=n.get(K.J.Test);v&&this._trackClientStateForGlassjar(e.clientState,d)}))}_createNetworkStateProvider(e,t,n){const{coreSettings:i,loggerFactory:a,scenarioFactory:o,windowProvider:r,endpointsManager:s,hostCommunicationService:l}=e,{enableNetworkOnlineDetection:d}=i.get(K.J.Core);return d?new FI(a,i,o,r,t,s):new RI(n,a,o,i,s,l)}}var OI=n(25521);class xI extends Fe{constructor(){super(De.Yg.CreateAuthenticationResources,["authenticationService","discover","coreSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.authenticationResources=new OI.I(e.authenticationService,e.discover,e.coreSettings)}))}}var LI=n(87412),UI=n(244449),BI=n(923036),jI=n(809752);class WI{constructor(e,t,n){var i;this._coreSettings=t,this._accountId=n,this.skypeIsDown=!1,this._criticalResources=[],this.cleanup=new gC.xQ,this.currentAuthState=new eS.X(LI.jq.Up),this.skypeTokenState=new eS.X(LI.QI.Unknown),this.resourceTokenStates=new Map,this.logSubscriptions=[],this.stateChangeLogs=[],this.defaultAuthStateChangeTimeout=3e4,this._logger=e.newLogger("AuthStateProvider"),this._logger.log("[AuthState] Initializing auth state to Up.");const{criticalResources:a,authStateChangeTimeout:o}=(null===(i=this._coreSettings)||void 0===i?void 0:i.get(K.J.Auth))||{};this._criticalResources=a||[],this._authStateChangeTimeout=null!=o?o:this.defaultAuthStateChangeTimeout,this.badTokenStates=new Map,this.skypeLogSubscription=this.skypeTokenState.pipe((0,cC.R)(this.cleanup)).pipe((0,sI.x)()).subscribe((e=>{this._logger.log(`[AuthState] Skype token state changed to: ${e}`),this.recordStateChange("SkypeToken",e)})),this.telemetryInterval=globalThis.window.setInterval((()=>{this.publishAuthStateTelemetry()}),UC.rF.ONE_HOUR),n&&(0,jI.kh)(this.currentAuthState.value,n)}observe(){return this.currentAuthState}getState(){return this.currentAuthState.value}getInteractionRequiredResource(){const e=this.badTokenStates.entries();let t=e.next();for(;!t.done;){if(t.value[1]===LI.QI.InteractionRequired)return t.value[0];t=e.next()}}reportResourceTokenState(e,t,n){this._criticalResources.includes(e)&&(this.updateTokenStateMap(e,t),t===LI.QI.Success?this.badTokenStates.has(e)&&(this.badTokenStates.clear(),this.skypeIsDown=!1):this.badTokenStates.set(e,t),this.evaluateCurrentState(n))}observeResourceTokenState(e){if(!this._criticalResources.includes(e))throw new Error("Unsupported resource, contact Auth team if you need your resource added.");let t=this.resourceTokenStates.get(e);return t||(t=this.updateTokenStateMap(e,LI.QI.Unknown)),t.pipe((0,cC.R)(this.cleanup)).pipe((0,sI.x)())}reportSkypeTokenState(e){this.skypeTokenState.next(e);const t=e===LI.QI.Failure;t!==this.skypeIsDown&&(this.skypeIsDown=t,this.evaluateCurrentState())}observeSkypeTokenState(){return this.skypeTokenState.pipe((0,cC.R)(this.cleanup)).pipe((0,sI.x)())}getSkypeTokenState(){return this.skypeTokenState.value}cleanupObservables(){var e;this._logger.log("[AuthState] Cleanup function called."),this.publishAuthStateTelemetry(),null===(e=null===globalThis||void 0===globalThis?void 0:globalThis.window)||void 0===e||e.clearInterval(this.telemetryInterval),this.cleanup.next(!0),this.cleanup.complete(),this.skypeTokenState.complete(),this.resourceTokenStates.forEach((e=>e.complete())),this.resourceTokenStates.clear(),this.skypeLogSubscription.unsubscribe(),this.logSubscriptions.forEach((e=>e.unsubscribe())),this.logSubscriptions=[]}recordStateChange(e,t){t!==LI.QI.Unknown&&this.stateChangeLogs.push(`${Date.now()}|${e}->${t}`)}publishAuthStateTelemetry(){if(this.stateChangeLogs.length<1)return;const e=UI.cv.create({subContext:"AuthState",correlation:{id:(0,BI.pW)(),source:"auth-state-provider",scenarioName:ft.RG.AuthPublishState}});e.addEventData(this.stateChangeLogs),e.closeScenario(),this.stateChangeLogs=[]}updateTokenStateMap(e,t){let n=this.resourceTokenStates.get(e);return n?n.next(t):(n=new eS.X(t),this.resourceTokenStates.set(e,n),this.logSubscriptions.push(n.pipe((0,cC.R)(this.cleanup)).pipe((0,sI.x)()).subscribe((t=>{this._logger.log(`[AuthState] ${e} token state changed to: ${t}`),this.recordStateChange(e,t)})))),n}evaluateCurrentState(e){let t;if(0===this.badTokenStates.size)t=this.skypeIsDown?LI.jq.SkypeReconnecting:LI.jq.Up;else{const e=this.badTokenStates.values();let n=e.next();for(;!n.done;){if(n.value===LI.QI.InteractionRequired){t=LI.jq.InteractionRequired;break}t=LI.jq.AADReconnecting,n=e.next()}}t&&this.changeAuthState(t,e)}changeAuthState(e,t){if(e===LI.jq.Up||e===LI.jq.InteractionRequired)this.pendingStateClearTimeout&&(globalThis.window.clearTimeout(this.pendingStateClearTimeout),this.pendingState=void 0,this.pendingError=void 0,this.pendingStateClearTimeout=void 0),this.changeTo(e,t);else if(this.pendingState)this.pendingState=e,this.pendingError=t;else{if(e===this.currentAuthState.value)return;this.pendingState=e,this.pendingError=t,this.pendingStateClearTimeout=globalThis.window.setTimeout((()=>{this.pendingState&&this.changeTo(this.pendingState,this.pendingError),this.pendingState=void 0,this.pendingError=void 0,this.pendingStateClearTimeout=void 0}),this._authStateChangeTimeout)}}changeTo(e,t){e!==this.currentAuthState.value&&(this._logger.warn(`[AuthState] Transition from ${this.currentAuthState.value} to ${e}`),this.recordStateChange("AuthState",e),this.currentAuthState.next(e),this._accountId&&(0,jI.kh)(e,this._accountId,t))}}var VI=n(597571),HI=n(913469),$I=n(73230),zI=n(538606),GI=n(640568),qI=n(531804);const QI="Login Rate limit exceeded",JI={AdminUserLicenseNotPresentForbidden:"AdminUserLicenseNotPresentForbidden",AdminTeamsDisabledForTenantForbidden:"AdminTeamsDisabledForTenantForbidden",UserLicenseNotPresentForbidde:"UserLicenseNotPresentForbidde",TeamsDisabledForTenantForbidden:"TeamsDisabledForTenantForbidden",UserLicenseNotPresentTrialEligible:"UserLicenseNotPresentTrialEligible",TrialLicenseTenantNotReady:"TrialLicenseTenantNotReady",NewFederatedUsersNotAllowed:"NewFederatedUsersNotAllowed"},YI=(e,t)=>(t<0||Date.now()-t>=Qo.gT.MILLISECONDS_PER_HOUR)&&((0,Mn.o7)(e)||[SI.qb.THROTTLED,SI.qb.NOT_AUTHORIZED,-1].indexOf(e)>-1),KI=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const r=(0,$I.uc)(a),{serverResponse:{status:s,body:l}={}}=e;null==r||r.appendEventData({statusCode:s}),(0,Mn.o7)(null!=s?s:0)?null==r||r.fail({message:(0,BI.VK)(e),errorCode:De.jK.ServiceUnavailable,statusCode:s}):-1!==s?((null===(i=l.message)||void 0===i?void 0:i.indexOf(QI))>-1&&(null==r||r.incomplete({message:(0,BI.VK)(e),errorCode:QI,statusCode:s}),o.error(`DiscoverRetryPolicy: Delaying skype token fetch for ${qI.b3.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD}' .`),(0,zI._)(qI.b3.DEFAULT_SKYPE_TOKEN_COOL_OFF_PERIOD)),yield ZI(e,t,n,a,o)):null==r||r.incomplete({message:(0,BI.VK)(e),errorCode:De.jK.TimedOut,statusCode:s})})),ZI=(e,t,n,a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,r;const s=(0,$I.uc)(a),{serverResponse:{status:l,body:d,headers:c}={}}=e;let u;try{const e=yield d.json();u=null===(i=null==e?void 0:e.error)||void 0===i?void 0:i.code}catch(e){o.error(`Body jsonify failed: ${e}`)}switch(o.error(`Getting errorCode: [${u}] from response`),l){case SI.qb.NOT_AUTHORIZED:yield eE(c,n,o,null===(r=t.options)||void 0===r?void 0:r.userIdentifier),null==s||s.incomplete({message:(0,BI.VK)(e),errorCode:null!=u?u:De.jK.Unauthorized,statusCode:l});break;case SI.qb.FORBIDDEN:((e,t)=>e===SI.qb.FORBIDDEN&&!!t&&t in JI)(l,u)&&XI(u,t,a),null==s||s.cancel({message:(0,BI.VK)(e),errorCode:null!=u?u:De.jK.Forbidden,statusCode:l});break;case SI.qb.THROTTLED:default:null==s||s.incomplete({message:(0,BI.VK)(e),errorCode:null!=u?u:De.jK.Throttled,statusCode:l})}})),XI=(e,t,n)=>{const i=(0,$I.uc)(n);if(e===JI.NewFederatedUsersNotAllowed)return t.headerUpdate||(t.headerUpdate={strongConsistencyValue:(a=qI.vu.strongConsistencyMsInternalUserSignup,qI.vu.strongConsistencyDefaultValue.replace("{id}",a))}),void(null==i||i.mark(JI.NewFederatedUsersNotAllowed));var a;e===JI.UserLicenseNotPresentTrialEligible?(null==i||i.mark(JI.UserLicenseNotPresentTrialEligible),t.lastLicenseErrorTime=-1):t.lastLicenseErrorTime=Date.now()},eE=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;e&&0!==(null===(i=Object.keys(e))||void 0===i?void 0:i.length)?yield t(e,a):n.error("DiscoverUnauthorizeError: header is empty")}));const tE=(e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return nE(e,t,iE)({policy:n,delay:n.createDelay(),retryCount:0,retriesTable:{},startTime:Date.now().valueOf(),forever:n.foreverCheck,headerUpdate:void 0,lastLicenseErrorTime:-1,options:{userIdentifier:null!=a?a:void 0}})})),nE=(e,t,n)=>a=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){for(var i;;){const o=t;(null===(i=a.headerUpdate)||void 0===i?void 0:i.strongConsistencyValue)&&(o.headers||(o.headers={}),o.headers.ConsistencyLevel=a.headerUpdate.strongConsistencyValue);try{return yield e(o)}catch(e){yield n(e,a)}}})),iE=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!e.serverResponse)throw e;const n=!(yield t.forever()),{serverResponse:{status:i}}=e;if(-1!==t.startTime&&Date.now().valueOf()-t.startTime>=t.policy.retryMaxTimeMs&&(t.startTime=-1,t.policy.retryMaxTimeCallback(n)),i&&t.policy.isOnline()&&(t.retryCount++<t.policy.maxRetryCount&&!n||n)&&t.policy.shouldRetry(i,t.lastLicenseErrorTime))return t.retriesTable[i]=(t.retriesTable[i]||0)+1,t.policy.errorHandler(e,t);throw e}));var aE=n(39635),oE=n(272097),rE=n(20204),sE=n(372304),lE=n(813459),dE=n(666013),cE=n(45417);class uE{constructor(e,t,n,a,o,r,s,l,d,c,u,m,g=(0,Ze.J)()){var p,v,h,f,y;this._authenticationService=e,this._coreSettings=a,this._scenarioFactory=o,this._networkStateProvider=r,this._i18n=s,this._authStateProvider=l,this.onDiscoverSuccess=d,this.onDiscoverFail=c,this.isCDLWorker=u,this.cdlAuthClient=m,this.globalScope=g,this._skypeToken=new eS.X(null),this._localStorageKeys=[],this.clearDiscoveryCacheForLogout=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,oE.Xx)(e);this.clearDiscoveryCache(t,["^fn:clearDiscoveryCacheForLogout"])})),this.clearDiscoveryCache=(e,t,n)=>{this._skypeToken=new eS.X(null),rE.Jt.del((0,$I.Z2)(e)),null==t||t.push("skypeCacheClear"),n||(rE.Jt.del((0,$I.Mu)(e)),null==t||t.push("userDetailsCacheClear"),rE.Jt.del((0,$I.S9)(e)),null==t||t.push("regionGtmsCacheClear")),this._clearFromLocalStorage(n),null==t||t.push("localstorageCacheClear"),this._logger.log(`[clearDiscoveryCache] Discover cache cleared, tokenOnly: ${!!n}.`)},this._getDiscoverResponse=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,a;const{correlationId:o=(0,BI.pW)(),eventData:r=[]}=e;null==r||r.push("_getDiscoverResponse|startScenario");const s=this._scenarioFactory.newScenario(ft.RG.GetSkypeToken);let l;try{if(!this._isAppOnline())throw(0,sE.Tr)(Object.assign(Object.assign({},$I.bO),{correlationId:o}));if((null===(t=this._authStateProvider)||void 0===t?void 0:t.getState())===LI.jq.InteractionRequired)throw(0,sE.Tr)(Object.assign(Object.assign({},$I.BD),{correlationId:o}));l=yield this._discoverProvider(Object.assign(Object.assign({},e),{eventData:r})),(0,$I.nH)(l,this._coreSettings,this._telemetryProvider,this._logger)}catch(e){throw e.errorCode!==UC.SM.InteractionRequired?(null===(n=this._authStateProvider)||void 0===n||n.reportSkypeTokenState(LI.QI.Failure),null==r||r.push("authState:0")):null===(i=this._authStateProvider)||void 0===i||i.reportSkypeTokenState(LI.QI.InteractionRequired),this.onDiscoverFail&&this.onDiscoverFail(!!this._bootstrapData),(0,$I.lm)(e,r,this._isAppOnline(),s,this._logger,this._coreSettings)}null===(a=this._authStateProvider)||void 0===a||a.reportSkypeTokenState(LI.QI.Success);const d=(0,$I.ZC)(l,this._logger);yield(0,$I.ut)(e.userIdentifier,d,r,o,this._logger,this._scenarioFactory,this.globalScope,this._coreSettings);const c=yield(0,$I.qW)(this._authenticationService,this._logger,r);return(0,oE.FG)(null==e?void 0:e.userIdentifier,c)||!(null==e?void 0:e.userIdentifier)?this._skypeToken.next(l.skypeToken):this._logger.error(`[_getDiscoverResponse][${o}] option uid:${null==e?void 0:e.userIdentifier}`),null==s||s.stop({reason:r.join(";")}),this.onDiscoverSuccess&&this.onDiscoverSuccess(),l})),this._isSkypeTokenValidInMemory=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=null!=e?e:yield(0,$I.qW)(this._authenticationService,this._logger,[]);return!!rE.Jt.getValue((0,$I.Z2)(t))})),this._retryMaxTimeCallback=e=>{var t;return e?(null===(t=this._authStateProvider)||void 0===t||t.reportSkypeTokenState(LI.QI.Failure),this._logger.error("[_retryMaxTimeCallback]Reporting skype token failure to authState"),!1):(this._logger.warn("[_retryMaxTimeCallback] Reached retry max time."),!1)},this._getResponseFromLocalStorage=(e,t)=>{if(!t||!e)return;const n=this._getFromLocalStorage(e,t,"auth.gtm.table"),i=this._getFromLocalStorage(e,t,"auth.skype.token");return n&&i?Object.assign(Object.assign({},i.userDetails),{skypeToken:i.skypeToken,expires:new Date(i.expiration),regionGtms:n}):void 0},this._getCachedResponseWrapper=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n;return this._getResponseFromLocalStorage(null===(t=null==e?void 0:e.profile)||void 0===t?void 0:t.oid,null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.tid)})),this._acquireSkypeTokenWeb=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,a;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenWeb");let o=yield this._authenticationService.getUser({accountId:e.userIdentifier.id,userIdentifier:e.userIdentifier,correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:ft.RG.AuthWebUser}});if(null===(n=e.eventData)||void 0===n||n.push("user:"+ +!!o,"uid:"+ +!!e.userIdentifier),!o){if(o=yield this._authenticationService.getUser({correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:ft.RG.AuthWebUser}}),!o)throw(0,sE.Tr)({context:qI.xm,subContext:"_acquireSkypeTokenWeb",errorCode:UC.SM.UserNotFoundError,message:"User not found for provided userIdentifier nor globally.",correlationId:e.correlationId,isExpected:!1});(0,$I.nD)(e,o,this._logger)}const r=yield this._getCachedResponseWrapper(o);if(r)return null===(i=e.eventData)||void 0===i||i.push("cache:1"),r;const s=rE.Jt.getValue((0,$I.Mu)((0,oE.Xx)(o))),l=(0,$I.TB)(o,e.correlationId,this._coreSettings,this._logger,this._i18n,!!s),d=this._scenarioFactory.findScenario(ft.RG.GetSkypeToken);null==d||d.mark(qI.j.SKYPE_SEND_REQUEST,(0,$I.nd)(e.eventData,this._isAppOnline(),this._coreSettings));const c=yield this.send({userIdentifier:e.userIdentifier,correlationId:e.correlationId})(l);return null===(a=e.eventData)||void 0===a||a.push("response:1"),null==d||d.mark(qI.j.SKYPE_RECEIVED_RESPONSE,(0,$I.nd)(e.eventData,this._isAppOnline(),this._coreSettings)),d&&(d.eventData.authzCorrelationId=c.headers["correlation-id"],d.eventData.correlationTags=c.headers["correlation-tags"],d.eventData.correlationId=null==e?void 0:e.correlationId),(0,$I.Qe)(c,e,this._logger)})),this._acquireSkypeTokenDesktop=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,a;null===(t=e.eventData)||void 0===t||t.push("fn:_acquireSkypeTokenDesktop");const o=yield this._authenticationService.getUser({accountId:e.userIdentifier.id,userIdentifier:e.userIdentifier,correlation:{id:e.correlationId,source:"discoverV2::_acquireSkypeTokenWeb",scenarioName:ft.RG.AuthWebUser}}),r=yield this._getCachedResponseWrapper(o);if(r)return r;null===(n=e.eventData)||void 0===n||n.push("cache:0");const s=this._scenarioFactory.findScenario(ft.RG.GetSkypeToken);null==s||s.mark(qI.j.SKYPE_SEND_REQUEST_DESKTOP);const l=yield this.globalScope.opener.requestMessage(vb.rY.GetStateData,{requestType:"skypeToken",timeout:Qo.lP.ACQUIRE_TOKEN_TIMEOUT});null==s||s.mark(qI.j.SKYPE_RECEIVED_RESPONSE);const d=null==l?void 0:l.skypeTokenData;s&&(s.eventData.correlationId=null==l?void 0:l.correlationId);return{userId:(0,$I.LO)(null===(i=null==d?void 0:d.token)||void 0===i?void 0:i.skypeToken,this._logger),userDetails:null==d?void 0:d.userDetails,skypeToken:null===(a=null==d?void 0:d.token)||void 0===a?void 0:a.skypeToken,regionGtms:null==d?void 0:d.regionGtms,expires:new Date(null==d?void 0:d.token.expiration)}})),this._acquireSkypeTokenWorker=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{eventData:t}=e;if(t.push("fn:_acquireSkypeTokenWorker"),!this.cdlAuthClient)throw(0,sE.Tr)({context:qI.xm,subContext:"_acquireSkypeTokenWorker",errorCode:De.jK.NotPresent,message:"CDL worker auth client unavailable",correlationId:e.correlationId,isExpected:!1});const n=!1!==e.forceRenew,i=this._scenarioFactory.findScenario(ft.RG.GetSkypeToken);null==i||i.mark(qI.j.SKYPE_SEND_REQUEST_WORKER);const a=yield this.cdlAuthClient.getSkypeToken(n);return null==i||i.mark(qI.j.SKYPE_TOKEN_RECEIVED_WORKER),Object.assign(Object.assign({userId:(0,$I.LO)(a.skypeToken,this._logger)},a.userDetails),{skypeToken:a.skypeToken,regionGtms:a.regionGtms,expires:new Date(a.expiration)})})),this._getRetryForSend=e=>{const{authzResource:t,disableRetryInDiscoverV2:n}=this._coreSettings.get(K.J.Auth);return a=>{var o;if(!this._authenticationService.authorizeV2)throw(0,sE.Tr)({context:qI.xm,subContext:"_getRetryForSend",errorCode:"AuthorizeV2NotFound",message:"AuthorizeV2 endpoint not accessible",correlationId:null!==(o=a.correlationId)&&void 0!==o?o:(0,BI.pW)(),isExpected:!1});const r=this._authenticationService.authorizeV2.bind(this._authenticationService),s=()=>(0,HI.B)(r(e,t||Qo.ej.MT_AAD_KEY,{userIdentifier:a.userIdentifier}),SI.qb.OK);return n?s():function(e,t,n){return i=>tE(e,i,t,n)}(s(),((e,t,n,a,o,r)=>({shouldRetry:YI,errorHandler:(a,o)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=(0,$I.uc)(t),{serverResponse:{status:r,headers:s}={}}=a;if(!r||!o.retriesTable[r])throw a.reason=Object.assign(Object.assign({},a.reason),{scenarioStep:"fail"}),a.message=`dicoverRetryPolicy: retry count for ${r} is empty`,a;const l=null==s?void 0:s["correlation-id"],d=null==s?void 0:s["correlation-tags"];null==i||i.appendEventData({authzCorrelationId:l,correlationTags:d}),o.headerUpdate=void 0,yield KI(a,o,n,t,e),e.error(`[DiscoverRetryPolicy]: retrying '[${o.retryCount}]' times due to response status - '[${r}], wait for '[${o.delay.next()}] for next retry..'`);const c=yield o.forever();if(o.retryCount>=o.policy.maxRetryCount&&c)throw e.log(`[DiscoverRetryPolicy]: maxTimeReached count: ${o.retryCount} and tokenValid, cancel forever`),a.reason=["LoggedAlready"],a;return(0,zI._)(o.delay.next())})),retryMaxTimeMs:Qo.lP.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS,maxRetryCount:Qo.lP.DEFAULT_SKYPE_MAX_RETRY_COUNT,createDelay:()=>new GI.df(Qo.lP.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS,Qo.lP.DEFAULT_SKYPE_EXP_DELAY_FACTOR,Qo.lP.DEFAULT_SKYPE_MAX_DELAY_TIME_MS),isOnline:a,retryMaxTimeCallback:o,foreverCheck:r}))(this._logger,this._scenarioFactory,this.unauthorizedErrorHandler,this._isAppOnline,this._retryMaxTimeCallback,this._isSkypeTokenValidInMemory),a.userIdentifier)}},this._isRefreshInBackgroundRequired=(e,t,n,i)=>{(null==e?void 0:e.shouldRefresh)&&(null==n||n.push("shouldrefreshbg"),this._debouncedGetDiscoverResponse((0,Ci.u4)(t),{userIdentifier:t,correlationId:i,eventData:n}).catch((e=>{(0,$I.H)(e,null==e?void 0:e.message,n,this._logger)})))},this._populateDiscoverResponseFromBootstrapdata=()=>{this._bootstrapData=this._coreSettings.get(K.J.Host).authBootstrapData,this._bootstrapData},this._isAppOnline=()=>this._networkStateProvider.getState()===Sv.G.Online,this.unauthorizedErrorHandler=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){(0,$I.qO)(e,t,this._authenticationService,this._coreSettings,this._logger)})),this._logger=t.newLogger(qI.xm),(0,lE.g)(this,"DiscoverV2",this._getConfig("mockApi"),this._getConfig("enableMockApi")),this.send=this._getRetryForSend(n),this._debouncedGetDiscoverResponse=(0,dE.k)(this._getDiscoverResponse),(0,rE.ky)(g),this._populateDiscoverResponseFromBootstrapdata(),this._discoverProvider=this.resolveProvider(),null===(v=null===(p=this._authenticationService)||void 0===p?void 0:p.registerCleanUpOnLogoutCallback)||void 0===v||v.call(p,Ot.D.Discover,this.clearDiscoveryCacheForLogout),this._tokenObserver=null===(y=null===(f=(h=this._authenticationService).observeMiddleTierToken)||void 0===f?void 0:f.call(h))||void 0===y?void 0:y.subscribe((e=>{void 0===e&&(0,$I.qW)(this._authenticationService,this._logger,[]).then((e=>{e&&rE.Jt.del((0,$I.Z2)(e))}))})),this._telemetryProvider=(0,DC.G)(),this._logger.log("[ctor]Service initialized.")}observeSkypeToken(){return this._skypeToken.pipe((0,rS.h)((e=>null!==e)),(0,sI.x)())}shouldThrowErrorIfSkypeTokenIsEmpty(){return!this._coreSettings.get(K.J.Auth).disableThrowingErrorIfSkypeTokenIsEmpty}getSettingToDisableSkypeTokenValidation(e,t){return(0,$I.wh)(e,t,this._coreSettings,this._logger,this._scenarioFactory)}regionGtm(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=(0,BI.pW)(),i=["^fn:regionGtm:uid:"+ +!!t];try{const a=null!=t?t:yield(0,$I.qW)(this._authenticationService,this._logger,i);let o=rE.Jt.getValue((0,$I.S9)(a));if(!o){this._logger.log(`[regionGtm][${n}] No cached regionGtm, start network call..`),null==i||i.push("cache:0");const e=yield this._debouncedGetDiscoverResponse((0,Ci.u4)(a),{userIdentifier:a,correlationId:n,eventData:i});o=null==e?void 0:e.regionGtms,null==i||i.push(`InResponse:${!!o}`)}const r=null==o?void 0:o[e];if(r)return r===qI.sW?r:(0,YN.m)(r);throw(0,sE.Tr)({correlationId:n,message:`${qI.xm}[regionGtm][${n}] ${e} not found in regionGtms table`,isExpected:!0,context:qI.xm,subContext:"regionGtm",errorCode:"RegionGtmNotFoundInRespone"})}catch(e){throw(0,$I.WA)(e,"regionGtm",n),(0,$I.H)(e,null==e?void 0:e.message,i,this._logger)}}))}skypeid(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,BI.pW)(),n=["^fn:skypeid:uid:"+ +!!e];try{const n=yield this.getUser(t,e);if(!n){const e=`[skypeid][${t}] No userDetail for getting skypeId`;throw this._logger.error(e),new Error(`${qI.xm} No user for getting skypeId`)}return n.id}catch(e){throw(0,$I.WA)(e,"skypeid",t),(0,$I.H)(e,null==e?void 0:e.message,n,this._logger)}}))}validateSkypeToken(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield this.validateSkypeTokenV2(e)).skypeToken}))}validateSkypeTokenV2(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,BI.pW)(),a=["^fn:validateSkypeToken:uid:"+ +!!(null==e?void 0:e.userIdentifier)];try{const o=null!==(t=null==e?void 0:e.userIdentifier)&&void 0!==t?t:yield(0,$I.qW)(this._authenticationService,this._logger,a),r=rE.Jt.get((0,$I.Z2)(o)),s=null==r?void 0:r.item;if(a.push(`cache:${!!s}`),s&&(yield(0,aE.p)(s,this.globalScope,this._scenarioFactory,this._coreSettings)),(null==o?void 0:o.accountType)===XT.Ch.Anonymous&&(null==s?void 0:s.skypeToken)&&!this._coreSettings.get(K.J.Auth).disableIgnoringForceRenewForAnon)return{skypeToken:s.skypeToken,fromCache:!0};const l=null==e?void 0:e.forceRenew,d=null==e?void 0:e.invalidSkypeToken;if(!l&&s&&s.skypeToken&&s.skypeToken!==d&&s.expiration&&s.expiration>Date.now())return this._isRefreshInBackgroundRequired(r,o,a,i),this._skypeToken.value||this._skypeToken.next(s.skypeToken),null===(n=this._authStateProvider)||void 0===n||n.reportSkypeTokenState(LI.QI.Success),{skypeToken:s.skypeToken,fromCache:!0};this.clearDiscoveryCache(o,a,!0),this._logger.log(`[validateSkypeToken][${i}] Skype token not valid during ping of forceRenew:${l}, clear old cache and start wire request.`);const c=yield this._debouncedGetDiscoverResponse((0,Ci.u4)(o),{userIdentifier:o,correlationId:i,eventData:a});return this._logger.log(`[validateSkypeToken][${i}] SkypeToken fetched from network.`),a.push(`InResponse:${!!c.skypeToken}`),{skypeToken:c.skypeToken,fromCache:!1}}catch(e){throw(0,$I.WA)(e,"validateSkypeToken",i),(0,$I.H)(e,null==e?void 0:e.message,a,this._logger)}}))}getRegion(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,BI.pW)(),n=["^fn:getRegion:uid:"+ +!!e];try{const i=null!=e?e:yield(0,$I.qW)(this._authenticationService,this._logger,n),a=rE.Jt.getValue((0,$I.Mu)(i));if(a)return a.region;n.push("cache:0"),this._logger.log(`[getRegion][${t}] No user details found in cache. Getting it from request.`);const o=yield this._debouncedGetDiscoverResponse((0,Ci.u4)(i),{userIdentifier:i,correlationId:t,eventData:n});return n.push(`InResponse:${!!o.region}`),o.region}catch(e){throw(0,$I.WA)(e,"getRegion",t),(0,$I.H)(e,null==e?void 0:e.message,n,this._logger)}}))}getUser(e=(0,BI.pW)(),t){var n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=["^fn:getUser:uid:"+ +!!t];try{const o=null!=t?t:yield(0,$I.qW)(this._authenticationService,this._logger,i);let r=rE.Jt.getValue((0,$I.Mu)(o));if(r||(this._logger.log(`[getUser][${e}]No cache, start network call...`),i.push("cache:0"),i.push(`IsCDL:${this.isCDLWorker&&this.cdlAuthClient}`),r=this.isCDLWorker&&this.cdlAuthClient?null===(n=yield this.cdlAuthClient.getUserDetails())||void 0===n?void 0:n.userDetails:(0,$I.br)(i,this._bootstrapData,this._logger)||(null===(a=yield this.getSkypeTokenInfoFromDiscoveryResponse({silent:!1,correlationId:e,userIdentifier:t,eventData:i}))||void 0===a?void 0:a.userDetails)),!r)throw new Error(`${qI.xm}[getUser][${e}] UserDetails fetched failure from network request`);return(0,$I.wC)(r)}catch(t){(0,$I.WA)(t,"getUser",e);const n=(0,$I.H)(t,null==t?void 0:t.message,i,this._logger);throw new cE.l(n)}}))}getSkypeTokenInfoFromDiscoveryResponse(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{correlationId:i=(0,BI.pW)(),userIdentifier:o}=e||{},r=null!==(t=null==e?void 0:e.eventData)&&void 0!==t?t:[];null==r||r.push("fn:getSkypeTokenInfoFromDiscoveryResponse");try{const t=null!=o?o:yield(0,$I.qW)(this._authenticationService,this._logger,r),s=null==e?void 0:e.forceRenew,l=rE.Jt.get((0,$I.Z2)(t));if((null==t?void 0:t.accountType)===XT.Ch.Anonymous&&(null===(n=null==l?void 0:l.item)||void 0===n?void 0:n.skypeToken)&&!this._coreSettings.get(K.J.Auth).disableIgnoringForceRenewForAnon)return l.item;let d;if(l&&l.item&&!s)this._isRefreshInBackgroundRequired(l,t,r,i),d=l.item;else{null==r||r.push("cache:0"),this._logger.log(`[getSkypeTokenInfoFromDiscoveryResponse][${i}] No response retrieved from cache.`),this.clearDiscoveryCache(t,r,!0);const n=yield this._debouncedGetDiscoverResponse((0,Ci.u4)(t),Object.assign(Object.assign({},e),{userIdentifier:t,eventData:r}));d=(0,$I.ZC)(n,this._logger)}return null===(a=this._authStateProvider)||void 0===a||a.reportSkypeTokenState(LI.QI.Success),d}catch(e){throw(0,$I.WA)(e,"getSkypeTokenInfoFromDiscoveryResponse",i),(0,$I.H)(e,null==e?void 0:e.message,r,this._logger)}}))}unsubscribeMtToken(){var e;null===(e=this._tokenObserver)||void 0===e||e.unsubscribe()}getConsumerLicenseDetails(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=(0,BI.pW)(),i=["^fn:getConsumerLicenseDetails:uid:"+ +!!e];try{const a=null!=e?e:yield(0,$I.qW)(this._authenticationService,this._logger,i);if(!(a.accountType===XT.Ch.MsaLife))return this._logger.log(`[getConsumerLicenseDetails][${n}] User account type is not MsaLife.`),Promise.resolve(void 0);const o=rE.Jt.getValue((0,$I.Mu)(a)),r=null===(t=null==o?void 0:o.licenseDetails)||void 0===t?void 0:t.consumerLicenseDetails;if(r)return r;i.push("cache:0"),this._logger.log(`[getConsumerLicenseDetails][${n}] No user license details found in cache. Getting it from request.`);const s=yield this._debouncedGetDiscoverResponse((0,Ci.u4)(a),{userIdentifier:a,correlationId:n,eventData:i});return i.push(`InResponse:${!!(null==s?void 0:s.consumerLicenseDetails)}`),null==s?void 0:s.consumerLicenseDetails}catch(e){throw(0,$I.WA)(e,"getConsumerLicenseDetails",n),(0,$I.H)(e,null==e?void 0:e.message,i,this._logger)}}))}_clearFromLocalStorage(e){var t;(null===(t=this.globalScope)||void 0===t?void 0:t.localStorage)&&(e?this._localStorageKeys.forEach((e=>{e.indexOf("auth.skype.token")>-1&&this.globalScope.localStorage.removeItem(e)})):this._localStorageKeys.forEach((e=>{this.globalScope.localStorage.removeItem(e)})),this._localStorageKeys=[])}resolveProvider(){return this._bootstrapData?this._acquireSkypeTokenDesktop:this.isCDLWorker?this._acquireSkypeTokenWorker:this._acquireSkypeTokenWeb}_getFromLocalStorage(e,t,n){var i;if(!(null===(i=this.globalScope)||void 0===i?void 0:i.localStorage))return;let a=`ts.${t}-${e}.${n}`,o=this.globalScope.localStorage.getItem(a);if(o||(a=`ts.${e}.${n}`,o=this.globalScope.localStorage.getItem(a)),o){this._localStorageKeys.push(a);try{return JSON.parse(o)}catch(e){this._logger.error(`[_getFromLocalStorage] ${e}`)}}}_getConfig(e){return this._coreSettings.get(K.J.Auth)[e]}}const mE=(e,t,n,i,a,o,r,s,l,d,c,u,m,g,p)=>{const{enableRequireDiscoverV2:v}=i.get(K.J.Auth);return v?new uE(e,t,n,i,a,r,s,l,c,u,m,g,p):new VI.Jq(e,t,n,i,a,o,d,c,u,m,g,p)};var gE=n(645794);class pE extends Fe{constructor(){super(De.Yg.CreateAuthMTMA,["appStateService","loggerFactory","scenarioFactory","networkState","coreSettings","authenticationService","authenticationUser","telemetryService","i18n","deeplinkService","userBiService"])}execute(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appStateService:i,loggerFactory:a,scenarioFactory:o,networkState:r,coreSettings:s,authenticationService:l,authenticationUser:d,telemetryService:c,i18n:u,deeplinkService:m,userBiService:g}=e,{enableUserAuthT2:p}=s.get(K.J.Auth)||{};if(!p)return;(0,UI.u)(null==d?void 0:d.id,g);const v=vE(d);try{if(!d)throw new Error("No AuthenticationUserContext found during User Auth init.");if(!l.createUserAuth)throw new Error("No User Auth Creation API exposed.");const n=new WI(a,s,d.id);e.authStateProvider=n,v.addEventData(["authState:created"]);const g=null===(t=l.createUserAuth)||void 0===t?void 0:t.call(l,d,"create-auth-mtma-task",n,m);e.authenticationService=g,v.addEventData(["userAuth:created"]);const p=(0,gE.Gg)(i);let h;s.get(K.J.Telemetry).useTelemetryServicesCache&&(h=c.getTelemetryServicesCache().get(d.id),v.setUserToTelemetryContext({id:d.id,oid:d.profile.objectId,tid:d.profile.tenantId,type:d.type,role:d.role,subType:d.subType}));const f=mE(g,a,Me.l,s,(null==h?void 0:h.coreScenarioFactory)||o,p,r,u,n,void 0,void 0,void 0,void 0,void 0);return e.discover=f,v.addEventData(["discover:created"]),f.validateSkypeToken(),s.get(K.J.Telemetry).useTelemetryServicesCache&&f.getRegion().then((e=>v.setUserDetailsToTelemetryContext({region:e||""}))),v.closeScenario(),e=>{switch(e){case"quit":case"restart":break;case"signout":default:null==n||n.cleanupObservables()}}}catch(e){const t=e instanceof cE.l?e:new cE.l(e);throw v.closeScenario({error:null!==(n=t.prevError)&&void 0!==n?n:e}),t}}))}}const vE=e=>{const t={id:(0,BI.pW)(),scenarioName:ft.RG.AuthUserInit,source:"create-auth-mtma-task::execute"};return UI.cv.create({correlation:t,subContext:"createAuthMTMATask",timeoutMs:UC.rF.ONE_HOUR,scenarioEventData:{context:`id:${!!(null==e?void 0:e.id)}`,accountId:null==e?void 0:e.id}})};class hE extends Fe{constructor(){super(De.Yg.CreateAuthStateTask,["loggerFactory","coreSettings","telemetryService"]),this._updateTelemetryOnClientStateChange=(e,t)=>{e.observe().subscribe((e=>{t.setCoreContext("AppInfo.AuthState",e)}))}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,coreSettings:n,telemetryService:i}=e,{enableAuthState:a,enableUserAuthT2:o}=n.get(K.J.Auth);if(!a||o)return;const r=new WI(t,n);e.authStateProvider=r,this._updateTelemetryOnClientStateChange(r,i)}))}}var fE=n(709167);const yE=(e,t,n)=>{var i;const{environment:a}=null!==(i=n.get(K.J.Metadata))&&void 0!==i?i:{},{clientType:o,currentUrl:r,hostingParent:s,isInIframe:l,isInCypressFrame:d,browser:c,browserVersion:u,osPlatform:m,osVersion:g}=t.config;return Object.assign(Object.assign({},e),{clientType:o,currentUrl:r,hostingParent:s,isInIframe:l,isInCypressFrame:d,browser:c,browserVersion:u,osPlatform:m,osVersion:g,environment:a})},kE=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){e.initializeAuthenticationService&&(yield e.initializeAuthenticationService())})),SE=(e,t,n,i)=>{const a={id:(0,BI.pW)(),scenarioName:ft.RG.AuthStart,source:"core-auth-tasks::init"};return rE.Jt.put(fE.Jl.authSessionId,a.id),UI.cv.create({correlation:a,subContext:"createAuthenticationServiceInstance",timeoutMs:UC.rF.ONE_HOUR,scenarioEventData:{context:`env:${e}||host:${t}||v2:${+!!n}||global:${+!!i}`}})};class bE extends Fe{constructor(){super(De.Yg.CreateAuth,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.authenticationService=yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t,i,a;const{loggerFactory:o,scenarioFactory:r,config:s,appStateService:l,coreSettings:c,windowProvider:u,platformService:m,authStateProvider:g,hostCommunicationService:p,telemetryService:v,i18n:h,rebootService:f,userBiService:y}=e;(0,rE.ky)(u),(0,UI.Tu)(r,v),(0,UI.u)(void 0,y);const k=yE(s,m,c),S=(0,gE.Gg)(l),{enableAuthV2:b,enableUserAuthT2:C}=(null==c?void 0:c.get(K.J.Auth))||{},w=SE(null!==(t=k.environment)&&void 0!==t?t:"",null===(i=null==u?void 0:u.location)||void 0===i?void 0:i.hostname,!!b,!!C);let N;try{N=b?C?new((yield(0,d.mT)((()=>Promise.all([n.e(65492),n.e(44240),n.e(8983)]).then(n.bind(n,941824))),"global-auth",r)).GlobalAuthService)(o,r,k,u,p,h,c,f):new((yield(0,d.mT)((()=>Promise.all([n.e(65492),n.e(44240),n.e(96106)]).then(n.bind(n,54619))),"auth_v2",r)).AuthenticationService)(o,r,k,u,p,h,g,c):new((yield(0,d.mT)((()=>Promise.all([n.e(12084),n.e(11095),n.e(59818)]).then(n.bind(n,786705))),"auth",r)).AuthenticationService)(o,r,S,k,u,v,c,p),yield kE(N),w.closeScenario()}catch(e){const t=e instanceof cE.l?e:new cE.l(e);throw w.closeScenario({error:null!==(a=t.prevError)&&void 0!==a?a:e}),t}return N})))(e)}))}}const CE=(e,t)=>UI.cv.create({correlation:e,subContext:"createAuthTenantsTask",timeoutMs:UC.rF.ONE_HOUR,scenarioEventData:{accountId:null==t?void 0:t.id}});class wE extends Fe{constructor(){super(De.Yg.CreateAuthTenants,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e;yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{coreSettings:n,authenticationUser:i,endpointsManager:a,authenticationService:o}=e,{enableUserAuthT2:r,enableMultiTenants:s}=n.get(K.J.Auth)||{},{testAutomation:l}=n.get(K.J.Test)||{};if(!r||!s)return;const d={id:(0,BI.pW)(),scenarioName:ft.RG.AuthWebSetUpTenants,source:"create-auth-tenants-task::setupTenantService"},c=CE(d,i);try{if(!i)throw new Error("No AuthenticationUserContext found during OnUserAuthenticated_MTMA hook");if(!o.setUpTenantsService||!o.getTenants)throw new Error("No TenantsService Set Up found duringGetTenants Task");const e={accountId:i.id,correlation:c.correlation,forceRefresh:!l};try{yield o.setUpTenantsService(a,e)}catch(e){return void c.closeScenario({error:e})}c.addEventData(["tenantService:created"]),o.getTenants(e).then((e=>{c.appendScenarioEventData({tenantCount:null==e?void 0:e.length}),c.closeScenario()})).catch((e=>{c.closeScenario({error:e})}))}catch(e){const n=e instanceof cE.l?e:new cE.l(e);throw c.closeScenario({error:null!==(t=n.prevError)&&void 0!==t?t:e}),n}})))(t);const{enableTenantPolling:n}=t.coreSettings.get(K.J.Auth);if(!n)return;const a=yield(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{coreSettings:n,authenticationService:a,windowProvider:o,authenticationUser:r,correlation:s}=e;if(!r)throw new Error("No AuthenticationUserContext found during OnUserAuthenticated_MTMA hook");if(!(yield a.getUser()).profile.isHomeAccount)return;const l=(null===(t=n.get(K.J.Auth))||void 0===t?void 0:t.tenantPollingMiliseconds)||UC.rF.ONE_DAY,d=o.setInterval((()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e={id:s.id,scenarioName:ft.RG.AuthWebGetTenantsInterval,source:"create-auth-tenants-task::tenantPollingInterval"},t=CE(e,r);try{const n={accountId:r.id,forceRefresh:!0,correlation:e};if(!a.getTenants)throw new Error("No valid getTenants function inside tenant polling interval");const i=yield a.getTenants(n);t.addEventData(["tenantService:AuthWebTenantPolling"]),t.appendScenarioEventData({tenantCount:null==i?void 0:i.length}),t.closeScenario()}catch(e){t.closeScenario({error:e}),o.clearInterval(d)}}))),l);return Promise.resolve(d)})))(t);return e=>{if(a)switch(e){case"signout":t.windowProvider.clearInterval(a);break;case"quit":case"restart":default:return}}}))}}class NE extends Fe{constructor(){super(De.Yg.CreateCacheClearing,["clientState","windowProvider"]),this._clearCacheOnClientStateChangeToInactive=(e,t)=>{e.observe().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var n;e===VS.pk.Inactive&&(yield null===(n=this.dataEvictionService)||void 0===n?void 0:n.evict(),t.clearCache())}))))}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,windowProvider:n,dataEvictionService:i}=e;this.dataEvictionService=i,this._clearCacheOnClientStateChangeToInactive(t,n)}))}}var TE=n(133973),IE=n(108117);class EE extends Fe{constructor(){super(De.Yg.CreateCacheStorageAndCacheManagers,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,windowProvider:n,config:i,loggerFactory:a}=e;t&&(e.cacheStorage=new TE.E(n.caches,t.profile.tenantId,t.profile.objectId,i.experienceName)),e.cacheStorage&&(e.offlineCacheManager=new IE.G(e.cacheStorage,a))}))}}var AE=n(912941),_E=n(148585);class DE{constructor(e){this.context=e,this._appServiceStateMap=this._newAppServiceStateMap(),this._logger=e.loggerFactory.newLogger("CDLApplicationStateService")}notifyServiceUp(e,t,n){this.notifyAppServiceStateChange(e,t,_E.l.ONLINE,n)}notifyServiceDown(e,t,n,i){this.notifyAppServiceStateChange(e,t,_E.l.OFFLINE,n,i)}observeAppServiceState(){const e=Array.from(Object.values(this._appServiceStateMap)).map((e=>e.asObservable().pipe((0,sI.x)())));return(0,AE.T)(...e)}_newAppServiceStateMap(){return Object.values(_E.Q).reduce(((e,t)=>{var n;return e[t]=(n=t,new eS.X({appService:n,currentState:_E.l.UNKNOWN})),e}),{})}notifyAppServiceStateChange(e,t,n,i,a){var o,r,s,l,d;if(!!this.context.coreSettings.get(K.J.CdlWorker).enableUserContextWorkerRegistration&&(null===(o=this.context.cdlWorkerRegistrarService)||void 0===o?void 0:o.mainWindowWorkerId)!==e.workerId)return void(null===(s=(r=this._logger).infoToTelemetry)||void 0===s||s.call(r,`Filtered out appService state changed from worker (originating worker = ${e.workerId}, main window worker id = ${this.context.cdlWorkerRegistrarService.mainWindowWorkerId})`,"cdl_app_state_notification_filtered_out",{origin:e.workerId,target:this.context.cdlWorkerRegistrarService.mainWindowWorkerId,context:t},!0));const c=this._appServiceStateMap[t],u={appService:t,previousState:c.getValue().currentState,currentState:n,currentStateChangeTimestamp:new Date,currentStateChangeReason:i,currentStateChangeCode:a};null===(d=(l=this._logger).infoToTelemetry)||void 0===d||d.call(l,`Received appService state change for ${t} (current state = ${u.currentState}, previous state = ${u.previousState}) from worker '${e.workerId}'`,"cdl_app_state_change_notification",{origin:e.workerId,target:this.context.cdlWorkerRegistrarService.mainWindowWorkerId,context:t},!0),c.next(u)}}var FE=n(693861);const ME=(e,t,n,i,a,o,r,s,l,d,c,u)=>{let m={};return e&&(m={experienceName:e}),t&&(m=Object.assign(Object.assign({},m),{ring:t})),n&&(m=Object.assign(Object.assign({},m),{environment:n})),i&&(m=Object.assign(Object.assign({},m),{sessionId:i})),a&&(m=Object.assign(Object.assign({},m),{platformId:a})),o&&(m=Object.assign(Object.assign({},m),{buildVersion:o})),r&&(m=Object.assign(Object.assign({},m),{localeCode:r})),s&&(m=Object.assign(Object.assign({},m),{workerId:s})),l&&(m=Object.assign(Object.assign({},m),{preAuthUserId:l})),u&&(m=Object.assign(Object.assign({},m),{publicPath:u})),void 0!==c?m=Object.assign(Object.assign({},m),{userConsoleLogLevel:c}):void 0!==d&&(m=Object.assign(Object.assign({},m),{preECSConsoleLogLevel:d})),JSON.stringify(m)};let RE;const PE=(e,t,n,i,a)=>class{constructor(o){const r=i?`${o}#${i}`:o,s=typeof e==typeof Worker?"cdlWorker":"cdlsharedWorker";OE(t,r,!1,s,n),null==a||a(r);const l=((e,t)=>{var n,i;if(RE)return RE;try{return RE=null===(n=window.trustedTypes)||void 0===n?void 0:n.createPolicy("@msteams/core-cdl-worker-common#create-cdl-worker",{createScriptURL:e=>xE(e,t)}),RE}catch(n){null===(i=t.errorToTelemetry)||void 0===i||i.call(t,`Create CDL worker URL trustedType policy failed. This is not a critical error, falling back to function validation. Error ${n}`,"cdl_worker_startup_error_trusted_policy",{endpointUrl:e},!0)}})(r,t);if(l){const t=l.createScriptURL(r);return new e(t)}const d=xE(r,t);return new e(d)}},OE=(e,t,n,i,a)=>{e.log(`{"hostRendererId":${i},"component":${a} Creating CDL Worker with ${n?"passed":"determined"} url ${t} }`)};function xE(e,t){var n;try{const t=new URL(e,LE().location.origin);let n=!0,i="CDL Web worker URL is invalid.";if(t.origin!==LE().location.origin&&(i=i.concat("OriginValidationFailed"),n=!1),n)return e;throw new Error(i)}catch(i){throw null===(n=t.errorToTelemetry)||void 0===n||n.call(t,"CDL web worker url is not valid","cdl_worker_startup_error_invalid_url",{endpointUrl:e},!0),(0,Mn.Tr)(i.message,De.jK.InvalidUrl,"",void 0)}}function LE(){return window}var UE=n(628671),BE=n(588878),jE=n(152220),WE=n(339939);const VE="MainRenderer",HE="GQL_STOP";class $E extends WE.Q{constructor(e,{rendererId:t,windowId:n},i,a){super(e,{rendererId:t,windowId:n},i,a)}sendFilteredAppStateRequest(e){const t=e.context.appState;return this._rendererId===VE&&(e.context.appState=this.filterWorkerAppState(t)),super.sendRequest(e)}filterWorkerAppState(e){return e}}class zE{constructor(){this.onResponseReceived=e=>{if(this.onMessage){const t=this.transformLegacyClientFields(e.payload.dataLayer);this.onMessage(t)}}}transformLegacyClientFields(e){return e.error&&(e.errors=e.error),e.extensions||(e.extensions={}),e.perfStats&&(e.extensions.perfStats=e.perfStats),e}}class GE extends zE{constructor(e,{rendererId:t,windowId:n},i,a){super(),this._context=i,this._loggingContext={hostRendererId:t,component:"CDLClient",requestWindowId:n},this.sendMessage=t=>e({requestId:t.requestId,rendererId:t.rendererId,windowId:t.windowId,payload:t.request,operationName:t.operationName,type:a,cdlOperationCustomContext:t.cdlOperationCustomContext})}handleResponse(e){var t;return this._context.bootstrapServices.logger.debug("Received message",Object.assign(Object.assign({},this._loggingContext),{requestId:e.requestId,requestRendererId:e.rendererId,requestWindowId:e.windowId})),Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e.rendererId,requestId:e.requestId,windowId:e.windowId,data:e.response.data,errors:e.response.errors?e.response.errors:void 0,errorCode:null===(t=e.response)||void 0===t?void 0:t.errorCode,extensions:e.response.extensions}}}))}}var qE=n(903406);class QE extends qE.D{transitionState(e,t){switch(e){case"authLoaded":this.execute("authServiceInjected",t,void 0);break;case"authServiceInjected":this.completeStateMachine(!0)}}}class JE extends qE.D{transitionState(e,t){switch(e){case"appService:Loaded":this.execute("appService:Injected",t,void 0);break;case"appService:Injected":this.completeStateMachine(!0)}}}var YE,KE,ZE,XE=n(220970),eA=n(365305);class tA{constructor(e){this._requestUtility=new XE.H("CDLAuthHandler");let t=[];t=e===VE?[{requestType:eA.m.AadGetToken,handlerFunc:tA.getAadTokensAngular},{requestType:eA.m.AadGetCurrentUser,handlerFunc:tA.getUserInformationAngular},{requestType:eA.m.GetSkypeTokens,handlerFunc:tA.getSkypeTokensAngular},{requestType:eA.m.GetUserDetails,handlerFunc:tA.getUserDetailsAngular},{requestType:eA.m.SubscribeToAuthState,handlerFunc:tA.subscribeToAuthState}]:[{requestType:eA.m.AadGetToken,handlerFunc:tA.getAadTokens},{requestType:eA.m.AadGetCurrentUser,handlerFunc:tA.getUserInformation},{requestType:eA.m.GetSkypeTokens,handlerFunc:tA.getSkypeTokens},{requestType:eA.m.GetUserDetails,handlerFunc:tA.getUserDetails},{requestType:eA.m.SubscribeToAuthState,handlerFunc:tA.subscribeToAuthState}],this._requestUtility.addHandlers(t)}injectDependentServices(e){return new Promise((t=>{if(!e)throw new TypeError("Cannot injectDependentServices of undefined");if("function"==typeof e.getAuthTokens&&(e={authenticationService:e,discover:void 0}),!e.authenticationService)throw new TypeError("Cannot inject authentication service that is not defined");if(this._authenticationService)throw new TypeError("injectDependentServices has been called again, even though it's already initialized");return this._authenticationService=e.authenticationService,this._discover||(this._discover=e.discover),this._authStateProvider||(this._authStateProvider=e.authStateProvider),t()}))}handle(e,t,n){return this._requestUtility.handle(e,t,n,this._authenticationService,this._discover,this._authStateProvider)}static convertAngularPromise(e){return new Promise(((t,n)=>{e.then((e=>t(e))).catch((e=>n(e)))}))}static handleAuthResult(e,t,n){const i=t.bootstrapServices.newScenario(ft.RG.AuthHandlerRequest);return i.appendEventData({operation:n}),e.then((e=>{if(null==e){const e="response payload is empty";throw i.fail({message:e}),new Error(e)}const t={statusMsg:`${n} request in main renderer has been processed`,data:e};return i.stop(),t})).catch((e=>{const a=tA.getErrorMessage(n,e);XE.H.onHandlerError(t,De.jK.UnhandledPromiseRejection,"the auth handler has exception",a,"CDLAuthHandler"),e.isExpected?i.incomplete({message:a}):i.fail({message:a});try{"string"==typeof e&&(e=new Error(e)),e.reason||(e.reason={}),e.reason.cdlClient="auth"}catch(n){t.bootstrapServices.logger.warn(`Failed to handle auth error. Original error: ${(0,Mn.VK)(e)}. Handling error: ${(0,Mn.VK)(n)}`,Object.assign({component:"CDLAuthHandler"},t.loggingContext))}throw e}))}static getAadTokensAngular(e,t,n){var i;const a=e.context.resource,o=e.context.options;return tA.logStartHandle(e,t,a),tA.handleAuthResult(tA.convertAngularPromise(n.getAuthToken(a,null==o?void 0:o.claim,null==o?void 0:o.silent,null===(i=e.context)||void 0===i?void 0:i.forceRenew)).then((e=>{if(!e)return;return{token:e.token,expires:e.expiration,tokenType:e.tokenType,fromCache:!1}})),t,eA.m.AadGetToken)}static getAadTokens(e,t,n){const{resource:i,options:a}=e.context;let o;return tA.logStartHandle(e,t,i),o=n.acquireTokenV2?n.acquireTokenV2(i,a):n.acquireToken(i,a).then((e=>({token:e}))),tA.handleAuthResult(o,t,eA.m.AadGetToken)}static getUserInformationAngular(e,t,n){return tA.logStartHandle(e,t),tA.handleAuthResult(tA.convertAngularPromise(n.getUserInformation()),t,eA.m.AadGetCurrentUser)}static getUserDetailsAngular(e,t,n){return tA.logStartHandle(e,t),tA.handleAuthResult(tA.convertAngularPromise(n.getUserDetails()),t,eA.m.GetUserDetails)}static getUserDetails(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){tA.logStartHandle(e,t);const n=yield a.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(o=e.context)||void 0===o?void 0:o.forceRenew)}),i=n?{userDetails:n.userDetails,id:n.userDetails.id}:void 0;return tA.handleAuthResult(Promise.resolve(i),t,eA.m.GetUserDetails)}))}static subscribeToAuthState(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!o){t.bootstrapServices.logger.log("Auth-Handler - auth state provider not provided. Not subscribing.",Object.assign({component:"CDLAuthHandler"},t.loggingContext));const e=(0,Mn.Tr)("AuthStateProvider not provided - This will should be an error in the RWC experience",De.jK.MissingParameter,"Auth-Handler");return Promise.reject(e)}const e=o.observe().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield tA.handleAuthResult(Promise.resolve(e),t,eA.m.SubscribeToAuthState);XE.H.callResponseCallback(r,n,"success")}))),(e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){XE.H.callResponseCallback(r,{statusMsg:tA.getErrorMessage(eA.m.SubscribeToAuthState,e),data:e},"failure")}))),(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){e.unsubscribe(),XE.H.callResponseCallback(r,{statusMsg:"AuthStateProvider Completed",data:void 0},"failure")}))));return tA.handleAuthResult(Promise.resolve(o.getState()),t,eA.m.SubscribeToAuthState)}))}static getSkypeTokensAngular(e,t,n){var i;tA.logStartHandle(e,t);const a=n.getSkypeTokens(!!(null===(i=e.context)||void 0===i?void 0:i.forceRenew)).then((e=>{if(!e)return;return{expiration:e.tokenExpiration||0,skypeToken:e.skypeToken,userDetails:e.userDetails,regionGtms:e.regionGtms}}));return tA.handleAuthResult(a,t,eA.m.GetSkypeTokens)}static getSkypeTokens(e,t,n,i){var a;return tA.logStartHandle(e,t),tA.handleAuthResult(i.getSkypeTokenInfoFromDiscoveryResponse({forceRenew:!!(null===(a=e.context)||void 0===a?void 0:a.forceRenew)}),t,eA.m.GetSkypeTokens)}static getUserInformation(e,t,n){return tA.logStartHandle(e,t),tA.handleAuthResult(n.getUser({correlation:{source:"AuthHandlerRequest",id:"na",scenarioName:"CentralDataLayerBootstrapAuthGetUser"}}),t,eA.m.AadGetCurrentUser)}static logStartHandle(e,t,n){const i=n?` for resource ${n}`:"";t.bootstrapServices.logger.log(`Auth handler started serving request ${e.requestOperationtype}${i}`,Object.assign({component:"CDLAuthHandler"},t.loggingContext))}}tA.getErrorMessage=(e,t)=>`the request type for ${e} failed due to ${(0,Mn.VK)(t)}`,function(e){e.MachineActive="MachineActive",e.MachineInactive="MachineInactive",e.MachineLongInactive="MachineLongInactive",e.MachineLocked="MachineLocked"}(YE||(YE={})),function(e){e.NotifyAppState="NotifyAppState",e.NotifyCoreClientState="NotifyCoreClientState",e.NotifyCoreMachineState="NotifyCoreMachineState",e.NotifyCoreSuspendedState="NotifyCoreSuspendedState",e.NotifyServiceUp="NotifyServiceUp",e.NotifyServiceDown="NotifyServiceDown"}(KE||(KE={})),function(e){e[e.ChatSync=0]="ChatSync",e[e.Presence=1]="Presence",e[e.Files=2]="Files",e[e.OneNote=3]="OneNote",e[e.Groups=4]="Groups",e[e.Video=5]="Video",e[e.MasterTab=6]="MasterTab",e[e.IndexDb=7]="IndexDb",e[e.AdalTokens=8]="AdalTokens",e[e.AdalLogin=9]="AdalLogin",e[e.AdalReauth=10]="AdalReauth",e[e.SkypeTokens=11]="SkypeTokens",e[e.SkypeLicense=12]="SkypeLicense",e[e.SupportedBrowser=13]="SupportedBrowser",e[e.MSAGuestLicense=14]="MSAGuestLicense",e[e.AppSession=15]="AppSession",e[e.CSAStartup=16]="CSAStartup"}(ZE||(ZE={}));class nA{constructor(e,t){this.workerId=t,this._requestUtility=new XE.H("CDLAppServiceHandler");let n=[];n=e===VE?[{requestType:KE.NotifyServiceUp,handlerFunc:nA.notifyServiceUpAngular},{requestType:KE.NotifyServiceDown,handlerFunc:nA.notifyServiceDownAngular}]:[{requestType:KE.NotifyServiceUp,handlerFunc:nA.notifyServiceUp},{requestType:KE.NotifyServiceDown,handlerFunc:nA.notifyServiceDown}],this._requestUtility.addHandlers(n)}injectAppState(e){return new Promise((t=>{if(this.appService)throw new TypeError("injectAppStateService has been called again, even though it's already initialized");return this.appService=e,t()}))}handle(e,t,n){return this._requestUtility.handle(e,t,n,this.appService,this.workerId)}static notifyServiceUp(e,t,n,i){return new Promise((a=>{t.bootstrapServices.logger.log(`App service change is received (worker ${i}), ${e.context.appService} is up and running`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:o,reason:r}=e.context,s={workerId:i};return n.notifyServiceUp(s,o,r),a()}))}static notifyServiceUpAngular(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`App service change is received, ${e.context.appService} is up and running. Notifying Angular.`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o}=e.context,r=ZE[a];return n.notifyServiceUp(r,o),i()}))}static notifyServiceDown(e,t,n,i){return new Promise((a=>{t.bootstrapServices.logger.log(`App service change is received (worker ${i}), ${e.context.appService} is down`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:o,reason:r,code:s}=e.context,l={workerId:i};return n.notifyServiceDown(l,o,r,s),a()}))}static notifyServiceDownAngular(e,t,n){return new Promise((i=>{t.bootstrapServices.logger.log(`Angular app service change is received, ${e.context.appService} is down. Notifying Angular.`,Object.assign({component:"CDLAppStateHandler"},t.loggingContext));const{appService:a,reason:o,code:r}=e.context,s=ZE[a];return n.notifyServiceDown(s,o,r),i()}))}}class iA{constructor(e){this.workerId=e}handle(e,t,n){return new Promise((i=>{var a;n.bootstrapServices.logger.log(`Network state received from CDL worker ${this.workerId}. Network state: ${e.payload.networkState}`,Object.assign({component:"NetworkStateHandler"},n.loggingContext)),null===(a=this.networkStateChangeHandler)||void 0===a||a.next(e.payload.networkState);i(t({response:{statusMsg:"Network state received success.",data:void 0},status:"success"}))}))}injectNetworkStateTracker(e){return new Promise((t=>{if(this.networkStateChangeHandler)throw new TypeError("injectNetworkStateTracker has been called again, even though it's already initialized");return this.networkStateChangeHandler=e,t()}))}}class aA extends qE.D{transitionState(e,t){switch(e){case"networkState:Loaded":this.execute("networkState:Injected",t,void 0);break;case"networkState:Injected":this.completeStateMachine(!0)}}}class oA{constructor(){this._componentName="EndpointsHealthMessageHandler"}handle(e,t,n){return new Promise((i=>{var a,o;(!e.payload||void 0===e.payload.healthState&&void 0===e.payload.endpointHealth)&&(this.log("Endpoints health message received from CDL. Payload is empty.",n),i(t(this.getSuccessMessage()))),e.payload.endpointHealth&&(this.log(`Endpoints health message received from CDL. Update: ${JSON.stringify(e.payload.endpointHealth)}.`,n),null===(a=this.endpointsHealthUpdateHandler)||void 0===a||a.handleEndpointHealthUpdate(e.payload.endpointHealth),i(t(this.getSuccessMessage()))),e.payload.healthState&&(this.log("Endpoints state dump message received from CDL.",n),null===(o=this.endpointsHealthUpdateHandler)||void 0===o||o.handleStateDump(e.payload.healthState),i(t(this.getSuccessMessage())))}))}injectEndpointsHealthUpdateHandler(e){return new Promise((t=>{if(this.endpointsHealthUpdateHandler)throw new TypeError("injectEndpointsHealthUpdateHandler has been called again, even though endpointsHealthUpdateHandler is already initialized");return this.endpointsHealthUpdateHandler=e,t()}))}log(e,t){t.bootstrapServices.logger.log(e,Object.assign({component:this._componentName},t.loggingContext))}getSuccessMessage(){return{response:{statusMsg:"Endpoints health received success.",data:void 0},status:"success"}}}class rA extends qE.D{transitionState(e,t){switch(e){case"endpointsHealthUpdateHandler:Loaded":this.execute("endpointsHealthUpdateHandler:Injected",t,void 0);break;case"endpointsHealthUpdateHandler:Injected":this.completeStateMachine(!0)}}}function sA(e,t,n,i){const{authStateMachine:a,authHandler:o}=lA(e,t,i),{appServiceStateMachine:r,appServiceMessageHandler:s}=dA(e,t,i,n),{networkStateHandlerStateMachine:l,networkStateHandler:d}=cA(e,t,i,n),{endpointsHealthHandlerStateMachine:c,endpointsHealthHandler:u}=uA(e,t,i);return new Map([[jE.k.auth,{stateMachine:a,requestHandler:o}],[jE.k.appService,{stateMachine:r,requestHandler:s}],[jE.k.networkState,{stateMachine:l,requestHandler:d}],[jE.k.endpointHealth,{stateMachine:c,requestHandler:u}]])}const lA=(e,t,n)=>{const i=new tA(t),a={action:i.injectDependentServices.bind(i)},o=new Map;o.set("authServiceInjected",a);return{authHandler:i,authStateMachine:new QE(n,o,"authLoaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"auth",component:"CreateWorkerStateAndRequestHandlers"}},"auth")}},dA=(e,t,n,i)=>{const a=new nA(t,i),o={action:a.injectAppState.bind(a)},r=new Map;r.set("appService:Injected",o);return{appServiceMessageHandler:a,appServiceStateMachine:new JE(n,r,"appService:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:"appService",component:"CreateWorkerStateAndRequestHandlers"}},"appService")}},cA=(e,t,n,i)=>{const a=new iA(i),o={action:a.injectNetworkStateTracker.bind(a)},r=new Map;r.set("networkState:Injected",o);return{networkStateHandler:a,networkStateHandlerStateMachine:new aA(n,r,"networkState:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:jE.k.networkState,component:"CreateWorkerStateAndRequestHandlers"}},"networkState")}},uA=(e,t,n)=>{const i=new oA,a={action:i.injectEndpointsHealthUpdateHandler.bind(i)},o=new Map;o.set("endpointsHealthUpdateHandler:Injected",a);return{endpointsHealthHandler:i,endpointsHealthHandlerStateMachine:new rA(n,o,"endpointsHealthUpdateHandler:Loaded",{bootstrapServices:e,loggingContext:{hostRendererId:t,requestType:jE.k.endpointHealth,component:"CreateWorkerStateAndRequestHandlers"}},"endpointsHealth")}};const mA=e=>({loaded:e.hasReachedCheckpoint("loaded")?1:0,healthCheck:e.hasReachedCheckpoint("health_checked")?1:0,syncEngine:e.hasReachedCheckpoint("syncEngine:Initialized")?1:e.hasReachedCheckpoint("syncEngine:FailedToInitialize")?2:0,authLoaded:e.hasReachedCheckpoint("authLoaded")?1:0}),gA=120*Qo.gT.MILLI_PER_SECOND,pA="CDLWorkerManager";function vA(e,t,i,a,o,r,s,l,d,c,u,m,g){var p;let v;const h=function(){const e=new Map;return e.set(jE.k.appState,$E),e.set(jE.k.control,WE.Q),e.set(jE.k.database,WE.Q),e.set(jE.k.diagnostics,WE.Q),e.set(jE.k.endpointHealth,WE.Q),e.set(jE.k.graphql,GE),e.set(jE.k.networkState,WE.Q),e.set(jE.k.syncEngine,WE.Q),e.set(jE.k.supportedResolvers,WE.Q),e.set(jE.k.telemetry,WE.Q),e}();return null===(p=e.workerCacheManager)||void 0===p||p.saveWorkerStatusToCacheStorage({state:"InProgress",stepName:"CreateCDLWorker"}),v=i?function(e,t,i,a,o,r,s,l,d,c,u,m,g,p){var v,h;if(d){OE(e.logger,d,!0,e.hostRendererId,pA);const n=null===(h=null===(v=null==g?void 0:g.loader)||void 0===v?void 0:v.getSharedWorker)||void 0===h?void 0:h.call(v),c=n||new SharedWorker(d);return hA(e,a,o,l,t,i,(e=>c.port.postMessage(e)),(e=>{c.port.onmessage=t=>e(t,(e=>c.port.postMessage(e)))}),(e=>{c.onerror=t=>e(t)}),"shared-worker",r,s,m,p,null==u?void 0:u.workerId)}const f=ME(null==u?void 0:u.experienceName,null==u?void 0:u.ring,null==u?void 0:u.environment,null==u?void 0:u.sessionId,null==u?void 0:u.platformId,null==u?void 0:u.buildVersion,null==u?void 0:u.localeCode,null==u?void 0:u.workerId,void 0,null==u?void 0:u.preECSConsoleLogLevel,null==u?void 0:u.userConsoleLogLevel,null==u?void 0:u.publicPath),y=SharedWorker;SharedWorker=PE(y,e.logger,pA,f,c);const k=new SharedWorker(n.tu(new URL("/statics/teams-modular-packages/hashed-assets/"+n.u(72346),n.b)));return SharedWorker=y,hA(e,a,o,l,t,i,(e=>k.port.postMessage(e)),(e=>{k.port.onmessage=t=>e(t,(e=>k.port.postMessage(e)))}),(e=>{k.onerror=t=>e(t)}),"shared-worker",r,s,m,p,null==u?void 0:u.workerId)}(e,t,h,a,o,r,s,l,d&&d.cdlSharedWorkerUrl,(e=>{d&&(d.cdlSharedWorkerUrl=e)}),c,u,m):function(e,t,i,a,o,r,s,l,d,c,u,m,g,p){var v,h;if(d){OE(e.logger,d,!0,e.hostRendererId,pA);const n=null===(h=null===(v=null==g?void 0:g.loader)||void 0===v?void 0:v.getWorker)||void 0===h?void 0:h.call(v),c=n||new Worker(d);return hA(e,a,o,l,t,i,(e=>c.postMessage(e)),(e=>{c.onmessage=t=>e(t,(e=>c.postMessage(e)))}),(e=>{c.onerror=t=>e(t)}),"web-worker",r,s,m,p,null==u?void 0:u.workerId)}const f=ME(null==u?void 0:u.experienceName,null==u?void 0:u.ring,null==u?void 0:u.environment,null==u?void 0:u.sessionId,null==u?void 0:u.platformId,null==u?void 0:u.buildVersion,null==u?void 0:u.localeCode,null==u?void 0:u.workerId,null==u?void 0:u.preAuthUserId,null==u?void 0:u.preECSConsoleLogLevel,null==u?void 0:u.userConsoleLogLevel,null==u?void 0:u.publicPath),y=Worker;Worker=PE(y,e.logger,pA,f,c);const k=new Worker(n.tu(new URL("/statics/teams-modular-packages/hashed-assets/"+n.u(77294),n.b)));return Worker=y,hA(e,a,o,l,t,i,(e=>k.postMessage(e)),(e=>{k.onmessage=t=>e(t,(e=>k.postMessage(e)))}),(e=>{k.onerror=t=>e(t)}),"web-worker",r,s,m,p,null==u?void 0:u.workerId)}(e,t,h,a,o,r,s,l,d&&d.cdlWebWorkerUrl,(e=>{d&&(d.cdlWebWorkerUrl=e)}),c,u,m,g),v}function hA(e,t,n,a,o,r,s,l,d,c,u,m,g,p,v="default"){return new Promise(((h,f)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const y={hostRendererId:o,component:"CDLWorker"},k=new UE.q({bootstrapServices:e,loggingContext:y});k.setState("bootstrapped"),null==g||g.mark(ft.ck.CdlWorkerBootstrapped);const S=(0,BE.U)(e,{postMessageCallback:e=>s(e),clients:r},{globalState:k,requestAndStateHandlers:sA(e,o,v,k)},o);S.workerServer.start(),l(((e,t)=>S.onMessageCallback(e,t,-1))),d((t=>{f(fA(t,e,y,"workerOnError",m,b.state))}));const b={workerServer:S.workerServer,workerClientResponseRouter:S.workerClientResponseRouter,state:k,workerType:c,syncEngineInitializationPromise:u};b.state.setState("loaded");try{yield function(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=t.workerClientResponseRouter.cdlControlClient.sendRequest({type:"health_check",bootstrapData:a,initiatorExperience:n});let r;r=o?(yield i).response:(yield(0,Rn.E)(i,e)).response,t.cdlWorkerSessionId=r.cdlWorkerSessionId,t.cdlWorkerSupportedResolvers=r.cdlWorkerSupportedResolvers,t.state.setState("health_checked")}))}(t||gA,b,n,a,p)}catch(t){f(fA(t,e,y,"healthCheckException",m,b.state))}h(b)}))))}function fA(e,{logger:t,workerCacheManager:n},i,a,o,r){const s=((e,t)=>{if(e.hasOwnProperty("code")){const t=e;if(t.code!==De.jK.Unknown)return t.code}return t.hasReachedCheckpoint("loaded")?t.hasReachedCheckpoint("syncEngine:FailedToInitialize")?De.jK.NotInitialized:t.hasReachedCheckpoint("health_checked")&&t.hasReachedCheckpoint("syncEngine:Initialized")?De.jK.UnhandledRuntimeException:De.jK.TimedOut:De.jK.ScriptLoadError})(e,r),l=(e=>{const t=mA(e);return`LD${t.loaded}:HC${t.healthCheck}:SE${t.syncEngine}:AL${t.authLoaded}`})(r),d=`err: ${(0,Mn.VK)(e.error)};message: ${(0,Mn.VK)(e.message)}`,c=(0,Mn.Tr)(De.w5.DataLayerClient,s,d,void 0,`Uncaught ${a} in Worker: ${(0,Mn.VK)(e.message)} Auth: ${o} WorkerState: ${l}`),u=`CDL Worker OnError for ${a}::Auth${o}::workerState:${l}::${(e=>e&&e.message&&e.message.includes("AsyncIterableObserver buffer is full")?"AsyncIterableBufferOverflow":"Unknown")(e)}`;return t.errorToTelemetry?t.errorToTelemetry(u,"cdl_worker_startup_error",(e=>{const t=mA(e);return{"WorkerStartupState.Loaded":1===t.loaded,"WorkerStartupState.HealthCheck":1===t.healthCheck,"WorkerStartupState.SyncEngine":t.syncEngine,"WorkerStartupState.AuthLoaded":1===t.authLoaded}})(r),!0):t.error(u,i,s),null==n||n.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CDLWorkerOnError",error:d}),c}var yA=n(663089),kA=n(370362),SA=n(455304),bA=n(967953),CA=n(474910),wA=n(180599);const NA=(0,bA.p)(CA.A),TA=()=>{let e;return(t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(void 0===e){const i=yield IA(t,n,a);return e=i,i}return e}))},IA=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,a,o,r,s;if(!e)return t.log("WebWorkerURL is undefined",n),!0;let l;null===(i=t.infoToTelemetry)||void 0===i||i.call(t,"Pinging PDS / ServiceWorker to verify if worker script is up","cdl_worker_startup_error_verify_worker_script",{endpointUrl:e});const d=new Date,c=performance.now();try{l=yield NA({url:e,method:"HEAD"})}catch(e){return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,e.toString(),"cdl_worker_startup_error_verify_worker_script",{statusCode:-1},!0),!1}const u=performance.now()-c;if(null===(o=t.infoToTelemetry)||void 0===o||o.call(t,"Finished pinging PDS / ServiceWorker","cdl_worker_startup_error_verify_worker_script",{totalRequestTime:u,statusCode:l.status,size:Number(l.headers["content-length"]||-1),correlationId:l.headers["x-msedge-ref"],callId:l.headers["x-ms-request-id"],contentType:l.headers["x-cache"]}),t.log(`precompiled-web-worker header x-msedge-ref: ${l.headers["x-msedge-ref"]}`,n),function(e,t){const n="Ref C: ";if(!e)return!0;let i;if(!(i=e.indexOf(n)))return!0;const a=e.slice(i+n.length),o=new Date(a);if(!(0,wA.q)(o))return!0;return t.getTime()<o.getTime()}(l.headers["x-msedge-ref"],d)||t.log("Request is likely served from service worker, since PDS response time is before the request time",n),l.status!==SI.qb.OK)return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,`PDS returned ${l.status} for worker script`,"cdl_worker_startup_error_verify_worker_script",void 0,!0),!1;return!l.headers["content-length"]||Number(l.headers["content-length"])<1e3?(null===(s=t.errorToTelemetry)||void 0===s||s.call(t,`PDS returned smaller than expected worker script, of size ${l.headers["content-length"]}`,"cdl_worker_startup_error_verify_worker_script",void 0,!0),!1):(t.log("Worker script fetched successfully.",n),!0)}));const EA=(e,t,n,a,o,r,s,l,d,c,u,m,g,p,v,h)=>new Promise(((f,y)=>{const k=performance.now();let S=null==g?void 0:g.workerStartupScenario,b=null==g?void 0:g.workerStartupScenarioTimeout;const C=AA(t);if(!S){const e=_A(n.newScenario,r,C,n.workerCacheManager,u,m,v,n.logger);S=e.workerStartupScenario,b=e.workerStartupScenarioTimeout}S.appendEventData({origin:s});const w=S;u&&n.logger.log(`Initializing worker manager from renderer with host: ${u.location.host} protocol: ${u.location.protocol} port: ${u.location.port}`,{hostRendererId:e,component:"CDLWorkerManager"});const N=TA();let T;p||(T=null==u?void 0:u.setTimeout((()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=MA(e);if(!(yield N(C?null==a?void 0:a.cdlSharedWorkerUrl:null==a?void 0:a.cdlWebWorkerUrl,n.logger,t))){const t=(0,Mn.Tr)("CDL worker script load error",De.jK.ScriptLoadError,"cdl_worker_startup_error_script_load_error"),i=yield FA(t,n,e,w,C,a,N,!1,!!p);y(i)}}))),4e4)),function(e,t,n,a,o,r,s,l,d,c,u,m,g,p,v,h,f,y){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let k=!1;v&&t.logger.log(`Initializing worker manager from renderer with host: ${v.location.host} protocol: ${v.location.protocol} port: ${v.location.port}`,{hostRendererId:e,component:"CDLWorkerManager"});try{const u=(0,si.P)();c.appendEventData({newState:"beforeCreateCDLWorker"});const f=yield vA(t,e,r,a,o,u.promise,h?h.getState():LI.jq.Up,m,n,g,void 0,v,y).finally((()=>{var e,t,n;null===(e=null==v?void 0:v.clearTimeout)||void 0===e||e.call(v,d),null==v||v.clearTimeout(l),null===(n=null===(t=null==v?void 0:v.loader)||void 0===t?void 0:t.clearWorker)||void 0===n||n.call(t)}));return k=!0,c.appendEventData({newState:ft.ck.CdlWorkerManagerHealthChecked,searchSessionId:f.cdlWorkerSessionId}),f.state.setState("initialized"),RA(c),c.mark("CDLWorkerManagerInitialized"),function(e,t,n,a,o,r,s,l){var d,c,u,m,g,p,v,h,f,y;(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=MA(n);try{const{response:n}=yield e.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"startup_info",subType:"Messaging",params:void 0}),r=n;if(r&&"string"!=typeof r&&"error"===r.type){const e="string"==typeof r.details?r.details:JSON.stringify(r.details);throw t.logger.warn(`Sync engine for Messaging strategy: ${e}`,i),e}null==l||l.appendEventData({messagingSyncEngineStartupMode:r,appLaunchMode:"clean"===r?"cold":"warm",workerResponseTime:performance.now()-s}),o.resolve({isSyncEngineInitialized:!0,bootType:(0,yA.n)(r)}),e.state.setState("syncEngine:Initialized"),RA(a),a.stop({dataSource:r})}catch(n){const s=yield DA(r,t.workerCacheManager),l="Init SyncEngine failed",k=`err: ${(0,Mn.VK)(n)}`,S=n.code||De.jK.Unknown;null===(c=(d=t.logger).errorToTelemetry)||void 0===c||c.call(d,`${l}:: ${k}`,"cdl_worker_manager_get_messaging_sync_engine_startup_info_error",Object.assign(Object.assign({},(0,kA.n)(i)),{errorCode:S}),!0),null===(m=(u=t.logger).errorToTelemetry)||void 0===m||m.call(u,`${l}:: WSM: ${s}`,"cdl_worker_manager_get_messaging_sync_engine_startup_info_error",Object.assign(Object.assign({},(0,kA.n)(i)),{errorCode:S}),!0),RA(a);const b=`${l}:: WSM: ${s}:: ${k}`,C=(null===(p=null===(g=n.response)||void 0===g?void 0:g.error)||void 0===p?void 0:p.isExpected)||!1,w={errors:b,isAccepted:C,errorCode:S,dataSource:null===(h=null===(v=n.response)||void 0===v?void 0:v.error)||void 0===h?void 0:h.startupMode,reason:null===(y=null===(f=n.response)||void 0===f?void 0:f.error)||void 0===y?void 0:y.message};C?a.cancel(w):a.fail(w),e.state.setState("syncEngine:FailedToInitialize"),o.resolve({isSyncEngineInitialized:!1})}}))}(f,t,e,c,u,r,s,p),f}catch(i){throw yield FA(i,t,e,c,r,n,u,!k,!!f)}}))}(e,n,a,o,s,C,k,T,b,S,N,l,d,c,u,m,p,h).then((e=>f(e))).catch((e=>y(e)))})),AA=e=>"electron"===e||"sharedworker"===e;function _A(e,t,n,i,a,o,r,s){var l;const d=300*SA.kg,c=t||d,u=e(ft.RG.CentralDataLayerWorkerManagerStartup,c);let m=!0;(null==r?void 0:r.getUser)&&(m=!1,null==r||r.getUser().then((()=>m=!0)));const g=null===(l=null==a?void 0:a.setTimeout)||void 0===l?void 0:l.call(a,(()=>{m||(null==s||s.warn("Worker startup - getUser is still not available. Cancelling Worker Scenario"),u.cancel({reason:"GetUser"}));(o?o.getState():LI.jq.Up)===LI.jq.InteractionRequired&&(null==s||s.warn("Worker startup - User is in InteractionRequired state. Cancelling Worker Scenario"),u.cancel({reason:"InteractionRequired"})),DA(n,i).then((e=>{u.appendEventData({errors:e})}))}),c-500);return{workerStartupScenario:u,workerStartupScenarioTimeout:g}}function DA(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=e?"shared-worker":"web-worker";let i="";if(t)try{const e=yield t.getWorkerStartupStatus(n);return"WorkerStartupStatus: "+(e?`lastError: ${JSON.stringify(e.lastError)}:: lastState: ${JSON.stringify(e.lastState)}`:"Unable to get CDL worker startup status")}catch(e){i=`Unable to get CDL worker startup status. Reason: ${(0,Mn.VK)(e)}`}else i="Unable to get CDL worker startup status. Reason: workerCacheManager is undefined";return i}))}function FA(e,t,n,a,o,r,s,l,d){var c,u,m,g,p;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield DA(o,t.workerCacheManager),v=`Failed to initialize CDL Worker :: err: ${(0,Mn.VK)(e)}`,h=`${v} :: ${i}`,f=MA(n);let y={errors:h,errorCode:t.workerCacheManager?e.code:De.jK.NotInitialized};if(l&&!d)try{(yield s(o?null==r?void 0:r.cdlSharedWorkerUrl:null==r?void 0:r.cdlWebWorkerUrl,t.logger,f))||(e.code=De.jK.ScriptLoadError,y={errors:"CDL Worker Script load error",errorCode:De.jK.ScriptLoadError})}catch(t){e.code=De.jK.ScriptLoadError,y={errors:`CDL Worker Script load error :: ${t.message}`,errorCode:De.jK.ScriptLoadError}}const k=(0,Mn.Tr)("CDLWorkerManager",e.code,JSON.stringify(f),void 0,h);return null===(u=(c=t.logger).errorToTelemetry)||void 0===u||u.call(c,v,"cdl_worker_manager_handle_initialize_worker_manager_failure_error",Object.assign(Object.assign({},(0,kA.n)(f)),{errorCode:k.code}),!0),null===(g=(m=t.logger).errorToTelemetry)||void 0===g||g.call(m,i,"cdl_worker_manager_handle_initialize_worker_manager_failure_error",Object.assign(Object.assign({},(0,kA.n)(f)),{errorCode:k.code}),!0),RA(a),e&&e.code===De.jK.TimedOut?a.stop(y,"timeout"):a.fail(y),null===(p=t.workerCacheManager)||void 0===p||p.saveWorkerStatusToCacheStorage({state:"Failure",stepName:"CreateCDLWorker",error:h}),k}))}function MA(e){return{hostRendererId:e,component:"CDLWorkerManager"}}function RA(e){e.appendEventData({"Thread.Id":"",threadId:""})}var PA=n(276291);function OA(e,t,n,o,r,s,l,d,c,u,m,g,p,v,h,f){var y,k,S,b,C,w,N,T,I,E;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{workerStartScenarioTimeoutInMs:A}=s.get(K.J.CdlWorker),_=(e,t,n)=>r.newScenario(e,{callback:n,timeoutMs:t}),D=(0,PA.L)(t.experienceName,o.newLogger("CDL:DataClientCoreWorkerManager"),r),F=LA(c,s),M=_A(_,A,AA(F),D,e,g,l,u),R=(null===(y=e.loader)||void 0===y?void 0:y.getCdlSharedWorkerUrl)?null===(k=e.loader)||void 0===k?void 0:k.getCdlSharedWorkerUrl():UA(s,e,r,u),P=(null===(S=e.loader)||void 0===S?void 0:S.getCdlWorkerUrl)?null===(b=e.loader)||void 0===b?void 0:b.getCdlWorkerUrl():void 0,O=xA(c,s,r,e,u);M.workerStartupScenario.appendEventData({contentType:O.toString(),newState:"beforeBootstrapData"}),function(e,t,n,i){i.log(`Initializing workerType ${e} ${t?"as Worker host":`as non-Worker host with sharedWorkerUrl ${n}`}`)}(F,O,R,u);try{let r;O&&(r=yield function(e,t,n,a,o,r,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){r.appendEventData({newState:"beforeAuthBootstrapData"});const l=yield function(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;o.appendEventData({newState:"beforeAuthUserData"});const s=1e4,l=r.get(K.J.CdlWorker).timeToGetUserFromAuthMs||s;try{i=yield(0,Rn.E)(e.getUser(),l)}catch(e){n.error(`Worker bootstrap authentication error - cannot authenticationService.getUser: ${null==e?void 0:e.code}`)}if(!i)return{};let d;o.appendEventData({newState:"beforeDiscoverUserData"});try{d=yield(0,Rn.E)(t.getUser(),l)}catch(e){n.error(`Worker bootstrap authentication error - cannot discover.getUser: ${null==e?void 0:e.code}`)}if(!d)return{userInformation:i};return{userInformation:i,userDetails:{userDetails:d,id:null==d?void 0:d.id},authState:(null==a?void 0:a.getState())||LI.jq.Up}}))}(e,t,n,a,r,s);return{hostSettings:o.hostSettings,auth:l}}))}(l,d,u,g,n,M.workerStartupScenario,s)),M.workerStartupScenario.appendEventData({newState:"beforeInitializeWorkerManagerFromDataClientCore"});const y=yield function(e,t,n,o,r,s,l,d,c,u,m,g,p,v,h,f,y,k,S){var b,C;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{ring:i,environment:w}=m.get(K.J.Metadata),{sessionId:N}=m.get(K.J.Platform),{enablePassingPlatformIdInWorkerUrlHash:T}=m.get(K.J.Core),{workerStartTimeoutInMs:I,workerStartScenarioTimeoutInMs:E,disablePingingPDSIfWorkerStartupFails:A,shouldDisableHealthCheckTimeout:_}=m.get(K.J.CdlWorker),D=w?(0,a.get)(Sb.s,w):void 0;return f.workerStartupScenario.appendEventData({newState:"beforeInitializeWorkerManager"}),EA(e,t,{logger:new FE.V(d.newLogger("CDL:DataClientCoreWorkerManager")),newScenario:h,offlineCacheManager:l,workerCacheManager:u,hostRendererId:e},{cdlSharedWorkerUrl:n||"",cdlWebWorkerUrl:o||""},I||void 0,E||void 0,r,s,{experienceName:r,ring:(null==i?void 0:i.id)||void 0,environment:D,platformId:T?c.config.platformId:void 0,sessionId:N||void 0,buildVersion:c.config.buildVersion,localeCode:y,workerId:v,publicPath:g.__webpack_public_path__,preECSConsoleLogLevel:null===(b=g.defaultConsoleLogLevel)||void 0===b?void 0:b.preECSConsoleLogLevel,userConsoleLogLevel:null===(C=g.defaultConsoleLogLevel)||void 0===C?void 0:C.userConsoleLogLevel},k,g,p,f,!!A,S,!!_)}))}(t.clientId,F,R,P,t.experienceName,r,m,o,c,D,s,e,g,v,_,M,h,f,l);return!!(null===(C=null==s?void 0:s.get(K.J.CdlWorker))||void 0===C?void 0:C.enableUserContextWorkerRegistration)&&(v&&(null===(w=null==r?void 0:r.auth.userDetails)||void 0===w?void 0:w.id)?p.mapUserIdToRegisteredWorker(v,r.auth.userDetails.id):null===(N=u.errorToTelemetry)||void 0===N||N.call(u,`Unable to register worker '${v}' to user through worker registrar for userId '${null===(T=null==r?void 0:r.auth.userDetails)||void 0===T?void 0:T.id}'`,"cdl_worker_init_register_user_context",{origin:v,userId:null===(I=null==r?void 0:r.auth.userDetails)||void 0===I?void 0:I.id},!0)),y}catch(e){return void(null===(E=u.errorToTelemetry)||void 0===E||E.call(u,`Failed to start CDL Worker from DataClientCore: ${(0,Mn.VK)(e)}`,"cdl_services_worker_worker_service_start_client_core_cdl_worker_error",void 0,!0))}}))}const xA=(e,t,n,i,a)=>{const o=LA(e,t),r=UA(t,i,n,a);return"webworker"===o||"web"===o||!r};function LA(e,t){let n=e.config.clientType===Ye.Bh.Web?"webworker":"sharedworker";const i=t.get(K.J.Host).cdlWorkerType,a=t.get(K.J.CdlWorker).cdlWorkerType;return i?n=i:a&&(n=a),n}function UA(e,t,n,i){var a;let{cdlSharedWorkerUrl:o}=e.get(K.J.Host);const r=t.localStorage.getItem("ts.cdlSharedWorkerJsUrl");if(o&&r&&o!==r){null===(a=i.errorToTelemetry)||void 0===a||a.call(i,`Worker URL saved in TSW:${o} is different from worker url in TMP:${r}`,"cdl_services_worker_worker_service_get_cdl_shared_worker_url_error",void 0,!0);n.newScenario(ft.RG.HostSettingsSync).fail({reason:JSON.stringify({cdlSharedWorkerUrl:o,storedWorkerUrl:r})}),o=r}return o}var BA=n(514400);class jA extends Fe{constructor(){super(De.Yg.CreateCDLWorkerAppServiceTask,["windowProvider","scenarioFactory","coreSettings","platformService","loggerFactory","cdlWorkerService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,BA.Q6)(e.coreSettings),n=!!e.coreSettings.get(K.J.CdlWorker).enableCdlAppStateService;if(!t||!n)return Promise.resolve();const a=new DE(e);return e.cdlAppStateService=a,function(e,t,n,a,o,r,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(xA(a,n,t,e,o)){const e=yield r.getCDLWorkerManager();null==e||e.state.setState("appService:Loaded",s)}}))}(e.windowProvider,e.scenarioFactory,e.coreSettings,e.platformService,e.loggerFactory.newLogger("CDLWorkerManager"),e.cdlWorkerService,a)}))}}class WA extends Fe{constructor(){super(De.Yg.CreateCDLWorkerAuthTask,["cdlWorkerRegistrarService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,BA.Q6)(e.coreSettings),{cdlWorkerService:n,cdlWorkerRegistrarService:a}=e;if(t&&n){yield function(e,t,n,a,o,r,s,l,d,c){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(xA(r,n,t,e,s)){const e=yield l.getCDLWorkerManager();null==e||e.state.setState("authLoaded",{authenticationService:a,discover:o,authStateProvider:c,cdlWorkerRegistrarService:d})}}))}(e.windowProvider,e.scenarioFactory,e.coreSettings,e.authenticationService,e.discover,e.platformService,e.loggerFactory.newLogger("CDLWorkerManager"),n,a,e.authStateProvider);if(!e.coreSettings.get(K.J.CdlWorker).enableCleanUpOnLogout)return;return t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(t){case"signout":yield n.logoutCurrentUser(e.coreSettings);break;default:return}}))}}))}}class VA{constructor(e,t,n,i){this.cdlWorkerService=i,this._logger=n.newLogger("CDLWorkerStateSender"),this._clientStateSubscription=e.observe().subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:KE.NotifyCoreClientState,context:{appState:e}}))),this._machineLockStateSubscription=t.observe().pipe((0,sI.x)(((e,t)=>e.machineLockState===t.machineLockState))).subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:KE.NotifyCoreMachineState,context:{appState:e.machineLockState}}))),this._suspendedStateSubscription=t.observe().pipe((0,sI.x)(((e,t)=>e.suspendedState===t.suspendedState))).subscribe((e=>this.sendAppStateChangeToWorker({requestOperationtype:KE.NotifyCoreSuspendedState,context:{appState:e.suspendedState}})))}dispose(){this._clientStateSubscription&&(this._clientStateSubscription.unsubscribe(),this._clientStateSubscription=void 0),this._machineLockStateSubscription&&(this._machineLockStateSubscription.unsubscribe(),this._machineLockStateSubscription=void 0),this._suspendedStateSubscription&&(this._suspendedStateSubscription.unsubscribe(),this._suspendedStateSubscription=void 0)}sendAppStateChangeToWorker(e){var t,n,a,o,r,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(0,Ci.u4)(e);let l;try{l=yield this.getCdlAppStateClient()}catch(e){return void(null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`Failed to send app state change ${i} to CDL. Reason: failed to obtain a CDLAppStateClient. See initialization failures earlier in the logs.`,"cdl_services_worker_worker_state_sender_send_app_state_get_client_error",void 0,!0))}if(l){this._logger.log(`Alerting CDL Worker of host state change: ${i}`);try{yield l.sendFilteredAppStateRequest(e)}catch(e){null===(s=(r=this._logger).errorToTelemetry)||void 0===s||s.call(r,`Failed to send app state change ${i} to CDL. Reason: ${(0,Ci.u4)(e)}`,"cdl_services_worker_worker_state_sender_send_app_state_send_request_error",void 0,!0)}}else null===(o=(a=this._logger).errorToTelemetry)||void 0===o||o.call(a,`Failed to send app state change ${i} to CDL. Reason: CDLAppStateClient does not exist. See initialization failures earlier in the logs.`,"cdl_services_worker_worker_state_sender_send_app_state_get_client_undefined_error",void 0,!0)}))}getCdlAppStateClient(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.cdlWorkerService.getCDLWorkerManager();return null==e?void 0:e.workerClientResponseRouter.cdlAppStateClient}))}}class HA extends zE{constructor(e,t){super(),this.workerClientResponseRouter=e,this.logger=t.loggerFactory.newLogger("CDLControlPlaneCommunicator")}sendMessage(e){this.getRequestForOperationName(e).then((t=>this.handleResponse(e.rendererId,e.requestId,this.extractPerfStats(t)))).catch((t=>this.handleResponse(e.rendererId,e.requestId,void 0,(0,Ci.u4)(t)||"Unknown Error")))}getRequestForOperationName(e){const t=e.operationName;if(!t)return Promise.reject(`Request could not be sent: operationName unavailable. RequestId: ${e.requestId}.`);switch(this.logger.log(`Converting GQL operation ${t} to CDL Worker control plane message.`),t){case"notifyWorkerSyncCanStart":return this.workerClientResponseRouter.cdlControlClient.sendRequest({type:"sync_can_start"});case"AppsChatNotifyActiveContextChangedMutation":const t=e.request.variables;return this.workerClientResponseRouter.cdlControlClient.sendRequest({type:"active_context_changed",activeContextChangedData:{activeContextId:t.activeContextId,activeContextType:t.activeContextType}})}}handleResponse(e,t,n,i){return Promise.resolve(this.onResponseReceived({payload:{dataLayer:{rendererId:e,requestId:t,data:!i,errors:i,extensions:{perfStats:n}}}}))}extractPerfStats(e){return{workerResponseTime:e.workerResponseTime||0,dataStorePerfStats:[]}}}var $A=n(817102);class zA{constructor(e,t,n,i,a,o,r){this.configLoader=e,this.coreSettings=t,this.coreSettingsContext=n,this.platformService=a,this.primaryUser=o,this.locale=r,this._hostSettings={},this.logger=i.newLogger("CDLWorkerHostSettingsAggregator")}get hostSettings(){return 0===Object.keys(this._hostSettings).length&&(this._hostSettings=this.aggregateHostSettings()),this._hostSettings}startNotifyingCDLWorkerForHostSettingsChanges(e){const t=[K.J.Activity,K.J.Auth,K.J.Calendar,K.J.CdlWorker,K.J.Communities,K.J.Core,K.J.CsaService,K.J.Diagnostics,K.J.DiscoverSurface,K.J.Esp,K.J.Extensibility,K.J.ExternalAccounts,K.J.Files,K.J.Flyout,K.J.Guardians,K.J.Host,K.J.MeetingArtifacts,K.J.Messaging,K.J.Metadata,K.J.People,K.J.Platform,K.J.Presence,K.J.TeamsAndChannels,K.J.WhatsNew,K.J.WindowsSignatureExperiences].map((e=>this.coreSettings.getObservable(e)));(0,AE.T)(...t).subscribe((t=>{const n=this.aggregateHostSettings();(0,a.isEqual)(this._hostSettings,n)||(this._hostSettings=n,this.logger.log("Notifying CDL Worker of host settings changes: ",n),e.sendRequest({type:"host_settings_updated",hostSettings:n}))}))}aggregateHostSettings(){var e;this.logger.debug("aggregateHostSettings called...");const{enableNetworkStateCommsBetweenCoreAndWorker:t,enableMTMA:n}=this.coreSettings.get(K.J.Core),{electronVersion:i,enableHybridChannelList:a=!1,msgEnableChannelsV2:o=!1,msgEnableChannelsV2Header:r=!1,msgEnableSelfChat:s=!1,userType:l="",windowsInsiderChannel:d}=this.coreSettings.get(K.J.Host),c=this.coreSettingsContext,{enableTPSSyncStrategy:u,enableTPSUpdatesOverTrouter:m,tpsSyncStrategyPollingIntervalMs:g}=this.coreSettings.get(K.J.CdlWorker);let p=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({enableNetworkStateCommsBetweenCoreAndWorker:!!t,enableMTMA:!!n,policiesNamespaces:this.configLoader("policies").namespaces||[],enableSyncEngine:(0,BA.Q6)(this.coreSettings),enableProfileManagerStore:(0,BA.bE)(this.coreSettings),enableMessagingNotificationsOverTrouter:this.isMessagingNotificationsOverTrouterEnabled(),imageCookieAuthEnabled:!this.coreSettings.get(K.J.Auth).skipAmsAuthRequest,msgEnableChannelsV2:o,msgEnableChannelsV2Header:r,msgEnableSelfChat:s,enableHybridChannelList:a,enableEspInWorker:!!this.coreSettings.get(K.J.Esp).enableEsp,ecsHostUrl:this.platformService.ecsOverrides.hostUrl,desktopVersion:this.platformService.host.hostAppVersion,initialWorkerHostLocationUrl:this.platformService.config.currentUrl,serviceSwitcherSelectedServiceId:c.getServiceSwitcherApiKey(),electronVersion:i,locale:this.locale||De.ZW,userType:l,windowsInsiderChannel:d,enableTPSSyncStrategy:!!u,enableTPSUpdatesOverTrouter:!!m,tpsSyncStrategyPollingIntervalMs:g},this.getCdlWorkerHostSettings(this.coreSettings)),this.getActivityHostSettings(this.coreSettings)),this.getActivityNotificationHostSettings(this.coreSettings)),this.getEndpointsHealthHostSettings(this.coreSettings)),this.getPeopleHostSettings(this.coreSettings)),this.getMessagingHostSettings(this.coreSettings)),this.getTeamsAndChannelsSettings(this.coreSettings)),this.getCalendarHostSettings(this.coreSettings)),this.getExternalAccountSettings(this.coreSettings)),this.getPresenceHostSettings(this.coreSettings)),this.getDataStoreHostSettings(this.coreSettings)),this.getFilesHostSettings(this.coreSettings)),this.getChannelInfoPaneSettings(this.coreSettings)),this.getAuthHostSettings(this.coreSettings)),this.getDiscoverSurfaceHostSettings(this.coreSettings)),this.getMtmaSpecificHostSettings()),this.getGuardiansHostSettings(this.coreSettings)),v=this.getCoreSettingsTestOverrides(this.coreSettingsContext);const{isRunningGlassjar:h}=this.coreSettings.get(K.J.Test);if(this.platformService.config.isInCypressFrame||h){const t={authOverrides:{authzEndpointUrl:this.coreSettings.get(K.J.Auth).authzEndpointUrl},csaOverrides:{csaHostUrl:null===(e=this.coreSettings.get(K.J.CsaService).apiConstants)||void 0===e?void 0:e.host}};p=Object.assign(Object.assign({},p),t),v={localStorageTestOverrides:Object.assign(Object.assign({},v.localStorageTestOverrides),{test:{}}),qspTestOverrides:v.qspTestOverrides}}return Object.assign(Object.assign(Object.assign({},p),v),{cdlWorkerSettings:this.getCdlWorkerSettings(this.coreSettings)})}getCdlWorkerSettings(e){const{enableFilterPinnedAppsBasedOnPolicy:t,enableBotSsoV2:n,disabledTabAppIds:i}=e.get(K.J.Extensibility),{enableTflHomepage:a}=e.get(K.J.Homepage),{enableVoicemailFeedItems:o,enableCommunitiesFeedItems:r,enabledCommunitiesActivities:s,activityCustomizations:l}=e.get(K.J.Activity),{enableCalendarInviteRouting:d}=e.get(K.J.Calendar),{enableCallsAppPhaseStateMachine:c,enableMeetingStartedNotificationV2:u,dialPlanPolicy:m,allowNonE164Mri:g,enableDialPlans:p,enablePstnWithExtnFix:v,enableFormattingFixForExtension:h,enableFixForDtmfTone:f,allowPrivateCallingPolicy:y}=e.get(K.J.Calling),{enableSubstrateInstrumentation:k}=e.get(K.J.Autosuggest),{enableTaglessNameForAnonConsumerUser:S,allowScopedPeopleSearchandAccess:b}=e.get(K.J.People),{enableConsumerConversations:C,commCopilotSummarizationRequestConfig:w}=e.get(K.J.Messaging),{ageGroup:N}=e.get(K.J.AgeConsent),{enableT2ChannelsAtMentionBadging:T,enableT2ChannelsBadgingAppBar:I,enableAutoFavoriteChannel:E,enableRecommendedTeamsSync:A,enableReactJoinTeamsGallery:_,recommendedTeamsCacheIntervalInHours:D,enableUserResolutionForChannelModeratorList:F}=e.get(K.J.TeamsAndChannels),{enableShowMissedActivitiesInChatList:M,disablePinnedChatsInUserPreferences:R}=e.get(K.J.ChatList),{clientExtendedDiagnosticsData:P,disableExtendedDiagnosticsDataToggle:O,enableWorkerStoreDiagnosticsLogsInIDB:x,workerDiagnosticsLogBufferArraySize:L,workerDiagnosticsLogsIDBObjectCount:U,logsMarkInterval:B,savingLogsIntoIDBThrottleTime:j,throttleWindowSizeMs:W,throttleCapacity:V,diagnosticsLogsThrottling:H,consoleLogLevel:$}=e.get(K.J.Diagnostics),{allowEngagementReportPolicy:z,enableBypassingEngagementReportPolicy:G}=e.get(K.J.MeetingArtifacts),{enableWhatsNew:q,enableEntryPointPromotions:Q,maxFeaturesInOverlayCount:J,maxValidFromDaysToBeShown:Y,contactsSync:Z,chatViaSms:X,flyoutV2:ee,flyoutInlineChat:te,togetherEmojisHighFive:ne,communitiesBeta:ie}=e.get(K.J.WhatsNew),{enableOverflowMenuInFlyout:ae}=e.get(K.J.Flyout),{enableHighFiveTogetherEmojis:oe}=e.get(K.J.WindowsSignatureExperiences),{enablePhonelinkSms:re}=e.get(K.J.PhonelinkSms);return{core:this.getCoreSettings(e),[K.J.Messaging]:{allowUserChat:this.getAllowUserChat(e),enableConsumerConversations:!!C,commCopilotSummarizationRequestConfig:w},[K.J.Extensibility]:{enableFilterPinnedAppsBasedOnPolicy:t,enableBotSsoV2:n,disabledTabAppIds:i},[K.J.Activity]:{activityCustomizations:l,enableVoicemailFeedItems:!!o,enableCommunitiesFeedItems:!!r,enabledCommunitiesActivities:s},[K.J.Communities]:this.getCdlWorkerSettingsForCommunities(e),[K.J.Homepage]:{enableTflHomepage:a},[K.J.Calendar]:{enableCalendarInviteRouting:d},[K.J.Calling]:{enableCallsAppPhaseStateMachine:!!c,enableMeetingStartedNotificationV2:!!u,allowNonE164Mri:!!g,enableDialPlans:!!p,enablePstnWithExtnFix:!!v,dialPlanPolicy:m||void 0,enableFormattingFixForExtension:!!h,enableFixForDtmfTone:!!f,allowPrivateCallingPolicy:!!y},[K.J.People]:{enableTaglessNameForAnonConsumerUser:!!S,allowScopedPeopleSearchandAccess:!!b},[K.J.Auth]:this._applyCdlWorkerAuthSettings(e),[K.J.AgeConsent]:{ageGroup:N},platform:{deviceInfo:e.get(K.J.Platform).deviceInfo},[K.J.Autosuggest]:{enableSubstrateInstrumentation:!!k},[K.J.TeamsAndChannels]:{enableT2ChannelsAtMentionBadging:!!T,enableT2ChannelsBadgingAppBar:!!I,enableAutoFavoriteChannel:E,enableRecommendedTeamsSync:!!A,enableReactJoinTeamsGallery:!!_,recommendedTeamsCacheIntervalInHours:D,enableUserResolutionForChannelModeratorList:!!F},[K.J.ChatList]:{enableShowMissedActivitiesInChatList:!!M,disablePinnedChatsInUserPreferences:!!R},metadata:{region:e.get(K.J.Metadata).region},cdlWorker:{disableLastMessageSenderCache:!!e.get(K.J.CdlWorker).disableLastMessageSenderCache},[K.J.Test]:Object.assign({},e.get(K.J.Test)),[K.J.Diagnostics]:{clientExtendedDiagnosticsData:!!P,disableExtendedDiagnosticsDataToggle:!!O,enableWorkerStoreDiagnosticsLogsInIDB:!!x,workerDiagnosticsLogBufferArraySize:L||0,workerDiagnosticsLogsIDBObjectCount:U||0,logsMarkInterval:B||0,throttleWindowSizeMs:W||0,throttleCapacity:V||0,savingLogsIntoIDBThrottleTime:j||0,diagnosticsLogsThrottling:H||Lr.gG.DryRunQuiet,consoleLogLevel:$},[K.J.WhatsNew]:{enableWhatsNew:!!q,enableEntryPointPromotions:!!Q,maxFeaturesInOverlayCount:J||0,maxValidFromDaysToBeShown:Y||0,contactsSync:Z,chatViaSms:X,flyoutV2:ee,flyoutInlineChat:te,togetherEmojisHighFive:ne,communitiesBeta:ie},[K.J.WindowsSignatureExperiences]:{enableHighFiveTogetherEmojis:!!oe},[K.J.Flyout]:{enableOverflowMenuInFlyout:!!ae},[K.J.MeetingArtifacts]:{allowEngagementReportPolicy:z,enableBypassingEngagementReportPolicy:G},[K.J.PhonelinkSms]:{enablePhonelinkSms:!!re}}}getCoreSettings(e){const{enable1JSGraphqlSearchBox:t,enableCommunitiesBadgeCount:n,enableLocaleFilterForFeatureFlags:i,enablePoliciesPushUpdates:a,searchBoxSuggestions:o}=e.get(K.J.Core);return{enable1JSGraphqlSearchBox:!!t,enableCommunitiesBadgeCount:!!n,enableLocaleFilterForFeatureFlags:i,enablePoliciesPushUpdates:a,searchBoxSuggestions:o}}getCdlWorkerSettingsForCommunities(e){const{enableCommunitiesApp:t,enableMemberThreadDetailsSync:n,enableCommunitiesDetailedBadgeCount:i}=e.get(K.J.Communities);return{enableCommunitiesApp:t,enableMemberThreadDetailsSync:n,enableCommunitiesDetailedBadgeCount:i}}_applyCdlWorkerAuthSettings(e){const{allowCdlWorkerToUpdateSetting:t,skypeTokenMigrationEnabled:n,skypeTokenMigrationServiceInfo:i}=e.get(K.J.Auth);return{allowCdlWorkerToUpdateSetting:!!t,skypeTokenMigrationEnabled:!!n,skypeTokenMigrationServiceInfo:i||void 0}}getAllowUserChat(e){const{allowUserChat:t,messagingPolicy:n}=e.get(K.J.Messaging);return"boolean"==typeof t||!!n?!!t:void 0}getPresenceHostSettings(e){const{enablePresenceInWorker:t,enablePresenceNotificationsOverTrouter:n,enablePriorityContactsSettings:i,enableEndpointsManagerOnBreakthroughService:a,enableOOFSettings:o,enableSendPresenceTokenToUPS:r}=e.get(K.J.Presence);return{enablePresenceInWorker:!!t,enablePresenceNotificationsOverTrouter:!!n,enablePriorityContactsSettings:!!i,enableEndpointsManagerOnBreakthroughService:!!a,enableOOFSettings:!!o,enableSendPresenceTokenToUPS:!!r}}getAuthHostSettings(e){const{skypeTokenValidationDisabled:t}=e.get(K.J.Auth);return{skypeTokenValidationDisabled:!!t}}getChannelInfoPaneSettings(e){const{enableChannelInfoPane:t}=e.get(K.J.Channels);return{enableChannelInfoPane:!!t}}getCdlWorkerHostSettings(e){const{enableAppsPlatformSyncEngine:t,enableChatWithUserNetworkFetch:n,enableClassBasedErrors:i,enableOfflineActionsSyncEngine:a,enableOpenWindowsSettingsMaglev:o,enablePoliciesSyncEngine:r,enableCrossTenantPoliciesSyncEngine:s,enableConversationReminderEngine:l,enableNotificationsEngine:d,enableAppsUsageSyncEngine:c,enableSendNudgeAfterInactivityPeriod:u,enableStartupDeferral:m,enableTenantSyncStrategy:g,enableSearchTopNPopulateStrategy:p,enableSensitivityLabelSync:v,enableUserPreferencesWorkerFetch:h,enableWaitOnAuthUp:f,chatsStartupJobPageSize:y,enableStartupUsingPartialData:k,enableNonRecentChatsStartup:S,nonRecentChatsStartupPageSize:b,nonRecentChatsStartupMaxCalls:C,nonRecentChatsStartupWorkflowTimeoutInMS:w,partialDataStartupChatsLimit:N,partialDataStartupSkipNonRecentMeeting:T,enableChatTitleCache:I,disableLastMessageSenderCache:E,disableUnknownTitleFallback:A,disableTitleCacheRefreshOnDisplayNameChange:_,enableMruChannelsMemoryPruning:D,currentConversationTableVersion:F,disableMessageContentWrapperDiv:M,disablePartialLoadConversationNetworkFetch:R,enableMultipleReplyChainsUpdatesFromWorker:P,enableMTMAAggregator:O,skipMeetingChatsInGroupChatSync:x,disablePingingPDSIfWorkerStartupFails:L,enablePriorityJobRunner:U,scheduleChannelsConversationSyncAtBackgroundPriority:B,trouterNotifyServiceDownTimerMs:j,chatServiceMaxPageSize:W,chatReplyChainsToFetch:V,preloadNamespaces:H}=e.get(K.J.CdlWorker);return{enableClassBasedErrors:!!i,enablePoliciesSyncEngine:!!r,enableCrossTenantPoliciesSyncEngine:!!s,enableOpenWindowsSettingsMaglev:!!o,enableConversationReminderEngine:!!l,enableSendNudgeAfterInactivityPeriod:!!u,enableNotificationsEngine:!!d,enableAppsUsageSyncEngine:!!c,enableUserPreferencesWorkerFetch:!!h,enableAppsPlatformSyncEngine:!!t,enableChatWithUserNetworkFetch:!!n,enableOfflineActionsSyncEngine:!!a,enableStartupDeferral:!!m,enableTenantSyncStrategy:!!g,enableSearchTopNPopulateStrategy:!!p,enableSensitivityLabelSync:!!v,enableWaitOnAuthUp:!!f,enableStartupUsingPartialData:!!k,enableNonRecentChatsStartup:!!S,nonRecentChatsStartupPageSize:b,nonRecentChatsStartupMaxCalls:C,nonRecentChatsStartupWorkflowTimeoutInMS:w,chatsStartupJobPageSize:y,partialDataStartupChatsLimit:N,partialDataStartupSkipNonRecentMeeting:T,skipMeetingChatsInGroupChatSync:!!x,enableChatTitleCache:!!I,disableLastMessageSenderCache:!!E,enableMruChannelsMemoryPruning:!!D,disableUnknownTitleFallback:!!A,disableTitleCacheRefreshOnDisplayNameChange:!!_,disablePartialLoadConversationNetworkFetch:!!R,enableMultipleReplyChainsUpdatesFromWorker:!!P,enableMTMAAggregator:!!O,disablePingingPDSIfWorkerStartupFails:L,currentConversationTableVersion:F,disableMessageContentWrapperDiv:M,enablePriorityJobRunner:!!U,scheduleChannelsConversationSyncAtBackgroundPriority:!!B,trouterNotifyServiceDownTimerMs:j,chatServiceMaxPageSize:W,chatReplyChainsToFetch:V,preloadNamespaces:H}}getActivityHostSettings(e){const{enableActivityManagerStore:t,enableActivityBellCount:n,paginationFirstLoad:i,maxActivityFeedLatency:a,clientStableBufferTimeForAPT:o,enableOrderFeedsReplyChainsByMaxVersion:r,enableChannelFeedItems:s,enableActivityTranslationInCDL:l,enableMarkAllAsReadLogic:d,enableUrgentFeedItems:c,enableSyntheticNotificationProcessor:u,enableGraphFeedItems:m,enableSharedChannelFeedItems:g,disableIncomingPstnActivityFeed:p,enableMTMAMissedNotifications:v,mtmaNotificationsPollingInterval:h,enableActivityFeedItemDeletion:f}=e.get(K.J.Activity);return{enableActivityManagerStore:!!t,enableActivityBellCount:!!n,feedItemsCountOnAppLoad:i||0,maxActivityFeedLatency:a||0,clientStableBufferTimeForAPT:o||0,enableOrderFeedsReplyChainsByMaxVersion:!!r,enableChannelFeedItems:!!s,enableActivityTranslationInCDL:!!l,enableMarkAllAsReadLogic:!!d,enableSharedChannelFeedItems:!!g,enableUrgentFeedItems:!!c,enableSyntheticNotificationProcessor:!!u,enableGraphFeedItems:!!m,disableIncomingPstnActivityFeed:!!p,enableMTMAMissedNotifications:!!v,mtmaNotificationsPollingInterval:h||zA.mtmaNotificationsPollingIntervalDefault,enableActivityFeedItemDeletion:!!f}}getActivityNotificationHostSettings(e){const{enableNewSettingsApiUse:t,enableMissedActivityEmails:n}=e.get(K.J.ActivityNotification);return{enableNewSettingsApiUse:!!t,enableMissedActivityEmails:!!n}}getPeopleHostSettings(e){const{enableBuddyListService:t,buddyListRefreshTimeoutInMilliSeconds:n,blockedListRefreshIntervalInMs:i,blockedListPendingActionQueueChunkSize:a,enableContactsSync:o,enableMultipleAliasesForContactsSync:r,maxNumberOfRoamingDevices:s,enableInstantSyncForRoamingDevices:l,fetchTFLContactsRefreshInterval:d,enableEndpointsManagerOnAcceptListService:c,enableEndpointsManagerOnBuddyService:u,enableEndpointsManagerOnBlockService:m,contactsSyncDeltaRefreshIntervalInMs:g,contactsSyncFullRefreshIntervalInMs:p,contactsSyncKeepAliveIntervalInMs:v,maxBatchSizeforSCDDeletion:h,lokiTokenResourceUrl:f,buddyServiceEndpointManagerMaxRetries:y,enableTflTfwFederation:k,enableProfilePicturesWithObjectId:S,enableMeProfileSyncStrategy:b,checkProfileExpiryAndRefreshIntervalInMs:C,enableTfwToTfwFederatedInviteFree:w,enableBlockedContactsDataStore:N,enableM365Endpoint:T,enableExtendedDirectory:I,enableCapiv3ContactsSync:E,enableProfileFetchFromWorkingSet:A}=e.get(K.J.People);return{enableBuddyListService:!!t,buddyListRefreshTimeoutInMilliSeconds:n||0,blockedListRefreshIntervalInMs:i||0,blockedListPendingActionQueueChunkSize:a||0,enableContactsSync:!!o,enableMultipleAliasesForContactsSync:!!r,maxNumberOfRoamingDevices:s||0,enableInstantSyncForRoamingDevices:!!l,fetchTFLContactsRefreshInterval:d||[],enableEndpointsManagerOnAcceptListService:!!c,enableEndpointsManagerOnBuddyService:!!u,enableEndpointsManagerOnBlockService:!!m,contactsSyncDeltaRefreshIntervalInMs:g||0,contactsSyncFullRefreshIntervalInMs:p||0,contactsSyncKeepAliveIntervalInMs:v||0,maxBatchSizeforSCDDeletion:h||0,lokiTokenResourceUrl:f||"",buddyServiceEndpointManagerMaxRetries:y||0,enableTflTfwFederation:!!k,enableProfilePicturesWithObjectId:!!S,enableMeProfileSyncStrategy:!!b,checkProfileExpiryAndRefreshIntervalInMs:C||0,enableTfwToTfwFederatedInviteFree:!!w,enableBlockedContactsDataStore:!!N,enableM365Endpoint:!!T,enableExtendedDirectory:!!I,enableCapiv3ContactsSync:!!E,enableProfileFetchFromWorkingSet:!!A}}getMessagingHostSettings(e){const{enableChatWithNonTflUsers:t,enableCSAChatSummarization:n,enableTflSmsCreate:i,enableTfwTflFederation:a,enableTfwFederationOnTfl:o,tflSmsAllowedPhoneNumberRegionCodes:r,enableTFLSmsFriendlyNameSearch:s,disableMessagingSyncEngine:l,disableRendererSideSanitization:d,enableAutoSendV2:c}=e.get(K.J.Messaging);return{enableChatWithNonTflUsers:!!t,enableCSAChatSummarization:!!n,enableTflSmsCreate:!!i,enableTfwTflFederation:!!a,enableTfwFederationOnTfl:!!o,enableTFLSmsFriendlyNameSearch:!!s,tflSmsAllowedPhoneNumberRegionCodes:r||[],disableMessagingSyncEngine:!!l,enableAutoSendV2:!!c,disableRendererSideSanitization:!!d}}getTeamsAndChannelsSettings(e){const{enablePinnedChannelsSyncEngine:t,maximumPinnedChannelLimit:n,pinnedChannelsSyncIntervalInMs:i,enableFixingPinnedChannelsConflict:a,enableUserResolutionForChannelModeratorList:o,enableRecommendedTeamsSync:r}=e.get(K.J.TeamsAndChannels);return{enablePinnedChannelsSyncEngine:!!t,maximumPinnedChannelLimit:n,pinnedChannelsSyncIntervalInMs:i,enableFixingPinnedChannelsConflict:!!a,enableUserResolutionForChannelModeratorList:!!o,enableRecommendedTeamsSync:!!r}}getCalendarHostSettings(e){const{autodiscoverSettings:t,calendarRESTEnabledAPIs:n,connectedCalendarSettingsRefreshIntervalInMs:i,enableCalendarSyncEngine:a,enableCalendarV2ApiService:o,enableCalendarV2ApiServiceEnterprise:r,enableClientStateCheckForCalendarPolling:s,enableMultipleCalendarSyncEngine:l,enableClientStateCheckForMultipleCalendarPolling:d,enableConnectedCalendar:c,enableConnectedCalendarSettingsSync:u,enableCourseCalendarSyncEngine:m,isOnCloud:g,maxRoomListsToFetch:p,maxRoomsInRoomListToFetch:v,maxRoomsToFetch:h,enableThirdPartyCalendar:f,calendarEventsPollIntervalInMs:y,isLmsCourseCalendar:k,enablePrefetchCalendarEventsOnStartUp:S,enablePrefetchCourseCalendarEventsOnStartUp:b,enableSensitivityLabelInCalendar:C,enableEventFetchOptimizationUsingLastSync:w,enableMeetingArtifactsCollaborationData:N,enableCalendarPushNotifications:T,enableCalendarPollingWithPushNotifications:I,enableCalendarGCVOptimizations:E}=e.get(K.J.Calendar);return{autodiscoverSettings:t,calendarRESTEnabledAPIs:n,connectedCalendarSettingsRefreshIntervalInMs:i||0,enableCalendarSyncEngine:!!a,enableCalendarV2ApiService:!!o,enableCalendarV2ApiServiceEnterprise:!!r,enableClientStateCheckForCalendarPolling:!!s,enableClientStateCheckForMultipleCalendarPolling:!!d,enableMultipleCalendarSyncEngine:!!l,enableConnectedCalendar:!!c,enableConnectedCalendarSettingsSync:!!u,enableCourseCalendarSyncEngine:m,enableEventFetchOptimizationUsingLastSync:w,enableMeetingArtifactsCollaborationData:N,enablePrefetchCourseCalendarEventsOnStartUp:b,isOnCloud:g,maxRoomListsToFetch:p,maxRoomsInRoomListToFetch:v,maxRoomsToFetch:h,enableThirdPartyCalendar:!!f,calendarEventsPollIntervalInMs:y,isLmsCourseCalendar:!!k,enablePrefetchCalendarEventsOnStartUp:!!S,enableSensitivityLabelInCalendar:!!C,enableCalendarPushNotifications:!!T,enableCalendarPollingWithPushNotifications:!!I,enableCalendarGCVOptimizations:!!E}}getExternalAccountSettings(e){const{enableExternalAccounts:t,requestSource:n,enableUnifiedHardDelete:i}=e.get(K.J.ExternalAccounts);return{enableExternalAccounts:!!t,requestSource:n,enableUnifiedHardDelete:!!i}}getEndpointsHealthHostSettings(e){const{enableWorkerEndpointsHealthMonitor:t,enableWorkerEndpointsHealthService:n}=e.get(K.J.Core);return{enableWorkerEndpointsHealthMonitor:!!t,enableWorkerEndpointsHealthService:!!n}}getDataStoreHostSettings(e){const{enableDbOpenTimeout:t,dbOpenTimeoutLengthSeconds:n,dataStoreMapType:i,disableDataStoreInMemoryProvider:a,disableDataStoreDbProvider:o,disableReplyChainManagerPrefetch:r,dataStoreCreationResiliencyConfig:s,dataStoreDbOperationResiliencyConfig:l,rollbackSupportInDataStoreInMemoryProvider:d}=e.get(K.J.CdlWorker);return{enableDbOpenTimeout:!!t,dbOpenTimeoutLengthSeconds:n||60,dataStoreMapType:i||"",disableDataStoreInMemoryProvider:!!a,disableDataStoreDbProvider:!!o,rollbackSupportInDataStoreInMemoryProvider:!!d,disableReplyChainManagerPrefetch:!!r,dataStoreCreationResiliencyConfig:s||{enable:!1},dataStoreDbOperationResiliencyConfig:l}}getCoreSettingsTestOverrides(e){const t=e;return{localStorageTestOverrides:t.getLocalStorageTestOverrides()||{},qspTestOverrides:t.getQspTestOverrides()||{}}}getFilesHostSettings(e){const{preferGraphOverVroom:t,vroomEndpointBaseUrl:n,graphEndpointBaseUrl:i,graphAuthScope:a,vroomAuthScope:o}=e.get(K.J.Files);return{filesOverrides:{preferGraphOverVroom:!!t,vroomEndpointBaseUrl:n||"",graphEndpointBaseUrl:i||"",graphAuthScope:a||"",vroomAuthScope:o||""}}}getDiscoverSurfaceHostSettings(e){const{discoverSurfaceDefaultSection:t,discoverSurfaceTopItemsCount:n,enableDiscoverSurfaceDebugMenu:i,enableHybridDiscoverSurface:a,enableDiscoverBadging:o,dataSyncIntervalTime:r,enableDiscoverSurfaceSyncEngine:s}=e.get(K.J.DiscoverSurface);return{enableHybridDiscoverSurface:!!a,discoverSurfaceTopItemsCount:n||$A.$.defaultItemsToFetch,discoverSurfaceDefaultSection:t||$A.$.defaultSection,enableDiscoverSurfaceDebugMenu:!!i,enableDiscoverBadging:!!o,dataSyncIntervalTime:r||$A.$.defaultDataSyncIntervalTime,enableDiscoverSurfaceSyncEngine:!!s}}getMtmaSpecificHostSettings(){const{enableMTMA:e}=this.coreSettings.get(K.J.Core);return e&&this.primaryUser&&this.primaryUser.profile?{primaryUserProfile:{oid:this.primaryUser.profile.objectId,tid:this.primaryUser.profile.tenantId}}:{}}isMessagingNotificationsOverTrouterEnabled(){const e=this.coreSettings.get(K.J.Host).enableMessagingNotificationsOverTrouter;return(0,a.isNil)(e)?!!this.coreSettings.get(K.J.CdlWorker).enableMessagingNotificationsOverTrouter:e}getGuardiansHostSettings(e){const{enableGuardiansPreferredMethodAndSmsInvite:t}=e.get(K.J.Guardians);return{enableGuardiansPreferredMethodAndSmsInvite:t}}}zA.mtmaNotificationsPollingIntervalDefault=3e5;var GA=n(517572);class qA{constructor(){this.perfDataByOperationName=new Map,this.cdlSubscriptionAggregatorAllowList=["chatServiceEvent","DataResolversBrowserChatServiceEventsChatServiceBatchEventSubscription","DataResolversBrowserChatServiceEventsChatServiceEventSubscription"]}static getInstance(){return this.subscriptionEventAggregatorSingleton||(this.subscriptionEventAggregatorSingleton=new qA),this.subscriptionEventAggregatorSingleton}init(e,t,n){var i;this.logger=e.newLogger("SubscriptionEventAggregator"),n&&(this.cdlSubscriptionAggregatorAllowList=n),null===(i=this.logger)||void 0===i||i.log(`Initialized CDLSubscriptionEventAggregator Allow List: ${this.cdlSubscriptionAggregatorAllowList.join(",")}`),this.intervalCancellationToken=setInterval((()=>{this.logStats(t)}),SA.A_)}addToTimeline(e,t,n,i,a,o){if(this.intervalCancellationToken||this.init(n,i,a),!t)return void(this.logger&&this.logger.log("Received subscription perf stat without responseSendTime. Ignoring."));const r=Date.now()-t;if(!(r<0)&&(e&&!this.perfDataByOperationName.has(e)&&this.perfDataByOperationName.set(e,{ipcTimes:[],customIdentifierCount:{}}),e)){const t=this.perfDataByOperationName.get(e);if(!t)return void(this.logger&&this.logger.warn(`SubscriptionEventAggregator: No perf data found for operationName ${e}`));if(t.ipcTimes.push(r),o){let e={};e="string"==typeof o?{[o]:1}:o,Object.keys(e).forEach((n=>{const i=e[n];t.customIdentifierCount[n]||(t.customIdentifierCount[n]=0),t.customIdentifierCount[n]+=i}))}}}logStats(e){const t=Array.from(this.perfDataByOperationName.entries());this.perfDataByOperationName.clear();for(const[n,i]of t){if(!this.cdlSubscriptionAggregatorAllowList.includes(n))continue;const t={operationName:n,numberOfRequests:i.ipcTimes.length,averageIPCTimeOneWay:i.ipcTimes.reduce(((e,t)=>e+t),0)/i.ipcTimes.length},o=e.newScenario(ft.RG.CentralDataLayerSubscription);(0,a.keys)(i.customIdentifierCount).forEach((e=>{o.mark(e,{size:i.customIdentifierCount[e],type:e})})),o.stop(t)}}}function QA(e,t,n,i,a){var o,r;let s;if(function(e,t,n){return!e.some((e=>{var i,a;const o=t.getEntriesByName(e);return null===(i=n.infoToTelemetry)||void 0===i||i.call(n,`Marker performance information ${e}!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!1),o.length<=0&&(null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`Measure ${e} was never created!`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0),!0)}))}([t,n],i,a))try{i.measure(e,t,n);const a=i.getEntriesByName(e)[0];s=null==a?void 0:a.duration,s&&(s=Math.round(s)),i.clearMeasures(e)}catch(e){null===(o=a.errorToTelemetry)||void 0===o||o.call(a,`Failed to capture measurement between ${t} and ${n}: ${e}`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0)}else null===(r=a.errorToTelemetry)||void 0===r||r.call(a,`Can not capture measurement between ${t} and ${n}, at least one of them not exist`,"telemetry_instrumentation_capture_perf_measurement",void 0,!0);return s}function JA(e,t,n,i){e.measure(t,n,i),e.clearMeasures(t),e.clearMarks(n),i&&e.clearMarks(i)}class YA{constructor(e,t,n){this.isResponse=t,this.internalPerfStat={operationName:n,requestStartTime:{perf:performance.now(),date:Date.now()},responseReceivedTime:{perf:performance.now(),date:Date.now()},workerResponseTime:0,dataStorePerfStats:[]},this.operationName=n||"",this.operationType=e,performance.mark(`${this.getPerformanceName()}-start`)}stopMeasurement(e,t,n){this.internalPerfStat=Object.assign(Object.assign(Object.assign({},this.internalPerfStat),e),{responseReceivedTime:{perf:performance.now(),date:Date.now()}});const i=this.getPerformanceName(),a=`${i}-start`,o=`${i}-end`;!function(e,t){void 0===function(e,t){const n=t.getEntriesByName(e);if(n&&n.length>0)return n[0]}(e,t)&&t.mark(e)}(a,performance),performance.mark(o),JA(performance,i,a,o);const{requestStartTime:r,requestReceivedTime:s,responseSendTime:l,responseReceivedTime:d,workerResponseTime:c}=this.internalPerfStat,u={totalRequestTime:Math.round(d.perf-r.perf),workerResponseTime:Math.round(c),requestTime:Math.round(r.perf),responseTime:Math.round(d.perf)};return(null==t?void 0:t.length)&&(u.otherResponsesReceivedWhileInTransit=t),n&&(u.responseReceiveLatency=n),s&&(u.requestIPCTime=s-r.date),l&&(u.responseIPCTime=d.date-l),u}static markSubscriptionRequest(e){const t=`subscription_request_start_${e}`,n=`subscription_request_${e}`;performance.mark(t),JA(performance,n,t)}static addSubscriptionResponse(e,t,n,i,a,o){qA.getInstance().addToTimeline(e,t,n,i,o,a)}getPerformanceName(){return`cdl-${this.isResponse?"response":"request"}-${this.operationName||this.operationType}`}}const KA=["callParticipantsVoiceLevelsChangedEvent","callParticipantsChangedEvent"],ZA=["callingIntent","chat","messageList"],XA=["putConversations"],e_="debug";class t_{constructor(e,t,n,i,a,o,r,s,l,d,c=[],u,m,g,p,v,h){var f;if(this._logger=a,this.loggerFactory=o,this.scenarioFactory=r,this.syncEngineInitializationPromise=s,this.rendererId=l,this.requestHealthMonitor=u,this.enableClassBasedErrors=m,this.splitFetchWaitMarkerInWLT=v,this.dataLayerClientSettings=h,this._perfStats=null,this._perfStatsForResponseProcessing=null,this._scenario=void 0,this._requestId=e,this._windowId=d,this._requestType=t,"subscription"!==t?this._perfStats=new YA(t,!1,i):YA.markSubscriptionRequest(i),this._requestComplete=!1,this._operationName=i,this._loggingContext={requestId:e,component:"RequestHandler",requestRendererId:this.rendererId,requestWindowId:this.windowId,hostRendererId:n,operationType:t,operationName:i},c=c&&c.length?c:XA,this.subject=new GA.x(this._logger,this._loggingContext),this.logRequest(),i&&!c.includes(i)&&"subscription"!==t){this._scenario=this.scenarioFactory.newScenario(ft.RG.CentralDataLayerRequest),this._scenario.clientName=i;const e=this.getActiveCPM();if(this._scenario.appendEventData({operationName:i,operationType:t,context:this.rendererId,"Panel.WindowID":this.windowId,target:g,correlationId:null==p?void 0:p.callerScenarioId,origin:null==p?void 0:p.callerInfo,activeCPM:e}),this.isRequestFromWindowLaunch(i,r)){r.startStep(ft.RG.WindowLaunchTime,ft.ck.FetchWait);const e=this.scenarioFactory.findScenario(ft.RG.WindowLaunchTime);this._wltTimestampsAtInit=null==e?void 0:e.timestamps.length}}null===(f=this.requestHealthMonitor)||void 0===f||f.requestCreated(this)}get requestId(){return this._requestId}get windowId(){return this._windowId}get response(){return this.subject.observable}get requestType(){return this._requestType}get operationName(){return this._operationName}isComplete(){return this._requestComplete}setResponseAndEndScenario(e,t,n){var i,a,o;const r=!e.errors&&e.data;this._otherResponsesReceivedWhileInTransit=t,this._responseReceiveLatency=n,r?(this._perfStatsForResponseProcessing=new YA(this.requestType,!0,this.operationName),this.onSuccess(e)):this.onError(e),this.onComplete(r?"success":"error"),r&&(null===(i=e.extensions)||void 0===i?void 0:i.perfStats)&&(null===(a=this._perfStatsForResponseProcessing)||void 0===a||a.stopMeasurement(null===(o=e.extensions)||void 0===o?void 0:o.perfStats,t,n))}cancel(){this._requestComplete||(this._requestComplete=!0,this._scenario&&this._scenario.incomplete(),this.onComplete("cancelled"))}onComplete(e){var t;this._requestComplete&&(this.subject.onComplete(),null===(t=this.requestHealthMonitor)||void 0===t||t.requestCompleted(this,e))}onSuccess(e){this.mergeAndEndStatsSnapshot(e.extensions),this.logResponse(),this.subject.onNext(e)}onError(e){var t,n,i;this._requestComplete=!0;const a=(null==e?void 0:e.errors)||"Unexpected: data layer query response missing both data and error",o=Array.isArray(a)?a.map((e=>(0,Mn.VK)(e))).join():(0,Mn.VK)(a);if(this.mergeAndEndStatsSnapshot(e.extensions,o),this.enableClassBasedErrors)this.subject.onNext(e);else{let a=e.errorCode;!a&&(null===(t=e.errors)||void 0===t?void 0:t.length)&&(a=e.errors[0].name||De.jK.RemoteOperationFailed),a||(a=De.jK.InvalidResponse);const r=(0,Mn.Tr)(De.w5.DataLayerClient,a,"onError",void 0,o);null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,`error while processing ${this._requestId}: ${r.message} (reason: ${r.reason})`,"cdl_data_layer_client_request_on_error",Object.assign(Object.assign({},(0,kA.n)(this._loggingContext)),{errorCode:a}),!0),this.subject.onError(r)}}mergeAndEndStatsSnapshot(e,t){var n,i,a;let o;e&&e.perfStats&&(this._perfStats&&(o=this._perfStats.stopMeasurement(e.perfStats,this._otherResponsesReceivedWhileInTransit,this._responseReceiveLatency)),"subscription"===this.requestType&&YA.addSubscriptionResponse(this.operationName,e.perfStats.responseSendTime,this.loggerFactory,this.scenarioFactory,e.subscriptionCustomIdentifier,null===(n=this.dataLayerClientSettings)||void 0===n?void 0:n.cdlSubscriptionAggregatorAllowList)),e&&(null===(i=this._scenario)||void 0===i||i.appendEventData({dataSource:e.dataSource,size:null===(a=e.perfStats)||void 0===a?void 0:a.payloadLength})),this._scenario&&(t?this.syncEngineInitializationPromise.then((e=>{var n,i,a;null===(n=this._scenario)||void 0===n||n.appendEventData(Object.assign(Object.assign({},o),{errors:(0,ta.A)(t)})),e.isSyncEngineInitialized?null===(i=this._scenario)||void 0===i||i.fail():null===(a=this._scenario)||void 0===a||a.incomplete()})):(this._scenario.stop(o),this.isRequestFromWindowLaunch(this.operationName,this.scenarioFactory)&&this.createWltSteps(o)))}logResponse(){this._logger[this.getLogLevel()]("Received response data for request",this._loggingContext)}createWltSteps(e){const t=this.scenarioFactory.findScenario(ft.RG.WindowLaunchTime);if(t&&t.currentStep!==ft.ck.FetchProcessResponse){if(e){const{requestIPCTime:n,responseIPCTime:i,workerResponseTime:a}=e;if(n&&i&&this.splitFetchWaitMarkerInWLT){if(this._wltTimestampsAtInit&&t.timestamps.length>this._wltTimestampsAtInit)return;t.mark(ft.ck.FetchWaitRequestIPC,{offsetCurrentTimeInMs:Math.round(a)+i}),t.mark(ft.ck.FetchWaitWorker,{offsetCurrentTimeInMs:i}),t.mark(ft.ck.FetchWaitResponseIPC)}else t.mark(ft.ck.FetchWaitIPC,{offsetCurrentTimeInMs:Math.round(a)}),t.mark(ft.ck.FetchWaitWorker)}t.startStep(ft.ck.FetchProcessResponse)}}isRequestFromWindowLaunch(e,t){return!!t.findScenario(ft.RG.WindowLaunchTime)&&ZA.indexOf(e)>-1}logRequest(){this._logger.debug("Created new request",this._loggingContext)}getLogLevel(){var e;return KA.indexOf(null!==(e=this._loggingContext.operationName)&&void 0!==e?e:"")>=0?e_:"log"}getActiveCPM(){const e=[ft.RG.ChatSwitch,ft.RG.ChannelSwitchL1,ft.RG.ChannelSwitchL2,ft.RG.ChannelL1Deeplink,ft.RG.ChannelL2Deeplink,ft.RG.ActivitySwitch,ft.RG.ApplicationLaunchTime,ft.RG.WindowLaunchTime];if(this.scenarioFactory.doesScenariosExist){const t=this.scenarioFactory.doesScenariosExist(e);if(t.length)return t.join(",")}}}class n_ extends t_{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class i_ extends t_{onSuccess(e){super.onSuccess(e),this._requestComplete=!0}}class a_ extends t_{onSuccess(e){super.onSuccess(e)}}var o_=n(174195);class r_{constructor(e,t,n,i,a){this.config=t,this.timeoutProvider=n,this.syncEngineInitializationPromise=i,this.dataLayerTarget=a,this.isRequestInProcess=!1,this.requestTimer=null,this.openRequests=new Map,this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames=new Set,this.failedOperationNames=new Set,this.lastSucceededRequest=this.firstTimedOutRequest=r_.DefaultRequestLoggingData,this.logger=e.newLogger("RequestHealthMonitor")}requestCreated(e){if(!this.shouldMonitor(e))return;let t;null!==this.requestTimer||this.isRequestInProcess?t=!1:(this.startTimer(),t=!0),this.openRequests.set(e.requestId,{operationName:e.operationName,shouldTimeout:t,timeAdded:Date.now()})}requestCompleted(e,t){if(!this.shouldMonitor(e))return;this.openRequests.delete(e.requestId)||this.logger.warn(`Unknown request completed. Possibly timed out. RequestId ${e.requestId}, OperationName ${e.operationName}, Target ${this.dataLayerTarget}.`),0===this.openRequests.size&&null!==this.requestTimer&&this.clearTimer(),"success"===t&&this.onSuccess(e),"error"===t&&this.onError(e)}onSuccess(e){this.lastSucceededRequest={requestId:e.requestId,operationName:e.operationName},this.timedOutDistinctRequestCount=0,this.failedDistinctRequestCount=0,this.timedOutOperationNames.clear(),this.failedOperationNames.clear(),this.firstTimedOutRequest=r_.DefaultRequestLoggingData}onError(e){this.failedOperationNames.has(e.operationName)||(this.failedDistinctRequestCount++,this.failedOperationNames.add(e.operationName),this.failedDistinctRequestCount===this.failureCountThreshold&&this.indicateTargetUnhealthy("error"))}onTimeout(){let e=r_.DefaultRequestLoggingData,t=Number.MAX_SAFE_INTEGER;this.openRequests.forEach(((n,i)=>{if(n.shouldTimeout){const a=n.operationName;n.timeAdded<t&&(t=n.timeAdded,e={operationName:a,requestId:i}),this.logger.warn(`Request reached time out in health monitor. RequestId ${i}, OperationName ${a}, Target ${this.dataLayerTarget}.`),this.openRequests.delete(i),this.timedOutOperationNames.has(a)||(this.timedOutDistinctRequestCount++,this.timedOutOperationNames.add(a),this.timedOutDistinctRequestCount===this.timedOutCountThreshold&&this.indicateTargetUnhealthy("timedOut"))}else n.shouldTimeout=!0})),this.firstTimedOutRequest===r_.DefaultRequestLoggingData&&(this.firstTimedOutRequest=e),this.requestTimer=null,this.isRequestInProcess=!1,this.openRequests.size>0&&this.startTimer()}startTimer(){null!==this.requestTimer&&(this.logger.warn(`Health monitor timer already running when attempting to start new. Clearing old timer. Target ${this.dataLayerTarget}.`),this.timeoutProvider.clearTimeout(this.requestTimer)),this.isRequestInProcess=!0,this.syncEngineInitializationPromise.then((e=>{e.isSyncEngineInitialized&&(this.requestTimer=this.timeoutProvider.setTimeout((()=>this.onTimeout()),this.timeOutLengthMs))}))}clearTimer(){null!==this.requestTimer?(this.timeoutProvider.clearTimeout(this.requestTimer),this.requestTimer=null,this.isRequestInProcess=!1):this.logger.warn(`Health monitor timer tried to cancel non-existent timer. Ignoring. Target ${this.dataLayerTarget}.`)}indicateTargetUnhealthy(e){var t,n,i,a;let o="error"===e?`ErrorCount: ${this.failureCountThreshold}.`:`TimedOutCount: ${this.timedOutCountThreshold}. TimeOutMs: ${this.timeOutLengthMs}.`;this.config.memoryMapType&&(o=`${o} MemoryMapType: ${this.config.memoryMapType}.`);const r=`Last succeeded operation: ${this.lastSucceededRequest.operationName}, ${this.lastSucceededRequest.requestId}.`,s=`First timeout operation: ${this.firstTimedOutRequest.operationName}, ${this.firstTimedOutRequest.requestId}`,l=`RequestHealthMonitor: DataLayer is unhealthy due to successive requests failing with ${e}. Target: ${this.dataLayerTarget}. ${o} ${r} ${s}`;null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,l,"cdl_data_layer_client_request_health_monitor_unhealthy_target",void 0,!0),null===(a=(i=this.config).unhealthyDataLayerCallback)||void 0===a||a.call(i,l)}shouldMonitor(e){return"subscription"!==e.requestType}get failureCountThreshold(){return this.config.failureCountThreshold||r_.DefaultFailureCountThreshold}get timeOutLengthMs(){return(this.config.timeoutLengthSeconds||r_.DefaultTimeoutLengthSeconds)*SA.NO}get timedOutCountThreshold(){return this.config.timeoutCountThreshold||r_.DefaultTimeoutCountThreshold}}r_.DefaultFailureCountThreshold=5,r_.DefaultTimeoutCountThreshold=5,r_.DefaultTimeoutLengthSeconds=60,r_.DefaultRequestLoggingData={operationName:"na",requestId:"na"};class s_{constructor(e,t,n,i,a,o,r,s,l,d,c,u,m){var g;this.logger=e,this.scenarioFactory=n,this.syncEngineInitializationPromise=a,this.leakDetectorService=o,this.dataLayerCommunicatorTarget=r,this.timeoutProvider=s,this.enableClassBasedErrors=d,this.trackingOperationsDuringWaitConfig=c,this.dataClientTrackingService=u,this.dataLayerClientSettings=m,this.requestMap=new Map,this.recentlyCancelledRequests=new Map,this.loggingContext={hostRendererId:t,component:"RequestRegistrar"},this.leakDetector=null===(g=this.leakDetectorService)||void 0===g?void 0:g.create(),l&&l.enableRequestHealthMonitor&&s&&(this.requestHealthMonitor=new r_(i,l,s,this.syncEngineInitializationPromise,r))}createRequest(e,t,n,i,a,o,r,s){var l;const d=class{static createDataLayerRequest(e,t,n,i,a,o,r,s,l,d,c,u,m,g,p,v){const h=[e,t,n,i,a,o,r,s,l,d,void 0,c,u,m,g,p,v];switch(t){case"mutation":return new n_(...h);case"query":return new i_(...h);case"subscription":return new a_(...h)}}}.createDataLayerRequest(e,t,this.loggingContext.hostRendererId,n,this.logger,i,this.scenarioFactory,this.syncEngineInitializationPromise,a,o,this.requestHealthMonitor,this.enableClassBasedErrors,this.dataLayerCommunicatorTarget,r,s,this.dataLayerClientSettings);return null===(l=this.leakDetector)||void 0===l||l.track(`Request-${d.requestType}-${n}`,d),this.requestMap.set(e,d),o_.Q.Instance.processRequest(t,n,e),d}reconcileResponse(e,t){var n,i,a,o,r;const s=this.requestMap.get(e),l=t.data?t.data&&Object.keys(t.data).toString():"";if(this.recentlyCancelledRequests.has(e))return void this.logger.log(`Received response to a requestId that was recently cancelled. RequestId: ${e}. OperationNameHints: ${l}.`,this.loggingContext);if(!s)return void(null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,`Received response to a requestId that cannot be found in the map. operationName ${l}`,"cdl_request",{operationName:l,windowId:t.windowId,callId:t.requestId,contextId:t.rendererId,target:this.dataLayerCommunicatorTarget},!0));const d=t.extensions&&t.extensions.perfStats;let c,u;if(d||this.logger.warn(`Received response without perfStats for request. RequestId: ${e} RendererId: ${t.rendererId}, WindowId: ${t.windowId}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext),(null===(a=this.trackingOperationsDuringWaitConfig)||void 0===a?void 0:a.enableTrackingCdlOperationsDuringWait)&&d&&d.responseSendTime){this.markResponse(s);const e=d.responseSendTime,t=Date.now();if(u=t-e,u>((null===(o=this.trackingOperationsDuringWaitConfig)||void 0===o?void 0:o.trackingCdlOperationsDuringWaitThresholdInMs)||100)){c=this.getResponsesBetweenStartAndLast(e);const n=null==c?void 0:c.reduce(((e,t)=>{const n=e.find((e=>(null==e?void 0:e.name)===t));return n?n.count++:e.push({name:t,count:1}),e}),[]);(null===(r=this.trackingOperationsDuringWaitConfig)||void 0===r?void 0:r.enableLoggingCdlOperationsDuringWait)&&this.logger.log(`${null==s?void 0:s.operationName}, sendtime: ${e}, receivetime: ${t}, latency: ${t-e}, responses received between send and receive: ${JSON.stringify(n)}`,this.loggingContext)}}const m=d;s.setResponseAndEndScenario(t,c,u),s.isComplete()&&(this.requestMap.delete(e),o_.Q.Instance.processResponse(e,m&&m.workerResponseTime))}cancelRequest({requestId:e,rendererId:t,windowId:n}){const i=this.requestMap.get(e);i?(i.cancel(),this.requestMap.delete(e),this.recentlyCancelledRequests.set(e,(new Date).getTime()),this.scheduleCancelledRequestsMapCleanup()):this.logger.debug(`Nothing to cancel, request no longer in map. RequestId: ${e} RendererId: ${t}, WindowId: ${n}, Target ${this.dataLayerCommunicatorTarget}`,this.loggingContext)}scheduleCancelledRequestsMapCleanup(){var e;if(!this.recentlyCancelledRequestsTimer){const t=2,n=(new Date).getTime();this.recentlyCancelledRequestsTimer=null===(e=this.timeoutProvider)||void 0===e?void 0:e.setTimeout((()=>this.cleanRecentlyCancelledRequestsMap(n)),t*SA.A_)}}cleanRecentlyCancelledRequestsMap(e){this.recentlyCancelledRequests.forEach(((t,n)=>{t<e&&this.recentlyCancelledRequests.delete(n)})),this.recentlyCancelledRequestsTimer=void 0}markResponse(e){var t;null===(t=this.dataClientTrackingService)||void 0===t||t.markResponse(e.operationName)}getResponsesBetweenStartAndLast(e){var t;return(null===(t=this.dataClientTrackingService)||void 0===t?void 0:t.getResponsesBetweenStartAndLast(e))||[]}}var l_=n(109458),d_=n(696758),c_=n(792795);class u_{constructor(e,t,n,i,a,o,r,s,l=!1,d=Promise.resolve({isSyncEngineInitialized:!0}),c,u,m,g){this.hostRendererId=e,this.loggerFactory=t,this.scenarioFactory=n,this.dataLayerCommunicator=i,this.leakDetectorService=a,this.splitFetchWaitMarkerInWLT=m,this.loggingContext={component:"DataLayerClient",hostRendererId:e},this.logger=new FE.V(t.newLogger("CDL")),this.logger.log("logger created for renderer",this.loggingContext),this.dataLayerCommunicator.onMessage=this.onMessageReceived.bind(this),this.requestRegistrar=new s_(this.logger,e,this.scenarioFactory,this.loggerFactory,d,this.leakDetectorService,o,r,s,l,c,u,g),this.requestId=new c_.L("graphql")}execute(e,t,n,i,a,o){const r=(0,l_.S)(e,n),s=r&&r.operation||"query",l=this.requestId.next(s),d=this.requestRegistrar.createRequest(l,s,n||s,this.loggerFactory,i,a,o,this.splitFetchWaitMarkerInWLT);this.logger.log("executing graphql request to data layer",Object.assign(Object.assign({requestId:d.requestId},this.loggingContext),{operationType:s,operationName:n,hostRendererId:this.hostRendererId,requestRendererId:i,requestWindowId:a})),this.dataLayerCommunicator.sendMessage({requestId:l,windowId:a,rendererId:this.hostRendererId,request:{graphqlQuery:(0,d_.S)(e),variables:t},cdlOperationCustomContext:o,operationName:n});return function(e,t){const n=e.subscribe;return e.subscribe=i=>{const a=n.call(e,i),o=a.unsubscribe;return a.unsubscribe=()=>(t(),o.call(a)),a},e}(d.response,this.onUnsubscribe(d,n))}onUnsubscribe(e,t){return()=>{e.isComplete()||(this.logger.log("Notifying server of unsubscription",Object.assign(Object.assign({},this.loggingContext),{requestId:e.requestId,requestType:HE,operationName:t})),this.dataLayerCommunicator.sendMessage({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId,request:{graphqlQuery:HE,variables:void 0},operationName:t}),this.requestRegistrar.cancelRequest({requestId:e.requestId,rendererId:this.hostRendererId,windowId:e.windowId}))}}onMessageReceived(e){this.requestRegistrar.reconcileResponse(e.requestId,e)}}class m_{constructor(e,t,n,i,a,o,r,s,l,d,c,u,m,g,p,v,h,f,y,k){this.host=e,this.config=t,this.loggerFactory=i,this.scenarioFactory=a,this.coreSettings=o,this.dataClientTrackingService=y,this.isDisposed=!1,this.logger=i.newLogger("DataClientCoreCDLWorkerService"),this.cdlWorkerHostSettingsAggregator=new zA(n,o,r,i,d,m,g),this.cdlWorkerManagerInitializationPromise=OA(e,t,this.cdlWorkerHostSettingsAggregator,i,a,o,s,l,d,this.logger,p,v,h,f,g,k);if(xA(d,o,a,e,this.logger)){this.cdlWorkerStateSender=new VA(c,u,i,this);const{disableCDLWorkerHostSettingsUpdates:e}=o.get(K.J.Core);e||this.startNotifyingCDLWorkerForHostSettingsChanges()}}getCDLWorkerManager(){return this.cdlWorkerManagerInitializationPromise}getDataLayerClient(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.dataLayerClient){const e=yield this.getCDLWorkerManagerOrThrow("getDataLayerClient"),t=this.coreSettings.get(K.J.CdlWorker),{logCdlOperationsDuringWaitSettings:n}=this.coreSettings.get(K.J.Core);this.dataLayerClient=new u_(this.config.clientId,this.loggerFactory,this.scenarioFactory,e.workerClientResponseRouter.cdlGraphQLClient,void 0,"Worker",this.host,{enableRequestHealthMonitor:!!t.enableRequestHealthMonitor,failureCountThreshold:t.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:t.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:t.requestHealthMonitorTimeoutLengthSeconds,memoryMapType:(0,BA.qo)(this.coreSettings)},!!t.enableClassBasedErrors,e.syncEngineInitializationPromise,{enableLoggingCdlOperationsDuringWait:null==n?void 0:n.enableLoggingCdlOperationsDuringWait,enableTrackingCdlOperationsDuringWait:null==n?void 0:n.enableTrackingCdlOperationsDuringWait,trackingCdlOperationsDuringWaitThresholdInMs:null==n?void 0:n.trackingCdlOperationsDuringWaitThresholdInMs},this.dataClientTrackingService,!!t.splitFetchWaitMarkerInWLT,{cdlSubscriptionAggregatorAllowList:t.cdlSubscriptionAggregatorAllowList||void 0})}return this.dataLayerClient}))}getControlPlaneCommunicator(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.controlPlaneCommunicator){const e=yield this.getCDLWorkerManagerOrThrow("getControlPlaneCommunicator");this.controlPlaneCommunicator=new HA(e.workerClientResponseRouter,{loggerFactory:this.loggerFactory})}return this.controlPlaneCommunicator}))}dispose(){this.cdlWorkerStateSender&&this.cdlWorkerStateSender.dispose(),this.isDisposed=!0}logoutCurrentUser(e){var t,n,a,o,r,s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.get(K.J.CdlWorker).maxLogoutTime||5e3;if(this.isDisposed)return void(null===(n=(t=this.logger).warnToTelemetry)||void 0===n||n.call(t,"Unable to cleanup CDL Worker: Already disposed.","cdl_services_worker_worker_service_logout_current_user_error",void 0,!0));const l=yield this.getCDLWorkerManager();if(l)try{yield(0,Rn.E)(l.workerClientResponseRouter.cdlSyncEngineClient.sendRequest({type:"logout",subType:"",params:void 0}),i,`logout request to CDL worker timed out after ${i} ms`)}catch(e){null===(s=(r=this.logger).errorToTelemetry)||void 0===s||s.call(r,`Failed to cleanup CDL Worker on logout. ${e&&e.code===De.jK.TimedOut?e.message:""}`,"cdl_services_worker_worker_service_logout_current_user_error",void 0,!0)}else null===(o=(a=this.logger).warnToTelemetry)||void 0===o||o.call(a,"Unable to cleanup CDL Worker: Worker manager not available.","cdl_services_worker_worker_service_logout_current_user_error",void 0,!0)}))}getDebugService(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.debugService){const{DataClientCoreCDLWorkerDebugService:e}=yield n.e(83194).then(n.bind(n,148013));this.debugService=new e(this.loggerFactory,this)}return this.debugService}))}startNotifyingCDLWorkerForHostSettingsChanges(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let n;try{n=yield this.getCDLWorkerManager()}catch(n){return void(null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,`Unable to start notifying CDL Worker for host settings changes: getCDLWorkerManager failed: ${n.message}.`,"cdl_services_worker_worker_service_notify_worker_host_settings_changes_error",void 0,!0))}n?(this.cdlWorkerHostSettingsAggregator.startNotifyingCDLWorkerForHostSettingsChanges(n.workerClientResponseRouter.cdlControlClient),this.logger.log("Start notifying CDL Worker for host settings changes.")):this.logger.log("Unable to start notifying CDL Worker for host settings changes: Worker manager not available.")}))}getCDLWorkerManagerOrThrow(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getCDLWorkerManager();if(!t)throw(0,Mn.Tr)(m_.ComponentName,De.jK.NotInitialized,e,void 0,"Worker manager is not initialized");return t}))}}m_.ComponentName="DataClientCoreCDLWorkerService";var g_=n(447639),p_=n(208957),v_=n(542182);class h_{constructor(e,t,n,i){this.cdlWorkerManager=e,this.logger=t,this.authenticationService=n,this.cacheStorage=i,this.logsProviderName="CdlWorkerLogsProvider"}getLogsFiles(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let t;const n=this.getWorkerDiagnosticsLogsFromCdlWorkerManager(),i=this.getVerboseWorkerLogs(this.cdlWorkerManager.workerType),a=yield this.authenticationService.getUser();if(a&&a.isAuthenticated)t=this.getSyncEngineLogsFromCdlWorkerManager();else{const e="Sync logs cannot be retrieved for unauthenticated users.";t=Promise.resolve([{isPiiFree:!0,fileName:"sync-failure-logs.txt",content:e}]),this.logger.warn(e)}const o=yield n;return[{isPiiFree:!o.diagnosticsEvents||!!e,fileName:"cdl-worker-diagnostics-logs.txt",content:o.diagnosticsEvents?(0,v_.Mf)(e?o.diagnosticsEvents.filter((e=>e.isPiiFree)):o.diagnosticsEvents):"No logs found"},{isPiiFree:!0,fileName:"cdl-worker-settings.json",content:o.coreSettingsSnapshot},...yield t,...yield i]}))}getVerboseWorkerLogs(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(this.cacheStorage){const t=new p_.d(this.cacheStorage,this.logger),n=yield t.getWorkerVerboseLog(e);if(""!==n)return Promise.resolve([{isPiiFree:!1,fileName:"verbose-worker-logs.txt",content:n}])}return Promise.resolve([])}))}getWorkerDiagnosticsLogsFromCdlWorkerManager(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=this.cdlWorkerManager.workerClientResponseRouter.cdlDiagnosticsClient;try{const n=yield t.sendRequest("get_logs");if(null===(e=null==n?void 0:n.response)||void 0===e?void 0:e.data)return n.response.data;this.logger.warn("Diagnostic event list empty or ill-formed")}catch(e){this.logger.error(`Unable to retrieve worker diagnostics logs. ${(0,Mn.VK)(e)}`)}return{diagnosticsEvents:void 0,coreSettingsSnapshot:""}}))}getSyncEngineLogsFromCdlWorkerManager(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=[];for(const t of(0,a.values)(g_.C))t!==g_.C.NoLog&&t!==g_.C.Diagnostics&&e.push(this.getSyncEngineLogsForTypeFromCdlWorkerManager(t));return Promise.all(e)}))}getSyncEngineLogsForTypeFromCdlWorkerManager(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=this.cdlWorkerManager.workerClientResponseRouter.cdlSyncEngineClient;let n;try{const i=yield t.sendRequest({type:"get_logs",subType:e,params:{conversationId:void 0}});(null==i?void 0:i.response)?n=i.response:(this.logger.warn(`Sync engine logs empty. LogType: ${e}`),n="No logs available.")}catch(e){const t=`Unable to retrieve sync diagnostics logs. ${(0,Mn.VK)(e)}`;this.logger.error(t),n=t}return{isPiiFree:!1,fileName:`sync-${this.syncEngineLogTypeToFileName(e)}-logs.txt`,content:n}}))}syncEngineLogTypeToFileName(e){switch(e){case g_.C.Messaging:return"messaging";case g_.C.AllConversations:return"all_conversations";case g_.C.People:return"people";case g_.C.Presence:return"presence";case g_.C.Calendar:return"calendar";case g_.C.AppsPlatform:return"apps-platform";case g_.C.Activities:return"activities";case g_.C.ChannelInfoPane:return"channel-info-pane";case g_.C.MTMAAggregator:return"mtma-aggregator";case g_.C.UserPreferences:return"user-preferences";case g_.C.TeamsAndChannels:return"teams-and-channels"}}}function f_(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=new m_(e.windowProvider,e.config,e.configLoader,e.loggerFactory,e.scenarioFactory,e.coreSettings,e.coreSettingsContext,e.authenticationService,e.discover,e.platformService,e.clientState,e.hostState,e.primaryUser,null===(t=e.i18NextWrapper)||void 0===t?void 0:t.locale,e.offlineCacheManager,e.authStateProvider,e.cdlWorkerRegistrarService,e.workerId,e.dataClientTrackingService,null===(n=e.altScenarioService)||void 0===n?void 0:n.altScenario);return function(e,t){const n=null==e?void 0:e.altScenario;n&&n.appendEventData({dataStoreName:(0,BA.qo)(t)})}(e.altScenarioService,e.coreSettings),i.getCDLWorkerManager().then((t=>{if(t){const{authenticationService:n,authenticationUser:i,cacheStorage:a,cdlWorkerRegistrarService:o,loggerFactory:r,logsCollectorService:s,workerId:l}=e,d=new h_(t,r.newLogger("CdlWorkerLogsProvider"),n,a),c=i&&(0,li.b)(i);s.registerUserLogsProvider(c||"",d),o.registerWorker(l),function(e,t){var n,i;const{enableNetworkStateCommsBetweenCoreAndWorker:a}=e.coreSettings.get(K.J.Core);if(a){const a=n=>{const i={networkState:e.networkState.getState(),baselineNetworkStateOverride:n};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(i)},o=e.authenticationUser&&(0,li.b)(e.authenticationUser)||"",r=null===(i=(n=e.networkState).createNetworkStateTracker)||void 0===i?void 0:i.call(n,o,`CDL Worker EM [${o}]`,a);r&&t.state.setState("networkState:Loaded",r);return function(e,t){return()=>{e.unsubscribe(),t.dispose()}}(e.networkState.observe().subscribe((e=>{const n={networkState:e};t.workerClientResponseRouter.cdlNetworkStateClient.sendRequest(n)})),r)}}(e,t),function(e,t){const{enableEndpointsHealthCommsBetweenCoreAndWorker:n}=e.coreSettings.get(K.J.Core);if(n){const n=e.endpointsHealthService;if(null==n?void 0:n.getEndpointsHealthUpdateHandler){const e=n.getEndpointsHealthUpdateHandler();t.state.setState("endpointsHealthUpdateHandler:Loaded",e),e.onStateDumpRequest((()=>{const e="get_health_state";t.workerClientResponseRouter.cdlEndpointsHealthClient.sendRequest(e)}))}}}(e,t),function(e){(0,DC.G)().setCdlContextCallback(((t,n,i)=>{e.workerClientResponseRouter.telemetryClient.sendRequest({requestOperationtype:"setContext",context:{[t]:n},userContextId:i})}))}(t)}})),yield(0,zI._)(1),i}))}function y_(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield null===(t=null==e?void 0:e.getCachedUsers)||void 0===t?void 0:t.call(e,Object.assign(Object.assign({},JS({source:Ot.D.Core})),{scenarioName:ft.RG.AuthWebCachedUser}),{isPrimaryUser:!0}),i=null==n?void 0:n[0];if(i)return(0,li.K)(i)}))}class k_ extends Fe{constructor(){super(De.Yg.CreateCDLWorkerOnAuthUserTask,["altScenarioService","authenticationService","clientState","config","configLoader","coreSettings","coreSettingsContext","diagnosticsService","discover","endpointsHealthService","hostState","i18NextWrapper","loggerFactory","logsCollectorService","networkState","platformService","scenarioFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{altScenarioService:t,authenticationService:n,clientState:a,config:o,configLoader:r,coreSettings:s,coreSettingsContext:l,diagnosticsService:d,discover:c,endpointsHealthService:u,hostState:m,i18NextWrapper:g,loggerFactory:p,logsCollectorService:v,networkState:h,platformService:f,scenarioFactory:y,windowProvider:k}=e,{authenticationUser:S,authStateProvider:b,cacheStorage:C,cdlWorkerRegistrarService:w,dataClientTrackingService:N,offlineCacheManager:T}=e,I=p.newLogger("CreateCDLWorkerOnAuthUserTask"),E=(0,BA.Q6)(s),{enableMTMA:A,disableExperience:_}=s.get(K.J.Core);if(!E||!A)return I.warn(`Not creating worker as cdl worker or mtma is not enabled. isCdlWorkerEnabled: ${E}, isMTMAEnabled: ${A}`),Promise.resolve();if(!S||!w)return I.warn("Not creating worker as authenticated user is not available or cdl worker registrar service is undefined."),Promise.resolve();if(_)return I.warn("Not creating worker as experience is disabled for the user."),Promise.resolve();const D=null==S?void 0:S.id;if(w.isWorkerRegistered(D)||w.useInitTaskWorker)return I.log(`Not creating a worker as we already have created worker workerId: ${D} for the user oid: ${S.profile.objectId},\n         tid: ${S.profile.tenantId}`),void(w.useInitTaskWorker=!1);let F;return I.log(`Creating a worker with id: ${D} for the user oid: ${S.profile.objectId},\n       tid: ${S.profile.tenantId}`),A&&(F=yield y_(n)),e.cdlWorkerService=yield f_({altScenarioService:t,authenticationService:n,authenticationUser:S,authStateProvider:b,cacheStorage:C,cdlWorkerRegistrarService:w,clientState:a,config:o,configLoader:r,coreSettings:s,coreSettingsContext:l,dataClientTrackingService:N,diagnosticsService:d,discover:c,endpointsHealthService:u,hostState:m,i18NextWrapper:g,loggerFactory:p,logsCollectorService:v,networkState:h,offlineCacheManager:T,platformService:f,primaryUser:F,scenarioFactory:y,windowProvider:k,workerId:D}),e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;switch(e){case"signout":null===(t=w.activeWorkers)||void 0===t||t.delete(D);break;default:return}}))}))}}class S_ extends Fe{constructor(){super(De.Yg.CreateCDLWorkerOnInitTask,["altScenarioService","authenticationService","clientState","config","configLoader","coreSettings","coreSettingsContext","diagnosticsService","discover","endpointsHealthService","hostState","i18NextWrapper","loggerFactory","logsCollectorService","networkState","platformService","scenarioFactory","windowProvider","cdlWorkerRegistrarService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{altScenarioService:t,authenticationService:n,clientState:i,config:a,configLoader:o,coreSettings:r,coreSettingsContext:s,diagnosticsService:l,discover:d,endpointsHealthService:c,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:p,networkState:v,platformService:h,scenarioFactory:f,windowProvider:y,cdlWorkerRegistrarService:k}=e,{authenticationUser:S,authStateProvider:b,cacheStorage:C,dataClientTrackingService:w,offlineCacheManager:N}=e,T=g.newLogger("CreateCDLWorkerOnInitTask");if(!(0,BA.Q6)(r))return void T.warn("Not creating worker as CDL worker is not enabled");const I=S?S.id:(0,mt.v4)();let E;const{enableMTMA:A}=r.get(K.J.Core);if(A){if(!k)return void T.warn("Not creating worker as cdlWorkerRegistrarService is undefined");T.log(`Creating CDL worker with id ${I} for user oid:${null==S?void 0:S.profile.objectId}, tid: ${null==S?void 0:S.profile.tenantId}`),E=yield y_(n)}else T.log("MTMA is not enabled. Creating a CDL worker with default workerId");e.cdlWorkerService=yield f_({altScenarioService:t,authenticationService:n,authenticationUser:S,authStateProvider:b,cacheStorage:C,cdlWorkerRegistrarService:k,clientState:i,config:a,configLoader:o,coreSettings:r,coreSettingsContext:s,dataClientTrackingService:w,diagnosticsService:l,discover:d,endpointsHealthService:c,hostState:u,i18NextWrapper:m,loggerFactory:g,logsCollectorService:p,networkState:v,offlineCacheManager:N,platformService:h,primaryUser:E,scenarioFactory:f,windowProvider:y,workerId:I})}))}}var b_,C_=n(681911);class w_{constructor({loggerFactory:e}){this.initTaskWorkerId="",this.mainWindowWorkerId=void 0,this.useInitTaskWorker=!0,this.activeWorkers=new Set,this.userRegisteredActiveWorkers=new Map,this.formatUserId=e=>e.replace(C_.V.User,""),this.logger=e.newLogger("DataClientCoreCDLWorkerRegistrarService")}setMainWindowWorkerByUserId(e){var t,n;e=this.formatUserId(e),this.userRegisteredActiveWorkers.has(e)?this.mainWindowWorkerId=this.userRegisteredActiveWorkers.get(e):null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`No registered active worker for user id ${e}`,"cdl_registrar_service_no_registered_active_worker",void 0,!0)}isWorkerRegistered(e){return this.activeWorkers.has(e)}mapUserIdToRegisteredWorker(e,t){var n,i;t=this.formatUserId(t),this.isWorkerRegistered(e)||(null===(i=(n=this.logger).warnToTelemetry)||void 0===i||i.call(n,`${e} wasn't tracked yet was registered to active user. Tracking worker.`,"cdl_registrar_service_map_user_worker_not_registered",void 0,!0),this.registerWorker(e)),this.userRegisteredActiveWorkers.set(t,e)}registerWorker(e){var t,n;this.isWorkerRegistered(e)?null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`${e} is already being tracked by cdl worker registrar service; skipping.`,"cdl_registrar_service_worker_already_registered",void 0,!0):(this.activeWorkers.add(e),this.initTaskWorkerId||(this.initTaskWorkerId=e,this.mainWindowWorkerId=e))}}class N_ extends Fe{constructor(){super(De.Yg.CreateCDLWorkerRegistrarServiceTask,["loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t}=e;return e.cdlWorkerRegistrarService=new w_({loggerFactory:t}),Promise.resolve()}))}}!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(b_||(b_={}));class T_ extends Fe{constructor(){super(De.Yg.CreateChangeReporting,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.schedulerChangeReporting=new cN,e.experienceChangeReportingService=new cN,e.lifeCycleScopeChangeReportingService=new cN,e.commandResultChangeReportingService=new cN,e.commandChangeReportingService=new cN}))}}var I_=n(555248);class E_ extends Fe{constructor(){super(De.Yg.CreateClientPreferences,["localStorage","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{localStorage:t,loggerFactory:n}=e;e.clientPreferences=new I_.l(n,{set:(e,n)=>t.set(e,n,NT.f.Experience),get:e=>t.get(e,NT.f.Experience)})}))}}class A_ extends Fe{constructor(){super(De.Yg.CreateCommandDelegator,["appsRegistryService","client","commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","userBiService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,loggerFactory:o,scenarioFactory:r,userBiService:s,windowProvider:l}=e;e.commandDelegator=(e,d)=>Fb({appsRegistryService:t,client:n,commandChangeReportingService:i,commandHandler:d,commandInput:e,coreSettings:a,loggerFactory:o,scenarioFactory:r,host:l,userBiService:s})}))}}class __ extends Fe{constructor(){super(De.Yg.CreateCommandHandler,["appsRegistryService","client","commandChangeReportingService","coreSettings","loggerFactory","platformService","scenarioFactory","userBiService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,loggerFactory:o,platformService:r,scenarioFactory:s,userBiService:l}=e;e.commandHandler=(e,d)=>kC({appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,entityCommandInput:e,loggerFactory:o,platformService:r,scenarioFactory:s,clientLaunchId:d,userBiService:l})}))}}const D_=[GS.B.Abandoned,GS.B.Close,GS.B.IntentTransferredCrossCloud],F_=[GS.B.Incomplete,GS.B.WindowNotUpdated],M_=[GS.B.Blanked,GS.B.CommandHandledByOnCommandReceived,GS.B.CommandHandledPriorToResolution,GS.B.EventHandled,GS.B.Hidden,GS.B.LayoutRendered,GS.B.LayoutRenderUpdated,GS.B.NotHandled,GS.B.Toggled],R_=[GS.B.Failure,GS.B.SlotPhasedRenderingTimedOut];function P_(e){switch(e){case GS.B.ApplicationHookReceivedCommand:case GS.B.CommandBeforeGetAppViewEntities:case GS.B.RenderStarted:case GS.B.ChunkLoadStarted:case GS.B.ChunkLoadSucceeded:case GS.B.Rendered:return!0;default:return!1}}const O_={[ft.RG.ClientStart]:24e4},x_="command-result-service";class L_{constructor(e,t,n,i){this.commandChangeReportingService=t,this.commandResultChangeReportingService=n,this.host=i,this.logger=e.newLogger(x_),this.pendingCommands=new Map}init(){this.commandChangeSubscription=this.setUpCommandChangeSubscriptions()}destroy(){var e;this.pendingCommands.clear(),null===(e=this.commandChangeSubscription)||void 0===e||e.unsubscribe()}registerForCommandTimeOut(e,t){const n=this.pendingCommands.get(e);n&&(n.onCommandTimeOut=t)}unRegisterForCommandTimeOut(e){const t=this.pendingCommands.get(e);t&&(t.onCommandTimeOut=void 0)}onCommandChange(e){switch(e.type){case GS.B.ScenarioEventDataAppended:case GS.B.ScenarioMarked:case GS.B.Rendered:break;case GS.B.CommandMetaDataAdded:{const{context:{contentExistsAndHasChanged:t},correlationId:n}=e,i=this.pendingCommands.get(n);i&&void 0!==t&&(this.logger.log(`CommandMetaDataAdded: contentExistsAndHasChanged=${t}`),i.contentExistsAndHasChanged=t);break}case GS.B.DelegatedCommandReceived:case GS.B.EventBubbled:{const{context:{correlation:t},correlationId:n}=e;let i=this.pendingCommands.get(n);i||(i=this.createPendingCommand({correlation:t}),this.pendingCommands.set(n,i));break}case GS.B.CommandStart:{const{correlationId:t,context:{entityCommand:n},userContextId:i}=e;let a=this.pendingCommands.get(t);a?a.entityCommand=n:a=this.createPendingCommand({entityCommand:n,userContextId:i}),this.pendingCommands.set(t,a);break}case GS.B.NavigationCommandStart:{const{correlationId:t,context:{correlation:n},userContextId:i}=e;let a=this.pendingCommands.get(t);a||(a=this.createPendingCommand({correlation:n,userContextId:i})),this.pendingCommands.set(t,a);break}case GS.B.Incomplete:case GS.B.Failure:{const{correlationId:t,context:{errorInfo:n,errorMessage:i,showOops:a,eventData:o},userContextId:r}=e,s=this.pendingCommands.get(t);s&&this.calculateCommandResult(s,e.type,r,{errorInfo:n,errorMessage:i,showOops:a,eventData:o});break}default:{const{type:t,correlationId:n,context:{eventData:i}}=e,a=this.pendingCommands.get(n);if(a&&a.previousEvents.has(t))break;a&&this.calculateCommandResult(a,e.type,e.userContextId,{eventData:i});break}}}createPendingCommand({correlation:e,entityCommand:t,userContextId:n}){if(!(e=null!=e?e:null==t?void 0:t.command.correlation)){const e=new Error("correlation cannot be undefined. A valid entityCommand or correlation should be passed.");throw this.logger.errorToTelemetry&&this.logger.errorToTelemetry(e.message,"webclient_framework_foundation_command_reporting_service_event",void 0,!0),e}const i=e.id,a=this.host.setTimeout(this.getCommandTimeoutHandler(i,n),this.getCommandTimeout(e));return{contentExistsAndHasChanged:void 0,correlation:e,entityCommand:t,previousEvents:new Set,timeoutId:a}}getCommandTimeoutHandler(e,t){return()=>{var n;const i=this.pendingCommands.get(e);if(i){const{previousStep:a}=i,o=function(e){return e&&P_(e)?qS.y.TimeoutRunningApp:qS.y.TimeoutRunningCore}(a);null===(n=i.onCommandTimeOut)||void 0===n||n.call(i),this.logger.error(`Command error, correlationId: ${e}, reason ${o}, previousStep: ${a}`),this.onCommandResult(ma.Failure,e,o,a,t,{errorCode:o})}}}setUpCommandChangeSubscriptions(){return this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e)))}getCommandTimeout({id:e,scenarioName:t}){return t&&O_[t]?(this.logger.log(`Increasing the command timeout (${O_[t]}) during ${t}, correlationId: ${e}`),O_[t]):12e4}calculateCommandResult(e,t,n,i){var a;const{previousStep:o,correlation:{id:r}}=e;if(e.previousEvents.add(t),e.previousStep=t,function(e){return M_.includes(e)}(t))this.onCommandResult(ma.Success,r,t,o,n,{eventData:null==i?void 0:i.eventData});else if(function(e){return R_.includes(e)}(t)){const e=(s=t,l=null==i?void 0:i.errorInfo,s===GS.B.SlotPhasedRenderingTimedOut?qS.y.SlotPhasedRenderingTimedOut:l||qS.y.UnknownCommandError),d=(null==i?void 0:i.errorMessage)||(null===(a=null==i?void 0:i.eventData)||void 0===a?void 0:a.errors);this.logger.error(`Command error, correlationId: ${r}, reason ${e}, previousStep: ${o}`),this.onCommandResult(ma.Failure,r,e,o,n,{errorCode:e,errorMessage:d,eventData:null==i?void 0:i.eventData})}else if(function(e,t){return e===GS.B.RenderStarted&&!1===t}(t,e.contentExistsAndHasChanged)){const e=qS.y.AlreadyRendered;this.onCommandResult(ma.Incomplete,r,e,o,n,{errorCode:e,eventData:null==i?void 0:i.eventData})}else if(function(e){return D_.includes(e)}(t)){const e=function(e,t){return e===GS.B.Close?t&&P_(t)?qS.y.WindowCloseRunningApp:qS.y.WindowCloseRunningCore:e===GS.B.Abandoned?GS.B.Abandoned:qS.y.UnknownCommandError}(t,o);this.onCommandResult(ma.Canceled,r,e,o,n,{errorCode:e,eventData:null==i?void 0:i.eventData}),this.logger.error(`Command abandoned, correlationId: ${r}, reason ${e}, previousStep: ${o}`)}else if(function(e){return F_.includes(e)}(t)){const e=(null==i?void 0:i.errorInfo)||t;this.onCommandResult(ma.Incomplete,r,e,o,n,{errorCode:e,eventData:null==i?void 0:i.eventData}),this.logger.error(`Command incomplete, correlationId: ${r}, reason ${t}, previousStep: ${o}`)}var s,l}onCommandResult(e,t,n,i,a,o){const r=this.pendingCommands.get(t);r&&(this.reportCommandResult(t,a,e,n,i,r,o),this.cleanUpPendingCommand(t,r))}cleanUpPendingCommand(e,{timeoutId:t}){this.host.clearTimeout(t),this.pendingCommands.delete(e)}reportCommandResult(e,t,n,i,a,o,r){const{entityCommand:s}=o;this.commandResultChangeReportingService.report({correlationId:e,userContextId:t,context:{entityCommand:s,error:(null==r?void 0:r.errorCode)||(null==r?void 0:r.errorMessage)?{errorCode:null==r?void 0:r.errorCode,errorMessage:null==r?void 0:r.errorMessage}:void 0,previousStep:a,reason:i,target:x_,eventData:null==r?void 0:r.eventData},type:n})}}var U_;!function(e){e.ExpLoader="ExpLoader",e.Core="Core",e.App="App"}(U_||(U_={}));const B_={eventId:"executeEntityCommand"};function j_(e,t,n,i){const{replyContent:a}=e,{id:o,type:r}=t;if(i)switch(r){case u.p.chats:return function({actionType:e,convId:t,userContextId:n,toastType:i},a,o){let r=bo.unknown;switch(e){case"quickReply":r=bo.quickReply;break;default:const e=`HostComms:: ${ri.f.RequiredFieldMissing} Toast activation command received from host with unknown chats action Type`;o.errorToTelemetry&&o.errorToTelemetry(e,"webclient_framework_host_comms",void 0,!0)}return{actionType:r,convId:t||void 0,message:a,userContextId:n,toastType:i}}(i,a,n);case u.p.calls:return function({actionType:e,userContextId:t,toastType:n},i,a){return e||(a.errorToTelemetry&&a.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing} Toast activation command received from host with unknown calls action type`,"webclient_framework_host_comms",void 0,!0),e="Unknown"),{actionType:e,toastId:i||void 0,toastType:n,userContextId:t}}(i,o,n);case u.p.communities:return function({actionType:e,userContextId:t,toastType:n,teamId:i,messageId:a},o){return n||(o.errorToTelemetry&&o.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing} Toast activation command received from host with unknown communities toast type`,"webclient_framework_host_comms",void 0,!0),n="Unknown"),{actionType:e,toastType:n,userContextId:t,messageId:a,teamId:i}}(i,n);default:return void(n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing} Unkown target entity type received from host for toast activation command`,"webclient_framework_host_comms",void 0,!0))}else n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing} Toast activation command received from host without target host entity options`,"webclient_framework_host_comms",void 0,!0)}function W_(e,t){switch(e){case Hn.mutate:return u.u.mutate;case Hn.view:return u.u.view;case Hn.list:return u.u.list;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing} Toast activation command received from host with unknown entity action. Defaulting to view.`,"webclient_framework_host_comms",void 0,!0),u.u.view}}function V_(e,t){const{entity:n,entityOptions:i,command:a}=e,{visibilityState:o,correlation:r}=a,{id:s,startTimestamp:l,source:d}=r,c=null==i?void 0:i.toastActivationEntityOptions;if(!c)return B_;if(!n)return B_;const{optionsJson:u}=n,m=function(e,t){const{id:n,type:i,action:a,linkedEntity:o}=e;return{action:W_(a,t),id:n,linkedEntity:eD(o,t),type:$_(i,t)}}(n,t),g=u?(0,$t.D)(u,void 0):void 0;return Object.assign(Object.assign({},B_),{payload:{entity:m,command:{visibilityState:z_(o,t),correlation:{id:s,startTimestamp:l?l.getTime():void 0,source:d,scenarioName:ft.RG.ToastActivation},stateTransition:tD(n.type,t)},entityOptions:H_(g),dataOptions:n.action===Hn.mutate||n.type===Wn.communities||n.type===Wn.reminders?j_(c,m,t,g):{userContextId:g.userContextId}}})}function H_(e){if(null==e?void 0:e.deepLinkId)return{deepLinkId:e.deepLinkId};if(!(null==e?void 0:e.messageId))return;const{messageId:t,focusOnLoad:n}=e;return{messageId:t,focusOnLoad:n}}function $_(e,t){switch(e){case Wn.chats:case Wn.reminders:return u.p.chats;case Wn.calls:return u.p.calls;case Wn.extensions:return u.p.extensions;case Wn.activity:return u.p.activity;case Wn.campaignnotifications:return u.p.campaignnotifications;case Wn.channels:return u.p.channels;case Wn.communities:return u.p.communities;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing} Toast activation command received from host with unknown entity type. Defaulting to chats`,"webclient_framework_host_comms",void 0,!0),u.p.chats}}function z_(e,t){switch(e){case Vn.show:return c.fe.show;case Vn.hide:return c.fe.hide;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing} Toast activation command received from host with unknown visibility state. Defaulting to show`,"webclient_framework_host_comms",void 0,!0),c.fe.show}}function G_(e,t){var n;const{command:i}=e,{correlation:a,visibilityState:o}=i;let r;return(null==a?void 0:a.startTimestamp)&&(r=new Date(+a.startTimestamp),r=aD(r)?r:void 0),{correlation:{id:null!==(n=null==a?void 0:a.id)&&void 0!==n?n:(0,mt.v4)(),startTimestamp:r,source:jn.toastFromWeb},visibilityState:X_(o,t)}}function q_(e,t){try{const{entity:n}=e,{action:i,id:a,type:o}=n;return{action:Q_(i,t),id:a,type:K_(o)}}catch(e){throw t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${(0,Ci.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),e}}function Q_(e,t){switch(e){case u.u.mutate:return Hn.mutate;case u.u.view:return Hn.view;case u.u.list:return Hn.list;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing}: EntityAction. Defaulting to HostEntityAction.view`,"webclient_framework_host_comms",void 0,!0),Hn.view}}function J_(e){const{id:t,linkedEntity:n,action:i,type:a,dataOptions:o}=e;return{action:i,id:t,linkedEntity:n,type:a,optionsJson:(0,Ci.u4)(o)}}function Y_(e){!function(e){if(!e)throw(0,Mn.Tr)(De.w5.Commanding,ri.f.RequiredFieldMissing,u.p.toasts,void 0,`${ri.f.RequiredFieldMissing}: entityOptions`);const t=e;if(!(t.targetEntity&&t.targetEntity.action&&t.targetEntity.type&&t.targetEntity.dataOptions&&t.time&&t.title))throw(0,Mn.Tr)(De.w5.Commanding,ri.f.RequiredFieldMissing,u.p.toasts,void 0,`${ri.f.RequiredFieldMissing}: hostEntityOptions?.toastEntityOptions`)}(e);const{buttons:t,targetEntity:n,textInput:i,time:a}=e;return{toastEntityOptions:Object.assign(Object.assign({},e),{targetEntity:J_(n),time:a,buttons:iD(t),textInput:Z_(i)})}}function K_(e){switch(e){case u.p.toasts:return Wn.toasts;default:throw(0,Mn.Tr)(De.w5.Commanding,ri.f.RequiredFieldMissing,u.p.toasts,void 0,`${ri.f.RequiredFieldMissing}: EntityType`)}}function Z_(e){if(!e)return;const{placeholderText:t,sendButton:n}=e;return{placeholderText:t,sendButton:n?nD(n):void 0}}function X_(e,t){switch(e){case c.fe.hide:return Vn.hide;case c.fe.show:return Vn.show;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing}: EntityVisibilityState. Defaulting to HostEntityVisibilityState.show`,"webclient_framework_host_comms",void 0,!0),Vn.show}}function eD(e,t){if(!e)return;const{id:n,type:i,action:a}=e;return{action:a?W_(a,t):void 0,id:n,type:$_(i,t)}}function tD(e,t){switch(e){case Wn.chats:case Wn.channels:return c.su.new;case Wn.calls:case Wn.campaignnotifications:return c.su.new;case Wn.extensions:case Wn.reminders:case Wn.activity:case Wn.communities:return c.su.flush;default:return t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: ${ri.f.RequiredFieldMissing} Toast activation command received from host with unhandled host entity type - ${e}.`,"webclient_framework_host_comms",void 0,!0),c.su.new}}function nD(e){const{image:t,targetEntity:n,text:i,preferImageOnly:a,style:o}=e;return{image:t,preferImageOnly:a,style:o,targetEntity:J_(n),text:i}}function iD(e){if(e)return e.map(nD)}const aD=e=>e instanceof Date&&!isNaN(e.getTime());function oD(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e.entity.type!==u.p.toasts)return;let r,s;(null===(o=e.command.correlation)||void 0===o?void 0:o.id)&&(r=a.findScenarioByNameAndId(ft.RG.CrossClientToastView,e.command.correlation.id),s=a.findScenarioByNameAndId(ft.RG.WebToastShow,e.command.correlation.id));const l=yield function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let n;try{n=yield e.loadModule("core"),t.log(`HostComms:: ${gI.LoadModuleCoreSuccess}`)}catch(e){const n=`HostComms:: ${mI.LoadModuleCoreFailed} ${(0,Ci.u4)(e)}`;t.errorToTelemetry&&t.errorToTelemetry(n,"webclient_framework_host_comms",void 0,!0)}return n}))}(t,n);if(!l||!l.executeCommand)return n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${mI.LoadModuleCoreFailed}`,"webclient_framework_host_comms",void 0,!0),null==r||r.fail({errorCode:mI.LoadModuleCoreFailed}),void(null==s||s.fail({errorCode:mI.LoadModuleCoreFailed}));try{const t=function(e,t){return{command:G_(e,t),entity:q_(e,t),entityOptions:Y_(null==e?void 0:e.entityOptions)}}(e,n);yield null==l?void 0:l.executeCommand(t),n.log(`HostComms:: ${gI.ExecuteCommandSuccess}`),null==r||r.mark(ft.ck.CrossClientHostEventSent),null==s||s.stop()}catch(e){n.errorToTelemetry&&n.errorToTelemetry(`HostComms:: ${mI.ExecuteCommandFailed} ${(0,Ci.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),null==r||r.fail({errorCode:mI.ExecuteCommandFailed}),null==s||s.fail({errorCode:mI.ExecuteCommandFailed})}}))}class rD{constructor(e,t,n,i){this.commandChangeReportingService=e,this.commandResultChangeReportingService=t,this.scenarioFactory=n,this.pendingCommands=new Map,this.logger=i.newLogger("CommandTelemetryService"),this.commandSequence=0}init(){this.commandChangeSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e))),this.commandResultChangeSubscription=this.commandResultChangeReportingService.observeChanges().subscribe((e=>this.onCommandResultChange(e)))}destroy(){var e,t,n;this.pendingCommands.clear(),null===(e=this.commandChangeSubscription)||void 0===e||e.unsubscribe(),null===(t=this.commandResultChangeSubscription)||void 0===t||t.unsubscribe(),null===(n=this.lifeCycleScopeChangeSubscription)||void 0===n||n.unsubscribe()}onCommandChange(e){switch(e.type){case GS.B.ScenarioEventDataAppended:{const{correlationId:t,context:{eventData:n}}=e;this.appendScenarioEventData(t,n);break}case GS.B.ScenarioMarked:{const{correlationId:t,context:{step:n,eventData:i,status:a,monitoringData:o}}=e;this.addScenarioMark(t,n,e.type,i,a,o);break}case GS.B.Rendered:case GS.B.CommandMetaDataAdded:break;case GS.B.DelegatedCommandReceived:case GS.B.EventBubbled:{const{context:{correlation:t}}=e;this.startCommandTelemetry(t.id,{correlation:t});break}case GS.B.CommandStart:{const{correlationId:t,context:{entityCommand:n}}=e,{scenarioEventData:i}=n;this.startCommandTelemetry(t,{entityCommand:n}),i&&this.appendScenarioEventData(t,i);break}case GS.B.NavigationCommandStart:{const{correlationId:t,context:{clientLaunchId:n,correlation:i,eventData:a}}=e;this.startCommandTelemetry(t,{correlation:i,clientLaunchId:n}),a&&this.appendScenarioEventData(t,a);break}default:{const{type:t,correlationId:n,context:{eventData:i}}=e,a=this.pendingCommands.get(n);if(a&&a.previousEvents.has(t))break;null==a||a.previousEvents.add(t),P_(t)&&(null==a||a.commandScenario.appendEventData({scenarioPhase:U_.App})),i&&this.appendScenarioEventData(n,i),this.addScenarioMark(n,t,t,i);break}}}findExistingNavigationCommandScenario(e,t){const n=t.scenarioName||ft.RG.NavigationCommand;let i=this.scenarioFactory.findScenarioByNameAndId(n,e);return i||t.scenarioName!==ft.RG.ClientStart||(i=this.scenarioFactory.findScenario(ft.RG.ClientStart)),i||void 0}findExistingActivitySwitchScenario(e){const t=e.command.correlation.id;if(e.command.correlation.source===Ot.D.ActivityFeedBellClick){const e=Array.from(this.pendingCommands.values());for(const n of e)if(n.correlation.scenarioName===ft.RG.ActivitySwitch||n.correlation.scenarioName===ft.RG.NavigationCommand){const e=n.correlation.id;this.logger.log(`Command was sent by activity app as a result of a bell click, correlationId ${t}. Combining scenario with existing activity_switch of correlationId ${e}`);const i=n.commandScenario;return this.pendingCommands.delete(e),i}}}startCommandTelemetry(e,{entityCommand:t,correlation:n,clientLaunchId:i}){let a,o=this.pendingCommands.get(e);i&&n&&(a=this.findExistingNavigationCommandScenario(i,n)),t&&!a&&(a=this.findExistingActivitySwitchScenario(t)),o?t&&(this.logger.log(`Updating command\n\tscenarioName: ${o.commandScenario.name}\n\tcorrelationId: ${e}\n\tentityType: ${t.entity.type}\n\tentityAction: ${t.entity.action}`),o.commandScenario.appendEventData({mainEntityAction:t.entity.action,mainEntityType:t.entity.type})):o=this.createPendingCommand(e,{commandScenario:a,entityCommand:t,correlation:n,clientLaunchId:i}),this.pendingCommands.set(e,o)}createPendingCommand(e,{entityCommand:t,correlation:n,clientLaunchId:i,commandScenario:a}){var o;if(!(n=null!=n?n:null==t?void 0:t.command.correlation)){const e=new Error("correlation cannot be undefined. A valid entityCommand or correlation should be passed.");throw this.logger.errorToTelemetry&&this.logger.errorToTelemetry(e.message,"webclient_framework_foundation_command_reporting_service_event",void 0,!0),e}if(n.scenarioName=null!==(o=n.scenarioName)&&void 0!==o?o:ft.RG.EntityCommand,!a){this.logger.log(`Creating new scenario with scenarioName: ${n.scenarioName}, correlationId ${e}`);const{startTimestamp:o}=n,r=o&&aD(new Date(+o))?+o:void 0;a=this.scenarioFactory.newScenario(n.scenarioName,{startTime:r}),void 0!==i&&(a.clientId=i),a.appendEventData({"EventInfo.CorrelationId":e,commandSequence:++this.commandSequence,commandSource:n.source,mainEntityAction:null==t?void 0:t.entity.action,mainEntityType:null==t?void 0:t.entity.type,scenarioPhase:U_.Core})}return this.logger.log(`Starting to track a new command\n\tscenarioName: ${n.scenarioName}\n\tcorrelationId: ${e}\n\tentityType: ${null==t?void 0:t.entity.type}\n\tentityAction: ${null==t?void 0:t.entity.action}`),{correlation:n,commandScenario:a,previousEvents:new Set}}appendScenarioEventData(e,t){const n=this.pendingCommands.get(e);n&&n.commandScenario.appendEventData((0,a.omitBy)(t,a.isUndefined))}addScenarioMark(e,t,n,i,o,r){const s=this.pendingCommands.get(e);s&&(n!==GS.B.ScenarioMarked&&this.logger.log(`${s.commandScenario.name} addScenarioMark, correlationId: ${e}, step: ${t}, eventData: ${JSON.stringify(i)}`),s.commandScenario.mark(t,i&&(0,a.omitBy)(i,a.isUndefined),o,r))}onCommandResultChange(e){const{context:{error:t,reason:n,previousStep:i,eventData:o,entityCommand:r},correlationId:s,type:l}=e,d=this.pendingCommands.get(s);if(!d)return void this.logger.error(`Command Result of ${n} and correlationId ${s} was reported but no pending command was found`);const c=null==d?void 0:d.commandScenario,u=(0,a.omitBy)(r&&rD.overrideMainEntityForExtensionCommand(o,r)||o,a.isUndefined);switch(l){case ma.Canceled:{const{errorCode:e}=t||{};this.logger.warn(`${c.name} Cancelled, correlationId: ${s}, reason: ${e}, previousStep: ${i}`),c.cancel(Object.assign({errorCode:e,reason:e},u));break}case ma.Failure:{const{errorCode:e,errorMessage:n}=t||{};this.logger.error(`${c.name} Failed, correlationId: ${s}, reason: ${e}, errorMessage: ${n}, previousStep: ${i}`),c.fail(Object.assign({errorCode:e,reason:e,errors:n&&(0,ta.A)(n)},u));break}case ma.Incomplete:{const{errorCode:e}=t||{};this.logger.warn(`${c.name} Incomplete, correlationId: ${s}, reason: ${e}, previousStep: ${i}`),c.incomplete(Object.assign({errorCode:e,reason:e},u));break}case ma.Success:this.logger.log(`${c.name} Successful, correlationId: ${s}, reason: ${n}, previousStep: ${i}`),c.stop(Object.assign({reason:n},u))}this.pendingCommands.delete(s)}static overrideMainEntityForExtensionCommand(e,t){return t.command.stateTransition!==c.su.extend?e:Object.assign(Object.assign({},e),{modalEntityType:t.entity.type,modalEntityAction:t.entity.action})}}const sD=[GS.B.ApplicationHookReceivedCommand,GS.B.ApplicationHookContinuedCommand],lD=[GS.B.ChunkLoadStarted,GS.B.ChunkLoadSucceeded,GS.B.ScenarioEventDataAppended,GS.B.ScenarioMarked];class dD{constructor(e,t){this._host=t,this.commandTimedOutAtHostHandler=e=>{const{correlationId:t}=e.payload,n=this._pendingCommands.get(t);n&&(n.onCommandTimeOut&&n.onCommandTimeOut(),this.cleanUpPendingCommand(t))},this._logger=e.newLogger("CommandReportingServiceHybrid"),this._pendingCommands=new Map,this._host.opener.addEventListener(vb.rY.EntityCommandTimedOutAtHost,this.commandTimedOutAtHostHandler)}registerNavigationCommandStart(){}registerCommandStart(e){var t;const n=e.command.correlation.id;if(!n)return void this._logger.error("registerCommandStart called without a command correlation id");const i=this._pendingCommands.get(n);i&&(this._logger.log(`registerCommandStart called with a pending command with correlation id ${n}, overwriting and starting new timeout interval`),this._host.clearTimeout(i.timeoutId));const a=null===(t=null==i?void 0:i.entityCommand.entityOptions)||void 0===t?void 0:t.timeout,o=a||9e4,r=this._host.setTimeout((()=>{this.reportCommandEvent(n,GS.B.CommandReportingTimedOut),this.cleanUpPendingCommand(n)}),o);this._logger.log(`Starting to track command with correlation Id ${n}`),this._pendingCommands.set(n,{entityCommand:e,timeoutId:r,previousEvents:new Set})}appendCommandEventData(e,t){const n=this._pendingCommands.get(e);n?this._pendingCommands.set(e,Object.assign(Object.assign({},n),{eventData:Object.assign(Object.assign({},n.eventData),t)})):this._logger.warn(`appendCommandEventData called with correlationId ${e}, but there was no such pending command`)}reportCommandEvent(e,t,n,i,a,o){const r=this._pendingCommands.get(e);if(!r)return;if(!lD.includes(t)&&r.previousEvents.has(t))return;r.previousEvents.add(t);const{entityCommand:s,eventData:l}=r,d=Object.assign(Object.assign(Object.assign({entityCommand:s,commandEvent:t},l),n),{timestamp:Date.now(),scenarioEventData:i,step:a,status:o});t===GS.B.CommandReportingTimedOut||sD.includes(t)||this._logger.log(`Command event reported ${t} for correlation id ${e}`),sD.includes(t)||this._host.opener.postMessage(cS.W.CommandChangeType,d)}registerForCommandTimeOut(e,t){const n=this._pendingCommands.get(e);n&&(n.onCommandTimeOut=t)}unRegisterForCommandTimeOut(e){const t=this._pendingCommands.get(e);t&&(t.onCommandTimeOut=void 0)}appendScenarioEventData(e,t){this.reportCommandEvent(e,GS.B.ScenarioEventDataAppended,void 0,t)}addScenarioMark(e,t,n,i){this.reportCommandEvent(e,GS.B.ScenarioMarked,void 0,n,t,i)}cleanUpPendingCommand(e){const t=this._pendingCommands.get(e);t&&(this._host.clearTimeout(t.timeoutId),this._pendingCommands.delete(e))}}class cD{constructor(e,t){this.legacyCommandReportingService=e,this.commandChangeReportingService=t,this.commandChangeSubscription=this.setUpCommandChangeSubscriptions()}destroy(){this.commandChangeSubscription.unsubscribe()}changeToCommandReportingService(e){switch(e.type){case GS.B.AfterOnCommandReceived:case GS.B.AfterOnEventReceived:case GS.B.BeforeOnCommandReceived:case GS.B.BeforeOnEventReceived:case GS.B.CommandHandledByOnCommandReceived:case GS.B.EventBubbled:case GS.B.EventHandled:case GS.B.DelegatedCommandReceived:break;case GS.B.ScenarioEventDataAppended:{const{context:{eventData:t},correlationId:n}=e;this.legacyCommandReportingService.appendScenarioEventData(n,t);break}case GS.B.ScenarioMarked:{const{context:{step:t,eventData:n,status:i,monitoringData:a},correlationId:o}=e;this.legacyCommandReportingService.addScenarioMark(o,t,n,i,a);break}case GS.B.CommandStart:{const{context:{entityCommand:t,executionContextEntity:n},correlationId:i}=e,{scenarioEventData:a}=t;this.legacyCommandReportingService.registerCommandStart(t),a&&this.legacyCommandReportingService.appendScenarioEventData(i,a),this.legacyCommandReportingService.reportCommandEvent(i,GS.B.CommandReceived,{executionContextEntity:n});break}case GS.B.NavigationCommandStart:{const{context:{clientLaunchId:t,correlation:n,eventData:i},correlationId:a}=e;this.legacyCommandReportingService.registerNavigationCommandStart(t,n),this.legacyCommandReportingService.addScenarioMark(a,GS.B.DeeplinkReceived),i&&this.legacyCommandReportingService.appendScenarioEventData(a,i);break}case GS.B.CommandMetaDataAdded:{const t=e.context,{target:n}=t,a=(0,i.__rest)(t,["target"]),{correlationId:o}=e;this.legacyCommandReportingService.appendCommandEventData(o,a);break}case GS.B.NotHandled:{const{correlationId:t,type:n}=e;this.legacyCommandReportingService.reportCommandEvent(t,n);break}default:{const t=e.context,{target:n,eventData:a}=t,o=(0,i.__rest)(t,["target","eventData"]),{correlationId:r,type:s}=e;this.legacyCommandReportingService.reportCommandEvent(r,s,o,a);break}}}setUpCommandChangeSubscriptions(){return this.commandChangeReportingService.observeChanges().subscribe((e=>this.changeToCommandReportingService(e)))}}class uD{constructor(e,t,n){this.commandChangeReportingService=e,this.lifeCycleScopeChangeReportingService=t,this.logger=n.newLogger("CommandAppLifeCycleListenerService"),this.lifeCycleScopeChangeSubscription=this.subscribeToLifeCycleScopeChange()}destroy(){var e;null===(e=this.lifeCycleScopeChangeSubscription)||void 0===e||e.unsubscribe()}subscribeToLifeCycleScopeChange(){return this.lifeCycleScopeChangeReportingService.observeChanges().pipe((0,aS.U)((({correlationId:e,context:{apps:t}})=>{let n=!1;return t.forEach((({id:t,type:i})=>{i===bb.c4.Initialized&&(n=!0,this.logger.log(`${t} initialized, correlationId: ${e}`))})),{appInitialized:n,correlationId:e}})),(0,rS.h)((({appInitialized:e})=>e))).subscribe((({correlationId:e,appInitialized:t})=>{this.commandChangeReportingService.report({correlationId:e,type:GS.B.ScenarioEventDataAppended,context:{target:"commandAppLifeCycle",eventData:{appInitialized:t}}})}))}}class mD{constructor(e){this._cap=e,this._map=new Map}entries(){return this._map.entries()}get(e){return this._map.get(e)}set(e,t){if(this._map.size>=this._cap){const e=this._map.keys().next().value;this._map.delete(e)}return this._map.set(e,t)}}class gD{constructor(e){this.commandChangeReportingService=e}init(){this.commandsHistory&&this.destroy(),this.commandsHistory=new mD(30),this.initCommandChangeReportingSubscription()}destroy(){var e;null===(e=this.commandChangeReportingSubscription)||void 0===e||e.unsubscribe(),this.commandChangeReportingSubscription=void 0,this.commandsHistory=void 0}get CommandsHistory(){return this.commandsHistory}initCommandChangeReportingSubscription(){this.commandChangeReportingSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>this.onCommandChange(e)))}onCommandChange(e){const{correlationId:t}=e;if(this.commandsHistory)if(e.type===GS.B.CommandStart){const{context:{entityCommand:n}}=e;let i=this.commandsHistory.get(t);const a={entityCommand:n,isCommandTargetedToMainWindow:!1,steps:[]};i=i?Object.assign(Object.assign({},i),{entityCommand:n}):a,this.commandsHistory.set(t,i)}else if(e.type===GS.B.CommandMetaDataAdded){const{correlationId:t,context:{isCommandTargetedToMainWindow:n}}=e,i=this.commandsHistory.get(t);i&&n&&this.commandsHistory.set(t,Object.assign(Object.assign({},i),{isCommandTargetedToMainWindow:n}))}else{const n=this.commandsHistory.get(t);null==n||n.steps.push({event:e.type,timestamp:Date.now()-(parseInt(n.entityCommand.command.correlation.startTimestamp,10)||0)})}}}function pD(e,t,...n){var i;const{coreSettings:a}=t,o=null!==(i=null==a?void 0:a.get(K.J.Core).enableCoreErrorsV2)&&void 0!==i&&i,r=[];for(const i of n)if(!t[i]&&(r.push(i),!o)){const t=`${e}: ${i} is missing`;throw(0,Mn.Tr)(De.w5.Core,De.jK.CoreServiceMissing,e,void 0,t)}if(o&&r.length>0)throw _e.fromMissingDependencies(e,r);return t}class vD extends Fe{constructor(){super(De.Yg.CreateCommandReportingService,[])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n="CreateCommandReportingServiceTask",{commandChangeReportingService:i,coreSettings:a,lifeCycleScopeChangeReportingService:o,loggerFactory:r,scenarioFactory:s,windowProvider:l}=pD(n,e,"coreSettings","commandChangeReportingService","lifeCycleScopeChangeReportingService","loggerFactory","scenarioFactory","windowProvider");if(null===(t=a.get(K.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService){const{commandResultChangeReportingService:t}=pD(n,e,"commandResultChangeReportingService"),o=new L_(r,i,t,l);o.init(),e.commandResultService=o,new rD(i,t,s,r).init(),this.initCommandHistoryService(e,i,a)}else e.commandReportingService=new dD(r,l),new cD(e.commandReportingService,i);new uD(i,o,r),this.initCommandHistoryService(e,i,a)}))}initCommandHistoryService(e,t,n){e.commandHistoryService=new gD(t),(null==n?void 0:n.get(K.J.Diagnostics).isDiagnosticsPanelEnabled)&&e.commandHistoryService.init()}}class hD extends Fe{constructor(){super(De.Yg.CreateCommandResultHooksService,[])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:n,coreSettings:i,client:a,commandResultChangeReportingService:o,entityCommanding:r,loggerFactory:s,scenarioFactory:l}=pD("CreateCommandReportingServiceTask",e,"appsRegistryService","client","commandResultChangeReportingService","coreSettings","entityCommanding","loggerFactory","scenarioFactory");return(null===(t=i.get(K.J.Core))||void 0===t?void 0:t.enableStandaloneCommandReportingService)&&(e.commandResultHooksService=new Ow(n,a,o,i,r,s,l,e.authenticationUser&&(0,li.b)(e.authenticationUser)),e.commandResultHooksService.init()),Promise.resolve()}))}}var fD=n(794493);const yD=(e,t,n,i)=>{const a=`${e}::TypeError::`;try{return new URL(t,n||void 0)}catch(e){let o=`${a}base::${n}`;throw i&&(o=o.concat(`::url::${t}`)),new fD.Y("URL_PARSE_FAILED",new Error(o))}},kD=(e,t,n)=>{let i=!1,a=!1,o=!1,r=!1,s=!1,l=`${e}::`;const d="ProtocolValidationFailed::",c="OriginValidationFailed::";if(t.protocol&&n.protocol?a=!0:l=l.concat(`${d}EmptyProtocol::'${t.protocol}'::'${n.protocol}'`),t.protocol!==n.protocol?l=l.concat(`${d}'${t.protocol}' !== '${n.protocol}'`):o=!0,t.origin&&n.origin?r=!0:l=l.concat(`${c}EmptyOrigin::'${t.origin}'::'${n.origin}'`),t.origin!==n.origin?l=l.concat(`${c}'${t.origin}' !== '${n.origin}'`):s=!0,i=a&&o&&r&&s,!i)throw new fD.Y("URL_VALIDATION_FAILED",new Error(l))},SD=[{id:"@msteams/components-calling-ppt-sharing#components-calling-ppt-sharing",getConfig:e=>({createScriptURL:(t,n)=>{var i;const a="pptLivePolicy",o=null!==(i=e.get(K.J.Security).pptLiveAllowedOrigin)&&void 0!==i?i:[];if(!Array.isArray(o)||0===o.length)throw new fD.Y("URL_VALIDATION_FAILED",new Error("pptLivePolicy::TypeError::allowedOriginList pptLiveAllowedOrigin is undefined or empty"));let r;const s=yD(a,t,n,!0);for(const e of o)try{const t=yD(a,e,void 0,!0);return kD(a,s,t),s.href}catch(e){r=e}throw r}})}],bD=[{id:"@msteams/no-op",getConfig:()=>({createHTML:e=>e,createScriptURL:e=>e})},{id:"@msteams/services-utilities-common#ChunkLoader",getConfig:e=>({createScriptURL:(t,n)=>{var i;const a="chunkLoaderPolicy";let o,r,s,l=!1,d=!1;const c=yD(a,t,n,!0),u=null!==(i=e.get(K.J.Platform).staticsPath)&&void 0!==i?i:"";if(!u)throw new fD.Y("URL_PARSE_FAILED",new Error(`${a}::TypeError::allowListUrl staticsPath is undefined`));try{s=yD(a,u,void 0,!0),kD(a,c,s),l=!0}catch(e){o=e}if(l)return c.href;try{s=yD(a,wD,void 0,!0),kD(a,c,s),d=!0}catch(e){r=e}if(d)return c.href;if(o)throw o;throw r}})},{id:"@msteams/services-io-browser-web-client-update#register-service-worker",getConfig:()=>({createScriptURL:(e,t)=>{const n="registerServiceWorkerPolicy";let i,a,o=!1;const r=yD(n,e,t,!0);try{a=yD(n,wD,void 0,!0),kD(n,r,a),o=!0}catch(e){i=e}if(o)return r.pathname;throw i}})},{id:"@msteams/core-services-telemetry-worker#TelemetryWorker",getConfig:e=>({createScriptURL:(e,t)=>{const n="telemetryWorkerPolicy";let i,a,o=!1;const r=yD(n,e,t,!0);try{a=yD(n,wD,void 0,!0),kD(n,r,a),o=!0}catch(e){i=e}if(o)return r.pathname;throw i}})}];function CD(){return window}const wD=CD().location.origin;class ND{constructor(e,t){this.coreSettings=e,this.logger=t.newLogger("CoreSecurityService"),this.configMap=new Map,this.policyMap=new Map,this.initializeTrustedTypeConfigMap(),this.setIsTrustedTypePoliciesEnabled()}getTrustedTypePolicy(e){var t,n,i;let a;if(this.isTrustedTypePoliciesEnabled||(e="@msteams/no-op"),a=this.policyMap.get(e),a)return a;if(a=this.createTrustedTypePolicyOnDemand(e),a)return this.policyMap.set(e,a),a;const o=new fD.Y("POLICY_NOT_FOUND",new Error(`${e}`));throw null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}::${null===(i=o.prevError)||void 0===i?void 0:i.message}`,"webclient_framework_foundation_core_services_security",void 0,!0),o}createTrustedTypePolicyOnDemand(e){var t,n,i;const a=this.configMap.get(e);if(!a)return;const o=CD().trustedTypes;if(!this.isTrustedTypePoliciesEnabled||!o)return this.getOptionsAsTrustedTypePolicy(a);try{return o.createPolicy(a.id,a.getConfig(this.coreSettings))}catch(a){const o=new fD.Y("CREATE_POLICY_FAILED",new Error(`${e}${null==a?void 0:a.message}`));throw null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}::${null===(i=o.prevError)||void 0===i?void 0:i.message}`,"webclient_framework_foundation_core_services_security",void 0,!0),o}}getOptionsAsTrustedTypePolicy(e){return e.getConfig(this.coreSettings)}initializeConfigs(){SD.forEach((e=>{this.setConfig(e)}))}initializeCoreConfigs(){bD.forEach((e=>{this.setConfig(e)}))}initializeTrustedTypeConfigMap(){this.initializeCoreConfigs(),this.initializeConfigs()}setConfig(e){if(this.configMap.has(e.id))throw new fD.Y("DUPLICATE_POLICY_FOUND",new Error(`CoreSecurityService::${e.id}`));this.configMap.set(e.id,e)}setIsTrustedTypePoliciesEnabled(){const{enableTrustedTypePolicies:e}=this.coreSettings.get(K.J.Core);this.isTrustedTypePoliciesEnabled=!!e}}class TD extends Fe{constructor(){super(De.Yg.CreateCoreSecurityTask,["coreSettings","loggerFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,windowProvider:i}=e,a=n.newLogger("CoreSecurityService"),o=new ND(t,n);e.coreSecurityService=o,i.chunkLoader.configureCoreSecurityService(o),a.log("CoreSecurityService Initialized")}))}}var ID=n(404073);class ED extends Fe{constructor(){super(De.Yg.CreateSettings,[]),this.registerShellHandlers=(e,t)=>{var n;null===(n=e.opener)||void 0===n||n.addEventListener(vb.rY.GetSettings,(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return t.getCurrentSettingsSnapshot().then((t=>e.opener.postMessage(vb.rY.GetSettings,{settings:t})),(()=>e.opener.postMessage(vb.rY.GetSettings,{settings:""})))}))))}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{hostSettings:t}=e,{clientPreferences:n,config:i,configLoader:a,diagnosticsService:o,loggerFactory:r,logsCollectorService:s,platformService:l,windowProvider:d,localStorage:c}=pD("CreateCoreSettingsTask",e,"clientPreferences","config","configLoader","diagnosticsService","loggerFactory","logsCollectorService","platformService","windowProvider","localStorage"),u=r.newLogger("create-core-settings-task"),m=yield ID.v.createContext(n,i,a,r,l,d,t,c),g=c.get("cachedUser",NT.f.User);if(g)try{const e=JSON.parse(g);m.updatePlatformProviderSettings({region:e.region}),u.debugNoPii&&u.debugNoPii("Successfully updated user metadata properties with cached user values")}catch(e){u.logNoPii&&u.logNoPii(`Failed to parse cached user: ${(0,Ci.u4)(e)}`)}else u.debugNoPii&&u.debugNoPii("No cached user found, user metadata properties not updated");const p=m.getCoreSettings(),v=m.getLogsProvider();e.coreSettingsContext=m,e.coreSettings=p,o.subscribeToCoreSettings(p),s.subscribeToCoreSettings(p);p.get(K.J.Core).enableMTMA||s.registerUserLogsProvider("",v),this.registerShellHandlers(d,v)}))}}class AD extends Fe{constructor(){super(De.Yg.CreateSettingsUserContext,["authenticationUser","coreSettingsContext","logsCollectorService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettingsContext:n,logsCollectorService:i,windowProvider:a}=e,o=yield n.createContextForUser(t,a);e.coreSettingsContext=o,e.coreSettings=o.getCoreSettings();const r=o.getLogsProvider();return i.registerUserLogsProvider(t.id,r),e=>{switch(e){case"quit":case"signout":o.cleanup(e);break;default:return}}}))}}class _D{constructor(e,t,n,i,a,o){this._commandHandler=e,this._client=t,this._experienceChangeReportingService=n,this._authenticationUser=i,this._hostCommunicationService=a,this._loggerFactory=o,this._logger=this._loggerFactory.newLogger("core-shortcut-service"),this._registeredDesktopShortcuts=[],this._registeredGlobalShortcuts=[]}addDesktopClientShortcut(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!a)return void this._logger.warn(`Missing windowId for command: ${t}`);const i=yield this._hostCommunicationService.loadModule("windowcontrols"),r=yield null===(o=null==i?void 0:i.addShortcut)||void 0===o?void 0:o.call(i,a,e);return r&&(this._logger.log(`Added desktop shortcut for command ${t} and shortuctId ${r}`),this._registeredDesktopShortcuts.push({commandId:t,shortcutId:r,commandHandler:n,windowId:a})),r}))}removeDesktopClientShortcut(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this._logger.debug(`Removing desktop shortcut for commandId ${e}`);const i=this._registeredDesktopShortcuts.find((n=>n.commandId===e&&n.windowId===t));if(i){const a=yield this._hostCommunicationService.loadModule("windowcontrols");yield null===(n=null==a?void 0:a.removeShortcut)||void 0===n?void 0:n.call(a,i.windowId,i.shortcutId),this._logger.log(`Removed desktop shortcut for command ${e} and shortuctId ${i.shortcutId}`),this._registeredDesktopShortcuts=this._registeredDesktopShortcuts.filter((n=>!(n.commandId===e&&n.windowId===t)))}}))}addGlobalShortcut(e,t,n){var a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=(e=>e.windows)(e),r=0===this._registeredGlobalShortcuts.length;this._logger.log(`Adding global shortcut for command ${t} and shortuct ${i}. ${this._registeredGlobalShortcuts.length} shortcuts active`);const s=yield this._hostCommunicationService.loadModule("globalshortcuts"),l=this._registeredGlobalShortcuts.filter((e=>e.keys===i));if(l.length>0){this._logger.log("Global shortcut already registered, removing");for(const e of l)yield null===(a=null==s?void 0:s.removeGlobalShortcut)||void 0===a?void 0:a.call(s,e.shortcutId),this._logger.log(`Removed global shortcut for command ${t} and shortuct ${i}`),this._registeredGlobalShortcuts=this._registeredGlobalShortcuts.filter((t=>t.shortcutId!==e.shortcutId))}const d=yield null===(o=null==s?void 0:s.addGlobalShortcut)||void 0===o?void 0:o.call(s,e);return d&&(this._registeredGlobalShortcuts.push({commandId:t,shortcutId:d,commandHandler:n,keys:i}),this._logger.log(`Added global shortcut for command ${t} and shortuctId ${d}. ${this._registeredGlobalShortcuts.length} shortcuts active`),r&&(this._logger.log("First global shortcut added, registering callback"),yield this.registerForGlobalShortcutActivated())),d}))}removeGlobalShortcut(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this._logger.log(`Removing global shortcut for commandId ${e}. ${this._registeredGlobalShortcuts.length} shortcuts active`);const i=this._registeredGlobalShortcuts.filter((t=>t.commandId===e));if(i.length>0){const n=yield this._hostCommunicationService.loadModule("globalshortcuts");for(const a of i)this._logger.log(`Removing global shortcut for commandId ${e} with keys ${a.keys}`),yield null===(t=null==n?void 0:n.removeGlobalShortcut)||void 0===t?void 0:t.call(n,a.shortcutId),this._logger.log(`Removed global shortcut for command ${e}`),this._registeredGlobalShortcuts=this._registeredGlobalShortcuts.filter((e=>e.shortcutId!==a.shortcutId));this._logger.log(`Removed ${i.length} global shortcut for command ${e}. ${this._registeredGlobalShortcuts.length} shortcuts active`)}0===this._registeredGlobalShortcuts.length&&(this._logger.log("Last global shortcut removed, disposing registration"),null===(n=this._disposeGlobalShortcutActivatedEventRegistration)||void 0===n||n.call(this),this._disposeGlobalShortcutActivatedEventRegistration=void 0)}))}addEventListener(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield(0,JT.jW)(this._client);(null==n?void 0:n.id)===e&&(this._mainShortcutServiceCallback=t)}))}processEvent(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){(yield(0,JT.jW)(this._client))?null===(n=this._mainShortcutServiceCallback)||void 0===n||n.call(this,e):(this._mainShortcutServiceCallbackWithPayload=()=>{var t;null===(t=this._mainShortcutServiceCallback)||void 0===t||t.call(this,e)},this._subscribeToChangeReportingService()),yield this.openMainApp()}))}registerForDesktopClientKeyDownShortcuts(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this._hostCommunicationService.loadModule("windowcontrols");this._disposeDesktopShortcutKeyDowEventRegistration=null===(e=null==t?void 0:t.registerForKeyDown)||void 0===e?void 0:e.call(t,(e=>this._handleDesktopShortcut(e)))}))}registerForGlobalShortcutActivated(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(this._disposeGlobalShortcutActivatedEventRegistration)return;const t=yield this._hostCommunicationService.loadModule("globalshortcuts");this._disposeGlobalShortcutActivatedEventRegistration=null===(e=null==t?void 0:t.registerForGlobalShortcutActivated)||void 0===e?void 0:e.call(t,(e=>this._handleGlobalShortcut(e)))}))}destroy(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){null===(e=this._disposeDesktopShortcutKeyDowEventRegistration)||void 0===e||e.call(this);const t=yield(0,JT.XD)(this._client),n=t.find((e=>e.isMainWindow&&e.layoutConfig.layoutMode===c.lO.standard));n||(this._mainShortcutServiceCallback=void 0),0!==t.length&&this._authenticationUser&&(null==n?void 0:n.userContextId)===(0,li.b)(this._authenticationUser)||(this._mainShortcutServiceCallbackWithPayload=void 0,this._mainShortcutServiceCallback=void 0,this._subscription&&this._subscription.unsubscribe())}))}openMainApp(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this._commandHandler({entity:{type:u.p.default,action:u.u.default},command:{visibilityState:c.fe.show,stateTransition:c.su.flush,correlation:{source:Ot.D.Core}}})}))}_handleDesktopShortcut(e){const t=this._registeredDesktopShortcuts.find((t=>t.shortcutId===e.shortcutId));t?(this._logger.debug(`Executing command handler for desktop shortcut: ${t.commandId} / ${e.shortcutId}`),t.commandHandler()):this._logger.warn(`Can't execute desktop shortcut with id ${e.shortcutId}. No record found.`)}_handleGlobalShortcut(e){const t=this._registeredGlobalShortcuts.find((t=>t.shortcutId===e));t?(this._logger.debug(`Executing command handler for global shortcut: ${t.commandId} / ${t.shortcutId}`),t.commandHandler()):this._logger.warn(`Can't execute global shortcut with id ${e}. No record found.`)}_subscribeToChangeReportingService(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,aS.U)((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e.type!==bb.FV.LayoutRenderComplete)return;const t=yield(0,JT.jW)(this._client);e.windowId===(null==t?void 0:t.id)&&this._onMainWindowLayoutRenderComplete()}))))).subscribe()}_onMainWindowLayoutRenderComplete(){var e;null===(e=this._mainShortcutServiceCallbackWithPayload)||void 0===e||e.call(this),this._mainShortcutServiceCallbackWithPayload=void 0,this._subscription&&this._subscription.unsubscribe()}}class DD extends Fe{constructor(){super(De.Yg.CreateCoreShortcutService,["commandHandler","client","coreSettings","experienceChangeReportingService","hostCommunicationService","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,commandHandler:n,client:i,coreSettings:a,experienceChangeReportingService:o,hostCommunicationService:r,loggerFactory:s}=e;a.get(K.J.Shortcuts).enableShortcutPropagation&&(e.coreShortcutService=new _D(n,i,o,t,r,s))}))}}class FD extends Fe{constructor(){super(De.Yg.CreateCoreUtilities,["isEntityInView"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{isEntityInView:t}=e;e.coreUtilities={isEntityInView:t}}))}}var MD=n(17245),RD=n(549426);const PD=["activeCalls","activeMeetings","activeWindow","activeWindowForEntity","activeWindows","allClientPreferences","appsInstalledByCurrentUser","appsUsage","bannerNotificationQueue","cachedAppList","callingScreenLayout","callingScreenStatus","currentCallingState","clientPreferences","fetchDynamicCommandsV2","localizationSettings","lockedTiles","meetingRoomLayoutToggleState","mostRecentlyUsedTiles","pinnedMeetings","pinnedTiles","pptSharingSession","recentMeetings","requestImmersiveReader","whiteboardSharingSession","attendeeCaptionsVisibility","meetingRoomFrontOfRoomCallPanelsState","espState"],OD=["addSharedPlatformCachedApps","executeEntityCommand","changeSlotsVisibility","performWindowHistoryNavigation","recordAppActionUsage","recordAppSceneUsage","recordAppUsage","removeSharedPlatformCachedApps","removeUserActiveWindows","removeWindow","resizeHeaderSlot","resizeSlotDimensions","saveReactiveVarsToHistory","setActiveCalls","setCallingScreenLayout","setCallingScreenStatus","toggleHideMyselfVideo","togglePinMyself","toggleMyselfInGrid","toggleParticipantPin","updateActiveCalls","updateAttendeeCaptionsVisibility","updateClientPreferences","updateCurrentLocale","updateEntity","updateEntityState","updateExtendedEntityContainerState","updateMeetingRoomLayoutToggleState","updateSharedPlatformCachedApps","setMeetingRoomFrontOfRoomCallPanelsState","recordEspCompletedActions","recordDisplayedSurface","recordEligibleSurface"],xD=["appsInstalledByCurrentUserEvent","appsUsageUpdateEvent","callParticipantPinnedEventv2","dynamicCommandsUpdateEvent","launchTileUpdatedEvent"],LD=["activeWindow","activeWindowForEntity","activeWindows","allClientPreferences","cachedAppList","clientPreferences","localizationSettings"],UD=[...LD,"activeCalls","activeMeetings","appsInstalledByCurrentUser","appsUsage","bannerNotificationQueue","callingScreenLayout","callingScreenStatus","currentCallingState","fetchDynamicCommandsV2","lockedTiles","meetingRoomLayoutToggleState","mostRecentlyUsedTiles","pinnedMeetings","pinnedTiles","pptSharingSession","recentMeetings","requestImmersiveReader","whiteboardSharingSession","espState"],BD=["addSharedPlatformCachedApps","executeEntityCommand","changeSlotsVisibility","removeWindow","resizeHeaderSlot","performWindowHistoryNavigation","recordAppActionUsage","recordAppSceneUsage","recordAppUsage","removeSharedPlatformCachedApps","removeUserActiveWindows","resizeSlotDimensions","saveReactiveVarsToHistory","updateClientPreferences","updateCurrentLocale","updateEntity","updateEntityState","updateExtendedEntityContainerState","updateSharedPlatformCachedApps"],jD=[...BD,"setActiveCalls","setCallingScreenLayout","setCallingScreenStatus","toggleParticipantPin","toggleHideMyselfVideo","toggleMyselfInGrid","togglePinMyself","updateActiveCalls","updateMeetingRoomLayoutToggleState","recordEspCompletedActions","recordDisplayedSurface","recordEligibleSurface"],WD=[],VD=[...WD,"appsInstalledByCurrentUserEvent","appsUsageUpdateEvent","callParticipantPinnedEventv2","callHideMyselfVideoEvent","dynamicCommandsUpdateEvent","launchTileUpdatedEvent","callMyselfVideoPinnedEvent"],HD=["chat","messages","installedAppsV2"],$D=[...PD,"lpcState","pinnedChannels","joinedTeamsAndChannels"],zD=(e,t,n)=>{const i=(0,MD.p$)(e),{operation:a,selectionSet:{selections:o},variableDefinitions:r}=i,s=qD[a],l=(null==r?void 0:r.some((e=>!!e.defaultValue)))?function(e,t={}){const n={};for(const i of e){const e=i.variable.name.value;t.hasOwnProperty(e)?n[e]=t[e]:i.defaultValue&&(n[e]=(0,RD.M)(i.defaultValue))}return n}(r,t):t;return o.filter((e=>"Field"===e.kind&&!$D.includes(e.name.value))).map((e=>({id:s,fieldName:e.name.value,args:GD(e,l),schemaId:n})))};function GD(e,t){var n;if(!(null===(n=null==e?void 0:e.arguments)||void 0===n?void 0:n.length))return;const i={};for(const n of e.arguments){const e=(0,RD.M)(n.value,t);void 0!==e&&(i[n.name.value]=e)}return i}const qD={query:"ROOT_QUERY",mutation:"ROOT_MUTATION",subscription:"ROOT_SUBSCRIPTION"};var QD;!function(e){e[e.DefaultSchema=0]="DefaultSchema",e[e.ViewSchema=1]="ViewSchema"}(QD||(QD={}));var JD=n(104044);const YD=n(853072);var KD=n(798353);class ZD{constructor(e){this._inactiveOperations=new Map,this._forcedActiveOperations=new Map,this._windowToDataMap=new Map,this._dataToWindowMap=new Map,this._activeOperations=(null==e?void 0:e.activeOperationLimit)?new KD.Z({maxSize:e.activeOperationLimit,onEviction:this.markLeastRecentlyUsedOperation.bind(this)}):new Map}trackOperation(e,t,n=QD.DefaultSchema,i){const{fetchPolicy:a,variables:o}=e,r=e.query||e.mutation;if("no-cache"===a)return;if(e.mutation&&!e.keepRootFields)return;zD(r,o,n).forEach((e=>{const n=(e=>{const t=YD(e);return(0,JD.Z)(t)})(e);this._activeOperations.set(n,e),"boolean"==typeof i&&this.forceActive(n,i),this.addDataForWindow(t,n),this._inactiveOperations.has(n)&&this._inactiveOperations.delete(n)}))}markDataForWindowAsInactive(e){const t=this._windowToDataMap.get(e)||[];this._windowToDataMap.delete(e),t.forEach((t=>{const n=this._dataToWindowMap.get(t);if(n&&(n.delete(e),n.size))return;const i=this._activeOperations.get(t);i&&this._inactiveOperations.set(t,i),this._dataToWindowMap.delete(t),this._activeOperations.delete(t)}))}flush(e=this._inactiveOperations.size){const t=[],n=[];let i=0;return this._inactiveOperations.forEach(((a,o)=>{i>=e||(t.push(a),n.push(o),HD.includes(a.fieldName)&&(i=e),i++)})),n.forEach((e=>this._inactiveOperations.delete(e))),{descriptors:t,hasMore:!!this._inactiveOperations.size}}DEBUG_ONLY_getInactiveOperations(){return this._inactiveOperations}addDataForWindow(e,t){let n=this._windowToDataMap.get(e);n||(n=new Set,this._windowToDataMap.set(e,n)),n.add(t);let i=this._dataToWindowMap.get(t);i||(i=new Set,this._dataToWindowMap.set(t,i)),i.add(e)}forceActive(e,t){var n;const i=(null!==(n=this._forcedActiveOperations.get(e))&&void 0!==n?n:0)+(t?1:-1);0!==i?this._forcedActiveOperations.set(e,i):this._forcedActiveOperations.delete(e)}markLeastRecentlyUsedOperation(e,t){var n;(null!==(n=this._forcedActiveOperations.get(e))&&void 0!==n?n:0)>0?this._activeOperations.set(e,t):this._inactiveOperations.set(e,t)}}class XD{constructor(e,t,n,i){this.dataOpsRepository=e,this.scenarioFactory=t,this.windowProvider=i,this.clients=new Set,this.logger=n.newLogger("EvictionService")}register(e){this.clients.add(e)}unregister(e){this.clients.delete(e)}evict(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.lastEvictionResult={entriesEvicted:0,entriesNotEvicted:0,entriesGCed:0};let e=!0;do{e=yield this.evictByWindowRequestIdleCallback()}while(e)}))}DEBUG_ONLY_getInactiveOperations(){return this.dataOpsRepository.DEBUG_ONLY_getInactiveOperations()}DEBUG_ONLY_getClients(){return this.clients}DEBUG_ONLY_lastResult(){return this.lastEvictionResult}evictByWindowRequestIdleCallback(){return new Promise((e=>{this.windowProvider.requestIdleCallback((t=>{let n=!1,i=0;do{const e=performance.now(),a=t.timeRemaining();this.logger.debug("Time remaining at start",a);const o=this.scenarioFactory.newScenario(ft.RG.CacheEviction);n=this.evictInternal(o);const r=t.timeRemaining(),s=performance.now();i=r>0?r:a-(s-e);const l={"Eviction.TimeRemaining":i};o.stop(l),this.logger.debug("Time remaining at end",i)}while(n&&i>10);e(n)}))}))}evictInternal(e){const{descriptors:t,hasMore:n}=this.dataOpsRepository.flush(10);let i=0,a=0;const o=this.groupCachesBySchema(),r=new Set;t.forEach((e=>{var t;const n=null!==(t=o.get(e.schemaId))&&void 0!==t?t:[];let s=!1;n.forEach((t=>{t.evict(e)&&(r.add(t),s=!0)})),s?i++:a++}));const s={"Eviction.EntriesEvicted":i,"Eviction.EntriesNotEvicted":a};e.mark("eviction",s);let l=0;r.forEach((e=>{const t=e.gc();l+=t.length}));const d={"Eviction.EntriesCollected":l};return e.mark("gc",d),this.logger.debug("Eviction results",{entriesEvicted:i,entriesNotEvicted:a,entriesGCed:l}),this.lastEvictionResult&&(this.lastEvictionResult.entriesEvicted+=i,this.lastEvictionResult.entriesNotEvicted+=a,this.lastEvictionResult.entriesGCed+=l),n}groupCachesBySchema(){const e=new Map;return this.clients.forEach((t=>{let n=e.get(t.schemaId);n||(n=new Set,e.set(t.schemaId,n)),n.add(t.cache)})),e}}var eF=n(95181),tF=n(966009),nF=n(130896),iF=n(263589),aF=n(233609),oF=n(834357),rF=n(959577),sF=n(575754),lF=n(306566);function dF(e){return function(t,{args:n,toReference:i,canRead:a}){if(a(t))return t;const o=e(n);return a(o)?i(o):void 0}}const cF={merge:["prejoinState","callTranscriptState","activeWindow","activeWindowForEntity","messages","userPreferences"],replace:["activeWindows","callingAlerts","workWeekDays","dateRange","activeCalls","listBreakoutRoomsWithDetails"]},uF={Query:{fields:Object.assign(Object.assign({user:dF((e=>({__typename:"User",id:null==e?void 0:e.userId}))),presence:dF((e=>({__typename:"Presence",id:`${null==e?void 0:e.userId}_ups`}))),call:dF((e=>({__typename:"Call",id:null==e?void 0:e.id}))),streamDetails:dF((e=>({__typename:"StreamDetailsInfo",id:null==e?void 0:e.id}))),breakoutRoomsDetails:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]],read:dF((e=>({__typename:"BreakoutRoomsDetails",id:null==e?void 0:e.coordinates.threadId})))},searchForMentionV2:{keyArgs:["teamId","searchQuery","includeBots","channelText","teamText","generalText","channelType","hostTenantId","enableScheduledTags","enableOwnersTag"]},breakoutRoomSettings:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},listBreakoutRoomsWithDetails:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},breakoutRoomsClientState:{keyArgs:["coordinates",["messageId","organizerId","tenantId","threadId"]]},localizationSettings:{keyArgs:["currentLocale"]},searchConversation:{keyArgs:["searchTerm","conversationId","filters"],merge:(e,t)=>t?e?Object.assign(Object.assign({},t),{Results:[...e.Results,...t.Results]}):t:e}},cF.merge.reduce(((e,t)=>Object.assign({[t]:{merge:!0}},e)),{})),cF.replace.reduce(((e,t)=>Object.assign({[t]:{merge:!1}},e)),{}))},Subscription:{fields:{chatServiceEvent:{merge:!1},callRecordingStateChangedEvent:{merge:!1},callingServiceEvent:{merge:!1}}},CallParticipantsCounts:{keyFields:["teamsCallId"]},ParticipantCountsChanged:{keyFields:["teamsCallId"]},ParticipantsChanged:{keyFields:["teamsCallId"]},MessagesResult:{keyFields:!1},WindowHistoryItem:{keyFields:!1},SelectedDevices:{keyFields:!1},Window:{fields:{windowHistory:{merge:!1},activeEntities:{merge:!0},correlation:{merge:!0},extendedEntityContainerState:{merge:!0}}},DeviceList:{fields:{cameras:{merge:!1},camerasSupportingAutoFraming:{merge:!1},microphones:{merge:!1},selectedDevices:{merge:!0}}},Call:{fields:{extendedCallType:{merge:!0},capabilities:{merge:!0},breakoutRoomDetails:{merge:!0}}},RoomCoordinates:{keyFields:["threadId"]},BasicParticipant:{keyFields:["participantId"]},BreakoutRoomsDetails:{fields:{breakoutRooms:{merge:!1}}},BreakoutRoom:{fields:{clientActionState:{read:e=>e||null},participants:{merge:!1}}},CalendarEvent:{keyFields:["objectId"]},InDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},AllDayEvents:{keyFields:["mailboxAddress","date"],fields:{events:{merge:!1}}},Building:{keyFields:["address"]},RecurrenceEvents:{keyFields:["mailboxAddress","cleanGlobalObjectId"]},MeetingCompositeKey:{keyFields:["conversationId","messageId","eventId","modifiedStamp"]},Translation:{keyFields:!1},DiagnosticInfo:{keyFields:!1},EmailUser:{keyFields:["smtp"]},AuthenticationUserProfile:{keyFields:["objectId","tenantId"]},FluidPendingMention:{keyFields:["atMentionId"]},Participant:{keyFields:["participantId"]},Rectangle:{keyFields:!1},AudienceSceneExtent:{keyFields:!1},AudienceSceneParticipant:{keyFields:!1},ChatMessageMentionType:{keyFields:!1},Feed:{fields:{section:{keyArgs(e,{variables:t}){if(t)return t.section},merge(e,t){var n,i;return e?(null===(n=null==t?void 0:t.deltaRequestDetails)||void 0===n?void 0:n.deltaRequestId)&&t.deltaRequestDetails.deltaRequestId===(null==e?void 0:e.requestId)?Object.assign(Object.assign({},t),{items:[...e.items,...t.items]}):(null===(i=t.deltaRequestDetails)||void 0===i?void 0:i.deltaRequestId)?e:t:t}}}},FeedItemType:{keyFields:["uri"]},FilesListResult:{keyFields:["threadId"]},PaymentDetails:{keyFields:["eventId"]},Channel:{fields:{defaultFileSettings:{merge:!0},membershipSummary:{merge:!0},spaceAdminSettings:{merge:!0}}},Team:{fields:{membershipSummary:{merge:!0},teamSettings:{merge:!0},teamGuestSettings:{merge:!0},teamSiteInformation:{merge:!0},sensitivityLabel:{merge:!0}}},TeamSettings:{fields:{funControl:{merge:!0}}}};function mF(e,t,n,i,a){if(n){const{config:{publicPath:n,buildType:o,buildVersion:r}}=i;if(!n)return;const s=window;if(s.__APOLLO_CLIENTS__||(s.__APOLLO_CLIENTS__=[]),s.__APOLLO_KEY_FIELDS__||(s.__APOLLO_KEY_FIELDS__=function(){const e={};for(const t of Object.keys(uF))uF[t].keyFields&&(e[t]=uF[t].keyFields);return e}()),"production"===o)"multi-window"===a?s.__REMPL_APOLLO_DEVTOOLS_URL__=`/multi-window/apollo-devtools?version=${r}`:"react-web-client"===a&&(s.__REMPL_APOLLO_DEVTOOLS_URL__="/v2/apollo-devtools");else{const e=n.endsWith("/")?n:n.concat("/");s.__REMPL_APOLLO_DEVTOOLS_URL__=`${e}apollo-devtools.html`}s.__APOLLO_GLOBAL_OPERATIONS__||(s.__APOLLO_GLOBAL_OPERATIONS__={globalMutations:OD,globalQueries:PD,globalSubscriptions:xD}),s.__APOLLO_CLIENTS__.push({client:e,clientId:t})}}const gF=new sF.i((()=>{throw new Error("This client has been destroyed!")}));class pF{constructor(e,t,n,i,a){var o,r;this.name=i,this.storeType=a,this.disposed=!1,this.schemaId=QD.DefaultSchema,this.ctx=t,this.services=e,this._client=n,null===(o=this.services.leakDetector)||void 0===o||o.track(JN.I.DataClient,this),this.services.dataOpsTracker&&this.setupWatchQueryTracking(this.client),this.services.dataEvictionService&&(null===(r=this.services.dataEvictionService)||void 0===r||r.register(this)),this.registerClient(this.client)}get client(){if(!this._client)throw new Error(`Accessing client ${this.constructor.name}/${this.name} after destroy`);return this._client}get cache(){return this.client.cache}updateContext(e,t){var n;this.ctx=e,null===(n=this._client)||void 0===n||n.setLink(t)}destroy(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){(null===(e=this.services)||void 0===e?void 0:e.dataEvictionService)&&this.services.dataEvictionService.unregister(this),yield this.destroyClient(),this.ctx=void 0,this.services=void 0}))}clearCache(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield null===(e=this._client)||void 0===e?void 0:e.clearStore()}))}getServices(){return this.services}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!1}}mutate(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this.getApolloClientInstance(e.mutation);null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,tF.z.mutate);const i=this.patchOptions(e),a=yield n.mutate(i);return this.trackReadOperation(n,e),a}))}query(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this.getApolloClientInstance(e.query);null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,tF.z.query);const i=this.patchOptions(e),a=yield n.query(i);return this.trackReadOperation(n,e),a}))}readQuery(e,t){var n;const i=this.getApolloClientInstance(e.query);null===(n=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===n||n.trackCall(this.storeType,tF.z.readQuery);const a=i.readQuery(e,t);return this.trackReadOperation(i,e),a}subscribe(e){var t;const n=this.getApolloClientInstance(e.query);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,tF.z.subscribe),n.subscribe(e).map((t=>{var i;return this.trackReadOperation(n,e),null===(i=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===i||i.trackSubscribeEvent(this.storeType),t}))}watchQuery(e){var t;try{const n=this.getApolloClientInstance(e.query);null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,tF.z.watchQuery);const i=this.patchOptions(e);return n.watchQuery(i)}catch(e){return new lF.y((t=>t.error(e)))}}writeQuery(e){var t;const n=this.getApolloClientInstance(e.query);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,tF.z.writeQuery),this.trackWriteOperation(n,e),n.writeQuery(e)}writeFragment(e){var t;const n=this.getApolloClientInstance(e.fragment);return null===(t=this.maybeGetGraphQLStoreStatsReporterService(n))||void 0===t||t.trackCall(this.storeType,tF.z.writeFragment),this.trackWriteOperation(n,e),n.writeFragment(e)}readFragment(e,t){var n;const i=this.getApolloClientInstance(e.fragment);return null===(n=this.maybeGetGraphQLStoreStatsReporterService(i))||void 0===n||n.trackCall(this.storeType,tF.z.readFragment),i.readFragment(e,t)}get defaultOptions(){return this.client.defaultOptions}set defaultOptions(e){this.client.defaultOptions=e}get disableNetworkFetches(){return this.client.disableNetworkFetches}set disableNetworkFetches(e){this.client.disableNetworkFetches=e}getApolloClientInstance(e){return this.client}patchOptions(e){const{context:t,patched:n}=e,a=(0,i.__rest)(e,["context","patched"]);return n?e:Object.assign(Object.assign({},a),{context:Object.assign(Object.assign({},this.ctx),t),patched:!0})}registerClient(e){e.dataClients||(e.dataClients=[]),e.dataClients.push(this)}unregisterClient(e){var t,n,i;return e.dataClients=null===(t=e.dataClients)||void 0===t?void 0:t.filter((e=>e!==this)),0===(null!==(i=null===(n=e.dataClients)||void 0===n?void 0:n.length)&&void 0!==i?i:0)}disposeClient(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this.unregisterClient(e);if(i&&((0,oF.$Z)(e),(0,oF.$Z)(e.cache),function(e){let t=window;for(t.__APOLLO_CLIENTS__&&(t.__APOLLO_CLIENTS__=t.__APOLLO_CLIENTS__.filter((t=>t.client!==e)));t;)t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__&&t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__.ApolloClient===e&&(t.__APOLLO_DEVTOOLS_GLOBAL_HOOK__.ApolloClient=void 0),t.__APOLLO_CLIENT__&&t.__APOLLO_CLIENT__===e&&(t.__APOLLO_CLIENT__=void 0),t=t.parent===t?null:t.parent}(e)),i&&t){const{scenarioFactory:t}=null!==(n=this.services)&&void 0!==n?n:{},i=null==t?void 0:t.newScenario(ft.RG.ApolloClientDisposion);try{e.stop(),yield e.clearStore(),e.setLink(gF),e.setResolvers([]),null==i||i.stop()}catch(e){null==i||i.fail({reason:String(e)})}}}))}disposeClients(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this._client&&(yield this.disposeClient(this._client,e),e&&(this._client=void 0))}))}destroyClient(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.disposed){this.disposed=!0;const{enableApolloClientDisposion:n}=null!==(t=null===(e=this.services)||void 0===e?void 0:e.coreSettings.get(K.J.Core))&&void 0!==t?t:{};yield this.disposeClients(null!=n&&n)}}))}setupWatchQueryTracking(e){const t=e.cache;if(pF.patchedCaches.has(t))return;const n=t.watch;t.watch=(i,...a)=>{this.trackReadOperation(e,i,!0);const o=n.call(t,i,...a);return()=>(this.trackReadOperation(e,i,!1),o())},pF.patchedCaches.set(t,n)}trackReadOperation(e,t,n){var i;this.ctx&&this.services&&(e instanceof pF||null===(i=this.services.dataOpsTracker)||void 0===i||i.trackOperation(t,this.name,this.schemaId,n))}trackWriteOperation(e,t){var n;this.ctx&&this.services&&(e instanceof pF||null===(n=this.services.dataReleaseService)||void 0===n||n.trackWriteOperation(t))}maybeGetGraphQLStoreStatsReporterService(e){var t,n;return e instanceof pF||!(null===(t=this.services)||void 0===t?void 0:t.graphqlStoreStatsReporterService)?null:null===(n=this.services)||void 0===n?void 0:n.graphqlStoreStatsReporterService}}pF.patchedCaches=new WeakMap;const vF=e=>e;class hF extends pF{constructor(e,t,n,i,a,o){super(e,i,n,a||"INVALID",o),this.parent=t}getApolloClientInstance(e){const t=(0,MD.p$)(e);if("OperationDefinition"===t.kind||"FragmentDefinition"===t.kind){const{selectionSet:{selections:n}}=t,i=this.getSharedGlobalOperationsList(t),a=n.map((e=>"Field"===e.kind&&-1===i.indexOf(e.name.value)));if(a.every(vF))return this.client;if(a.some(vF)){const t=(0,Mn.Tr)(this.className,De.jK.InvalidInput,"route",{operation:e},"Operation contains mix of shared and window private selections");throw console.log(t),t}}return this.parent}getSharedGlobalOperationsList(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation?this.parentMutations:"OperationDefinition"===e.kind&&"subscription"===e.operation?this.parentSubscriptions:this.parentQueries}}class fF extends hF{constructor(e,t,n,i,a){super(e,t,n,i,i.windowId,a)}get parentQueries(){return PD}get parentSubscriptions(){return xD}get parentMutations(){return OD}get className(){return"ChildDataClient"}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}}class yF extends pF{constructor(e,t,n,i){super(e,n,t,n.windowId||"INVALID",i)}clone(e){throw new Error("Trying to clone child instance")}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:null,selfIsMainClient:!!this.ctx&&this.ctx.windowId===De.ew}}}class kF extends yF{constructor(){super(...arguments),this.schemaId=QD.ViewSchema}subscribe(e){const t=this.getApolloClientInstance(e.query),n=this.patchOptions(e);return t.subscribe(n)}}var SF=n(256784);class bF extends pF{constructor(e,t,n,i){super(e,n,t({windowId:n.windowId||De.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"core",storeType:tF.t.core}),n.windowId||De.ew,tF.t.core),this.createApolloClient=t,this.overrideLink=null,this.viewSchemaClient=null,this.overrideLink=null,i&&(this.viewSchemaClient=i({windowId:n.windowId||De.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"core-viewSchema",storeType:tF.t.viewSchema}),this.registerClient(this.viewSchemaClient))}updateContext(e,t){super.updateContext(e,t),this.overrideLink=t}clone(e){return e.windowId===De.ew?new yF(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new fF(this.getServices(),this,this.createApolloClient({windowId:e.windowId,entityType:e.entityType,viewportContext:e.windowProvider.viewportContext,name:`child-${e.windowId}`,overrideLink:this.overrideLink,storeType:tF.t.window}),Object.assign(Object.assign({},this.ctx),e),tF.t.window)}cloneForViewSchema(e){return SF(this.viewSchemaClient,"View schema must be avaliable"),new kF(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),tF.t.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class CF extends pF{constructor(e,t,n){super(e,n,t,n.windowId||De.ew,tF.t.embed)}clone(e){return new yF(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType)}}var wF=n(446221),NF=n(665454),TF=n(425851),IF=n(256319);const EF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"WriteCallingDefaults"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingDebugTool"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"passiveBarHiddenParticipantsCount"}}]}},{kind:"Field",name:{kind:"Name",value:"streamPermissionsDebug"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acknowledged"}},{kind:"Field",name:{kind:"Name",value:"acknowledgementRequired"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"Field",name:{kind:"Name",value:"pptSharingSession"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"}}]}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"calls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};const AF={callingDebugTool:{__typename:"CallingDebugTool",visible:!0,passiveBarHiddenParticipantsCount:0},streamPermissionsDebug:{__typename:"StreamPermissionsDebug",acknowledged:!1,acknowledgementRequired:!1,url:"https://www.microsoft.com/"},pptSharingSession:{__typename:"ActivePptSession",_:!1},isFake:!1,calls:[]},_F={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}}]}}]}}]},DF={Query:{lpcState:(e,t,{cache:n})=>n.readQuery({query:_F})},Mutation:{setLpcState(e,{newLpcState:t},{cache:n}){const i={lpcState:Object.assign(Object.assign({},t),{__typename:"LpcState"})};return n.writeQuery({query:_F,data:i}),i.lpcState}}};var FF=n(532009);const MF=(e,t,n)=>{(0,FF.k)(e),function(e,t){const n=t.newLogger("writeCallingDefaults");(0,wF.tW)(e),(0,wF.bC)(e);try{e.writeQuery({query:EF,data:AF})}catch(e){n.error(`Fail to write calling defaults - ${e}`)}try{e.writeQuery({query:NF.a,data:{shouldShowVideoEffectsPreview:!1}})}catch(e){n.error(`Fail to write default value of shouldShowVideoEffectsPreview - ${e}`)}try{e.writeQuery({query:TF.z,data:{shouldKeepPreviewWindowInSidePanelOpen:!1}})}catch(e){n.error(`Fail to write default value of shouldKeepPreviewWindowInSidePanelOpen - ${e}`)}try{e.writeQuery({query:IF.Q,data:{shouldAvatarMenuItemSelected:!0}})}catch(e){n.error(`Fail to write default value of shouldAvatarMenuItemSelected - ${e}`)}}(e,t),function(e){e.writeQuery({query:_F,data:{lpcState:{__typename:"LpcState",isLivePersonaCardInitialized:!1}}})}(e),n&&RF(e,n,t)},RF=(e,t,n)=>{const i=n.newLogger("appDefaults"),a=t.length;i.log(`Writing ${a.toString()} app default values to the Apollo cache.`),t.forEach((t=>{var n,a;try{const{queryFieldName:n,gqlTypeName:i}=t,a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:`${i}DefaultQuery`},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:n},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}}]},o={[n]:{__typename:i}};e.writeQuery({query:a,data:o})}catch(e){const o=`Failed to write ${t.gqlTypeName} to cache as Query field ${t.queryFieldName}.`;null!==(a=null===(n=i.errorToTelemetry)||void 0===n?void 0:n.call(i,o,"webclient_framework_foundation_core_services_active_application_hooks",void 0,!0))&&void 0!==a||i.error(o)}}))};class PF extends zE{constructor(e){super(),this.shellWindow=e,this.shellWindow.opener.addEventListener(vb.rY.CentralDataLayerResponse,(e=>{this.onResponseReceived(e)}))}sendMessage(e){this.shellWindow.opener.postMessage(vb.rY.CentralDataLayerRequest,{dataLayer:e})}}function OF(e){return new sF.i((t=>{const{query:n,variables:i,operationName:a}=t,o=t.getContext(),r={callerInfo:null==o?void 0:o.callerInfo,callerScenarioId:null==o?void 0:o.callerScenarioId};return e.execute(n,i,a,null==o?void 0:o.rendererId,null==o?void 0:o.windowId,r)}))}const xF={mutation:new Set(["notifyWorkerSyncCanStart","notifyActiveContextChangedToCDLWorker"])};var LF=n(890902),UF=n(554817);function BF({resolvers:e,contextValue:t}){return new sF.i(((n,i)=>{const a=function(e,t){const{query:n}=e,i=(0,MD.p$)(n);if("OperationDefinition"!==i.kind)return;const{operation:a,selectionSet:{selections:o}}=i;if("mutation"!==a)return;const r=function(e,t){let n;return e.forEach((e=>{if("Field"===e.kind){const i=function(e,t){let n;return t.forEach((({Mutation:t})=>{t[e]&&(n=n||t[e])})),n}(e.name.value,t);if(i){if(n)throw new Error("There cannot be more than 1 matching forward resolver for a document");n={selection:e,resolver:i}}}})),n}(o,t);if(!r)return;return function(e){if(!e.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value))){const t=e.arguments.map((e=>e.name.value)).join(","),n=e.arguments.map((e=>e.value.name.value)).join(",");throw new Error(`Argument name mismatch. Mutation queries, which have forward mutation resolvers should \n                    have a 1-1 name match between the document variable names and the field resolver variable names.\n                    Allowed argument names ${t} does not match the supplied argument names ${n}`)}}(r.selection),r.resolver}(n,e);if(!a)return i(n);const o=n.getContext();return(0,UF.p)(a(n.variables,Object.assign(Object.assign({},t),o))).flatMap((e=>(n.variables=e,i(n))))}))}var jF=n(513830);function WF(){return new sF.i(((e,t)=>t(e).map((t=>{if(!t.data||!e.query)return t;const{definitions:n}=e.query,i=n.find((e=>e.kind===jF.h.OPERATION_DEFINITION));if(!i||!i.selectionSet)return t;try{const e=i.selectionSet.selections,n=VF(HF(t.data),e);return t.data=n,t}catch(e){return t}}))))}function VF(e,t){for(const n of t){if(n.kind!==jF.h.FIELD)continue;const t=n.name.value;if("__typename"!==t)if(t in e){if(null!==e[t]&&n.selectionSet&&n.selectionSet.selections){e[t]=HF(e[t]);const i=n.selectionSet.selections;VF(e[t],i)}}else e[t]=null}return e}function HF(e){return Array.isArray(e)?e.slice():"object"==typeof e?Object.assign({},e):e}var $F=n(804117);function zF(e){return"subscription"===e.operationType}function GF(e){const{operation:t,graphQLErrors:n,operationType:i}=e,a=t.getContext(),o={operationName:t.operationName,operationType:i,rendererId:a.windowId};return n&&n.length>0&&(o.errors=n.map((e=>function(e,t){let n=De.jK.UnhandledRuntimeException;const i={path:t};if(!e)return i;e.code?n=e.code:"Failed to fetch"===e.message&&(n=De.jK.FailedToFetch);if(i.code=n,e.hasOwnProperty("serverResponse")&&e.serverResponse){"number"==typeof e.serverResponse.status&&(i.status=e.serverResponse.status),i.mscv=e.serverResponse.headers["ms-cv"],i.xmsCorrelationId=e.serverResponse.headers["x-ms-correlation-id"];try{i.contextId=JSON.stringify(e.serverResponse.headers.contextid)}catch(e){}}return i}(e.originalError,e.path&&e.path.join("::"))))),o}function qF(e,t,n){!QF(e)&&n&&function(e,t,n){const i=GF(e);if(i.errors&&i.errors.length>0){!function(e,t){const{operation:n,operationType:i}=e;t.error(`'${n.operationName}' operation of type '${i}' failed.`)}(e,t);const a=Object.assign(Object.assign({},i),{errors:"","Panel.WindowID":i.rendererId});i.errors[0].code===De.jK.FailedToFetch?n.cancel(a):n.fail(a)}else n.stop({operationName:i.operationName,operationType:i.operationType,"Panel.WindowID":i.rendererId})}(e,t,n)}function QF(e){return zF(e)}function JF(e,t,n,i,a){const o=e.newLogger("TrackRequestLink");return new sF.i(((e,r)=>{const{query:s}=e,{operation:l}=(0,l_.S)(s,null),d=r(e);let c;return n&&(null==a||a.addOperation(e.operationName,l,"Request")),i&&(c=function(e,t){let n;return QF(e)||(n=t.newScenario(ft.RG.QueryExecution)),n}({operationType:l,operation:e},t)),new lF.y((t=>{let r;try{r=d.subscribe({next:r=>{i&&(r.errors&&r.errors.length>0?qF({operation:e,operationType:l,graphQLErrors:r.errors,response:r},o,c):function(e,t){if(!zF(e)&&t){const n=GF(e);t.mark(ft.ck.QueryResult,{operationName:n.operationName,operationType:n.operationType,"Panel.WindowID":n.rendererId})}}({operation:e,operationType:l,response:r},c)),n&&(null==a||a.addOperation(e.operationName,l,"Response")),t.next(r)},error:r=>{const s=(e=>e&&e.result?e.result.errors:e instanceof Error?[new $F._("Unhandled exception",void 0,void 0,void 0,void 0,e)]:[new $F._("Unknown error payload provided from forward link")])(r);i&&qF({operation:e,operationType:l,graphQLErrors:s},o,c),n&&(null==a||a.addOperation(e.operationName,l,"Error")),t.error(r)},complete:()=>{i&&qF({operationType:l,operation:e},o,c),c=void 0,t.complete()}})}catch(t){throw i&&qF({operationType:l,operation:e,graphQLErrors:[new $F._("Unhandled exception in forward link",void 0,void 0,void 0,void 0,t)]},o,c),c=void 0,t}return()=>{i&&qF({operationType:l,operation:e},o,c),c=void 0,r&&r.unsubscribe()}}))}))}const YF=new class{constructor(){this.map=new Map}destroy(e){const t=this.map.get(e);t&&(t.subscriptions.forEach((e=>{e.next(void 0),e.complete()})),t.subscriptions.length=0,this.map.delete(e))}register(e){if(!this.map.has(e)){const t=new lF.y((t=>{const{subscriptions:n}=this.map.get(e)||{};n&&n.push(t)}));this.map.set(e,{cancellationObservable:t,subscriptions:[]})}return this.map.get(e).cancellationObservable}};function KF(e){YF.destroy(e)}function ZF(e,t){const n=e.newLogger("TrackSubscriptionLinks");return new sF.i(((e,i)=>{const{eventsWithoutCancellationListener:a}=t.get(K.J.Calling),{operationName:o,query:r}=e,{operation:s}=(0,l_.S)(r,null);if("subscription"!==s||(null==a?void 0:a.includes(o)))return i(e);const l=(0,mt.v4)(),d=YF.register(l);n.debug(`Forwarding request ${l} for operation ${o}`),e.setContext((e=>Object.assign(Object.assign({},e),{cancellationListener:d})));const c=i(e);return new lF.y((e=>{let t;try{t=c.subscribe({next:t=>{var n;(null===(n=null==t?void 0:t.errors)||void 0===n?void 0:n.length)&&KF(l),e.next(t)},error:t=>{KF(l),e.error(t)},complete:()=>{KF(l),e.complete()}})}catch(e){throw KF(l),e}return()=>{KF(l),t&&t.unsubscribe()}}))}))}function XF(e,t,n=!1){const i=new Map,a=new Map;if(!e)throw new Error("Need an operation name to support");return new sF.i(((o,r)=>{if(!((e,t)=>{const{query:n}=e,i=(0,MD.p$)(n);if(!i||"OperationDefinition"!==i.kind)return!1;const{selectionSet:{selections:a}}=i,{operation:o}=(0,l_.S)(n,null);if("subscription"!==o)return!1;if(a.length>1)throw new Error("There cannot be more than 1 selection for this link");const r=a[0];if("Field"===r.kind&&r.name.value===t){if(r.arguments.every((({name:e,value:t})=>"Variable"!==t.kind||t.name.value===e.value)))return!0;throw new Error("Argument name must match value")}return!1})(o,e))return r(o);const s=(l=o.variables,JSON.stringify(Object.keys(l).sort().map((e=>{const t=l[e];if(-1!==["boolean","string"].indexOf(typeof t)||null===t||Number.isSafeInteger(t))return[e,t];throw new Error("Unsupported argument type")}))));var l;return new lF.y((e=>{const l=i.get(s);if(l)l.observersCollection.push(e),n&&a.has(s)&&e.next(a.get(s));else{let l="";if(t&&t.get(K.J.Calling).enableSubscriptionCancellationListener){l=(0,mt.v4)();const e=YF.register(l);o.setContext((t=>Object.assign(Object.assign({},t),{cancellationListener:e})))}const d=r(o).subscribe({next:e=>{n&&a.set(s,e);i.get(s).observersCollection.slice().forEach((t=>{t.next(e)}))},error:e=>{const{observersCollection:t}=i.get(s);i.delete(s);for(const n of t)n.error(e)},complete:()=>{const{observersCollection:e}=i.get(s);i.delete(s);for(const t of e)t.complete()}});i.set(s,{observersCollection:[e],forwardSubscription:d,requestId:l})}return()=>{const t=i.get(s);if(!t)return;const{observersCollection:n,forwardSubscription:o,requestId:r}=t,l=n.indexOf(e);-1!==l&&(n.splice(l,1),0===n.length&&(i.delete(s),a.delete(s),null!==r&&""!==r&&function(e){YF.destroy(e)}(r),o&&o.unsubscribe()))}}))}))}var eM=n(366606),tM=n(808947),nM=n(602136),iM=n(758730),aM=n(432327);const oM=e=>({modules:[()=>(0,d.mT)((()=>n.e(92151).then(n.bind(n,637363))),"data-apollo-broadcast-streaming-attendee",e),()=>(0,d.mT)((()=>Promise.all([n.e(10523),n.e(6693)]).then(n.bind(n,419071))),"data-client-calling",e),()=>(0,d.mT)((()=>n.e(10683).then(n.bind(n,934806))),"data-resolvers-activity",e),()=>(0,d.mT)((()=>n.e(49073).then(n.bind(n,862370))),"data-resolvers-activity-bell-count",e),()=>(0,d.mT)((()=>Promise.all([n.e(72932),n.e(83744),n.e(20058)]).then(n.bind(n,153396))),"data-resolvers-activity-settings",e),()=>(0,d.mT)((()=>n.e(12136).then(n.bind(n,245907))),"data-resolvers-address-autosuggest",e),()=>(0,d.mT)((()=>n.e(74750).then(n.bind(n,216706))),"data-resolvers-ai-insights-feedback",e),()=>(0,d.mT)((()=>n.e(10812).then(n.bind(n,216817))),"data-resolvers-ai-insights-sds",e),()=>(0,d.mT)((()=>n.e(87391).then(n.bind(n,756699))),"data-resolvers-app-device-permission",e),()=>(0,d.mT)((()=>n.e(75230).then(n.bind(n,630446))),"data-resolvers-app-ratings-and-reviews",e),()=>(0,d.mT)((()=>n.e(32240).then(n.bind(n,501151))),"data-resolvers-app-suggestions",e),()=>(0,d.mT)((()=>Promise.all([n.e(18669),n.e(1420)]).then(n.bind(n,650575))),"data-resolvers-appbar",e),()=>(0,d.mT)((()=>n.e(76260).then(n.bind(n,70958))),"data-resolvers-apps-monet",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(10287),n.e(81578),n.e(14324),n.e(48127),n.e(9486),n.e(78594)]).then(n.bind(n,97941))),"data-resolvers-apps-platform",e),()=>(0,d.mT)((()=>n.e(32978).then(n.bind(n,923320))),"data-resolvers-apps-usage",e),()=>(0,d.mT)((()=>n.e(79071).then(n.bind(n,667027))),"data-resolvers-artifacts-platform",e),()=>(0,d.mT)((()=>n.e(17097).then(n.bind(n,253279))),"data-resolvers-azure-maps",e),()=>(0,d.mT)((()=>n.e(76138).then(n.bind(n,530514))),"data-resolvers-biometric-enrollment",e),()=>(0,d.mT)((()=>Promise.all([n.e(16747),n.e(30087)]).then(n.bind(n,513382))),"data-resolvers-bots-platform",e),()=>(0,d.mT)((()=>n.e(96386).then(n.bind(n,755884))),"data-resolvers-bots-platform-worker",e),()=>(0,d.mT)((()=>n.e(84042).then(n.bind(n,607210))),"data-resolvers-brb",e),()=>(0,d.mT)((()=>n.e(48195).then(n.bind(n,739706))),"data-resolvers-breakout-rooms",e),()=>(0,d.mT)((()=>n.e(66493).then(n.bind(n,545524))),"data-resolvers-browser-activity",e),()=>(0,d.mT)((()=>n.e(8806).then(n.bind(n,174923))),"data-resolvers-browser-ams",e),()=>(0,d.mT)((()=>n.e(75818).then(n.bind(n,58113))),"data-resolvers-browser-app-state",e),()=>(0,d.mT)((()=>n.e(90963).then(n.bind(n,720938))),"data-resolvers-browser-audience",e),()=>(0,d.mT)((()=>Promise.resolve().then(n.bind(n,717233))),"data-resolvers-browser-authentication",e),()=>(0,d.mT)((()=>n.e(12353).then(n.bind(n,679781))),"data-resolvers-browser-broadcast-attendee",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(95544),n.e(30038)]).then(n.bind(n,603243))),"data-resolvers-browser-calendar",e),()=>(0,d.mT)((()=>n.e(46310).then(n.bind(n,541097))),"data-resolvers-browser-call-recording",e),()=>(0,d.mT)((()=>n.e(488).then(n.bind(n,854030))),"data-resolvers-browser-calls-screen",e),()=>(0,d.mT)((()=>n.e(88314).then(n.bind(n,97882))),"data-resolvers-browser-chat",e),()=>(0,d.mT)((()=>n.e(48687).then(n.bind(n,354814))),"data-resolvers-browser-communities",e),()=>(0,d.mT)((()=>n.e(98722).then(n.bind(n,501398))),"data-resolvers-browser-core",e),()=>(0,d.mT)((()=>n.e(3891).then(n.bind(n,776301))),"data-resolvers-browser-ddv",e),()=>(0,d.mT)((()=>n.e(55221).then(n.bind(n,650806))),"data-resolvers-browser-files",e),()=>(0,d.mT)((()=>n.e(40868).then(n.bind(n,758477))),"data-resolvers-browser-floodgate",e),()=>(0,d.mT)((()=>Promise.all([n.e(83836),n.e(4867),n.e(3985),n.e(10104)]).then(n.bind(n,578212))),"data-resolvers-browser-live-stream-rendering",e),()=>(0,d.mT)((()=>n.e(22540).then(n.bind(n,670672))),"data-resolvers-browser-lms-integration",e),()=>(0,d.mT)((()=>n.e(48840).then(n.bind(n,43016))),"data-resolvers-browser-logs-files",e),()=>(0,d.mT)((()=>n.e(1638).then(n.bind(n,443018))),"data-resolvers-browser-meet-for-work",e),()=>(0,d.mT)((()=>n.e(91029).then(n.bind(n,852099))),"data-resolvers-browser-meeting-artifacts",e),()=>(0,d.mT)((()=>n.e(56166).then(n.bind(n,659719))),"data-resolvers-browser-meeting-bot",e),()=>(0,d.mT)((()=>n.e(63968).then(n.bind(n,37445))),"data-resolvers-browser-meeting-catchup",e),()=>(0,d.mT)((()=>n.e(51949).then(n.bind(n,111836))),"data-resolvers-browser-mention",e),()=>(0,d.mT)((()=>n.e(26756).then(n.bind(n,383538))),"data-resolvers-browser-notifications-settings",e),()=>(0,d.mT)((()=>n.e(77697).then(n.bind(n,256065))),"data-resolvers-browser-payment",e),()=>(0,d.mT)((()=>n.e(93553).then(n.bind(n,618699))),"data-resolvers-browser-settings",e),()=>(0,d.mT)((()=>n.e(229).then(n.bind(n,540968))),"data-resolvers-browser-share",e),()=>(0,d.mT)((()=>n.e(14169).then(n.bind(n,31081))),"data-resolvers-browser-style-my-room",e),()=>(0,d.mT)((()=>n.e(73969).then(n.bind(n,689261))),"data-resolvers-browser-survey",e),()=>(0,d.mT)((()=>n.e(35241).then(n.bind(n,543632))),"data-resolvers-browser-teams",e),()=>(0,d.mT)((()=>n.e(29180).then(n.bind(n,372259))),"data-resolvers-browser-tenant-privacy",e),()=>(0,d.mT)((()=>n.e(76023).then(n.bind(n,96891))),"data-resolvers-browser-tpn",e),()=>(0,d.mT)((()=>n.e(70357).then(n.bind(n,104212))),"data-resolvers-browser-url-preview",e),()=>(0,d.mT)((()=>Promise.all([n.e(32276),n.e(79455)]).then(n.bind(n,124681))),"data-resolvers-browser-virtual-events",e),()=>(0,d.mT)((()=>n.e(27490).then(n.bind(n,962779))),"data-resolvers-browser-voicemail",e),()=>(0,d.mT)((()=>Promise.all([n.e(80337),n.e(26124)]).then(n.bind(n,560928))),"data-resolvers-browser-webinar",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(95544),n.e(94300),n.e(5632)]).then(n.bind(n,575573))),"data-resolvers-calendar",e),()=>(0,d.mT)((()=>n.e(34653).then(n.bind(n,828032))),"data-resolvers-callable-channel",e),()=>(0,d.mT)((()=>Promise.all([n.e(95138),n.e(6020)]).then(n.bind(n,541506))),"data-resolvers-calling",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(58257),n.e(37684),n.e(61302),n.e(25585)]).then(n.bind(n,657900))),"data-resolvers-channel-info-pane",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(58257),n.e(37684),n.e(92249),n.e(61302),n.e(86639)]).then(n.bind(n,85446))),"data-resolvers-channel-messages",e),()=>(0,d.mT)((()=>n.e(82991).then(n.bind(n,922614))),"data-resolvers-channels",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(81e3),n.e(58257),n.e(72932),n.e(37684),n.e(84411),n.e(91455),n.e(95138),n.e(16366)]).then(n.bind(n,180244))),"data-resolvers-chat",e),()=>(0,d.mT)((()=>n.e(84427).then(n.bind(n,257831))),"data-resolvers-closed-captions",e),()=>(0,d.mT)((()=>n.e(75499).then(n.bind(n,729481))),"data-resolvers-coach-report",e),()=>(0,d.mT)((()=>n.e(55264).then(n.bind(n,125762))),"data-resolvers-collab-cloud",e),()=>(0,d.mT)((()=>n.e(94263).then(n.bind(n,507521))),"data-resolvers-communities",e),()=>(0,d.mT)((()=>n.e(12767).then(n.bind(n,970483))),"data-resolvers-compose-language",e),()=>(0,d.mT)((()=>n.e(76003).then(n.bind(n,646363))),"data-resolvers-connected-calendar",e),()=>(0,d.mT)((()=>n.e(33745).then(n.bind(n,936129))),"data-resolvers-connectors",e),()=>(0,d.mT)((()=>n.e(87314).then(n.bind(n,107066))),"data-resolvers-contacts-sync",e),()=>(0,d.mT)((()=>n.e(61627).then(n.bind(n,59633))),"data-resolvers-contacts-sync-banner",e),()=>(0,d.mT)((()=>n.e(84226).then(n.bind(n,763660))),"data-resolvers-contacts-sync-settings",e),()=>(0,d.mT)((()=>n.e(48853).then(n.bind(n,959553))),"data-resolvers-conversations-reminder",e),()=>(0,d.mT)((()=>n.e(83650).then(n.bind(n,936596))),"data-resolvers-cross-tenant-policies",e),()=>(0,d.mT)((()=>n.e(75145).then(n.bind(n,126716))),"data-resolvers-desktop-client-shortcuts",e),()=>(0,d.mT)((()=>n.e(27133).then(n.bind(n,343724))),"data-resolvers-developer-switchers",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(37684),n.e(61302),n.e(85446)]).then(n.bind(n,585099))),"data-resolvers-discover-surface",e),()=>(0,d.mT)((()=>n.e(67767).then(n.bind(n,334855))),"data-resolvers-distribution-list",e),()=>(0,d.mT)((()=>n.e(31192).then(n.bind(n,905437))),"data-resolvers-dynamics-marketing",e),()=>(0,d.mT)((()=>n.e(19778).then(n.bind(n,901378))),"data-resolvers-esp",e),()=>(0,d.mT)((()=>n.e(56654).then(n.bind(n,395861))),"data-resolvers-esp-target",e),()=>(0,d.mT)((()=>n.e(86090).then(n.bind(n,307560))),"data-resolvers-example",e),()=>(0,d.mT)((()=>n.e(88542).then(n.bind(n,642196))),"data-resolvers-external-accounts",e),()=>(0,d.mT)((()=>n.e(90378).then(n.bind(n,651213))),"data-resolvers-external-accounts-response",e),()=>(0,d.mT)((()=>n.e(87392).then(n.bind(n,661168))),"data-resolvers-external-calendar-email-address",e),()=>(0,d.mT)((()=>n.e(57375).then(n.bind(n,430487))),"data-resolvers-favorite-user",e),()=>(0,d.mT)((()=>Promise.all([n.e(72932),n.e(37301)]).then(n.bind(n,623549))),"data-resolvers-files",e),()=>(0,d.mT)((()=>n.e(66263).then(n.bind(n,115339))),"data-resolvers-fluid",e),()=>(0,d.mT)((()=>n.e(97323).then(n.bind(n,344487))),"data-resolvers-gallery",e),()=>(0,d.mT)((()=>n.e(89689).then(n.bind(n,693682))),"data-resolvers-guardians",e),()=>(0,d.mT)((()=>n.e(45029).then(n.bind(n,333802))),"data-resolvers-host-updates",e),()=>(0,d.mT)((()=>n.e(64100).then(n.bind(n,280725))),"data-resolvers-hosted-web-content-log",e),()=>(0,d.mT)((()=>n.e(57746).then(n.bind(n,655508))),"data-resolvers-immersive-reader",e),()=>(0,d.mT)((()=>n.e(18884).then(n.bind(n,579811))),"data-resolvers-implicit-contacts",e),()=>(0,d.mT)((()=>n.e(32529).then(n.bind(n,721122))),"data-resolvers-import-msa-contacts",e),()=>(0,d.mT)((()=>n.e(84091).then(n.bind(n,804026))),"data-resolvers-invite-links",e),()=>(0,d.mT)((()=>Promise.all([n.e(43653),n.e(8126),n.e(72467),n.e(48129)]).then(n.bind(n,897306))),"data-resolvers-live-state-broadcast",e),()=>(0,d.mT)((()=>Promise.resolve().then(n.bind(n,754504))),"data-resolvers-local-preferences",e),()=>(0,d.mT)((()=>Promise.resolve().then(n.bind(n,477533))),"data-resolvers-localization-settings",e),()=>(0,d.mT)((()=>n.e(49087).then(n.bind(n,116301))),"data-resolvers-loki",e),()=>(0,d.mT)((()=>n.e(56448).then(n.bind(n,329628))),"data-resolvers-m365-links",e),()=>(0,d.mT)((()=>n.e(99367).then(n.bind(n,474041))),"data-resolvers-manage-tenant",e),()=>(0,d.mT)((()=>n.e(52943).then(n.bind(n,711477))),"data-resolvers-meet-for-work",e),()=>(0,d.mT)((()=>Promise.all([n.e(6749),n.e(8687)]).then(n.bind(n,434622))),"data-resolvers-meeting-analytics",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(62478)]).then(n.bind(n,532028))),"data-resolvers-meeting-intelligence",e),()=>(0,d.mT)((()=>n.e(17400).then(n.bind(n,514815))),"data-resolvers-meeting-options",e),()=>(0,d.mT)((()=>n.e(4596).then(n.bind(n,651613))),"data-resolvers-meeting-summary-qna-history",e),()=>(0,d.mT)((()=>n.e(78996).then(n.bind(n,418123))),"data-resolvers-meeting-templates",e),()=>(0,d.mT)((()=>n.e(55989).then(n.bind(n,266010))),"data-resolvers-mesh-audio",e),()=>(0,d.mT)((()=>n.e(62329).then(n.bind(n,404594))),"data-resolvers-mesh-spaces",e),()=>(0,d.mT)((()=>n.e(68400).then(n.bind(n,669658))),"data-resolvers-mfu-contacts",e),()=>(0,d.mT)((()=>n.e(68507).then(n.bind(n,90736))),"data-resolvers-missed-mtma-notifications",e),()=>(0,d.mT)((()=>n.e(23989).then(n.bind(n,722227))),"data-resolvers-mru",e),()=>(0,d.mT)((()=>n.e(65398).then(n.bind(n,169680))),"data-resolvers-msa-authentication",e),()=>(0,d.mT)((()=>n.e(80579).then(n.bind(n,260673))),"data-resolvers-notifications",e),()=>(0,d.mT)((()=>n.e(7932).then(n.bind(n,935358))),"data-resolvers-notifications-engine",e),()=>(0,d.mT)((()=>n.e(64278).then(n.bind(n,703607))),"data-resolvers-os-file-share",e),()=>(0,d.mT)((()=>n.e(22616).then(n.bind(n,548794))),"data-resolvers-people-avatar",e),()=>(0,d.mT)((()=>Promise.all([n.e(95281),n.e(91384),n.e(97757),n.e(25443),n.e(93844)]).then(n.bind(n,386583))),"data-resolvers-people-picker",e),()=>(0,d.mT)((()=>n.e(79932).then(n.bind(n,956457))),"data-resolvers-people-targeting",e),()=>(0,d.mT)((()=>n.e(98050).then(n.bind(n,907763))),"data-resolvers-phonelink-sms",e),()=>(0,d.mT)((()=>Promise.all([n.e(83817),n.e(9486),n.e(45286),n.e(82329)]).then(n.bind(n,357232))),"data-resolvers-platform-tabs",e),()=>(0,d.mT)((()=>Promise.all([n.e(80764),n.e(35512)]).then(n.bind(n,530281))),"data-resolvers-platform-tabs-state",e),()=>(0,d.mT)((()=>n.e(60115).then(n.bind(n,11190))),"data-resolvers-policies",e),()=>(0,d.mT)((()=>Promise.all([n.e(84460),n.e(51778),n.e(61724),n.e(60532)]).then(n.bind(n,653830))),"data-resolvers-presence",e),()=>(0,d.mT)((()=>n.e(93902).then(n.bind(n,497819))),"data-resolvers-privacy-settings",e),()=>(0,d.mT)((()=>n.e(26759).then(n.bind(n,647593))),"data-resolvers-pstn",e),()=>(0,d.mT)((()=>n.e(99173).then(n.bind(n,684159))),"data-resolvers-reply-chains",e),()=>(0,d.mT)((()=>Promise.all([n.e(86854),n.e(45129),n.e(39341),n.e(86060)]).then(n.bind(n,679474))),"data-resolvers-search",e),()=>(0,d.mT)((()=>Promise.all([n.e(86854),n.e(45129),n.e(39341),n.e(76945)]).then(n.bind(n,281249))),"data-resolvers-search-contextual",e),()=>(0,d.mT)((()=>Promise.all([n.e(26589),n.e(60848)]).then(n.bind(n,505199))),"data-resolvers-search-meeting-summary",e),()=>(0,d.mT)((()=>n.e(44462).then(n.bind(n,173596))),"data-resolvers-search-prefetch",e),()=>(0,d.mT)((()=>n.e(78001).then(n.bind(n,816507))),"data-resolvers-search-substrate",e),()=>(0,d.mT)((()=>Promise.all([n.e(95281),n.e(91384),n.e(8908),n.e(25443),n.e(7598)]).then(n.bind(n,285365))),"data-resolvers-search-suggestions",e),()=>(0,d.mT)((()=>n.e(34595).then(n.bind(n,897290))),"data-resolvers-sensitivity-label",e),()=>(0,d.mT)((()=>Promise.all([n.e(95281),n.e(39717)]).then(n.bind(n,473266))),"data-resolvers-share-to-teams",e),()=>(0,d.mT)((()=>n.e(70225).then(n.bind(n,468770))),"data-resolvers-shell",e),()=>(0,d.mT)((()=>n.e(39262).then(n.bind(n,862324))),"data-resolvers-smb-user-intent",e),()=>(0,d.mT)((()=>n.e(25270).then(n.bind(n,968643))),"data-resolvers-store",e),()=>(0,d.mT)((()=>n.e(47806).then(n.bind(n,591550))),"data-resolvers-suggestions",e),()=>(0,d.mT)((()=>n.e(87227).then(n.bind(n,734392))),"data-resolvers-system-settings",e),()=>(0,d.mT)((()=>n.e(51661).then(n.bind(n,97497))),"data-resolvers-targeting-hierarchy",e),()=>(0,d.mT)((()=>n.e(80574).then(n.bind(n,787259))),"data-resolvers-taskbar",e),()=>(0,d.mT)((()=>n.e(78866).then(n.bind(n,46400))),"data-resolvers-team-gallery",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(48127),n.e(67785)]).then(n.bind(n,365566))),"data-resolvers-team-settings",e),()=>(0,d.mT)((()=>n.e(65365).then(n.bind(n,71151))),"data-resolvers-teams",e),()=>(0,d.mT)((()=>Promise.all([n.e(51778),n.e(61724),n.e(72932),n.e(12971),n.e(48127),n.e(9486),n.e(45286),n.e(86205)]).then(n.bind(n,360856))),"data-resolvers-teams-and-channels",e),()=>(0,d.mT)((()=>n.e(17902).then(n.bind(n,546768))),"data-resolvers-teams-meeting-policies",e),()=>(0,d.mT)((()=>n.e(86824).then(n.bind(n,697248))),"data-resolvers-tenant-analytics",e),()=>(0,d.mT)((()=>n.e(88540).then(n.bind(n,248552))),"data-resolvers-tenant-membership",e),()=>(0,d.mT)((()=>n.e(39706).then(n.bind(n,515720))),"data-resolvers-tfl-meeting-links",e),()=>(0,d.mT)((()=>n.e(91457).then(n.bind(n,569066))),"data-resolvers-tfl-user",e),()=>(0,d.mT)((()=>n.e(81694).then(n.bind(n,586237))),"data-resolvers-third-party-calendar",e),()=>(0,d.mT)((()=>Promise.all([n.e(72932),n.e(31911),n.e(588)]).then(n.bind(n,243453))),"data-resolvers-toast",e),()=>(0,d.mT)((()=>n.e(29722).then(n.bind(n,659438))),"data-resolvers-transcript",e),()=>(0,d.mT)((()=>n.e(18815).then(n.bind(n,828523))),"data-resolvers-transcript-feedback",e),()=>(0,d.mT)((()=>n.e(68095).then(n.bind(n,288893))),"data-resolvers-transcript-settings-store",e),()=>(0,d.mT)((()=>n.e(3441).then(n.bind(n,730153))),"data-resolvers-translation-settings",e),()=>(0,d.mT)((()=>n.e(7560).then(n.bind(n,292227))),"data-resolvers-unified-consent",e),()=>(0,d.mT)((()=>n.e(83028).then(n.bind(n,464505))),"data-resolvers-update-client-state",e),()=>(0,d.mT)((()=>n.e(73676).then(n.bind(n,727868))),"data-resolvers-user",e),()=>(0,d.mT)((()=>n.e(84335).then(n.bind(n,323108))),"data-resolvers-user-license",e),()=>(0,d.mT)((()=>Promise.all([n.e(72932),n.e(14284),n.e(55919)]).then(n.bind(n,109369))),"data-resolvers-user-preferences",e),()=>(0,d.mT)((()=>Promise.all([n.e(29266),n.e(25375)]).then(n.bind(n,517096))),"data-resolvers-view-schema",e),()=>(0,d.mT)((()=>n.e(51469).then(n.bind(n,476967))),"data-resolvers-viva-insights",e),()=>(0,d.mT)((()=>n.e(19318).then(n.bind(n,932666))),"data-resolvers-whats-new",e),()=>(0,d.mT)((()=>Promise.resolve().then(n.bind(n,567444))),"data-resolvers-windows",e),()=>(0,d.mT)((()=>Promise.all([n.e(68413),n.e(21706)]).then(n.bind(n,894439))),"data-schema-cdl",e),()=>(0,d.mT)((()=>n.e(91443).then(n.bind(n,234877))),"data-resolvers-cypress-only",e)],preloadModules:[26,100,101,169],sharedModule:()=>(0,d.mT)((()=>Promise.all([n.e(47933),n.e(35922),n.e(34882)]).then(n.bind(n,439477))),"data-schema",e),dependencies:{1:[171,170],3:[2],4:[171,170,165],13:[171,170],14:[171,170,13],18:[171,170],21:[171,170],27:[171,170],31:[171,170],32:[171,170,64],35:[171,170],37:[171,170],58:[171,170,64],60:[171,170],61:[62],64:[171,170],72:[171,170],74:[171,170],79:[62],82:[171,170],86:[85],88:[171,170],90:[171,170,35],96:[171,170],105:[171,170,64,58],106:[107],108:[171,170],113:[171,170],121:[171,170],124:[171,170],127:[171,170],131:[171,170],132:[171,170,131],148:[171,170],149:[62],153:[171,170],157:[171,170,107],163:[171,170],165:[171,170],168:[171,170,82],170:[171]},types:{Query:{pstnUserProfile:1,ignoreMirroringVideoPreferenceSetting:1,ongoingConsultation:1,parkedCallDetails:1,mergeableCalls:1,userCallingSettings:1,explicitRecordingConsentState:1,deviceList:1,defaultVideoBackgroundImages:1,tenantVideoBackgroundImages:1,userVideoBackgroundImages:1,call:1,callWhiteboardSharingSources:1,callMeetingInfo:1,callHealthCategories:1,callQuestionnaire:1,callingIntent:1,callByThreadId:1,videoAvailableForConversation:1,callStartTimestamp:1,callParticipants:1,transportCompanionDeviceInfo:1,teamsCallId:1,callingDialogData:1,callTranscriptState:1,callingAlerts:1,shouldShowTheUpsellScreen:1,meetingInfoFromCall:1,getDeviceBlurringCapability:1,callScreenPreviewsV2:1,screenRecordingEnabled:1,noiseSuppressionSetting:1,autoGainControlSetting:1,musicModeSettings:1,isAudioOnlySupported:1,isCameraSharingEnabled:1,isMeetingRoomCortanaEnabled:1,isContentCameraEnhancementSupported:1,shouldShowVmrButton:1,isAllowStartWhiteboardEnabled:1,systemAudioState:1,castingSystemAudioState:1,spatialAudioConfigs:1,speakerMuted:1,speakerHWMuted:1,searchUsersByIdsOrQuery:1,threadMembers:1,meetingRoomInMeetingSpeakerAttributionState:1,meetingRoomInMeetingFaceAttributionState:1,meetingRoomInMeetingPeopleFeedState:1,currentSeatingAssignment:1,currentSeatMapping:1,currentAudienceScene:1,callParticipantsCounts:1,isVideoEffectCapableOnDevice:1,isWatermarkSupported:1,videoEffectStateV2:1,videoTouchUpStrength:1,windowsEffectsCapability:1,isWindowsEffectsQuickSettingsSupported:1,windowsEffectsState:1,isHighFidelityAudioModeOn:1,hasActiveCalls:1,meetingRoomDefaultCallSettings:1,meetingRoomInfo:1,videoEffectReadinessOnDevice:1,totalMeetingParticipantCount:1,isAnonUserFromCloud:1,isE2EECallEnabled:1,isE2EESettingEnabledByTenantAdmin:1,isE2EEQualifiedBySlimcoreVersion:1,getEmergencyAddress:1,getLocationResponseAddress:1,emergencyCustomDisclaimer:1,callRedirectionSettings:1,ringtoneSettings:1,isApplianceMode:1,cloudPeopleFeedRoomViewState:1,holographicCallState:1,isOutgoingCallerIDBlocked:1,isBlockOutgoingCallerIDEnabled:1,voicemailPolicySettings:1,voicemailSettings:1,userDelegation:1,busyOnBusySetting:1,isTTYSettingEnabled:1,parkedCalls:1,slaCalls:1,userDelegates:1,callingAggregateSettings:1,browserPopoutUserPreference:1,getSecondaryRingerDevice:1,activities:2,activitySettingsComponents:4,activitySettings:4,addressAutoSuggest:5,aiInsightsCollectionItems:7,aiInsightsCollectionItem:7,appSuggestions:10,skypeTeamsAppRanking:10,lockedTiles:11,pinnedTiles:11,mostRecentlyUsedTiles:11,m365Apps:11,billingRegion:12,offer:12,appsubscriptions:12,installedApps:13,installedAppsV2:13,installedChatAppsWithPreCheck:13,tflChatInstalledApps:13,installedSideLoadApp:13,installedTrustedSideLoadApp:13,installedApp:13,appDefinitions:13,appDefinition:13,blockedAppDefinition:13,sideLoadAppDefinition:13,trustedSideLoadAppDefinition:13,stagedApps:13,appStoreRating:13,installedAppsForContainerApp:13,customAppPolicy:13,appsUsage:13,appsInstalledByCurrentUser:13,appImpressions:13,installedAppsForUser:13,installedAppThreads:13,isAppsDiscoveryEnabled:13,getTeamManageAppsPermissions:13,getUserAppRequest:13,adminAppRequestConfig:13,todoAppsUsage:14,getMeetingArtifacts:15,meetingArtifactsBatch:15,addresses:16,botSingleSignOnRequest:18,fetchAdaptiveCardsForTab:18,searchMessageExtension:18,searchUniversalSearch:18,selectItemMessageExtension:18,fetchDynamicCommands:18,fetchDynamicCommandsV2:18,getAppPreview:18,querySettingUrlMessageExtension:18,getBotFileUploadUrl:18,taskMessageExtension:18,botConfig:18,getAuthToken:18,fetchTaskForAdaptiveCardTab:18,fetchTaskModule:18,brbFormData:20,brbScreenshots:20,roomCoordinates:21,listBreakoutRoomsWithDetails:21,breakoutRoomSettings:21,getBreakoutRoomsUsers:21,getGroupsMembers:21,teamMembers:21,fetchAssignees:21,breakoutRoomsDetails:21,activityDataForLmsIntegration:22,audienceBackgroundScenes:25,audienceSceneDefinition:25,authenticationUsers:26,authenticatedUser:26,authenticationToken:26,authConsent:26,hostMachineUsers:26,tenantData:26,userAuthState:26,userRelations:26,broadcastAttendeeMeeting:27,broadcast:27,broadcastCaptions:27,teamCalendarEventByUid:28,teamCalendarEvents:28,meetingRecommendedFiles:28,calendarEventsCacheV2:28,calendarViewV2_1:28,calendarEventByUid:28,buildings:28,rooms:28,userTimeZoneSettings:28,callRecordingsInfo:29,blockedPstnContacts:30,messageDraft:31,messageDraftsIndex:31,tflTwoWaySmsProfiles:31,giphys:31,searchEmoticons:31,emoticonCategories:31,pinnedSkinTone:31,downloadAmsItem:31,constructAmsUrl:31,downloadImageItemUsingProxy:31,getUrlReputationRest:31,safelinksGetPolicy:31,offlineAssetBlobUrl:31,supportedTranslationLanguages:31,optionalTelemetry:31,streamCameraRecorderInUseStatus:31,onePlayerSettings:31,community:32,communityDetailsByJoinLink:32,experienceAccountMode:33,clientAccessAllowedByAdminPolicy:33,isDiagnosticDataViewerEnabled:34,filePermission:35,filePermissionWarning:35,currentFiles:35,parseFileLabelFromUrl:35,fileDetailsForChiclet:35,filesValidDomains:35,redeemFile:35,fileDownloadDetailsUsingItemDetailsService:35,fileDownloadDetailsUsingLegacyVroomService:35,redeemFileById:35,getFileDetailsForPptSharing:35,fileDetailsForThumbnail:35,fileDetailsWithSharepointId:35,getPersonalSiteInfoForUpload:35,shareDialogAudience:35,fetchVideoInfo:35,getFileSharingInformation:35,videoFileStatus:35,videoMessageCaptionStatus:35,getFileSharingInformationFromUrl:35,getFileAttachSuggestions:35,cloudStorageFolders:35,floodgateDaysUsedMoreThan:36,floodgateSurveyContext:36,floodgateActiveSurvey:36,liveStreamCaptionsCultures:37,liveStreamDiagnosticData:37,liveStreamIsAvailable:37,liveStreamIsStreaming:37,liveStreamIsActive:37,liveStreamIsRendering:37,liveStreamIdMetadata:37,liveStreamCaptionsState:37,teamsForCourse:38,courseMembersAndOwners:38,meetingArtifacts:41,allMeetingArtifacts:41,allMeetingArtifactsBatch:41,readAndOptionallyReserveMeetingArtifact:41,reserveMeetingArtifact:41,chaptersOfRecording:43,atMentionsFromTranscript:43,searchForMention:44,searchForMentionV2:44,retrieveRegionalEndpoint:44,isGlobalNotificationSettingsDisabled:45,paymentProviders:46,currencies:46,products:46,paymentDetails:46,settingsListItems:47,emailMessagePreview:48,checkCloudFilesStatus:48,recentShareToTeamsRecipients:48,shareToTeamsDesktopUpsellDisplayedStatus:48,survey:50,instantAnswers:50,teams:51,teamsLocal:51,tenantPrivacyUrl:52,notice:53,urlPreview:54,richUrlPreview:54,virtualEvent:55,virtualEvents:55,virtualEventMe:55,virtualEventSession:55,virtualEventSessions:55,virtualEventSpeaker:55,virtualEventSpeakers:55,virtualEventSponsor:55,virtualEventSponsors:55,virtualEventRegistration:55,virtualEventAttendees:55,virtualEventEmailTemplate:55,virtualEventEmailTemplates:55,voicemailAudio:56,voicemails:56,webinar:57,webinarImage:57,userMailboxSettings:58,teamCalendarEvent:58,teamCalendarEventsV2:58,multiCalendarEvents:58,calendarLeftRailSettings:58,calendarEventsV3:58,calendarEventsV3WithPagination:58,calendarEvent:58,calendarEventV2:58,calendarEventMasterCategories:58,refreshCalendarSurface:58,callQueueSettings:59,callQueueAgentOboAccounts:59,callQueues:59,sharedMailIdForGroupId:59,callQueueConfigurationSummary:59,authorizedConfigurations:59,replyChainSummaries:62,replyChainMessages:62,channelDrillDownHeaderBaseData:62,pinnedPostsSummaries:62,channelModerationByID:62,crossPostChannelIds:62,messages:64,message:64,previousNextChats:64,chats:64,pinnedChats:64,recentsChats:64,suggestedContactsInChatList:64,chat:64,chatAwait:64,chatMembers:64,chatsByTitle:64,chatWithUser:64,defaultChat:64,newChatIntentId:64,membersConsumptionHorizon:64,chatsWithUsers:64,chatsWithGuardians:64,badgeCounts:64,searchUsersByConversation:64,messageAnnotations:64,translationSuggestionRequired:64,lastTranslationSuggestion:64,typingUsers:64,chatFilesSuggestions:64,chatSummarization:64,chatScheduleSuggestion:64,closedCaptionsSettings:65,coachArtifactsByThreadId:66,coachArtifact:66,fluidCollabTenantInfo:67,fluidContainerId:67,fluidToken:67,ntpTime:67,clientRoles:67,communities:68,connectedCalendarSettings:70,syncConnectedCalendarSettings:70,connectorProfile:71,suggestedContacts:72,contactsSyncSettings:74,crossTenantPolicies:76,feed:79,panelActive:79,showDiscoverSurfaceModal:79,lastViewedPostInL1View:79,transitiveMembersCountForDistributionList:80,transitiveMembersForDistributionList:80,transitiveMembersForDistributionLists:80,getWebinarLinkDetails:81,virtualEventsOrgDetails:81,espState:82,irisCampaign:82,getEspSurfaceDisplayStatus:83,getExternalAccounts:85,externalAccountsResponse:86,oneDriveDetails:89,getPersonalSiteInfoFromUserPreferenceStore:89,fileDetails:90,fluidSharepointInfo:90,getSpecialFolder:90,getFluidSPOEnabled:90,getPermissions:90,checkUserAccess:90,mediaFiles:91,membersAndRelatedContacts:92,relatedContacts:92,teacherAnnouncementsChat:92,guardiansAnnouncementsOffNetworkCount:92,hostUpdateState:93,hostUpdaterAvailable:93,immersiveReaderAuthToken:95,implicitSuggestions:96,implicitSuggestionsSource:96,fetchMsaContacts:97,chatInviteLink:98,userInviteLink:98,getPhoneNumbers:98,userContactSyncClaimToken:98,getLiveStateAuth:99,getLiveStateRegionalUrl:99,allClientPreferences:100,clientPreferences:100,userExperiencePreferences:100,localizationSettings:101,lokiConfig:102,m365Link:103,getTenantAdmins:104,getJoinTenantUrl:104,aadDomain:104,meetForWorkInsights:105,meetForWorkUserSetting:105,meetingActionItems:106,meetingAIInsightsNotes:106,meetingArtifactsByThreadId:106,meetingArtifact:106,attendanceReport:106,attendanceReportFromMeetingIntelligenceService:106,meetingThreadProperties:107,meetingRecaps:107,meetingRecapCatchupItems:107,meetingRecapTopics:107,meetingRecapTranscriptMetadata:107,meetingRecapOnePlayerMetadata:107,meetingInstances:107,currentDefaultSensitivityLabelId:108,getMeetingOptions:108,getMeetingOptionsByCode:108,meetingOptionsForMeetingCreation:108,meetingOptionsForMeetingEdit:108,meetingSummaryQuestionsAndAnswersHistory:109,meetingTemplateDescriptions:110,meshSpaces:112,missedMTMANotificationsBadge:114,mostRecentlyUsedFiles:115,getAccessToken:116,bannerNotificationQueue:117,toastNotificationQueue:117,osfileshare:119,pstnUser:121,getCacheResults:121,people:121,searchUsers:121,searchUsersWithGroupChats:121,searchSuggestionsForPeoplePicker:121,warmupPeopleSubstrateSearch:121,zeroStateSuggestions:121,tflZeroStateSuggestions:121,membersOfTag:122,tagCard:122,tagsForTeamMembers:122,allTeamsTagCards:122,teamsTagCardsByTeamIds:122,teamTagCardsWithSettings:122,teamTagSettings:122,tenantTagSettings:122,deletedTags:122,tagsEnabled:122,platformTab:124,platformTabs:124,platformTabsV2:124,recentPlatformTabs:124,policies:126,presence:127,presences:127,outOfOfficeSettings:127,blockedContacts:128,priorityContacts:128,pstnAssignment:129,replyChains:130,replyChain:130,getTeamForFile:131,parentPostTeamAndChannel:131,buildChatTitle:131,searchMessages:131,searchMessagesPrefetcher:131,searchAllData:131,searchAllDataPrefetcher:131,searchFiles:131,osearchFiles:131,searchMeetings:131,metaPreview:131,searchOdcFilePreview:131,searchReplyChain:131,searchReplyChainFromPost:131,channelPost:131,searchPeople:131,searchEmails:131,searchPreTrigger:131,searchConversation:132,searchMeetingSummary:133,searchPrefetchConfigs:134,getSearchSuggestionResults:136,searchBoxFetchSuggestions:136,sensitivityLabelById:137,sensitivityLabelPolicySettings:137,defaultSensitivityLabel:137,sensitivityLabelsInLocalCache:137,searchSuggestionsForShareToTeams:138,windowState:139,zoomState:139,customFrameRenderingButtons:139,backdropEffectState:139,pearInstallState:139,isPearEnabled:139,waffleAppUrls:139,smbUserIntent:140,smbUserIntentLocal:140,storeCollection:141,storeCollectionList:141,storeCollectionItemList:141,storeHeroItemList:141,storeSearchItems:141,storeExtendedSearchItems:141,storeSuggestItems:141,storeItemsDetail:141,storeHeroItemsDetail:141,storeSearchItemsLegacy:141,storeArticles:141,init3S:142,suggestions:142,systemSettings:143,hierarchyNodeCharacteristics:144,hierarchyNodeDescendantsCount:144,hierarchyNodeChildren:144,recommendedTeams:146,discoverableTeams:146,joinedTeams:148,joinedTeamsWithActivityCounts:148,defaultChannel:148,pinnedChannels:148,teamLevelApps:148,team:148,teamWithMockData:148,canCreateTWT:149,joinedTeamsAndChannels:149,channelByID:149,channelsByIds:149,myGroupSettings:149,sensitivityLabels:149,sensitivityLabelByTeamId:149,sensitivityPolicySettings:149,sharedWithTeamInvitations:149,gridViewSections:149,teamByGroupId:149,teamTemplatesSummary:149,teamTemplate:149,lockedTeamsPendingMemberCount:149,lockedTeamsPendingMembers:149,joinRequests:149,threadMembersByRole:149,searchThreadMembers:149,deletedChannels:149,sharedChannelInvitations:149,getRecommendedTeams:149,searchRecommendedTeams:149,tenantMetadata:149,channelsByTeamId:149,teamsMeetingConfiguration:150,metricPerTeam:151,metricPerChannel:151,metricCrossTeam:151,getInviteErrorMessageFromErrorCode:152,meetingLinks:153,getConnectedCalendarSettings:155,thirdPartyCalendar:155,toastImageAsDataUri:156,hasMeetingArtifactsTranscript:157,getAssociatedMeetingArtifactsTranscripts:157,getMeetingArtifactsTranscript:157,getMeetingArtifactsTranscriptAcl:157,userTranscriptMeetingSettings:159,smisAttributionSetting:159,contentTranslation:160,consentState:161,me:163,userLicenseDetails:163,user:163,userFromEmail:163,users:163,getUsers:163,msaMeProfile:163,ephemeralMsaMeProfile:163,consumerLicenseDetails:164,userPreferences:165,userPreferencesForCategory:165,noop:166,node:166,oneGql_person:166,oneGql_personByEmail:166,vivaInsightsStatus:167,whatsNewState:168,annotationImage:170,annotationClickThroughStart:170,annotationClickThroughStop:170,appDevicePermission:170,callingServiceState:170,favoritePhoneNumbers:170,isStandardFormatNormalized:170,parsedAndFormattedNumber:170,botSsoConsentRequest:170,getBatchUserPresence:170,getUsersForConversation:170,getUsersFromCallingRoster:170,vdiCapabilities:170,smsUsersForConversation:170,isBlockedContact:170,contactBlockedStatusExtended:170,isVideoExtensibilityEnabled:170,messagesWithUnreadActivities:170,devicePermission:170,suggestedUsers:170,suggestedTransferTargets:170,teamsCallIdByCallId:170,callParticipantsForScope:170,conversationForCall:170,callScreenPreviews:170,callPptFiles1:170,callInvisionWhiteboardSharingSources:170,getInvisionWhiteboard:170,instantScdSearch:170,streamPermissions:170,overflowRoomId:170,meetingRoomBroadcast:170,getMeetingNotes:170,meetingInfoFromExchange:170,hasVideoOwnership:170,channelSiteInfo:170,sharepointIds:170,suggestedRooms:170,autoMuteChatAlertBannerDismissed:170,callTranscriptData:170,callTranscriptDataByUrl:170,isAttendanceReportEnabledInRoster:170,isAttendanceReportAvailableAfterCallEnded:170,biometricEnrollmentEnabled:170,biometricEnrollmentStatus:170,isPnsEnabledAndSupported:170,isWhiteboardDeviceCapableOf:170,isSpatialAudioOn:170,isWhiteboardVideoEffectOn:170,isCommunicationDisabledByExtendedDirectoryPolicy:170,videoEffects:170,meetingBrandingLogoUrl:170,composerStream:170,isTenantVerifiedDomain:170,tenantPrivacyPolicyStatement:170,searchFederatedUsers:170,searchFederatedUsersTfl:170,searchFederatedUsersByMri:170,searchXtapUser:170,batchUsersByEmailsAndPhones:170,messageUniqueIdentifier:170,buddyGroup:170,buddyGroups:170,callingPerformanceScenarioId:170,biometricEnrollmentPrivacyLink:170,scdImageData:170,dialpadSuggestedUsers:170,validateUpgradePolicyOfChatRecipient:170,systemAudioDriverState:170,breakoutRoom:170,listBreakoutRooms:170,participantsForBreakoutRoomsAssignment:170,maxNumberOfVideoStreams:170,msaUserProfilePicture:170,msaGroupProfilePicture:170,joinTenantUrl:170,pptSharingTelemetry:170,joinLink:170,messageLanguages:170,getTranscriptAcl:170,hasVideoBackgroundEffect:170,autoFramingVideoSetting:170,calendarEvents:170,openInDesktopAsDeviceSpecificFileOpenPreference:170,environmentSupport:170,liveStreamState:170,virtualDesktopInfrastructureConnectedState:170,videoEffectApplyingState:170,getGestureBasedReactionOption:170,unifiedWebinar:170,appDevicePermissions:170,teamsWithActivityCountsAndMentions:170,hideMeetingNames:170,windowOcclusionTrackingStatus:170,meetingRoomCalendarSettings:170,meetingRoomPendingMeetingJoinErrorAlert:170},Mutation:{setKeyProxyCookiesForStreamingAttendee:0,toggleHideMyselfVideo:1,toggleMyselfInGrid:1,togglePinMyself:1,callMeBackWithResult:1,updateCallRedirectionSettings:1,updateVoicemailSettings:1,updateUserDelegates:1,passGetUserMediaWithoutMedia:1,cleanupGetUserMediaModal:1,updateBlockOutgoingCallerID:1,setIgnoreMirroring:1,toggleE2EECall:1,toggleTTYSetting:1,mergeCalls:1,updateSelfExplicitRecordingConsentState:1,startPstnCall:1,turnOffCallGroupNotification:1,dismissParkedCallById:1,parkCall:1,unparkCall:1,unparkCallById:1,transferCall:1,setMutedLobbyDialogForCall:1,startConsultation:1,transferCallConsultation:1,transferUserConsultation:1,selectAudienceSceneAndAssignSeats:1,addAudienceBotDataChannel:1,startBotView:1,callingRosterAddARoom:1,addParticipant1:1,stopCall:1,startCall:1,startSharing:1,stopSharing:1,startWhiteboardSharing:1,changeWhiteboardUrl:1,changeFileUserPermissions:1,postFluidWhiteboard:1,startCallAppContentSharing:1,stopWhiteboardSharing:1,stopCallAppContentSharing:1,stopMdpDataCollection:1,disableCallForwarding:1,changeCallForwardingTargetTo:1,changeRingtoneSettings:1,playAudioFile:1,pauseAudioFile:1,changeImmersiveViewStatus:1,addScreenRecordingDisabledAlert:1,downloadVideoBackgroundImage:1,uploadVideoBackgroundImage:1,deleteVideoBackgroundImage:1,toggleIncomingVideo:1,toggleMute:1,toggleMuteWithState:1,toggleVideo:1,fireCallingIntent:1,navigateToMainWindow:1,saveEmergencyAddress:1,saveEmergencyLocation:1,removeCustomEmergencyAddress:1,setUserAgreementEmergencyCustomDisclaimer:1,setInterpretationGroup:1,updateParticipantInterpretationState:1,startOrContinueInstantMeeting:1,resolveCallingAppEvent:1,removeParticipant1:1,denyParticipant:1,promoteAttendeeToPresenter:1,demotePresenterToAttendee:1,admitParticipant1:1,admitAllParticipants1:1,muteParticipant1:1,toggleParticipantRoomView:1,muteAllParticipants1:1,renameParticipant:1,spotlightParticipant:1,stopSpotlightOnParticipant:1,stopSpotlight:1,bringOnStage:1,removeFromStage:1,createOrGetInstantMeetingInfo:1,applyVideoBackgroundEffects:1,joinCallFromIntent:1,rejoinCall:1,cancelRetry:1,notifyCallingViewportCreation:1,notifyCallingWindowingContainerUpdate:1,endCallingIntent:1,updateExternalCallMonitorVisibility:1,sendDtmf:1,submitCallFeedback:1,cancelCallFeedback:1,callFeedbackRendered:1,toggleHoldCall:1,dismissAlert:1,actionOnAlert:1,createCompositorV2:1,disposeCompositor:1,updateCompositorLayout:1,updateCallRefreshSettings:1,updateMeetNowTitle:1,videoSizeChanged:1,setTextureSharingSupported:1,setMaxVideoChannels:1,setStreamItemsCountOnStage:1,updateStreams:1,toggleVideoStreamFocus:1,stopStream:1,stopStream1:1,setVideosSizeAndPreference:1,setVideoPreference:1,acknowledgeFirstFrame:1,devicePermission:1,toggleVideoWithState:1,sendCallingDataToTelemetry:1,startRecording:1,startLocalRecording:1,stopRecording:1,stopLocalRecording:1,startRecordingAndTranscript:1,stopRecordingAndTranscript:1,startTranscript:1,stopTranscript:1,stopVideoForAllCalls:1,makeTranscriptEdit:1,startStream1:1,startStream:1,openFeedbackDialog:1,openMeetingRoomCortana:1,initCallingService:1,disposeCallingService:1,toggleRemotePtzCamera:1,toggleCortana:1,toggleMeetingRoomInMeetingSpeakerAttribution:1,toggleMeetingRoomInMeetingFaceAttribution:1,toggleMeetingRoomInMeetingPeopleFeed:1,toggleHighFidelityAudio:1,toggleMusicModeSettings:1,triggerCallingToastAction:1,selectDevice:1,selectAudioDevice:1,setSpeakerVolume:1,tryToggleIncludeSystemAudio:1,startSystemAudioSharing:1,stopSystemAudioSharing:1,toggleMuteSpeaker:1,toggleRaiseHands:1,toggleRoomRemote:1,toggleAutoGainControl:1,saveGeneratedBackgroundImage:1,captureVideoFrame:1,updateNoiseSuppression:1,lowerOtherParticipantsHand:1,lowerAllRaisedHands:1,startPreview:1,stopPreview:1,toggleTogetherModePinning:1,startCoach:1,stopCoach:1,startClosedCaptions:1,stopClosedCaptions:1,setClosedCaptionsLanguage:1,setClosedCaptionsTextTrack:1,requestClosedCaptionSubtitle:1,newCallingScenario:1,markCallingScenario:1,stopCallingScenario:1,failCallingScenario:1,cancelCallingScenario:1,incompleteCallingScenario:1,updateCallingScenarioEventData:1,pauseCallingScenario:1,resumeCallingScenario:1,screenSharingAcceptControlRequest:1,screenSharingDenyControlRequest:1,screenSharingRequestControl:1,screenSharingReleaseControl:1,screenSharingGiveControlRequest:1,screenSharingTerminateControlRequest:1,registerControlEvents:1,unregisterControlEvents:1,setAplCustomLayout:1,triggerBannerAction:1,triggerDialogAction:1,openSettingsPane:1,toggleVideoEffectV2:1,setTouchUpVideoEffect:1,setWindowsEffectsState:1,updateCustomLayoutSelection:1,setSpatialAudio:1,updateSpatialAudioStageConfig:1,updateSpatialAudioSubStageConfig:1,updateSpatialAudioParticipantsPosition:1,toggleAudioPipeline:1,endRoomRemoteSession:1,createRoomRemoteSession:1,sendCommandToMeetingRoom:1,startFileSharing1:1,handlePresentDeepLink:1,callPptSharingChangeSlide:1,callPptSharingMediaEventUpdate:1,callPptSharingUpdatePresentationUrl:1,callPptSharingTakeControl:1,callPptSharingUpdateSlidesCount:1,callPptSharingUpdateLayout:1,callPptSharingUpdateCameoState:1,callPptSharingTogglePrivateViewing:1,callPptSharingStopContentSharing:1,setAvatarModeState:1,setIsAvatarAppAvailable:1,startHolographicInteraction:1,startHolographicFreezeFrameInteraction:1,stopHolographicInteraction2:1,stopHolographicFreezeFrameInteraction:1,updateHolographicViewingParticipant:1,updateImmersiveViewParticipantWithMeshTag:1,placeHolographicAnnotation:1,continueHolographicInking:1,stopHolographicInking:1,deleteCallHistoryLog:1,deleteHolographicAnnotations:1,recoverHolographicAnnotations:1,clearAllHolographicAnnotations:1,setHolographicToolbarVisibility:1,setHolographicToolbarAvailability:1,clearCallParticipantRestriction:1,updateCallParticipantRestrictions:1,updateAttendeeRestrictions:1,sendThirdPartyDevicePairingResponse:1,updateIgnoreMirroringVideoPreferenceSetting:1,requestAppAudioHandling:1,setBusyOnBusySetting:1,joinCallByInvitationContent:1,setBrowserPopoutUserPreference:1,updateSecondaryRingerDevice:1,enableVideoExtensibility:1,disableVideoExtensibility:1,closeVideoExtensibility:1,deleteActivityFeedItem:2,updateActivityThreadId:2,toggleActivityRead:3,clearBellCount:3,updateActivitySettings:4,submitAiInsightsFeedback:6,createAiInsightsCollection:7,createAiInsightsCollectionItem:7,updateAiInsightsCollectionItem:7,firstCreateAiInsightsCollectionItem:7,resolveAppDevicePermission:8,postAppReview:9,updateAppReview:9,deleteAppReview:9,markAppReviewHelpful:9,reportAppReview:9,postAppReviewComment:9,updateAppReviewComment:9,deleteAppReviewComment:9,installApp:13,upgradeApp:13,installCustomApp:13,installSideLoadApp:13,installTrustedSideLoadApp:13,deleteApp:13,createUserAppRequest:13,pinMessageExtensionV2:13,pinMessageExtension:13,unpinMessageExtensionV2:13,unpinMessageExtension:13,deleteStagedApp:13,uploadStagedApp:13,recordAppActionUsage:13,recordAppUsage:13,recordAppSceneUsage:13,recordAppImpression:13,outgoingWebhook:13,startVoiceCaptureBiometricEnrollment:17,stopVoiceCaptureBiometricEnrollment:17,cancelVoiceBiometricEnrollment:17,startFaceCaptureBiometricEnrollment:17,cancelFaceCaptureBiometricEnrollment:17,finishFaceCaptureBiometricEnrollment:17,sendInvoke:18,sendExecuteInvoke:18,submitTab:18,cardCacheOperation:18,postFileUploadInfoAndUserConsent:18,updateSettingsMessageExtension:18,verifyCardSignInState:18,tokenExchangeInvoke:18,submitO365Action:18,connectorHttpPostAction:18,submitTaskMessageExtension:18,submitBotConfig:18,submitTaskModule:18,submitTaskAdaptiveCardTab:18,cardCacheOperationV2:19,createBrbItem:20,addBreakoutRoom:21,deleteAllBreakoutRooms:21,updateBreakoutRoomInfo:21,deleteBreakoutRoom:21,createBreakoutRoomsWithDetails:21,updateBreakoutRooms:21,updateBreakoutRoomSettings:21,breakoutRoomBulkMoveAction:21,takeControlToManageBreakoutRooms:21,setBreakoutRoomsInMeetingEnabled:21,openBreakoutRooms:21,closeBreakoutRooms:21,sendBreakoutRoomAnnouncementAlert:21,activateBreakoutRoomAlert:21,goToMainMeetingFromBreakoutRoom:21,goToBreakoutRoomFromMainMeeting:21,moveToNewMeeting:21,askToJoinBreakoutRoom:21,uploadAmsItem:23,authenticateUser:26,loginUser:26,authenticationLogout:26,reauthenticateUser:26,resolveThirdPartyOauthCode:26,initializeAccounts:26,switchAccount:26,refreshTenants:26,authenticateOrGetUser:26,updateTenants:26,startLiveStreamCaptions:27,stopLiveStreamCaptions:27,toggleLiveStreamCaptionButton:27,subscribeToBroadcastUpdates:27,unsubscribeFromBroadcastUpdates:27,meetingRecommendationSearchFeedbackResponse:28,forwardCalendarEvent:28,addToMyCalendar:28,forwardTeamEvent:28,suggestedTime:28,patchCalendarEvent:28,createSchedulingServiceEvent:28,deleteSchedulingServiceEvent:28,unhidePrivateMeetingConversation:28,publishFormCacheSyncEvent:28,publishFormLoadingSpinnerEvent:28,publishCalendarToggleTabEvent:28,publishFormShareDialogEvent:28,publishFormErrorEvent:28,blockOrUnblockPstnContact:30,saveMessageDraft:31,removeMessageDraft:31,transferMessageDraft:31,tflTwoWaySmsSaveProfile:31,tflTwoWaySmsRemoveProfiles:31,translateMessage:31,requestMessageTranslations:31,updateMessageTranslationStatus:31,translateChannelMessage:31,addOfflineAsset:31,removeOfflineAsset:31,setPinnedSkinTone:31,addEmoticonToRecentsByEmoticonID:31,addVideoMessageBlobsAsOfflineAsset:31,runVideoMessageBlobsGC:31,updateStreamCameraRecorderInUseStatus:31,updateOnePlayerSettings:31,sendLinkClickedSignal:31,communitiesReportConcern:32,acceptCommunitiesInvitation:32,createCommunity:32,requestToJoinCommunity:32,inviteUsersToCommunity:32,sendMessageEmailToMembers:32,removeAuthenticatedUser:33,rebootApp:33,setDiagnosticDataViewerEnabled:34,submitDiagnosticDataViewerConnectionString:34,provisionPersonalSharepointSite:35,backfillThreadPropertiesWithSpoIDs:35,uploadFile:35,uploadItems:35,cancelUpload:35,deleteAttachedFile:35,refreshSiteUrl:35,createShareLinkInvite:35,createFilesShareLink:35,removeFileFromSharePoint:35,attachFiles:35,downloadFile:35,bootstrapFloodgate:36,floodgateLogActivity:36,floodgateLogActivityStartTime:36,floodgateLogActivityStopTime:36,onCVSurveyEvent:36,floodgateUpdateUserSurveyNotificationEnabled:36,addLiveStreamCues:37,clearLiveStreamCues:37,showLiveStreamCaptions:37,startLiveStream:37,stopLiveStream:37,setLiveStreamOptions:37,setLiveStreamCaptionsData:37,toggleLiveStreamCaptions:37,setLiveStreamSubtitleTrack:37,downloadLogsFiles:39,addMeetingArtifacts:41,commitMeetingArtifact:41,updateMeetingArtifacts:41,createPaymentDetails:46,updatePaymentDetails:46,sendEmailMessage:48,saveShareToTeamsRecipient:48,deleteShareToOutlookEmailDraft:48,setShareToTeamsDesktopUpsellIsDisplayedStatus:48,generateStyledBackgroundImage:49,submitTranslationFeedback:50,submitSurvey:50,sendInstantAnswersTelemetryIsInsightUseful:50,sendInstantAnswersTelemetryDwellTime:50,sendSmartRepliesOCVFeedback:50,sendSuggestedScheduleMessageDeliveryOCVFeedback:50,createVirtualEvent:55,updateVirtualEvent:55,cancelVirtualEvent:55,addVirtualEventSpeaker:55,updateVirtualEventSpeaker:55,deleteVirtualEventSpeaker:55,addVirtualEventSpeakerImage:55,updateVirtualEventSpeakerImage:55,deleteVirtualEventSpeakerImage:55,addVirtualEventSponsor:55,updateVirtualEventSponsor:55,deleteVirtualEventSponsor:55,addVirtualEventSession:55,updateVirtualEventSession:55,deleteVirtualEventSession:55,addVirtualEventSessionRecordingFromArtifact:55,addVirtualEventSessionRecordingFromOdsp:55,updateVirtualEventSessionRecording:55,deleteVirtualEventSessionRecording:55,downloadVirtualEventRecording:55,updateVirtualEventRegistration:55,updateVirtualEventTheme:55,updateVirtualEventPromoImage:55,updateVirtualEventLogoImage:55,managePendingApprovals:55,updateVirtualEventEmailTemplate:55,markReadUnread:56,deleteVoicemail:56,saveWebinar:57,submitAttendeeRegistration:57,cancelAttendeeRegistration:57,createWebinar:57,deleteWebinar:57,sendUpdateEmail:57,saveWebinarImage:57,increaseWebinarPageViewCount:57,registerConsentForD365Link:57,setPrivacyLink:57,addVirtualEventId:57,importCalendarEvent:58,updateMeetingResponse:58,updateMeetingResponseV2:58,deleteCalendarEvent:58,deleteCalendarEventV2:58,cancelCalendarEvent:58,cancelCalendarEventV2:58,updateCalendarLeftRailSettings:58,cancelTeamEvent:58,cancelTeamEventV2:58,updateAttendeeEvent:58,updateAttendeeEventV2:58,createOrUpdateCalendarEvent:58,createOrUpdateCalendarEventV2:58,createOrUpdateTeamEvent:58,createOrUpdateTeamEventV2:58,updatePartialEvent:58,deleteCalendarEventsCache:58,notifyCalendarScenarioStatusToHost:58,inviteOffNetworkUsers:58,toggleCallableQueueOptInStatus:59,revertEditFailure:62,pinUnpinPost:62,clearDeleteFailureForMessage:62,setReplyChainConsumptionHorizon:62,setReplyChainTitle:62,deleteCrossPostAll:62,deleteCrossPostSingle:62,retryCrossPost:62,clearCrossPostFailure:62,updateCrossPostSelectedChannelIds:62,createChannel:63,updateChannel:63,reportMessage:64,submitReport:64,sendFeedback:64,sendMessage:64,sendMessageWorker:64,sendTypingIndicator:64,createChat:64,createNewChat:64,setMuteChat:64,setThreadPropertyMeeting:64,setThreadPropertyLiveness:64,addMembersToConversation:64,inviteMembersToConversation:64,registerBadgeCounts:64,removeMemberFromConversation:64,updateMessageEmotion:64,ackUrgentMessage:64,setConsumptionHorizon:64,leaveChat:64,setConsumptionHorizonBookmark:64,setChatPinned:64,discardDraftChat:64,setChatVisibility:64,deleteChat:64,setConversationTitle:64,reorderPinnedChats:64,saveMessage:64,unsaveMessage:64,deleteDraftMessage:64,deleteMessage:64,undeleteMessage:64,updateMessageLinks:64,setPinnedItemsThreadProperty:64,setPinnedItemsConversationProperty:64,reportOffensiveMessage:64,updateMessageTranslation:64,updateChannelsMessageTranslation:64,chatScheduleSuggestionNudgeAcknowledge:64,chatScheduleSuggestionSuppress:64,updateClosedCaptionsSettings:65,deleteCoachArtifact:66,registerClientId:67,setFluidContainerId:67,detectComposeLanguage:69,setComposeLanguage:69,switchSpellCheckLanguage:69,publishConnectedCalendarSetting:70,deleteConnectedCalendarSetting:70,invokeUserActionOnContactsSyncBanner:73,publishContactsSyncSettings:74,deleteContactsSyncSettings:74,addDesktopClientShortcut:77,switchRing:78,clearContainer:78,switchService:78,feedback:79,removeHasUpdatedItemsFlag:79,discoverSurfaceUserPreferenceForEntities:79,recordEligibleSurface:82,recordDisplayedSurface:82,recordEspCompletedActions:82,triggerNotificationDisplay:82,resolveEspSelector:83,activateEspTarget:83,deactivateEspTarget:83,registerEspTarget:83,unregisterEspTarget:83,updateEspSurfaceDisplayStatus:83,increment:84,addExternalAccount:85,removeExternalAccount:85,unlinkExternalAccount:85,refreshExternalAccount:85,setExternalCalendarEmailAddress:87,addToFavorite:88,deleteFile:90,createShareLink:90,deleteShareLink:90,odspAtMention:90,renameFile:90,grantUserPermissions:90,createTeacherAnnouncementsChat:92,retrySendGuardiansAnnouncement:92,tryInstallUpdate:93,initService:96,disableChatInviteLink:98,enableChatInviteLink:98,enableCommunitiesInviteLink:98,redeemClaimInviteLink:98,redeemInviteLink:98,initiateAutoClaimVerification:98,confirmAutoClaimVerification:98,sendMeetingReactionLiveState:99,sendMeetingNotesLiveState:99,updateClientPreferences:100,updateUserExperiencePreferences:100,clearUserExperiencePreferences:100,clearUserExperiencePreferencesByCategory:100,updateCurrentLocale:101,updateMeetForWorkUserSetting:105,downloadAttendanceReportFromType:106,deleteAttendanceReportFromType:106,downloadLocalReport:106,downloadAttendanceReportFromMeetingIntelligenceService:106,updateMeetingOptionsSensitivityLabelForCreate:108,updateMeetingOptionsSensitivityLabelForEdit:108,setCurrentDefaultSensitivityLabelId:108,setMeetingOptions:108,setMeetingOptionsByCode:108,updateLocalMeetingOptions:108,updateLocalMeetingOptionsForEdit:108,updateLocalMeetingOptionsToSS:108,updateLocalEditMeetingOptionsToSS:108,updateLocalMeetingOptionsInvitees:108,requestMuteInApp:111,setIsMutedInApp:111,addUpdateMostFrequentlyUsedContact:113,addTagsToMembersOfTeam:122,deleteTagsFromMembersOfTeam:122,updateTeamTag:122,updateTeamTagSettings:122,deleteTag:122,restoreTag:122,pairWithPhonelink:123,executeDeepLink:124,updatePlatformTab:124,createPlatformTab:124,removePlatformTab:124,migrateLegacyPlatformTab:124,addPlatformCachedApps:124,removePlatformCachedApps:124,updatePlatformCachedApps:124,sendExternalAuthDeeplink:124,sendTswSdkMessage:124,updateShareFormStatus:125,updatePlatformTabsNavigationEvent:125,sendRegisterBackButtonSignalV2:125,pollSettingsOnDemand:126,updatePoliciesInCache:126,setPresence:127,setStatusNote:127,setCallStatePresence:127,setOutOfOffice:127,blockOrUnblockUser:128,removePriorityContact:128,addPriorityContact:128,sendSearchActionsInstrumentation:131,sendSearchEntityActionsInstrumentation:131,sendSearchResultsRenderedInstrumentation:131,sendSearchClientLayoutInstrumentation:131,pingSearch:131,sendClientDataSourceInstrumentation:131,sendResponseReceivedInstrumentation:131,sendSubstrateMeetingSummaryInstrumentation:133,initSubstrateSearch:135,sendSearchActions3SInstrumentation:135,sendSearchEntityActions3SInstrumentation:135,sendSearchResultsRendered3SInstrumentation:135,sendSearchClientLayout3SInstrumentation:135,editSearchHistory:136,setHostTheme:139,setWindowBounds:139,sendIntentSignal:140,toggleSetting:143,joinTeam:146,joinTeamByCode:146,updateTeamSetting:147,updateTeamDiscoverability:147,resetTeamJoinCode:147,removeTeamJoinCode:147,renewTeam:147,archiveTeam:149,unArchiveTeam:149,checkWorkFlowStatus:149,acceptInvitationByInvitee:149,createTeam:149,declineInvitationByInvitee:149,deleteInvitationByInvitee:149,deleteShareWithTeamInvitationForChannel:149,approveSharedChannelInvitation:149,denySharedChannelInvitation:149,editTeam:149,leaveChannel:149,restoreChannel:149,setChannelShowForMember:149,showChannel:149,showTeam:149,updateGridViewSection:149,validateTeamName:149,createTeamFromTemplate:149,setCollapsedConversationPropertyV2:149,handleBulkJoinRequests:149,handleJoinRequest:149,sponsorJoinRequest:149,unlockTeam:149,setPinConversationProperty:149,setThreadPropertyChannelSettings:149,setChannelSpaceAdminSettings:149,updateChannelEmailSettings:149,removeChannelEmailSettings:149,removeThreadMembership:149,updateChannelNotificationSettings:149,updatePinnedChannelsOrder:149,stopSharingChannelWithTeam:149,addThreadMembership:149,updateThreadMembership:149,joinTeamById:149,joinTeamWithCode:149,cancelJoinRequest:149,inviteMembersToTenant:152,updateMeetingLinks:153,setCurrentUserIsTFLUser:154,addThirdPartyCalendar:155,removeThirdPartyCalendar:155,reconnectThirdPartyCalendar:155,hardDeleteThirdPartyCalendar:155,deleteMeetingArtifactsTranscript:157,downloadMeetingArtifactsTranscript:157,editMeetingArtifactsTranscript:157,submitTranscriptFeedback:158,updateUserTranscriptMeetingSettings:159,migrateSmisServiceAttributionSettings:159,updateTranslationSettings:160,updateClientStateVeryActive:162,updateMSAMeSearchability:163,updateMsaMeAliasVisibility:163,updateMsaUserName:163,createMsaMeProfileAndStampAliases:163,updateMsaProfileAvatar:163,removeProfilePicture:163,updateUserPreferences:165,noop:166,createContact:166,updateContact:166,setPresenceAvailability:166,setPresenceStatusNote:166,schedulePresenceOutOfOffice:166,recordWhatsNewDisplayedFeature:168,recordWhatsNewEntryPointPromotion:168,recordWhatsNewEntryPointUserAction:168,turnOnCallGroupNotification:170,clearBotSsoConsentRequest:170,createBuddyGroupDialog:170,renameBuddyGroupDialog:170,deleteBuddyGroupDialog:170,addFavoritePhoneNumber:170,callMeBack:170,messageListRendered:170,storeAnonymousUsers:170,smartDeviceLogOut:170,smartDeviceQuickFeedback:170,altScenario:170,createMeetingNotes:170,updateAttendeeTranscription:170,acceptBlockSfCChat:170,contactAcceptOrBlockExtended:170,addBlockedMri:170,deleteBlockedMri:170,rejectCall:170,cancelCallParticipantAddition:170,resumeCallBeingConsulted:170,retryCall:170,startStopStreams:170,toggleNativeRenderer:170,toggleIncomingAudio:170,sendMeetingReaction:170,lowerOtherParticipantHand:170,lowerHandsForEveryone:170,toggleVideoSharing:170,toggleTimeZoneIndicator:170,toggleWhiteboardVideoEffect:170,togglePushToTalk:170,userFacingDiagnosticsV2:170,downloadAttendanceInRoster:170,downloadAttendanceAfterCallEnded:170,showInteropScreenshareAlert:170,toggleContentCameraShare:170,toggleMeetingRoomDisplayOemPlugin:170,updateCalendarHealthStatus:170,openMeetingRoomSettings:170,restartMeetingRoomDevice:170,openPublicPreviewFeedbackDialog:170,updateMeetingRoomRemoteHandlerState:170,toggleContentCameraEnhancement:170,showVmrState:170,startSharingFromChat:170,startInteropMeeting:170,callPptWeathepersonFailed:170,startAnnotation:170,stopAnnotation:170,updateLayoutToggleState:170,pauseRecording:170,resumeRecording:170,acceptStreamPermissions:170,toggleScd:170,updateVideoPrivacyPolicy:170,setCurrentDeviceVideoEffect:170,downloadVideoBackgroundImageV2:170,dismissAutoMuteChatAlertBanner:170,openSecurityAndPrivacyPane:170,openInviteDialog:170,updateCurrentActiveCard:170,updateCardDocumentUrl:170,updatePlayerInteractionResult:170,sendToBroadcast:170,startBroadcast:170,stopBroadcast:170,resumeOverflowRoom:170,notifyHolographicImageLoaded:170,deleteFailedMessage:170,startScd:170,stopScd:170,showHiddenChatHistory:170,addContact:170,removeContact:170,removeContactFromBuddyGroup:170,requestSystemAudioDriverInstallation:170,reportParticipant:170,createBreakoutRooms:170,markActivitiesAsRead:170,markActivityMessagesInViewportAsRead:170,markUpsellScreenAsDisplayed:170,updateSelectedUserFrequency:170,deleteJoinLink:170,updateThreadJoinLink:170,toggleNdi:170,updateMeetingRoomAppState:170,updateMeetingLock:170,applyWhiteboardVideoEffect:170,updateAutoFramingVideoSetting:170,openSettingsPanelWithWindowFocus:170,showPrivateMeetingConversation:170,upgradeConsumerLicense:170,downloadClassicalAttachment:170,setWeatherpersonCapable:170,setAplCustomBackground:170,setAplCustomBackgroundV2:170,joinScheduledMeeting:170,joinScheduledMeetingWithLink:170,startLiveStreaming:170,stopLiveStreaming:170,toggleGestureBasedReactionOption:170,updateGroupProfileAvatar:170,deleteGroupProfileAvatar:170,setAppDevicePermission:170,navigateBackFromApp:170,registerBackButtonHandler:170,sendMeetingRoom3PJoinByCodeValuestoRigel:170,setMeetingRoomHighContrastMode:170,toggleMeetingRoomHdmiIngestActiveState:170,toggleMeetingRoomHdmiIngestMirrorContent:170,refreshBiometricEnrollmentStatus:170,removeCachedBiometricVoiceSignature:170,refreshEnrollmentStatusAndPassSignatureToDeviceManager:170,updateOcclusions:170},Subscription:{ignoreMirroringVideoPreferenceSettingChangedEvent:1,activeCallsChangedEvent:1,callMyselfVideoPinnedEvent:1,callParticipantPinnedEventv2:1,callHideMyselfVideoEvent:1,callToggleMyselfInGridEvent:1,callingServiceEvent:1,callingWindowingContentChangedEvent:1,connectedCallsChangedEvent:1,callParticipantAudioRestrictionsChangedEvent:1,callParticipantVideoRestrictionsChangedEvent:1,callTransferEvents:1,ongoingConsultationEvent:1,dominantSpeakerInfoEvent:1,frameSizeChangedEvent:1,callTitleChangedEvent:1,fullFrameRequiredEvent:1,callAudienceBotDataChannelEvents:1,explicitRecordingConsentStateChangedEvent:1,blurringCapabilityChangedEvent:1,highFidelityAudioSwitchChangedEvent:1,musicModeSettingsChangedEvent:1,callMicNrgLevelsChangedEvent:1,callSpeakerVolumeChangedEvent:1,meetingJoinFromTeamsDeviceEvent:1,callSpeakerMutedChangedEvent:1,callPptSharingEvent:1,broadcastAttendeeCountEvent:1,overflowRoomCallStateChange:1,broadcastQnaFeedUpdatedEvent:1,callSpeakerHWMutedChangedEvent:1,callPptSharingAddedEvent:1,whiteboardSharingAddedEvent:1,delegateSettingsChangedEvent:1,callAppContentSharingAddedEvent:1,whiteboardSharingStatusChangedEvent:1,callAppContentSharingStatusChangedEvent:1,whiteboardUrlChangedEvent:1,fileUserPermissionsChangedEvent:1,callAppUrlChangedEvent:1,companionStreamAddedEvent:1,companionStreamRemovedEvent:1,callPptSharingRemovedEvent:1,callAppContentSharingRemovedEvent:1,callPptSharingSlideChangedEvent:1,callPptSharingPresentationUrlReadyEvent:1,callPptSharingChangeSlideCortanaInvocationEvent:1,callPptSharingMediaEventUpdatedEvent:1,callPptSharingTelemetryUpdatedEvent:1,callPptSharingPrivateViewingChangedEvent:1,callPptSharingContentSharingStatusChangedEvent:1,callRecordingStateChangedEvent:1,callLocalRecordingStateChangedEvent:1,callVoiceCollectionChangedEvent:1,callPptSharingStartedEvent:1,whiteboardSharingStartedEvent:1,callAppContentSharingStartedEvent:1,contentCameraState:1,callPptSharingStartFailedEvent:1,noiseSuppressionChangedEvent:1,autoGainControlChangedEvent:1,whiteboardSharingStartFailedEvent:1,callAppContentSharingStartFailedEvent:1,annotationChangedEvent:1,callPptSharingJoinFailedEvent:1,callLayoutChangedEvent:1,callContentCameraSharingChangedEvent:1,callParticipantPinnedEvent:1,callingScreenGalleryTypeChangedEvent:1,callingPoliciesChangedEvent:1,hasOngoingCallsChangedEvent:1,subscribedCallChangedEvent:1,bluetoothStateChangedEvent:1,callTranscriptStateEvent:1,callTranscriptEditEvent:1,callTranscriptEntryEvent:1,teamsCallIdChangedEvent:1,callHealthCategoriesUpdatedEvent:1,callingIntentEvent:1,callParticipantsChangedEvent:1,callParticipantsOnlyChangedEvent:1,callParticipantsCountsOnlyChangedEvent:1,meetingRoomCortanaStateChangedEvent:1,cortanaEvent:1,meetingRoomCortanaEnabled:1,meetingRoomRemoteSelectedLayoutChangedEvent:1,meetingRoomSwapScreensButtonStateChangedEvent:1,callParticipantsVoiceLevelsChangedEvent:1,callParticipantsReactionsEvent:1,callingAllowedEvent:1,hasUnreadMessagesChanged:1,spatialAudioConfigsChangedEvent:1,startStreamsEvent:1,callingScreenStatusChanged:1,callingAppEvents:1,askPermissionTicketStateChanged:1,callingClientStateEvent:1,raiseHandStateChangedEvent:1,systemAudioStateChanged:1,closedCaptionsDynamicEntryEvent:1,closedCaptionsEntryEvent:1,closedCaptionsStatusEvent:1,coachStatusEvent:1,videoAvailableForConversationChangedEvent:1,audienceSceneSeatingChangedEvent:1,screenShareControlEvent:1,videoEffectConfigChangedEvent:1,videoCapabilityLimitsChangedEvent:1,videoLayoutCapabilitiesChangedEvent:1,roomRemoteStateUpdateEvent:1,roomRemoteCapabilitiesUpdateEvent:1,roomRemoteProximityBannerEvent:1,e2eeStatusChangedEvent:1,videoEffectReadinessChangedEvent:1,windowsEffectsCapabilityChangedEvent:1,framesinkEventsChangedEvent:1,videoEffectCapabilitiesChangedEvent:1,setScalingEvent:1,scalingModeUpdatedEvent:1,emergencyAddressUpdatedEvent:1,emergencyCustomDisclaimerUpdatedEvent:1,thirdPartyDevicesEvent:1,holographicAnnotationEvent:1,holographicCallStateChangedEvent:1,currentSeatMappingChangedEvent:1,parkedCallsChangedEvent:1,slaCallsChangedEvent:1,sharedLineCallInvitationContent:1,streamingInfoChangedEvent:1,callingAggregateSettingsEvent:1,audioEndedEvent:1,videoExtensibilityLifecycleEvent:1,videoExtensibilityPerformanceEvent:1,activityEvent:2,activityConsumptionHorizonBookmarkEvent:2,activitySettingsChangedEvent:4,hasAppDevicePermission:8,launchTileUpdatedEvent:11,lockedTilesUpdatedEvent:11,m365ApplicationUpdatedEvent:11,m365ApplicationsUpdated:11,installedAppsUpdateEvent:13,installedAppsUpdateEventV2:13,taskModuleUpdateEvent:13,taskModuleUpdateEventV2:13,appsUsageUpdateEvent:13,appsInstalledByCurrentUserEvent:13,meetingArtifactsUpdateEvent:15,biometricVoiceEnrollmentProgressEvent:17,biometricVoiceEnrollmentMicNrgLevelEvent:17,appServiceStateChanged:24,authenticationUsersEvent:26,authenticationStateChanged:26,broadcastQnaFeedStatusEvent:27,broadcastUpdatedEvent:27,multiSlotFormEvent:28,callBlockingListChangedEvent:30,experienceAccountMode:33,diagnosticDataViewerConnectionStateChanged:34,fileUploadProgressEvent:35,onSurveySend:36,liveStreamErrorEvent:37,liveStreamPlaybackStartedEvent:37,liveStreamPlaybackNotLiveEvent:37,liveStreamPlaybackStateChangedEvent:37,liveStreamPlaybackSeekedEvent:37,liveStreamUrlSwitchedEvent:37,liveStreamFirstFrameRenderedEvent:37,liveStreamFullScreenToggledEvent:37,liveStreamCaptionsToggledEvent:37,meetAppInsightsEvent:40,meetingBotActionEvent:42,voicemailsChangedEvent:56,syncCalendarEvents:58,calendarSyncStateUpdates:58,syncMultiCalendarEvents:58,syncCalendarLeftRailSettings:58,syncCalendarEventsWithPagination:58,callableChannelUpdatedEvent:59,callingConversationStateEvent:60,hasMessageChanged:60,appNotificationEvent:60,channelSystemMessageUpdateEvent:61,channelPinnedPostsUpdateEvent:61,replyChainSummaryEvent:62,replyChainMessageEvent:62,channelModerationUpdateEvent:62,crossPostSelectedChannelIdsEvent:62,messagePaneActivityEvent:64,chatListEvent:64,chatListBatchEvent:64,chatPinEvent:64,chatListMissedActivitiesEvent:64,chatServiceEvent:64,chatServiceBatchEvent:64,chatMembersEvent:64,chatServicePostActiveEvent:64,suggestedContactsEvent:64,chatBadgeCountEvent:64,hasTypingUsersEvent:64,typingUsersEvent:64,communitiesBatchEvent:68,communitiesUnreadPostsCountEvent:68,keyboardLanguageEvent:69,connectedCalendarSettingsChangedEvent:70,suggestedContactsChangeEvent:72,displayContactsSyncBannerEvent:73,contactsSyncSettingsChangedEvent:74,connectedAccountStateEvent:74,conversationsReminderUpdatedEvent:75,registerForDesktopClientKeyDownShortcuts:77,discoverFeedHasUpdatedItems:79,espTriggerEvent:82,activeEspTargetChangedEvent:83,p2pFilesListUpdated:89,p2pFilesListStoreErrorUpdated:89,hostUpdateState:93,reportAProblemLogUpload:94,callParticipantsReactionsLiveStateEvent:99,callMeetingNotesLiveStateEvent:99,clientPreferencesChangedEvent:100,meetForWorkInsightsUpdate:105,requestMuteInAppEvent:111,isMutedInAppChangedEvent:111,meshSpacesParticipantsUpdated:112,missedMTMANotificationsUpdateEvent:114,notificationsEngineUpdatedEvent:118,platformTabsEvent:124,platformTabEventV2:124,platformTabEvent:124,externalAuthDeeplinkEvent:124,tswSdkMessageEvent:124,shareFormStatusEvent:125,teamsAndChannelsTabAddedEvent:125,platformTabsNavigationEvent:125,selectAppEntityEvent:125,registerBackButtonEvent:125,policiesUpdatedEvent:126,presencePostActiveEvent:127,presenceUpdateEvent:127,windowState:139,zoomState:139,customFrameAreaEvent:139,backdropEffectState:139,flyoutBeaconUpdatedEvent:145,flyoutChatBadgeUpdatedEvent:145,taskbarBadgeUpdatedEvent:145,teamsAndChannelsBatchEvent:149,teamsAndChannelsSyncEvent:149,gridViewUpdateEvent:149,channelByIDUpdateEvent:149,toastEvent:156,channelToastEvent:156,syntheticNotificationToastEvent:156,communitiesToastEvent:156,msaProfileAvatarChangedEvent:163,userPreferencesChangedEventForCategory:165,windowStateEvent:169,callingServiceStateEvent:170,blockedContactChangedEvent:170,contactAcceptOrBlockExtendedChangedEvent:170,callChatBubbleToggleEvent:170,localMediaVideoStreamUpdatesEvent:170,meetingRoomAppStateEvent:170,callRemotePtzCameraStateChangedEvent:170,meetingRoomThemeChangedEvent:170,meetingRoomDisplayDisconnectedEvent:170,bleLoudSpeakerInMeetingEvent:170,adjacentRoomFoundWithIntentEvent:170,nearbyRoomsChangedEvent:170,ultrasoundRoomsChangedEvent:170,broadcastStreamingDetailsUpdatedEvent:170,playerInteractionOperationEvent:170,meetingRoomRemoteControlVisibilityChangedEvent:170,meetingRoomOemPluginConnectionChangedEvent:170,scdStatusEvent:170,biometricEnrollmentDevicesEvent:170,botSsoRequestEvent:170,buddyGroupUpdatedEvent:170,buddyGroupsChangedEvent:170,attendeeTranscriptionEvent:170,callTechnicalInfoEvent:170,systemAudioDriverStateChangedEvent:170,callQueueIntentIdTeamsCallIdChangedEvent:170,escalatedCallConversationChangedEvent:170,callCompositorFailedEvent:170,dynamicCommandsUpdateEvent:170,liveStreamChangedEvent:170,eyeContactCapabilityChangedEvent:170,spatialAudioToggleChangedEvent:170,videoEffectStateChangedEvent:170,gestureBasedReactionEvent:170,deeplinkSharingStartedEvent:170,callForwardingSettingsChangedEvent:170,unifiedWebinarDataUpdateEvent:170,supportedMeetingsListChangedEvent:170,complianceRecordingStateChangedEvent:170,meetingRoomHdmiIngestStateChangedEvent:170,teamsWithActivityCountsAndMentionsEvent:170,meetingRoomMeetingJoinErrorEvent:170}}});var rM=n(893725),sM=n(491257),lM=n(958913);const dM=(e,t="resolverUncaughtErrorBoundary__doNotAssignToGraphQLTeam")=>(0,lM.q)((({graphQLErrors:n})=>{const i=e.newLogger(t);n&&n.forEach((({path:e})=>{if(e){const t=function(e){return e.map((e=>"number"==typeof e?`[${e.toString()}]`:`${e}`)).join(".")}(e);i.error(`Uncaught error in a GraphQL resolver, at field selection path: ${t}`)}else i.error("Unknown uncaught error in a GraphQL resolver")}))}));function cM(e,t,n){if(!t||0===Object.keys(t).length)return!1;const{query:i}=e,a=(0,MD.p$)(i);if(!a||a&&"OperationDefinition"!==a.kind)return!1;const{selectionSet:{selections:o}}=a,r=(0,l_.S)(i,null);if(!r)return!1;const s=r.operation;let l=!1;return o.every((e=>{if("Field"===e.kind){if(t[s]&&t[s].has(e.name.value))return l=!0,!0;if(l){n.newLogger("isDataLayerClientOperationSupported").error(`Unexpected partially supported operation - unsupported selection = ${e.name.value}`)}}return!1}))}class uM{static createSingletonLink(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(uM._singletonLink)throw new Error("Links are already created");return uM._singletonLink=sF.i.from(yield uM.createDefaultLinks(e)),uM._singletonLink}))}static createLink(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return sF.i.from(yield uM.createDefaultLinks(e))}))}static get singletonLink(){return uM._singletonLink}static createViewSchemaLink(e){return this._viewSchemaImportPromise||(this._viewSchemaImportPromise=Promise.all([n.e(63535),n.e(33181)]).then(n.bind(n,143593))),sF.i.from([dM(e.loggerFactory,"apolloViewSchemaLinkCatchedErrors"),this.createLazyViewSchemaTerminatingLink(e,this._viewSchemaImportPromise)])}static createLazyViewSchemaTerminatingLink(e,t){let n;return this._viewSchemaImport&&this._viewSchemaExecutor?this._viewSchemaImport.createViewSchemaTerminatingLink(e,this._viewSchemaExecutor):new sF.i(((i,a)=>new lF.y((o=>{let r,s=!1;return t.then((t=>(this._viewSchemaExecutor||(this._viewSchemaExecutor=new t.ViewSchemaExecutor),this._viewSchemaImport||(this._viewSchemaImport=t),n||(n=t.createViewSchemaTerminatingLink(e,this._viewSchemaExecutor)),n))).then((e=>{var t;s||(r=null===(t=e.request(i,a))||void 0===t?void 0:t.subscribe({next:o.next.bind(o),error:o.error.bind(o),complete:o.complete.bind(o)}))})).catch(o.error.bind(o)),()=>{s=!0,r&&r.unsubscribe()}}))))}static createPatchVariablesLink(e){return BF({contextValue:e,resolvers:[LF.s]})}static createTerminatingLink({config:e,contextValue:t,cdlWorkerService:n,dataClientTrackingService:a,loggerFactory:o,scenarioFactory:r,coreSettings:s,leakDetectorService:l,windowProvider:d},c){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=uM.createMainRendererTerminatingLink(e.clientId,o,r,d,s,l,a),u=sF.i.concat(function(e,t){return(0,nM.G)({map:oM(t),contextBuilder:()=>e.contextValue,schemaBuilder({typeDefs:t,resolvers:n}){const i=(0,aM.yM)(n),a=e.enableClassBasedErrors?"function"==typeof i?(...e)=>(0,tM.o)(i(...e),"WebResolver"):(0,tM.o)(i,"WebResolver"):i;return(0,iM.sJ)({typeDefs:t,resolvers:a,noExtensionExtraction:!0,updateResolversInPlace:!0,resolverValidationOptions:{requireResolversForResolveType:"ignore"},skipASTValidation:!0})}})}({contextValue:t,enableClassBasedErrors:!!s.get(K.J.Core).enableClassBasedErrors},r),(0,eM.c)()),m=o.newLogger("createTerminatingLink"),g=(0,sM.Om)(s,m);let p=sF.i.split((e=>function(e,t,n,i){const{enableCentralDataLayer:a}=n.get(K.J.Host);return!!a&&cM(e,t,i)}(e,g,s,o)),(0,rM.z)(WF(),i),u);return(0,BA.Q6)(s)&&!c&&(p=yield uM.createCDLWorkerTerminatingLink(n,e,o,r,s,m,p)),p}))}static createMainRendererTerminatingLink(e,t,n,i,a,o,r){const s=a.get(K.J.Cdl),{logCdlOperationsDuringWaitSettings:l}=a.get(K.J.Core),d=this.createDataLayerClientSettings(a);return OF(new u_(e,t,n,new PF((0,Ze.J)()),o,"Angular",i,{enableRequestHealthMonitor:!!s.enableRequestHealthMonitor,failureCountThreshold:s.requestHealthMonitorFailureCountThreshold,timeoutCountThreshold:s.requestHealthMonitorTimeoutCountThreshold,timeoutLengthSeconds:s.requestHealthMonitorTimeoutLengthSeconds},void 0,void 0,{enableLoggingCdlOperationsDuringWait:null==l?void 0:l.enableLoggingCdlOperationsDuringWait,enableTrackingCdlOperationsDuringWait:null==l?void 0:l.enableTrackingCdlOperationsDuringWait,trackingCdlOperationsDuringWaitThresholdInMs:null==l?void 0:l.trackingCdlOperationsDuringWaitThresholdInMs,trackingCdlOperationsDuringWaitBufferSize:null==l?void 0:l.trackingCdlOperationsDuringWaitBufferSize},r,void 0,d))}static createDataLayerClientSettings(e){const{cdlSubscriptionAggregatorAllowList:t}=e.get(K.J.CdlWorker);return{cdlSubscriptionAggregatorAllowList:t||void 0}}static createCDLWorkerTerminatingLink(e,t,n,a,o,r,s){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e)return r.warn("Not creating CDL Worker terminating link. Worker is enabled, but service is unavailable."),s;const i=yield e.getCDLWorkerManager();if(!i)return r.warn("Not creating CDL Worker terminating link. Worker is enabled, service is available but workerManager is not defined."),s;const l=OF(yield e.getDataLayerClient()),d=(0,sM.Ng)(o,r,i.cdlWorkerSupportedResolvers);return s=sF.i.split((e=>function(e,t,n){return cM(e,t,n)}(e,d,n)),(0,rM.z)(WF(),l),s),o.get(K.J.CdlWorker).enableControlPlaneLink&&(s=yield uM.createCDLWorkerControlPlaneTerminatingLink(e,t,n,a,s,o)),s}))}static createCDLWorkerControlPlaneTerminatingLink(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield e.getControlPlaneCommunicator(),s=OF(new u_(t.clientId,n,a,i,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.createDataLayerClientSettings(r)));return o=sF.i.split((e=>function(e,t){return cM(e,xF,t)}(e,n)),(0,rM.z)(WF(),s),o)}))}}uM._singletonLink=null,uM._viewSchemaExecutor=null,uM.createDefaultLinks=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{contextValue:t,loggerFactory:n,scenarioFactory:i,coreSettings:a,noCDLTerminatingLink:o}=e,r=yield uM.createTerminatingLink(e,o),s=uM.createPatchVariablesLink(t),l=a.get(K.J.Core).enableGraphQlOpsCount,d=a.get(K.J.Core).enableTrackRequestsLink,c=l||d?[JF(n,i,l,d,t.graphqlOpsCountService)]:[],u=a.get(K.J.Calling).enableSubscriptionCancellationListener?[ZF(n,a)]:[],m=XF("presenceUpdateEvent",a,!0),g=XF("callParticipantUpdatedEvent",a),p=XF("callParticipantsChangedEvent",a),v=XF("callParticipantsVoiceLevelsChangedEvent",a),h=XF("chatServiceEvent",a),f=XF("blockedContactChangedEvent",a);return[...c,...u,s,dM(n),m,g,p,v,h,f,r]}));var mM=n(264786);const gM=()=>(0,mM.ZB)(["filter","typeFilter"]);function pM(e,t){return t("timestamp",e||{})||""}const vM=()=>{const e=(0,mM.ZB)(!1),{read:t,merge:n}=e,o=(0,i.__rest)(e,["read","merge"]);return Object.assign(Object.assign({},o),{merge:(e,t,i)=>{var o,r;if("function"==typeof n){const s=n(e,t,i),{readField:l}=i;let d=(0,a.uniqBy)(s.edges,(e=>l("id",e.node)));return d=d.filter((e=>!l("deleteTime",e.node))),Object.assign(Object.assign({},s),{edges:d,pageInfo:Object.assign(Object.assign({},null==s?void 0:s.pageInfo),{startCursor:l("timestamp",null===(o=(0,a.head)(d))||void 0===o?void 0:o.node),endCursor:l("timestamp",null===(r=(0,a.last)(d))||void 0===r?void 0:r.node)})})}return n},read:(...e)=>{const n=e[0],{readField:i}=e[1];if(!n||!t)return;if(!n.edges)return n;const a=[...n.edges].sort(((e,t)=>function(e,t,n){const i=null==e?void 0:e.node,a=null==t?void 0:t.node,o=pM(i,n),r=pM(a,n);return o?r?parseInt(r,10)-parseInt(o,10):-1:1}(e,t,i)));return Object.assign(Object.assign({},t(...e)),{edges:a})}})};const hM=()=>{const e=(0,mM.ZB)(!1),{merge:t}=e,n=(0,i.__rest)(e,["merge"]);return Object.assign(Object.assign({},n),{merge:(e,n,i)=>{if(fM(t)){if(!e)return n;const{readField:o}=i,r=t(e,n,i),s="objectId",l=(0,a.uniqBy)(r.edges,(e=>o(s,e.node)));return Object.assign(Object.assign({},r),{edges:l,pageInfo:Object.assign({},r.pageInfo)})}return t}})},fM=e=>"function"==typeof e,yM=e=>{const t=uF.Query||{fields:{}};return Object.assign(Object.assign(Object.assign({},uF),e),{Query:Object.assign(Object.assign({},t),{fields:Object.assign(Object.assign({},t.fields),{chats:gM(),recentsChats:gM(),pinnedChats:gM(),activities:vM(),suggestedContactsInChatList:(0,mM.ZB)(["filter","typeFilter"]),replyChainMessages:Object.assign(Object.assign({},(0,mM.ZB)(["channelId","replychainId"])),{read:e=>e}),replyChainSummaries:Object.assign(Object.assign({},(0,mM.ZB)(["channelId"])),{read:e=>e}),fluidMessages:{merge:(e,t)=>[...t]},feed:{merge:!0},calendarEventsV3WithPagination:hM(),pinnedChannels:{merge:!1}})})})},kM=e=>"cache-and-network"===e||"network-only"===e?"cache-first":e;var SM=n(316574);const bM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quotedReply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quotedReply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}}]};var CM=n(870209);var wM=n(350672);var NM=n(232922),TM=n(299034),IM=n(915465),EM=n(545004);const AM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chat"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingInformationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}}]}},...NM.T.definitions,...TM.v.definitions,...IM.f.definitions,...EM.qL.definitions]},_M=e=>({__typename:"ChatDisabledContext",isUIDisabled:e.isUIDisabled,disabledReason:e.disabledReason,extendedData:e.extendedData,lastUpdatedTime:e.lastUpdatedTime}),DM=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:L.Z4B.UnknownReason,extendedData:null,lastUpdatedTime:null}),FM=()=>({__typename:"ChatDisabledContext",isUIDisabled:!1,disabledReason:L.Z4B.ChatDisabledDueToBotStatus,extendedData:null,lastUpdatedTime:null}),MM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidMessages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidMessages"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}}]}}]}}]},RM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidManifestEntries"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidManifestEntries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"entries"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}}]},PM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fluidPendingMentions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"componentHash"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fluidPendingMentions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"componentHash"},value:{kind:"Variable",name:{kind:"Name",value:"componentHash"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"atMentionId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"contentId"}},{kind:"Field",name:{kind:"Name",value:"navigationPath"}}]}}]}}]};const OM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"composeState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"composeState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isExpanded"}}]}}]}}]},xM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"imageAltText"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageAltText"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var LM=n(595091),UM=n(291540);const BM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messagePaneScrolledToStartState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messagePaneScrolledToStartState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isScrolledToStart"}}]}}]}}]},jM={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForTranslation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"fromLanguage"}}]}}]}}]},WM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"twoWaySmsFriendlyName"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"twoWaySmsFriendlyName"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var VM=n(25729);const HM={Query:{fluidManifestEntries:(e,{locale:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{try{const n=e.readQuery({query:RM,variables:{locale:t}});return null==n?void 0:n.fluidManifestEntries}catch(e){return void n.newLogger("fluid-manifest-entries").error("Failed to retrieve the cached fluid manifest json")}})(n,t,i)||null,requestImmersiveReader:(e,{conversationId:t,messageId:n,setFocusOnClose:i},a)=>function(e,t,n){return(0,Ze.J)().opener.open(xb.B.OpenOnMainRenderer,xb._.ImmersiveReader,{conversationId:e,messageId:t,setFocusOnClose:n}),!0}(t,n,i)},Conversation:Object.assign({isFederated(e){var t;return null!==(t=e.isFederated)&&void 0!==t?t:(0,Co.eX)(e.id)},isMeeting(e){var t;return null!==(t=e.isMeeting)&&void 0!==t?t:(0,CM.e9)(e.id)},isSfB(e){var t;return null!==(t=e.isSfB)&&void 0!==t?t:(0,Co.C6)(e.id)},chatDisabledContext:e=>(e=>{if(!e)return null;if(!e.chatDisabledContext){const t=e;return t&&t.isDisabled&&t.isOneOnOne&&t.hasBotMember?FM():DM()}return e.chatDisabledContext})(e)},{isHighImportance:()=>null,isUrgentImportance:()=>null,activeCallsCount:()=>null,datatid:()=>null,displayName:()=>null,hasActiveCalls:()=>null,hasFailedMessages:()=>null,otherMemberMris:()=>null,isNewChat:()=>null,isBotBlocked:()=>null,isBotUser:()=>null,isHidden:()=>null,isContactTagged:()=>null,pictureUpn:()=>null,pinnedIndex:()=>null,showAtMention:()=>null,showMarkers:()=>null,tooltipTitle:()=>null,longTitle:()=>null,pictureGroup:()=>null,lastMessageTime:()=>null,messagePreview:()=>null,messagePreviewAria:()=>null,isLastMessageText:()=>null,plGroupKey:()=>null,presenceSource:()=>null,hasActions:()=>null,canBeDiscarded:()=>null,canBotBeBlocked:()=>null,canBePinned:()=>null,canBeMuted:()=>null,canBeLeft:()=>null,canBeHidden:()=>null,canBeFavorited:()=>null,canTagContact:()=>null,canPopOut:()=>null,canManageApps:()=>null}),Mutation:{untranslateMessage:(e,{messageId:t},{cache:n,loggerFactory:i})=>function(e,t,n){if(!t)return null;const i=wM.Ps`
    fragment originalMessageFields on Message {
      id
      content
    }
  `;try{const n=e.readFragment({id:`Message:${t}`,fragment:i});return n?n.content:null}catch(e){return n.error(`Failed to get message from cache: ${e}`),null}}(n,t,i.newLogger("untranslateMessage")),updateChatDisabledContext:(e,{convId:t,isUIDisabled:n,disabledReason:i,extendedData:a},{cache:o})=>((e,t,n,i,a)=>{const o={convId:t},r={__typename:"ChatDisabledContextResponse",message:"",success:!1,chatDisabledContext:DM()};try{const t=e.readQuery({query:AM,variables:o});if(!t||!t.chat)return r.message="Could not update chatDisabledContext for a null chat conversation",r;const s=Date.now().toString();t.chat.chatDisabledContext&&(r.chatDisabledContext=Object.assign({},t.chat.chatDisabledContext));const l={__typename:"ChatDisabledContext",isUIDisabled:n,disabledReason:i,extendedData:a,lastUpdatedTime:s},d={chat:Object.assign(Object.assign({},t.chat),{chatDisabledContext:l})};e.writeQuery({query:AM,variables:o,data:d}),r.success=!0,d&&d.chat&&d.chat.chatDisabledContext&&(r.chatDisabledContext=_M(d.chat.chatDisabledContext))}catch(e){r.message=`Exception: Failed to update chatDisabledContext for conversation ${t}. Exception Details: ${e.message}`}return r})(o,t,n,i,a),resetQuotedReply:(e,{convId:t},{cache:n})=>((e,t)=>(t.writeQuery({query:bM,variables:{convId:e},data:{quotedReply:null}}),!0))(t,n),setQuotedReply:(e,{convId:t,quotedReply:n},{cache:i})=>((e,{displayName:t,from:n,messageId:i,preview:a,timestamp:o},r)=>{const s={quotedReply:{__typename:"QuotedReply",displayName:t,from:n,messageId:i,preview:a,timestamp:o}};return r.writeQuery({query:bM,variables:{convId:e},data:s}),!0})(t,n,i),updateComposeState(e,{id:t,isExpanded:n},{cache:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"ComposeMessageState",id:t,isExpanded:n};try{a.writeQuery({query:OM,variables:{id:t},data:{composeState:Object.assign(Object.assign({},e),{__typename:"ComposeMessageState"})}})}catch(e){o.newLogger("update-compose-state").error(`Failed to write to client cache the compose state query. Error: ${e.message}`)}return e}))},setImageAltText(e,{altText:t},{cache:n,loggerFactory:a}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={imageAltText:t};try{n.writeQuery({query:xM,data:e})}catch(e){a.newLogger("update-image-alt-text").error(`Failed to write to client cache the image alt text query. Error: ${e.message}`)}return!0}))},insertHyperlink(e,{displayText:t,address:n},{cache:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"FluidInsertedHyperlink",displayText:t,address:n};try{a.writeQuery({query:LM.D,data:{insertedHyperlink:Object.assign(Object.assign({},e),{__typename:"FluidInsertedHyperlink"})}})}catch(e){o.newLogger("insert-hyperlink-dialog-data").error(`Failed to write to client cache the insert hyperlink dialog data query. Error: ${e.message}`)}return!0}))},setTwoWaySmsFriendlyName(e,{twoWaySmsFriendlyName:t},{cache:n,loggerFactory:a}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={twoWaySmsFriendlyName:t};try{n.writeQuery({query:WM,data:e})}catch(e){a.newLogger("update-tfl-two-way-sms-friendly-name").error(`Failed to write to client cache the tfl two way sms friendly name query. Error: ${e.message}`)}return!0}))},updateMessagePaneScrolledToStartState(e,{id:t,isScrolledToStart:n},{cache:a,loggerFactory:o}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"MessagePaneScrolledToStartState",id:t,isScrolledToStart:n};try{a.writeQuery({query:BM,variables:{id:t},data:{messagePaneScrolledToStartState:Object.assign(Object.assign({},e),{__typename:"MessagePaneScrolledToStartState"})}})}catch(e){o.newLogger("update-chat-bottom-state").error(`Failed to write to client cache the chat bottom state query. Error: ${e.message}`)}return e}))},setDlpDialogData(e,{isReport:t,isOverride:n,justification:a},{cache:o,loggerFactory:r}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e={__typename:"DlpDialogData",isReport:t,isOverride:n,justification:a};try{o.writeQuery({query:UM.C,data:{dlpDialogData:Object.assign(Object.assign({},e),{__typename:"DlpDialogData"})}})}catch(e){r.newLogger("set-dlp-dialog-data").error(`Failed to write to client cache the set dlp dialog data query. Error: ${e.message}`)}return e}))},setFluidMessage:(e,{fluidMessage:t,remove:n},{cache:i,loggerFactory:a})=>(({messageId:e,originalArrivalTime:t},n,i,a)=>{try{const a=i.readQuery({query:MM}),o=n?function(e,t){var n;return{fluidMessages:(null===(n=null==e?void 0:e.fluidMessages)||void 0===n?void 0:n.filter((e=>e.messageId!==t)))||[]}}(a,e):function(e,t,n){const i=[],a={__typename:"FluidMessage",id:t,messageId:t,originalArrivalTime:n};let o=!1;if(null==e?void 0:e.fluidMessages)for(const t of e.fluidMessages)t.originalArrivalTime<a.originalArrivalTime&&!o&&(i.push(a),o=!0),i.push(t);return o||i.push(a),{fluidMessages:i}}(a,e,t);return i.writeQuery({query:MM,data:o}),!0}catch(e){return a.newLogger("set-fluid-messages-pending-load").error(`Failed to write to client cache the set fluid message pending load query. Error: ${e.message}`),!1}})(t,!!n,i,a),setFluidManifestEntries:(e,{locale:t,entries:n},{cache:i,loggerFactory:a})=>((e,t,n,i)=>{try{const i={fluidManifestEntries:{__typename:"FluidManifestEntries",locale:e,entries:t,timestamp:Date.now()}};return n.writeQuery({query:RM,variables:{locale:e},data:i}),!0}catch(e){return i.newLogger("fluid-manifest-entries").error(`Failed to write to client cache that set fluid manifest json query. Error: ${e.message}`),!1}})(t,n,i,a),updateFluidPendingMentions:(e,{componentHash:t,pendingMention:n,remove:i},{cache:a,loggerFactory:o})=>((e,t,n,i,a)=>{try{const a=Object.assign({__typename:"FluidPendingMention"},t),o={componentHash:e},r=i.readQuery({query:PM,variables:o}),s=((null==r?void 0:r.fluidPendingMentions)||[]).filter((e=>a.userPrincipalName!==e.userPrincipalName)),l=n?s:[...s,a];return i.writeQuery({query:PM,variables:o,data:{fluidPendingMentions:l}}),!0}catch(e){return a.newLogger("fluid-resolvers-update-pending-fluid-mentions").error(`Failed to write pending mentions to the cache, error="${e.message}"`),!1}})(t,n,!!i,a,o),clearFluidPendingMentions:(e,{componentHash:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{try{const n={componentHash:e};return t.writeQuery({query:PM,variables:n,data:{fluidPendingMentions:[]}}),!0}catch(e){return n.newLogger("fluid-resolvers-clear-fluid-pending-mentions").error(`Failed to clear pending mentions from the cache, error="${e.message}"`),!1}})(t,n,i),resetSmartReplyFileSuggestion:(e,{convId:t},{cache:n,loggerFactory:i})=>((e,t,n)=>{const i={smartReplyFileSuggestion:null};try{return t.writeQuery({query:VM.v,variables:{convId:e},data:i}),!0}catch(e){return n.newLogger("ResetSmartReplyFileSuggestion").error(`Failed to reset smart reply file suggestion in cache: ${e}`),!1}})(t,n,i),setSmartReplyFileSuggestion:(e,{convId:t,fileSuggestion:n},{cache:i,loggerFactory:a})=>((e,{fileName:t,url:n},i,a)=>{try{const a={smartReplyFileSuggestion:{__typename:"SmartReplyFileSuggestion",fileName:t,url:n}};return i.writeQuery({query:VM.v,variables:{convId:e},data:a}),!0}catch(e){return a.newLogger("SetSmartReplyFileSuggestion").error(`Failed to set smart reply file suggestion in cache: ${e}`),!1}})(t,n,i,a)},Message:{deletionInfo:(e,t,{cache:n})=>(0,SM.sE)(n,e),translation:(e,t,{cache:n})=>{var i;try{const t=`Message:${e.id}`,a=null===(i=n.readFragment({id:t,fragment:jM}))||void 0===i?void 0:i.translation;return a?Object.assign(Object.assign({},a),{__typename:"Translation"}):null}catch(e){return null}},diagnosticInfo:()=>({__typename:"DiagnosticInfo",diagnosticErrorCode:-1,diagnosticMessage:null})}},$M={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormBlockingTasksQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormBlockingTasks"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}}]}}]},zM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormTerminatingActionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormTerminatingAction"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},GM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientCalendarSchedulingFormActiveTabQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"schedulingFormActiveTab"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},qM={Query:{schedulingFormActiveTab(e,t,{cache:n,loggerFactory:i}){var a,o;try{const e=n.readQuery({query:GM});return null!==(a=null==e?void 0:e.schedulingFormActiveTab)&&void 0!==a?a:null}catch(e){const t=i.newLogger("scheduling-form-active-tab");return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"schedulingFormActiveTab: Failed to fetch scheduling form active tab from cache.","calendar_form_active_tab"),null}},schedulingFormBlockingTasks(e,t,{cache:n,loggerFactory:i}){var a,o;try{const e=n.readQuery({query:$M});return null!==(a=null==e?void 0:e.schedulingFormBlockingTasks)&&void 0!==a?a:[]}catch(e){const t=i.newLogger("scheduling-form-blocking-task");return null===(o=t.errorToTelemetry)||void 0===o||o.call(t,"schedulingFormBlockingTasks: Failed to fetch scheduling form blocking task from cache.","calendar_form_blocking_tasks"),[]}},schedulingFormTerminatingAction(e,t,{cache:n,loggerFactory:i}){var a,o,r;try{return null!==(o=null===(a=n.readQuery({query:zM}))||void 0===a?void 0:a.schedulingFormTerminatingAction)&&void 0!==o?o:null}catch(e){const t=i.newLogger("scheduling-form-terminating-action");return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"schedulingFormTerminatingAction: Failed to fetch scheduling form terminating action from cache.","calendar_form_terminating_action"),null}},calendarLeftRail:()=>({isExpanded:!0})},Mutation:{addSchedulingFormBlockingTask(e,{input:{task:t}},{cache:n,loggerFactory:i}){var a,o,r,s;const l=i.newLogger("add-scheduling-form-blocking-task"),d=(0,mt.v4)();try{const e=null!==(o=null===(a=n.readQuery({query:$M}))||void 0===a?void 0:a.schedulingFormBlockingTasks)&&void 0!==o?o:[],i=e.find((e=>e.type===t.type));if(i&&i.state===L.vDg.Active)return null===(r=l.errorToTelemetry)||void 0===r||r.call(l,"addSchedulingFormBlockingTask: Failed to write scheduling form blocking task in cache. Existing active task of same type already exists.","calendar_form_blocking_tasks"),null;const s=(i?e.filter((e=>e.type!==t.type)):e).concat([Object.assign(Object.assign({__typename:"SchedulingFormTask"},t),{id:d})]);n.writeQuery({query:$M,data:{schedulingFormBlockingTasks:s}})}catch(e){return null===(s=l.errorToTelemetry)||void 0===s||s.call(l,"addSchedulingFormBlockingTask: Failed to write scheduling form blocking task in cache.","calendar_form_blocking_tasks"),null}return Object.assign(Object.assign({},t),{id:d,__typename:"SchedulingFormTask"})},updateSchedulingFormBlockingTask(e,{input:{type:t,state:n}},{cache:i,loggerFactory:a}){var o,r,s,l;const d=a.newLogger("update-scheduling-form-blocking-task");try{let e=-1;const a=(null!==(r=null===(o=i.readQuery({query:$M}))||void 0===o?void 0:o.schedulingFormBlockingTasks)&&void 0!==r?r:[]).map(((i,a)=>(null==i?void 0:i.type)===t?(e=a,Object.assign(Object.assign({},i),{state:n})):i));return-1===e?(null===(s=d.errorToTelemetry)||void 0===s||s.call(d,"updateSchedulingFormBlockingTask: Failed to update scheduling form blocking task in cache. Task does not exist.","calendar_form_blocking_tasks"),null):a[e]}catch(e){return null===(l=d.errorToTelemetry)||void 0===l||l.call(d,"updateSchedulingFormBlockingTask: Failed to update scheduling form blocking task in cache.","calendar_form_blocking_tasks"),null}},removeSchedulingFormBlockingTask(e,{input:{type:t}},{cache:n,loggerFactory:i}){var a,o,r;const s=i.newLogger("remove-scheduling-form-blocking-task");try{const e=null!==(o=null===(a=n.readQuery({query:$M}))||void 0===a?void 0:a.schedulingFormBlockingTasks)&&void 0!==o?o:[],i=e.find((e=>e.type===t));if(!i)return null;const r=e.filter((e=>(null==e?void 0:e.type)!==t));return n.writeQuery({query:$M,data:{schedulingFormBlockingTasks:r}}),i}catch(e){return null===(r=s.errorToTelemetry)||void 0===r||r.call(s,"removeSchedulingFormBlockingTask: Failed to remove scheduling form blocking task from cache.","calendar_form_blocking_tasks"),null}},setSchedulingFormActiveTab(e,{input:t},{cache:n,loggerFactory:i}){var a;const o=null===t?null:Object.assign(Object.assign({},t),{__typename:"SchedulingFormTab"});try{return n.writeQuery({query:GM,data:{schedulingFormActiveTab:o}}),o}catch(e){const t=i.newLogger("scheduling-form-active-tab");return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,"setSchedulingFormActiveTab: Failed to set scheduling form active tab in cache.","calendar_form_active_tab"),null}},setSchedulingFormTerminatingAction(e,{input:{type:t}},{cache:n,loggerFactory:i}){var a;const o=i.newLogger("set-scheduling-form-terminating-action");try{n.writeQuery({query:zM,data:{schedulingFormTerminatingAction:t}})}catch(e){return null===(a=o.errorToTelemetry)||void 0===a||a.call(o,"setSchedulingFormTerminatingAction: Failed to update scheduling form terminating task in cache.","calendar_form_terminating_action"),!1}return!0}}};var QM=n(20645);var JM=n(11695);const YM={Mutation:{addFileUpload(e,{fileToAdd:t},{cache:n}){const{fileContainerId:i}=t,a=(({uploadId:e,fileName:t,serviceName:n,context:i})=>({title:t,status:L.XXy.PROGRESS,id:e,itemId:null,type:(0,QM.mD)(t),objectUrl:"",baseUrl:"",progress:1,fileId:"",isReferencedFile:!1,shareUrl:"",shareId:"",previewUrl:"",chicletBreadcrumbs:null,context:null!=i?i:null,permissionScope:null,previewHeight:null,previewWidth:null,progressComplete:null,state:L.cj1.active,hasUploadFailed:!1,serviceName:n,externalFileShareInfo:"",__typename:"FileUpload"}))(t);return(0,JM.zz)([a],n,i),!0},removeFileUpload(e,{input:t},{cache:n}){const{uploadId:i,fileContainerId:a}=t;return(0,JM.Fj)(i,a,n),!0}}};var KM=n(369443);const ZM=e=>{if(e){const{appIcon:t,appId:n,appName:i,contentType:a,content:o,locale:r}=e;return{__typename:"PlatformCard",appIcon:t||null,appId:n||null,appName:i||null,content:o,contentType:a,locale:r||null}}return null};var XM=n(490326);var eR=n(523950);var tR=n(516135);var nR=n(698355);const iR={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformAppsFetchPolicyFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicy"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"forceNetworkFetch"}},{kind:"Field",name:{kind:"Name",value:"scope"}},{kind:"Field",name:{kind:"Name",value:"convId"}}]}}]},aR="PlatformAppsFetchPolicy",oR="PlatformAppsFetchPolicyMetadata",rR=wM.Ps`
  fragment PlatformAppsFetchPolicyMetadata_FetchPolicyIds on PlatformAppsFetchPolicyMetadata {
    fetchPolicyIds
  }
`,sR=wM.Ps`
  fragment PlatformAppsFetchPolicy_ForceNetwork on PlatformAppsFetchPolicy {
    forceNetworkFetch
  }
`,lR=(e,t)=>{let n=`${aR}:${e}`;return t&&(n=`${n}:${t}`),n},dR=(e,t,n,i)=>{let a=!0;try{const a=lR(t.scope,t.convId);e.writeFragment({id:a,fragment:iR,data:t});const{enableContextlessFetchPolicyUpdates:o}=n.get(K.J.Extensibility);o&&mR(e,a,i)}catch(e){a=!1}return a},cR=(e,t,n)=>{let i=`${e}`;return t&&(i=`${i}:${t}`),{__typename:aR,id:i,scope:e,forceNetworkFetch:n,convId:null!=t?t:null}},uR=e=>{var t;try{const n=e.readFragment({id:oR,fragment:rR});return null!==(t=null==n?void 0:n.fetchPolicyIds)&&void 0!==t?t:[]}catch(e){throw e}},mR=(e,t,n)=>{var i;const a=n.newLogger("updateFetchPolicyIds");try{let n=uR(e);if(n.includes(t))return;n=n.concat(t),e.writeFragment({id:oR,fragment:rR,data:{__typename:oR,fetchPolicyIds:n}})}catch(e){null===(i=a.errorToTelemetry)||void 0===i||i.call(a,`updateFetchPolicyIds: failed to update fetch policy ids when adding ${t}`,"platform_apps_fetch_policy_update_ids_resolver")}};var gR=n(582364);var pR=n(337147);var vR=n(619695);const hR={__typename:"MessageExtensionsAppsState",toggleRefetch:!1},fR=(e,t)=>{try{const n=e.readQuery({query:vR.F,variables:{convId:t}});if(!n)throw new Error("Unable to read ME apps state from cache");return n}catch(e){throw e}};var yR=n(685539);var kR=n(85273);var SR=n(721715);var bR=n(622673),CR=n(878635);var wR=n(589884);var NR=n(907306);var TR=n(454016);var IR=n(228222);var ER=n(920047);const AR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformCachedAppListQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cachedAppList"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedSourceWindow"}},{kind:"Field",name:{kind:"Name",value:"apps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"webContentsId"}},{kind:"Field",name:{kind:"Name",value:"processId"}},{kind:"Field",name:{kind:"Name",value:"isCachedAndHidden"}},{kind:"Field",name:{kind:"Name",value:"lastLoaded"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}}]}}]}}]}}]},_R=(e,t,n,i,o)=>{if(!e)return!1;const{lastUpdatedSourceWindow:r}=e;try{const s=t.readQuery({query:AR}),l=n({input:e,cacheData:s,coreSettings:o,logger:i});if((0,a.isEqual)(l,null==s?void 0:s.cachedAppList.apps))null==i||i.warn("cache write skipped, data unchanged");else{null==i||i.log("cached app list updated, writing query");const e={cachedAppList:{__typename:"CachedAppList",id:"appcaching",apps:l,lastUpdatedSourceWindow:r}};t.writeQuery({query:AR,data:e})}return!0}catch(e){return!1}},DR=e=>{const t={};return e.forEach((e=>t[e.processId]=e)),t},FR=e=>{var t;const{cacheData:n,input:i,logger:a}=e;return(({apps:e},t,n)=>{const i=DR(t),a=e.filter((e=>!i[e.processId]));return a.length!==e.length&&(null==n||n.warn("duplicate apps found in mutation input")),t.concat(a.map((e=>{var t,n,i,a;return Object.assign(Object.assign({},e),{__typename:"CachedApp",webContentsId:null!==(t=e.webContentsId)&&void 0!==t?t:null,lastLoaded:null!==(n=e.lastLoaded)&&void 0!==n?n:null,appId:null!==(i=e.appId)&&void 0!==i?i:null,appName:null!==(a=e.appName)&&void 0!==a?a:null})})))})(i,null!==(t=null==n?void 0:n.cachedAppList.apps)&&void 0!==t?t:[],a)},MR=e=>{var t;const{cacheData:n,input:{apps:i},logger:a}=e,o=DR(i);let r=[];return(null==n?void 0:n.cachedAppList.apps)&&(r=null==n?void 0:n.cachedAppList.apps.filter((e=>!o[e.processId])),r.length===(null==n?void 0:n.cachedAppList.apps.length)&&(null===(t=null==a?void 0:a.errorToTelemetry)||void 0===t||t.call(a,"app to remove is not in the cached app list","platform_app_caching_missing_cached_app_on_update",void 0,!0))),r},RR=(e,t,n)=>{let i,a=-1;for(const n of e)(!i||n.lastLoaded&&n.lastLoaded<i)&&(a=t.indexOf(n),i=n.lastLoaded);const o=[...t];return-1!==a&&(o.splice(a,1),null==n||n.log("app removed from global cache due to exceeding shared cache size")),o},PR=e=>{const{cacheData:t,input:{apps:n},coreSettings:i,logger:a}=e,o=null==i?void 0:i.get(K.J.Extensibility),r=null==o?void 0:o.appCachingMaxSizeNS;let s=[];if(null==t?void 0:t.cachedAppList.apps){const e=DR(null==t?void 0:t.cachedAppList.apps);s=n.map((t=>{var n,i,o,r;let s;const l=e[t.processId];l?s=l:(s=t,null==a||a.log("adding app to cache that was not found during update."));const d=null!==(n=s.webContentsId)&&void 0!==n?n:null,c=null!==(i=t.lastLoaded)&&void 0!==i?i:null,u=t.isCachedAndHidden,m=null!==(o=s.appId)&&void 0!==o?o:null,g=null!==(r=s.appName)&&void 0!==r?r:null;return Object.assign(Object.assign({},s),{__typename:"CachedApp",webContentsId:d,lastLoaded:c,appId:m,isCachedAndHidden:u,appName:g})}));const i=DR(s);s=s.concat(t.cachedAppList.apps.filter((e=>!i[e.processId])))}return r?((e,t,n)=>{const i=e.filter((e=>e.isCachedAndHidden));return!i.length||i.length<=t?e:RR(i,e,n)})(s,r,a):s};var OR=n(569516);var xR=n(136772);var LR=n(627291);const UR={Query:{platformAppsBatchFetchPolicy:(e,{options:t},{cache:n})=>t.map((({scope:e,convId:t})=>((e,{scope:t,convId:n})=>{let i;try{const a=lR(t,n),o=e.readFragment({id:a,fragment:iR});i=null==o?void 0:o.forceNetworkFetch}catch(e){i=!1}return cR(t,n,null!=i&&i)})(n,{scope:e,convId:t}))),messageExtensionsAppsState:()=>hR},Mutation:{toggleAppsRefetch:(e,{convId:t},{cache:n})=>{try{const e=fR(n,t),{messageExtensionsAppsState:i}=e,a=!i.toggleRefetch,o={messageExtensionsAppsState:Object.assign(Object.assign({},i),{toggleRefetch:a})};n.writeQuery({query:vR.F,variables:{convId:t},data:o});return fR(n,t).messageExtensionsAppsState.toggleRefetch}catch(e){throw e}},updateTaskModuleResult:(e,{text:t,taskModuleId:n,draftId:i,card:a,conversationId:o,adaptiveCardTabResult:r,reason:s,entryPoint:l},{cache:d})=>{var c;try{const e={taskModuleResult:{__typename:"TaskModuleResult",text:null!=t?t:null,card:ZM(a),adaptiveCardTabResult:null!==(c=r&&r.map((e=>ZM(e))))&&void 0!==c?c:null,taskModuleId:n,draftId:null!=i?i:null,conversationId:null!=o?o:null,reason:s,entryPoint:l}};return d.writeQuery({query:KM.sR,data:e}),!0}catch(e){return!1}},resetTaskModuleResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:KM.sR,data:{taskModuleResult:null}}),!0}catch(e){return!1}},updateAppDetailsResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No appInstallDetails input received");const{appId:e,appInstallId:i,isAppInstalled:a,errorCode:o}=t,r={appDetailsResult:{__typename:"AppDetailsResult",appInstallId:i,appId:e,isAppInstalled:a,errorCode:o||null}};return n.writeQuery({query:XM.i,data:r}),!0}catch(e){return!1}},updateInContextStoreLaunchInstalledAppResult:(e,{input:t},{cache:n})=>{try{let e;if(t){const{id:n,appId:i,capability:a,appDisplayName:o=null,draftId:r=null}=t;e={inContextStoreLaunchInstalledAppResult:{__typename:"InContextStoreLaunchInstalledAppResult",id:n,appId:i,capability:a,appDisplayName:o,draftId:r}}}else e={inContextStoreLaunchInstalledAppResult:null};return n.writeQuery({query:eR.I,data:e}),!0}catch(e){return!1}},setPlatformAppsFetchPolicy:(e,{input:t},{cache:n,loggerFactory:i,coreSettings:a})=>((e,t,n,i)=>{var a;let o=!0;for(const r of t){let t=!0;const s={__typename:aR,forceNetworkFetch:r.fetchSource===L.p1$.Network,scope:r.scope,convId:null!==(a=r.convId)&&void 0!==a?a:null};t=dR(e,s,n,i),o=o&&t}return o})(n,t,a,i),updateAllPlatformAppsFetchPolicies:(e,{fetchSource:t},{cache:n,loggerFactory:i,scenarioFactory:a})=>{var o;let r=!0;const s=i.newLogger("updateAllPlatformAppsFetchPolicies"),l=a.newScenario(ft.RG.UpdateAllPlatformAppsFetchPolicies),d=uR(n),c=d.length;l.appendEventData({appCount:c});for(const e of d)try{n.writeFragment({id:e,fragment:sR,data:{__typename:aR,forceNetworkFetch:t===L.p1$.Network}})}catch(n){r=!1,null===(o=s.errorToTelemetry)||void 0===o||o.call(s,`updateAllPlatformAppsFetchPolicies: failed to update fetch policy for ${e} to ${t}`,"platform_apps_fetch_policy_update_all_resolver")}return r?(l.stop(),!0):(l.fail(),!1)},updateTabConfigurationResult:(e,{id:t,tabId:n},{cache:i})=>{try{const e={tabConfigurationResult:{__typename:"tabConfigurationResult",id:t,tabId:n}};return i.writeQuery({query:yR.s,variables:{threadId:t},data:e}),!0}catch(e){return!1}},updateMessageToParentResult:(e,{appId:t,message:n},{cache:i})=>{try{const e={messageToParentResult:{__typename:"messageToParentResult",appId:t,message:n}};return i.writeQuery({query:kR.y,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateMessageToChildResult:(e,{appId:t,message:n},{cache:i})=>{try{const e={messageToChildResult:{__typename:"messageToChildResult",appId:t,message:n}};return i.writeQuery({query:SR.n,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateAppButtonSettings:(e,{appId:t,action:n},{cache:i})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={appButtonResult:{__typename:"AppButtonResult",appId:t,action:n}};return i.writeQuery({query:wR.E,variables:{appId:t},data:e}),!0}catch(e){return!1}},updateChangeSettings:(e,{id:t,status:n,appId:i,tabId:a},{cache:o})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={changeSettingsResult:{__typename:"ChangeSettingsResult",id:t,status:n,appId:null!=i?i:null,tabId:null!=a?a:null}};return o.writeQuery({query:bR.L,variables:{id:t},data:e}),!0}catch(e){return!1}},triggerChangeSettings:(e,{id:t,message:n,appId:i,tabId:a},{cache:o})=>{if(!t)throw new Error("Incorrect input received; id is required");try{const e={changeSettingsTriggerResult:{__typename:"ChangeSettingsTriggerResult",id:t,message:n,appId:null!=i?i:null,tabId:null!=a?a:null}};return o.writeQuery({query:CR.N,variables:{id:t},data:e}),!0}catch(e){return!1}},updateSelectMediaResult:(e,{input:t},{cache:n})=>{var i;try{const{selectMediaError:e,mediaUrls:a}=t,o={selectMediaResult:{__typename:"SelectMediaResult",selectMediaError:null!=e?e:null,mediaUrls:null!==(i=a)&&void 0!==i?i:null}};return n.writeQuery({query:gR.a,data:o}),!0}catch(e){return!1}},resetSelectMediaResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:gR.a,data:{selectMediaResult:null}}),!0}catch(e){return!1}},updateViewImagesResult:(e,{input:t},{cache:n})=>{try{const{viewImagesError:e,errorCode:i}=t,a={viewImagesResult:{__typename:"ViewImagesResult",viewImagesError:null!=e?e:null,errorCode:null!=i?i:null}};return n.writeQuery({query:pR.R,data:a}),!0}catch(e){return!1}},resetViewImagesResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:pR.R,data:{viewImagesResult:null}}),!0}catch(e){return!1}},updateMapCoordinateResult:(e,{locationApiResult:t},{cache:n})=>{try{const{latitude:e,longitude:i,locationApiError:a}=t,o={mapCoordinateResult:{__typename:"MapCoordinateResult",latitude:null!=e?e:null,longitude:null!=i?i:null,locationApiError:null!=a?a:null}};return n.writeQuery({query:tR.i,data:o}),!0}catch(e){return!1}},resetMapCoordinateResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:tR.i,data:{mapCoordinateResult:null}}),!0}catch(e){return!1}},resetSelectPeoplePickerResult:(e,t,{cache:n})=>{try{return n.writeQuery({query:nR.k,data:{selectPeoplePickerResult:[]}}),!0}catch(e){return!1}},updateSelectPeoplePickerResult:(e,{selectPeoplePickerResult:t},{cache:n})=>{try{const e={selectPeoplePickerResult:t.map((e=>({__typename:"SelectPeoplePickerResult",objectId:e.objectId,displayName:e.displayName||"",email:e.email||""})))};return n.writeQuery({query:nR.k,data:e}),!0}catch(e){return!1}},updateCustomAppUploadResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No customAppUpload input received");const{customAppType:e}=t,i={customAppUploadResult:{__typename:"CustomAppUploadResult",customAppType:e}};return n.writeQuery({query:NR.kY,data:i}),!0}catch(e){return!1}},updateShowLocationResult:(e,{response:t},{cache:n})=>{try{const e={showLocationResponse:null!=t?t:null};return n.writeQuery({query:TR.F,data:e}),!0}catch(e){return!1}},resetShowLocationResponse:(e,t,{cache:n})=>{try{return n.writeQuery({query:TR.F,data:{showLocationResponse:null}}),!0}catch(e){return!1}},updateWebhookConfirmationResult:(e,{input:t},{cache:n})=>{try{if(!t)throw new Error("No webhookConfirmation input received");const e={webhookConfirmationResult:t};return n.writeQuery({query:IR.S,data:e}),!0}catch(e){return!1}},setAppDevicePermissionsUpdated:(e,{input:t},{cache:n})=>{if(!t||!t.id||!t.status)throw new Error("Incorrect input received; id and status are required");try{const{id:e,status:i}=t,a={appDevicePermissionsUpdated:{__typename:"AppDevicePermissionsUpdated",id:e,status:i}};return n.writeQuery({query:ER.g,data:a,variables:{input:e}}),a.appDevicePermissionsUpdated}catch(e){return null}},addSharedPlatformCachedApps:(e,{input:t},{cache:n,loggerFactory:i})=>_R(t,n,FR,null==i?void 0:i.newLogger("AppCaching resolver: addSharedPlatformCachedApps")),removeSharedPlatformCachedApps:(e,{input:t},{cache:n,loggerFactory:i})=>_R(t,n,MR,null==i?void 0:i.newLogger("AppCaching resolver: removeSharedPlatformCachedApps")),updateSharedPlatformCachedApps:(e,{input:t},{cache:n,loggerFactory:i,coreSettings:a})=>_R(t,n,PR,null==i?void 0:i.newLogger("AppCaching resolver: updateSharedPlatformCachedApps"),a),setLocalFrameContext:(e,{localFrameContext:t},{cache:n})=>{var i,a,o,r,s;try{const e={localFrameContext:{__typename:"LocalFrameContext",id:t.id,threadId:null!==(i=t.threadId)&&void 0!==i?i:null,messageId:null!==(a=t.messageId)&&void 0!==a?a:null,tabId:null!==(o=t.tabId)&&void 0!==o?o:null,websiteUrl:null!==(r=t.websiteUrl)&&void 0!==r?r:null,contentUrl:null!==(s=t.contentUrl)&&void 0!==s?s:null}};return n.writeQuery({query:OR.O,data:e}),e.localFrameContext}catch(e){return null}},resetLocalFrameContext:(e,t,{cache:n})=>{try{return n.writeQuery({query:OR.O,data:{localFrameContext:null}}),null}catch(e){throw e}},setAppsBadgeRead:(e,{isRead:t},{cache:n})=>{try{return n.writeQuery({query:xR.Q,data:{appsBadgeRead:!!t}}),!0}catch(e){return!1}},setBackButtonHandlerState:(e,{backButtonHandlerState:t},{cache:n})=>{var i;try{const e={backButtonHandlerState:{__typename:"BackButtonHandlerState",id:t.id,registered:null!==(i=t.registered)&&void 0!==i&&i}};return n.writeQuery({query:LR.i,data:e}),e.backButtonHandlerState}catch(e){return null}},resetBackButtonHandlerState:(e,t,{cache:n})=>{try{return n.writeQuery({query:LR.i,data:{backButtonHandlerState:null}}),null}catch(e){throw e}}}};var BR=n(759099),jR=n(119653),WR=n(382190),VR=n(821452),HR=n(361286);const $R="mainAppWindowActiveEntities";function zR(){return{__typename:"ActiveEntities",subNavEntity:null,startEntity:null,headerEntity:null,mainEntity:{__typename:"Entity",action:tt.EntityAction.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:De.ew,linkedEntity:null,type:tt.EntityType.blank,options:null,windowOptions:null},endEntity:null,entityExtension:null}}function GR(e,t){return!(!e||!t)&&(e.id===t.id&&e.type===t.type&&e.action===t.action)}function qR(e,t){return!e&&!t||!(!e||!t)&&(e.id===t.id&&e.type===t.type&&e.action===t.action&&(null==e?void 0:e.entityState.flushableByLinkedEntity)===(null==t?void 0:t.entityState.flushableByLinkedEntity)&&(null==e?void 0:e.options)===(null==t?void 0:t.options)&&function(e,t){if(!e&&!t)return!0;if(e&&t)return e.action===t.action&&e.id===t.id&&e.type===t.type;return!1}(null==e?void 0:e.linkedEntity,null==t?void 0:t.linkedEntity))}function QR(e,t,n){const i=new Map,a=new Map;for(const o of e){if(n&&!n(o))continue;const{mainEntity:e,endEntity:r}=o.activeEntities,s=o.userContextId;i.set(t(e,s),[o,e]);const{linkedEntity:l}=e;if(l&&a.set(t(l,s),[o,l]),r){i.set(t(r,s),[o,r]);const{linkedEntity:e}=r;e&&a.set(t(e,s),[o,e])}}return[i,a]}function JR(e,t){return`${e.type}-${e.id}-${t}`}function YR(e){return!!e.activeEntities}function KR(e,t){if(!t)return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:null,endEntity:null,entityExtension:null};const{__typename:n}=t,a=(0,i.__rest)(t,["__typename"]),o=Object.assign({},a);if(!e)return o;const{subNavEntity:r,headerEntity:s,startEntity:l,mainEntity:d,endEntity:c,entityExtension:u}=e,{subNavEntity:m,headerEntity:g,startEntity:p,mainEntity:v,endEntity:h,entityExtension:f}=t;return o.subNavEntity=GR(r,m)?null:m,o.headerEntity=GR(s,g)?null:g,o.startEntity=GR(l,p)?null:p,o.mainEntity=GR(d,v)?null:v,o.endEntity=GR(c,h)?null:h,o.entityExtension=GR(u,f)?null:f,o}function ZR(e,t){const n=YR(e)?e.activeEntities:null,i=YR(t)?t.activeEntities:null;if(!n||!i)return!0;const{subNavEntity:a,headerEntity:o,startEntity:r,mainEntity:s,endEntity:l,entityExtension:d}=n,{subNavEntity:c,headerEntity:u,startEntity:m,mainEntity:g,endEntity:p,entityExtension:v}=i;return!(e.userContextId===t.userContextId&&e.extendedEntityContainerState.containerState===t.extendedEntityContainerState.containerState&&function(e,t){var n,i,a,o;if(e&&t)return(null===(n=e.blockedCommand)||void 0===n?void 0:n.stateTransition)===(null===(i=t.blockedCommand)||void 0===i?void 0:i.stateTransition)&&(null===(a=e.blockedCommand)||void 0===a?void 0:a.visibilityState)===(null===(o=t.blockedCommand)||void 0===o?void 0:o.visibilityState)&&qR(e.blockedEntity,t.blockedEntity)&&e.blockedEntityOptions===t.blockedEntityOptions;if(!e&&!t)return!0;return!1}(e.blockingEntityExtension,t.blockingEntityExtension)&&qR(a,c)&&qR(o,u)&&qR(r,m)&&qR(s,g)&&qR(l,p)&&qR(d,v))}function XR(e,t,n,i){var a;const o=tP(YR(e)?e.activeEntities:null,YR(t)?t.activeEntities:null);return n!==tt.EntityStateTransition.none||"search"===(null===(a=o.endEntity)||void 0===a?void 0:a.type)||"search"===i.type&&eP(o)}function eP(e){return!(e.subNavEntity||e.headerEntity||e.startEntity||e.mainEntity||e.endEntity||e.entityExtension)}function tP(e,t){if(!t)return{subNavEntity:(null==e?void 0:e.subNavEntity)||null,headerEntity:(null==e?void 0:e.headerEntity)||null,startEntity:(null==e?void 0:e.startEntity)||null,mainEntity:(null==e?void 0:e.mainEntity)||null,endEntity:(null==e?void 0:e.endEntity)||null,entityExtension:(null==e?void 0:e.entityExtension)||null};const n=Object.assign({},t);if(!e)return n;const{subNavEntity:i,headerEntity:a,startEntity:o,mainEntity:r,endEntity:s,entityExtension:l}=e,{subNavEntity:d,headerEntity:c,startEntity:u,mainEntity:m,endEntity:g,entityExtension:p}=t;return n.subNavEntity=GR(i,d)?null:null!=d?d:i,n.headerEntity=GR(a,c)?null:null!=c?c:a,n.startEntity=GR(o,u)?null:null!=u?u:o,n.mainEntity=GR(r,m)?null:null!=m?m:r,n.endEntity=GR(s,g)?null:null!=g?g:s,n.entityExtension=GR(l,p)?null:null!=p?p:l,n}function nP(e){return!!(e.mainEntity||e.endEntity||e.entityExtension)}function iP(){return{__typename:"ExtendedEntityContainerState",containerState:L.oqG.Closed,isExternal:!1}}const aP=()=>({id:(0,mt.v4)(),startTimestamp:Date.now().toString(),source:Ot.D.Unknown});function oP(e){if(!e)return null;const{action:t=null,entityState:n={flushableByLinkedEntity:!0},id:i,linkedEntity:a=null,options:o=null,type:r,windowOptions:s=null}=Object.assign({},e);return{action:null!=t?t:tt.EntityAction.view,entityState:{flushableByLinkedEntity:n.flushableByLinkedEntity,__typename:"EntityState"},id:i||null,linkedEntity:a&&sP(a)||null,options:o,type:r,windowOptions:s?Object.assign(Object.assign({},s),{__typename:"WindowOptions"}):null,__typename:"Entity"}}function rP(e,t,n){return{id:e.id||null,type:e.type,action:e.action,options:t||null,windowOptions:n?Object.assign(Object.assign({},n),{__typename:"WindowOptions"}):null,linkedEntity:e.linkedEntity&&sP(e.linkedEntity)||null,entityState:{flushableByLinkedEntity:!0,__typename:"EntityState"},__typename:"Entity"}}function sP(e){return{action:e.action||null,id:e.id?e.id:"emptyLinkedEntityId",type:e.type,__typename:"LinkedEntity"}}const lP=e=>e?Object.assign(Object.assign({},e),{options:null}):null,dP=e=>Object.assign(Object.assign({},e),{subNavEntity:lP(e.subNavEntity),headerEntity:lP(e.headerEntity),startEntity:lP(e.startEntity),mainEntity:lP(e.mainEntity),endEntity:lP(e.endEntity)}),cP=e=>e?(0,li.b)(e):null,uP=(e,t,n)=>{var i;const a=t&&(null===(i=e.getApp({entityType:t.type}))||void 0===i?void 0:i.manifest.id);a&&n.add(a)};function mP({appsRegistryService:e,currentWindowId:t,newReactiveValues:n}){n&&(e.resetAllViewState(t),Object.keys(n).forEach((i=>{e.setReactiveValuesForApp(t,i,n[i])})))}const gP=e=>(e.layoutConfig.slots=pP(),e),pP=()=>{const e={__typename:"SlotLayoutConfig",height:null,isHidden:!1,width:null};return{__typename:"SlotsLayoutConfig",contextualNotifications:e,end:e,header:e,main:e,nav:e,notifications:e,start:e,subNav:e,titleBar:e,toasts:e}};function vP(e,t,n,i,a,o){if(nP(e)){const r=!!yP(e,t),s=!!kP(e,CP),l=!!kP(e,NP),d=!!kP(e,IP),c=!!kP(e,EP),u=!!kP(e,AP),m=!!kP(e,_P),g=!!kP(e,DP),p=!!kP(e,LP),v=!!kP(e,UP),h=!!kP(e,FP),f=!!kP(e,VP),y=!!kP(e,YP),k=!!kP(e,$P),S=!!kP(e,zP),b=!!kP(e,GP),C=function(e,t,n){const{enableNewConsumerTasksChatTabNavigation:i}=t.get(K.J.Chat);return!i&&!!kP(e,(e=>TP(e,n)))}(e,a,o),w=function(e,t){const{enableAliasVisibilitySettingsCommand:n}=t.get(K.J.People);return!n&&!!kP(e,wP)}(e,a),N=function(e,t,n){const{enableReactTaskModuleForBIM:i,launchAngularDialog:a,enableReactWorkflowsInBIM:o,enableReactTaskModuleForHWC:r,enableModernPurchaseFlow:s}=t.get(K.J.Extensibility);return function(e,t,n){return t===De.ew&&!n&&!!kP(e,BP)}(e,n,i)||function(e,t,n){return t===De.ew&&!n&&!!kP(e,jP)}(e,n,r)||function(e,t){return!!t&&!!kP(e,HP)}(e,a)||function(e,t){return!(t||!kP(e,QP)&&!kP(e,JP))}(e,o)||function(e){return!!kP(e,WP)}(e)||function(e,t){return!t&&!!kP(e,qP)}(e,s)}(e,a,t),T=function(e,t){const{enableBrb:n}=t.get(K.J.Brb);return!n&&!!kP(e,xP)}(e,a),I=function(e,t){const{enableHybridChannelList:n,msgEnableChannelsV2:i}=t.get(K.J.Host);return!(i||n||!kP(e,MP))}(e,a),E=function(e,t){const{isCalendarSurfaceHybridArchitectureEnabled:n}=t.get(K.J.Host),i=!!kP(e,OP);if(i&&n)return!1;return i}(e,a),A=function(e,t){const{isSchedulingFormHybridArchitecureEnabled:n}=t.get(K.J.Host),{enableMultiWindowCalendarSchedulingForm:i}=t.get(K.J.Calendar),a=!!kP(e,RP);if(i&&a)return!1;return a&&!n}(e,a),_=function(e,t,n,i,a){const{isSchedulingFormHybridArchitecureEnabled:o}=a.get(K.J.Host),{enableMultiWindowCalendarSchedulingFormViewAndEdit:r}=a.get(K.J.Calendar),s=!!kP(e,PP);if(s&&i)return!1;if(o&&s)return!1;if(r&&s)return!(t!==De.ew||!n);return s}(e,t,n,i,a),D=function(e,t,n,i){const{isChatHybridArchitectureEnabled:a}=t.get(K.J.Host),o=kP(e,bP);let r=!!o;o&&(i.log(`Checking if opener should handle chat ${o.id}: isChatHybridArchitectureEnabled\n      ${a}, and isNotNewNorNoneOnMainContext ${n}`),r=!1===a&&n,i.log(`Opener should handle chat ${o.id} ${r}`));return r}(e,a,n,o);return r||s||l||d||c||u||m||g||p||v||h||f||y||k||S||b||C||w||N||T||I||E||A||_||D}return!1}function hP(e,t,n,i,a){let o=!1,r=null;return r=yP(t,i)||function(e,t){let n=null;return fP.forEach((t=>{const i=kP(e,t);i&&(n=i)})),n||kP(e,(e=>TP(e,t)))}(t,a),r&&(n.report({correlationId:e.id,type:GS.B.NotHandled,context:{target:"openerHandleEntityChange"}}),o=!0),o}const fP=[_P,CP,NP,IP,EP,AP,DP,HP,MP,OP,function(e){return!(!e||e.type!==L.pyR.schedulingform)},$P,zP,xP,LP,UP,BP,bP,FP,VP,YP,GP,qP,QP,JP,wP,WP];function yP(e,t){return t===De.ew?kP(e,SP):null}function kP(e,t){const{mainEntity:n,endEntity:i,entityExtension:a}=e;let o=null;return n&&t(n)&&(o=n),i&&t(i)&&(o=i),a&&t(a)&&(o=a),o}function SP(e){if(!e)return!1;switch(e.type){case L.pyR.channels:return[L.ukP.leave,L.ukP.share].indexOf(e.action)>=0;case L.pyR.channelroster:return e.action===L.ukP.manage;case L.pyR.eduteamcreate:return e.action===L.ukP.view;case L.pyR.teams:return e.action===L.ukP.delete;case L.pyR.channelnotificationsettings:case L.pyR.crosspostchannelselectiondialog:return e.action===L.ukP.view}return[L.pyR.addchannel,L.pyR.addmember,L.pyR.addmembernewteam,L.pyR.broadcastliveevent,L.pyR.channelconnectors,L.pyR.channeldeeplink,L.pyR.channeldelete,L.pyR.channeledit,L.pyR.channelemail,L.pyR.channelmoderators,L.pyR.restorechannel,L.pyR.showChannelOwners,L.pyR.teamarchive,L.pyR.teamcreate,L.pyR.teamdeeplink,L.pyR.teamedit,L.pyR.teamjoincode,L.pyR.teamleave,L.pyR.teampicture,L.pyR.teamrenewal,L.pyR.teamrestore,L.pyR.sharedchannelacceptinvitation,L.pyR.sharedchanneldeclineinvitation,L.pyR.showformemberdialog,L.pyR.stopsharingchannelwithteam].indexOf(e.type)>=0}function bP(e){return e&&e.type===L.pyR.chats}function CP(e){const t=!(!e||e.type!==L.pyR.extensions||e.id!==c.oz.organization);if(t&&!(null==e?void 0:e.linkedEntity))throw(0,Mn.Tr)(De.w5.Commanding,De.jK.Undefined,"CommandChangeNotification",void 0,"Org chart entity defined without a linked entity. Cannot notify host of route change.");return t}function wP(e){return e.type===L.pyR.settingsstore&&e.id===c.oz.privacyManageVisibility}function NP(e){const t=!(!e||e.type!==L.pyR.extensions||e.id!==L.pyR.linkedin);if(t&&!(null==e?void 0:e.linkedEntity))throw(0,Mn.Tr)(De.w5.Commanding,De.jK.Undefined,"CommandChangeNotification",void 0,"LinkedIn entity defined without a linked entity. Cannot notify host of route change.");return t}function TP(e,t){var n;if(e&&e.type===L.pyR.extensions&&e.action===L.ukP.view&&(null===(n=e.linkedEntity)||void 0===n?void 0:n.type)===L.pyR.chats){let n;try{(null==e?void 0:e.id)&&(n=JSON.parse(e.id||"").appId)}catch(e){t.warn("isConsumerTasksChatTab, failed to parse appId")}return!("1ded03cb-ece5-4e7c-9f73-61c375528078"!==n)}return!1}function IP(e){return(null==e?void 0:e.type)===L.pyR.transcripttab}function EP(e){return(null==e?void 0:e.type)===L.pyR.meetingrecaptab}function AP(e){return!(!e||e.type!==L.pyR.platformapps||e.action!==L.ukP.list)}function _P(e){const t=!(!e||e.type!==L.pyR.platformStage||e.action!==L.ukP.view),n=!(!e||e.type!==L.pyR.platformTabGallery);return t||n}function DP(e){return!(!e||e.type!==L.pyR.platformapps||e.action!==L.ukP.manage)}function FP(e){return!(!e||(e.type!==L.pyR.file||e.action!==L.ukP.view)&&e.type!==L.pyR.fileopensettings)}function MP(e){return!(!e||e.type!==L.pyR.channels||!e.id)}function RP(e){return!(!e||e.type!==L.pyR.schedulingform||e.action!==L.ukP.create)}function PP(e){return!(!e||e.type!==L.pyR.schedulingform||e.action!==L.ukP.view)}function OP(e){return!(!e||e.type!==L.pyR.calendar)}function xP(e){return!(!e||e.type!==L.pyR.brbfeedbackdialog)}function LP(e){return!(!e||e.type!==L.pyR.open3sfeedback)}function UP(e){return!(!e||e.type!==L.pyR.livepersonacard)}function BP(e){return!(!e||e.type!==L.pyR.taskmodule)}function jP(e){return!(!e||e.type!==L.pyR.hwctaskmodule)}function WP(e){return!(!e||e.type!==L.pyR.settingsdialog)}function VP(e){return!(!e||e.type!==L.pyR.accounts)}function HP(e){return!(!e||e.type!==L.pyR.platformapp||e.action!==L.ukP.info)}function $P(e){return!(!e||e.type!==L.pyR.platformappdetails||e.action!==L.ukP.config&&e.action!==L.ukP.update)}function zP(e){return!(!e||e.type!==L.pyR.incontextstore||e.action!==L.ukP.config&&e.action!==L.ukP.update)}function GP(e){return!(!e||e.type!==L.pyR.platformapp||e.action!==L.ukP.view)}function qP(e){return!(!e||e.type!==L.pyR.platformsubscriptionplans||e.action!==L.ukP.info)}function QP(e){return!(!e||e.type!==L.pyR.workflows||e.action!==L.ukP.create)}function JP(e){return!(!e||e.type!==L.pyR.workflows||e.action!==L.ukP.manage)}function YP(e){return!(!e||e.type!==L.pyR.customapp||e.action!==L.ukP.create)}var KP=n(264091);const ZP=e=>{var t,n,i;return null!==(i=null!==(n=null!==(t=e.subNavEntity)&&void 0!==t?t:e.headerEntity)&&void 0!==n?n:e.startEntity)&&void 0!==i?i:e.mainEntity},XP=({entity:e,currentEntities:t,shouldUseNewEntity:n})=>{var i;return n?{appEntity:null!==(i=e.linkedEntity)&&void 0!==i?i:e,contextEntity:e.linkedEntity?e:null}:t?{appEntity:ZP(t),contextEntity:e}:{appEntity:e,contextEntity:null}},eO=({appsRegistryService:e,clientPreferences:t,contextEntity:n,coreSettings:i,entity:a,layoutMode:o})=>{if(!a)throw new Error("entity used to match app is null");const r=e.getApp({entityType:a.type});if(r&&r.getAppViewEntities)return r.getAppViewEntities({contextEntity:n,coreSettings:i,entity:a,layoutMode:o,userPreferences:{infoPane:t.getPreferences("infoPane"),teamLayout:t.getPreferences("teamLayout")}})},tO={[L.tF7.subNavEntity]:{children:[L.tF7.headerEntity,L.tF7.startEntity,L.tF7.mainEntity,L.tF7.endEntity]},[L.tF7.headerEntity]:{children:[L.tF7.startEntity,L.tF7.mainEntity,L.tF7.endEntity]},[L.tF7.startEntity]:{children:[L.tF7.mainEntity,L.tF7.endEntity]},[L.tF7.mainEntity]:{children:[L.tF7.endEntity]},[L.tF7.endEntity]:{children:null}};function nO(e){return e&&e.viewEntityName?e.viewEntityName:L.tF7.subNavEntity}function iO({executionContext:e,viewEntityName:t}){return nO(e)===t}function aO({executionContext:e,viewEntityName:t}){const n=nO(e),{children:i}=tO[n];return!(!i||!i.includes(t))}const oO=(e,t,n)=>{var i;const{coreSettings:a}=t,{enableHybridExperienceRendererLayout:o}=a.get(K.J.Host),{activeEntities:{subNavEntity:r,headerEntity:s,startEntity:l,mainEntity:d,endEntity:c},layoutConfig:{layoutMode:u}}=e,m=(null===(i=t.authenticationUser)||void 0===i?void 0:i.role)===L.w4O.Anonymous,g=d.type===L.pyR.identity,p=d.type===L.pyR.tflfre,v=d.type===L.pyR.callsmonitor,h=d.type===L.pyR.error,f=d.type===L.pyR.pearnotdefaultapp,y=d.type===L.pyR.search||d.type===L.pyR.tflfre,k="newchat"===d.id,S=rO(e,t,m),b=u===L.lOW.standard;return{subNavSlotConfig:sO(!!o&&b,r,L.WLT.SUBNAV,L.tF7.subNavEntity,L.OQr.Rail,t,n),headerSlotConfig:sO(!k,s,L.WLT.HEADER,L.tF7.headerEntity,L.OQr.HorizontalBar,t,n),startSlotConfig:sO(!!o,l,L.WLT.START,L.tF7.startEntity,L.OQr.Rail,t,n),mainSlotConfig:sO(!0,d,L.WLT.MAIN,L.tF7.mainEntity,L.OQr.Main,t,n),endSlotConfig:sO(!0,c,L.WLT.END,L.tF7.endEntity,L.OQr.Rail,t,n),navSlotConfig:lO(!!o&&b&&!g&&!m&&!p&&!f,L.WLT.NAV,L.tF7.mainEntity,L.OQr.VerticalBar,t,n),notificationsSlotConfig:lO(!(h||v),L.WLT.NOTIFICATIONS,L.tF7.mainEntity,L.OQr.ThinHorizontalBar,t,n),titleBarSlotConfig:y?sO(S,d,L.WLT.TITLE_BAR,L.tF7.mainEntity,L.OQr.TitleBar,t,n):lO(S,L.WLT.TITLE_BAR,L.tF7.mainEntity,L.OQr.TitleBar,t,n),toastsSlotConfig:lO(!0,L.WLT.TOASTS,L.tF7.mainEntity,L.OQr.PartialOverlay,t,n),configurationsSlotConfig:lO(!0,L.WLT.CONFIGURATIONS,L.tF7.mainEntity,L.OQr.Configurations,t,n),contextualNotificationsSlotConfig:lO(!0,L.WLT.CONTEXTUAL_NOTIFICATIONS,L.tF7.mainEntity,L.OQr.OverlayThinHorizontalBar,t,n),__typename:"SlotsConfig"}},rO=(e,t,n)=>{const{activeEntities:{mainEntity:i},layoutConfig:{layoutMode:a,isFullscreen:o}}=e,{platformService:r,coreSettings:s}=t,{disableTitleBarForEntityType:l}=s.get(K.J.Core);let{enableTitleBar:d}=s.get(K.J.Core);const{enableHybridExperienceRendererLayout:c}=s.get(K.J.Host),u=(null==r?void 0:r.config.clientType)===Ye.Bh.Web;l&&(d=d&&!l.some((e=>e===i.type))),d=d&&!(e.isMainWindow&&!r.config.isInCypressFrame);d=!(!(c&&a===L.lOW.standard)&&!d);return!(i.type===L.pyR.attendeeview||n&&u||!d||o)},sO=(e,t,n,i,a,{appsRegistryService:o},r)=>{var s;const l=((null==t?void 0:t.type)===L.pyR.search||(null==t?void 0:t.type)===L.pyR.tflfre)&&n===L.WLT.TITLE_BAR,d=t&&(null===(s=o.getApp({entityType:t.type===L.pyR.framework||l?void 0:t.type,renderMode:a}))||void 0===s?void 0:s.manifest.id);return!d&&t&&t.type&&t.type!==L.pyR.framework?r.error(`No app found for entityType:${t.type} and appRenderMode:${a} in slot ${n}`):e&&t&&d&&r.log(`SlotConfig -\nentityType:${t.type}\nentityAction:${t.action}\nslotName:${n},\nviewEntityName:${i},\nappRenderMdoe:${a},\nappId:${d}`),e&&t&&d?{entity:t,slotName:n,viewEntityName:i,appRenderMode:a,appId:d,__typename:"SlotConfig"}:null},lO=(e,t,n,i,a,o)=>sO(e,{action:L.ukP.view,id:null,linkedEntity:null,options:null,type:L.pyR.framework,windowOptions:null,entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"},__typename:"Entity"},t,n,i,a,o);function dO(e,t,n=e.windowHistory.length-1){if(!YR(e))return;const i=e.windowHistoryNavigationState,a=e.windowHistory;e.currentWindowHistoryIndex=n;const o=a.length>0&&a[a.length-1].activeEntities.mainEntity,r=e.activeEntities.mainEntity,s=!!o&&GR(o,r);i.canNavigateBack=!(0===a.length||1===a.length&&s)&&n>0,i.canNavigateForward=n<e.windowHistory.length-1;let l=n;n!==e.windowHistory.length-1&&(l=n-1),i.backHistory=cO(0,l,e.windowHistory);const d=i.backHistory,c=e.activeEntities.mainEntity;d.length>0&&GR(c,d[d.length-1].entity)&&(d.pop(),t.debug("windowHistoryNavigationState back history entry was popped.")),i.backHistory=d.reverse().slice(0,10),i.forwardHistory=cO(n+1,e.windowHistory.length-1,e.windowHistory).slice(0,10),t.debug(`Reset windowHistoryNavigationState. size: ${e.windowHistory.length}, windowHistoryIndex: ${n}`),t.debug(`Reset windowHistoryNavigationState. canNavigateBack: ${i.canNavigateBack}, canNavigateForward: ${e.windowHistoryNavigationState.canNavigateForward}, backHistory size: ${e.windowHistoryNavigationState.backHistory.length}, forwardHistory size: ${i.forwardHistory.length}`)}function cO(e,t,n){if(!n)return[];const i=[];for(let a=e;a<=t;a++)i.push({__typename:"WindowHistoryNavigationItem",windowHistoryIndex:a,entity:n[a].activeEntities.mainEntity});return i}const uO=(e,t,n)=>{const i=i=>!i||n(t.getApp({entityType:i.type}),{mainEntity:e.mainEntity,subNavEntity:e.subNavEntity});return i(e.mainEntity)&&i(e.subNavEntity)};function mO({appIdsForReactiveVarChange:e,context:t,isUserContextSwitch:n,logger:i,newActiveEntities:a,windowContentState:o}){const{appsRegistryService:r,windowProvider:s,clientPreferences:l,coreSettings:d}=t,{currentWindowHistoryIndex:c,windowId:u}=o;let{windowHistory:m}=o;const{enableHostHistoryNavigation:g}=d.get(K.J.Core);n&&(m=[]);const p=gO(a,r,l,d,o.layoutMode),v=((e,t)=>{const{subNavEntity:n,headerEntity:i,startEntity:a,mainEntity:o,endEntity:r}=t,s=new Set;return uP(e,n,s),uP(e,i,s),uP(e,a,s),uP(e,o,s),uP(e,r,s),s})(r,p);if(e&&!e.some((e=>v.has(e))))return i.log(`Not storing rv change to history b/c rv changes made for app not being stored in history ${e} `),[m,!1];if(!((e,t,n)=>uO(e,t,((e,t)=>{var i,a;try{return!(null===(i=null==e?void 0:e.onBeforeAddToNavigation)||void 0===i?void 0:i.shouldAddEntitiesToWindowHistory)||e.onBeforeAddToNavigation.shouldAddEntitiesToWindowHistory(t)}catch(t){return null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`App ${e.manifest.name} failed to execute entity command hook 'ShouldAddEntitiesToWindowHistory' with ""${t.name}"" error`,"entity_command_hook",{errors:`${t.name}`},!0),!0}})))(p,r,i))return i.log("Not saving to history b/c app shouldAddEntitiesToWindowHistory hook has returned false"),[m,!1];const h={};v.forEach((e=>{const{navigationalReactiveValues:t,nonNavigationalReactiveValues:n}=r.getAppViewStateForWindow(u,e)||{};(t||n)&&(h[e]=(e=>{if(!e)return;let t={};return t=Object.keys(e).reduce(((t,n)=>{const i=e[n];return Object.assign(Object.assign({},t),{[n]:i.read()})}),{}),t})(Object.assign(Object.assign({},t),n)))})),c<m.length-1&&(m=m.slice(0,c+1),i.debug(`Reset windowHistory navigation path after index ${c}.`));let f=m;const y=m[m.length-1];return(!y||e||nP(KR(a,y.activeEntities)))&&(f=[...m,{__typename:"WindowHistoryItem",activeEntities:p,reactiveVars:h}],g&&(s.history.pushState({windowHistoryIndex:f.length-1},""),i.debug(`Added browser history entry with windowHistoryIndex: ${f.length}.`))),[f,!0]}const gO=(e,t,n,i,a)=>{const o=t.getApp({entityType:ZP(e).type});return o&&o.manifest.shouldDeferNavigationToMainSlotApp?pO(e,t,n,i,a):e},pO=(e,t,n,i,a)=>{const{appEntity:o,contextEntity:r}=XP({currentEntities:e,entity:e.mainEntity,shouldUseNewEntity:!0}),s=eO({appsRegistryService:t,clientPreferences:n,contextEntity:r,coreSettings:i,entity:o,layoutMode:a});return s&&s.mainEntity?{endEntity:oP(s.endEntity),headerEntity:oP(s.headerEntity),mainEntity:oP(s.mainEntity)||e.mainEntity,startEntity:oP(s.startEntity),subNavEntity:oP(s.subNavEntity),entityExtension:null,__typename:"ActiveEntities"}:e};function vO(e,t,n=!0){var i;try{const{activeWindows:t=[]}=e.readQuery({query:KP.i8})||{};return n?(0,a.cloneDeep)(t):t}catch(e){return null===(i=t.errorToTelemetry)||void 0===i||i.call(t,`activeWindowsQuery cache read failed - ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),t.debug("activeWindowsQuery entry not found in cache"),[]}}function hO(e,t,n,i,a){var o;const{cache:r,commandChangeReportingService:s}=e;if(n&&YR(n)){const t=((e,t)=>{const n=t.loggerFactory.newLogger("getCoreViewState");return{slotsConfig:oO(e,t,n),__typename:"CoreViewState"}})(n,e);n=Object.assign(Object.assign({},n),{coreViewState:t})}const l=a||(null==n?void 0:n.correlation.id)||(0,mt.v4)(),d=n?function(e,t,n,i){var a;let o;const r=t.slice(0);if(YR(e)){const t=r.findIndex((t=>t.id===e.id));o=e,-1===t?r.push(o):r[t]=o}else{const t=e.windowHistory.length;if(t>0&&!e.windowHistory[t-1].activeEntities)throw null===(a=n.errorToTelemetry)||void 0===a||a.call(n,"Unable to resolve active entities, trying to pop back to empty window","webclient_framework_foundation_core_services_entity_commanding"),(0,Mn.Tr)(De.w5.Commanding,De.jK.Undefined,"executeEntityCommand",e.correlation,"Unable to resolve to active entities");o=r.splice(r.findIndex((t=>t.id===e.id)),1)[0],n.log(`Window has no active entities so destroying for correlation ${i}`)}return r}(n,t,i,l):t;try{r.writeQuery({query:KP.i8,data:{activeWindows:d}})}catch(e){return null===(o=i.errorToTelemetry)||void 0===o||o.call(i,`activeWindowsQuery cache write failed - ${e.message}`,"webclient_framework_foundation_core_services_entity_commanding",void 0,!0),s.report({correlationId:l,type:GS.B.Failure,context:{target:"executeEntityCommand",errorInfo:qS.y.WindowCacheFailedToUpdate,errorMessage:e.message}}),!1}return n&&yO(d,n,i,e),n&&fO(e,d,n,l),i.log(`After updating window cache, there are ${d.length} active windows`),!0}const fO=({appsRegistryService:e,experienceChangeReportingService:t},n,i,a)=>{if(YR(i)&&SO(n,i.id)){const n=ZP(i.activeEntities),o=e.getPlatformAppIdForEntity(n);t.report({correlationId:a,type:bb.yU.AppSelectionChanged,context:{target:"entity-command-resolver",appId:o}})}},yO=(e,t,n,{appsRegistryService:i,clientPreferences:a,coreSettings:o,localStorage:r})=>{var s,l,d,c;const{enableWriteActiveEntitiesToLocalStorage:u,enableWriteAppHistoryToLocalStorage:m}=o.get(K.J.Core);if(YR(t)&&SO(e,t.id)&&(((e,t,n)=>uO(e,t,((e,t)=>{var i,a;try{return!(null===(i=null==e?void 0:e.onBeforeAddToNavigation)||void 0===i?void 0:i.shouldRestoreClientToEntities)||e.onBeforeAddToNavigation.shouldRestoreClientToEntities(t)}catch(t){return null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`App ${e.manifest.name} failed to execute entity command hook 'ShouldRestoreClientToEntities' with ""${t.name}"" error`,"entity_command_hook",{errors:`${t.name}`},!0),!0}})))(t.activeEntities,i,n)&&u&&r.set($R,JSON.stringify({activeEntities:t.activeEntities,userContextId:t.userContextId}),NT.f.Experience),m)){const{activeEntities:e}=t,n=ZP(e),u=i.getApp({entityType:n.type});if(null===(l=null===(s=null==u?void 0:u.onBeforeAddToNavigation)||void 0===s?void 0:s.shouldStoreLastVisitedInAppHistory)||void 0===l?void 0:l.call(s,e.mainEntity)){const e=null==u?void 0:u.manifest.id;r.set(`appActiveEntitiesHistory-${e}`,JSON.stringify(dP(t.activeEntities)))}else if(null==u?void 0:u.manifest.shouldDeferNavigationToMainSlotApp){const n=i.getApp({entityType:e.mainEntity.type}),s=null==n?void 0:n.manifest;if(null===(c=null===(d=null==n?void 0:n.onBeforeAddToNavigation)||void 0===d?void 0:d.shouldStoreLastVisitedInAppHistory)||void 0===c?void 0:c.call(d,e.mainEntity)){const n=pO(e,i,a,o,t.layoutConfig.layoutMode);r.set(`appActiveEntitiesHistory-${null==s?void 0:s.id}`,JSON.stringify(dP(n)))}}}},kO=(e,t)=>e.find((e=>e.layoutConfig.layoutMode===t&&e.isMainWindow)),SO=(e,t)=>{const n=kO(e,tt.LayoutModes.standard);return t===De.ew||t===(null==n?void 0:n.id)};function bO(e,t){const n=e.get(t);return n&&n[0]}function CO(e,t){return e.find((e=>e.id===t))}function wO(e,t,n,i,a){let o=bO(t,JR(e,i));const{linkedEntity:r}=e;let s=!1;!o&&r&&(o=bO(t,JR(r,i)),s=!!o),!o&&e.id&&(o=bO(n,JR({id:e.id,type:e.type},i)),s=!!o);const{enableLinkedEntityMatching:l}=a.get(K.J.Core);return l&&!o&&r&&(o=bO(n,JR(r,i)),s=!!o),[o,s]}function NO({pubsub:e,fromWindowId:t,isFromWindowMain:n,sourceWindowId:i,diff:a,targetWindow:o,targetVisibilityState:r,stateTransition:s,correlation:l,logger:d}){!function(e,t,n,i,a,o,r){YR(o)&&o.id!==De.ew&&TO(t,a)&&(n.log(`Focusing window ${r} for correlation ${e.id}`),i.publish(`windowStateEvent-${r}`,{windowStateEvent:{isFocused:!0,correlation:e}}))}(l,a,d,e,r,o,i),function(e,t,n,i,a,o,r,s,l){!TO(t,s)||i||l.id===n||r!==tt.EntityStateTransition.flush&&r!==tt.EntityStateTransition.forceFlush||(a.log(`Closing ${n} for correlation ${e.id}`),o.publish(`windowStateEvent-${n}`,{windowStateEvent:{correlation:e,shouldClose:!0}}))}(l,a,t,n,d,e,s,r,o)}function TO(e,t){return t===tt.EntityVisibilityState.show||t===tt.EntityVisibilityState.toggle&&nP(e)}const IO=(e,t,n,i,a)=>{e.activeEntities=e.windowHistory[t].activeEntities;const o=(e=gP(e)).windowHistory[t].reactiveVars;return mP({appsRegistryService:a.appsRegistryService,currentWindowId:e.id,newReactiveValues:o}),dO(e,n,t),hO(a,i,e,n)};function EO(e){if(!e)return"{}";const{id:t,type:n,action:i,linkedEntity:a,entityState:o}=Object.assign({},e);return`{\n    id: ${t}, \n    type: ${n}, \n    action: ${i}, \n    linkedEntity: { \n      id: ${a&&a.id}, \n      type: ${a&&a.type}}, \n    entityState: {\n      flushableByLinkedEntity: ${null==o?void 0:o.flushableByLinkedEntity}\n    }\n  }`}function AO(e){return e?`{\n    id: ${e.id}\n    startTimestamp: ${e.startTimestamp},\n    source: ${e.source}\n  }`:"{}"}function _O(e,t){const{id:n,correlation:i,isMainWindow:a,layoutConfig:{layoutMode:o}}=e;t.log(`{\n    id: ${n},\n    correlation: ${AO(i)},\n    isMainWindow: ${a},\n    layoutMode: ${o} \n  }`),YR(e)?(t.log("activeEntities for window:"),function(e,t){const{subNavEntity:n,headerEntity:i,startEntity:a,mainEntity:o,endEntity:r,entityExtension:s}=e;n&&t.log(`subNavEntity: ${EO(n)}`),i&&t.log(`headerEntity: ${EO(i)}`),a&&t.log(`startEntity: ${EO(a)}`),t.log(`mainEntity: ${EO(o)}`),r&&t.log(`endEntity: ${EO(r)}`),s&&t.log(`entityExtension: ${EO(s)}`)}(e.activeEntities,t)):t.log("activeEntities: undefined")}function DO(e,t){if(void 0===e)return t.log("undefined - app not ported to multi slot");if(null===e)return t.log("null - no app supports this entity");const{subNavEntity:n,headerEntity:i,startEntity:a,mainEntity:o,endEntity:r}=e;n&&t.log(`subNavEntity: ${EO(n)}`),i&&t.log(`headerEntity: ${EO(i)}`),a&&t.log(`startEntity: ${EO(a)}`),o&&t.log(`mainEntity: ${EO(o)}`),r&&t.log(`endEntity: ${EO(r)}`)}function FO(e,t,{entity:n,stateTransition:i,logger:a,window:o,correlation:r,commandChangeReportingService:s,entityOptions:l}){var d,c;if(!o.blockingEntityExtension)throw(0,Mn.Tr)(De.w5.Commanding,De.jK.Undefined,"executeEntityCommand",o.correlation,"Unable to resolve blockingEntityExtension");const u={activeEntities:t,windowHistory:[...o.windowHistory],currentWindowHistoryIndex:o.windowHistory.length-1,layoutMode:o.layoutConfig.layoutMode,userContextId:o.userContextId,windowId:o.id};a.log("Blocking command transition due to blockingEntityExtension");const m=iP();u.activeEntities=Object.assign(Object.assign({},t),{entityExtension:o.blockingEntityExtension.entity});const g=Object.assign(Object.assign({},o.blockingEntityExtension),{blockedEntity:n,blockedEntityOptions:l||null,blockedCommand:{stateTransition:i,visibilityState:e,correlation:r,__typename:"EntityCommand"}});s.report({correlationId:r.id,type:GS.B.CommandMetaDataAdded,context:{target:"blockTransitionAndShowExtension",transitionBlockedByExtension:!0}});const p=o.windowHistoryNavigationState,v=Object.assign(Object.assign({},p),{backHistory:[...null!==(d=p.backHistory)&&void 0!==d?d:[]],forwardHistory:[...null!==(c=p.forwardHistory)&&void 0!==c?c:[]]});return Object.assign(Object.assign(Object.assign({},o),u),{correlation:r,extendedEntityContainerState:m,blockingEntityExtension:g,windowHistoryNavigationState:v})}const MO=(e,t,n)=>{const i=e.activeEntities.entityExtension;if(!i)return t.error(`Unable to create hide command for extension in the given window. The window does not have an active extension. Window ID: ${e.id}`),null;const a=aP();a.source=Ot.D.CoreResolvers;const o={correlation:a,stateTransition:tt.EntityStateTransition.extend,visibilityState:tt.EntityVisibilityState.hide};return n.report({type:GS.B.CommandStart,correlationId:a.id,context:{target:"createAndRegisterHideExtensionCommand",entityCommand:{entity:i,command:Object.assign(Object.assign({},o),{correlation:Object.assign(Object.assign({},a),{startTimestamp:parseInt(a.startTimestamp,10)})})}}}),{entity:i,command:o}},RO=(e,t,n)=>{var i;if(YR(e)){const a=MO(e,t,n),o=null===(i=null==a?void 0:a.command.correlation)||void 0===i?void 0:i.id;o&&(t.log(`Closing external dialog, sending hide command with new correlation ${o}`),n.report({type:GS.B.NotHandled,correlationId:o,context:{target:"sendHideExternalExtensionCommand"}}))}},PO=(e,t,n,i,a)=>{const{commandChangeReportingService:o}=a;e.extendedEntityContainerState.isExternal?(n.log(`Routing externally - closing external dialog for correlation ${i.id}`),RO(e,n,o)):(n.log(`Routing externally - closing BIM dialog from command with correlation ${i.id}`),((e,t,n,i,a)=>{YR(t)&&hO(a,n,OO(t,i),e)})(n,e,t,i,a))};function OO(e,t){const{activeEntities:n}=e;return Object.assign(Object.assign({},e),{correlation:t,extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),{containerState:L.oqG.Closed}),activeEntities:Object.assign(Object.assign({},n),{entityExtension:null})})}const xO="webclient_framework_foundation_core_services_entity_commanding";function LO(e,t,n,i,a){let o;const{windowHistory:r,activeEntities:s}=e;let l=r;const{appsRegistryService:d}=n,c=r.slice().reverse().find((e=>{return t=s,n=e.activeEntities,i=ZP(t),a=ZP(n),!(i.type===a.type&&i.action===a.action);var t,n,i,a}));if(c){o=c.activeEntities,mP({appsRegistryService:d,currentWindowId:e.id,newReactiveValues:c.reactiveVars});const i={activeEntities:s,windowHistory:r,currentWindowHistoryIndex:e.currentWindowHistoryIndex,layoutMode:e.layoutConfig.layoutMode,userContextId:e.userContextId,windowId:e.id};[l]=mO({context:n,isUserContextSwitch:!1,logger:a,newActiveEntities:o,windowContentState:i}),a.log(`Found app switch in window history ${t.id}`)}else if(a.log(`No app switch found in history ${t.id}`),e.id===De.ew){const r=d.getDefaultCommand(n.coreSettings);if(r){a.log(`Using default command for main window ${t.id}`);const o=aP();return o.source=Ot.D.CoreResolvers,a.log(`Sending new command with correlation ${o.id}`),ax({entity:r,command:{stateTransition:L.suD.forceFlush,visibilityState:L.feW.show,correlation:o},windowId:e.id,clientLaunchId:e.correlation.clientLaunchId},n,i)||Object.assign(Object.assign({},e),{correlation:t,activeEntities:void 0})}o=zR()}else a.log(`No app switch found in child window ${e.id}, so should close ${t.id}`);return Object.assign(Object.assign({},e),{correlation:t,activeEntities:o,windowHistory:l})}function UO({appsRegistryService:e,commandChangeReportingService:t,correlation:n,entitiesMap:i,entity:a,logger:o,userContextId:r,window:s}){const{id:l}=n;return o.log(`Hiding main entity and popping history - ${EO(a)} and correlation ${l}`),t.report({correlationId:n.id,type:GS.B.CommandMetaDataAdded,context:{target:"hideMainEntity",popWindowHistory:!0}}),function({window:e,entitiesMap:t,correlation:n,logger:i,userContextId:a,appsRegistryService:o}){let r;const{windowHistory:s,activeEntities:l}=e;let d=s[s.length-1];if(eP(tP(l,(null==d?void 0:d.activeEntities)||null))&&(s.pop(),d=s[s.length-1]),d){if(bO(t,JR(d.activeEntities.mainEntity,a))||d.activeEntities.endEntity&&bO(t,JR(d.activeEntities.endEntity,a)))return r=void 0,o.resetAllViewState(e.id),Object.assign(Object.assign({},e),{correlation:n,activeEntities:r});r=d.activeEntities,mP({appsRegistryService:o,currentWindowId:e.id,newReactiveValues:d.reactiveVars}),dO(e,i)}else e.id===De.ew&&(r=zR(),o.resetAllViewState(e.id));return Object.assign(Object.assign({},e),{correlation:n,activeEntities:r})}({window:s,entitiesMap:i,correlation:n,logger:o,userContextId:r,appsRegistryService:e})}function BO({activeEntities:e,correlation:t,entity:n,logger:i,window:a}){const o=a;return GR(e.startEntity,n)?(i.log(`Hiding start entity - ${EO(n)} and correlation ${t.id}`),Object.assign(Object.assign({},o),{activeEntities:Object.assign(Object.assign({},e),{startEntity:null}),correlation:t})):GR(e.endEntity,n)?(i.log(`Hiding end entity - ${EO(n)} and correlation ${t.id}`),Object.assign(Object.assign({},o),{activeEntities:Object.assign(Object.assign({},e),{endEntity:null}),correlation:t})):void 0}function jO(e,t,n){var{commandChangeReportingService:a,correlation:o,enableMultiSlotHide:r,entitiesMap:s,entity:l,logger:d,stateTransition:c,window:u}=e,m=(0,i.__rest)(e,["commandChangeReportingService","correlation","enableMultiSlotHide","entitiesMap","entity","logger","stateTransition","window"]);if(YR(u)){const{activeEntities:e}=u;if(u.blockingEntityExtension&&c!==L.suD.extend)return FO(L.feW.hide,e,Object.assign({commandChangeReportingService:a,correlation:o,enableMultiSlotHide:r,entitiesMap:s,entity:l,logger:d,stateTransition:c,window:u},m));if(c===L.suD.forceFlush&&function(e,t){return GR(e,t.subNavEntity)||GR(e,t.headerEntity)||GR(e,t.mainEntity)}(l,e))return function({commandChangeReportingService:e,correlation:t,logger:n,window:i},a,o){const{id:r}=t;if(!YR(i))return i;n.log(`Closing app with correlation correlation ${r}`);const s=LO(i,t,a,o,n),l=YR(s)?ZP(s.activeEntities):void 0;return e.report({correlationId:t.id,type:GS.B.CommandMetaDataAdded,context:{target:"closeApp",popWindowHistory:!1,entityDisplayedAfterHide:YR(s)?{mainEntity:s.activeEntities.mainEntity,contextEntity:l}:void 0}}),s}(Object.assign({commandChangeReportingService:a,correlation:o,enableMultiSlotHide:r,entitiesMap:s,entity:l,logger:d,stateTransition:c,window:u},m),t,n);if((!r||c===L.suD.flush)&&GR(e.mainEntity,l))return a.report({correlationId:o.id,type:GS.B.Hidden,context:{target:"handleHideCommandAction"}}),UO(Object.assign({commandChangeReportingService:a,correlation:o,enableMultiSlotHide:r,entitiesMap:s,entity:l,logger:d,stateTransition:c,window:u},m));if(!r||c===L.suD.none){const t=BO({entity:l,logger:d,window:u,correlation:o,activeEntities:e});if(t)return a.report({correlationId:o.id,type:GS.B.Hidden,context:{target:"handleHideCommandAction"}}),t}if(GR(e.entityExtension,l))return d.log(`Closing extended entity container with correlation ${o.id}`),OO(u,o);a.report({correlationId:o.id,type:GS.B.Incomplete,context:{target:"handleHideCommandAction"}}),d.warn(`Hide command issued for an entity but that entity is not present - ${EO(l)}`)}else d.warn(`Hide command issued for an entity but are no active entities - ${EO(l)}`);return u}function WO({appViewEntities:e,commandChangeReportingService:t,coreSettings:n,correlation:i,enableMultiSlotNone:a,entity:o,executionContext:r,logger:s,userContextId:l,window:d}){var c;let u;const m={activeEntities:GO(d),windowHistory:[...d.windowHistory],currentWindowHistoryIndex:d.currentWindowHistoryIndex,layoutMode:d.layoutConfig.layoutMode,userContextId:d.userContextId,windowId:d.id},{enableMTMACommanding:g}=n.get(K.J.Core);if(g&&l!==d.userContextId)throw null===(c=s.errorToTelemetry)||void 0===c||c.call(s,"Different user context sent for toggle command",xO),new Error("Different user context sent for toggle command");if(YR(d)){const{activeEntities:n}=d,l=BO({activeEntities:n,correlation:i,entity:o,logger:s,window:d});if(l)return function({commandChangeReportingService:e,correlation:t,logger:n,newEntity:i}){e.report({correlationId:t.id,type:GS.B.Toggled,context:{target:"logHideToggle"}}),n.log(`Toggling entity (hide) - ${EO(i)} and correlation ${t.id}`)}({commandChangeReportingService:t,logger:s,newEntity:o,correlation:i}),l;GR(n.mainEntity,o)||(t.report({correlationId:i.id,type:GS.B.Incomplete,context:{target:"handleToggleCommandAction"}}),s.log(`Toggling end entity (show) - ${EO(o)} and correlation ${i.id}`),u=qO({activeEntities:n,appViewEntities:e,correlation:i,enableMultiSlotNone:a,executionContext:r,logger:s,newEntity:o,windowContentState:m}).activeEntities)}else t.report({correlationId:i.id,type:GS.B.Incomplete,context:{target:"handleToggleCommandAction"}}),s.warn(`Toggle command only supported when active entities set - ${o}`);return Object.assign(Object.assign({},d),{correlation:i,activeEntities:u})}function VO({activeEntities:e,stateTransition:t,executionContext:n}){const i=e.mainEntity.entityState.flushableByLinkedEntity,a=!e.endEntity||e.endEntity.entityState.flushableByLinkedEntity,o=aO({executionContext:n,viewEntityName:L.tF7.mainEntity});return t===L.suD.forceFlow||o&&i&&t===L.suD.flow||!o&&a&&t===L.suD.flow}function HO({mainEntity:e,entity:t,stateTransition:n,matchedLinkedEntity:i}){const a=e.entityState.flushableByLinkedEntity;return n===L.suD.forceFlush||a&&(n===L.suD.flush||n===L.suD.new)||i&&t.type!==L.pyR.chats&&t.type!==L.pyR.devicesettings&&t.type!==L.pyR.contentcamerasetup&&t.type!==L.pyR.transcript&&t.type!==L.pyR.meetingdetails&&t.type!==L.pyR.roster&&t.type!==L.pyR.accessibilitypanel}function $O(e,t){const n={__typename:"Entity",action:L.ukP.view,entityState:{__typename:"EntityState",flushableByLinkedEntity:!0},id:null,linkedEntity:null,type:L.pyR.hybridplaceholder,options:null,windowOptions:null};return t===L.c$2.Activity||t===L.c$2.NonHybridLeftRail?n:oP(e)}function zO({currentEntity:e,entityFromAppViewEntities:t,isExecutionContextUpstreamOfEntity:n}){const i=!e||e.entityState.flushableByLinkedEntity;return n&&i&&!!t}function GO(e){return YR(e)?e.activeEntities:void 0}function qO({activeEntities:e,appViewEntities:t,correlation:n,enableMultiSlotNone:i,executionContext:a,logger:o,newEntity:r,windowContentState:s}){return i&&t?(o.log("Using multi slot none behavior"),function({activeEntities:e,appViewEntities:t,executionContext:n,windowContentState:i}){return Object.assign(Object.assign({},i),{activeEntities:Object.assign(Object.assign({},e),{startEntity:zO({currentEntity:e.startEntity,entityFromAppViewEntities:t.startEntity,isExecutionContextUpstreamOfEntity:aO({executionContext:n,viewEntityName:L.tF7.startEntity})||iO({executionContext:n,viewEntityName:L.tF7.startEntity})})?oP(t.startEntity):e.startEntity,endEntity:zO({currentEntity:e.endEntity,entityFromAppViewEntities:t.endEntity,isExecutionContextUpstreamOfEntity:aO({executionContext:n,viewEntityName:L.tF7.endEntity})||iO({executionContext:n,viewEntityName:L.tF7.endEntity})})?oP(t.endEntity):e.endEntity})})}({activeEntities:e,appViewEntities:t,executionContext:a,windowContentState:s})):(o.log("Falling back to default none behavior"),function(e,t,n,i,a){return i.log(`Adding as end entity - ${EO(n)} and correlation ${a}`),Object.assign(Object.assign({},e),{activeEntities:Object.assign(Object.assign({},t),{endEntity:n})})}(s,e,r,o,n.id))}function QO(e,t){var n,a,o,{appViewEntities:r,correlation:s,enableMultiSlotNone:l,entity:d,executionContext:c,isInputDefaultEntity:u,logger:m,matchedLinkedEntity:g,sourceHint:p,stateTransition:v,window:h,userContextId:f}=e,y=(0,i.__rest)(e,["appViewEntities","correlation","enableMultiSlotNone","entity","executionContext","isInputDefaultEntity","logger","matchedLinkedEntity","sourceHint","stateTransition","window","userContextId"]);const{coreSettings:k}=t,S=GO(h);let b=h.extendedEntityContainerState,C={activeEntities:S,windowHistory:[...h.windowHistory],currentWindowHistoryIndex:h.currentWindowHistoryIndex,layoutMode:h.layoutConfig.layoutMode,userContextId:h.userContextId,windowId:h.id};if(h.blockingEntityExtension&&S&&v!==L.suD.extend)return FO(L.feW.show,S,Object.assign({appViewEntities:r,correlation:s,enableMultiSlotNone:l,entity:d,executionContext:c,isInputDefaultEntity:u,logger:m,matchedLinkedEntity:g,sourceHint:p,stateTransition:v,window:h,userContextId:f},y));if(!S||HO({mainEntity:S.mainEntity,entity:d,stateTransition:v,matchedLinkedEntity:g}))C=function({appViewEntities:e,context:t,correlation:n,isInputDefaultEntity:i,logger:a,newEntity:o,sourceHint:r,userContextId:s,window:l,windowContentState:d}){var c;const{subNavEntity:u=null,headerEntity:m=null,startEntity:g=null,mainEntity:p=null,endEntity:v=null}=Object.assign({},e),{coreSettings:h}=t,{activeEntities:f}=d,{action:y,type:k}=o,{enableMTMACommanding:S}=h.get(K.J.Core),b=!!S&&s!==l.userContextId;if(!b&&(y===L.ukP.default&&f&&k===ZP(f).type||d.activeEntities&&i))return d;const C={__typename:"ActiveEntities",subNavEntity:$O(u,r),headerEntity:oP(m),startEntity:oP(g),mainEntity:null!==(c=oP(p))&&void 0!==c?c:o,endEntity:oP(v),entityExtension:null},[w]=mO({context:t,logger:a,windowContentState:d,newActiveEntities:C,isUserContextSwitch:b});return a.log(`Flushing window - ${EO(o)} and correlation ${n.id}`),{activeEntities:C,windowHistory:w,currentWindowHistoryIndex:w.length-1,layoutMode:l.layoutConfig.layoutMode,userContextId:s,windowId:l.id}}({appViewEntities:r,context:t,correlation:s,isInputDefaultEntity:u,logger:m,newEntity:d,sourceHint:p,userContextId:f,window:h,windowContentState:C});else if(VO({activeEntities:S,stateTransition:v,executionContext:c}))C=function({activeEntities:e,appViewEntities:t,context:n,executionContext:i,logger:a,window:o,windowContentState:r}){var s;const l=aO({executionContext:i,viewEntityName:L.tF7.headerEntity}),d=l||aO({executionContext:i,viewEntityName:L.tF7.startEntity}),c=d||aO({executionContext:i,viewEntityName:L.tF7.mainEntity}),u=c||aO({executionContext:i,viewEntityName:L.tF7.endEntity});a.log(`Issuing flow command on window - headerEntity ${l}, startEntity ${d}, \n        mainEntity ${c}, endEntity ${u}`);const m=Object.assign(Object.assign({},e),{headerEntity:l?oP(null==t?void 0:t.headerEntity):e.headerEntity,startEntity:d?oP(null==t?void 0:t.startEntity):e.startEntity,mainEntity:c&&null!==(s=oP(null==t?void 0:t.mainEntity))&&void 0!==s?s:e.mainEntity,endEntity:u?oP(null==t?void 0:t.endEntity):e.endEntity}),[g]=mO({context:n,isUserContextSwitch:!1,logger:a,newActiveEntities:m,windowContentState:r});return{activeEntities:m,windowHistory:g,currentWindowHistoryIndex:g.length-1,layoutMode:o.layoutConfig.layoutMode,userContextId:o.userContextId,windowId:o.id}}({activeEntities:S,appViewEntities:r,context:t,executionContext:c,logger:m,window:h,windowContentState:C});else if(function(e,t,n){return!!e&&(GR(e.mainEntity,t)||GR(e.endEntity,t))&&n!==L.suD.extend}(S,d,v))!function(e,t,n,i){e!==tt.EntityStateTransition.new&&t.log(`Entity already exists in the active entities no state transition made - ${EO(n)} and correlation ${i}`)}(v,m,d,s.id),C=function(e,t,n,a,o){const{activeEntities:r}=n;if(!r)return n;const{mainEntity:s,endEntity:l}=r,d=Object.assign({},r),{entityState:c}=a,u=(0,i.__rest)(a,["entityState"]);GR(s,a)?d.mainEntity=Object.assign(Object.assign({},s),u):l&&GR(l,a)&&(d.endEntity=Object.assign(Object.assign({},l),u));const[m]=mO({context:e,isUserContextSwitch:!1,logger:t,newActiveEntities:r,windowContentState:n});return{activeEntities:d,windowHistory:m,currentWindowHistoryIndex:m.length-1,layoutMode:o.layoutConfig.layoutMode,userContextId:o.userContextId,windowId:o.id}}(t,m,C,d,h);else if(v===L.suD.extend){const e=function({activeEntities:e,extendedEntityContainerState:t,logger:n,newEntity:i,windowContentState:a}){const o=t.containerState===L.oqG.Confirmed,r=t.containerState===L.oqG.Error,s=e.entityExtension&&t.isExternal;if(i.type===L.pyR.platformapp&&i.action===L.ukP.create||!e.entityExtension||o||r||s)return t=iP(),a.activeEntities=Object.assign(Object.assign({},e),{entityExtension:i}),[t,a];n.log(`Not showing extension: exists ${!!e.entityExtension}, isConfirmed ${o}, \n  hasError ${r}, hasExternalDialog ${s}`)}({activeEntities:S,extendedEntityContainerState:b,logger:m,newEntity:d,windowContentState:C});if(!e)throw new Error(`Extension already rendered, only one extension command request can be processed at a time. \n        Extension shown: ${null===(n=S.entityExtension)||void 0===n?void 0:n.type}; Extension requested: ${d.type}.`);b=e[0],C=e[1]}else C=qO({activeEntities:S,appViewEntities:r,correlation:s,enableMultiSlotNone:l,newEntity:d,executionContext:c,logger:m,windowContentState:C});if(function(e,t,n,i){const{enableMTMACommanding:a}=e.get(K.J.Core);return!(!a||t||!n||!i.userContextId||n===i.userContextId)}(k,v===L.suD.flush||v===L.suD.forceFlush||v===L.suD.extend,f,h))throw new Error("Different user context sent for non-flush and non-extend command");const w=h.windowHistoryNavigationState,N=Object.assign(Object.assign({},w),{backHistory:[...null!==(a=w.backHistory)&&void 0!==a?a:[]],forwardHistory:[...null!==(o=w.forwardHistory)&&void 0!==o?o:[]]});return Object.assign(Object.assign(Object.assign({},h),C),{correlation:s,extendedEntityContainerState:b,windowHistoryNavigationState:N})}function JO(e,t,n,i){switch(e){case L.feW.hide:return jO(t,n,i);case L.feW.toggle:return WO(t);case L.feW.show:case L.feW.showWithoutFocusing:return QO(t,n)}}function YO(e,t){if(void 0!==t){const n=t?sP(t):null;e.linkedEntity=n}}function KO(e,t,n,i,a){const{visibilityState:o,stateTransition:r,layoutMode:s}=e;if(o!==L.feW.hide){if(i&&r===L.suD.new)return(0,mt.v4)();if(a&&n===De.ew){if(!kO(t,null!=s?s:c.lO.standard))return(0,mt.v4)()}else if(function(e,t){return t===De.ew&&!CO(e,De.ew)}(t,n))return De.ew}}function ZO({activeWindows:e,command:t,coreSettings:n,correlation:i,entitiesMap:a,entity:o,isNewContextSupportEnabled:r,layoutMode:s,linkedEntitiesMap:l,logger:d,userContextId:u,windowId:m,webNrcEnabled:g}){const p=t.stateTransition===L.suD.forceFlush,v=t.stateTransition===L.suD.flow,[h,f]=!r||p||v?[void 0,!1]:wO(o,a,l,u,n);h&&(d.log(`Entity matched matched via linked entity ${f} for correlation ${i.id} to window`),_O(h,d));const y=h||function({command:e,activeWindows:t,windowId:n,correlation:i,logger:a,isNewContextSupportEnabled:o,layoutMode:r,userContextId:s,webNrcEnabled:l}){const d=KO(e,t,n,o,l);return void 0!==d?(a.log(`Creating new window with id ${d} for correlation ${i.id}`),function(e,t,n,i,a,o,r,s){return{__typename:"Window",id:t,windowOptions:null,windowHistory:[],currentWindowHistoryIndex:0,windowHistoryNavigationState:{__typename:"WindowHistoryNavigationState",canNavigateBack:!1,canNavigateForward:!1,backHistory:[],forwardHistory:[]},correlation:Object.assign(Object.assign({},e),{__typename:"Correlation"}),extendedEntityContainerState:iP(),blockingEntityExtension:null,isMainWindow:a!==tt.EntityStateTransition.new&&i===De.ew,isInitialWindowStateHidden:o===L.feW.showWithoutFocusing,userContextId:s,layoutConfig:{__typename:"LayoutConfig",layoutMode:null!=n?n:t===De.ew||r&&a!==tt.EntityStateTransition.new?L.lOW.standard:L.lOW.focus,isFullscreen:!1,slots:pP()}}}(i,d,r,n,e.stateTransition,e.visibilityState,l,s)):(e=>e===De.ew)(n)?(a.log(`Retrieving mainWindow with layoutMode ${r} for correlation ${i.id}`),kO(t,null!=r?r:c.lO.standard)):(a.log(`Retrieving window with id ${n} for correlation ${i.id}`),CO(t,n))}({activeWindows:e,command:t,correlation:i,isNewContextSupportEnabled:r,layoutMode:s,logger:d,userContextId:u,windowId:m,webNrcEnabled:g});if(!y)throw function(e,t){var n;return null===(n=t.errorToTelemetry)||void 0===n||n.call(t,"Unable to get source window",xO),(0,Mn.Tr)(De.w5.Commanding,De.jK.UndefinedWindowError,"CommandResolvers",e,"Unable to find applicable target window")}(i,d);return[y,f]}function XO(e,t,n,i,a){const o=rP(e),{webNrcEnabled:r}=a.get(K.J.Host),s=r?e=>e.id!==De.ew:void 0,[l,d]=QR(t,JR,s),[c]=wO(o,l,d,i,a);return c&&(n.log(`Found window for entity ${EO(o)}`),_O(c,n)),c||null}function ex(e,t,n,i){const a=e.activeEntities;return!!(null==a?void 0:a.entityExtension)&&(a.entityExtension=null,e.extendedEntityContainerState.containerState=L.oqG.Error,hO(t,n,e,i))}const tx=(e,t,n,a,o,r)=>{const{appsRegistryService:s,cache:l,commandChangeReportingService:d,localStorage:c,coreSettings:u,windowId:m}=n,g=(0,i.__rest)(n,["appsRegistryService","cache","commandChangeReportingService","localStorage","coreSettings","windowId"]),p=Object.assign(Object.assign({},e),{extendedEntityContainerState:Object.assign(Object.assign({},e.extendedEntityContainerState),t)}),v=e.blockingEntityExtension;p.blockingEntityExtension=null;const h=hO(n,o,p,a),f=((e,t,n)=>{const i=null==e?void 0:e.blockedEntity,a=null==e?void 0:e.blockedCommand,o=null==e?void 0:e.blockedEntityOptions;if(!i||!a)return t.warn("Unable to re-create the command which was blocked and saved."),null;const r=aP();r.source=Ot.D.CoreResolvers;const s={entity:i,command:Object.assign(Object.assign({},a),{correlation:r}),entityOptions:o};return n.report({type:GS.B.CommandStart,correlationId:s.command.correlation.id,context:{target:"createAndRegisterBlockedCommandOnConfirm",entityCommand:Object.assign(Object.assign({},s),{entityOptions:o?JSON.parse(o):void 0})}}),s})(v,a,d);if(f){const{entity:e,command:t,entityOptions:n}=f;return!!ax({entity:e,command:t,entityOptions:n,windowId:m,clientLaunchId:p.correlation.clientLaunchId},Object.assign({appsRegistryService:s,cache:l,commandChangeReportingService:d,coreSettings:u,localStorage:c,windowId:m},g),r)}return h},nx=({logger:e,appsRegistryService:t,coreSettings:n})=>{const i=t.getDefaultCommand(n);return i?(e.log("Default command found"),i):(e.error("No default command defined"),null)},ix=({isInputDefaultEntity:e,sourceWindow:t,context:n,userContextId:i,newEntity:a,matchedLinkedEntity:o,stateTransition:r,executionContext:s,correlation:l,logger:d})=>{const{localStorage:c,coreSettings:u,appsRegistryService:m,commandChangeReportingService:g,clientPreferences:p}=n,{enableWriteActiveEntitiesToLocalStorage:v,enableMTMACommanding:h,enableWriteAppHistoryToLocalStorage:f}=u.get(K.J.Core);let y=null;e&&t.isMainWindow&&v?y=((e,t,n,i)=>{const a=e.get($R,NT.f.Experience);if(a)try{const e=JSON.parse(a);return i&&n!==e.userContextId?null:e.activeEntities}catch(e){t.error(`Could not restore active entities from local storage. Stored string was in an invalid JSON format. String: ${a}.`)}return null})(c,d,i,h):a.action===L.ukP.default&&t.isMainWindow&&f&&(y=((e,t,n,i)=>{var a;const o=null===(a=i.getApp({entityType:n}))||void 0===a?void 0:a.manifest.id,r=e.get(`appActiveEntitiesHistory-${o}`);if(r)try{return JSON.parse(r)}catch(e){t.error(`Could not restore active entities from local storage. Stored string was in an invalid JSON format. String: ${r}.`)}return null})(c,d,a.type,m));const k=YR(t)?t.activeEntities:void 0;if(!y){const e=(({currentEntities:e,newEntity:t,matchedLinkedEntity:n,stateTransition:i,executionContext:a})=>!e||HO({entity:t,mainEntity:e.mainEntity,matchedLinkedEntity:n,stateTransition:i})||VO({activeEntities:e,stateTransition:i,executionContext:a}))({currentEntities:k,newEntity:a,matchedLinkedEntity:o,stateTransition:r,executionContext:s});d.log(`Should use entity from command input for getAppViewEntities ${e} `);const{appEntity:n,contextEntity:i}=XP({currentEntities:YR(t)?t.activeEntities:void 0,entity:a,shouldUseNewEntity:e});g.report({type:GS.B.CommandBeforeGetAppViewEntities,context:{target:"executeEntityCommand"},correlationId:l.id});try{y=eO({appsRegistryService:m,clientPreferences:p,contextEntity:i,coreSettings:u,entity:n,layoutMode:t.layoutConfig.layoutMode}),(({appViewEntities:e,stateTransition:t,appEntity:n,linkedEntity:i})=>t!==tt.EntityStateTransition.none&&null===e&&n===i)({appEntity:n,appViewEntities:y,linkedEntity:a.linkedEntity,stateTransition:r})&&(d.log(`Initial getAppViewEntities for ${n} returned null`),y=eO({entity:a,clientPreferences:p,contextEntity:null,coreSettings:u,layoutMode:t.layoutConfig.layoutMode,appsRegistryService:m}))}catch(e){g.report({type:GS.B.Failure,context:{errorInfo:qS.y.CommandGetAppViewEntitiesFailure,errorMessage:e.message,target:"executeEntityCommand"},correlationId:l.id})}}return y},ax=({clientLaunchId:e,command:t,entity:n,entityOptions:i,executionContext:a,windowId:o,windowOptions:r},s,l)=>{var d,u,m,g;const{appsRegistryService:p,authenticationUser:v,cache:h,clientPreferences:f,commandChangeReportingService:y,coreSettings:k,experienceChangeReportingService:S,loggerFactory:b,windowProvider:C,scenarioFactory:w}=s,N=b.newLogger("executeEntityCommand-mutation"),{visibilityState:T,stateTransition:I,correlation:E,layoutMode:A}=t;try{const g=o||De.ew,b=((e,t)=>t?Object.assign(Object.assign({},t),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}):Object.assign(Object.assign({},aP()),{clientLaunchId:null!=e?e:null,__typename:"Correlation"}))(null!=e?e:null,E);y.report({correlationId:b.id,type:GS.B.CommandResolutionStarted,context:{target:"executeEntityCommand"}});const _=vO(h,N),[D,F]=QR(_,JR,(e=>!SO(_,e.id)&&!((e,t)=>{const n=kO(e,tt.LayoutModes.minimal);return t===(null==n?void 0:n.id)})(_,e.id))),M=(e=>e.action===tt.EntityAction.default&&e.type===tt.EntityType.default)(n),R=null==E?void 0:E.sourceHint,P=(({entity:e,isInputDefaultEntity:t,logger:n,appsRegistryService:i,coreSettings:a})=>t?nx({logger:n,appsRegistryService:i,coreSettings:a}):e)({entity:n,isInputDefaultEntity:M,logger:N,appsRegistryService:p,coreSettings:k});if(!P)return null===(d=N.errorToTelemetry)||void 0===d||d.call(N,"Unable to use entity from command input",xO,void 0,!0),null;const O=rP(P,i,r);if(function(e){return e.type===tt.EntityType.toasts}(O))return N.log("Send all toast commands to Maglev host for execution"),y.report({correlationId:b.id,type:GS.B.NotHandled,context:{target:"executeEntityCommand",entityCommand:{entity:n,command:Object.assign(Object.assign({},t),{correlation:t.correlation,layoutMode:t.layoutMode||void 0}),entityOptions:i&&JSON.parse(i)}}}),null;N.log(`Command received for entity ${EO(O)}`),N.log(`Command received :${function(e){return`{\n    visibilityState: ${e.visibilityState},\n    stateTransition: ${e.stateTransition},\n    correlation: ${AO(e.correlation)}\n  }`}(t)}`),N.log(`Command with id ${b.id} received on window context ${g}`),N.log(`Command received with execution context: ${null==a?void 0:a.viewEntityName}`);const{isNewContextSupportEnabled:x,webNrcEnabled:U}=k.get(K.J.Host),{enableMultiSlotHide:B,enableMultiSlotNone:j,enableWindowNotUpdatedEvent:W,enableMTMACommanding:V,forceFocusLayoutMode:H}=k.get(K.J.Core),$=kO(_,L.lOW.standard),z=V&&((null==a?void 0:a.userContextId)||cP(v)||I===L.suD.extend&&$&&$.userContextId)||null;N.log(`isNewContextSupportEnabled ${x}, enableMultiSlotHide ${B}, enableMultiSlotNone ${j}`);const G=((e,t)=>t?c.lO.focus:e&&(e.layoutMode||c.lO.focus))(C.Cypress,!!H),q=ZO({activeWindows:_,command:t,coreSettings:k,correlation:b,entitiesMap:D,entity:O,isNewContextSupportEnabled:null==x||x,layoutMode:null!=G?G:A,linkedEntitiesMap:F,logger:N,userContextId:z,windowId:g,webNrcEnabled:null!=U&&U});let[Q]=q;const[,J]=q;if(I===L.suD.extend){if(U&&!YR(Q)&&Q.isMainWindow&&g===De.ew){N.log("Extension command - creating main window");const e=nx({logger:N,appsRegistryService:p,coreSettings:k});if(!e)throw new Error("No default entity. Unable to show extension");const t=rP(e,i,r),n=ix({isInputDefaultEntity:!0,sourceWindow:Q,context:s,userContextId:z,newEntity:t,matchedLinkedEntity:!1,stateTransition:L.suD.flush,executionContext:a,correlation:b,logger:N});N.log(`Extension command - flushing with entity ${EO(t)}`),DO(n,N),Q=JO(L.feW.show,{appsRegistryService:p,appViewEntities:n||void 0,clientPreferences:f,commandChangeReportingService:y,correlation:b,coreSettings:k,enableMultiSlotHide:B,enableMultiSlotNone:j,entitiesMap:D,entity:t,entityOptions:i,executionContext:a,host:C,isInputDefaultEntity:!0,logger:N,matchedLinkedEntity:J,sourceHint:R,stateTransition:L.suD.flush,userContextId:z,window:Q},s,l),N.log("Extension command - created source window"),_O(Q,N)}const e=!YR(Q);if(e||Q.userContextId!==z){const t=e?qS.y.EmptyWindowError:qS.y.UserContextMismatch;return N.log(`Extension command error ${t}`),y.report({correlationId:b.id,type:GS.B.Incomplete,context:{errorInfo:t,target:"executeEntityCommand"}}),null}}const Y=ix({isInputDefaultEntity:M,sourceWindow:Q,context:s,userContextId:z,newEntity:O,matchedLinkedEntity:J,stateTransition:I,executionContext:a,correlation:b,logger:N});if(y.report({type:GS.B.CommandAfterGetAppViewEntitiesSucceeded,context:{target:"executeEntityCommand"},correlationId:b.id}),N.log("Final appViewEntities: "),DO(Y,N),N.log(`Before updating cache, There are ${_.length} active windows`),N.log("Source window: "),_O(Q,N),null===Y)throw null===(u=N.errorToTelemetry)||void 0===u||u.call(N,"No app supports entity command",xO),new Error("no app view entities for entity input");let Z=JO(T,{appsRegistryService:p,appViewEntities:Y,clientPreferences:f,commandChangeReportingService:y,correlation:b,coreSettings:k,enableMultiSlotHide:B,enableMultiSlotNone:j,entitiesMap:D,entity:O,entityOptions:i,executionContext:a,host:C,isInputDefaultEntity:M,logger:N,matchedLinkedEntity:J,sourceHint:R,stateTransition:I,userContextId:z,window:Q},s,l);N.log("Target window: "),_O(Z,N);const X=function(e,t){return KR(YR(e)?e.activeEntities:null,YR(t)?t.activeEntities:null)}(Q,Z);!function(e,t,n,i,a,o,r){const s=(0,FN.YR)(e,n);r.log(`ViewportContext: ${s}`);const l={"Panel.WindowID":t,"Window.ViewportContext":s};a.report({correlationId:i,type:GS.B.ScenarioEventDataAppended,context:{target:"setViewportContextOnLaunchScenarios",eventData:l}});const d=o.findScenario(ft.RG.WindowLaunchTime);null==d||d.appendEventData(l)}(Z.isMainWindow,Z.id,Z.layoutConfig.layoutMode,b.id,y,w,N),y.report({correlationId:b.id,type:GS.B.CommandMetaDataAdded,context:{target:"executeEntityCommand",isCommandTargetedToMainWindow:Z.id===De.ew,shouldNavigate:XR(Q,Z,I,O)}});const ee=Q.id===De.ew&&I!==L.suD.new&&I!==L.suD.none;if(vP(X,g,ee,I===L.suD.flow||I===L.suD.none,k,N)){N.log(`Opener will handle the requested entity change with correlationId ${b.id} and entityId ${n.id}`);let e=!0;X.entityExtension&&(Z.extendedEntityContainerState.isExternal=!0,e=hO(s,_,Z,N));const t=CO(_,De.ew);if(t&&(e=>!(!e.activeEntities.entityExtension||e.extendedEntityContainerState.containerState===L.oqG.Closed))(t)&&PO(t,_,N,b,s),e)try{return(({correlation:e,diff:t,commandChangeReportingService:n,windowId:i,logger:a,targetWindow:o,context:r,activeWindows:s})=>{var l;if(hP(e,t,n,i,a))return null;throw ex(o,r,s,a),null===(l=a.errorToTelemetry)||void 0===l||l.call(a,"Unable to update cache, opener did not handle change",xO),(0,Mn.Tr)(De.w5.Commanding,De.jK.UnhandledRuntimeException,"executeEntityCommand",void 0,"Unable to update cache, opener did not handle the entity change")})({correlation:b,diff:X,commandChangeReportingService:y,windowId:g,logger:N,targetWindow:Z,context:s,activeWindows:_})}catch(e){throw ex(Z,s,_,N),null===(m=N.errorToTelemetry)||void 0===m||m.call(N,"Unable to update cache, errored while having opener handle change",xO,{errors:`${e.message}`}),(0,Mn.Tr)(De.w5.Commanding,De.jK.UnhandledRuntimeException,"executeEntityCommand",e,"Unable to update cache, opener threw an exception and did not handle the entity change")}}if(((e,t,n)=>{const i=YR(e)?e.activeEntities.entityExtension:null,a=YR(t)?t.activeEntities.entityExtension:null;return!(t.extendedEntityContainerState.containerState===L.oqG.Closed||!(i&&nP(n)||!a))})(Q,Z,X)&&(Z=((e,t,n,i,a)=>{if(e.extendedEntityContainerState.isExternal)n.log(`Internal routing - closing external dialog for correlation ${a.id}`),RO(t,n,i);else if(n.log(`Internal routing - closing internal dialog for correlation ${a.id}`),YR(e))return OO(e,a);return e})(Z,Q,N,y,b)),N.log(`Handling the requested entity command internally for correlation ${b.id}`),NO({pubsub:l,fromWindowId:g,isFromWindowMain:SO(_,g),sourceWindowId:Q.id,diff:X,targetWindow:Z,targetVisibilityState:T,stateTransition:I,correlation:b,logger:N}),dO(Z,N),W&&!ZR(Q,Z))return y.report({correlationId:b.id,type:GS.B.WindowNotUpdated,context:{target:"executeEntityCommand"}}),null;if(Q.correlation.id!==b.id){const e=YR(Q)?Q.activeEntities:void 0;e&&y.report({correlationId:b.id,type:GS.B.ScenarioEventDataAppended,context:{target:"executeEntityCommand",eventData:{fromMainEntityType:e.mainEntity.type,fromMainEntityAction:e.mainEntity.action}}}),y.report({correlationId:Q.correlation.id,type:GS.B.Abandoned,context:{target:"executeEntityCommand"}}),S.report({correlationId:b.id,type:bb.yU.ActiveEntitiesDestroyed,context:{target:"entity-command-resolver"},windowId:Q.id})}!GR(YR(Z)?Z.activeEntities.mainEntity:null,YR(Q)?Q.activeEntities.mainEntity:null)&&YR(Q)&&(Z=gP(Z));const te=hO(s,_,Z,N,b.id);if(te){const e=function(e){const t=[];return Object.keys(e).map((n=>{const i=e[n];i&&t.push(i)})),t}(X);e.length>0&&S.report({correlationId:b.id,type:bb.yU.ActiveEntitiesResolved,context:{target:"entity-command-resolver",entities:e},windowId:Z.id}),y.report({correlationId:b.id,type:GS.B.WindowUpdated,context:{target:"executeEntityCommand"}})}return te&&YR(Z)?Z:null}catch(e){throw null===(g=N.errorToTelemetry)||void 0===g||g.call(N,`Unable to execute entity command ${T} ${I} -  ${e.message}`,xO,{mainEntityType:n.type,mainEntityAction:n.action,correlationId:E.id},!0),e}},ox=(e,t,n,a)=>{var{cache:o,windowId:r,commandChangeReportingService:s}=n,l=(0,i.__rest)(n,["cache","windowId","commandChangeReportingService"]);if(!e.activeEntities.entityExtension)return!1;const d=MO(e,t,s);if(d){const{entity:t,command:n}=d;return ax({entity:t,command:n,windowId:r,clientLaunchId:e.correlation.clientLaunchId},Object.assign({cache:o,windowId:r,commandChangeReportingService:s},l),a)}return!1},rx=e=>({Query:{activeWindow(e,{windowId:t},{cache:n,coreSettings:i,loggerFactory:a}){const o=a.newLogger("activeWindow"),{webNrcEnabled:r}=i.get(K.J.Host),s=t||De.ew;let l;const d=vO(n,o,!1);if(l=s===De.ew&&r?kO(d,L.lOW.standard):d.find((e=>e.id===s)),!l)throw new Error(`Requesting activeWindow for unknown windowId ${s}`);return l},activeWindowForEntity(e,{entity:t},{cache:n,loggerFactory:i,authenticationUser:a,coreSettings:o}){const r=i.newLogger("activeWindowForEntity-query"),s=vO(n,r),{enableMTMACommanding:l}=o.get(K.J.Core);return XO(t,s,r,l?cP(a):null,o)}},Mutation:{navigateToWindowHistoryIndex:(e,t,n)=>(({windowId:e,windowHistoryIndex:t},n)=>{var i;const{cache:a,loggerFactory:o}=n,r=o.newLogger("navigateToWindowHistoryIndex-mutation");r.debug(`Navigating to windowHistoryIndex ${t} on window ${e}.`);const s=vO(a,r),l=CO(s,e);if(!l)throw new Error("Could not find window.");return!(0===(null===(i=l.windowHistory)||void 0===i?void 0:i.length)||t<0||t>l.windowHistory.length-1)&&IO(l,t,r,s,n)})(t,n),performWindowHistoryNavigation:(e,t,n)=>(({windowId:e,navigationDirection:t},n)=>{var i;const{cache:a,loggerFactory:o}=n,r=o.newLogger("performWindowHistoryNavigation-mutation");r.debug(`Navigating ${e} with direction ${t}.`);const s=vO(a,r),l=CO(s,e);if(!l)throw new Error("Could not find window.");if(0===(null===(i=l.windowHistory)||void 0===i?void 0:i.length))return!1;let d=l.currentWindowHistoryIndex;const c=e=>r.warn(`Could not navigate ${t}. Index ${e} is out of the bounds of the window history.`);if(t===L.fEB.back){if(d--,d<0)return c(d),!1}else if(++d,d>l.windowHistory.length-1)return c(d),!1;return IO(l,d,r,s,n)})(t,n),updateEntity(e,{entity:t,entityOptions:n,viewEntityName:i,windowId:a},o){const{cache:r,loggerFactory:s}=o,l=a||De.ew,d=s.newLogger("updateEntity-mutation"),c=vO(r,d),u=CO(c,l);if(!u)return d.warn("Trying to update entity in window that does not exist"),!1;if(u.userContextId&&o.authenticationUser&&u.userContextId!==cP(o.authenticationUser))return d.warn("Trying to update entity in for a different user context than currently present on the window"),!1;return function({entity:e,window:t,viewEntityName:n}){t.activeEntities[n]=Object.assign(Object.assign({},t.activeEntities[n]),e)}({window:u,entity:rP(t,n),viewEntityName:i}),hO(o,c,u,d)},updateEntityState(e,{entity:t,entityState:n},i){const{authenticationUser:a,cache:o,coreSettings:r,loggerFactory:s}=i,{enableMTMACommanding:l}=r.get(K.J.Core),d=s.newLogger("updateEntityState-mutation"),c=vO(o,d),u=XO(t,c,d,l?cP(a):null,r);if(!u)return d.warn("Trying to update flushable entity that does not exist"),!1;return function(e,t,n,i){const{mainEntity:a,endEntity:o}=e.activeEntities,{flushableByLinkedEntity:r,linkedEntityUpdate:s}=n;GR(a,t)?(null!=r&&(a.entityState.flushableByLinkedEntity=r),YO(a,s)):o&&GR(o,t)?(i.log("Updating entity state for end entity"),YO(o,s)):i.warn(`Updating entity state for entity the does not exist ${t}`)}(u,rP(t),n,d),hO(i,c,u,d),!0},updateExtendedEntityContainerState(t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{cache:t,loggerFactory:i,windowId:o,windowProvider:r}=a,s=i.newLogger("updateExtendedEntityContainerState-mutation"),l=vO(t,s),d=CO(l,o);if(d)if(((e,t)=>{var n;return e===L.oqG.Confirmed&&(null===(n=t.blockingEntityExtension)||void 0===n?void 0:n.entity)&&GR(t.activeEntities.entityExtension,t.blockingEntityExtension.entity)})(n.containerState,d))d.id===De.ew&&r.opener.postMessage(cS.W.MainWindowBlockedState,{isBlocked:"Confirmed",entity:null}),tx(d,n,a,s,l,e);else{if(n.containerState!==L.oqG.Closed)return d.extendedEntityContainerState=Object.assign(Object.assign({},d.extendedEntityContainerState),n),hO(a,l,d,s);ox(d,s,a,e)}return!1}))},executeEntityCommand:(t,n,i)=>ax(n,i,e),addBlockingExtension:(t,{entity:n,entityOptions:a,windowId:o,removeBlock:r},s)=>{var{cache:l,loggerFactory:d,windowProvider:c}=s,u=(0,i.__rest)(s,["cache","loggerFactory","windowProvider"]);const m=d.newLogger("addBlockingExtension-mutation");m.log(`${r?"Removing":"Adding"} an entity extension blocker of type ${n.type}`);const g=vO(l,m),p=CO(g,o);if(p){const t=Object.assign(Object.assign({},n),{id:n.id||null,linkedEntity:null,options:a||null,windowOptions:null,__typename:"Entity",entityState:{flushableByLinkedEntity:!1,__typename:"EntityState"}});if(r&&p.blockingEntityExtension)return((e,t,n,i,a,o)=>{const{windowProvider:r}=o;if(!t.blockingEntityExtension||!GR(t.blockingEntityExtension.entity,e))return!1;const s=Object.assign(Object.assign({},t),{blockingEntityExtension:null}),l=hO(o,n,s,i);return s.id===De.ew&&r.opener.postMessage(cS.W.MainWindowBlockedState,{isBlocked:"Unblocked",entity:null}),ox(t,i,o,a),l})(t,p,g,m,e,Object.assign({cache:l,loggerFactory:d,windowProvider:c},u));if(!r)return((e,t,n,i,a)=>{var o;const{windowProvider:r}=a,s={entity:e,__typename:"BlockingEntityExtension",blockedEntity:null,blockedCommand:null,blockedEntityOptions:null},l=Object.assign(Object.assign({},t),{blockingEntityExtension:s});if(l.id===De.ew)try{r.opener.postMessage(cS.W.MainWindowBlockedState,{isBlocked:"Blocked",entity:s.entity,entityOptions:e.options&&JSON.parse(e.options)})}catch(e){null===(o=i.errorToTelemetry)||void 0===o||o.call(i,"Unable to parse and post addBlockingExtension to main window",xO)}return hO(a,n,l,i)})(t,p,g,m,Object.assign({cache:l,windowProvider:c,loggerFactory:d},u))}return!1},setWindowFullscreen:(e,{isFullscreen:t,windowId:n},i)=>{const{cache:a,loggerFactory:o}=i,r=o.newLogger("setWindowFullscreen-mutation"),s=vO(a,r),l=CO(s,n);if(!l)return null;let d=!1;return l.layoutConfig.isFullscreen!==t&&(l.layoutConfig.isFullscreen=t,d=hO(i,s,l,r)),d&&YR(l)?l:null},resizeHeaderSlot:(e,{height:t,windowId:n},i)=>{var a,o,r,s,l;const{cache:d,loggerFactory:c}=i,u=c.newLogger("resizeHeaderSlot-mutation"),m=vO(d,u),g=CO(m,n);if(!g)return null;let p=!1;return(null===(o=null===(a=g.layoutConfig.slots)||void 0===a?void 0:a.header)||void 0===o?void 0:o.height)!==t&&(g.layoutConfig.slots=Object.assign(Object.assign({},g.layoutConfig.slots),{__typename:"SlotsLayoutConfig",header:Object.assign(Object.assign({},null===(r=g.layoutConfig.slots)||void 0===r?void 0:r.header),{__typename:"SlotLayoutConfig",height:t,width:(null===(l=null===(s=g.layoutConfig.slots)||void 0===s?void 0:s.header)||void 0===l?void 0:l.width)||null})}),p=hO(i,m,g,u)),p&&YR(g)?g:null},changeSlotsVisibility:(e,{slotNames:t,windowId:n,isHidden:i},a)=>{const{cache:o,loggerFactory:r}=a,s=r.newLogger("changeSlotsVisibility-mutation"),l=vO(o,s),d=CO(l,n);if(!d)return s.error("mutation fails as targetWindow is not found."),null;let c=!1,u=!1;const m=t.reduce(((e,t)=>{var n;const a=(e=>e.replace(/-./g,(e=>e[1].toUpperCase())))(t),o=null===(n=d.layoutConfig.slots)||void 0===n?void 0:n[a];return u||(null==o?void 0:o.isHidden)===i||(u=!0),e[a]=Object.assign(Object.assign({},o),{isHidden:i}),e}),{});return u&&(d.layoutConfig.slots=Object.assign(Object.assign({__typename:"SlotsLayoutConfig"},d.layoutConfig.slots),m),c=hO(a,l,d,s)),c&&YR(d)?d:null},removeUserActiveWindows:(e,{userContextId:t},n)=>{const{cache:i,loggerFactory:a}=n,o=a.newLogger("removeUserActiveWindowsMutation-mutation");return hO(n,((e,t)=>e.filter((e=>e.isMainWindow||e.userContextId!==t)))(vO(i,o),t),void 0,o)},resizeSlotDimensions:(e,{windowId:t,slotName:n,width:i},a)=>{var o,r,s,l,d,c;const{cache:u,loggerFactory:m}=a,g=m.newLogger("resizeSlotDimensions-mutation"),p=vO(u,g),v=CO(p,t);if(!v)return null;let h=!1;return n===L.WLT.SUBNAV?v.layoutConfig.slots=Object.assign(Object.assign({},v.layoutConfig.slots),{__typename:"SlotsLayoutConfig",subNav:Object.assign(Object.assign({},null===(o=v.layoutConfig.slots)||void 0===o?void 0:o.subNav),{__typename:"SlotLayoutConfig",height:(null===(s=null===(r=v.layoutConfig.slots)||void 0===r?void 0:r.subNav)||void 0===s?void 0:s.height)||null,width:i})}):n===L.WLT.END&&(v.layoutConfig.slots=Object.assign(Object.assign({},v.layoutConfig.slots),{__typename:"SlotsLayoutConfig",end:Object.assign(Object.assign({},null===(l=v.layoutConfig.slots)||void 0===l?void 0:l.end),{__typename:"SlotLayoutConfig",height:(null===(c=null===(d=v.layoutConfig.slots)||void 0===d?void 0:d.end)||void 0===c?void 0:c.height)||null,width:i})})),h=hO(a,p,v,g),h&&YR(v)?v:null},saveReactiveVarsToHistory(e,{windowId:t,appIds:n},i){const{cache:a,loggerFactory:o}=i,r=o.newLogger("saveReactiveVarsToHistory-mutation"),s=t||De.ew,l=vO(a,r),d=CO(l,s);if(!d)return r.warn("Trying to save reactive var history for window that does not exist"),!1;if(0===d.windowHistory.length)return!1;const c={activeEntities:d.activeEntities,windowHistory:d.windowHistory,currentWindowHistoryIndex:d.currentWindowHistoryIndex,layoutMode:d.layoutConfig.layoutMode,userContextId:d.userContextId||null,windowId:d.id},[u,m]=mO({appIdsForReactiveVarChange:n,context:i,isUserContextSwitch:!1,logger:r,newActiveEntities:d.activeEntities,windowContentState:c});if(!m)return r.log("Did not update history"),!1;const g=Object.assign(Object.assign({},d),{windowHistory:u});return dO(g,r),hO(i,l,g,r),!0}}});var sx=n(214118);const lx=e=>({__typename:"MeetingRoomFrontOfRoomCallPanelsState",id:e,rightPanel:null});var dx=n(918174);const cx={Query:{meetingRoomFrontOfRoomCallPanelsState:(e,{teamsCallId:t},{cache:n})=>{let i=lx(t);try{const e=n.readQuery({query:dx.Z,variables:{teamsCallId:t}}),a=null==e?void 0:e.meetingRoomFrontOfRoomCallPanelsState;i=null!=a?a:i}catch(e){}return i}},Mutation:{setMeetingRoomFrontOfRoomCallPanelsState:(e,{teamsCallId:t,state:n},{cache:i,loggerFactory:a})=>{var o;const r=null==a?void 0:a.newLogger("setMeetingRoomFrontOfRoomCallPanelsState");let s=lx(t);try{const e=i.readQuery({query:dx.Z,variables:{teamsCallId:t}});(null==e?void 0:e.meetingRoomFrontOfRoomCallPanelsState)&&(s=e.meetingRoomFrontOfRoomCallPanelsState)}catch(e){null==r||r.error("No data found in cache for meetingRoomFrontOfRoomCallPanelsState, using default value")}const l={__typename:"MeetingRoomFrontOfRoomCallPanelsState",id:s.id,rightPanel:null!==(o=n.rightPanel)&&void 0!==o?o:null};try{i.writeQuery({query:dx.Z,variables:{teamsCallId:t},data:{meetingRoomFrontOfRoomCallPanelsState:l}})}catch(e){null==r||r.error("setMeetingRoomFrontOfRoomCallPanelsState to cache failed.")}return l}}};var ux=n(681663),mx=n(892185),gx=n(314769),px=n(212693);const vx={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientVirtualEventsVirtualEventActionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"virtualEventAction"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]},hx={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientVirtualEventsVirtualEventSchedulingFormDataQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"virtualEventSchedulingFormData"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasUnsavedChanges"}}]}}]}}]},fx={Query:{virtualEventAction(e,t,{cache:n,loggerFactory:i}){var a,o,r;try{return null!==(o=null===(a=n.readQuery({query:vx}))||void 0===a?void 0:a.virtualEventAction)&&void 0!==o?o:null}catch(e){const t=i.newLogger("virtual-event-action");return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"virtualEventAction: Failed to fetch virtual event action from cache.","virtual_event_form_action"),null}},virtualEventSchedulingFormData(e,t,{cache:n,loggerFactory:i}){var a,o,r;try{return null!==(o=null===(a=n.readQuery({query:hx}))||void 0===a?void 0:a.virtualEventSchedulingFormData)&&void 0!==o?o:null}catch(e){const t=i.newLogger("virtual-event-scheduling-form-data");return null===(r=t.errorToTelemetry)||void 0===r||r.call(t,"virtualEventSchedulingFormData: Failed to fetch virtual event scheduling form data from cache.","virtual_event_scheduling_form_data"),null}}},Mutation:{setVirtualEventAction(e,{input:{type:t}},{cache:n,loggerFactory:i}){var a;const o=i.newLogger("set-virtual-event-action");try{n.writeQuery({query:vx,data:{virtualEventAction:t}})}catch(e){return null===(a=o.errorToTelemetry)||void 0===a||a.call(o,"setVirtualEventStateAction: Failed to update virtual event action task in cache.","virtual_event_form_action"),null}return t},updateVirtualEventSchedulingFormData(e,{virtualEventSchedulingFormDataInput:t},{cache:n,loggerFactory:i}){var a,o;const r=i.newLogger("update-virtual-event-scheduling-form-data"),s={virtualEventSchedulingFormData:{__typename:"VirtualEventSchedulingFormData",hasUnsavedChanges:null!==(a=t.hasUnsavedChanges)&&void 0!==a&&a}};try{n.writeQuery({query:hx,data:s})}catch(e){return null===(o=r.errorToTelemetry)||void 0===o||o.call(r,"updateVirtualEventSchedulingFormData: Failed to update virtual event scheduling form data in cache.","virtual_event_scheduling_form_data"),null}return s.virtualEventSchedulingFormData}}};class yx{constructor(){}static create(e){if(yx._clientResolvers)throw new Error("ClientResolvers are already created");return yx._clientResolvers=function(e){return(0,a.merge)((0,sx.w)(),jR.w,qM,HM,(0,BR.wf)(),function(){let e;const t=t=>a=>(o,r,s)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e){const{broadcastClientResolvers:t}=yield Promise.all([n.e(47844),n.e(44781),n.e(9268),n.e(91789)]).then(n.bind(n,274982));e=t()}return e[t][a](o,r,s)}));return{Query:{broadcastLayout:t("Query")("broadcastLayout"),attendeeCaptionsVisibility:t("Query")("attendeeCaptionsVisibility")},Mutation:{setBroadcastActiveSectionSource:t("Mutation")("setBroadcastActiveSectionSource"),updateBroadcastLayout:t("Mutation")("updateBroadcastLayout"),selectBroadcastSection:t("Mutation")("selectBroadcastSection"),clearBroadcastSource:t("Mutation")("clearBroadcastSource"),createDebugBroadcast:t("Mutation")("createDebugBroadcast"),updateAttendeeCaptionsVisibility:t("Mutation")("updateAttendeeCaptionsVisibility")}}}(),function(e){let t;const a=a=>o=>(r,s,l)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!t){const{clientResolvers:i}=yield Promise.all([n.e(47844),n.e(44781),n.e(9268),n.e(91789)]).then(n.bind(n,274982));t=i(e)}return t[a][o](r,s,l)}));return{CallingIntent:{isFake:a("CallingIntent")("isFake")},CallLogParticipant:{hasDisplayName:a("CallLogParticipant")("hasDisplayName"),displayName:a("CallLogParticipant")("displayName")},Query:{whiteboardSharingSession:a("Query")("whiteboardSharingSession"),pptSharingSession:a("Query")("pptSharingSession"),bulkMoveStatus:a("Query")("bulkMoveStatus"),anonymousDisplayName:a("Query")("anonymousDisplayName"),prejoinState:a("Query")("prejoinState"),callingScreenStatus:a("Query")("callingScreenStatus"),callingScreenLayout:a("Query")("callingScreenLayout"),pinnedParticipantIds:a("Query")("pinnedParticipantIds"),videoScanType:a("Query")("videoScanType"),captionFontSize:a("Query")("captionFontSize"),debugVideoEffectState:a("Query")("debugVideoEffectState"),selectedBackgroundsInfo:a("Query")("selectedBackgroundsInfo"),getHardwareOutDevices:a("Query")("getHardwareOutDevices"),avatarInfo:a("Query")("avatarInfo"),selectedAvatarInfo:a("Query")("selectedAvatarInfo"),activeVideoEffects:a("Query")("activeVideoEffects"),videoEffectsCurrentInfo:a("Query")("videoEffectsCurrentInfo"),currentCallingState:a("Query")("currentCallingState"),compositorRegions:a("Query")("compositorRegions"),avatarAppAvailabilityInfo:a("Query")("avatarAppAvailabilityInfo")},Mutation:{moveRoomRetainedParticipants:a("Mutation")("moveRoomRetainedParticipants"),acceptStreamPermissionsDebug:a("Mutation")("acceptStreamPermissionsDebug"),sendToDebugHardwareOutDevice:a("Mutation")("sendToDebugHardwareOutDevice"),stopDebugHardwareOutDevice:a("Mutation")("stopDebugHardwareOutDevice"),setDebugSpeakerVolume:a("Mutation")("setDebugSpeakerVolume"),setDebugToolVisible:a("Mutation")("setDebugToolVisible"),updateMeetingRoomLayoutToggleState:a("Mutation")("updateMeetingRoomLayoutToggleState"),updateShouldLaunchWhiteboardOnLoad:a("Mutation")("updateShouldLaunchWhiteboardOnLoad"),setDebugToolHiddenParticipantsCount:a("Mutation")("setDebugToolHiddenParticipantsCount"),setBulkMoveStatus:a("Mutation")("setBulkMoveStatus"),createDebugBreakoutRooms:a("Mutation")("createDebugBreakoutRooms"),createDebugCall:a("Mutation")("createDebugCall"),addDebugSuggestedUser:a("Mutation")("addDebugSuggestedUser"),joinDebugCallFromIntent:a("Mutation")("joinDebugCallFromIntent"),createDebugCallingIntent:a("Mutation")("createDebugCallingIntent"),createDebugConversation:a("Mutation")("createDebugConversation"),updateDebugCall:a("Mutation")("updateDebugCall"),stopDebugCall:a("Mutation")("stopDebugCall"),stopSpotlightSelfDebugCall:a("Mutation")("stopSpotlightSelfDebugCall"),updateDebugMeetingRoomRemoteSelectedLayoutChanged:a("Mutation")("updateDebugMeetingRoomRemoteSelectedLayoutChanged"),updateDebugSwapScreensButtonState:a("Mutation")("updateDebugSwapScreensButtonState"),toggleHoldDebugCall:a("Mutation")("toggleHoldDebugCall"),addDebugParticipant:a("Mutation")("addDebugParticipant"),createDebugParticipants:a("Mutation")("createDebugParticipants"),toggleDebugLocalMute:a("Mutation")("toggleDebugLocalMute"),startDebugRecording:a("Mutation")("startDebugRecording"),stopDebugRecording:a("Mutation")("stopDebugRecording"),setCallTranscriptStateDebug:a("Mutation")("setCallTranscriptStateDebug"),sendCallTranscriptEntryEventDebug:a("Mutation")("sendCallTranscriptEntryEventDebug"),sendClosedCaptionsEntryEventDebug:a("Mutation")("sendClosedCaptionsEntryEventDebug"),sendClosedCaptionsStatusEventDebug:a("Mutation")("sendClosedCaptionsStatusEventDebug"),removeDebugParticipant:a("Mutation")("removeDebugParticipant"),toggleDebugVideo:a("Mutation")("toggleDebugVideo"),toggleDebugScreenShare:a("Mutation")("toggleDebugScreenShare"),updateDebugParticipant:a("Mutation")("updateDebugParticipant"),updateDebugPinParticipantFromOutside:a("Mutation")("updateDebugPinParticipantFromOutside"),updateDebugCortanaToggleButton:a("Mutation")("updateDebugCortanaToggleButton"),updateDebugContentCameraSharing:a("Mutation")("updateDebugContentCameraSharing"),toggleDebugMuteSpeaker:a("Mutation")("toggleDebugMuteSpeaker"),updateDebugContentCameraState:a("Mutation")("updateDebugContentCameraState"),triggerDebugCallingScreenGalleryTypeChange:a("Mutation")("triggerDebugCallingScreenGalleryTypeChange"),toggleVoiceLevel:a("Mutation")("toggleVoiceLevel"),setDebugDevicesList:a("Mutation")("setDebugDevicesList"),setDebugCallingQualityFeedback:a("Mutation")("setDebugCallingQualityFeedback"),setAnonymousDisplayName:a("Mutation")("setAnonymousDisplayName"),setPrejoinState:a("Mutation")("setPrejoinState"),triggerSubscribedCallChangedDebugEvent:a("Mutation")("triggerSubscribedCallChangedDebugEvent"),updateMeetingBrandingInfoCache:a("Mutation")("updateMeetingBrandingInfoCache"),setAcceptStreamPermissionsDebugResponse:a("Mutation")("setAcceptStreamPermissionsDebugResponse"),setStreamPermissionsDebugAcknowledged:a("Mutation")("setStreamPermissionsDebugAcknowledged"),setStreamPermissionsDebugAcknowledgedRequired:a("Mutation")("setStreamPermissionsDebugAcknowledgedRequired"),setCallingScreenStatus:a("Mutation")("setCallingScreenStatus"),setCallingScreenLayout:a("Mutation")("setCallingScreenLayout"),setPinnedParticipantIds:a("Mutation")("setPinnedParticipantIds"),setVideoScanType:a("Mutation")("setVideoScanType"),updateCaptionFontSize:a("Mutation")("updateCaptionFontSize"),setDebugDeviceBlurringCapability:a("Mutation")("setDebugDeviceBlurringCapability"),setDebugVideoBackgroundImages:a("Mutation")("setDebugVideoBackgroundImages"),triggerBluetoothStateChangedDebugEvent:a("Mutation")("triggerBluetoothStateChangedDebugEvent"),triggerRaiseHandStateChangedEvent:a("Mutation")("triggerRaiseHandStateChangedEvent"),toggleDebugVideoEffect:a("Mutation")("toggleDebugVideoEffect"),updateMeetingLockDebug:a("Mutation")("updateMeetingLockDebug"),updateSelectedBackgroundsInfo:a("Mutation")("updateSelectedBackgroundsInfo"),setShouldReloadVideoApp:a("Mutation")("setShouldReloadVideoApp"),setShouldShowVideoApp:a("Mutation")("setShouldShowVideoApp"),setShouldShowVideoEffectsPreview:a("Mutation")("setShouldShowVideoEffectsPreview"),setShouldKeepPreviewWindowInSidePanelOpen:a("Mutation")("setShouldKeepPreviewWindowInSidePanelOpen"),setVideoAppPostMessageEvent:a("Mutation")("setVideoAppPostMessageEvent"),setAvatarAppPostMessageEvent:a("Mutation")("setAvatarAppPostMessageEvent"),setVideoNotification:a("Mutation")("setVideoNotification"),setAvatarErrorNotification:a("Mutation")("setAvatarErrorNotification"),setAvatarQuickPickerErrorNotification:a("Mutation")("setAvatarQuickPickerErrorNotification"),setShouldSetAvatarRendererTimeout:a("Mutation")("setShouldSetAvatarRendererTimeout"),setShouldRefreshVideoFilters:a("Mutation")("setShouldRefreshVideoFilters"),toggleParticipantPin:a("Mutation")("toggleParticipantPin"),setScaling:a("Mutation")("setScaling"),scalingModeUpdated:a("Mutation")("scalingModeUpdated"),updateAvatarInfo:a("Mutation")("updateAvatarInfo"),updateSelectedAvatarInfo:a("Mutation")("updateSelectedAvatarInfo"),setLastSelectedCameraId:a("Mutation")("setLastSelectedCameraId"),setIsAvatarAppLoaded:a("Mutation")("setIsAvatarAppLoaded"),updateActiveVideoEffects:a("Mutation")("updateActiveVideoEffects"),updateVideoEffectsCurrentInfo:a("Mutation")("updateVideoEffectsCurrentInfo"),meetingDebugGoLive:a("Mutation")("meetingDebugGoLive"),setDebugStageRoomOutcome:a("Mutation")("setDebugStageRoomOutcome"),setShouldShowPopupPreview:a("Mutation")("setShouldShowPopupPreview"),setShouldAvatarMenuItemSelected:a("Mutation")("setShouldAvatarMenuItemSelected"),updateCallingState:a("Mutation")("updateCallingState"),setCompositorRegion:a("Mutation")("setCompositorRegion"),removeCompositorRegion:a("Mutation")("removeCompositorRegion"),setAvatarAppAvailabilityInfo:a("Mutation")("setAvatarAppAvailabilityInfo"),setIsAvatarMRULoaded:a("Mutation")("setIsAvatarMRULoaded"),setMeetingCollab:a("Mutation")("setMeetingCollab"),toggleMeetingCollab:a("Mutation")("toggleMeetingCollab"),stopSharingTriggeredOnStage:a("Mutation")("stopSharingTriggeredOnStage")}}}(e),cx,rx(e),DF,WR.D,VR.w,UR,YM,HR.s,ux.s,px.s,fx,mx.w,gx.w)}(e),yx._clientResolvers}static get clientResolvers(){return yx._clientResolvers}}yx._clientResolvers=null;class kx extends hF{constructor(e,t,n,i,a){var o;super(e,t,n({windowId:i.windowId,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:`mtma-user-${(null===(o=null==i?void 0:i.authenticationUser)||void 0===o?void 0:o.id)||"nouser"}-${i.windowId}`,storeType:a}),i,i.windowId,a)}get parentQueries(){return UD}get parentSubscriptions(){return VD}get parentMutations(){return jD}get className(){return"MTMAWindowDataClient"}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}clone(e){throw new Error("Trying to clone child instance")}}class Sx extends pF{constructor(e,t,n,i){super(e,n,t({windowId:n.windowId||De.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"mtma-core",storeType:tF.t.mtmaCore}),n.windowId||De.ew,tF.t.mtmaCore),this.createApolloClient=t,this.viewSchemaClient=null,i&&(this.viewSchemaClient=i({windowId:n.windowId||De.ew,entityType:n.entityType,viewportContext:n.windowProvider.viewportContext,name:"core-viewSchema",storeType:tF.t.viewSchema}),this.registerClient(this.viewSchemaClient))}clone(e){return e.windowId===De.ew?new yF(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new kx(this.getServices(),this,this.createApolloClient,Object.assign(Object.assign({},this.ctx),e),tF.t.mtmaWindow)}cloneForViewSchema(e){return SF(this.viewSchemaClient,"View schema must be avaliable"),new kF(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),tF.t.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class bx extends hF{constructor(e,t,n,i,a){var o;super(e,t,n({windowId:i.windowId||De.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:`mtma-user-${(null===(o=null==i?void 0:i.authenticationUser)||void 0===o?void 0:o.id)||"nouser"}-${i.windowId}`,storeType:tF.t.mtmaUser}),i,i.windowId||De.ew,tF.t.mtmaUser),this.createApolloClient=n,this.viewSchemaClient=null,a&&(this.viewSchemaClient=a({windowId:i.windowId||De.ew,entityType:i.entityType,viewportContext:i.windowProvider.viewportContext,name:"core-viewSchema",storeType:tF.t.viewSchema}),this.registerClient(this.viewSchemaClient))}get parentQueries(){return LD}get parentSubscriptions(){return WD}get parentMutations(){return BD}get className(){return"MTMAUserDataClient"}__UNSAFE_getApolloClientReferencesForDebugPanel(){return{self:this.client,parent:this.parent.__UNSAFE_getApolloClientReferencesForDebugPanel().self,selfIsMainClient:!1}}clone(e){return e.windowId===De.ew?new yF(this.getServices(),this.client,Object.assign(Object.assign({},this.ctx),e),this.storeType):new kx(this.getServices(),this,this.createApolloClient,Object.assign(Object.assign({},this.ctx),e),tF.t.mtmaWindow)}cloneForViewSchema(e){return SF(this.viewSchemaClient,"View schema must be available"),new kF(this.getServices(),this.viewSchemaClient,Object.assign(Object.assign({},this.ctx),e),tF.t.viewSchema)}disposeClients(e){const t=Object.create(null,{disposeClients:{get:()=>super.disposeClients}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all([t.disposeClients.call(this,e),(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.viewSchemaClient&&(yield this.disposeClient(this.viewSchemaClient,e),e&&(this.viewSchemaClient=null))})))()])}))}}class Cx{constructor(){this._cache=new Map,this.getOrCreateServiceInstance=(e,t)=>{let n;return this._cache.has(e)?n=this._cache.get(e):(n=t(),this._cache.set(e,n)),n},this.clear=()=>{this._cache.clear()}}}const wx=new Cx,Nx=wx.getOrCreateServiceInstance;var Tx,Ix;!function(e){e.AddressService="AddressService",e.AiInsightsFeedbackService="AiInsightsFeedbackService",e.AiInsightsSdsService="AiInsightsSdsService",e.AppBasedLinkService="AppBasedLinkService",e.AppSuggestionsService="AppSuggestionsService",e.AppsPlatformService="AppsPlatformService",e.AsyncMediaService="AsyncMediaService",e.AtpSafelinksService="AtpSafelinksService",e.AzureMapsService="AzureMapsService",e.BadgeCountService="BadgeCountService",e.BiometricEnrollmentService="BiometricEnrollmentService",e.BiometricFaceEnrollmentService="BiometricFaceEnrollmentService",e.BotsPlatformService="BotsPlatformService",e.BrbService="BrbService",e.BreakoutRoomsService="BreakoutRoomsService",e.BreakoutRoomsHelper="BreakoutRoomsHelper",e.BroadcastAttendeeService="BroadcastAttendeeService",e.BroadcastStreamingAttendeeService="BroadcastStreamingAttendeeService",e.BroadcastCaptionsService="BroadcastCaptionsService",e.BroadcastSignalRService="BroadcastSignalRService",e.CalendarService="CalendarService",e.CallBlockingService="CallBlockingService",e.CallingAdapterServices="CallingAdapterServices",e.CallingAppEventsService="CallingAppEventsService",e.CallingAnonymousDisplayNameService="CallingAnonymousDisplayNameService",e.CallingBannerServiceAdapter="CallingBannerServiceAdapter",e.CallingDialogServiceAdapter="CallingDialogServiceAdapter",e.CallingNotificationServiceAdapter="CallingNotificationServiceAdapter",e.CallingService="CallingService",e.CallRecordingService="CallRecordingService",e.ChatService="ChatService",e.ChatServiceEndpointProvider="ChatServiceEndpointProvider",e.CloudStorageFoldersService="CloudStorageFoldersService",e.CmdMeetingIntelligenceService="CmdMeetingIntelligenceService",e.CollabCloudService="CollabCloudService",e.CollabObjectService="CollabObjectService",e.MeetingCatchupService="MeetingCatchupService",e.CommonSubstrateService="CommonSubstrateService",e.ConnectedAccountsService="ConnectedAccountsService",e.ConnectedCalendarSettingsService="ConnectedCalendarSettingsService",e.ConsumerGroupsService="ConsumerGroupsService",e.CSAService="CSAService",e.DeveloperSwitchersService="DeveloperSwitchersService",e.DistributionListService="DistributionListService",e.DynamicsMarketingService="DynamicsMarketingService",e.DynamicsVirtualEventsService="DynamicsVirtualEventsService",e.EmoticonService="EmoticonService",e.EspService="EspService",e.ExampleService="ExampleService",e.ExternalAccountsService="ExternalAccountsService",e.DiscoverSurfaceService="DiscoverSurfaceService",e.DiscoverSurfaceFeedbackService="DiscoverSurfaceFeedbackService",e.ExternalAccountsResponseService="ExternalAccountsResponseService",e.ExternalCalendarEmailAddressService="ExternalCalendarEmailAddressService",e.FilesBackfillThreadPropertiesService="FilesBackfillThreadPropertiesService",e.FilesRedeemService="FilesRedeemService",e.FilesReferenceService="FilesReferenceService",e.FilesValidDomainsService="FilesValidDomainsService",e.FilesSharepointUrlService="FilesSharepointUrlService",e.FileUploadPreviewService="FileUploadPreviewService",e.FileUploadService="FileUploadService",e.FileDownloadManagerService="FileDownloadManagerService",e.FluidService="FluidService",e.GalleryService="GalleryService",e.GiphyService="GiphyService",e.GoogleCalendarAuthenticationService="GoogleCalendarAuthenticationService",e.GoogleContactsAuthenticationService="GoogleContactsAuthenticationService",e.GuardiansService="GuardiansService",e.ImageProxyService="ImageProxyService",e.ImmersiveReaderService="ImmersiveReaderService",e.ImportMsaContactsService="ImportMsaContactsService",e.ImplicitContactsService="ImplicitContactsService",e.InstantAnswersService="InstantAnswersService",e.ItemDeleteService="ItemDeleteService",e.ItemDetailsService="ItemDetailsService",e.DriveItemShareService="DriveItemShareService",e.ItemUploadService="ItemUploadService",e.InviteLinksService="InviteLinksService",e.LiveStateBroadcastService="LiveStateBroadcastService",e.LiveStreamRenderingService="LiveStreamRenderingService",e.LmsIntegrationService="LmsIntegrationService",e.LockedTeamsService="LockedTeamsService",e.LogsFilesService="LogsFilesService",e.LokiMetaPreviewService="LokiMetaPreviewService",e.LokiService="LokiService",e.ManageTenantService="ManageTenantService",e.MeetForWorkService="MeetForWorkService",e.MeetingArtifactsService="MeetingArtifactsService",e.MeetingBotService="MeetingBotService",e.MeetingIntelligenceService="MeetingIntelligenceService",e.MeetingOptionsClientDataService="MeetingOptionsClientDataService",e.MeetingOptionsService="MeetingOptionsService",e.MeetingQuestionsAndAnswersService="MeetingQuestionsAndAnswersService",e.MeetingRecapService="MeetingRecapService",e.MeetingRecapSwaService="MeetingRecapSwaService",e.MeetingTemplateService="MeetingTemplateService",e.MeshSessionService="MeshSessionService",e.MonetizationService="MonetizationService",e.MRUItemService="MRUItemService",e.MsaAuthenticationService="MsaAuthenticationService",e.OdcFilePreviewService="OdcFilePreviewService",e.OdsService="OdcService",e.OSearchService="OSearchService",e.PaymentsService="PaymentsService",e.PeoplePickerService="PeoplePickerService",e.PeopleSearchService="PeopleSearchService",e.PeopleService="PeopleService",e.PeopleTargetingService="PeopleTargetingService",e.PersonalFileDetailsService="PersonalFileDetailsService",e.PetrolService="PetrolService",e.FloodgateService="FloodgateService",e.PoliciesService="PoliciesService",e.PresenceService="PresenceService",e.PstnService="PstnService",e.RefreshSiteUrlService="RefreshSiteUrlService",e.ReportConcernService="ReportConcernService",e.SCISService="SCISService",e.SearchPrefetchService="SearchPrefetchService",e.SensitivityLabelPolicySettingsService="SensitivityLabelPolicySettingsService",e.SharepointRestClient="SharepointRestClient",e.SharepointShareService="SharepointShareService",e.ShareService="ShareService",e.SignalsService="SignalsService",e.SmbUserIntentService="SmbUserIntentService",e.StatefulLongPoll="StatefulLongPoll",e.StoreService="StoreService",e.StyleMyRoomService="StyleMyRoomService",e.SubstrateFilesSearchService="SubstrateFilesSearchService",e.SubstrateMeetingRecommendationsService="SubstrateMeetingRecommendationsService",e.SubstrateMeetingSearchService="SubstrateMeetingSearchService",e.SubstrateMeetingSummarySearchService="SubstrateMeetingSummarySearchService",e.SubstrateRecommendationsService="SubstrateRecommendationsService",e.SubstrateSearchService="SubstrateSearchService",e.SubstrateSuggestionsService="SubstrateSuggestionsService",e.TargetingHierarchyService="TargetingHierarchyService",e.TeamCalendarService="TeamCalendarService",e.TeamsAndChannelsService="TeamsAndChannelsService",e.TenantMembershipService="TenantMembershipService",e.TenantPrivacyProfileService="TenantPrivacyProfileService",e.TenantService="TenantService",e.TenantAnalyticsService="TenantAnalyticsService",e.TFLUserService="TFLUserService",e.ThirdPartyCalendarService="ThirdPartyCalendarService",e.ToastImageService="ToastImageService",e.TpnNoticeService="TpnNoticeService",e.TranscriptFeedbackService="TranscriptFeedbackService",e.TranscriptSettingsStoreService="TranscriptSettingsStoreService",e.TranscriptService="TranscriptService",e.TranslateService="TranslateService",e.UnifiedConsentService="UnifiedConsentService",e.UrlPreviewService="UrlPreviewService",e.UserLicenseService="UserLicenseService",e.UserProfileService="UserProfileService",e.VideoFileService="VideoFileService",e.VirtualEventsService="VirtualEventsService",e.VoicemailService="VoicemailService",e.WebinarService="WebinarService"}(Tx||(Tx={})),function(e){e.ExampleGlobalService="ExampleGlobalService",e.GlobalCallingService="GlobalCallingService"}(Ix||(Ix={}));const Ex=(e,t)=>n=>(0,d.mT)(e,t,n),Ax=()=>Promise.all([n.e(88450),n.e(43990),n.e(90799),n.e(51778),n.e(61724),n.e(58016),n.e(12724),n.e(10287),n.e(45178),n.e(16702)]).then(n.bind(n,836964)),_x=Ex((()=>Promise.all([n.e(84460),n.e(85108)]).then(n.bind(n,506610))),"services-app-based-link"),Dx=Ex((()=>Promise.all([n.e(69566),n.e(5203)]).then(n.bind(n,792622))),"services-apps-platform"),Fx=Ex((()=>n.e(33885).then(n.bind(n,761866))),"services-app-suggestions"),Mx=Ex((()=>n.e(91494).then(n.bind(n,387489))),"services-atp-safelinks"),Rx=Ex((()=>n.e(71401).then(n.bind(n,234003))),"services-async-media"),Px=Ex((()=>Promise.all([n.e(43780),n.e(99110),n.e(87927)]).then(n.bind(n,575228))),"services-azure-maps"),Ox=Ex((()=>Promise.all([n.e(19715),n.e(56255)]).then(n.bind(n,357906))),"services-biometric-enrollment"),xx=Ex((()=>Promise.all([n.e(16747),n.e(20672)]).then(n.bind(n,690711))),"services-bots-platform"),Lx=Ex((()=>n.e(40060).then(n.bind(n,215403))),"services-brb"),Ux=Ex((()=>n.e(11846).then(n.bind(n,281579))),"services-breakout-rooms"),Bx=Ex((()=>n.e(51710).then(n.bind(n,613295))),"services-transcript"),jx=Ex((()=>n.e(19211).then(n.bind(n,309373))),"services-transcript-setting-store"),Wx=Ex((()=>n.e(51710).then(n.bind(n,613295))),"services-transcript-feedback"),Vx=Ex((()=>n.e(16205).then(n.bind(n,879389))),"services-ai-insights-feedback"),Hx=Ex((()=>n.e(16205).then(n.bind(n,879389))),"services-ai-insights-sds"),$x=Ex((()=>n.e(12159).then(n.bind(n,429973))),"services-style-my-room"),zx=Ex((()=>n.e(63685).then(n.bind(n,562511))),"services-broadcast-attendee"),Gx=Ex((()=>n.e(20188).then(n.bind(n,455388))),"services-broadcast-streaming-attendee"),qx=Ex((()=>Promise.all([n.e(88450),n.e(28560)]).then(n.bind(n,367482))),"services-broadcast-captions"),Qx=Ex((()=>Promise.all([n.e(33937),n.e(12549)]).then(n.bind(n,394630))),"services-broadcast-signalr"),Jx=Ex((()=>Promise.all([n.e(51778),n.e(61724),n.e(95544),n.e(2423),n.e(93376)]).then(n.bind(n,586589))),"services-io-calendar"),Yx=Ex((()=>n.e(34692).then(n.bind(n,33277))),"services-chat-endpoint-provider"),Kx=Ex((()=>Promise.all([n.e(54283),n.e(77209)]).then(n.bind(n,996401))),"services-chat"),Zx=Ex((()=>n.e(76808).then(n.bind(n,972759))),"services-report-concern"),Xx=(Ex((()=>Promise.all([n.e(84460),n.e(88450),n.e(43990),n.e(90799),n.e(51778),n.e(61724),n.e(58016),n.e(12724),n.e(10287),n.e(45178),n.e(75925)]).then(n.bind(n,821632))),"services-calling"),Ex((()=>n.e(93740).then(n.bind(n,606577))),"services-cmd-meeting-intelligence")),eL=Ex((()=>n.e(56737).then(n.bind(n,290759))),"services-collab-object"),tL=Ex((()=>n.e(41480).then(n.bind(n,908018))),"services-meeting-catchup"),nL=Ex((()=>n.e(32034).then(n.bind(n,994833))),"services-connected-accounts"),iL=Ex((()=>n.e(675).then(n.bind(n,504212))),"services-io-connected-calendar"),aL=Ex((()=>n.e(923).then(n.bind(n,985224))),"services-distribution-list"),oL=Ex((()=>n.e(5794).then(n.bind(n,68241))),"services-dynamics-marketing"),rL=Ex((()=>n.e(6652).then(n.bind(n,303172))),"services-dynamics-virtual-events"),sL=Ex((()=>n.e(78832).then(n.bind(n,446332))),"services-emoticon"),lL=Ex((()=>n.e(21174).then(n.bind(n,7457))),"services-esp"),dL=Ex((()=>n.e(69081).then(n.bind(n,128813))),"services-external-accounts"),cL=Ex((()=>n.e(35430).then(n.bind(n,618630))),"services-external-accounts-response"),uL=Ex((()=>n.e(79197).then(n.bind(n,627950))),"services-external-calendar-email-address"),mL=Ex((()=>n.e(3137).then(n.bind(n,154862))),"services-files"),gL=Ex((()=>n.e(22121).then(n.bind(n,720759))),"services-file-upload"),pL=Ex((()=>n.e(2653).then(n.bind(n,97465))),"services-file-download-manager"),vL=Ex((()=>n.e(51425).then(n.bind(n,787817))),"services-fluid"),hL=Ex((()=>n.e(73806).then(n.bind(n,200703))),"services-giphy"),fL=Ex((()=>n.e(94248).then(n.bind(n,260190))),"services-gallery"),yL=Ex((()=>n.e(83483).then(n.bind(n,610224))),"services-google-calendar-authentication"),kL=Ex((()=>n.e(83483).then(n.bind(n,610224))),"services-google-contacts-authentication"),SL=Ex((()=>n.e(87480).then(n.bind(n,252151))),"services-image-proxy"),bL=Ex((()=>n.e(42705).then(n.bind(n,681848))),"immersive-reader-service"),CL=Ex((()=>n.e(70972).then(n.bind(n,274399))),"services-import-msa-contacts"),wL=Ex((()=>n.e(17965).then(n.bind(n,763250))),"services-instant-answers"),NL=Ex((()=>n.e(23088).then(n.bind(n,970597))),"services-invite-links"),TL=Ex((()=>Promise.all([n.e(43653),n.e(8126),n.e(72467),n.e(96978)]).then(n.bind(n,814333))),"services-live-state-broadcast"),IL=Ex((()=>Promise.all([n.e(83836),n.e(4867),n.e(3985),n.e(14408)]).then(n.bind(n,680556))),"services-live-stream-renderer"),EL=Ex((()=>n.e(22581).then(n.bind(n,35917))),"services-lms-integration"),AL=Ex((()=>n.e(88475).then(n.bind(n,554605))),"services-tenant-analytics"),_L=Ex((()=>n.e(89829).then(n.bind(n,305831))),"services-loki"),DL=Ex((()=>n.e(26934).then(n.bind(n,202929))),"services-discover-surface"),FL=Ex((()=>n.e(90579).then(n.bind(n,92614))),"services-discover-surface-feedback"),ML=Ex((()=>n.e(3998).then(n.bind(n,725797))),"services-guardians"),RL=Ex((()=>n.e(51074).then(n.bind(n,815589))),"services-locked-teams"),PL=Ex((()=>n.e(88975).then(n.bind(n,967940))),"services-logs-files"),OL=Ex((()=>n.e(2066).then(n.bind(n,739258))),"services-manage-tenant"),xL=Ex((()=>Promise.all([n.e(51778),n.e(61724),n.e(10287),n.e(43130),n.e(83989),n.e(61440)]).then(n.bind(n,585353))),"services-meet-for-work"),LL=Ex((()=>Promise.all([n.e(6749),n.e(45626)]).then(n.bind(n,996434))),"services-meeting-artifacts"),UL=Ex((()=>n.e(94945).then(n.bind(n,762736))),"services-meeting-intelligence"),BL=Ex((()=>n.e(24251).then(n.bind(n,237747))),"services-meeting-recap"),jL=Ex((()=>n.e(20516).then(n.bind(n,69988))),"services-meeting-options"),WL=Ex((()=>n.e(49880).then(n.bind(n,510255))),"services-meeting-recap-swa"),VL=Ex((()=>n.e(88137).then(n.bind(n,395964))),"services-meeting-templates"),HL=Ex((()=>n.e(25459).then(n.bind(n,862237))),"services-mesh-session"),$L=Ex((()=>n.e(50104).then(n.bind(n,273529))),"services-msa-authentication"),zL=Ex((()=>Promise.all([n.e(50064),n.e(16151)]).then(n.bind(n,339696))),"services-people"),GL=(Ex((()=>n.e(37342).then(n.bind(n,620115))),"services-viva-insights"),Ex((()=>n.e(16313).then(n.bind(n,838738))),"services-people-picker")),qL=Ex((()=>Promise.all([n.e(94265),n.e(54165)]).then(n.bind(n,940417))),"services-people-targeting"),QL=Ex((()=>n.e(50718).then(n.bind(n,124421))),"services-files-personal"),JL=Ex((()=>n.e(14988).then(n.bind(n,826722))),"services-example"),YL=Ex((()=>n.e(42461).then(n.bind(n,632426))),"services-petrol"),KL=Ex((()=>Promise.all([n.e(98557),n.e(94166)]).then(n.bind(n,753261))),"services-floodgate"),ZL=Ex((()=>n.e(43607).then(n.bind(n,550088))),"services-ods"),XL=Ex((()=>n.e(4609).then(n.bind(n,405667))),"services-policies"),eU=Ex((()=>n.e(76130).then(n.bind(n,801270))),"services-presence"),tU=Ex((()=>Promise.all([n.e(51778),n.e(61724),n.e(23363)]).then(n.bind(n,804119))),"scis-service"),nU=Ex((()=>Promise.all([n.e(51778),n.e(61724),n.e(86854),n.e(45129),n.e(79506)]).then(n.bind(n,697312))),"services-search"),iU=Ex((()=>Promise.all([n.e(26589),n.e(72842)]).then(n.bind(n,917023))),"services-search-meeting-summary"),aU=Ex((()=>n.e(19161).then(n.bind(n,207774))),"search-substrate"),oU=Ex((()=>n.e(2078).then(n.bind(n,770964))),"services-substrate-meeting-recommendations"),rU=Ex((()=>n.e(86272).then(n.bind(n,597492))),"services-substrate-recommendations"),sU=Ex((()=>n.e(99164).then(n.bind(n,327307))),"services-sharepoint-client"),lU=Ex((()=>n.e(30288).then(n.bind(n,366380))),"services-sharepoint-share"),dU=Ex((()=>n.e(15793).then(n.bind(n,364780))),"services-share"),cU=Ex((()=>n.e(92876).then(n.bind(n,925980))),"services-signals"),uU=Ex((()=>n.e(63473).then(n.bind(n,376057))),"services-smb-user-intent"),mU=Ex((()=>Promise.all([n.e(88591),n.e(59098)]).then(n.bind(n,49106))),"services-store"),gU=Ex((()=>Promise.all([n.e(86854),n.e(38431)]).then(n.bind(n,616062))),"services-suggestions"),pU=Ex((()=>Promise.all([n.e(86854),n.e(34949)]).then(n.bind(n,7497))),"services-implicit-contacts"),vU=Ex((()=>n.e(52761).then(n.bind(n,447248))),"services-targeting-hierarchy"),hU=Ex((()=>n.e(62437).then(n.bind(n,762346))),"services-tenant-membership"),fU=Ex((()=>n.e(72557).then(n.bind(n,977577))),"services-tenant-service"),yU=Ex((()=>n.e(77412).then(n.bind(n,871731))),"services-third-party-calendar"),kU=Ex((()=>n.e(54692).then(n.bind(n,882513))),"services-toast-image"),SU=(Ex((()=>n.e(51309).then(n.bind(n,668136))),"services-teams-and-channels"),Ex((()=>n.e(16014).then(n.bind(n,896166))),"services-translate")),bU=Ex((()=>n.e(6408).then(n.bind(n,960328))),"services-tpn-notice"),CU=Ex((()=>n.e(39613).then(n.bind(n,639464))),"unified-consent-state"),wU=Ex((()=>Promise.all([n.e(84460),n.e(14826)]).then(n.bind(n,670660))),"services-url-preview"),NU=Ex((()=>n.e(13549).then(n.bind(n,346253))),"services-user-profile"),TU=Ex((()=>n.e(1172).then(n.bind(n,256223))),"services-voicemail"),IU=Ex((()=>n.e(48693).then(n.bind(n,397008))),"services-item-crud"),EU=Ex((()=>n.e(51792).then(n.bind(n,548847))),"services-webinar"),AU=Ex((()=>Promise.all([n.e(51778),n.e(61724),n.e(83989),n.e(78815)]).then(n.bind(n,812039))),"services-meeting-bot"),_U=Ex((()=>n.e(29961).then(n.bind(n,87946))),"services-virtual-events"),DU=Ex((()=>n.e(23935).then(n.bind(n,584665))),"services-developer-switchers"),FU=Ex((()=>n.e(78053).then(n.bind(n,974586))),"services-search-prefetch"),MU=Ex((()=>n.e(84615).then(n.bind(n,145684))),"services-call-recording"),RU=Ex((()=>n.e(59616).then(n.bind(n,57617))),"services-user-license"),PU=Ex((()=>n.e(76049).then(n.bind(n,434018))),"services-payment"),OU=Ex((()=>n.e(17341).then(n.bind(n,557652))),"services-monetization"),xU=Ex((()=>n.e(57264).then(n.bind(n,353751))),"services-mru"),LU=Ex((()=>n.e(1035).then(n.bind(n,615489))),"services-collab-cloud"),UU=Ex((()=>n.e(55402).then(n.bind(n,294438))),"tfl-user-service"),BU=Ex((()=>n.e(72042).then(n.bind(n,362524))),"services-sensitivity-label-policy-settings"),jU=Ex((()=>n.e(83548).then(n.bind(n,308589))),"services-meeting-questions-and-answers"),WU=e=>()=>e.userServicesCache(Tx.AsyncMediaService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,gtmRegistry:n,discover:i,coreSettings:a,loggerFactory:o,scenarioFactory:r,endpointsManager:s}=e,{AsyncMediaService:l}=yield Rx(r);return new l(t,n,i,a,o,s,r)})))(e))),VU=e=>()=>e.userServicesCache(Tx.SharepointRestClient,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,scenarioFactory:i}=e,{SharepointRestClient:a}=yield sU(i);return new a(t,n)})))(e))),HU=(e,t)=>()=>e.userServicesCache(Tx.BotsPlatformService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:n,scenarioFactory:i,gtmRegistry:a,send:o,discover:r,platformService:s,i18n:l}=e,d=yield t(),{BotsPlatformService:c}=yield xx(i);return new c(n,d,a.bind(o,Lr.Pn.middleTier),r,i,s,l)})))(e,t))),$U=e=>()=>e.userServicesCache(Tx.ConnectedAccountsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,scenarioFactory:i,send:a,coreSettings:o,i18n:r}=e,{ConnectedAccountsService:s}=yield nL(i);return new s(t,n,i,o,a,r)})))(e))),zU=e=>()=>e.userServicesCache(Tx.GoogleCalendarAuthenticationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,windowProvider:i,scenarioFactory:a,platformService:o}=e,{GoogleCalendarAuthenticationService:r}=yield yL(a);return new r(i,t,n,a,o)})))(e))),GU=e=>()=>e.userServicesCache(Tx.GoogleContactsAuthenticationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,windowProvider:i,scenarioFactory:a,platformService:o}=e,{GoogleContactsAuthenticationService:r}=yield kL(a);return new r(i,t,n,a,o)})))(e))),qU=e=>()=>e.userServicesCache(Tx.MsaAuthenticationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,windowProvider:i}=e,{MsaAuthenticationService:a}=yield $L(n);return new a(t,n,i)})))(e))),QU=(e,t,n,a)=>()=>e.userServicesCache(Tx.ExternalAccountsService,(()=>((e,t,n,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,scenarioFactory:o,authenticationService:r,platformService:s}=e,l=yield t(),d=yield n(),c=yield a(),{ExternalAccountsService:u}=yield dL(o);return new u(i,r,l,d,c,o,s)})))(e,t,n,a))),JU=(e,t,n)=>()=>e.userServicesCache(Tx.ThirdPartyCalendarService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:i,scenarioFactory:a,authenticationService:o,localStorage:r}=e,s=yield t(),l=yield n(),{ThirdPartyCalendarService:d}=yield yU(a);return new d(i,o,s,l,a,r)})))(e,t,n)));var YU=n(488752);const KU=e=>()=>e.userServicesCache(Tx.CallingAppEventsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,windowProvider:i}=e,{ObservableFactory:a}=yield Ax(),o=new a;return new YU.n(t,o,n,i)})))(e)));var ZU=n(596992);const XU=(e,t)=>()=>e.userServicesCache(Tx.CallingBannerServiceAdapter,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,i18n:i}=e,a=yield t();return new ZU.Y(n,a,i)})))(e,t)));var eB=n(219475);const tB=(e,t)=>()=>e.userServicesCache(Tx.CallingDialogServiceAdapter,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i}=e,a=yield t();return new eB.l(n,i,a)})))(e,t)));var nB=n(379733);const iB=(e,t)=>()=>e.userServicesCache(Tx.CallingNotificationServiceAdapter,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,coreSettings:i}=e,a=yield t();return new nB.L(n,i,a)})))(e,t))),aB=e=>()=>e.userServicesCache(Tx.DiscoverSurfaceService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,endpointsManager:i}=e,{DiscoverSurfaceService:a}=yield DL(n);return new a(t,i,n)})))(e))),oB=e=>()=>e.userServicesCache(Tx.UserLicenseService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:n,loggerFactory:i,scenarioFactory:a}=e,{UserLicenseService:o}=yield RU(a);return new o(t,n,i,a)})))(e))),rB=(e,t)=>()=>e.userServicesCache(Tx.SmbUserIntentService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:n,loggerFactory:i,scenarioFactory:a,localStorage:o,windowProvider:r}=e,s=yield t(),{SmbUserIntentService:l}=yield uU(a);return new l(i,n,o,s,r,a)})))(e,t))),sB=e=>()=>e.userServicesCache(Tx.TenantPrivacyProfileService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,authenticationService:n,coreSettings:i,scenarioFactory:a,endpointsManager:o,localStorage:r,discover:s}=e,{CallingIdentityAdapterService:l,ClientDatabaseService:d,AggregatedSettingsStoreService:c,ACSCallingAuthenticationServiceAdapter:u,CallingAuthenticationServiceAdapter:m,TenantPrivacyProfileService:g}=yield Ax(),p=new d(t,r),v=new c(t,i),h=yield n.getUser();return new g(t,n,new l(i.get(K.J.Calling).enableACSEmbed?new u(s,h,t):new m(n,s,h,t),v,t),i,p,a,o)})))(e))),lB=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(K.J.CMDMeetingArtifactsService))||void 0===t?void 0:t.enableCMDMeetingArtifactsService))throw new Error("FF enableCMDMeetingArtifactsService is disabled");return e.userServicesCache(Tx.CollabObjectService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,coreSettings:n,loggerFactory:i,endpointsManager:a,scenarioFactory:o,discover:r}=e,{CollabObjectService:s}=yield eL(o);return new s(t,n,i,a,r)})))(e)))},dB=e=>()=>e.userServicesCache(Tx.AiInsightsFeedbackService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,loggerFactory:i}=e,{AiInsightsFeedbackService:a}=yield Vx(t);return new a(n,i,t)})))(e))),cB=e=>()=>e.userServicesCache(Tx.AiInsightsSdsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,loggerFactory:i}=e,{AiInsightsSdsService:a}=yield Hx(t);return new a(n,i,t)})))(e))),uB=(e,t)=>()=>e.userServicesCache(Tx.AppBasedLinkService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,scenarioFactory:i,loggerFactory:a}=e,{AppBasedLinkService:o}=yield _x(i);return new o(n,yield t(),i,a)})))(e,t))),mB=e=>()=>e.userServicesCache(Tx.AppsPlatformService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,coreSettings:n,endpointsManager:i,localStorage:a,authenticationService:o}=e,{enableMetaOsSdkIntegration:r}=n.get(K.J.Extensibility),{AppsPlatformService:s,AppsPlatformServiceMetaOS:l}=yield Dx(t);return r?new l(n,i,t,o):new s(n,i,a)})))(e))),gB=e=>()=>e.userServicesCache(Tx.AppSuggestionsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,coreSettings:i,loggerFactory:a,windowProvider:o}=e,{AppSuggestionsService:r}=yield Fx(t);return new r(i,n,a,o)})))(e))),pB=e=>()=>e.userServicesCache(Tx.AzureMapsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,i18NextWrapper:n,scenarioFactory:i,coreSettings:a}=e,{AzureMapsService:o}=yield Px(i);return new o(t,a,n)})))(e))),vB=e=>()=>e.userServicesCache(Tx.BadgeCountService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,config:n,discover:i,platformService:a,scenarioFactory:o}=e,{BadgeCountService:r}=yield Kx(o);return new r(a,t,i,n)})))(e))),hB=e=>()=>e.userServicesCache(Tx.BrbService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,coreSettings:i,logsCollectorService:a,authenticationService:o,platformService:r,discover:s,windowProvider:l,hostCommunicationService:d,endpointsManager:c,authenticationUser:u,i18n:m}=e,{BrbService:g}=yield Lx(t);return new g(n,i,a,o,r,s,l,d,c,t,m,u)})))(e))),fB=e=>()=>e.userServicesCache(Tx.BreakoutRoomsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{BreakoutRoomsService:i}=yield Ux(t);return new i(n)})))(e))),yB=(e,t)=>()=>e.userServicesCache(Tx.BreakoutRoomsHelper,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,endpointsManager:a,coreSettings:o}=e,{enableCalling:r}=o.get(K.J.BreakoutRoom),{BreakoutRoomsCallingHelper:s,BreakoutRoomsNoCallingHelper:l}=yield Ux(n);return r?new s((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return t(e)})))):new l(a)})))(e,t))),kB=e=>()=>e.userServicesCache(Tx.AtpSafelinksService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,localStorage:r,send:s}=e,{AtpSafelinksService:l}=yield Mx(o);return new l(i.bind(s,Lr.Pn.middleTier),t,n,o,a,r)})))(e))),SB=e=>()=>e.userServicesCache(Tx.BroadcastAttendeeService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,windowProvider:o}=e,{BroadcastAttendeeService:r}=yield zx(a);return new r(t,i,a,o,n)})))(e))),bB=e=>()=>e.userServicesCache(Tx.BroadcastStreamingAttendeeService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{BroadcastStreamingAttendeeService:i}=yield Gx(n);return new i(t)})))(e))),CB=e=>()=>e.userServicesCache(Tx.BroadcastCaptionsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,send:n,endpointsManager:i,scenarioFactory:a,windowProvider:o,loggerFactory:r}=e,{BroadcastCaptionsService:s}=yield qx(a);return new s(o,r,a,t,n,i)})))(e))),wB=e=>()=>e.userServicesCache(Tx.BroadcastSignalRService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,endpointsManager:i,windowProvider:a}=e,{BroadcastSignalRService:o}=yield Qx(t);return new o(n,i,t,a)})))(e)));var NB=n(162024);const TB=(e,t)=>n=>{t({payload:n,pubsub:e})},IB=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:i,gtmRegistry:a,loggerFactory:o,pubsub:r,send:s,windowProvider:l}=e,{CallBlockingService:d}=yield n.e(67417).then(n.bind(n,489859));return new d(t,i,a.bind(s,Lr.Pn.middleTier),o.newLogger("CallBlockingService"),l,TB(r,EB))})),EB=({payload:e,pubsub:t})=>{t.publish(NB.oo,e.newBlockedMris)};class AB{constructor(){this._displayName=null,this.getDisplayName=()=>this._displayName,this.setDisplayName=e=>{this._displayName=e}}}const _B=e=>()=>e.userServicesCache(Tx.CallingAnonymousDisplayNameService,(()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return new AB})))),DB=e=>()=>e.userServicesCache(Tx.CmdMeetingIntelligenceService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{CmdMeetingIntelligenceService:i}=yield Xx(t);return new i(n)})))(e))),FB=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(K.J.MeetingCatchupService))||void 0===t?void 0:t.enableMeetingCatchupService))throw new Error("FF enableMeetingCatchupService is disabled");return e.userServicesCache(Tx.MeetingCatchupService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{MeetingCatchupService:i}=yield tL(n);return new i(t)})))(e)))},MB=e=>()=>e.userServicesCache(Tx.ConnectedCalendarSettingsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,scenarioFactory:n,endpointsManager:i}=e,{ConnectedCalendarSettingsService:a}=yield iL(n);return new a(n,t,i)})))(e))),RB=e=>()=>{const{coreSettings:t}=e,{enableCMDServiceForTokenRetriveAndVoiceSignatureStore:n}=t.get(K.J.BiometricEnrollment),{isCMDSvcEnabledForBiometricStorage:a}=t.get(K.J.Host);return n||a?e.userServicesCache(Tx.BiometricEnrollmentService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,coreSettings:i,loggerFactory:a,platformService:o,scenarioFactory:r,i18n:s}=e,{VoiceBiometricEnrollmentService:l}=yield Ox(r);return new l(t,n,i,a,o,s)})))(e))):e.userServicesCache(Tx.BiometricEnrollmentService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,loggerFactory:i,platformService:a,scenarioFactory:o,send:r,coreSettings:s,i18n:l}=e,{BiometricEnrollmentService:d}=yield Ox(o);return new d(t,n,i,a,r,s,l)})))(e)))},PB=e=>()=>e.userServicesCache(Tx.BiometricFaceEnrollmentService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,coreSettings:i,loggerFactory:a,platformService:o,scenarioFactory:r}=e,{BiometricFaceEnrollmentService:s}=yield Ox(r);return new s(t,n,i,a,o)})))(e))),OB=e=>()=>e.userServicesCache(Tx.DeveloperSwitchersService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,rebootService:n,windowProvider:i,loggerFactory:a,config:o}=e,{DeveloperSwitchersService:r}=yield DU(t);return new r(n,i,a.newLogger("DeveloperSwitchersService"),o)})))(e))),xB=e=>()=>e.userServicesCache(Tx.DistributionListService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,loggerFactory:i,coreSettings:a,scenarioFactory:o}=e,{DistributionListService:r}=yield aL(o);return new r(i,t.bind(n,Lr.Pn.middleTier),a)})))(e))),LB=e=>()=>e.userServicesCache(Tx.DynamicsMarketingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,send:i,scenarioFactory:a}=e,{DynamicsMarketingService:o}=yield oL(a);return new o(t,n,i)})))(e))),UB=e=>()=>e.userServicesCache(Tx.DynamicsVirtualEventsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,send:i,i18NextWrapper:a,scenarioFactory:o,loggerFactory:r,discover:s}=e,{DynamicsVirtualEventsService:l}=yield rL(o);return new l(t,n,i,a,r,s)})))(e))),BB=(e,t)=>()=>e.userServicesCache(Tx.EmoticonService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,localStorage:i,scenarioFactory:a,coreSettings:o,i18n:r}=e,{EmoticonService:s}=yield sL(a),l=new s(yield t(),r.locale,i,o,n.newLogger("EmoticonService"),a,r);return yield l.isInitialized,l})))(e,t))),jB=e=>()=>e.userServicesCache(Tx.EspService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{EspService:i}=yield lL(n);return new i(t)})))(e))),WB=e=>()=>e.userServicesCache(Tx.ExampleService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{ExampleService:n}=yield JL(t);return new n})))(e))),VB=(e,t)=>()=>e.userServicesCache(Tx.ExternalAccountsResponseService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,scenarioFactory:i}=e,a=yield t(),{ExternalAccountsResponseService:o}=yield cL(i);return new o(n,a,i)})))(e,t))),HB=e=>()=>e.userServicesCache(Tx.FluidService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i}=e,{FluidService:a}=yield vL(i);return new a(t,n)})))(e))),$B=e=>()=>e.userServicesCache(Tx.GalleryService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,send:i,scenarioFactory:a}=e,{GalleryService:o}=yield fL(a);return new o(i,t,n,a)})))(e))),zB=e=>()=>e.userServicesCache(Tx.GiphyService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:n,endpointsManager:i,send:a,scenarioFactory:o,i18n:r}=e,{GiphyService:s}=yield hL(o);return new s(n.bind(a,Lr.Pn.middleTier),t,r.locale,i)})))(e))),GB=e=>()=>e.userServicesCache(Tx.GuardiansService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a,loggerFactory:o}=e,{GuardiansService:r}=yield ML(a);return new r(t,o,n,i)})))(e))),qB=e=>()=>e.userServicesCache(Tx.ImageProxyService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,gtmRegistry:n,send:i,scenarioFactory:a}=e,{ImageProxyService:o}=yield SL(a);return new o(n,i,t)})))(e))),QB=e=>()=>e.userServicesCache(Tx.ImmersiveReaderService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{ImmersiveReaderService:i}=yield bL(n);return new i(t)})))(e))),JB=(e,t)=>()=>t.userServicesCache(Tx.ImportMsaContactsService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,endpointsManager:i,scenarioFactory:a}=t,{ImportMsaContactsService:o}=yield CL(a);return new o(yield e(),n,i,a)})))(e,t))),YB=e=>()=>e.userServicesCache(Tx.ImplicitContactsService,(()=>(({discover:e,gtmRegistry:t,send:n,scenarioFactory:a})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{ImplicitContactsService:i}=yield pU(a);return new i(n,e,t,a)})))(e))),KB=e=>()=>e.userServicesCache(Tx.InstantAnswersService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,send:n,scenarioFactory:i,loggerFactory:a,i18n:o}=e,{InstantAnswersService:r}=yield wL(i);return new r(a,i,t,n,o)})))(e))),ZB=e=>()=>e.userServicesCache(Tx.InviteLinksService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{InviteLinksService:i}=yield NL(t);return new i(n)})))(e))),XB=e=>()=>e.userServicesCache(Tx.LiveStateBroadcastService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{pubsub:t,scenarioFactory:n,loggerFactory:i,coreSettings:a,authenticationService:o,platformService:r,discover:s}=e,{LiveStateBroadcastService:l}=yield TL(n);return new l(t,i,a,o,r,n,s)})))(e))),ej=e=>()=>e.userServicesCache(Tx.LiveStreamRenderingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,discover:n,send:i,scenarioFactory:a,loggerFactory:o,pubsub:r,platformService:s,clientState:l,coreSettings:d,endpointsManager:c,networkState:u}=e,{LiveStreamRenderingService:m}=yield IL(a),{ACSCallingAuthenticationServiceAdapter:g,CallingAuthenticationServiceAdapter:p}=yield Ax(),v=yield t.getUser();return new m(o,d.get(K.J.Calling).enableACSEmbed?new g(n,v,o):new p(t,n,v,o),s,l,r,i,d,a,c,u)})))(e))),tj=e=>()=>e.userServicesCache(Tx.LmsIntegrationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a}=e,{LmsIntegrationService:o}=yield EL(a);return new o(t,n,i)})))(e))),nj=e=>()=>e.userServicesCache(Tx.LockedTeamsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:n,send:i,scenarioFactory:a}=e,{LockedTeamsService:o}=yield RL(a);return new o(t,n,i)})))(e))),ij=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,logsCollectorService:i,coreSettings:a}=e;let o,r;"entityCommanding"in e&&(o=e.entityCommanding),"i18n"in e&&(r=e.i18n);const{LogsFilesService:s}=yield PL(t);return new s(n,i,a,void 0,o,r)})),aj=e=>()=>e.userServicesCache(Tx.LogsFilesService,(()=>ij(e))),oj=e=>()=>e.userServicesCache(Tx.LokiService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,scenarioFactory:i,coreSettings:a}=e,{LokiService:o}=yield _L(i);return new o(n,t,a)})))(e))),rj=e=>()=>e.userServicesCache(Tx.ManageTenantService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,endpointsManager:n,loggerFactory:i,scenarioFactory:a}=e,{ManageTenantService:o}=yield OL(a);return new o(t,i,a,n)})))(e))),sj=(e,t,n)=>()=>{if(!e.coreSettings.get(K.J.Meet).enableMeetForWork)throw new Error("enableMeetForWork flag is disabled");return e.userServicesCache(Tx.MeetForWorkService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,authenticationService:a,authenticationUser:o,loggerFactory:r,cmdApolloClient:s,coreSettings:l,pubsub:d,endpointsManager:c}=e,{MeetForWorkService:u}=yield xL(i),m=yield t(),{enableCMDMeetingArtifactsService:g}=l.get(K.J.CMDMeetingArtifactsService);return new u(a,m,g?yield n():void 0,s,o,i,l,d,r,c)})))(e,t,n)))},lj=e=>()=>e.userServicesCache(Tx.MeetingArtifactsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,coreSettings:i,scenarioFactory:a,i18n:o,loggerFactory:r}=e,{MeetingArtifactsService:s}=yield LL(a);return new s(n,t,i,o,r,a)})))(e))),dj=(e,t,n)=>()=>{var a;const{coreSettings:o}=e;if(!(null===(a=null==o?void 0:o.get(K.J.MeetingBot))||void 0===a?void 0:a.enableMeetingBot))throw new Error("enableMeetingBot flag is disabled");return e.userServicesCache(Tx.MeetingBotService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,cmdApolloClient:a,authenticationService:o,coreSettings:r,loggerFactory:s,localStorage:l,platformService:d,windowProvider:c,entityCommanding:u,i18n:m,authenticationUser:g}=e,{MeetingBotService:p}=yield AU(i);return new p(o,yield t(),r,yield n(),s,i,c,l,d,a,u,m,g)})))(e,t,n)))},cj=e=>()=>e.userServicesCache(Tx.MeetingIntelligenceService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{MeetingIntelligenceService:i}=yield UL(t);return new i(n)})))(e))),uj=e=>()=>e.userServicesCache(Tx.PeopleService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,endpointsManager:a,coreSettings:o}=e,{PeopleService:r}=yield zL(i);return new r(t.bind(n,Lr.Pn.middleTier),o,a)})))(e))),mj=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{windowProvider:t,coreSettings:i,scenarioFactory:a,loggerFactory:o}=e,{MeetingOptionsClientDataService:r}=yield n.e(20516).then(n.bind(n,948327)),s=uj(e);return new r(t,yield s(),i,a,o)})),gj=e=>()=>e.userServicesCache(Tx.MeetingOptionsClientDataService,(()=>mj(e))),pj=e=>()=>e.userServicesCache(Tx.MeetingOptionsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i,coreSettings:a,gtmRegistry:o,discover:r,loggerFactory:s}=e,{MeetingOptionsService:l}=yield jL(i);return new l(t,n,i,a,o,r,s)})))(e))),vj=e=>()=>e.userServicesCache(Tx.MeetingQuestionsAndAnswersService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:t,scenarioFactory:n,endpointsManager:i}=e,{MeetingQuestionsAndAnswersService:a}=yield jU(n);return new a(i,t,n)})))(e))),hj=e=>()=>e.userServicesCache(Tx.MeetingRecapService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{MeetingRecapService:i}=yield BL(t);return new i(n)})))(e))),fj=e=>()=>e.userServicesCache(Tx.MeetingRecapSwaService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,scenarioFactory:n,authenticationService:i}=e,{MeetingRecapSwaService:a}=yield WL(n);return new a(i,t)})))(e))),yj=e=>()=>e.userServicesCache(Tx.MeetingTemplateService,(()=>(({scenarioFactory:e,send:t,authenticationService:n,coreSettings:a,discover:o,loggerFactory:r})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{MeetingTemplateService:i}=yield VL(e);return new i(t,n,a,e,o,r)})))(e))),kj=e=>()=>e.userServicesCache(Tx.MeshSessionService,(()=>(({authenticationService:e,loggerFactory:t,scenarioFactory:n,send:a})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{MeshSessionService:i}=yield HL(n);return new i(e,t,a)})))(e))),Sj=e=>()=>e.userServicesCache(Tx.PaymentsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,i18n:o,loggerFactory:r}=e,{PaymentService:s}=yield PU(t);return new s(n,i,a,r,t,o)})))(e)));var bj=n(185392);const Cj=e=>()=>e.userServicesCache(Tx.PeoplePickerService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,endpointsManager:a,coreSettings:o}=e,{PeoplePickerService:r}=yield GL(i);return new r((0,bj.Y)(t.bind(n,Lr.Pn.middleTier),o,a))})))(e))),wj=e=>()=>e.userServicesCache(Tx.PeopleTargetingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:n,send:i,coreSettings:a,scenarioFactory:o,discover:r}=e,{PeopleTargetingService:s}=yield qL(o);return new s(t,n,i,a,r)})))(e))),Nj=e=>()=>e.userServicesCache(Tx.PoliciesService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,endpointsManager:n,loggerFactory:i,networkState:a,scenarioFactory:o}=e,{PoliciesService:r}=yield XL(o);return new r(n,t,i,a,o)})))(e))),Tj=e=>()=>e.userServicesCache(Tx.PresenceService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,pubsub:n,send:i,scenarioFactory:a,platformService:o,config:r}=e,{PresenceService:s}=yield eU(a);return new s(t.bind(i,Lr.Pn.unifiedPresence),n,o,r)})))(e))),Ij=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i,loggerFactory:a}=e,{AddressService:o}=yield n.e(21836).then(n.bind(n,535959));return new o(t.bind(i,Lr.Pn.middleTier),a)})),Ej=e=>()=>e.userServicesCache(Tx.AddressService,(()=>Ij(e))),Aj=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i}=e,{PstnService:a}=yield n.e(93393).then(n.bind(n,774616));return new a(t.bind(i,Lr.Pn.middleTier))})),_j=e=>()=>e.userServicesCache(Tx.PstnService,(()=>Aj(e))),Dj=e=>()=>e.userServicesCache(Tx.SCISService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,authenticationService:n,platformService:i,scenarioFactory:a,loggerFactory:o}=e,{SCISService:r}=yield tU(a);return new r(t,n,i,a,o)})))(e))),Fj=e=>()=>e.userServicesCache(Tx.SearchPrefetchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,authenticationService:i}=e,{SearchPrefetchService:a}=yield FU(t);return new a(i,n)})))(e))),Mj=e=>()=>e.userServicesCache(Tx.ShareService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,gtmRegistry:i,scenarioFactory:a,send:o,i18n:r}=e,{ShareService:s}=yield dU(a);return new s(t,n,i,o,r)})))(e))),Rj=e=>()=>e.userServicesCache(Tx.StoreService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,gtmRegistry:i,localStorage:a,coreSettings:o,authenticationService:r,platformService:s,endpointsManager:l,windowProvider:d,i18n:c}=e,{StoreService:u}=yield mU(t);return new u(t,n,i,a,o,r,s,l,d,c)})))(e))),Pj=e=>()=>e.userServicesCache(Tx.StyleMyRoomService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,i18n:n,scenarioFactory:i,endpointsManager:a}=e,{StyleMyRoomService:o}=yield $x(i);return new o(t,a,n)})))(e))),Oj=e=>()=>e.userServicesCache(Tx.TenantMembershipService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{TenantMembershipService:i}=yield hU(t);return new i(t,n)})))(e))),xj=e=>()=>e.userServicesCache(Tx.TenantService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{TenantService:i}=yield fU(t);return new i(t,n)})))(e))),Lj=e=>()=>e.userServicesCache(Tx.TenantAnalyticsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n,loggerFactory:i}=e,{TenantAnalyticsService:a}=yield AL(n);return new a(i,t)})))(e))),Uj=e=>()=>e.userServicesCache(Tx.TranscriptService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,coreSettings:i,loggerFactory:a}=e,{TranscriptService:o}=yield Bx(t);return new o(n,a,t,i)})))(e))),Bj=e=>()=>e.userServicesCache(Tx.TranscriptFeedbackService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{TranscriptFeedbackService:n}=yield Wx(t);return new n})))(e))),jj=e=>()=>e.userServicesCache(Tx.TranscriptSettingsStoreService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,authenticationUser:i}=e,{SettingsStoreService:a}=yield jx(t);return new a(n,i)})))(e))),Wj=e=>()=>e.userServicesCache(Tx.TranslateService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,endpointsManager:n,coreSettings:i,scenarioFactory:a,send:o}=e,{TranslateService:r}=yield SU(a);return new r(t.bind(o,Lr.Pn.middleTier),a,i,n)})))(e))),Vj=e=>()=>e.userServicesCache(Tx.TargetingHierarchyService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,discover:i,loggerFactory:a,scenarioFactory:o,send:r}=e,{TargetingHierarchyService:s}=yield vU(o);return new s(t,a,r,n,i)})))(e))),Hj=e=>()=>e.userServicesCache(Tx.ToastImageService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{ToastImageService:i}=yield kU(t);return new i(n)})))(e)));var $j=n(68156);const zj=e=>()=>e.userServicesCache(Tx.TeamsAndChannelsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t}=e;return new $j.K(t)})))(e))),Gj=e=>()=>e.userServicesCache(Tx.TpnNoticeService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,platformService:n,scenarioFactory:i}=e,{TpnNoticeService:a}=yield bU(i);return new a(t,n)})))(e))),qj=(e,t)=>()=>e.userServicesCache(Tx.UrlPreviewService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:n,endpointsManager:i,send:a,coreSettings:o,scenarioFactory:r}=e,{UrlPreviewService:s}=yield wU(r);return new s(n,a,o,yield t(),i,r)})))(e,t))),Qj=e=>()=>e.userServicesCache(Tx.UserProfileService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:n,scenarioFactory:i,coreSettings:a}=e,{UserProfileService:o}=yield NU(i);return new o(n,t,a)})))(e))),Jj=e=>()=>e.userServicesCache(Tx.VirtualEventsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r}=e,{VirtualEventsService:s,MockVirtualEventsService:l}=yield _U(t);return a.get(K.J.VirtualEvents).forceUseMockAPIs?new l:new s(n,i,a,o,r)})))(e)));var Yj=n(599820);const Kj=({payload:e,pubsub:t})=>{t.publish(Yj.Gq,e)},Zj=e=>()=>e.userServicesCache(Tx.VoicemailService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,pubsub:o,send:r,windowProvider:s}=e,{VoicemailService:l}=yield TU(a);return new l(t,n,r,i,s,TB(o,Kj))})))(e))),Xj=e=>()=>e.userServicesCache(Tx.WebinarService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,i18n:r,loggerFactory:s}=e,{WebinarService:l}=yield EU(t);return new l(n,i,a,s,t,r,o)})))(e))),eW=e=>()=>e.userServicesCache(Tx.CallRecordingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,endpointsManager:i}=e,{CallRecordingService:a}=yield MU(t);return new a(n,i)})))(e))),tW=e=>()=>e.userServicesCache(Tx.MonetizationService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i,loggerFactory:a,discover:o,coreSettings:r,localStorage:s}=e,{MonetizationService:l}=yield OU(i);return new l(t,n,a,o,r,s)})))(e))),nW=e=>()=>e.userServicesCache(Tx.MRUItemService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,scenarioFactory:i}=e,{MRUService:a}=yield xU(i);return new a(t,n)})))(e))),iW=(e,t)=>()=>e.userServicesCache(Tx.DiscoverSurfaceFeedbackService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,windowProvider:i}=e,{DiscoverSurfaceFeedbackService:a}=yield FL(n);return new a(yield t(),i)})))(e,t))),aW=e=>()=>{var t;const{coreSettings:n}=e;if(!(null===(t=null==n?void 0:n.get(K.J.Extensibility))||void 0===t?void 0:t.enableCollabCloudApis))throw new Error("enableCollabCloudApis flag is disabled");return e.userServicesCache(Tx.CollabCloudService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{CollabCloudService:i}=yield LU(t);return new i(n)})))(e)))},oW=e=>()=>e.userServicesCache(Tx.TFLUserService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n,localStorage:i,loggerFactory:a}=e,{TFLUserService:o}=yield UU(t);return new o(a,i,n)})))(e))),rW=e=>()=>e.userServicesCache(Tx.SensitivityLabelPolicySettingsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,discover:n,gtmRegistry:i,loggerFactory:a,authenticationUser:o,scenarioFactory:r,send:s}=e,{SensitivityLabelPolicySettingsService:l}=yield BU(r);return new l(t,i,s,n,a.newLogger("SensitivityLabelPolicySettingsService"),o)})))(e))),sW=(e,t,n)=>()=>e.userServicesCache(Tx.PetrolService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{platformService:i,authenticationService:a,coreSettings:o,send:r,scenarioFactory:s,loggerFactory:l,hostCommunicationService:d,i18n:c}=e,{PetrolService:u}=yield YL(s);return new u(a,s,l,i,o,r,yield t(),yield n(),d,c)})))(e,t,n))),lW=(e,t)=>()=>e.userServicesCache(Tx.FloodgateService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i,coreSettings:a,clientState:o,i18NextWrapper:r,windowProvider:s,platformService:l,authenticationUser:d}=e,c=yield t(),{FloodGateService:u}=yield KL(i);return new u(n,i,o,a,c,r,l,s,d)})))(e,t))),dW=(e,t,n)=>()=>e.userServicesCache(Tx.OdsService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:i,scenarioFactory:a,loggerFactory:o,endpointsManager:r,logsCollectorService:s,coreSettings:l,platformService:d,hostCommunicationService:c,i18n:u}=e,{OdsService:m}=yield ZL(a);return new m(i,o,r,s,l,d,yield t(),c,yield n(),u)})))(e,t,n))),cW=e=>()=>e.userServicesCache(Tx.LokiMetaPreviewService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,scenarioFactory:a}=e,{LokiMetaPreviewService:o}=yield nU(a);return new o(n,t,i)})))(e))),uW=e=>()=>e.userServicesCache(Tx.OdcFilePreviewService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,scenarioFactory:a}=e,{OdcFilePreviewService:o}=yield nU(a);return new o(n,t,i)})))(e))),mW=e=>()=>e.userServicesCache(Tx.OSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,discover:n,loggerFactory:i,scenarioFactory:a,coreSettings:o,endpointsManager:r}=e,{OSearchService:s}=yield nU(a);return new s(t,r,n,i,o)})))(e))),gW=e=>()=>e.userServicesCache(Tx.PeopleSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{send:t,endpointsManager:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,discover:r,coreSettings:s}=e,{PeopleSearchService:l}=yield nU(o);return new l(i.bind(t,Lr.Pn.middleTier),n,a,r,s)})))(e))),pW=e=>()=>e.userServicesCache(Tx.SubstrateFilesSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,platformService:i,loggerFactory:a,scenarioFactory:o,i18n:r}=e,{SubstrateFilesSearchService:s}=yield nU(o);return new s(n,t,i,o,a,r)})))(e))),vW=e=>()=>e.userServicesCache(Tx.SubstrateRecommendationsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n}=e,{SubstrateRecommendationsService:i}=yield rU(n);return new i(t)})))(e))),hW=e=>()=>e.userServicesCache(Tx.SubstrateSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,platformService:a,scenarioFactory:o,windowProvider:r,coreSettings:s,endpointsManager:l,i18n:d}=e,{SubstrateSearchService:c}=yield nU(o);return new c(n,t,a,o,i,r,s,l,d)})))(e))),fW=e=>()=>e.userServicesCache(Tx.SubstrateSuggestionsService,(()=>(({authenticationService:e,endpointsManager:t,coreSettings:n,discover:a,gtmRegistry:o,send:r,scenarioFactory:s,platformService:l})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{SubstrateSuggestionsService:i}=yield gU(s);return new i(r,t,e,n,a,o,l)})))(e))),yW=e=>()=>e.userServicesCache(Tx.SubstrateMeetingSearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,send:n,loggerFactory:i,platformService:a,scenarioFactory:o}=e,{SubstrateMeetingSearchService:r}=yield nU(o);return new r(n,t,a,o,i)})))(e))),kW=e=>()=>e.userServicesCache(Tx.SubstrateMeetingSummarySearchService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,loggerFactory:n,platformService:i,scenarioFactory:a,coreSettings:o,endpointsManager:r}=e,{SubstrateMeetingSummarySearchService:s}=yield iU(a);return new s(t,i,a,n,o,r)})))(e))),SW=e=>()=>e.userServicesCache(Tx.ChatService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,endpointsManager:n,platformService:i,coreSettings:a,send:o,scenarioFactory:r}=e,{ChatService:s}=yield Kx(r);return new s(t.bind(o,Lr.Pn.chatService),a,i,n)})))(e))),bW=(e,t)=>()=>e.userServicesCache(Tx.ChatServiceEndpointProvider,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n}=e,i=yield t(),{ChatServiceEndpointProvider:a}=yield Yx(n);return new a(i,n)})))(e,t))),CW=e=>()=>e.userServicesCache(Tx.ConsumerGroupsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:t,scenarioFactory:n,endpointsManager:i,loggerFactory:a}=e,{ConsumerGroupsService:o}=yield Kx(n);return new o(i,a,n,t)})))(e))),wW=e=>()=>e.userServicesCache(Tx.CSAService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,platformService:n,coreSettings:i,scenarioFactory:a,discover:o,endpointsManager:r,config:s,send:l}=e,{createCSAService:d}=yield Kx(a);return d(t,n,i,o,l,r,s)})))(e))),NW=e=>()=>e.userServicesCache(Tx.StatefulLongPoll,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{StatefulLongPoll:n}=yield Kx(t);return new n})))(e))),TW=e=>()=>e.userServicesCache(Tx.ReportConcernService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,gtmRegistry:i,platformService:a}=e,{ReportConcernService:o}=yield Zx(t);return new o(i.bind(n,Lr.Pn.middleTier),a)})))(e))),IW=(e,t)=>()=>e.userServicesCache(Tx.SharepointShareService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,loggerFactory:i,send:a,scenarioFactory:o}=e,{SharepointShareService:r}=yield lU(o);return new r(a,i,n,yield t())})))(e,t))),EW=(e,t)=>()=>e.userServicesCache(Tx.FilesRedeemService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:n,coreSettings:i,loggerFactory:a,send:o,scenarioFactory:r}=e,{FilesRedeemService:s}=yield lU(r);return new s(o,n,a,i,yield t())})))(e,t))),AW=(e,t,n)=>()=>n.userServicesCache(Tx.FilesSharepointUrlService,(()=>((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:i,coreSettings:a}=n,{FilesSharepointUrlService:o}=yield lU(i);return new o(yield e(),yield t(),a)})))(e,t,n))),_W=(e,t)=>()=>t.userServicesCache(Tx.FilesReferenceService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n}=t,{FilesReferenceService:i}=yield mL(n);return new i(yield e())})))(e,t))),DW=(e,t)=>()=>e.userServicesCache(Tx.FileUploadPreviewService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i}=e,{FileUploadPreviewService:a}=yield gL(i);return new a(yield t(),n)})))(e,t))),FW=(e,t)=>()=>e.userServicesCache(Tx.FileUploadService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{loggerFactory:n,scenarioFactory:i,coreSettings:a}=e,{FileUploadService:o}=yield gL(i);return new o(yield t(),a,n)})))(e,t))),MW=e=>()=>e.userServicesCache(Tx.FileDownloadManagerService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n}=e,{FileDownloadManagerService:i}=yield pL(t);return new i(n.newLogger("fileDownloadManagerService"))})))(e)));var RW=n(853761);const PW=(e,t)=>()=>e.userServicesCache(Tx.PersonalFileDetailsService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:n,gtmRegistry:i,loggerFactory:a,scenarioFactory:o,send:r}=e,s=yield t(),{PersonalFileDetailsService:l}=yield QL(o),d=new RW.q(n);return new l(s,o,a,i.bind(d.authorize(r,"x-skypetoken"),Lr.Pn.middleTier))})))(e,t))),OW=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,send:i,discover:a}=e,{RefreshSiteUrlService:o}=yield n.e(6545).then(n.bind(n,998316));return new o(t,a,i)})),xW=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{gtmRegistry:t,discover:i,loggerFactory:a,send:o}=e,{CloudStorageFoldersService:r}=yield Promise.all([n.e(88450),n.e(43990),n.e(90799),n.e(34125)]).then(n.bind(n,843250));return new r(t,i,a,o)})),LW=e=>()=>e.userServicesCache(Tx.CloudStorageFoldersService,(()=>xW(e))),UW=e=>()=>e.userServicesCache(Tx.FilesBackfillThreadPropertiesService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{discover:t,gtmRegistry:n,scenarioFactory:i,loggerFactory:a,send:o}=e,{FilesBackfillThreadPropertiesService:r}=yield mL(i),s=new RW.q(t);return new r(a,n.bind(s.authorize(o,"x-skypetoken"),Lr.Pn.middleTier))})))(e)));var BW=n(352267);const jW=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:n,authenticationService:i,loggerFactory:a,coreSettings:o}=t,r=WW(o),s=VW(o,r)||"",l=HW(o,r)||"",d=(0,BW.x)(i),{ItemUploadService:c,ItemDeleteService:u,ItemDetailsService:m}=yield IU(n),g=a.newLogger(e);switch(e){case Tx.ItemUploadService:return new c(d,r,s,l,g);case Tx.ItemDeleteService:return new u(d,r,g);case Tx.ItemDetailsService:return new m(d,r,g,o);default:return}})),WW=e=>!!e.get(K.J.Files).preferGraphOverVroom,VW=(e,t)=>t?e.get(K.J.Files).graphEndpointBaseUrl:e.get(K.J.Files).vroomEndpointBaseUrl,HW=(e,t)=>t?e.get(K.J.Files).graphAuthScope:e.get(K.J.Files).vroomAuthScope,$W=e=>()=>e.userServicesCache(Tx.ItemUploadService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield jW(Tx.ItemUploadService,e)})))(e))),zW=e=>()=>e.userServicesCache(Tx.ItemDeleteService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield jW(Tx.ItemDeleteService,e)})))(e))),GW=e=>()=>e.userServicesCache(Tx.ItemDetailsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield jW(Tx.ItemDetailsService,e)})))(e))),qW=e=>()=>e.userServicesCache(Tx.DriveItemShareService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{DriveItemShareService:n}=yield lU(t),{authenticationService:i,coreSettings:a}=e,o=WW(a);return new n((0,BW.x)(i),o)})))(e))),QW=(e,t)=>()=>e.userServicesCache(Tx.VideoFileService,(()=>((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{coreSettings:n,loggerFactory:i,send:a,scenarioFactory:o}=e,{VideoFileService:r}=yield lU(o);return new r(a,i,n,yield t())})))(e,t))),JW=e=>()=>e.userServicesCache(Tx.FilesValidDomainsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n,loggerFactory:i}=e,{FilesValidDomainsService:a}=yield mL(n);return new a(t,i)})))(e))),YW=e=>()=>e.userServicesCache(Tx.CalendarService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r,platformService:s,i18n:l}=e,{CalendarService:d}=yield Jx(t);return new d(n,i,o,a,r,s,l)})))(e))),KW=e=>()=>e.userServicesCache(Tx.ExternalCalendarEmailAddressService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,endpointsManager:n}=e,{ExternalCalendarEmailAddressService:i}=yield uL(t);return new i(n)})))(e))),ZW=e=>()=>e.userServicesCache(Tx.TeamCalendarService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,coreSettings:a,discover:o,loggerFactory:r,platformService:s,i18n:l}=e,{TeamCalendarService:d}=yield Jx(t);return new d(n,i,o,a,r,s,l)})))(e))),XW=e=>()=>e.userServicesCache(Tx.SubstrateMeetingRecommendationsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,send:n,authenticationService:i,loggerFactory:a}=e,{SubstrateMeetingRecommendationsService:o}=yield oU(t);return new o(n,i,a)})))(e))),eV=e=>()=>e.userServicesCache(Tx.CommonSubstrateService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,platformService:i,authenticationService:a,endpointsManager:o,windowProvider:r,coreSettings:s}=e,{CommonSubstrateService:l}=yield aU(t);return new l(r,n,a,i,s,o)})))(e))),tV=e=>()=>e.userServicesCache(Tx.SignalsService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{authenticationService:t,config:n,coreSettings:i,scenarioFactory:a,send:o}=e;if(!n)throw new Error("config not set on IUserServicesFactoryContext");const{SignalsService:r}=yield cU(a);return new r(t,i,o,n)})))(e))),nV=e=>()=>e.globalServicesCache(Ix.ExampleGlobalService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=e,{ExampleService:n}=yield JL(t);return new n})))(e))),iV=e=>()=>e.globalServicesCache(Ix.GlobalCallingService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{GlobalCallingService:t}=yield Promise.all([n.e(84460),n.e(88450),n.e(43990),n.e(90799),n.e(51778),n.e(61724),n.e(58016),n.e(12724),n.e(10287),n.e(45178),n.e(75925)]).then(n.bind(n,821632));return new t(e)})))(e))),aV=e=>()=>e.userServicesCache(Tx.UnifiedConsentService,(()=>(e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{endpointsManager:t,scenarioFactory:n,authenticationService:i,cacheStorage:a,loggerFactory:o}=e,{UnifiedConsentService:r}=yield CU(n);return new r(t,i,a,o)})))(e))),oV=(e,t)=>{const{calendarServices:n,chatServices:i,fileServices:a,getAsyncMediaService:o,getBotsPlatformService:r,getCallingAppEventsService:s,getCallingBannerService:l,getCallingDialogService:d,getCallingNotificationService:c,getCollabObjectService:u,getConnectedAccountsService:m,getDiscoverSurfaceService:g,getExternalAccountsService:p,getGoogleCalendarAuthenticationService:v,getMsaAuthenticationService:h,getSharepointRestClient:f,getSmbUserIntentService:y,getTenantPrivacyProfileService:k,getThirdPartyCalendarService:S,getUserLicenseService:b}=(e=>{const t=WU(e),n=lV(e),i=VU(e),a=HU(e,n.getChatService),o=dV(e,t,n.getChatService,i),r=$U(e),s=zU(e),l=GU(e),d=qU(e),c=QU(e,s,l,r),u=JU(e,s,r),m=cV(e),g=KU(e),p=XU(e,g),v=tB(e,g),h=iB(e,g),f=aB(e),y=oB(e),k=rB(e,y),S=sB(e);return{calendarServices:m,chatServices:n,fileServices:o,getAsyncMediaService:t,getBotsPlatformService:a,getCallingAppEventsService:g,getCallingBannerService:p,getCallingDialogService:v,getCallingNotificationService:h,getCollabObjectService:lB(e),getConnectedAccountsService:r,getDiscoverSurfaceService:f,getExternalAccountsService:c,getGoogleCalendarAuthenticationService:s,getMsaAuthenticationService:d,getSharepointRestClient:i,getSmbUserIntentService:k,getTenantPrivacyProfileService:S,getThirdPartyCalendarService:u,getUserLicenseService:y}})(e),C={getCallingAppEventsService:s,getCallingBannerService:l,getCallingDialogService:d,getCallingNotificationService:c,getTenantPrivacyProfileService:k},w=((e,t,n)=>i=>n.getGlobalCallingService().then((n=>n.initAccount(i,e,t).then((t=>Object.assign(Object.assign({},t),{dispose:(t,i)=>n.disposeAccount(t,i,e.authenticationUser)}))))))(e,C,t),N=((e,t,n)=>()=>n.getGlobalCallingService().then((n=>n.deprecated_onAccountInitialized(e,t).then((t=>Object.assign(Object.assign({},t),{dispose:(t,i)=>n.disposeAccount(t,i,e.authenticationUser)}))))))(e,C,t);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i),{getAiInsightsFeedbackService:dB(e),getAiInsightsSdsService:cB(e),getAppBasedLinkService:uB(e,r),getAppsPlatformService:mB(e),getAppSuggestionsService:gB(e),getAsyncMediaService:o,getAzureMapsService:pB(e),getBadgeCountService:vB(e),getBotsPlatformService:r,getBrbService:hB(e),getBreakoutRoomsService:fB(e),getBreakoutRoomsHelper:yB(e,w),getAtpSafelinksService:kB(e),getBroadcastAttendeeService:SB(e),getBroadcastStreamingAttendeeService:bB(e),getBroadcastCaptionsService:CB(e),getBroadcastSignalRService:wB(e)}),n),{getCallBlockingService:(T=e,()=>T.userServicesCache(Tx.CallBlockingService,(()=>IB(T)))),getCallingAnonymousDisplayNameService:_B(e),getCallingAppEventsService:s,getCallingBannerService:l,getCallingDialogService:d,getCallingNotificationService:c,getCallingService:w,deprecated_getCallingServiceOnInitialized:N,getCmdMeetingIntelligenceService:DB(e),getCollabObjectService:u,getMeetingCatchupService:FB(e),getConnectedAccountsService:m,getConnectedCalendarSettingsService:MB(e),getBiometricEnrollmentService:RB(e),getBiometricFaceEnrollmentService:PB(e),getDeveloperSwitchersService:OB(e),getDistributionListService:xB(e),getDynamicsMarketingService:LB(e),getDynamicsVirtualEventsService:UB(e),getEmoticonService:BB(e,i.getChatService),getEspService:jB(e),getExampleService:WB(e),getExternalAccountsService:p,getExternalAccountsResponseService:VB(e,m)}),a),{getFluidService:HB(e),getGalleryService:$B(e),getGiphyService:zB(e),getGoogleCalendarAuthenticationService:v,getGoogleContactsAuthenticationService:GU(e),getGuardiansService:GB(e),getImageProxyService:qB(e),getImmersiveReaderService:QB(e),getImportMsaContactsService:JB(h,e),getImplicitContactsService:YB(e),getInstantAnswersService:KB(e),getInviteLinksService:ZB(e),getLiveStateBroadcastService:XB(e),getLiveStreamRenderingService:ej(e),getLmsIntegrationService:tj(e),getLockedTeamsService:nj(e),getLogsFilesService:aj(e),getLokiService:oj(e),getManageTenantService:rj(e),getMeetForWorkService:sj(e,n.getCalendarService,u),getMeetingArtifactsService:lj(e),getMeetingBotService:dj(e,n.getCalendarService,i.getChatService),getMeetingIntelligenceService:cj(e),getMeetingOptionsClientDataService:gj(e),getMeetingOptionsService:pj(e),getMeetingQuestionsAndAnswersService:vj(e),getMeetingRecapService:hj(e),getMeetingRecapSwaService:fj(e),getMeetingTemplateService:yj(e),getMeshSessionService:kj(e),getMsaAuthenticationService:h,getPaymentService:Sj(e),getPeoplePickerService:Cj(e),getPeopleService:uj(e),getPeopleTargetingService:wj(e)}),rV(e,y,b)),{getPoliciesService:Nj(e),getPresenceService:Tj(e)}),sV(e)),{getAddressService:Ej(e),getPstnService:_j(e),getSCISService:Dj(e),getSearchPrefetchService:Fj(e)}),uV(e)),{getSharepointRestClient:f,getShareService:Mj(e),getSmbUserIntentService:y,getStoreService:Rj(e),getStyleMyRoomService:Pj(e),getTenantMembershipService:Oj(e),getTenantService:xj(e),getTenantAnalyticsService:Lj(e),getTenantPrivacyProfileService:k,getTranscriptService:Uj(e),getTranscriptFeedbackService:Bj(e),getTranscriptSettingsStoreService:jj(e),getTranslateService:Wj(e),getTargetingHierarchyService:Vj(e),getThirdPartyCalendarService:S,getToastImageService:Hj(e),getTeamsAndChannelsService:zj(e),getTpnNoticeService:Gj(e),getUrlPreviewService:qj(e,a.getFilesReferenceService),getUserProfileService:Qj(e),getVirtualEventsService:Jj(e),getVoicemailService:Zj(e),getWebinarService:Xj(e),getCallRecordingService:eW(e),getUserLicenseService:b,getDiscoverSurfaceService:g,getMonetizationService:tW(e),getMRUItemService:nW(e),getDiscoverSurfaceFeedbackService:iW(e,g),getCollabCloudService:aW(e),getTFLUserService:oW(e),getSensitivityLabelPolicySettingsService:rW(e)});var T},rV=(e,t,n)=>{const i=sW(e,t,n);return{getPetrolService:i,getFloodgateService:lW(e,i),getOdsService:dW(e,t,n)}},sV=e=>({getLokiMetaPreviewService:cW(e),getOdcFilePreviewService:uW(e),getOSearchService:mW(e),getPeopleSearchService:gW(e),getSubstrateFilesSearchService:pW(e),getSubstrateRecommendationsService:vW(e),getSubstrateSearchService:hW(e),getSubstrateSuggestionsService:fW(e),getSubstrateMeetingSearchService:yW(e),getSubstrateMeetingSummarySearchService:kW(e)}),lV=e=>{const t=SW(e),n=bW(e,t),i=CW(e),a=wW(e),o=NW(e);return{getChatService:t,getChatServiceEndpointProvider:n,getConsumerGroupsService:i,getCSAService:a,getReportConcernService:TW(e),getStatefulLongPoll:o,getUnifiedConsentService:aV(e)}},dV=(e,t,n,i)=>{const a=IW(e,i),o=EW(e,i),r=AW(a,o,e);return{getFilesRedeemService:o,getFilesReferenceService:_W(r,e),getFilesSharepointUrlService:r,getFileUploadPreviewService:DW(e,t),getFileUploadService:FW(e,i),getFileDownloadManagerService:MW(e),getPersonalFileDetailsService:PW(e,n),getRefreshSiteUrlService:(s=e,()=>s.userServicesCache(Tx.RefreshSiteUrlService,(()=>OW(s)))),getCloudStorageFoldersService:LW(e),getFilesBackfillThreadPropertiesService:UW(e),getSharepointShareService:a,getItemUploadService:$W(e),getItemDeleteService:zW(e),getItemDetailsService:GW(e),getDriveItemShareService:qW(e),getVideoFileService:QW(e,i),getFilesValidDomainsService:JW(e)};var s},cV=e=>({getCalendarService:YW(e),getExternalCalendarEmailAddressService:KW(e),getTeamCalendarService:ZW(e),getMeetingRecommendationsService:XW(e)}),uV=e=>({getCommonSubstrateService:eV(e),getSignalsService:tV(e)});function mV(e){const t=(n=Object.assign({globalServicesCache:Nx},e),{getExampleGlobalService:nV(n),getGlobalCallingService:iV(n),getLogsFilesService:(i=n,()=>i.globalServicesCache(Tx.LogsFilesService,(()=>ij(i))))});var n,i;return Object.assign(Object.assign({entityType:"unknown",windowId:""},e),t)}class gV{static createGlobalDataRequestContext(e){if(gV._globalRequestContext)throw new Error("GlobalDataRequestContext is already created!");return gV._globalRequestContext=mV(e),gV._globalRequestContext}static createUserDataRequestContext(e,t){if(!gV._globalRequestContext)throw new Error("GlobalDataRequestContext has not been created!");return function(e,t,n){const i=Object.assign(Object.assign({},e),{userServicesCache:(new Cx).getOrCreateServiceInstance}),{appsRegistryService:a,appStateService:o,authenticationService:r,authenticationUser:s,authStateProvider:l,cacheStorage:d,clientPreferences:c,clientState:u,clientAccessAdminPolicyCheckService:m,commandChangeReportingService:g,coreSettings:p,discover:v,experienceChangeReportingService:h,hostCommunicationService:f,localStorage:y,loggerFactory:k,offlineCacheManager:S,platformService:b,pubsub:C,rebootService:w,scenarioFactory:N,userBiService:T,windowProvider:I,i18n:E,brbServiceManager:A,entityCommanding:_,userTrackingService:D}=e;return Object.assign(Object.assign(Object.assign({},t),{appsRegistryService:a,appStateService:o,authenticationUser:s,authenticationService:r,authStateProvider:l,cacheStorage:d,clientPreferences:c,clientState:u,clientAccessAdminPolicyCheckService:m,commandChangeReportingService:g,coreSettings:p,discover:v,entityType:"unknown",experienceChangeReportingService:h,hostCommunicationService:f,localStorage:y,loggerFactory:k,offlineCacheManager:S,platformService:b,pubsub:C,rebootService:w,scenarioFactory:N,userBiService:T,windowId:"",windowProvider:I,i18n:E,brbServiceManager:A,entityCommanding:_,userTrackingService:D}),oV(Object.assign(Object.assign({},i),{cmdApolloClient:n}),t))}(e,gV._globalRequestContext,t)}static get globalRequestContext(){return gV._globalRequestContext}}function pV(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e.config.enableEmbedDataClient)return function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{dataEvictionService:i,platformService:o,coreSettings:r,config:s}=e,{enableApolloDevtools:l}=r.get(K.J.Diagnostics),d=new eF.pS,{defaultContext:c,link:u}=yield bV(e,n,d),m=null===(a=c.leakDetectorService)||void 0===a?void 0:a.create(),g=vV(e,d,m,u,c.loggerFactory,c.scenarioFactory)({windowId:De.ew,entityType:n,viewportContext:e.windowProvider.viewportContext,name:"embed",storeType:tF.t.embed});return mF(g,"embed",Boolean(l),o,s.experienceName),new CF({pubsub:d,leakDetector:m,scenarioFactory:c.scenarioFactory,coreSettings:c.coreSettings,dataOpsTracker:t,dataEvictionService:CV(i)?i:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},g,c)}))}(e,t,n);const{enableMTMA:a}=e.coreSettings.get(K.J.Core);return a?function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:i,dataEvictionService:o}=e,r=new eF.pS,{defaultContext:s,link:l}=yield bV(e,n,r,{noCDLTerminatingLink:!0}),d=null===(a=s.leakDetectorService)||void 0===a?void 0:a.create(),c=vV(e,r,d,l,s.loggerFactory,s.scenarioFactory),{enableApolloDataEviction:u,enableViewSchema:m}=i.get(K.J.Core);let g;return m&&(g=fV(e,r,d,uM.createViewSchemaLink(e),s.loggerFactory,s.scenarioFactory)),new Sx({pubsub:r,leakDetector:d,scenarioFactory:s.scenarioFactory,coreSettings:s.coreSettings,dataOpsTracker:u?t:void 0,dataEvictionService:u&&CV(o)?o:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},c,s,g)}))}(e,t,n):function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:i,dataEvictionService:o}=e,r=new eF.pS,{defaultContext:s,link:l}=yield bV(e,n,r),d=null===(a=s.leakDetectorService)||void 0===a?void 0:a.create(),c=vV(e,r,d,l,s.loggerFactory,s.scenarioFactory),{enableApolloDataEviction:u,enableViewSchema:m}=i.get(K.J.Core);let g;return m&&(g=fV(e,r,d,uM.createViewSchemaLink(e),s.loggerFactory,s.scenarioFactory)),new bF({pubsub:r,leakDetector:d,scenarioFactory:s.scenarioFactory,coreSettings:s.coreSettings,dataOpsTracker:u?t:void 0,dataEvictionService:u&&CV(o)?o:void 0,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},c,s,g)}))}(e,t,n)}))}function vV(e,t,n,i,a,o,r,s){const{appsRegistryService:l,coreSettings:d,platformService:c,config:u,graphqlStoreStatsReporterService:m}=e;let g;g=r||yx.create(t);const{maxApolloResultCacheSize:p,enableApolloDoubleWriteFix:v}=d.get(K.J.Core),{enableApolloDevtools:h}=d.get(K.J.Diagnostics),f=null!=p?p:void 0;return({windowId:e,entityType:t,viewportContext:r,name:d,overrideLink:p,storeType:y})=>{const k=l.getRegisteredAppsTypePolicies(e),S=hV({leakDetector:n,windowId:e,entityType:t,viewportContext:r,userContextId:s},p||i,g,f,a,o,k,h,y,m,v);return mF(S,d,Boolean(h),c,u.experienceName),S}}const hV=(e,t,n,i,a,o,r,s,l,d,c)=>{const u=(0,oF.aw)({typePolicies:yM(null==r?void 0:r.typePolicies),possibleTypes:iF.g_h,dataIdFromObject:nF.X,resultCacheMaxSize:i,apolloLeakOptions:e,loggerFactory:a,scenarioFactory:o,storeType:l,graphqlStoreStatsReporterService:d,enableApolloDoubleWriteFix:c}),m=(0,oF.nl)({cache:u,link:t,resolvers:n,defaultOptions:{watchQuery:{nextFetchPolicy:kM}},apolloLeakOptions:e,loggerFactory:a,enableApolloDevtools:s,storeType:l,graphqlStoreStatsReporterService:d,enableApolloDoubleWriteFix:c});return MF(u,a,null==r?void 0:r.defaultTypeName),m};function fV(e,t,n,i,a,o){const{coreSettings:r,platformService:s,config:l,graphqlStoreStatsReporterService:d}=e,{maxApolloResultCacheSize:c,enableApolloDoubleWriteFix:u}=r.get(K.J.Core),{enableApolloDevtools:m}=r.get(K.J.Diagnostics),g=null!=c?c:void 0;return({windowId:e,entityType:t,viewportContext:r,name:c,overrideLink:p,storeType:v})=>{const h=yV({leakDetector:n,windowId:e,entityType:t,viewportContext:r},p||i,{},g,a,o,v,d,u);return mF(h,c,Boolean(m),s,l.experienceName),h}}const yV=(e,t,n,i,a,o,r,s,l)=>{const d=(0,oF.aw)({typePolicies:{},possibleTypes:aF.g,dataIdFromObject:nF.X,resultCacheMaxSize:i,apolloLeakOptions:e,loggerFactory:a,scenarioFactory:o,storeType:r,graphqlStoreStatsReporterService:s});return(0,oF.nl)({cache:d,link:t,resolvers:n,defaultOptions:{watchQuery:{nextFetchPolicy:kM}},apolloLeakOptions:e,loggerFactory:a,storeType:r,graphqlStoreStatsReporterService:s,enableApolloDoubleWriteFix:l})},kV=(e,t,n)=>{const{appsRegistryService:i,appStateService:a,cdlAppStateService:o,authenticationService:r,authenticationUser:s,cacheStorage:l,clientPreferences:d,clientState:c,clientAccessAdminPolicyCheckService:u,commandChangeReportingService:m,coreSettings:g,discover:p,dataEvictionService:v,experienceChangeReportingService:h,hostCommunicationService:f,leakDetectorService:y,localStorage:k,loggerFactory:S,offlineCacheManager:b,platformService:C,rebootService:w,scenarioFactory:N,userBiService:T,windowProvider:I,i18n:E,brbServiceManager:A,entityCommanding:_,userTrackingService:D}=e;return{appsRegistryService:i,appStateService:a,cdlAppStateService:o,authenticationService:r,authenticationUser:s,cacheStorage:l,clientPreferences:d,clientState:c,clientAccessAdminPolicyCheckService:u,commandChangeReportingService:m,coreSettings:g,discover:p,dataEvictionService:v,entityType:n,experienceChangeReportingService:h,hostCommunicationService:f,leakDetectorService:y,localStorage:k,loggerFactory:S,offlineCacheManager:b,platformService:C,pubsub:t,rebootService:w,scenarioFactory:N,userBiService:T,windowId:De.ew,windowProvider:I,i18n:E,brbServiceManager:A,entityCommanding:_,userTrackingService:D}},SV=(e,t)=>{const n=(0,rF.v)(((t,n)=>Object.assign(Object.assign({},e),n)));return sF.i.from([n,t])};function bV(e,t,n,{noCDLTerminatingLink:a}={}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{networkState:i}=e,o=(0,gE.UZ)(Me.l,i.observeIsOnline()),r=Object.assign(Object.assign({},e),{pubsub:n,send:o}),s=gV.createGlobalDataRequestContext(r),l=yield uM.createSingletonLink(Object.assign({contextValue:s,noCDLTerminatingLink:a},r));return{defaultContext:kV(e,n,t),link:l}}))}function CV(e){if(!e)return!1;const t=e;return"function"==typeof t.register&&"function"==typeof t.unregister}class wV extends Fe{constructor(){super(De.Yg.CreateDataClient,["scenarioFactory","loggerFactory","windowProvider","coreSettings","platformService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,windowProvider:i,coreSettings:a,platformService:o}=e,{enableApolloDataEviction:r,maxApolloCacheOperationCount:s}=e.coreSettings.get(K.J.Core),l=new ZD({activeOperationLimit:s});e.dataCleanupService=l,r&&(e.dataEvictionService=new XD(l,t,n,i));const d=yield pV(Object.assign(Object.assign({},e),{pulsar:this.createDataClientPulsarInstance(a,n,o)}),l,L.pyR.default);e.client=d}))}createDataClientPulsarInstance(e,t,n){const{enablePulsarTelemetry:i,logToOTLCollector:a}=e.get(K.J.Pulsar),o=new yN(gN.TEAMS_RESOLVER,{sessionId:n.host.sessionId,spanExporter:new kN,loggerFactory:t,logToOTLCollector:!!a});return i&&o.initialize(),o}}var NV=n(412506);const TV={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}}]}}]}}]},IV={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAuthenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAuthenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"Variable",name:{kind:"Name",value:"reason"}}}]}]}}]},EV={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeWindow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeWindow"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var AV,_V;function DV(e){const t=e.get(K.J.Metadata).environment;if(!t)throw new zS.G(zS.$.GET_CURRENT_CLOUD_FAILED);return t}function FV(e,t,n,a){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=!!(null===(o=null==e?void 0:e.get(K.J.Auth))||void 0===o?void 0:o.enableIntegratedAuthApp);return t.log(`getUserContext(${a})`),n(i,a)}))}!function(e){e[e.Other=1]="Other",e[e.Main=2]="Main",e[e.Flyout=3]="Flyout"}(AV||(AV={})),function(e){e.MatchingPendingIntentFound="MatchingPendingIntentFound",e.IntentOverriddenByOnBeforeAuth="IntentOverriddenByOnBeforeAuth",e.IntentOverriddenByOnAfterAuth="IntentOverriddenByOnAfterAuth"}(_V||(_V={}));function MV(e,t,n,a,o,r,s=!1){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{id:i,source:l}=o;t.report({type:GS.B.IntentExecuted,correlationId:i,context:{target:"launch-cloud",eventData:{commandSource:l,scenarioPhase:"Core"}}});try{const o=yield a.loadModule("auth");if(!(null==o?void 0:o.launchCloud))throw Error("launchCloud not implemented in auth module");yield o.launchCloud({cloud:e,correlation:{id:i,source:l},deepLink:n,isMainWindow:s,accountId:r}),t.report({type:GS.B.IntentTransferredCrossCloud,correlationId:i,context:{target:"launch-cloud",eventData:{commandSource:l,scenarioPhase:"Core"}}})}catch(e){const n=new zS.G(zS.$.LAUNCH_CLOUD_DEEPLINK_ERROR,e);throw t.report({type:GS.B.Failure,correlationId:i,context:{target:"launch-cloud",errorInfo:qS.y.DeeplinkLaunchCrossCloudError,eventData:{commandSource:l,scenarioPhase:"Core",errorCode:n.toTelemetryEntry()}}}),n}}))}function RV(e,t,n,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){n.log(`Executing Intent in windowId: ${o}`);const i=function(e,t){if(t){const n=(0,a.cloneDeep)(e.entityCommand);return n.command.stateTransition=c.su.flush,n.command.__UNSAFE_windowId=t,n}return e.entityCommand}(t,o),r=yield e(i,t.scenarioCorrelation.clientLaunchId);return n.log(`Command execution happened in windowId: ${r}`),r}))}const PV="intent-service",OV="none",xV=e=>e.activeWindows.some((e=>!e.isMainWindow));class LV{constructor(e,t,n,i,a,o,r,s,l,d){this.appsRegistryService=t,this.coreSettings=n,this.commandHandler=i,this.client=a,this.waitForRenderingContextReady=o,this.commandChangeReportingService=r,this.experienceChangeReportingService=s,this.scenarioFactory=l,this.hostComms=d,this.pendingIntentMap=new Map,this.logger=e.newLogger("IntentService"),this.observeActiveWindows(),this.hasCreatedNonMainWindow=!1}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let t,n,i;if(this.logInternal("execute: Original intent:",e),e.shouldRenderContent){i=function(e){return e.entityCommand.entity.type===u.p.flyout||e.entityCommand.command.layoutMode===c.lO.minimal?AV.Flyout:e.entityCommand.command.layoutMode===c.lO.focus?AV.Other:AV.Main}(e),yield this.cleanupActiveWindowsIfNeeded(i);const o=this.pendingIntentMap.get(i);o&&(t=o.windowId,n=_V.MatchingPendingIntentFound,this.logInternal(`execute: Replacing intent for window id: ${t} with layout type ${i}:`,e)),this.pendingIntentMap.set(i,{intent:(0,a.cloneDeep)(e),windowId:t})}this.logInternal("execute: Intent for evaluation:",e),this.commandChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:GS.B.IntentReceived,context:{target:PV,eventData:{mainEntityType:e.shouldRenderContent?e.entityCommand.entity.type:OV,mainEntityAction:e.shouldRenderContent?e.entityCommand.entity.action:OV,errorCode:n}}});const{intentExecuted:o,targetWindowId:r}=yield this.executeInternal(e,t);if(e.shouldRenderContent&&i)o?(this.logger.log("execute: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(i)):(this.pendingIntentMap.set(i,{intent:(0,a.cloneDeep)(e),windowId:r}),this.logInternal(`execute: updated window ID: ${r}: For pending intent:`,e));else if(!e.shouldRenderContent){const t=this.scenarioFactory.findScenario(ft.RG.ApplicationLaunchTime);null==t||t.stop({mainEntityType:OV,reason:"nrc_background_launch"}),this.commandChangeReportingService.report({type:GS.B.Blanked,correlationId:e.scenarioCorrelation.correlation.id,context:{target:"intent-service",eventData:{systemInitiated:!0,mainEntityType:OV}}})}this.experienceChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:bb.yU.NavigationIntentExecuted,context:{target:"intent-service",shouldRenderContent:e.shouldRenderContent}})}))}checkForPendingIntent(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){for(const[n,{intent:i,windowId:o}]of Array.from(this.pendingIntentMap)){const r=(0,a.cloneDeep)(i);if(r){this.commandChangeReportingService.report({correlationId:e.id,type:GS.B.IntentReceived,context:{target:PV,eventData:{mainEntityType:r.entityCommand.entity.type,mainEntityAction:r.entityCommand.entity.action}}}),r.entityCommand.command.visibilityState=c.fe.showWithoutFocusing,r.metadata.userContextId=t,r.entityCommand.command.correlation=e,r.scenarioCorrelation.correlation=e,this.logInternal("checkForPendingIntent: Executing pending intent:",r);const{intentExecuted:i}=yield this.executeInternal(r,o,!0);i&&(this.logger.log("checkForPendingIntent: Intent was not overriden and executed. Removing from state."),this.pendingIntentMap.delete(n))}}}))}switchAccount(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.logger.log("switchAccount"),this.execute({shouldRenderContent:!0,scenarioCorrelation:t,entityCommand:ZS({entity:n,command:{visibilityState:c.fe.show,stateTransition:c.su.forceFlush,layoutMode:c.lO.standard,correlation:t.correlation}}),metadata:{allowAnonymous:!1,deepLink:e,userContextId:a}})}))}launchMainApp(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("launchMainApp"),yield this.execute({shouldRenderContent:!0,scenarioCorrelation:t,entityCommand:ZS({entity:n,command:{visibilityState:c.fe.show,stateTransition:c.su.forceFlush,layoutMode:c.lO.standard,correlation:t.correlation}}),metadata:{allowAnonymous:!1,deepLink:e}})}))}prewarmFlyout(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("prewarmFlyout"),yield this.execute({shouldRenderContent:!0,scenarioCorrelation:e,entityCommand:ZS({entity:{type:u.p.flyout,action:u.u.default},command:{visibilityState:c.fe.showWithoutFocusing,stateTransition:c.su.flush,layoutMode:c.lO.minimal,correlation:e.correlation}}),metadata:{allowAnonymous:!1,deepLink:IT.flyout}})}))}cleanupActiveWindowsIfNeeded(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{switch(e){case AV.Other:const e=this.pendingIntentMap.get(AV.Main);e&&(this.logger.log(`Closing main window with id=${e.windowId}.`),yield this.client.mutate({mutation:EV,variables:{windowId:e.windowId}}));case AV.Main:const t=this.pendingIntentMap.get(AV.Other);t&&(this.logger.log(`Closing other window with id=${t.windowId}.`),yield this.client.mutate({mutation:EV,variables:{windowId:t.windowId}}))}}catch(t){this.logger.warn(`cleanupActiveWindowsIfNeeded: Failed to remove window of type ${e}: ${t.message}`)}}))}observeActiveWindows(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.client.watchQuery({query:TV}).subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,a,o,r;if(!e.loading&&!e.errors){const{data:s}=e;if(null===(n=null===(t=this.coreSettings)||void 0===t?void 0:t.get(K.J.Core))||void 0===n?void 0:n.enableAnonymousCallerSignout)if(this.hasCreatedNonMainWindow){const e=yield FV(this.coreSettings,this.logger,this.waitForRenderingContextReady);yield(a=s,o=this.client,r=(e=>{var t;return(null===(t=null==e?void 0:e.authenticationUser)||void 0===t?void 0:t.type)===XT.Ch.Anonymous})(e),(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!xV(a)&&r){const e={id:(0,BI.pW)(),source:"intent-service",scenarioName:ft.RG.AuthWebLogout};yield o.mutate({mutation:IV,variables:{reason:"AnonymousSessionEnd"},context:{correlation:e}})}})))}else this.hasCreatedNonMainWindow=xV(s);this.checkAndCleanupIfWindowRemoved(s.activeWindows.map((e=>e.id)))}}))))}))}checkAndCleanupIfWindowRemoved(e){for(const[t,{intent:n,windowId:i}]of Array.from(this.pendingIntentMap))i&&!e.find((e=>e===i))&&(this.logInternal(`checkAndCleanupIfWindowRemoved: window id: ${i} no longer exists, removing intent:`,n),this.pendingIntentMap.delete(t))}executeInternal(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let o,r=this.commandHandler;this.logInternal(`executeInternal: windowId: ${t}: Original intent:`,e),this.commandChangeReportingService.report({type:GS.B.OnBeforeIntentAuthenticatedStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:PV}});const{intentOverridenByHook:s,targetWindowId:l,errorCode:d,targetCloud:c,targetUserContextId:m}=yield this.evaluateHook("onBeforeIntentAuthenticated",{intent:(0,a.cloneDeep)(e),context:{client:this.client,coreSettings:this.coreSettings,scenarioFactory:this.scenarioFactory}},r,t);if(o=d,this.commandChangeReportingService.report({type:GS.B.OnBeforeIntentAuthenticatedCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:PV,eventData:{errorCode:d}}}),s)return this.logger.log("executeInternal: Intent overriden by onBeforeIntentAuthenticated."),c?(this.logger.log("executeInternal: overridden to target cloud. LaunchCloud and return early."),yield MV(c,this.commandChangeReportingService,e.metadata.deepLink,this.hostComms,e.scenarioCorrelation.correlation,e.metadata.userContextId),{intentExecuted:!0,targetWindowId:l}):{intentExecuted:!1,targetWindowId:l};if(e.metadata.userContextId!==m&&(this.logger.log("executeInternal: userContextId overriden by onBeforeIntentAuthenticated."),e.metadata.userContextId=m),!e.shouldRenderContent&&!e.metadata.userContextId)return this.logger.log("executeInternal: userContextId is still undefined. Returning early."),{intentExecuted:!1,targetWindowId:l};let g,p;this.commandChangeReportingService.report({type:GS.B.WaitForUserContextStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:PV}});try{g=yield FV(this.coreSettings,this.logger,this.waitForRenderingContextReady,e.metadata.userContextId)}catch(n){return{intentExecuted:!0,targetWindowId:yield this.logAndGoToErrorPage({error:new zS.G(zS.$.CREATE_USER_CONTEXT_FAILED_GENERIC,n,e.metadata.userContextId),errorInfo:qS.y.CreateUserContextError,errorMessage:`getUserContext(${e.metadata.userContextId}) failed, executing original intent ${n}.`,fallbackError:new zS.G(zS.$.CREATE_USER_CONTEXT_FAILED_GENERIC,void 0,e.metadata.userContextId),intent:e,newCommandType:GS.B.Failure,windowId:t})}}if(this.commandChangeReportingService.report({type:GS.B.WaitForUserContextCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:PV}}),null==g?void 0:g.authenticationUser){const n=g;r=(e,t)=>kC(Object.assign(Object.assign({},n),{entityCommandInput:e,clientLaunchId:t})),this.commandChangeReportingService.report({type:GS.B.OnAfterIntentAuthenticatedStarted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:PV}});const{intentOverridenByHook:i,targetWindowId:s,errorCode:l}=yield this.evaluateHook("onAfterIntentAuthenticated",{intent:(0,a.cloneDeep)(e),context:{authenticatedUser:g.authenticationUser,client:g.client,localStorage:g.localStorage,coreSettings:this.coreSettings,experienceChangeReportingService:g.experienceChangeReportingService}},r,t);if(this.commandChangeReportingService.report({type:GS.B.OnAfterIntentAuthenticatedCompleted,correlationId:e.scenarioCorrelation.correlation.id,context:{target:PV,eventData:{errorCode:l}}}),l&&(o=l),i)return this.logger.log("executeInternal: Intent overriden by onAfterIntentAuthenticated."),{intentExecuted:!1,targetWindowId:s}}else this.logger.log(`executeInternal: user context / authentication user is not defined for userContextId: ${e.metadata.userContextId}  - skip execution of onAfterIntentAuthenticated`);return this.logInternal(`executeInternal: windowId: ${t}: Executing original intent:`,e),this.commandChangeReportingService.report({correlationId:e.scenarioCorrelation.correlation.id,type:GS.B.IntentExecuted,context:{target:PV,eventData:{mainEntityType:e.shouldRenderContent?e.entityCommand.entity.type:OV,mainEntityAction:e.shouldRenderContent?e.entityCommand.entity.action:OV,errorCode:o}}}),e.shouldRenderContent&&(!function(e,t,n,a,o,r){var s,l;(0,i.__awaiter)(this,void 0,void 0,(function*(){o&&n.entityCommand.entity.type===u.p.default&&(a.log("checkForPendingIntent: Translating default entity to a real entity"),n.entityCommand.entity=null!==(l=e.getDefaultCommand(null!==(s=null==r?void 0:r.coreSettings)&&void 0!==s?s:t))&&void 0!==l?l:n.entityCommand.entity)}))}(this.appsRegistryService,this.coreSettings,e,this.logger,n,g),p=yield RV(r,e,this.logger,t)),{intentExecuted:!0,targetWindowId:p}}))}evaluateHook(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o;this.logger.log(`evaluateHook(${e}): windowId: ${a}: Begin evaluation`);let r=!1;for(const s of function(e,t,n){const i=[];for(const a of e.registeredApps){const e=a[t];if(e)for(const t of Array.from(e.filter))"*"!==t&&t!==n||i.push(a)}return i}(this.appsRegistryService,e,t.intent.shouldRenderContent?t.intent.entityCommand.entity.type:void 0)){this.logger.log(`evaluateHook(${e}) - Matching app found: ${s.manifest.id}`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:GS.B.IntentHookStarted,context:{target:PV,eventData:{matchingApp:s.manifest.id}}});try{const n=yield this.evaluateHookForApp(s,e,t);r=n.intentOverridenByHook,i=n.intent,o=r?"onBeforeIntentAuthenticated"===e?_V.IntentOverriddenByOnBeforeAuth:_V.IntentOverriddenByOnAfterAuth:void 0}catch(n){this.logger.warn(`evaluateHook(${e}) windowId: ${a}: - Evaluating hook threw an error: ${n}. Executing error intent.`),o="onBeforeIntentAuthenticated"===e?qS.y.OnBeforeIntentAuthenticatedRejected:qS.y.OnAfterIntentAuthenticatedRejected;return{intentOverridenByHook:!0,targetWindowId:yield this.logAndGoToErrorPage({error:n,errorInfo:o,errorMessage:`evaluateHook(${e}) windowId: ${a}: - Evaluating hook threw an error: ${n}. Falling back to original intent.`,fallbackError:new zS.G(zS.$.UNKNOWN),intent:t.intent,newCommandType:GS.B.IntentHookRejected,windowId:a}),errorCode:o}}if(r){if(!i)return this.logger.warn(`evaluateHook(${e}) windowId: ${a}: - Hook overriden to undefined. Stopping further processing`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:GS.B.Failure,context:{target:PV,errorInfo:"onBeforeIntentAuthenticated"===e?qS.y.OnBeforeIntentAuthenticatedReturnedUndefined:qS.y.OnAfterIntentAuthenticatedReturnedUndefined}}),{intentOverridenByHook:!0,targetWindowId:a};if(i.metadata.cloud)return{intentOverridenByHook:r,targetWindowId:void 0,targetCloud:i.metadata.cloud,errorCode:o};if(t.intent.shouldRenderContent&&i.shouldRenderContent){this.logInternal(`evaluateHook(${e}), windowId: ${a}: - Executing overriden intent:`,i),this.commandChangeReportingService.report({correlationId:i.scenarioCorrelation.correlation.id,type:GS.B.IntentExecuted,context:{target:PV,eventData:{mainEntityType:i.shouldRenderContent?i.entityCommand.entity.type:OV,mainEntityAction:i.shouldRenderContent?i.entityCommand.entity.action:OV,errorCode:o}}});return{intentOverridenByHook:r,targetWindowId:yield RV(n,i,this.logger,a),errorCode:o}}}}return this.logger.log(`evaluateHook(${e}): windowId: ${a}: Completing evaluation. Intent was not overriden.`),this.commandChangeReportingService.report({correlationId:t.intent.scenarioCorrelation.correlation.id,type:GS.B.IntentHookCompleted,context:{target:PV}}),{intentOverridenByHook:!1,targetWindowId:a,errorCode:o,targetUserContextId:null==i?void 0:i.metadata.userContextId}}))}evaluateHookForApp(e,t,n){var a,o,r,s,l,d,c,u;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,m,g;switch(t){case"onBeforeIntentAuthenticated":i=yield null===(a=e.onBeforeIntentAuthenticated)||void 0===a?void 0:a.execute(n);break;case"onAfterIntentAuthenticated":i=yield null===(o=e.onAfterIntentAuthenticated)||void 0===o?void 0:o.execute(n);break;default:{const e=`evaluateHook(${t}): Unknown hook and options.`;throw null===(s=(r=this.logger).errorToTelemetry)||void 0===s||s.call(r,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}}if(!i){const e=`evaluateHook(${t}): Undefined app hook response.`;throw null===(d=(l=this.logger).errorToTelemetry)||void 0===d||d.call(l,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}switch(i.overrideType){case pv.NoOverride:g=!1,m=n.intent;break;case pv.OverrideCloud:g=!0,m=Object.assign(Object.assign({},n.intent),{metadata:Object.assign(Object.assign({},n.intent.metadata),{cloud:i.cloud})});break;case pv.OverrideIntent:g=!0,m=i.intent;break;case pv.OverrideUserContext:g=!1,m=Object.assign(Object.assign({},n.intent),{metadata:Object.assign(Object.assign({},n.intent.metadata),{userContextId:i.userContextId})});break;case pv.TerminateNavigation:g=!0,m=void 0;break;default:const e=`evaluateHook(${t}): Invalid app hook override type.`;throw null===(u=(c=this.logger).errorToTelemetry)||void 0===u||u.call(c,e,"webclient_framework_foundation_core_services_intent",void 0,!0),new Error(e)}if(this.commandChangeReportingService.report({correlationId:n.intent.scenarioCorrelation.correlation.id,type:GS.B.IntentHookResolved,context:{target:PV}}),m&&n.intent.shouldRenderContent!==m.shouldRenderContent)throw new zS.G(zS.$.INVALID_INTENT_OVERRIDE);return{intentOverridenByHook:g,intent:m}}))}logInternal(e,t){this.logger.log(`${e} {${t.shouldRenderContent?`${t.entityCommand.entity.type}, ${t.entityCommand.entity.action}, ${t.entityCommand.command.layoutMode}, ${t.entityCommand.command.visibilityState}}`:"nrc"}`)}logAndGoToErrorPage({error:e,errorInfo:t,errorMessage:n,fallbackError:a,intent:o,newCommandType:r,windowId:s}){var l,d;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(null===(d=(l=this.logger).errorToTelemetry)||void 0===d||d.call(l,n,"webclient_framework_foundation_core_services_intent"),this.commandChangeReportingService.report({type:r,correlationId:o.scenarioCorrelation.correlation.id,context:{target:PV,errorInfo:t,eventData:{errors:e instanceof Ae.G&&Ae.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():`${e}`}}}),o.shouldRenderContent)return function(e,t,n,a,o,r){var s;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;try{if(!(n instanceof Ae.G))throw n;i=n.serialize()}catch(e){null===(s=t.errorToTelemetry)||void 0===s||s.call(t,`Failed to serialize error: ${e}`,"webclient_framework_foundation_core_services_intent"),i=null==r?void 0:r.serialize()}const l=Object.assign(Object.assign({},a),{entityCommand:{entity:{type:u.p.error,action:u.u.view},entityOptions:{serializedError:i},command:Object.assign(Object.assign({},a.entityCommand.command),{layoutMode:c.lO.focus})}});return RV(e,l,t,o)}))}(this.commandHandler,this.logger,e,o,s,a)}))}}class UV{constructor(e,t,n,i,a,o,r,s,l,d,c,u,m,g,p){this._client=i,this._host=o,this._appsRegistryService=r,this._config=s,this._correlation=l,this._scenarioFactory=d,this._userBiService=c,this._commandChangeReportingService=u,this._hostComms=m,this._localStorage=g,this._experienceChangeReportingService=p,this._logger=e.newLogger("DeepLinkService"),this._intentService=new LV(e,this._appsRegistryService,t,n,this._client,a,this._commandChangeReportingService,this._experienceChangeReportingService,this._scenarioFactory,this._hostComms),this._loggerFactory=e,this._coreSettings=t}init(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this._host.addEventListener("hashchange",(()=>{const e=function(e,t,n){return{clientLaunchId:GT({location:e,clientLaunchId:n}),correlation:HT(e,t),deeplinkId:qT(e,"deeplinkId")}}(this._host.location,Ot.D.ExternalCommand);return this._handleUrl(!1,e)})),this._handleUrl(!0,{clientLaunchId:GT({location:this._host.location}),correlation:Object.assign({scenarioName:ft.RG.ClientStart},this._correlation),deeplinkId:qT(this._host.location,"deeplinkId")})}))}executeFromUrlAsync(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this._isValidDeepLinkUrl(e))return!1;const s=new URL(e);try{const l={correlation:(null==t?void 0:t.correlation)?JS(t.correlation):HT(s,Ot.D.InternalDeeplink),clientLaunchId:a};a&&this.sendDeeplinkReceivedSignal(l,n);const d=DV(this._coreSettings),c=yield function(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){}))}();if(c&&c!==d)return yield MV(c,this._commandChangeReportingService,e,this._hostComms,l.correlation,o),!0;const{terminateDeeplink:u,intent:m}=yield this._getNavigationIntentAsync(s,!0,l,t,o,r);return u?(this.stopNavigationScenarios(l,GS.B.Incomplete,qS.y.DeeplinkExecutionTerminated),!0):m?(yield this._intentService.execute(m),!0):(this.stopNavigationScenarios(l,GS.B.Incomplete,qS.y.DeeplinkIntentParseFailure),!1)}catch(t){const n=`DeepLink:: ${Ub.ToNavigationIntentFailed} ${e} ${(0,Ci.u4)(t)}`;throw new Error(n)}}))}checkForPendingIntent(e,t,n){const i=JS({source:e,scenarioName:ft.RG.NavigationCommand});return t&&this.sendDeeplinkReceivedSignal({clientLaunchId:t,correlation:i},{type:"pendingIntent"}),this._intentService.checkForPendingIntent(i,n)}launchMainApp(e,t,n){const i={correlation:JS(Object.assign({scenarioName:ft.RG.NavigationCommand},e)),clientLaunchId:GT({clientLaunchId:t})};i.clientLaunchId&&this.sendDeeplinkReceivedSignal(i,{type:"default"});const a=null!=n?n:{type:u.p.default,action:u.u.default};return this._intentService.launchMainApp(zT(a),i,a)}switchAccount(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i={correlation:JS(Object.assign({scenarioName:ft.RG.NavigationCommand},e)),clientLaunchId:GT({clientLaunchId:n})};i.clientLaunchId&&this.sendDeeplinkReceivedSignal(i,{type:"switchAccount"});const r=null!=a?a:{type:u.p.default,action:u.u.default};return o&&o!==DV(this._coreSettings)?MV(o,this._commandChangeReportingService,zT(r),this._hostComms,i.correlation,t,!0):this._intentService.switchAccount(zT(r),i,r,t)}))}prewarmFlyout(e){const t={correlation:JS({source:e,scenarioName:ft.RG.NavigationCommand}),clientLaunchId:GT({location:this._host.location})};return this.sendDeeplinkReceivedSignal(t,{type:"flyout"}),this._intentService.prewarmFlyout(t)}executeIntent(e){const t={correlation:JS(Object.assign(Object.assign({},e.entityCommand.command.correlation),{scenarioName:ft.RG.NavigationCommand})),clientLaunchId:GT({})};return this.sendDeeplinkReceivedSignal(t,{type:`${e.entityCommand.entity.type}/${e.entityCommand.entity.action}`}),this._intentService.execute(Object.assign(Object.assign({},e),{entityCommand:Object.assign(Object.assign({},e.entityCommand),{command:Object.assign(Object.assign({},e.entityCommand.command),{correlation:t.correlation})}),metadata:Object.assign(Object.assign({},e.metadata),{deepLink:zT(e.entityCommand.entity)}),scenarioCorrelation:t,shouldRenderContent:!0}))}_handleUrl(e,t){var n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(this._lastDesktopClientId&&this._lastDesktopClientId===t.clientLaunchId)return void(null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,"Navigation received with duplicate clientId. Terminating flow.","webclient_framework_foundation_core_services_deeplink",void 0,!0));this._lastDesktopClientId=t.clientLaunchId;const i=this._host.location;t.correlation.scenarioName&&t.clientLaunchId&&this.sendDeeplinkReceivedSignal(t);const{terminateDeeplink:o,intent:r}=yield this._getNavigationIntentAsync(i,!1,t);let s=r;return o?(yield this._notifyIntentHandled(),void this.stopNavigationScenarios(t,GS.B.Incomplete,qS.y.DeeplinkExecutionTerminated)):(!s&&this._config.shouldExecuteDefaultCommand&&(s=LT(t,void 0,IT.default,QT(),c.lO.standard)),s?(yield this._notifyIntentHandled(),e&&this._experienceChangeReportingService.report({correlationId:t.correlation.id,type:bb.yU.InitialDeeplinkResolved,context:{target:"deeplink-service-handle-url",shouldRenderContent:s.shouldRenderContent}}),this._intentService.execute(s)):void this.stopNavigationScenarios(t,GS.B.Failure,qS.y.DeeplinkIntentParseFailure))}))}_isValidDeepLinkUrl(e){var t,n;try{return(0,_T.H)(e,this._coreSettings)}catch(e){const i=`DeepLink:: ${Ub.InvalidDeepLinkUrl}::${null==e?void 0:e.name}`;return null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,i,"webclient_framework_foundation_core_services_deeplink",void 0,!0),!1}}_notifyIntentHandled(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this._hostComms.loadModule("core");yield null===(e=null==t?void 0:t.intentHandled)||void 0===e?void 0:e.call(t)}catch(e){this._logger.warn("Failed to notify host that intent was handled")}}))}_getNavigationIntentAsync(e,t,n,a,o,r){var s,l;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield VT({appsRegistryService:this._appsRegistryService,coreSettings:this._coreSettings,hostCommunicationService:this._hostComms,location:e,scenarioCorrelation:n,loggerFactory:this._loggerFactory,userBiService:this._userBiService,isInternalDeeplink:t,commandChangeReportingService:this._commandChangeReportingService,intentPersistenceService:new NV.I(this._localStorage),userContextId:o,client:this._client,preferredCommandInput:a,sourceViewEntity:r,scenarioFactory:this._scenarioFactory})}catch(e){null===(l=(s=this._logger).errorToTelemetry)||void 0===l||l.call(s,`DeepLink:: ${Ub.ToNavigationIntentFailed}`,"webclient_framework_foundation_core_services_deeplink",void 0,!0)}return{terminateDeeplink:!1}}))}sendDeeplinkReceivedSignal({clientLaunchId:e,correlation:t,deeplinkId:n},i){this._commandChangeReportingService.report({type:GS.B.NavigationCommandStart,correlationId:t.id,context:{target:"deeplink-service",clientLaunchId:e,correlation:t,eventData:Object.assign({deeplinkId:n,commandSource:t.source,scenarioPhase:"Core"},i)}})}stopNavigationScenarios(e,t,n){this._logger.warn("Navigation intent not found");const i=this._scenarioFactory.findScenario(ft.RG.ApplicationLaunchTime);null==i||i.fail({errorCode:n}),this._commandChangeReportingService.report({type:t,correlationId:e.correlation.id,context:{target:"deeplink-service-handle-url",errorInfo:n}})}}class BV extends Fe{constructor(){super(De.Yg.CreateDeeplinkService,["appsRegistryService","client","commandChangeReportingService","commandHandler","config","coreSettings","correlation","experienceChangeReportingService","hostCommunicationService","localStorage","loggerFactory","scenarioFactory","userBiService","waitForRenderingContextReady","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,commandHandler:a,config:o,coreSettings:r,correlation:s,experienceChangeReportingService:l,hostCommunicationService:d,localStorage:c,loggerFactory:u,scenarioFactory:m,userBiService:g,waitForRenderingContextReady:p,windowProvider:v}=e;e.deeplinkService=new UV(u,r,a,n,p,v,t,o,s,m,g,i,d,c,l)}))}}const jV="default";class WV extends Fe{constructor(){super(De.Yg.CreateDefaultCacheStorageAndCacheManagers,["config","loggerFactory","windowProvider","coreSettings","scenarioFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,config:n,loggerFactory:i,coreSettings:a,scenarioFactory:o}=e,r=new TE.E(t.caches,jV,jV,n.experienceName);e.cacheStorage=r,e.offlineCacheManager=new IE.G(r,i);(0,BA.Q6)(a)&&(e.workerCacheManager=(0,PA.L)(n.experienceName,i.newLogger("CreateDefaultCacheStorageAndCacheManagersTask"),o))}))}}const VV="tmp";class HV{constructor(e,t,n,i,a){this.tid=e,this.oid=t,this.experienceName=n,this.windowProvider=i,this.logger=a.newLogger("LocalStorageService")}set(e,t,n=NT.f.UserAndExperience){const i=this.getFormatKey(e,n);return this.windowProvider.localStorage.setItem(i,t)}setSafe(e,t,n=NT.f.UserAndExperience){var i,a;try{return this.set(e,t,n),!0}catch(t){return null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,`Failed to set key '${e}'`,"webclient_framework_localstorage_setsafe",{errorCode:null==t?void 0:t.name},!0),!1}}get(e,t=NT.f.UserAndExperience){const n=this.getFormatKey(e,t);return this.windowProvider.localStorage.getItem(n)}remove(e,t=NT.f.UserAndExperience){const n=this.getFormatKey(e,t);return this.windowProvider.localStorage.removeItem(n)}clear(e){if(e){const t=e.map((e=>this.getFormatKey("",e)));Object.keys(this.windowProvider.localStorage).filter((e=>e.startsWith(VV)&&t.some((t=>e.startsWith(t))))).forEach((e=>this.windowProvider.localStorage.removeItem(e)))}else this.windowProvider.localStorage.clear()}getFormatKey(e,t){switch(t){case NT.f.Experience:return`tmp.${this.experienceName}.${e}`;case NT.f.User:return`tmp.${this.tid}.${this.oid}.${e}`;case NT.f.Global:return`tmp.${e}`;case NT.f.UserAndExperience:default:return`tmp.${this.tid}.${this.oid}.${this.experienceName}.${e}`}}}const $V="default";class zV extends Fe{constructor(){super(De.Yg.CreateDefaultLocalStorage,["config","loggerFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,config:i}=e,a=new HV($V,$V,i.experienceName,t,n);e.localStorage=a}))}}class GV extends Fe{constructor(){super(De.Yg.CreateDiscovery,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{onDiscoverSuccess:t,onDiscoverFail:n}=this.getDiscoverCallback(e),{authenticationService:i,loggerFactory:a,coreSettings:o,scenarioFactory:r,appStateService:s,networkState:l,authStateProvider:d,i18n:c}=e,u=(0,gE.Gg)(s);e.discover=mE(i,a,Me.l,o,r,u,l,c,d,void 0,t,n,void 0,void 0)}))}getDiscoverCallback(e){var t;let n,i;return(null===(t=e.platformService)||void 0===t?void 0:t.config.hostingParent)===Ye.GJ.Outlook&&(n=()=>{e.windowProvider.sessionStorage.removeItem(LI.v4),e.windowProvider.sessionStorage.removeItem(LI.F_)},i=t=>{t||"true"!==e.windowProvider.sessionStorage.getItem(LI.F_)||(e.windowProvider.sessionStorage.setItem(LI.v4,"true"),e.windowProvider.location.reload())}),{onDiscoverSuccess:n,onDiscoverFail:i}}}var qV=n(274418),QV=n(192428);class JV{constructor(){this._endpointsHealthCache={},this._groupsHealthCache={},this.getEndpointHealth=(e,t)=>{if(e&&t){const n=this._endpointsHealthCache[this._getCacheKey(e,t)];return n?Object.assign({},n.value):void 0}},this.observeEndpointHealth=(e,t)=>e&&t?this._getHealthRecord(e,t).observable:void 0,this.observeAggregatedHealth=e=>e?this._getHealthRecord(e,void 0).observable:void 0,this.dumpState=()=>JSON.stringify(Object.assign(Object.assign({},this._endpointsHealthCache),this._groupsHealthCache),((e,t)=>t instanceof QV.x?t.value:t)),this.updateRemoteEndpointHealth=e=>{if(!e.serviceName)return;const t=this._getHealthRecord(e.serviceName,e.endpointName);t.value.isHealthy!==e.isHealthy&&(t.value.isHealthy=e.isHealthy,t.onNext(t.value))},this._getCacheKey=(e,t)=>`${e}_${t||""}`,this._getHealthRecord=(e,t)=>(t?this._endpointsHealthCache[this._getCacheKey(e,t)]:this._groupsHealthCache[this._getCacheKey(e,t)])||this._startTrackingHealth(e,t),this._startTrackingHealth=(e,t)=>{if(t){const n={serviceName:e,endpointName:t,isHealthy:void 0},i=new QV.x(n);return this._endpointsHealthCache[this._getCacheKey(e,t)]=i,i}{const n={groupName:e,isHealthy:void 0},i=new QV.x(n);return this._groupsHealthCache[this._getCacheKey(e,t)]=i,i}}}getAggregatedHealth(e){if(e){const t=this._groupsHealthCache[this._getCacheKey(e,void 0)];return t?Object.assign({},t.value):void 0}}dispose(){this._endpointsHealthCache={},this._groupsHealthCache={}}}class YV{constructor(e,t){this._endpointsManager=e,this._logger=t,this._subscriptions=[],this._aggregatedHealthMap=new Map,this._remoteEndpointsHealthCache=new JV,this.observeEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)?this._getLocalEndpointObservable(e,t):this._getRemoteEndpointHealth(e,t)?this._getRemoteEndpointObservable(e,t):this._getLocalEndpointObservable(e,t),this.getEndpointHealth=(e,t)=>this._getLocalEndpointHealth(e,t)||this._getRemoteEndpointHealth(e,t),this.observeAggregatedHealth=e=>{var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.observable},this.getAggregatedHealth=e=>this._getLocalAggregatedHealth(e)||this._getRemoteAggregatedHealth(e),this.dumpState=()=>(0,Ci.LQ)(`{ "aggregated endpoints health": [\n      ${this._printAggregatedHealth(this._aggregatedHealthMap)}\n    ],\n    "endpoints health": [\n      ${this._endpointsManager.health.dumpState()}\n    ]},\n    "remote endpoints health": ${this._remoteEndpointsHealthCache.dumpState()}`),this.getWorkerDumpState=()=>this._requestWorkerStateDumpCallback?(this._deferredWorkerStateDump=(0,si.P)(),this._requestWorkerStateDumpCallback(),this._deferredWorkerStateDump.promise):Promise.reject("Worker endpoints health snapshot can't be requested"),this.getEndpointsHealthUpdateHandler=()=>({handleEndpointHealthUpdate:this._remoteEndpointsHealthCache.updateRemoteEndpointHealth,handleStateDump:this._handleWorkerStateDumpResponse,onStateDumpRequest:this._setWorkerStateDumpRequestCallback}),this._getLocalEndpointHealth=(e,t)=>this._endpointsManager.health.getEndpointHealth(e,t),this._getLocalEndpointObservable=(e,t)=>this._endpointsManager.health.observeEndpointHealth(e,t),this._getRemoteEndpointHealth=(e,t)=>this._remoteEndpointsHealthCache.getEndpointHealth(e,t),this._getRemoteEndpointObservable=(e,t)=>this._remoteEndpointsHealthCache.observeEndpointHealth(e,t),this._updateAggregatedHealth=(e,t,n)=>{const i=e.healthSubject.value,a=[];if(i.endpoints)for(const e of i.endpoints)if(e.endpointName===t.endpointName&&e.serviceName===t.serviceName)a.push(t);else{const t=this._endpointsManager.health.getEndpointHealth(e.serviceName,e.endpointName);t&&a.push(t)}try{const t=n(a);t!==i.isHealthy&&(i.isHealthy=t,e.healthSubject.onNext(i))}catch(e){this._logger.error(`Error happened in aggregated group health policy. Group: ${i.groupName}. Error: ${JSON.stringify(e.reason||e)}`)}},this._printAggregatedHealth=e=>{let t="";return e.forEach((e=>{t=`${t},${JSON.stringify(e.healthSubject.value)}`})),t?(0,Ci.LQ)(t):""},this._handleWorkerStateDumpResponse=e=>{this._logger.log("Received worker endpoints health state dump."),this._deferredWorkerStateDump&&(this._deferredWorkerStateDump.resolve(e),this._deferredWorkerStateDump=void 0)},this._setWorkerStateDumpRequestCallback=e=>{this._requestWorkerStateDumpCallback=e}}createAggregatedHealthGroup(e,t,n){if(!e||0===e.length||!t||0===t.length)return this._logger.error(`createAggregatedHealthGroup: Group name is empty or no endpoints are provided. groupName: ${e}; endpoints: ${t&&JSON.stringify(t)}`),qV.a.InvalidArguments;if(this.getAggregatedHealth(e))return this._logger.error(`createAggregatedHealthGroup: Group name already exists. groupName: ${e}`),qV.a.GroupNameExists;const i={groupName:e,endpoints:t,isHealthy:void 0},a={healthSubject:new QV.x(i)};return this._aggregatedHealthMap.set(e,a),t.forEach((t=>{var i;const a=null===(i=this.observeEndpointHealth(t.serviceName,t.endpointName))||void 0===i?void 0:i.subscribe((t=>{const i=this._aggregatedHealthMap.get(e);i||this._logger.error(`Can't update group health. Group '${e}' is not registered`),i&&this._updateAggregatedHealth(i,t,n)}));a&&this._subscriptions.push(a)})),qV.a.Success}dispose(){var e;this._subscriptions.map((e=>e.unsubscribe())),this._subscriptions=[],this._aggregatedHealthMap.clear(),this._remoteEndpointsHealthCache.dispose(),this._requestWorkerStateDumpCallback=void 0,null===(e=this._deferredWorkerStateDump)||void 0===e||e.reject("CombinedEndpointsHealthService is disposed"),this._deferredWorkerStateDump=void 0}_getLocalAggregatedHealth(e){var t;return null===(t=this._aggregatedHealthMap.get(e))||void 0===t?void 0:t.healthSubject.value}_getRemoteAggregatedHealth(e){return this._remoteEndpointsHealthCache.getAggregatedHealth(e)}}var KV=n(838565),ZV=n(636636),XV=n(884866),eH=n(305590);class tH extends Fe{constructor(){super(De.Yg.CreateEndpointsManager,["coreSettings"])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:n,windowProvider:i,coreSettings:a}=e,{disableEndpointsHealthService:o,enableCombinedEndpointsHealthService:r}=a.get(K.J.Core);e.endpointsManager=(0,XV.F)(e,{globalContext:i,telemetryProvider:(0,ZV.YK)(i,a,n.newLogger("EPM"),null===(t=e.authenticationUser)||void 0===t?void 0:t.id),configuration:(0,eH.XF)(a.get(K.J.Core))}),o?n.newLogger("EndpointsHealthService").log("Disabled by disableEndpointsHealthService feature flag"):(e.endpointsHealthService=r?new YV(e.endpointsManager,n.newLogger("CombinedEndpointsHealthService")):new KV.V(e.endpointsManager,n.newLogger("EndpointsHealthService")),(0,DC.G)().setEndpointHealth(e.endpointsHealthService.getEndpointHealth))}))}}const nH={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CoreServicesTasksRemoveUserActiveWindowsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeUserActiveWindows"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}}}]}]}}]};class iH extends Fe{constructor(){super(De.Yg.CreateEntityCommanding,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:t,commandHandler:n,commandDelegator:a,eventHandler:o,windowProvider:r,hostCommunicationService:s,scenarioFactory:l,loggerFactory:d,deeplinkService:c,coreSettings:u}=pD("CreateEntityCommandingTask",e,"client","commandHandler","commandDelegator","eventHandler","windowProvider","hostCommunicationService","scenarioFactory","loggerFactory","deeplinkService","coreSettings"),m=e.authenticationUser?(0,li.b)(e.authenticationUser):void 0,{entityCommanding:g,eventing:p}=Rw(n,a,o,t,u,r,l,d,c,s,m);return e.entityCommanding=g,e.eventing=p,e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"signout":yield t.mutate({mutation:nH,variables:{userContextId:m}})}}))}))}}class aH extends Fe{constructor(){super(De.Yg.CreateEventHandler,["appsRegistryService","client","commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","userBiService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,client:n,commandChangeReportingService:i,coreSettings:a,loggerFactory:o,scenarioFactory:r,userBiService:s}=e;e.eventHandler=(e,l,d)=>Ob({appsRegistryService:t,client:n,commandChangeReportingService:i,commandDelegator:d,commandHandler:l,coreSettings:a,eventInput:e,loggerFactory:o,scenarioFactory:r,userBiService:s})}))}}const oH={RejectIncomingCall:Da.Yu.toastCallingRejectIncomingCall,IgnoreIncomingCall:Da.Yu.toastCallingIgnoreIncomingCall,AcceptIncomingCallContentOnly:Da.Yu.toastCallingAcceptIncomingCallContentOnly,AcceptIncomingCallThroughPrejoin:Da.Yu.toastCallingAcceptIncomingCallThroughPrejoin,AcceptIncomingCallWithAudio:Da.Yu.toastCallingAcceptIncomingCallWithAudio,AcceptIncomingCallWithVideo:Da.Yu.toastCallingAcceptIncomingCallWithVideo,AcceptIncomingScreenshareOnlyCall:Da.Yu.toastCallingAcceptIncomingScreenshareOnlyCall,Error:Da.Yu.toastCallingError,NavigateToCallTab:Da.Yu.toastCallingNavigateToCallTab,ReplyIncomingCall:Da.Yu.toastCallingReplyIncomingCall,ResumeCallTransfer:Da.Yu.toastCallingResumeCallTransfer,TimeOut:Da.Yu.toastCallingTimeOut,Unknown:Da.Yu.toastCallingUnknown,onAcceptTelemetryCleanup:Da.Yu.toastAcceptTelemetryCleanup,onDismissTelemetryCleanup:Da.Yu.toastDismissTelemetryCleanup},rH={RejectIncomingCall:Da.rA.toastRejectIncomingCall,AcceptIncomingCallContentOnly:Da.rA.toastAcceptIncomingCall,AcceptIncomingCallThroughPrejoin:Da.rA.toastAcceptIncomingCall,AcceptIncomingCallWithAudio:Da.rA.toastAcceptIncomingCall,AcceptIncomingCallWithVideo:Da.rA.toastAcceptIncomingCall,AcceptIncomingScreenshareOnlyCall:Da.rA.toastAcceptIncomingCall,ReplyIncomingCall:Da.rA.toastReplyIncomingCall,ResumeCallTransfer:Da.rA.toastResumeCallTransfer},sH=(e,t)=>{const{dataOptions:n,entity:i}=t;let a;if((null==n?void 0:n.actionType)===bo.quickReply&&e.recordPanelAction({actionGesture:Da.uS.click,actionScenario:Da.Tk.toastActivation,actionScenarioType:Da.Yu.quickReplyFromToast,moduleName:Da.rA.chatToastQuickreply}),i.action===u.u.view&&e.createDatabag&&(null==n?void 0:n.toastType)){const{toastType:t}=n;a=e.createDatabag(),a.chatToastType=t}i.action!==u.u.view||(null==n?void 0:n.actionType)&&!(null==a?void 0:a.chatToastType)||e.recordPanelAction({actionGesture:Da.uS.click,panelRegion:Da.Ai.toast,panelType:Da.wh.chatToast,actionScenario:Da.Tk.toastActivation,actionScenarioType:Da.Yu.openChatConversationFromToast,dataBag:a})},lH=(e,t)=>{const{entity:n}=t;n.action===u.u.view&&e.recordPanelAction({actionGesture:Da.uS.click,panelRegion:Da.Ai.toast,panelType:Da.wh.channelsToast,actionScenario:Da.Tk.toastActivation,actionScenarioType:Da.Yu.openChannelsConversationFromToast})},dH=(e,t)=>{const{dataOptions:n,entity:i}=t;let a;if(n&&e.createDatabag){const{toastType:t}=n;a=e.createDatabag(),a.communitiesToastType=t}i.action===u.u.view&&e.recordPanelAction({actionGesture:Da.uS.click,panelRegion:Da.Ai.toast,panelType:Da.wh.communitiesToast,actionScenario:Da.Tk.toastActivation,actionScenarioType:Da.Yu.openCommunitiesConversationFromToast,teamId:null==n?void 0:n.teamId,dataBag:a})},cH=(e,t)=>{var n;const{dataOptions:i}=t;if(!i)return;const{actionType:a,toastType:o}=i,r=oH[a],s=rH[a];let l;e.createDatabag&&(l=e.createDatabag(),l.correlationId=null===(n=t.command)||void 0===n?void 0:n.correlation.id,l.callingToastType=o),r&&e.recordPanelAction({actionGesture:Da.uS.click,panelRegion:Da.Ai.toast,panelType:Da.wh.callingToast,actionScenario:Da.Tk.toastActivation,actionScenarioType:r,moduleName:s,dataBag:l}),null==l||l.dispose()};function uH(e,t,n,a,o){const r=e.newLogger("External Command Listener"),s=mH(r,o);if(t.opener.addEventListener("executeEntityCommand",s),a.get(K.J.Core).enableHostCommandListener){const e=e=>{const{entity:t}=e,{type:n}=t;switch(n){case Wn.calls:case Wn.chats:case Wn.toasts:case Wn.extensions:case Wn.channels:case Wn.reminders:case Wn.activity:case Wn.campaignnotifications:case Wn.communities:return s(V_(e,r));case Wn.signout:return function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{yield e(Object.assign(Object.assign({},B_),{payload:{entity:{type:u.p.default,action:u.u.default},command:{visibilityState:c.fe.show,stateTransition:c.su.flush}}})),t.log("HostComms:: Executed default command"),yield e(Object.assign(Object.assign({},B_),{payload:{entity:{type:u.p.signoutdialog,action:u.u.view},command:{visibilityState:c.fe.show,stateTransition:c.su.extend}}})),t.log("HostComms:: Executed signout modal command")}catch(e){throw t.errorToTelemetry&&t.errorToTelemetry(`HostComms:: SignoutCommandFailed - ${(0,Ci.u4)(e)}`,"webclient_framework_host_comms",void 0,!0),e}}))}(s,r);default:return s(B_)}};n.loadModule("core").then((t=>{var n;t&&(null===(n=t.registerForOnExecuteCommand)||void 0===n||n.call(t,e))})).catch((e=>{var t;null===(t=r.errorToTelemetry)||void 0===t||t.call(r,`Loading core host comms module failed with: ${(0,Ci.u4)(e)}`,"webclient_framework_host_comms",void 0,!0)}))}return Promise.resolve()}const mH=(e,t)=>({payload:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=t=>{var n;return null===(n=e.errorToTelemetry)||void 0===n?void 0:n.call(e,t,"webclient_framework_foundation_external_command_listener",void 0,!0)};try{if(n&&n.entity&&n.command&&n.entity.type in u.p&&n.entity.action in u.u&&n.command.visibilityState in c.fe&&n.command.stateTransition in c.su){const{entity:a,entityOptions:o,dataOptions:r,command:s,windowOptions:l}=n,{linkedEntity:d}=a;if(d){if(!d.id||!(d.type in u.p))return i(`Missing id ${!d.id} or linked entity type ${d.type}`),Promise.reject()}else a.linkedEntity=null;s.correlation=s.correlation||{},s.correlation.source=s.correlation.source||Ot.D.ExternalCommand;const c=null==r?void 0:r.userContextId;e.debug(`got userContextId: ${c} from dataOptions`);const m=t(!1,c),g=1e4;(0,Rn.E)(m,g).catch((()=>{i(`waitForRenderingContextReady timed out after ${g}ms`)}));const p=yield m;e.debug(`got renderingContext for userContextId: ${c}`);const v={dataOptions:r,entity:a,entityOptions:o,command:XS(s),windowOptions:l};return((e,t,n)=>{if(!e)return void t.error("coreServicesEntityCommanding: UserBiService is not available.");const i={[u.p.chats]:sH,[u.p.channels]:lH,[u.p.calls]:cH,[u.p.communities]:dH}[n.entity.type];i&&i(e,n)})(p.userBiService,e,v),p.commandHandler(v)}const a=function(e){let t=`payload(${!!e})`;if(e){const{entity:n,command:i}=e;if(t+=` entity(${!!n}) command(${!!i})`,n&&i){const{type:e,action:a}=n,{visibilityState:o,stateTransition:r}=i;t+=` type(${e}) action(${a})`,t+=` visibilityState(${o}) stateTransition(${r})`}}return t}(n);return i(`Invalid payload for executeEntityCommand handler: ${a}`),Promise.reject()}catch(e){i(`Error thrown from external command listener: ${(0,Ci.u4)(e)}`)}}));class gH extends Fe{constructor(){super(De.Yg.CreateExternalCommandListener,["windowProvider","loggerFactory","hostCommunicationService","coreSettings","waitForRenderingContextReady"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,hostCommunicationService:i,coreSettings:a,waitForRenderingContextReady:o}=e;return uH(n,t,i,a,o)}))}}class pH{constructor(){this.countBasedLogs=this.initializeLogs(),this.countBasedTotalLogs=[],this.currentBuffer=0}addOperation(e,t,n){if(t&&e)if(this.countBasedLogs[t][e]){const i=this.countBasedLogs[t][e];"Request"===n?i.requestCount++:i.responseCount++}else this.countBasedLogs[t][e]={requestCount:"Request"===n?1:0,responseCount:"Response"===n?1:0,errorCount:"Error"===n?1:0}}getLatestDataAndClear(){const e=(0,a.clone)(this.countBasedLogs);return this.currentBuffer>=40&&(this.currentBuffer=0),this.countBasedTotalLogs[this.currentBuffer++]=e,this.countBasedLogs=this.initializeLogs(),e}getCompleteDataLogs(){return this.countBasedTotalLogs.length<40?this.countBasedTotalLogs:this.countBasedTotalLogs.slice(this.currentBuffer).concat(this.countBasedTotalLogs.slice(0,this.currentBuffer))}initializeLogs(){return{subscription:{},mutation:{},query:{}}}}class vH extends Fe{constructor(){super(De.Yg.CreateGraphQlOpsService,["coreSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableGraphQlOpsCount:t,enableGraphQlOpsCountInConsole:n}=e.coreSettings.get(K.J.Core);let i;if(t&&(i=new pH,e.graphqlOpsCountService=i),n){const e=window;e.hooks||(e.hooks={}),e.hooks.graphQlOpsCountServiceHook=i}}))}}var hH=n(494032);class fH{constructor(){this.stats={},this.counter=0,this.tracked={}}getTelemetry(){const e=this.stats;return this.stats={},e}trackCall(e,t){this.getOrCreateStore(e).methodCalls[t]++}trackSubscribeEvent(e){this.getOrCreateStore(e).subscribeEvents++}markReadStart(e,t){return this.mark(yH("read",e,t))}markReadEnd(e){this.markEnd(e)}markReadError(e){this.markError(e)}markDiffStart(e,t){return this.mark(yH("diff",e,t))}markDiffEnd(e){this.markEnd(e)}markDiffError(e){this.markError(e)}markWriteStart(e,t){return this.mark(yH("write",e,t))}markWriteEnd(e){return this.markEnd(e)}markWriteError(e){this.markError(e)}markDuplicateWrite(e,t,n){const i=yH("writeDuplicate",e,t);this.update("success",i,n)}mark(e){const t=""+this.counter++;return this.tracked[t]=e,t}markEnd(e){const t=this.tracked[e];if(delete this.tracked[e],t){const e=performance.now()-t.start;return this.update("success",t,e),e}return 0}markError(e){const t=this.tracked[e];if(delete this.tracked[e],t){const e=performance.now()-t.start;this.update("error",t,e)}}update(e,t,n){const i=this.getOrCreateStore(t.storeType)[t.kind];i.count++,"error"===e&&i.errors++,i.min=Math.min(null!==i.min?i.min:Number.MAX_VALUE,n),(null==i.max||i.max<n)&&(i.max=n,i.slowestOperation=t.operationName),i.mean=null!==i.mean?(i.mean+n)/2:n}getOrCreateStore(e){let t=this.stats[e];return t||(t={type:e,read:kH(),write:kH(),diff:kH(),writeDuplicate:kH(),subscribeEvents:0,methodCalls:{[tF.z.query]:0,[tF.z.watchQuery]:0,[tF.z.mutate]:0,[tF.z.subscribe]:0,[tF.z.readQuery]:0,[tF.z.writeQuery]:0,[tF.z.readFragment]:0,[tF.z.writeFragment]:0}},this.stats[e]=t),t}}function yH(e,t,n){return{storeType:t,kind:e,operationName:"string"==typeof n?n:(0,hH.Ok)(n)||"unknown",start:performance.now()}}function kH(){return{min:null,max:null,mean:null,count:0,errors:0,slowestOperation:null}}class SH extends Fe{constructor(){super(De.Yg.CreateGraphQLStoreStatsReporterService,["coreSettings","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e.loggerFactory.newLogger("CreateGraphQLStoreStatsReporterServiceTask"),{enableGraphQLStoreStatsReporterService:n}=e.coreSettings.get(K.J.Core);n&&(e.graphqlStoreStatsReporterService=new fH,t.log("GraphQLStoreStatsReporterService initialized"))}))}}var bH=n(635767);class CH extends Fe{constructor(){super(De.Yg.CreateGtmRegistry,["authenticationService","discover","coreSettings","loggerFactory","platformService","config"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.gtmRegistry=new bH.a(e.authenticationService,e.discover,e.coreSettings,e.loggerFactory,e.platformService,e.config)}))}}class wH{constructor(e,t,n,i,a){this.commandChangeReportingService=e,this.coreSettings=t,this.hostCommunicationService=n,this.scenarioFactory=i,this.logger=a.newLogger("HostCommandingListener")}init(){this.initCommandChangeReportingSubscription()}destroy(){var e;null===(e=this.commandChangeReportingSubscription)||void 0===e||e.unsubscribe(),this.commandChangeReportingSubscription=void 0}initCommandChangeReportingSubscription(){this.commandChangeReportingSubscription&&this.destroy(),this.commandChangeReportingSubscription=this.commandChangeReportingService.observeChanges().subscribe((e=>{e.type===GS.B.NotHandled&&e.context.entityCommand&&this.sendHostEvent(e.context.entityCommand)}))}sendHostEvent(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){!!this.coreSettings.get(K.J.Core).enableCommandToHostCommService&&(yield oD(e,this.hostCommunicationService,this.logger,this.scenarioFactory))}))}}class NH{constructor(){this.id=De.Yg.CreateHostCommandingListener}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,coreSettings:n,loggerFactory:i,scenarioFactory:a,hostCommunicationService:o}=pD("CreateHostCommandingListenerTask",e,"commandChangeReportingService","coreSettings","loggerFactory","scenarioFactory","hostCommunicationService");new wH(t,n,o,a,i).init()}))}}n(483295);const TH={web:{loadModule:(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return"auth"===e?(e=>({signInOnElectron:function(t){const n={options:t};return Promise.resolve(e.opener.postMessage("login",n))}}))(t):"calling"===e?(e=>({signalCallConnectionComplete:function(){return Promise.resolve(e.opener.postMessage("signalCallConnectionComplete",{}))}}))(t):"callingperf"===e?(e=>({callingPerfStatsAvailable:function(t){const n={callingPerfStats:t};return Promise.resolve(e.opener.postMessage("callingPerfStats",n))}}))(t):"core"===e?(e=>({registerForOnSubNavHoverChanged:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("showOrHideSubNav",n),()=>{e.opener.removeEventListener("showOrHideSubNav",n)}},setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))}}))(t):"embedcalendar"===e?(e=>({sendHeightOnResize:function(t){const n={embedCalendarHeight:t};return Promise.resolve(e.opener.postMessage("sendHeightOnResize",n))},sendCalendarScenarioStatus:function(t,n){const i={ScenarioStatus:t,AgendaViewEndState:n};return Promise.resolve(e.opener.postMessage("sendCalendarScenarioStatus",i))}}))(t):"search"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):"surveyform"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):void 0})),definedModules:["auth","calling","callingperf","core","embedcalendar","search","surveyform"]},edge:{loadModule:e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return"appdevicepermission"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Appdevicepermission})):"appswitcher"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Appswitcher})):"auth"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Auth})):"bluetoothproximity"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Bluetoothproximity})):"brb"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Brb})):"calling"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Calling})):"core"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Core})):"customvideobackground"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Customvideobackground})):"ecs"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Ecs})):"etw"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Etw})):"fileopenpreference"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Fileopenpreference})):"globalshortcuts"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Globalshortcuts})):"heartbeat"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Heartbeat})):"hid"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Hid})):"logscollection"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Logscollection})):"m365link"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.M365link})):"moduleloader"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Moduleloader})):"officeintegration"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Officeintegration})):"osutils"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Osutils})):"profiler"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Profiler})):"scenario"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Scenario})):"sharetarget"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Sharetarget})):"taskbar"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Taskbar})):"telemetry"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Telemetry})):"tmapolicy"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Tmapolicy})):"toasts"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Toasts})):"updates"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Updates})):"webclientstates"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Webclientstates})):"windowcontrols"===e?(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;return null===(e=globalThis.nativeModules)||void 0===e?void 0:e.Windowcontrols})):void 0})),definedModules:["appdevicepermission","appswitcher","auth","bluetoothproximity","brb","calling","core","customvideobackground","ecs","etw","fileopenpreference","globalshortcuts","heartbeat","hid","logscollection","m365link","moduleloader","officeintegration","osutils","profiler","scenario","sharetarget","taskbar","telemetry","tmapolicy","toasts","updates","webclientstates","windowcontrols"]},electron:{loadModule:(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return"appdevicepermission"===e?(e=>({registerForHasDevicePermissions:function(t){const n=(e={})=>{t(e.eventId,e.webContentsId,e.permissionType,e.guid)};return e.opener.addEventListener("hasDevicePermissions",n),()=>{e.opener.removeEventListener("hasDevicePermissions",n)}},resolveDevicePermission:function(t,n,i){const a={message:t,permission:n,guid:i};return Promise.resolve(e.opener.postMessage("hasDevicePermissionsCallback",a))}}))(t):"auth"===e?(e=>({signInOnElectron:function(t){const n={options:t};return Promise.resolve(e.opener.postMessage("login",n))}}))(t):"callingperf"===e?(e=>({callingPerfStatsAvailable:function(t){const n={callingPerfStats:t};return Promise.resolve(e.opener.postMessage("callingPerfStats",n))}}))(t):"core"===e?(e=>({registerForOnSubNavHoverChanged:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("showOrHideSubNav",n),()=>{e.opener.removeEventListener("showOrHideSubNav",n)}},setCoreInitialized:function(){return Promise.resolve(e.opener.postMessage("coreInitialized",{}))},notifyCoreStateChanged:function(t){const n={childSettings:t};return Promise.resolve(e.opener.postMessage("updateWindowState",n))}}))(t):"hostedwebcontentlog"===e?(e=>({registerForReportAProblemLogUploadEvent:function(t){const n=(e={})=>{t(e.eventId)};return e.opener.addEventListener("reportAProblemLogUpload",n),()=>{e.opener.removeEventListener("reportAProblemLogUpload",n)}}}))(t):"m365link"===e?(e=>({getM365Link:function(t,n){const i={url:t,context:n};return e.opener.requestMessage("getM365Link",i)}}))(t):"search"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):"surveyform"===e?(e=>({registerForLogActivity:function(t){const n=(e={})=>{t(e.payload)};return e.opener.addEventListener("logActivity",n),()=>{e.opener.removeEventListener("logActivity",n)}}}))(t):"windowcontrols"===e?(e=>({swapMeetingRoomFrontOfRoomWindows:function(){return Promise.resolve(e.opener.postMessage("swapMeetingRoomFrontOfRoomWindows",{}))},getScreenshots:function(t,n){const i={width:t,height:n};return e.opener.requestMessage("getScreenshots",i)}}))(t):void 0})),definedModules:["appdevicepermission","auth","callingperf","core","hostedwebcontentlog","m365link","search","surveyform","windowcontrols"]}},IH=(e,t=!1)=>new EH(TH.edge,e,void 0,t);class EH{constructor(e,t,n,i=!1){this._internalLoadDefinition=e,this._logger=t,this._host=n,this._enableScenarioCache=i,this._hostCommsScenarioFactory=AH(this._enableScenarioCache)}loadModule(e){var t,n,a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this._hostCommsScenarioFactory.newScenario("host_comms_load_module");let r;try{this._logger.log(`Loading module: ${e}`),r=yield this._internalLoadDefinition.loadModule(e,null!==(t=this._host)&&void 0!==t?t:void 0)}catch(t){throw null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,"Error while loading module","webclient_framework_host_comms",void 0,!0),null==i||i.fail({reason:"Error while loading module",message:e}),t}return!r&&(null===(o=this._internalLoadDefinition.definedModules)||void 0===o?void 0:o.includes(e))?(this._logger.error(`Failed to load module. Module, undefined ${e}`),null==i||i.fail({reason:"Failed to load module",message:e})):(this._logger.log(`Module "${e}" loaded`),null==i||i.stop({message:e})),r}))}setScenarioFactory(e){this._hostCommsScenarioFactory.setScenarioFactory(e)}}const AH=e=>{let t;const n=[];return{newScenario:i=>{if(t)return t.newScenario(i);if(e){const e=DH(i);return n.push(e),e}},setScenarioFactory:e=>{t=e,_H(n,t)}}},_H=(e,t)=>{let n=e.pop();for(;n;){const i=t.newScenario(n.name,{startTime:n.time});"failed"===n.status&&i.fail(Object.assign({cached:!0},n.result)),"stopped"===n.status&&i.stop(Object.assign({cached:!0},n.result)),n=e.pop()}},DH=e=>{let t,n;return{name:e,time:Date.now(),fail:e=>{n="failed",t=e},stop:e=>{n="stopped",t=e},get result(){return t},get status(){return n}}};class FH extends Fe{constructor(){super(De.Yg.CreateHostCommunication,["coreSettings","loggerFactory","platformService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,platformService:i,windowProvider:a}=e;e.hostCommunicationService=((e,t,n,i)=>{const{clientType:a}=e.config,o=i.newLogger("HostComms");return o.log(`Create HostComms for ${a}`),a===Ye.Bh.Maglev&&t.get(K.J.Core).enablePieCommunication?IH(o,!0):a===Ye.Bh.Desktop?new EH(TH.electron,o,n,!0):new EH(TH.web,o,n,!0)})(i,t,a,n)}))}}var MH=n(594645),RH=n(721750),PH=n(583707),OH=n(166459),xH=n(902856),LH=n(564396),UH=n(142980);function BH(e){return e.navigator.language||De.ZW}function jH(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.loadModule("osutils"),i=yield null===(t=null==n?void 0:n.getAppLocale)||void 0===t?void 0:t.call(n);return null==i?void 0:i.localeName}))}function WH(e,t,n){const i=VH(e,t,n);return(0,UH.vw)(i).locale}function VH(e,t,n,i){var a;const o=function({localeCode:e,language:t,setting:n}){if(e)return e;if(t)return t.toLowerCase();if(!n)return;let i;if(Array.isArray(n)){for(const e of n)if(e.startsWith("localeCode:")){i=e;break}}else n.startsWith("localeCode:")&&(i=n);if(i)return i.split(":")[1];return}(t.state.getSearchState()||{});if(o)return o;if(i&&(null===(a=null==e?void 0:e.navigator)||void 0===a?void 0:a.language))return e.navigator.language;const r=e.getHostedWindowContext(),s="localeCode";return r&&r.localeCode?(e.localStorage.setItem(s,r.localeCode),r.localeCode):e.localStorage.getItem(s)||n||De.ZW}const HH=()=>{};class $H{get locale(){return this._locale}get osLocaleInfo(){return this._osLocaleInfo}constructor(e,t,n,i,a,o,r,s=n.config.localeCode,l,d){this.preloadNamespaces=e,this.coreSettings=i,this.staticNamespaces=o,this.originLocale=s,this.userLanguage=l,this.osLocale=d,this.notLoadedNamespacesWithErrors=[];const c=t("i18n"),u="pseudo"===s||"pseudo_rtl"===s;let m=(0,LH.Ax)(s,a,r);const g=K.J.Core&&this.coreSettings.get(K.J.Core);g&&g.useEnglishOnlyUI&&(m="en-us");const p=this.initPlugins(t,u,m,c);this.namespaceLoader=(0,OH.v)(t),this.i18next=p,this.latestTranslation={},this.originLocale=s,this.logger=c,this.scenarioFactory=a,this.osPlatform=n.config.osPlatform,this.initOsDateTimeLocalization(i,a,n,c),this.initI18next(m,a,c),this._locale=m,this.loadLocales()}setOSLocaleInfo(e){this._osLocaleInfo=e}setLocale(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=K.J.Core&&this.coreSettings.get(K.J.Core);t&&t.useEnglishOnlyUI&&(e="en-us");const n=(0,LH.um)(this.scenarioFactory,e);this.i18next.changeLanguage(n),this._locale=n,yield this.loadLocales()}))}initPlugins(e,t,n,i){const a=[new RH.Z(e,{filterRegex:/.*\_mf$/})];if(t){const e=new PH.Z;a.push(e),n="en-us"}LH.cL.locale=n;let o=MH.Z.createInstance();for(const e of a)o=o.use(e);const r=this.getInitOptions(n,a);return o.init(r).catch((e=>i.error("The i18next initialization failed",e))),o}removeDefaultI18nNamespaces(e){var t;("string"==typeof this.i18next.options.ns?[this.i18next.options.ns]:null!==(t=this.i18next.options.ns)&&void 0!==t?t:[]).forEach((t=>this.i18next.removeResourceBundle(e,t))),this.i18next.setDefaultNamespace("")}setMissingHandlers(e,t){this.i18next.options.saveMissing=!0,this.i18next.options.missingKeyHandler=(n,i,a)=>{this.missingKeyHandler(e,t,this.i18next,n,i,a)},this.i18next.options.missingInterpolationHandler=n=>this.missingInterpolationHandler(e,t,this.latestTranslation)}initI18next(e,t,n){this.removeDefaultI18nNamespaces(e),this.setMissingHandlers(t,n)}initOsDateTimeLocalization(e,t,n,i){const a=K.J.Host&&e.get(K.J.Host),o=a&&a.enableOsDateTimeFormatting;o&&n.config.getLocaleInfoAsync().then((e=>{if(null==e?void 0:e.regionalFormat){const t="_",n="-";e.regionalFormat=e.regionalFormat.split(t).join(n).toLowerCase()}o&&this.setOSLocaleInfo(e)})).catch((e=>{var n;null===(n=i.errorToTelemetry)||void 0===n||n.call(i,`getLocaleInfoAsync failed for ${JSON.stringify(e)}`,"telemetry_i18next_wrapper");t.newScenario(ft.RG.I18nGetLocaleInfo).fail({errors:JSON.stringify(["getLocaleInfoAsync failed"])})}))}loadLocales(){const e=[];this.staticNamespaces&&this.namespaceLoader.loadStatic(this,this.staticNamespaces);for(const t of this.preloadNamespaces){const n=this.namespaceLoader.load(this,t);n.promise&&e.push(n.promise.catch(HH))}return Promise.all(e)}missingKeyHandler(e,t,n,i,a,o){const r="string"==typeof n.options.ns?[n.options.ns]:n.options.ns||[""],s=r.indexOf(a)<0;let l="",d="";if(s&&(e=>this.notLoadedNamespacesWithErrors.indexOf(e)>=0)(a))return;s?(l=`The namespace "${a}" has not been loaded. The only loaded namespaces: "${r.join(", ")}"`,d=o,this.notLoadedNamespacesWithErrors.push(a)):l=`The key "${o}" doesn't exist in namespace "${a}" for locale "${i[0]}"`;e.newScenario(ft.RG.I18nMissingKeyHandler).stop({message:l,origin:d}),t.error(l)}missingInterpolationHandler(e,t,n){var i;const a=`Undefined interpolation for namespace "${n.namespace}" and key "${n.key}"`;e.newScenario(ft.RG.I18nMissingInterpolationHandler).stop({message:a}),null===(i=t.errorToTelemetry)||void 0===i||i.call(t,a,"telemetry_i18next_wrapper")}getInitOptions(e,t){return{initImmediate:!1,interpolation:{escapeValue:!1},react:{bindI18n:"languageChanged",bindStore:"",nsMode:"default"},lng:e,fallbackLng:e,load:"currentOnly",lowerCaseLng:!0,postProcess:t.filter((e=>"postProcessor"===e.type)).map((e=>e.name))}}}class zH extends Fe{constructor(){super(De.Yg.CreateI18NextWrapper,["config","coreSettings","coreSettingsContext","hostCommunicationService","loggerFactory","platformService","routingServices","scenarioFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=function(e,t,n,i,a,o,r,s){const{windowProvider:l,routingServices:d,hostCommunicationService:c}=o,u=(0,xH.pf)(l),m=K.J.Core&&i.get(K.J.Core),g=m&&m.includeBrowserInLocaleDetermination,p=VH(l,d,u.localeCode,!!g),v=BH(l),h=c?jH(c):Promise.resolve(void 0);return new $H(e,t,n,i,a,r,s,p,v,h)}(e.config.preloadedI18nNamespaces||[],e.loggerFactory.newLogger,e.platformService,e.coreSettings,e.scenarioFactory,{windowProvider:e.windowProvider,routingServices:e.routingServices,hostCommunicationService:e.hostCommunicationService},e.config.staticNamespaces,e.config.locale);e.coreSettingsContext.setLocale(t.locale),e.i18NextWrapper=t}))}}var GH=n(356629);class qH extends Fe{constructor(){super(De.Yg.CreateI18n,["i18NextWrapper"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.i18n=new GH.o(e.i18NextWrapper)}))}}class QH{constructor(e){this.cache=new Map,this.lastId=0,this.maxCacheSize=e.maxCacheSize,this.cachePruningPercent=e.cachePruningPercent}add(e){if(this.maxCacheSize<=0)return;let t=this.cache.get(e);if(t)return void(t.time=this.lastId++);const n=new Image;n.src=e,t={image:n,time:this.lastId++},this.cache.set(e,t),this.cache.size>this.maxCacheSize&&this.prune()}setCapacity(e){this.maxCacheSize=e.maxCacheSize,this.cachePruningPercent=e.cachePruningPercent,this.cache.size>this.maxCacheSize&&this.prune()}clear(){this.cache.clear(),this.lastId=0}has(e){return this.cache.has(e)}get size(){return this.cache.size}prune(){const e=[];this.cache.forEach(((t,n)=>{e.push({time:t.time,url:n})})),e.sort(((e,t)=>e.time-t.time));let t=Math.ceil(this.maxCacheSize*this.cachePruningPercent);t=Math.max(this.cache.size-this.maxCacheSize,t);for(let n=0;n<t;n++){const t=e[n];this.cache.delete(t.url)}}}class JH extends Fe{constructor(){super(De.Yg.CreateImageCaches,["coreSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t}=e,n=new QH({maxCacheSize:0,cachePruningPercent:.15});e.avatarImageCache=n;const i=null==t?void 0:t.getObservable(K.J.ImageCache),a=null==i?void 0:i.subscribe((e=>{let t=0;"number"==typeof(null==e?void 0:e.avatarImageCacheMaxCapacity)&&(t=e.avatarImageCacheMaxCapacity),n.setCapacity({maxCacheSize:t,cachePruningPercent:.15})}));return()=>a.unsubscribe()}))}}class YH extends Fe{constructor(){super(De.Yg.CreateInactiveGC,["clientState","coreSettings","profilerService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,coreSettings:n,profilerService:a}=e;t.observe().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e===VS.pk.Inactive||e===VS.pk.LongInactive){const{clearConsoleInInactive:e,enableGCInInactive:t}=n.get(K.J.Core);e&&(console.clear(),console.log('Console cleared on going to Inactive/LongInactive. When debugging, you can override this with disabling "clearConsoleInInactive" FF')),t&&a.requestTriggerGC()}}))))}))}}class KH extends Fe{constructor(){super(De.Yg.LeakDetector,["loggerFactory","coreSettings","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,windowProvider:n,coreSettings:i}=e,a=t.newLogger("CreateLeakDetectorTask"),{enableObjectLeakDetection:o}=i.get(K.J.Core);if(a.log(`enableObjectLeakDetection ${o}`),!o)return;if(!n.WeakRef)return void a.log("windowProvider?.WeakRef is undefined");const r=new JN.E(i,n);e.leakDetectorService=r,a.log("leakDetectorService instantiated"),n.opener.addEventListener(vb.rY.GetLeaks,(()=>this.sendLeaksStats(n,r,a))),this.initTestingMode(n,r,i.get(K.J.Host))}))}sendLeaksStats(e,t,n){let i=0;const a=e.parent;a.getAndClearAriTelemetry=void 0,a.getLeakDetectorService=void 0,a.gc?(n.log("executing gc() on experience renderer"),a.gc(),i=1e4):n.warn("gc() not defined on experience renderer");let o=0;o=e.setTimeout((()=>{e.clearTimeout(o);const n={leaks:t.getReachableObjectCountsByKey(),leaksTrackingInfo:t.getReachableObjectsTrackingInfo()};e.opener.postMessage(vb.rY.GetLeaks,n)}),i)}initTestingMode(e,t,n){const{userType:i}=n;i&&i.indexOf("test")>-1&&!("getLeakDetectorService"in e.parent)&&(e.parent.getLeakDetectorService=()=>t)}}class ZH extends Fe{constructor(){super(De.Yg.CreateLocalStorage,["authenticationUser","config","coreSettings","loggerFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,config:n,windowProvider:a,loggerFactory:o}=e,r=new HV(t.profile.tenantId,t.profile.objectId,n.experienceName,a,o),s=o.newLogger("CreateLocalStorage");e.localStorage=r;const l=!e.coreSettings.get(K.J.Auth).isLegacyCleanupCodeFlag;return e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if("signout"===e&&l){const e=yield function(e,t){const n={},i=["TflFreProfileCardDisplayed"],a=["mainAppWindowActiveEntities"];try{i.forEach((t=>{const i=e.get(t,NT.f.UserAndExperience);i&&(n[t]=i)})),e.clear([NT.f.UserAndExperience,NT.f.User]),a.map((t=>e.remove(t,NT.f.Experience)))}catch(e){t.warn(`Failed to clear local storage! ${e}`)}return n}(r,s);e&&function(e,t,n){const i=Object.keys(t);try{i.forEach((n=>{e.set(n,t[n],NT.f.UserAndExperience)}))}catch(e){n.warn(`Failed to restore local storage values for ${i}: ${e}!`)}}(r,e,s)}switch(e){case"quit":case"signout":new NV.I(r).clear();break;default:return}}))}))}}function XH(){return Promise.all([n.e(70197),n.e(19335),n.e(35799),n.e(56845),n.e(61130),n.e(87568),n.e(17353),n.e(63167),n.e(11023),n.e(84733),n.e(23948),n.e(56193),n.e(21439),n.e(84591)]).then(n.bind(n,288084))}function e$(){return(0,d.mT)(XH,"nova-app-bar")}const t$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesTasksLockedTilesQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lockedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isSelected"}}]}}]}}]}}]}}]};const n$={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tileWithSelection"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LaunchTile"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isSelected"}}]}}]},i$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lockedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tilesWithSelectionStatus"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tilesWithSelectionStatus"}}]}},{kind:"Field",name:{kind:"Name",value:"mostRecentlyUsedTiles"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tilesWithSelectionStatus"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tilesWithSelectionStatus"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"TileConnection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"CoreServicesTasksUpdateNovaAppSelectionFragment_tileWithSelection"}}]}}]}}]}},...n$.definitions]}.definitions]};function a$(e,t,n){e.writeFragment({id:`LaunchTile:${t}`,fragment:n$,data:{__typename:"LaunchTile",id:t,isSelected:n}})}class o$ extends Fe{constructor(){super(De.Yg.CreateNovaAppBarUpdater,["authenticationUser","client","experienceChangeReportingService","coreSettings","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,client:n,experienceChangeReportingService:o,coreSettings:r,loggerFactory:s}=e,l=s.newLogger("NovaAppBarUpdater");let d;const c=this.subscribeToLockedTilesUpdates(n,l).then((e=>{d=e})).catch((e=>{var t;return null===(t=l.errorNoPii)||void 0===t?void 0:t.call(l,e)}));let u;if(r.get(K.J.Core).enableAppBarQueryUpdate){const e=(0,li.b)(t);u=o.observeChanges().pipe((0,rS.h)((t=>t.userContextId===e&&t.type===bb.yU.AppSelectionChanged)),(0,aS.U)((e=>e.type===bb.yU.AppSelectionChanged?e.context.appId:void 0)),(0,sI.x)()).subscribe((e=>{!function(e,t,n){try{const t=e.readQuery({query:i$});if(t){let i,o;for(const[,e]of(0,a.entries)(t))if(i||(i=e.edges.find((e=>e.node.isSelected))),o||(o=e.edges.find((e=>e.node.id===n))),i&&o)break;if((null==i?void 0:i.node.id)===(null==o?void 0:o.node.id))return;i&&a$(e,i.node.id,!1),o&&a$(e,o.node.id,!0)}}catch(e){t.error("Error thrown updating Nova AppBar selection.")}}(n.cache,l,e)}))}return()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){null==u||u.unsubscribe(),yield c,null==d||d.unsubscribe()}))}))}subscribeToLockedTilesUpdates(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{lockedTilesSubscription:n}=yield e$();return e.subscribe({query:n}).subscribe((n=>{n.data&&function(e,t,n){var a,o;(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=e.readQuery({query:t$});if(t){const{lockedTilesUpdateQuery:i}=yield e$(),o=null===(a=t.lockedTiles.edges.find((e=>e.node.isSelected)))||void 0===a?void 0:a.node.id,r=Object.assign({},n.lockedTilesUpdatedEvent.lockedTiles);for(const e of r.edges.map((e=>e.node)))e.isSelected=e.id===o;e.writeQuery({query:i,data:{lockedTiles:r}})}}catch(e){null===(o=t.errorNoPii)||void 0===o||o.call(t,e)}}))}(e,t,n.data)}))}))}}var r$,s$,l$,d$;!function(e){e.Cold="Cold",e.Warm="Warm",e.Rollback="Rollback",e.Update="Update",e.Local="Local",e.Container="Container",e.Unknown="Unknown"}(r$||(r$={})),function(e){e.SessionID="tmp.sessionId",e.DeviceID="tmp.deviceId",e.IsRelaunchFromOOPs="tmp.relaunchFromOOPs",e.PreAuthUserID="tmp.preAuthUserId"}(s$||(s$={})),function(e){e.IndexPageStart="execute-index-html-script",e.CoreModuleLoaded="exp_loader_core_module_loaded",e.NotifyDesktop="exp_loader_notified_desktop",e.ConfigLoaded="exp_loader_config_loaded",e.MainChunksLoadingStart="exp_loader_load_bundles_start",e.MainChunksLoadingStop="exp_loader_load_bundles_stop",e.IndexPageStop="exp_loader_index_stop",e.ClientStartStop="client_start_stop"}(l$||(l$={})),function(e){e.ExpLoaderFailure="ExpLoaderFailure",e.LoadBundlesFailure="LoadBundlesFailure",e.ParseIndexPageFailure="ParseIndexPageFailure",e.CoreStartTimeout="CoreStartTimeout"}(d$||(d$={}));var c$=n(389074);class u$ extends c$.s{constructor(e,t,n,i,a){super(n.navigator.userAgent),this.loggerFactory=e,this.routingServices=t,this.windowHost=n,this.hostSettings=i,this.getPlatformConfigurationOverrides=a,this.logger=this.loggerFactory.newLogger("PlatformService"),this.queryStringParameters=this.routingServices.state.getSearchState()||{},this.headConfig=(0,xH.pf)(this.windowHost,this.logger),this.cachedConfig=this.computeConfig(),this.cachedEcsOverrides=this.computeEcsOverrides()}get config(){return this.cachedConfig}get ecsOverrides(){return this.cachedEcsOverrides}get host(){var e,t;const n=null===(t=null===(e=this.windowHost.loader)||void 0===e?void 0:e.getProperties)||void 0===t?void 0:t.call(e);return Object.assign({bootType:(null==n?void 0:n.bootType)||r$.Unknown,deviceId:(null==n?void 0:n.deviceId)||sb.get("deviceId"),deviceInfo:null==n?void 0:n.deviceInfo,hostAppVersion:(0,xH.nU)(this.windowHost),sessionId:(null==n?void 0:n.sessionId)||sb.get("sessionId"),preAuthUserId:null==n?void 0:n.preAuthUserId},this.windowHost.getHostedWindowContext())}getOsOverride(){return this.windowHost.localStorage.getItem("platformOverride")}computeConfig(){var e,t,n;let i={};this.getPlatformConfigurationOverrides&&(i=this.getPlatformConfigurationOverrides(this.windowHost,this.queryStringParameters)),this.logger.log(`IPlatformConfiguration overrides: ${JSON.stringify(i)}`);const a=this.getBrowser(),o=null!==(e=i.clientType)&&void 0!==e?e:this.getClientType(this.queryStringParameters,this.windowHost),r=this.determinePlatformId(i);this.logger.log(`Determined PlatformID to be '${r}'`);const s=this.getHostingParent(),l=this.windowHost.__VERSION__,d=`${r}/${l}`,c=this.windowHost.__webpack_public_path__,u=this.getVendor(),m=this.getOSDetails();let g="https://statics.teams.cdn.office.net";try{c&&(g=new URL(c).origin)}catch(e){this.logger.warn(`Failed to parse dynamic staticsPath origin from '${c}'`)}const p=this.windowHost.navigator.language||"en-us";return this.logger.log(`PlatformService: configuring with clientVersion: ${d}`),{browser:a,browserVersion:this.getBrowserVersion(),buildType:(0,xH.Cu)(d),buildVersion:l,clientContext:this.getClientContext(s),clientType:o,clientVersion:d,currentUrl:null===(n=null===(t=this.windowHost)||void 0===t?void 0:t.location)||void 0===n?void 0:n.href,hostingParent:s,isInCypressFrame:this.getIsInCypressFrame(),isInIframe:this.getIsInIframe(),isInternalUser:this.headConfig.isInternalUser,localeCode:this.getLocaleCode(),osDetails:m,osPlatform:this.getOsPlatform(),osVersion:this.getOSPlatformVersion(),platformId:r,publicPath:c,staticsPath:g,userAgent:this.userAgent,userLanguage:p,vdi:i.vdi,vendor:u,getLocaleInfoAsync:this.windowHost.getLocaleInfoAsync}}determinePlatformId(e){var t,n,i,a,o,r,s,l,d,c,u;const m=e.platformId,g=null===(n=null===(t=this.hostSettings)||void 0===t?void 0:t.hostSettings)||void 0===n?void 0:n.platformId;if(null===(a=(i=this.logger).logNoPii)||void 0===a||a.call(i,`Potential PlatformID sources: experienceOverrides='${m}', hostSettings='${g}', qsp='${JSON.stringify(this.queryStringParameters)}', windowHostHost='${null===(o=this.windowHost)||void 0===o?void 0:o.localStorage.getItem("host")}'`),m)return null===(s=(r=this.logger).logNoPii)||void 0===s||s.call(r,"Using PlatformID value from experience overrides"),m;if(g){const e=parseInt(g,10);if(e)return null===(d=(l=this.logger).logNoPii)||void 0===d||d.call(l,"Using PlatformID value from host settings"),e}return null===(u=(c=this.logger).logNoPii)||void 0===u||u.call(c,"Using PlatformID value from QSP/WindowHost/Browser"),this.getPlatformId(this.queryStringParameters,this.windowHost)}getHostUrl(){const e=this.windowHost.localStorage.getItem("ecsHostUrl")||this.headConfig.ecsHostUrl;if(e)return new URL(e,this.windowHost.location.origin).href}computeEcsOverrides(){const e=this.getHostUrl(),t=this.getEnvironmentOverride()||(0,xH.zj)(this.windowHost,this.headConfig),n=(0,a.get)(Sb.s,t),i=this.getRingOverride(),{originalRing:o,unauthenticated:r}=this.headConfig;return Object.assign(Object.assign({hostUrl:e},this.getRingConfig(n,i)),{originalRing:o,unauthenticated:r})}getEnvironmentOverride(){if(this.queryStringParameters.webinarRing)return this.queryStringParameters.webinarRing}getLocaleCode(){const e=this.getQspLocale();if(e)return e;const t=this.windowHost.getHostedWindowContext(),n="localeCode";return t&&t.localeCode?(this.windowHost.localStorage.setItem(n,t.localeCode),t.localeCode):this.windowHost.localStorage.getItem(n)||this.headConfig.localeCode||"en-us"}getQspLocale(){if(this.queryStringParameters.localeCode)return this.queryStringParameters.localeCode;if(this.queryStringParameters.language)return this.queryStringParameters.language.toLowerCase();if(!this.queryStringParameters.setting)return;const e=this.queryStringParameters.setting;let t;if(Array.isArray(e)){for(const n of e)if(n.startsWith("localeCode:")){t=n;break}}else e.startsWith("localeCode:")&&(t=e);return t?t.split(":")[1]:void 0}getRingOverride(){if(this.headConfig.isInternalUser&&this.queryStringParameters.ring)return this.queryStringParameters.ring;const e=this.windowHost.getHostedWindowContext();if(null==e?void 0:e.ring)return e.ring;const{ring:t}=this.headConfig;return t?"string"==typeof t?t:t.id:void 0}getHostingParent(){const e=(0,xH.f2)(this.windowHost);return e&&e.dataset&&"outlook"===e.dataset.host?Ye.GJ.Outlook:Ye.GJ.Unknown}getClientContext(e){return e===Ye.GJ.Outlook?Ye.RY.Embed:void 0}getIsInIframe(){return!!this.windowHost.getHostedWindowContext().isInIframe}getIsInCypressFrame(){return!!this.windowHost.getHostedWindowContext().isInCypressFrame}}class m$ extends Fe{constructor(){super(De.Yg.CreatePlatform,["windowProvider","loggerFactory","routingServices"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,routingServices:i,hostSettings:a,getPlatformConfigurationOverrides:o}=e;e.platformService=new u$(n,i,t,a,o)}))}}var g$=n(38623);function p$(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n={workers:[],processes:[]},i=yield null==e?void 0:e.loadModule("heartbeat");if(!(null==i?void 0:i.getPerfMetrics))return n;try{if(t&&(null==i?void 0:i.getPerfMetricsAsync)){const{processes:e,workers:t}=yield i.getPerfMetricsAsync();for(const e of t)n.workers.push({targetSessionId:e.targetSessionId,type:e.type,subType:e.subType,totalSizeKB:(0,g$.kl)(e.totalSizeBytes),usedSizeKB:(0,g$.kl)(e.usedSizeBytes)});for(const t of e)n.processes.push({processId:t.processId,name:t.name,type:t.type,utilitySubType:t.utilitySubType,embeddedBrowserWebView:t.embeddedBrowserWebView,cpuCycleTime:t.cpuCycleTime,workingSetSizeKB:(0,g$.kl)(t.workingSetSizeBytes),commitSizeKB:(0,g$.kl)(t.pageFileUsageBytes)})}else{const e=yield i.getPerfMetrics();for(const t of e)n.processes.push({processId:t.processId,name:t.name,type:t.type,utilitySubType:t.utilitySubType,embeddedBrowserWebView:t.embeddedBrowserWebView,cpuCycleTime:t.cpuCycleTime,workingSetSizeKB:(0,g$.kl)(t.workingSetSizeBytes),commitSizeKB:(0,g$.kl)(t.pageFileUsageBytes)})}}catch(e){console.error("get-webview-2-metrics, getMetrics: Failed to get metrics.")}return n}))}var v$,h$,f$,y$,k$;!function(e){e.LoadModuleProfilerFailed="LoadModuleProflierFailed",e.ExecuteCommandFailed="ExecuteCommandFailed"}(v$||(v$={})),function(e){e.LoadModuleProfilerSuccess="LoadModuleProfilerSuccess",e.ExecuteCommandSuccess="ExecuteCommandSuccess"}(h$||(h$={}));class S${constructor(e,t){this.hostCommunicationService=t,this.logger=e.newLogger("ProfilerService"),this.exposeToCoreWindow()}getMemoryData(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield p$(this.hostCommunicationService,!1);return(0,g$.Mv)(e.processes)}))}getHeapSnapshot(e=!0){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.getHeapSnapshot)||void 0===t?void 0:t.call(n);return(null==i?void 0:i.snapshot)?i.snapshot:void 0}))}getMemoryTracing(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return;const n=yield null===(e=t.getMemoryTracing)||void 0===e?void 0:e.call(t,{duration:5e3});return(null==n?void 0:n.data)?n.data:void 0}))}requestTriggerGC(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getProfilerModuleAsync();if(!t)return!1;const n=yield null===(e=t.triggerGC)||void 0===e?void 0:e.call(t);return!!(null==n?void 0:n.status)}))}startMemoryTracing(e=!0){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return!1;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.startMemoryTracing)||void 0===t?void 0:t.call(n);return!!(null==i?void 0:i.status)}))}stopMemoryTracing(e=!0){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getProfilerModuleAsync();if(!n)return;e&&(yield this.requestTriggerGC());const i=yield null===(t=n.stopMemoryTracing)||void 0===t?void 0:t.call(n);return(null==i?void 0:i.data)?i.data:void 0}))}getProfilerModuleAsync(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let e;try{e=yield this.hostCommunicationService.loadModule("profiler"),this.logger.log(`Profiler:: ${h$.LoadModuleProfilerSuccess}`)}catch(e){this.logger.error(`Profiler:: ${v$.LoadModuleProfilerFailed} ${(0,Ci.u4)(e)}`)}return e}))}exposeToCoreWindow(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.hostCommunicationService.loadModule("profiler"),t=yield this.hostCommunicationService.loadModule("heartbeat");e&&t?globalThis.window.profiler=Object.assign(Object.assign({},e),{getMemoryData:()=>this.getMemoryData(),getHeapSnapshot:(e=!1)=>this.getHeapSnapshot(e),getTotalWorkingSetSizeBytes:()=>this.getWorkingSetSizeFromProcesses(null==t?void 0:t.getPerfMetrics),getTotalCommitSizeBytes:()=>this.getCommitSizeFromProcesses(null==t?void 0:t.getPerfMetrics)}):this.logger.log("HostComms is unable to load profiler and/or heartbeat module. We are running on Web or Teams 1.0. Bailing out.")}))}getWorkingSetSizeFromProcesses(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e){const t=yield e();return null==t?void 0:t.reduce(((e,t)=>(e.workingSetSizeBytes+=t.workingSetSizeBytes,e)),{workingSetSizeBytes:0}).workingSetSizeBytes}return this.logger.warn("Unable to get perf metrics."),-1}))}getCommitSizeFromProcesses(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(e){const t=yield e();return null==t?void 0:t.reduce(((e,t)=>(e.pageFileUsageBytes+=t.pageFileUsageBytes,e)),{pageFileUsageBytes:0}).pageFileUsageBytes}return this.logger.warn("Unable to get perf metrics."),-1}))}}class b$ extends Fe{constructor(){super(De.Yg.CreateProfiler,["loggerFactory","hostCommunicationService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.profilerService=new S$(e.loggerFactory,e.hostCommunicationService)}))}}!function(e){e.incomplete="incomplete",e.success="success",e.failure="failure"}(f$||(f$={})),function(e){e.LifeCycleReport="life_cycle_report"}(y$||(y$={})),function(e){e.ExperienceLifeCycleManager="experience_life_cycle_manager",e.UserLifeCycleManager="user_life_cycle_manager"}(k$||(k$={}));class C${constructor(e,t,n,i,a,o,r,s,l,d){this.loggerFactory=e,this.host=t,this.clientStateProvider=n,this.networkStateProvider=i,this.platformService=a,this.hostCommunicationService=s,this.localStorage=l,this.scenarioFactory=d,this.cleanupOnRebootArray=[],this.clientStateSubscription=null,this.expChangeSubscription=null,this.lcChangeSubscription=null,this.isRunningJobsInLongInactive=!1,this.rebootPending=void 0,this.registerCleanupCallback=e=>{this.cleanupOnRebootArray.push(e)},this.didUrlChange=e=>(0,YN.IC)(e)!==(0,YN.IC)(this.host.location.href),this.areMaxRetriesExhausted=(e,t)=>{if(null==t?void 0:t.maxRetries){const n=this.getRetryStorageKey(e),i=this.localStorage.get(n,NT.f.Experience),a=i&&parseInt(i,10)||0,o=a>=t.maxRetries;return this.logger.warn(`Max retries exhausted for '${e}', retries: ${a}, maxRetries: ${t.maxRetries}`),this.localStorage.set(n,`${a+1}`,NT.f.Experience),o}return!1},this.getRetryStorageKey=e=>`rebootRetries.${e}`,this.logger=this.loggerFactory.newLogger("rebootService"),this.expChangeSubscription=o.observeChanges().pipe((0,aS.U)((e=>{this.isExperienceIdleStateChangedEvent(e)&&(this.isRunningJobsInLongInactive=!0)}))).subscribe(),this.lcChangeSubscription=r.observeChanges().pipe((0,aS.U)((({context:e})=>{const{target:t,reportedChange:n}=e;if(this.isRunningJobsInLongInactive&&t===k$.UserLifeCycleManager&&this.isExperienceIdleStateChangedEvent(n)&&(this.isRunningJobsInLongInactive=!1,this.rebootPending)){this.host.clearTimeout(this.timeoutId),this.logger.log("Core finished running App jobs in LongInactive client state. Issuing pending reboot now...");const{reason:e,commandSource:t,options:n}=this.rebootPending;this.rebootApp(e,t,n)}}))).subscribe()}rebootApp(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(yield this.cleanupBeforeReboot(),this.logger.log(`Reboot app triggered for ${e} from ${t} with options: ${(0,Ci.u4)(n)}`),this.areMaxRetriesExhausted(t,n))return!1;try{this.dispose();const i=this.scenarioFactory.findScenario(ft.RG.ClientStart);null==i||i.incomplete({commandSource:t,reason:e});const a=this.getReloadUrl(n,t,e);this.platformService.config.clientType===Ye.Bh.Maglev?yield this.rebootThroughDesktopApi(a,t,e):this.didUrlChange(a)?this.host.location.replace(a):this.host.location.reload()}catch(e){return this.logger.error("Reboot app failed"),!1}return!0}))}rebootWhenLongInactive(e,t,n){return this.clientStateSubscription?(this.logger.log(`Reboot subscription failed from ${t} with reason ${e}`),!1):(this.logger.log(`Reboot when longInactive is subscribed from ${t} with reason ${e}`),this.clientStateSubscription=this.clientStateProvider.observe().subscribe((i=>this.handleClientStateChange(i,e,t,n))),!0)}clearRetryCount(e){this.localStorage.remove(this.getRetryStorageKey(e),NT.f.Experience)}dispose(){var e,t,n;this.isRunningJobsInLongInactive=!1,this.rebootPending=void 0,this.timeoutId&&(this.host.clearTimeout(this.timeoutId),this.timeoutId=void 0),null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),null===(t=this.expChangeSubscription)||void 0===t||t.unsubscribe(),null===(n=this.lcChangeSubscription)||void 0===n||n.unsubscribe()}cleanupBeforeReboot(){var e,t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,a,o;for(;i=this.cleanupOnRebootArray.pop();)try{yield i("restart")}catch(e){a=a?a.concat(`${i.toString()}::${(0,Ci.u4)(e)}`):`${i.toString()}::${(0,Ci.u4)(e)}::`}a&&(o=new zS.G(zS.$.CLEANUP,new Error(a)),null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,`${o.code}${null===(n=o.prevError)||void 0===n?void 0:n.message}`,"webclient_framework_foundation_core_services",void 0,!0))}))}rebootThroughDesktopApi(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield this.hostCommunicationService.loadModule("core");i?yield null===(a=i.relaunch)||void 0===a?void 0:a.call(i,{url:e,reason:`${n}; source: ${ET.d[t]}`}):this.logger.error("HostComms is unable to load core module.")}))}handleClientStateChange(e,t,n,i){this.networkStateProvider.getState()===Sv.G.Online?(this.logger.log(`Handling clientState change to ${e}.`),e===VS.pk.LongInactive&&(this.rebootPending={reason:t,commandSource:n,options:i},this.isRunningJobsInLongInactive?this.waitForRunningJobsAndReboot():this.rebootApp(t,n,i))):this.logger.log(`Reboot skipped, network state is offline when client state change to ${e}.`)}getReloadUrl(e,t,n){var i;const a=new URL((null==e?void 0:e.customUrl)||this.host.location.href),o=a.searchParams;(null===(i=null==e?void 0:e.qsps)||void 0===i?void 0:i.hasOwnProperty("clearcontainer"))&&o.delete("container"),o.delete("tenantId"),a.hash=this.getReloadHash(t,n,a.hash);const r=(null==e?void 0:e.qsps)||{};return Object.keys(r).forEach((e=>{o.set(e,r[e])})),a.toString()}getReloadHash(e,t,n){if(this.platformService.config.clientType===Ye.Bh.Maglev){const i=$T(n);let a;if(i.deepLink===IT.core)a=IT.core;else switch(e){case ET.d.WebClientUpdateService:a=IT.core;break;case ET.d.ReloadAppTask:a=i.deepLink&&i.deepLink!==IT.flyout&&t===ET.Z.RingSwitch?encodeURIComponent(i.deepLink):IT.default;break;default:a=IT.default}return`deepLink=${a}&source=${ET.d[e]}`}return""}waitForRunningJobsAndReboot(){this.logger.log("Pending a reboot while waiting for Core to finish running App jobs in LongInactive client state. timeout=2000 ms"),this.timeoutId=this.host.setTimeout((()=>{if(this.host.clearTimeout(this.timeoutId),this.rebootPending){this.logger.log("Timeout waiting for Core to finish running App jobs in LongInactive client state. Rebooting now...");const{reason:e,commandSource:t,options:n}=this.rebootPending;this.rebootApp(e,t,n)}}),2e3)}isExperienceIdleStateChangedEvent(e){return e.type===bb.yU.ExperienceIdleStateChanged&&e.context.isIdle}}class w$ extends Fe{constructor(){super(De.Yg.CreateReboot,["clientState","experienceChangeReportingService","hostCommunicationService","lifeCycleScopeChangeReportingService","localStorage","loggerFactory","networkState","platformService","scenarioFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,experienceChangeReportingService:n,hostCommunicationService:i,lifeCycleScopeChangeReportingService:a,localStorage:o,loggerFactory:r,networkState:s,platformService:l,scenarioFactory:d,windowProvider:c}=e;e.rebootService=new C$(r,c,t,s,l,n,a,i,o,d)}))}}var N$,T$,I$,E$,A$=n(984700),_$=n(249049);class D$ extends Fe{constructor(){super(De.Yg.CreateRouting,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e.config.forceUseBrowserHistory||!e.windowProvider||""===e.windowProvider.location.hash?(0,A$.lX)({basename:e.config.basePath}):(0,A$.q_)({basename:e.config.basePath});e.history=t,e.routingServices=(0,_$.I)(e.loggerFactory,e.history,e.windowProvider&&e.windowProvider.location)}))}}class F${constructor(e,t){this._scheduler=e,this._logger=t.newLogger("SchedulerWithValidator"),this._uniqueJobIds=new Set}validateAndSchedule(e,t,n){const{id:i,runOncePerId:a}=t;if(this._uniqueJobIds.has(i)){if(a)return this._logger.debug(`Job by ID ${i} has already run once.`),Gw.o_}else this._uniqueJobIds.add(i);return this._scheduler.schedule(e,t,n)}}function M$(e){if(e.has(bb.c4.ExperienceWarm))return;const t=P$(e,bb.yU.NavigationIntentExecuted);let n=!1;t&&(n=!t.shouldRenderContent||function(e){var t;const n=P$(e,bb.FV.LayoutRenderComplete);return null!==(t=n&&(null==n?void 0:n.mainEntityType)!==L.pyR.pearnotdefaultapp)&&void 0!==t&&t}(e));const i=Array.from(e.values()).pop();return n&&(null==i?void 0:i.context)}function R$(e,t){if(e.has(bb.c4.UserWarm))return;let n=!1;if(O$(e))if(t)if(function(e){return!!P$(e,bb.FV.LayoutRenderCancelled)}(e)||x$(e))n=!0;else{const t=P$(e,bb.yU.NavigationIntentExecuted);t&&!t.shouldRenderContent&&(n=!0)}else n=!0;const i=Array.from(e.values()).pop();return n&&(null==i?void 0:i.context)}function P$(e,t){const n=e.get(t);return n&&n.context}function O$(e){return e.has(bb.yU.UserAuthenticated)&&e.has(bb.yU.UserConsentedToConsumeResources)}function x$(e){const t=P$(e,bb.FV.LayoutRenderComplete);if(t){const{mainEntityType:e}=t;if(!e||-1===[L.pyR.identity,L.pyR.tflfre,L.pyR.pearnotdefaultapp].indexOf(e))return!0}return!1}function L$(e,t){let n=[];const i=e[t.state];return i&&(n=n.concat(i({context:t.context}))),n}function U$(e,t,n){let i;if(e){const{app:a,state:o,callback:r}=e;let s=r();if(s){const e=s.length;if(e>0){t.log(`App:${a.manifest.id} supports the state: ${o}, job count returned from the app: ${e}.`),s=s.filter((e=>function(e,t,n){if(n===N$.start)return!1;const i=t&&t[n];if(Array.isArray(i))return i.indexOf(e)>-1;if([N$.onPreWarm,N$.onExperienceWarm,N$.onUserWindowPreWarm].includes(n))return!1;return!0}(e.id,n,o)));const i=s.length;i!==e&&t.log(`Jobs filtering by permissions took place. Job count is now: ${i}`)}i={state:o,jobs:s}}}return i}function B$({app:e,currentChanges:t,change:n,getCachedSupportSet:a,sessionContext:o}){const r=function(e,t){if(t.has(bb.c4.Initialized)||e.type===bb.yU.ExperienceIdleStateChanged)return;const n=P$(t,bb.yU.ActiveEntitiesResolved);return O$(t)&&n?n:void 0}(n,t);if(r)return{app:e,state:N$.onPreInit,callback:()=>function(e,t,n){let a;const o=n(),{entities:r,target:s}=t,l=(0,i.__rest)(t,["entities","target"]);for(const t of r)if(t&&o&&o.has(t.type)){a=a||[];const n=L$(e,{context:Object.assign(Object.assign({},l),{entity:t}),state:N$.onPreInit});a=a.concat(n)}return a}(e,Object.assign(Object.assign({},o),r),a)}}function j$({app:e,currentChanges:t,sessionContext:n}){const i=M$(t);if(i){const t=N$.onExperienceWarm;return{app:e,state:t,callback:()=>L$(e,{context:Object.assign(Object.assign({},n),i),state:t})}}}function W$({app:e,currentChanges:t,sessionContext:n,change:i}){if(i.context.isIdle&&O$(t)){const t=N$.onExperienceIdle;return{app:e,state:t,callback:()=>L$(e,{context:Object.assign({},n),state:t})}}}function V$({app:e,currentChanges:t,sessionContext:n}){const i=function(e){if(e.has(bb.c4.WindowWarm))return;let t=!1;x$(e)&&(t=!0);const n=Array.from(e.values()).pop();return t&&(null==n?void 0:n.context)}(t);if(i){const t=N$.onUserWindowPreWarm;return{app:e,state:t,callback:()=>L$(e,{context:Object.assign(Object.assign({},n),i),state:t})}}}function H$({appId:e,jobState:t,change:n,currentChanges:i,logger:a}){let o;if(t){const{jobs:r,state:s}=t,l=function(e,t){let n;switch(e){case N$.start:n=bb.c4.Started;break;case N$.onPreInit:n=bb.c4.Initialized;break;case N$.onExperienceWarm:n=bb.c4.ExperienceWarm;break;case N$.onPreWarm:n=bb.c4.UserWarm;break;case N$.onExperienceIdle:n=bb.c4.ExperienceIdle;break;case N$.onUserWindowPreWarm:n=bb.c4.WindowWarm}return function(e,{correlationId:t,windowId:n,context:{target:i}}){return{type:e,context:{target:i},correlationId:t,windowId:n}}(n,t)}(s,n);i.set(l.type,l),a.debug(`Life Cycle - Change type: ${n.type}, initiated by: ${n.context.target}. Resulted in app:${e} transition to state: ${s} and job count: ${r.length}`),o={change:l,jobs:r}}return o}function $$({application:e,appLifeCyclePermissions:t,change:n,currentChanges:i,getNextState:a,getCachedSupportSet:o,logger:r,sessionContext:s}){const l=U$(a({currentChanges:i,app:e,change:n,getCachedSupportSet:o,sessionContext:s}),r,t);return H$({appId:e.manifest.id,jobState:l,change:n,currentChanges:i,logger:r})}!function(e){e.start="start",e.onPreInit="onPreInit",e.onExperienceWarm="onExperienceWarm",e.onPreWarm="onPreWarm",e.onExperienceIdle="onExperienceIdle",e.onUserWindowPreWarm="onUserWindowPreWarm"}(N$||(N$={})),function(e){e.Experience="Experience"}(T$||(T$={})),function(e){e.Window="Window"}(I$||(I$={})),function(e){e.FirstUserAtBoot="FirstUserAtBoot",e.Other="Other"}(E$||(E$={}));class z${constructor(e,t,n){this._scope=e,this._appLifeCyclePermissions=t,this._sessionContext=n,this._currentChanges=new Map,this._logger=n.loggerFactory.newLogger("ApplicationLifeCycleManager")}get managedId(){var e;return null===(e=this._application)||void 0===e?void 0:e.manifest.id}manageApplication(e){this._application=e}onChange(e){const t=[];if(!this._application)return t;this._currentChanges.set(e.type,e);const n=function(e){switch(e){case T$.Experience:return[j$];case I$.Window:return[V$];default:return[B$,(t=e===E$.FirstUserAtBoot,({app:e,currentChanges:n,sessionContext:i})=>{const a=R$(n,t);if(a){const t=N$.onPreWarm;return{app:e,state:t,callback:()=>L$(e,{context:Object.assign(Object.assign({},i),a),state:t})}}}),W$]}var t}(this._scope);for(const i of n){const n=$$({application:this._application,appLifeCyclePermissions:this._appLifeCyclePermissions,change:e,currentChanges:this._currentChanges,getNextState:i,getCachedSupportSet:()=>this.supportedSets,logger:this._logger,sessionContext:this._sessionContext});n&&t.push(n)}return t}get supportedSets(){return this._supportedEntitySet=this._supportedEntitySet||this._application&&function(e){const t=e.manifest.supportedEntities,n=new Set;return t&&t.reduce(((e,t)=>e.add(t)),n),n}(this._application),this._supportedEntitySet}}function G$({applicationManagers:e,change:t,logger:n,schedulerWithValidator:a}){const o=[];return n.debug(`Change received: ${t.type}`),e.forEach((e=>{const r=e.managedId,s=e.onChange(t);r&&s.length>0&&s.forEach((e=>o.push(function(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{jobs:o,change:r}=e,s=[];o.forEach((e=>{s.push(function(e,t,n){var{job:a}=e,o=(0,i.__rest)(e,["job"]);return new Promise(((e,r)=>{t.validateAndSchedule((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield a();return e(t),t}catch(e){throw r(e),e}}))),Object.assign(Object.assign({priority:Gw.vW.Macro},o),{scheduledById:"services-life-cycle-manager"}),n)===Gw.o_&&e(void 0)}))}(e,a,r.correlationId))}));const l=[];let d=f$.success;for(const e of s)try{const t=yield e;t&&l.push(t)}catch(e){const i=`Not all jobs scheduled by ${n} completely successfully. Continuing execution of remaining jobs. Error: ${e.message?e.message:e}`;t.errorToTelemetry&&t.errorToTelemetry(i,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0),d=f$.failure}return Promise.resolve({id:n,type:r.type,stateJobStatus:d,jobCount:o.length,cleanupJobs:l})}))}(e,n,r,a))))})),{change:t,lcChanges:o}}function q$({change:e,lcChanges:t}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield Promise.all(t);return{change:e,lcChanges:n}}))}function Q$({change:e,lcChanges:t},n,i){const{type:a}=e;0===t.length&&n.debug(`Experience change type: ${a} produced no application life cycle changes`);const o=i===T$.Experience?k$.ExperienceLifeCycleManager:k$.UserLifeCycleManager;return Object.assign(Object.assign({},e),{type:y$.LifeCycleReport,context:{apps:t,target:o,reportedChange:e}})}class J${constructor(e,t,n,i,a,o,r){this._scope=t,this._sessionContext=i,this._lifeCycleChangeReportingService=a,this._loggerFactory=o,this._lifeCycleJobPermissions=r,this._cleanupJobs=[],this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger(`WindowLifeCycleManager[${e}]`),this._schedulerWithValidator=new F$(n,o)}notify(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=G$({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}),n=yield q$(t);for(const{cleanupJobs:e}of n.lcChanges)this._cleanupJobs.push(...e);const i=Q$(n,this._logger,this._scope);this._lifeCycleChangeReportingService.report(i)}))}manageApplication(e){var t;if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const n=new z$(this._scope,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);n.manageApplication(e),this._applicationManagers.push(n)}destroy(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o,r;for(;i=this._cleanupJobs.pop();)try{yield i(e)}catch(e){r=r?r.concat(`${i.toString()}::${(0,Ci.u4)(e)}`):`${i.toString()}::${(0,Ci.u4)(e)}::`}r&&(o=new zS.G(zS.$.CLEANUP,new Error(r)),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}${null===(a=o.prevError)||void 0===a?void 0:a.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}}class Y${constructor(e,t,n,i,a,o,r){this._scope=t,this._scheduler=n,this._sessionContext=i,this._lifeCycleChangeReportingService=a,this._loggerFactory=o,this._lifeCycleJobPermissions=r,this._cleanupJobs=[],this._windowLifecycleManagers=new Map,this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger(`UserLifeCycleManager[${e}]`),this._schedulerWithValidator=new F$(n,o)}manageApplication(e){var t;if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const n=new z$(this._scope,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);n.manageApplication(e),this._applicationManagers.push(n)}notify(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.handleWindowChange(e);const i=G$({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}),o=yield q$(i);if((null===(t=o.lcChanges)||void 0===t?void 0:t.length)>0&&(null===(n=o.lcChanges[0])||void 0===n?void 0:n.type)===bb.c4.UserWarm){const e=null===(a=this._sessionContext.scenarioFactory)||void 0===a?void 0:a.findScenario(ft.RG.PostALT);null==e||e.mark(ft.ck.PreWarmJobCompleted)}for(const{cleanupJobs:e}of o.lcChanges)this._cleanupJobs.push(...e);const r=Q$(o,this._logger,this._scope);this._lifeCycleChangeReportingService.report(r)}))}manageWindow(e,t){var n,i;if(this._windowLifecycleManagers.has(e))return void(null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,`WINDOW_LIFECYCLE_MANAGER_ALREADY_EXISTS[${e}]`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0));const a=new J$(e,I$.Window,this._scheduler,t,this._lifeCycleChangeReportingService,this._loggerFactory,this._lifeCycleJobPermissions);this._activelyManagedApplications.forEach((e=>a.manageApplication(e))),this._windowLifecycleManagers.set(e,a)}removeWindow(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this._windowLifecycleManagers.get(e);n&&(yield n.destroy(t),this._windowLifecycleManagers.delete(e))}))}destroy(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o,r;for(this._windowLifecycleManagers.forEach((t=>{t.destroy(e)}));i=this._cleanupJobs.pop();)try{yield i(e)}catch(e){r=r?r.concat(`${i.toString()}::${(0,Ci.u4)(e)}`):`${i.toString()}::${(0,Ci.u4)(e)}::`}r&&(o=new zS.G(zS.$.CLEANUP,new Error(r)),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}${null===(a=o.prevError)||void 0===a?void 0:a.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}handleWindowChange(e){var t;e.windowId&&(null===(t=this._windowLifecycleManagers.get(e.windowId))||void 0===t||t.notify(e))}}class K${constructor(e,t,n,i,a,o){this._scheduler=e,this._experienceChangeReportingService=t,this._sessionContext=n,this._lifeCycleChangeReportingService=i,this._loggerFactory=a,this._lifeCycleJobPermissions=o,this._cleanupJobs=[],this._userLifecycleManagers=new Map,this.handleUserScopeChange=e=>{if(e.userContextId){const t=this._userLifecycleManagers.get(e.userContextId);t?t.notify(e):this._logger.error(`EXPECTED_USER_LIFECYCLE_MANAGER_NOT_FOUND[${e.userContextId}]`)}else this._userLifecycleManagers.forEach((t=>t.notify(e)))},this._applicationManagers=[],this._activelyManagedApplications=new Set,this._lifeCycleJobPermissions=this._lifeCycleJobPermissions||{},this._logger=this._loggerFactory.newLogger("ExperienceLifeCycleManager"),this._schedulerWithValidator=new F$(this._scheduler,a)}init(){const e=this._experienceChangeReportingService.observeChanges();this._subscription=e.pipe((0,lS.b)(this.handleUserScopeChange),(0,aS.U)((e=>G$({applicationManagers:this._applicationManagers,change:e,logger:this._logger,schedulerWithValidator:this._schedulerWithValidator}))),(0,kS.b)(q$),(0,lS.b)((e=>{var t,n,i;if((null===(t=e.lcChanges)||void 0===t?void 0:t.length)>0&&(null===(n=e.lcChanges[0])||void 0===n?void 0:n.type)===bb.c4.ExperienceWarm){const e=null===(i=this._sessionContext.scenarioFactory)||void 0===i?void 0:i.findScenario(ft.RG.PostALT);null==e||e.mark(ft.ck.ExperienceWarmJobCompleted)}for(const{cleanupJobs:t}of e.lcChanges)this._cleanupJobs.push(...t)})),(0,aS.U)((e=>Q$(e,this._logger,T$.Experience))),(0,aS.U)((e=>this._lifeCycleChangeReportingService.report(e)))).subscribe()}destroy(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o,r;for(;i=this._cleanupJobs.pop();)try{yield i(e)}catch(e){r=r?r.concat(`${i.toString()}::${(0,Ci.u4)(e)}`):`${i.toString()}::${(0,Ci.u4)(e)}::`}this._subscription&&this._subscription.unsubscribe(),this._scheduler.destroy(),r&&(o=new zS.G(zS.$.CLEANUP,new Error(r)),null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,`${o.code}${null===(a=o.prevError)||void 0===a?void 0:a.message}`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0))}))}manageApplication(e){var t;if(!this._subscription)throw new Error("Unable to manage provided application prior to LifeCycleManager init.");if(this._activelyManagedApplications.has(e))return;this._activelyManagedApplications.add(e);const n=new z$(T$.Experience,null===(t=this._lifeCycleJobPermissions)||void 0===t?void 0:t.Application,this._sessionContext);n.manageApplication(e),this._applicationManagers.push(n)}manageUser(e,t){if(this._userLifecycleManagers.has(e))return void this._logger.error(`USER_LIFECYCLE_MANAGER_ALREADY_EXISTS[${e}]`);const n=new Y$(e,this._userLifecycleManagers.size>0?E$.Other:E$.FirstUserAtBoot,this._scheduler,t,this._lifeCycleChangeReportingService,this._loggerFactory,this._lifeCycleJobPermissions);this._activelyManagedApplications.forEach((e=>n.manageApplication(e))),this._userLifecycleManagers.set(e,n)}manageWindow(e,t,n){var i,a;this.removeWindow(e,"switch_user");const o=this._userLifecycleManagers.get(t);o?o.manageWindow(e,Object.assign(Object.assign({},this._sessionContext),n)):null===(a=(i=this._logger).errorToTelemetry)||void 0===a||a.call(i,`EXPECTED_USER_LIFECYCLE_MANAGER_NOT_FOUND[${t}]`,"webclient_framework_foundation_core_services_life_cycle_manager",void 0,!0)}removeUser(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this._userLifecycleManagers.get(t);n?(yield n.destroy(e),this._userLifecycleManagers.delete(t)):this._logger.warn(`USER_LIFECYCLE_MANAGER_NOT_FOUND_TO_DESTROY[${t}]`)}))}removeWindow(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this._userLifecycleManagers.forEach((n=>n.removeWindow(e,t)))}))}}const Z$=(e,t,n,i)=>{const a=function(e,t,n){if(!n){const{context:{execution:n}}=e;t.error(`Received a scheduler change in state: ${Gw.Tf[n]} with no active scenario: ${JSON.stringify(e)}`)}return n}(e,t,i);if(a){const{context:{execution:t,handle:i,error:o}}=e;a.appendEventData({errorCode:null==o?void 0:o.code,message:null==o?void 0:o.message,context:null==o?void 0:o.context}),a.mark(`${ft.ck.ScheduledJobStateChange}_${Gw.Tf[t].toLocaleLowerCase()}_${i}`),n(a)}};class X${constructor(e,t,n){this._schedulerChangeReporting=e,this._scenarioFactory=t,this._activeExpScenariosMap=new Map,this._activeAppScenariosMap=new Map,this._activeSchedulerScenariosMap=new Map,this._logger=n.newLogger("LifeCycleTelemetry")}init(){const e=e=>({change:e,scenarioFactory:this._scenarioFactory,activeAppScenariosMap:this._activeAppScenariosMap,activeExpScenariosMap:this._activeExpScenariosMap,activeSchedulerScenariosMap:this._activeSchedulerScenariosMap,logger:this._logger});this._schedulingChangeSubscription=this._schedulerChangeReporting.observeChanges().pipe((0,aS.U)((t=>function({change:e,activeSchedulerScenariosMap:t,scenarioFactory:n,logger:i}){const{context:{execution:a}}=e,o=(({windowId:e,context:{handle:t}})=>`${t}:${e}`)(e);let r=t.get(o);switch(a){case Gw.Tf.Started:if(r)i.error(`Received a scheduler change in state: ${Gw.Tf[a]} with an active scenario already running. Change: ${JSON.stringify(e)}`);else{r=n.newScenario(ft.RG.ScheduledJobComplete),t.set(o,r);const{correlationId:i,context:{meta:{id:a,priority:s,scheduledById:l,runOncePerId:d},target:c},type:u}=e;r.appendEventData({"Job.Id":a,"Job.Priority":Gw.vW[s],"Job.ScheduledBy":l,"Job.RunOncePerId":d,target:c,correlationId:i,type:u})}break;case Gw.Tf.Canceled:Z$(e,i,(e=>null==e?void 0:e.cancel()),r);break;case Gw.Tf.Complete:Z$(e,i,(e=>null==e?void 0:e.stop()),r),t.delete(o);break;case Gw.Tf.Received:i.log(`Received a scheduler change in state: ${Gw.Tf[a]}: Change:${JSON.stringify(e)}`)}}(e(t))))).subscribe()}destroy(){this._schedulingChangeSubscription&&this._schedulingChangeSubscription.unsubscribe(),this._schedulingChangeSubscription=void 0}}var ez;!function(e){e.p720="720p",e.p1080="1080p",e.p2k="2k",e.p4k="4k",e.unkown="unkown"}(ez||(ez={}));const tz=2073600,nz=3686400,iz=8294400;function az(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i={Perf_Screen:void 0};let o;const r=e.screen.availWidth*(null===(t=e.screen)||void 0===t?void 0:t.availHeight);return o=r<tz?ez.p720:r>=tz&&r<nz?ez.p1080:r>=nz&&r<iz?ez.p2k:r>=iz?ez.p4k:ez.unkown,i.Perf_Screen={width:null===(n=e.screen)||void 0===n?void 0:n.availWidth,height:null===(a=e.screen)||void 0===a?void 0:a.availHeight,resolution:o,dpr:e.devicePixelRatio},Promise.resolve(i)}))}var oz=n(709521);class rz{constructor(e){this.context=e,this.isRunning=!1,this.timeouts={},this.granularNativeMetrics=[],this.granularWorkerMetrics=[],this.packedCallingData=new Map,this.peakWorkingSetByProcess=new Map,this.peakUsedJSHeapSize=0,this.granularJSHeapMetrics=[],this.getHeartbeatInterval=()=>{var e,t;return null!==(t=null===(e=this._configuration)||void 0===e?void 0:e.intervalInSeconds)&&void 0!==t?t:Number.MAX_SAFE_INTEGER},this.getMemorySubInterval=()=>{var e,t;return null!==(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection.collectionIntervalInSeconds)&&void 0!==t?t:Number.MAX_SAFE_INTEGER},this.logger=e.loggerFactory.newLogger("Heartbeat")}static getInstance(){return rz.instance}get configuration(){return this._configuration}start(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){rz.instance||(rz.instance=this,this.logger.debug("Starting the monitor..."),this.subscribeToCoreSettings(),this.initializedTime=(new Date).getTime(),yield this.registerScenarios())}))}stop(){this.logger.debug("Stopping the monitor..."),this.stopHeartbeat(),rz.instance=void 0}isHeartbeatMonitorRunning(){return this.isRunning}getMemoryData(){var e,t;return(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection)||void 0===t?void 0:t.enabled)?this.getAverageMemoryMetrics():{}}collectData(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=this.getActions().map((e=>e()));return Object.assign.apply(Object,yield Promise.all(e))}))}collectCallingData(e,t){var n,i;const{enableCallingCDLTrackingNS:a}=this.context.coreSettings.get(K.J.Calling)||{};if(a){const e=JSON.parse(t),i={cdlData:null===(n=this.context.graphqlOpsCountService)||void 0===n?void 0:n.getLatestDataAndClear()},a=Object.assign(e,i);t=JSON.stringify(a)}this.packedCallingData.set(e,(null!==(i=this.packedCallingData.get(e))&&void 0!==i?i:[]).concat(t))}getActions(){var e,t,n,i,a,o,r,s,l,d,c,u,m,g,p,v,h,f,y,k,S;const b=[];(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection)||void 0===t?void 0:t.enabled)&&b.push(this.getAverageMemoryMetrics.bind(this)),(null===(i=null===(n=this._configuration)||void 0===n?void 0:n.elapsedTimeTracking)||void 0===i?void 0:i.enabled)&&b.push(this.getElapsedTime.bind(this)),(null===(o=null===(a=this._configuration)||void 0===a?void 0:a.screenInfoCollection)||void 0===o?void 0:o.enabled)&&b.push(az.bind(this,this.context.windowProvider)),(null===(s=null===(r=this._configuration)||void 0===r?void 0:r.ariMetricsCollection)||void 0===s?void 0:s.enabled)&&b.push(this.getAriMetrics.bind(this)),(null===(d=null===(l=this._configuration)||void 0===l?void 0:l.dataClientMetricsCollection)||void 0===d?void 0:d.enabled)&&b.push(this.getDataClientMetrics.bind(this)),(null===(u=null===(c=this._configuration)||void 0===c?void 0:c.windowMetricsCollection)||void 0===u?void 0:u.enabled)&&b.push(this.getWindowMetrics.bind(this)),(null===(g=null===(m=this._configuration)||void 0===m?void 0:m.clientStateMetricsCollection)||void 0===g?void 0:g.enabled)&&b.push(this.getClientStateMetrics.bind(this)),(null===(v=null===(p=this._configuration)||void 0===p?void 0:p.OLDMetricsCollection)||void 0===v?void 0:v.enabled)&&b.push(this.getObjectLeakDetectorMetrics.bind(this));const{enableCallingDataCollectionInHeartbeatConfig:C}=(null===(h=this.context.coreSettings)||void 0===h?void 0:h.get(K.J.Calling))||{};return C&&(null===(y=null===(f=this._configuration)||void 0===f?void 0:f.callingDataCollection)||void 0===y?void 0:y.enabled)&&b.push(this.getCallingData.bind(this)),(null===(S=null===(k=this._configuration)||void 0===k?void 0:k.graphqlStoreMetricsCollection)||void 0===S?void 0:S.enabled)&&b.push(this.getGraphQLStoreMetrics.bind(this)),b}stopHeartbeat(){this.isRunning&&this.logger.debug("stopping heartbeat monitor"),Object.keys(this.timeouts).forEach((e=>{this.context.windowProvider.clearTimeout(this.timeouts[e])})),this.timeouts={},this.isRunning=!1}subscribeToCoreSettings(){this.context.coreSettings.getObservable(K.J.Telemetry).subscribe((e=>{var t,n,i;const{enableHeartbeatMonitor:a,heartbeatConfiguration:o}=e;o?(this._configuration=o,this.logger.debug("Configuration loaded...",this._configuration)):null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"'heartbeatConfiguration' not found.","fundamentals_performance_heartbeat_monitor"),a?(this.startHeartbeat(),(null===(i=this._configuration)||void 0===i?void 0:i.memoryMetricsCollection.enabled)||(this.context.windowProvider.clearTimeout(this.timeouts.memory),this.timeouts.memory=void 0)):this.stopHeartbeat()}))}startHeartbeat(){!this.isRunning&&this.logger.debug("starting heartbeat monitor"),this.scheduleNextTimeout("heartbeat",this.isRunning?this.getHeartbeatInterval():Math.min(30,this.getHeartbeatInterval()),this.beat.bind(this),this.getHeartbeatInterval),this.scheduleNextTimeout("memory",this.isRunning?this.getMemorySubInterval():Math.min(25,this.getMemorySubInterval()),this.collectGranularMemoryAndJSHeapData.bind(this),this.getMemorySubInterval),this.isRunning=!0}scheduleNextTimeout(e,t=Number.MAX_SAFE_INTEGER,n,a){var o;const r=t*De.B.second;0<r&&r<2147483647&&(this.timeouts[e]=null!==(o=this.timeouts[e])&&void 0!==o?o:this.context.windowProvider.setTimeout((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,i;this.timeouts[e]=void 0;try{yield n()}catch(e){null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,`call to function '${n}' failed in heartbeat monitor.`,"fundamentals_performance_heartbeat_monitor")}finally{this.scheduleNextTimeout(e,a(),n,a)}}))),r))}beat(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.collectData();(0,Lw.aA)(e)}))}getElapsedTime(){const e=(new Date).getTime(),t=this.initializedTime||e;return{elapsed:Math.floor((e-t)/De.B.second)}}getAverageMemoryMetrics(){const e=[];if(this.granularNativeMetrics.length){const t=new Map(this.peakWorkingSetByProcess.entries());this.peakWorkingSetByProcess.clear(),this.granularNativeMetrics.reduce(((e,t)=>{var n;for(const i of t){const{processId:t}=i;e.set(t,(null!==(n=e.get(t))&&void 0!==n?n:[]).concat(i))}return e}),new Map).forEach(((n,i)=>{var o;this.peakWorkingSetByProcess.set(i,null!==(o=t.get(i))&&void 0!==o?o:0);const r=(0,a.meanBy)(n,(e=>e.workingSetSizeKB)),s=(0,a.meanBy)(n,(e=>e.commitSizeKB)),l={processId:i,name:n[0].name,type:n[0].type,utilitySubType:n[0].utilitySubType,embeddedBrowserWebView:n[0].embeddedBrowserWebView,cpuCycleTime:n[0].cpuCycleTime,workingSetSizeKB:isNaN(r)?void 0:Math.round(r),commitSizeKB:isNaN(s)?void 0:Math.round(s)};e.push(l)}))}const t=[];this.granularWorkerMetrics.length&&this.granularWorkerMetrics.reduce(((e,t)=>{var n;for(const i of t){const{targetSessionId:t}=i;e.set(t,(null!==(n=e.get(t))&&void 0!==n?n:[]).concat(i))}return e}),new Map).forEach(((e,n)=>{const i=(0,a.meanBy)(e,(e=>e.totalSizeKB)),o=(0,a.meanBy)(e,(e=>e.usedSizeKB)),r={targetSessionId:n,type:e[0].type,subType:e[0].subType,totalSizeKB:isNaN(i)?void 0:Math.round(i),usedSizeKB:isNaN(o)?void 0:Math.round(o)};t.push(r)}));const n=(0,g$.Mv)(e,this.peakWorkingSetByProcess,this.mainRendererProcessId),i=(0,g$.tC)(t);let o={};if(this.granularJSHeapMetrics.length){const e={jsHeapSizeLimit:Math.round((0,a.meanBy)(this.granularJSHeapMetrics,(e=>e.jsHeapSizeLimit||0))),totalJSHeapSize:Math.round((0,a.meanBy)(this.granularJSHeapMetrics,(e=>e.totalJSHeapSize||0))),usedJSHeapSize:Math.round((0,a.meanBy)(this.granularJSHeapMetrics,(e=>e.usedJSHeapSize||0)))};o=(0,g$.RQ)(e,this.peakUsedJSHeapSize)}return Object.assign(Object.assign(Object.assign({},n),i),o)}getAriMetrics(){const e={Perf_Ari:""};if(this.context.appResponsivenessService){const t=this.context.appResponsivenessService.getTelemetry();e.Perf_Ari=t}return e}getDataClientMetrics(){const e={Perf_ApolloCacheStats:void 0};if(this.context.dataClientTrackingService){const t=this.context.dataClientTrackingService.getTelemetry();e.Perf_ApolloCacheStats=t}return e}getWindowMetrics(){const e={Perf_WindowStats:void 0};if(this.context.windowTrackerService){const t=this.context.windowTrackerService.getTelemetry();e.Perf_WindowStats=t}return e}getObjectLeakDetectorMetrics(){const e={};return this.context.leakDetectorService&&(e.Perf_OLDStats=this.context.leakDetectorService.getTelemetry()),e}getClientStateMetrics(){const e={Perf_IsUserInCall:void 0};if(this.context.clientState){const t=this.context.clientState.getState()===VS.pk.VeryActive;e.Perf_IsUserInCall=t}return e}getCallingData(){const e={Perf_Calling_Data:void 0};return this.packedCallingData.forEach((t=>{e.Perf_Calling_Data?e.Perf_Calling_Data.push(...t):e.Perf_Calling_Data=t})),this.packedCallingData.clear(),e}getGraphQLStoreMetrics(){const e={};return this.context.graphqlStoreStatsReporterService&&(e.Perf_GraphQLStoreStats=this.context.graphqlStoreStatsReporterService.getTelemetry()),e}collectGranularMemoryAndJSHeapData(){var e,t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=Math.max(Math.floor(this.getHeartbeatInterval()/this.getMemorySubInterval()),1)||1;if(this.context.hostCommunicationService){const a=yield p$(this.context.hostCommunicationService,(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.workerMetricsCollection)||void 0===t?void 0:t.enabled)||!1);this.granularNativeMetrics=this.granularNativeMetrics.concat([a.processes]).slice(-i),this.granularWorkerMetrics=this.granularWorkerMetrics.concat([a.workers]).slice(-i);const o=[];for(const e of a.processes){const{processId:t,type:n}=e,i=this.peakWorkingSetByProcess.get(t);this.peakWorkingSetByProcess.set(t,Math.max(i||0,e.workingSetSizeKB||0)),"renderer"===n.toLowerCase()&&o.push(e)}this.mainRendererProcessId=this.mainRendererProcessId&&o.find((e=>e.processId===this.mainRendererProcessId))?this.mainRendererProcessId:null===(n=o.sort(((e,t)=>{var n,i;return(null!==(n=t.workingSetSizeKB)&&void 0!==n?n:0)-(null!==(i=e.workingSetSizeKB)&&void 0!==i?i:0)}))[0])||void 0===n?void 0:n.processId}else this.logger.error("Invalid hostCommunicationService, cannot get metrics from Desktop");if(this.context.windowProvider){const e=(0,oz.P)(this.context.windowProvider);this.peakUsedJSHeapSize=Math.max(this.peakUsedJSHeapSize,e.usedJSHeapSize||0),this.granularJSHeapMetrics=this.granularJSHeapMetrics.concat(e).slice(-i)}}))}registerScenarios(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(this.context.hostCommunicationService){const e=yield this.context.hostCommunicationService.loadModule("heartbeat");if(null==e?void 0:e.registerForScenarioStart)try{e.registerForScenarioStart((e=>{}))}catch(e){this.logger.error("Failed to register for listening to host scenarios starting")}if(null==e?void 0:e.registerForScenarioStop)try{e.registerForScenarioStop((e=>{}))}catch(e){this.logger.error("Failed to register for listening to host scenarios stopping")}}}))}}rz.instance=void 0;const sz=1024,lz=1e3,dz=6e4,cz=36e5,uz=864e5,mz="memoryFeedbackService.lastDialogDate",gz="memoryFeedbackService.countOfDialogWithinDay",pz="memoryFeedbackService.countOfDialogWithinWeek";class vz{constructor(e,t,n,i,a,o,r,s){this.localStorage=e,this.entityCommanding=t,this.clientState=n,this.client=i,this.coreSettings=a,this.scenarioFactory=o,this.profilerService=r,this.userTrackingService=s,this.timeWhenLastCallEnded=-1,this.countOfDialogWithinDay=0,this.countOfDialogWithinWeek=0,this.memoryFeedbackSettings=this.coreSettings.get(K.J.Diagnostics).memoryFeedbackSettings}start(){this.startClientStateSubscription(),this.intervalId||(this.intervalId=(0,Ze.J)().setInterval((()=>this.beat()),this.memoryFeedbackSettings.verySlowSampleTime))}stop(){this.intervalId&&(0,Ze.J)().clearInterval(this.intervalId),this.timeoutId&&(0,Ze.J)().clearTimeout(this.timeoutId),this.clientStateSubscription&&this.clientStateSubscription.unsubscribe()}startClientStateSubscription(){let e=this.clientState.getState();this.clientStateSubscription=this.clientState.observe().subscribe({next:t=>{e===VS.pk.VeryActive&&t!==VS.pk.VeryActive&&(this.timeWhenLastCallEnded=Date.now()),e=t}})}shouldKeepRunningForMTMA(){var e;return!!this.memoryFeedbackSettings.accountSizeInMB||(null===(e=this.userTrackingService)||void 0===e?void 0:e.getAccountMode())!==oi.MultipleAccounts}beat(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.shouldKeepRunningForMTMA())return void this.stop();const t=yield null===(e=rz.getInstance())||void 0===e?void 0:e.getMemoryData();if(!t)return;if(void 0!==t.Perf_Renderer_Count_Processes&&t.Perf_Renderer_Count_Processes>1)return this.stop(),void this.newScenario(ft.RG.MemoryFeedbackStopBecauseOfDevtools);const n=new Date,i=yield this.shouldShowBrbDialog(n,t);i.isMemoryHeavy&&(this.openBrbDialog(i.memoryDetailMessage),this.newScenario(ft.RG.MemoryFeedbackDialogOpen),this.stop(),this.dateOfBeginingHighMemory=void 0,this.localStorage.set(gz,(this.countOfDialogWithinDay+1).toString()),this.localStorage.set(pz,(this.countOfDialogWithinWeek+1).toString()),this.localStorage.set(mz,n.toString()))}))}openBrbDialog(e){this.entityCommanding.brbFeedback.autoBrbConfirmationDialog({visibilityState:c.fe.show,stateTransition:c.su.new,correlation:{source:Ot.D.AutoBrb}},{feedbackText:`Detected high memory usage. ${e}`})}shouldShowBrbDialog(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield(0,JT.jW)(this.client);if(!(null==n?void 0:n.isMainWindow))return{isMemoryHeavy:!1};this.dateOfBeginingHighMemory&&(yield this.triggerGCAndWait());const{isMemoryHeavy:i,memoryDetailMessage:a}=yield this.getMemoryUsageData(t);if(!i||this.wasInCallRecently(e))return this.dateOfBeginingHighMemory=void 0,{isMemoryHeavy:!1};if(this.dateOfBeginingHighMemory=this.dateOfBeginingHighMemory||e,e.getTime()-this.dateOfBeginingHighMemory.getTime()<this.memoryFeedbackSettings.durationInMinuteOfConsecutiveHighMemoryState*dz)return{isMemoryHeavy:!1};if(this.hasReachedDialogLimit(e))return{isMemoryHeavy:!1};return this.clientState.getState()!==VS.pk.Active?{isMemoryHeavy:!1}:{isMemoryHeavy:i,memoryDetailMessage:a}}))}getMemoryUsageData(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=this.getThresholds(),n=[];let i=!1;const a=yield this.calculatePopoutAdditionalSize(),o=this.calculateAccountsAdditionalSizeInKb(),r=e.Perf_Renderer_WorkingSet||0,s=r-a.rendererWorkingSet-o.rendererWorkingSet>t.rendererWorkingSet*sz;i=i||s,n.push(`${this.markReachedThreshold(s)}RWS: ${this.convertKBtoMB(r)} MB`);const l=e.Perf_JSHeap_UsedSize||0,d=l-a.jsUsedHeapSize-o.jsUsedHeapSize>t.jsUsedHeapSize*sz;i=i||d,n.push(`${this.markReachedThreshold(d)}JSH: ${this.convertKBtoMB(l)} MB`);return{isMemoryHeavy:i,memoryDetailMessage:n.join(", ")}}))}calculatePopoutAdditionalSize(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(null===(e=yield(0,JT.XD)(this.client))||void 0===e?void 0:e.length)||0,n=this.memoryFeedbackSettings.popoutSizeInMB;return t<=1||!n?{jsUsedHeapSize:0,rendererWorkingSet:0}:{jsUsedHeapSize:(t-1)*n.jsUsedHeapSize*sz,rendererWorkingSet:(t-1)*n.rendererWorkingSet*sz}}))}calculateAccountsAdditionalSizeInKb(){var e;const t=(null===(e=this.userTrackingService)||void 0===e?void 0:e.getAuthenticatedUsers().size)||0,n=this.memoryFeedbackSettings.accountSizeInMB;return t<=1||!n?{jsUsedHeapSize:0,rendererWorkingSet:0}:{jsUsedHeapSize:(t-1)*n.jsUsedHeapSize*sz,rendererWorkingSet:(t-1)*n.rendererWorkingSet*sz}}hasReachedDialogLimit(e){const t=new Date(this.localStorage.get(mz)||0);return e.getTime()-t.getTime()<this.memoryFeedbackSettings.gapInHourBetweenFeedbackDialogs*cz||(e.getTime()-t.getTime()>uz&&this.resetDialogDayCount(),this.countOfDialogWithinDay=parseInt(this.localStorage.get(gz)||"0",10),this.countOfDialogWithinDay>=this.memoryFeedbackSettings.limitOfFeedbackDialogsWithinDay||(e.getTime()-t.getTime()>7*uz&&this.resetDialogWeekCount(),this.countOfDialogWithinWeek=parseInt(this.localStorage.get(pz)||"0",10),this.countOfDialogWithinWeek>=this.memoryFeedbackSettings.limitOfFeedbackDialogsWithinWeek))}wasInCallRecently(e){const t=this.memoryFeedbackSettings.minimumSecondsPassedSinceLastCall*lz,n=this.timeWhenLastCallEnded>0&&e.getTime()-this.timeWhenLastCallEnded;return n&&t&&n<t}triggerGCAndWait(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield null===(e=this.profilerService)||void 0===e?void 0:e.requestTriggerGC(),yield(0,zI._)(this.memoryFeedbackSettings.delayInMsAfterGC)}))}newScenario(e){this.scenarioFactory.newScenario(e).stop()}getThresholds(){return this.memoryFeedbackSettings.thresholdsInMB}resetDialogDayCount(){this.localStorage.set(gz,"0")}resetDialogWeekCount(){this.localStorage.set(pz,"0")}markReachedThreshold(e){return e?"#":""}convertKBtoMB(e){return(e/sz).toFixed(2)}}var hz,fz=n(593656);!function(e){e.LifeCycleScopeChange="LifeCycleScopeChange"}(hz||(hz={}));class yz extends Fe{constructor(){super(De.Yg.Scheduling,["appsRegistryService","client","clientState","config","coreSecurityService","coreSettings","coreSettingsContext","coreUtilities","entityCommanding","experienceChangeReportingService","hostCommunicationService","i18n","i18NextWrapper","lifeCycleScopeChangeReportingService","localStorage","loggerFactory","networkState","platformService","rebootService","scenarioFactory","schedulerChangeReporting","userBiService","windowProvider"]),this.createCoreApplication=(e,t)=>({manifest:{name:"CoreTasks",id:"com.microsoft.teams.corescheduling"},onExperienceWarm:e=>[{id:"memory-feedback-service-start",job:()=>{const{context:{localStorage:t,entityCommanding:n,clientState:i,coreSettings:a,client:o,scenarioFactory:r,userTrackingService:s,profilerService:l}}=e;if(!a.get(K.J.Diagnostics).enableMemoryFeedbackService)return;if(!t||!i||!a.get(K.J.Diagnostics).memoryFeedbackSettings)return;new vz(t,n,i,o,a,r,l,s).start()}},{id:"init-diagnostics-idb-job",job:()=>{const{context:{loggerFactory:t}}=e;"notifyDiagnosticsALTDone"in t&&t.notifyDiagnosticsALTDone()}}],onPreWarm:n=>[{id:"settings-ecs-fetch",job:()=>e.fetchEcsSettingsIfApplicable()},{id:"user-bi-initialize-smb-user-intent",job:()=>t.initializeAndSubscribeToSmbUserIntent&&t.initializeAndSubscribeToSmbUserIntent()},{id:"active-windows-history-job",job:()=>{const{context:{activeWindowsHistoryService:e}}=n;if(e)return e.initialize(),t=>{e.cleanup(t)}}},{id:"initialize-office-integration-service",job:()=>{const{context:{coreSettings:e,client:t,hostCommunicationService:i,loggerFactory:a,entityCommanding:o,authenticationUser:r,localStorage:s,windowProvider:l}}=n;e.get(K.J.People).enableOfficeIntegration&&fz.x.Instance(i,e,t,a,o,l,s,r).initialize()}}]})}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e.config,n=e.coreSettings,a=e.coreSettingsContext,o=e.entityCommanding,r=e.experienceChangeReportingService,s=e.hostCommunicationService,l=e.i18n,d=e.lifeCycleScopeChangeReportingService,c=e.loggerFactory,u=e.networkState,m=e.platformService,g=e.scenarioFactory,p=e.schedulerChangeReporting,v=e.userBiService,h=e.clientState,f=e.localStorage,y=e.i18NextWrapper,k=e.windowProvider,S=e.rebootService,b=e.coreSecurityService;new X$(p,g,c).init();const C=new eN(p,window,c,De.QU),{isEntityInView:w}=e.coreUtilities,N=new K$(C,r,{client:e.client,coreSettings:n,entityCommanding:o,i18n:l,isEntityInView:w,loggerFactory:c,networkState:u,platformService:m,scenarioFactory:g,hostCommunicationService:s,clientState:h,localStorage:f,config:t,i18NextWrapper:y,windowProvider:k,rebootService:S,coreSecurityService:b},d,c,t.lifeCycleJobPermissions);return N.init(),e.appsRegistryService.registeredApps.forEach((e=>N.manageApplication(e))),N.manageApplication(this.createCoreApplication(a,v)),e.scheduler=C,e.experienceLifecycleManager=N,e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"quit":case"signout":yield N.destroy(e);break;default:return}}))}))}}class kz{constructor(e,t,n,a,o,r,s){this.experienceChangeReportingService=e,this.commandChangeReportingService=t,this.appsRegistryService=n,this.scheduler=a,this.hostComms=o,this.userKey=r,this.context=s,this.mainWindowDisplayedChange={windowId:null,eventFired:!1},this.processExperienceChangeChange=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){e.type===bb.yU.UserConsentedToConsumeResources&&(this.layoutRenderedChange&&(this.layoutRenderedChange=void 0),this.userConsentedChange=e),e.type===bb.FV.LayoutRenderComplete&&!0===e.isMainWindow&&(this.layoutRenderedChange=e),this.tryToSendSignal()})),this.onWindowVisibilityChanged=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;const n=yield this.isMainWindowForActiveUserContext(e.windowId);if(!e.visible||this.mainWindowDisplayedChange&&(null===(t=this.mainWindowDisplayedChange)||void 0===t?void 0:t.eventFired))e.visible||(n&&(this.mainWindowDisplayedChange.windowState=yield this.getWindowState(e.windowId)),this.mainWindowDisplayedChange.eventFired=!1,this.mainWindowDisplayedChange.windowId=null);else{if(!n)return;this.mainWindowDisplayedChange.windowId=e.windowId,this.tryToSendSignal()}}))}init(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.experienceChangeReportingServiceSubscription=this.experienceChangeReportingService.observeChanges().pipe((0,rS.h)((e=>e.userContextId===this.userKey))).subscribe(this.processExperienceChangeChange),this.commandChangeReportingServiceSubscription=this.commandChangeReportingService.observeChanges().pipe((0,rS.h)((e=>e.userContextId===this.userKey&&!!e.isMainWindow&&e.type===GS.B.WindowCreated&&e.context.layoutMode===c.lO.standard))).subscribe((e=>{this.mainWindowRenderedChange=e,this.tryToSendSignal()}));const t=yield this.hostComms.loadModule("windowcontrols");this.windowVisibilityChangeSubscription=null===(e=null==t?void 0:t.registerForWindowVisibilityChanged)||void 0===e?void 0:e.call(t,this.onWindowVisibilityChanged)}))}dispose(){this.experienceChangeReportingServiceSubscription&&this.experienceChangeReportingServiceSubscription.unsubscribe(),this.commandChangeReportingServiceSubscription&&this.commandChangeReportingServiceSubscription.unsubscribe(),this.windowVisibilityChangeSubscription&&this.windowVisibilityChangeSubscription()}tryToSendSignal(){if(!this.shouldSendSignal())return;const e=this.appsRegistryService.registeredApps;this.scheduler.schedule((()=>{e.forEach((e=>{e.UNSAFE_onSignal&&e.UNSAFE_onSignal({type:"main_window_rendered",userContextId:this.userKey},this.context)}))}),{id:"on-signal-job",priority:Gw.vW.Macro,scheduledById:"signal-processor"},(0,mt.v4)()),this.reset()}isMainWindowForActiveUserContext(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield(0,JT.jW)(this.context.client);return e===(null==t?void 0:t.id)&&t.userContextId===this.userKey}))}getWindowState(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostComms.loadModule("windowcontrols");return null===(t=null==n?void 0:n.getWindowState)||void 0===t?void 0:t.call(n,e)}))}shouldSendSignal(){return this.windowHasBeenCreatedAndSignalsHaveFired()||this.windowHasToggledVisibilityAndWasNotMinimizedOrRestored()}windowHasBeenCreatedAndSignalsHaveFired(){return!!this.userConsentedChange&&!!this.mainWindowRenderedChange&&!!this.layoutRenderedChange}windowHasToggledVisibilityAndWasNotMinimizedOrRestored(){return!(!this.userConsentedChange||!this.mainWindowDisplayedChange.windowId||this.mainWindowDisplayedChange.eventFired||this.windowWasMinimized())}windowWasMinimized(){var e;return!0===(null===(e=this.mainWindowDisplayedChange.windowState)||void 0===e?void 0:e.minimized)}reset(){this.mainWindowRenderedChange=void 0,this.layoutRenderedChange=void 0,this.mainWindowDisplayedChange.eventFired=!0}}class Sz extends Fe{constructor(){super(De.Yg.CreateSignalProcessor,["appsRegistryService","experienceChangeReportingService","client","coreSettings","entityCommanding","loggerFactory","platformService","scenarioFactory","scheduler","hostCommunicationService","commandChangeReportingService","authenticationUser","userBiService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appsRegistryService:t,experienceChangeReportingService:n,client:i,coreSettings:a,entityCommanding:o,loggerFactory:r,platformService:s,scenarioFactory:l,scheduler:d,hostCommunicationService:c,commandChangeReportingService:u,authenticationUser:m,userBiService:g}=e,p=new kz(n,u,t,d,c,(0,li.b)(m),{client:i,coreSettings:a,entityCommanding:o,loggerFactory:r,platformService:s,scenarioFactory:l,userBiService:g});return p.init(),()=>{p.dispose()}}))}}var bz=n(686158);class Cz extends Fe{constructor(){super(De.Yg.TelemetryContext,["loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e.loggerFactory.newLogger("CreateTelemetryContextTask");e.telemetryContextService=new bz.v(t)}))}}class wz{constructor(){this._userContextIds=new Set,this._accountModeObservable=new eS.X(oi.SingleAccount)}trackUser(e){this._userContextIds.add(e),this._accountModeObservable.next(this._userContextIds.size>1?oi.MultipleAccounts:oi.SingleAccount)}removeUser(e){this._userContextIds.delete(e),this._accountModeObservable.next(this._userContextIds.size>1?oi.MultipleAccounts:oi.SingleAccount)}getAuthenticatedUsers(){return this._userContextIds}has(e){return this._userContextIds.has(e)}getAccountMode(){return this._accountModeObservable.value}getAccountModeObservable(){return this._accountModeObservable}}class Nz extends Fe{constructor(){super(De.Yg.CreateTrackUserServiceTask,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.userTrackingService=new wz}))}}class Tz extends Fe{constructor(){super(De.Yg.CreateUserDataClient,["scenarioFactory","loggerFactory","windowProvider","coreSettings","client"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e.client)throw new Error("CreateUserDataClientTask: core data client doesn't exist, cannot initialize user client");const t=yield function(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{networkState:i,coreSettings:o,leakDetectorService:r,platformService:s,config:l,graphqlStoreStatsReporterService:d}=e,c=new eF.pS,u=(0,gE.UZ)(Me.l,i.observeIsOnline()),m=Object.assign(Object.assign({},e),{pubsub:c,send:u}),g=yx.clientResolvers;if(!g)throw new Error("Client resolvers should be created at this point");const{maxApolloResultCacheSize:p,enableViewSchema:v,enableApolloDoubleWriteFix:h}=o.get(K.J.Core),{enableApolloDevtools:f}=o.get(K.J.Diagnostics),y=null!=p?p:void 0,k=null==r?void 0:r.create(),S=(null==e?void 0:e.authenticationUser)&&(0,li.b)(e.authenticationUser),b=hV({leakDetector:k,userContextId:S,windowId:De.ew,entityType:n,viewportContext:"cmd"},void 0,g,y,e.loggerFactory,e.scenarioFactory,void 0,f,tF.t.cmd,d,h);mF(b,`mtma-cmd-${(null===(a=null==e?void 0:e.authenticationUser)||void 0===a?void 0:a.loginUserName)||"nouser"}`,Boolean(f),s,l.experienceName);const C=gV.createUserDataRequestContext(m,b),w=yield uM.createLink(Object.assign({contextValue:C},m));b.setLink(w);const N=vV(e,c,k,w,e.loggerFactory,e.scenarioFactory,g,S);let T;v&&(T=fV(e,0,k,uM.createViewSchemaLink(e),e.loggerFactory,e.scenarioFactory));const{dataOpsTracker:I,dataEvictionService:E}=t.getServices();return new bx({pubsub:c,leakDetector:k,scenarioFactory:C.scenarioFactory,coreSettings:C.coreSettings,dataOpsTracker:I,dataEvictionService:E,graphqlStoreStatsReporterService:e.graphqlStoreStatsReporterService},t,N,C,T)}))}(e,e.client,L.pyR.default);return e.client=t,e=>{switch(e){case"signout":case"quit":t.destroy()}}}))}}var Iz=n(107844),Ez=n(966490),Az=n(250570),_z=n(355272),Dz=n(953672),Fz=n(57527);const Mz="prod",Rz="general";function Pz(e,t,n){let i,a,o;if(n){const e=n.expConfigMetadata.find((e=>e.client===Fz.j)),t=n.expConfigMetadata.find((e=>e.client===Fz.t));i=null==e?void 0:e.config.eTag,a=null==t?void 0:t.config.eTag,o=n.expConfigMetadata.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(",")}else i=e.eTag||void 0,a=e.hostETag||void 0,e.configIds&&e.configIds.experiments&&(o=e.configIds.experiments.join(","));const r=function(e,t){var n;const i=e.ring&&e.ring.id||Rz;if(t)return i;const a=null===(n=e.region)||void 0===n?void 0:n.toLowerCase(),o="gcc"===a?a:e.environment||Mz;switch(o){case Mz:return i;case"gcc":return`${i}_gcc`;default:return`${o}-${i}`}}(e,t);return{ring:r,eTag:i,hostETag:a,expIds:o,environment:e.environment||void 0}}class Oz{constructor(e){this._top=-1,this._isFilled=!1,this._buffer=new Array(e),this.capacity=e}add(e){this._top=(this._top+1)%this.capacity,this._buffer[this._top]=e,this._top===this.capacity-1&&(this._isFilled=!0)}getItemFromLast(e){if(-1===this._top||e>=this.capacity||!this._isFilled&&this._top-e<0)return;const t=this._top-e>=0?this._top-e:this.capacity- -1*(this._top-e);return this._buffer[t]}}class xz{constructor(e){this.eventMarks=new Oz(e&&e>0?e:100)}markEvent(e){this.markEventOverrideTimestamp(e,Date.now())}markEventOverrideTimestamp(e,t){var n;null===(n=this.eventMarks)||void 0===n||n.add({ts:t,name:e})}getEventsBetweenStartAndLast(e){if(!this.eventMarks)return[];const t=[];let n;for(let i=1;n=this.eventMarks.getItemFromLast(i),n&&!(n.ts<e);i++)t.push(n.name);return t}getEventsBetween(e,t){if(!this.eventMarks)return[];const n=[];let i;for(let a=0;i=this.eventMarks.getItemFromLast(a),i&&!(i.ts<e);a++)i.ts<t&&n.push(i.name);return n}}function Lz(e){return new xz(e)}var Uz;!function(e){e.Action="panelaction",e.View="panelview"}(Uz||(Uz={}));class Bz{constructor(e,t=""){this.contextData=e,this.userContextId=t,this.clickStreamBatchInSeconds=75,this.clickStreamMaxBatchSize=15,this.getBatchNumber=()=>this.userBiCache.batchNumber,this.emptyCacheWithoutRestarting=()=>{this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!1,disableSetTimeout:!0})},this.addEventToUserBiCache=(e,t)=>{"panelaction"===t?(this.userBiCache.actionCount=this.userBiCache.actionCount+1,e["EventInfo.BaseType"]=Uz.Action):(this.userBiCache.viewCount=this.userBiCache.viewCount+1,e["EventInfo.BaseType"]=Uz.View),this.userBiCache.events.push(e),this.userBiCache.events.length>=this.clickStreamMaxBatchSize&&this.recordClickStreamEvent({isTimeOut:!1,isBatchSize:!0})},this.cacheClickStreamToLocalStorage=()=>{var e;this.userBiCache.events.length>0&&this.telemetrySettings.enableClickStreamUnloadCache&&(null===(e=this.contextData.localStorage)||void 0===e||e.set("clickstream_cache",JSON.stringify(this.userBiCache)))},this.setUpHostListeners=()=>{this.host.addEventListener("beforeunload",(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){this.cacheClickStreamToLocalStorage(),this.emptyCacheWithoutRestarting(),yield this.telemetryProvider.flush()}))))},this.localStorageFlush=()=>{var e,t;if(this.telemetrySettings.enableClickStreamUnloadCache){const n=null===(e=this.contextData.localStorage)||void 0===e?void 0:e.get("clickstream_cache"),i=JSON.parse(n);n&&(0,Lw.P3)(Az.x.ClickStream,"clickstream_cached",i,void 0,{columnName:"events",packedData:i.events},void 0,this.userContextId),null===(t=this.contextData.localStorage)||void 0===t||t.remove("clickstream_cache")}},this.setBatchTimeandSize=e=>{e===(Ye.Bh.Desktop||Ye.Bh.Maglev)?(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSeconds||75,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSize||15):(this.clickStreamBatchInSeconds=this.telemetrySettings.clickStreamBatchInSecondsWeb||30,this.clickStreamMaxBatchSize=this.telemetrySettings.clickStreamMaxBatchSizeWeb||5)},this.setupClickStreamTimeout=()=>this.contextData.windowProvider.setTimeout((()=>{this.recordClickStreamEvent({isTimeOut:!0,isBatchSize:!1})}),1e3*this.clickStreamBatchInSeconds),this.recordClickStreamEvent=e=>{if(this.userBiCache.actionCount>0||this.userBiCache.viewCount>0){this.userBiCache.batchFlushed=e.isBatchSize,this.userBiCache.timeoutFlushed=e.isTimeOut;const t=this.userBiCache;this.telemetrySettings.disable1DSBatching&&(t.latency=4),(0,Lw.P3)(Az.x.ClickStream,"clickstream",t,void 0,{columnName:"events",packedData:t.events},void 0,this.userContextId),this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:t.batchNumber+1,batchFlushed:!1,timeoutFlushed:!1}}this.contextData.windowProvider.clearTimeout(this.currentTimeoutId),e.disableSetTimeout||(this.currentTimeoutId=this.setupClickStreamTimeout())},this.userBiCache={events:[],batchStartTime:(new Date).toISOString(),viewCount:0,actionCount:0,batchNumber:1,batchFlushed:!1,timeoutFlushed:!1},this.telemetrySettings=this.contextData.coreSettings.get(K.J.Telemetry);const n=this.contextData.platformService.config.clientType;this.setBatchTimeandSize(n),this.currentTimeoutId=this.setupClickStreamTimeout(),this.host=this.contextData.windowProvider,this.localStorageFlush(),this.host&&this.setUpHostListeners(),this.telemetryProvider=(0,DC.G)()}}var jz=n(340487);class Wz{constructor(e,t){var n,a;if(this.context=e,this.windowId=t,this.biEventObserver=new gC.xQ,this.experimentationEventData={},this.telemetrySettings={},this.panelContextData={},this.dataBagContextData={},this.windowSlotContext={},this.userContextId="",this._dataBags=[],this.recordPanelView=(e,t,n)=>{const i=this.getCombinedDataBagData(n);this.recordBiEvent({eventName:"panelview",data:Object.assign(Object.assign(Object.assign({},this.windowSlotContext),i),$z(e))},t)},this.recordPanelAction=(e,t,n)=>{var i;const a=this.getCombinedContextData(n),o=this.getCombinedDataBagData(n);this.recordBiEvent({eventName:"panelaction",data:Object.assign(Object.assign(Object.assign({},this.windowSlotContext),o),Vz(Object.assign(Object.assign({},a),e)))},t),null===(i=this.eventTimeTracker)||void 0===i||i.markEvent(`${e.actionOutcome}-${e.actionScenario}-${e.panelType}-${e.threadType}`)},this.setBISlotContext=e=>{this.windowSlotContext=Object.assign(Object.assign({},this.windowSlotContext),e)},this.createDatabag=()=>{const e=new jz.S;return this._dataBags.push(e),e.setDispose((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield(0,zI._)(0);const t=this._dataBags.findIndex((t=>t.id===e.id));this._dataBags.splice(t,1)})))),e},this.appendBiData=(e,t)=>{const{dataBag:n}=t,a=(0,i.__rest)(t,["dataBag"]),o=zz(Da.sz,e);this.dataBagContextData[o]=Object.assign(Object.assign({},this.dataBagContextData[o]),null==n?void 0:n.data),this.panelContextData[o]=Object.assign(Object.assign({},this.panelContextData[o]),a)},this.removeBiData=(e,t)=>{var n,i;const a=zz(Da.sz,e);if(t)for(const e of t)this.dataBagContextData&&(null===(n=this.dataBagContextData[a])||void 0===n||delete n[e]),this.panelContextData&&(null===(i=this.panelContextData[a])||void 0===i||delete i[e]);else delete this.dataBagContextData[a],delete this.panelContextData[a]},this.recordTestOnlyTelemetry=()=>{var e;const t=null===(e=this.context)||void 0===e?void 0:e.coreSettings.get(K.J.Telemetry).testOnlyUserbiTelemetry;t&&this.recordPanelAction(JSON.parse(t))},(null===(n=this.context)||void 0===n?void 0:n.authenticationUser)&&(this.userContextId=this.context.authenticationUser.id),null===(a=this.context)||void 0===a?void 0:a.coreSettings){const{disableRingNamePrefixing:e}=this.context.coreSettings.get(K.J.Telemetry),{enableSmbUserIntentUserBiTelemetry:t}=this.context.coreSettings.get(K.J.Growth),{enableCallingPerfCollectorService:n,enableCallingLongTasksTracking:i,enableCallingLongTasksTriggerFinder:a}=this.context.coreSettings.get(K.J.Calling);this.includeSmbUserIntentData=Boolean(t);const o=this.context.coreSettings.getObservable(K.J.Metadata);this.metadataSubscription=o.subscribe((t=>{var n;this.experimentationEventData=function(e,t,n){const i={},a=Pz(e,t,n);return i["UserInfo.Ring"]=a.ring,i["UserInfo.ETag"]=a.eTag,i["UserInfo.HostETag"]=a.hostETag,i["AppInfo.ExpIds"]=a.expIds,i["AppInfo.Environment"]=a.environment,i}(t,!!e,null===(n=this.context)||void 0===n?void 0:n.experimentationService)})),this.environment=this.context.coreSettings.get(K.J.Metadata).environment,this.telemetrySettingsSubscription=this.context.coreSettings.getObservable(K.J.Telemetry).subscribe((e=>this.onReceiveTelemetrySettings(e))),this.clientType=this.context.platformService.config.clientType,this.clientType===Ye.Bh.Maglev&&this.windowId!==De.ew&&this.subscribeToMaglevWindowState(),n&&i&&a&&(this.eventTimeTracker=Lz()),this.context.coreSettings.get(K.J.Telemetry).enableTestOnlyTelemetry&&this.recordTestOnlyTelemetry()}}getEventsWithinTimeframe(e,t){var n;return(null===(n=this.eventTimeTracker)||void 0===n?void 0:n.getEventsBetween(e,t))||[]}getWindowId(){return this.windowId}destroy(){var e;this.metadataSubscription&&this.metadataSubscription.unsubscribe(),this.telemetrySettingsSubscription&&this.telemetrySettingsSubscription.unsubscribe(),this.clickStreamService&&this.clickStreamService.emptyCacheWithoutRestarting(),this.windowStateSubcription$&&this.windowStateSubcription$.unsubscribe(),this.unregisterForWindowStateChanged&&this.unregisterForWindowStateChanged(),(null===(e=this.smbUserIntentSubcription)||void 0===e?void 0:e.unsubscribe)&&this.smbUserIntentSubcription.unsubscribe(),this._dataBags.length&&(this._dataBags=[])}initializeAndSubscribeToSmbUserIntent(){var e,t;if(this.environment===Sb.s.life&&this.includeSmbUserIntentData&&(null===(e=this.context)||void 0===e?void 0:e.client)){const{smbUserIntentUserBiTelemetryPollInterval:e}=null===(t=this.context)||void 0===t?void 0:t.coreSettings.get(K.J.Growth),a=36e5,o=null!=e?e:a;return(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var e,t;const i=yield(0,d.mT)((()=>n.e(9342).then(n.bind(n,143298))),"services-io-data-smb-user-intent").then((e=>e.smbUserIntentDocument));this.smbUserIntentSubcription=null===(t=null===(e=this.context)||void 0===e?void 0:e.client)||void 0===t?void 0:t.watchQuery({query:i,pollInterval:Number(o),fetchPolicy:"no-cache"}).subscribe((e=>{var t;(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.smbUserIntent)&&(this.smbUserIntent=e.data.smbUserIntent)}))})))(),()=>{var e;"function"==typeof(null===(e=this.smbUserIntentSubcription)||void 0===e?void 0:e.unsubscribe)&&this.smbUserIntentSubcription.unsubscribe()}}}getDataFromBaseInstance(){var e,t,n;return{"UserInfo.SmbUserIntent.Intent":null===(e=this.smbUserIntent)||void 0===e?void 0:e.smbUserIntent,"UserInfo.SmbUserIntent.IntentScore":null===(t=this.smbUserIntent)||void 0===t?void 0:t.smbUserIntentScore,"UserInfo.SmbUserIntent.ConfidenceScore":null===(n=this.smbUserIntent)||void 0===n?void 0:n.smbConfidenceScore}}bubbleUpObservable(e){var t,n,i;this.biEventObserver.next(e),null===(i=null===(n=null===(t=this.context)||void 0===t?void 0:t.parentUserBiService)||void 0===n?void 0:n.bubbleUpObservable)||void 0===i||i.call(n,e)}observe(){return this.biEventObserver.asObservable()}onReceiveTelemetrySettings(e){this.telemetrySettings=e,this.context&&this.telemetrySettings.enableClickStreamEvents&&!this.clickStreamService&&(this.clickStreamService=new Bz({coreSettings:this.context.coreSettings,windowProvider:this.context.windowProvider,platformService:this.context.platformService,localStorage:this.context.localStorage},this.userContextId))}recordBiEvent(e,t){this._applyContextData(e),this.includeSmbUserIntentData&&this.applySmbUserIntentData(e);const n=function(e){const t={};return Object.keys(e).forEach((n=>{(0,a.isNil)(e[n])||(t[n]=e[n])})),t}(e.data),i="EventInfo.Identifier"in e.data?e.data["EventInfo.Identifier"]:void 0;if(this.telemetrySettings.enableClickStreamEvents&&this.clickStreamService){const t=(e.eventName,n);this.telemetrySettings.enableDualClickStreamEvents&&(n.batchNumber=this.clickStreamService.getBatchNumber(),(0,Lw.P3)(Az.x.UserBI,e.eventName,n,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?i:void 0,this.userContextId)),this.clickStreamService.addEventToUserBiCache(t,e.eventName)}else(0,Lw.P3)(Az.x.UserBI,e.eventName,n,void 0,void 0,this.telemetrySettings.enableUserBiEventIdentifiers?i:void 0,this.userContextId);t&&(t.debug(`Analytics: EventType: ${e.eventName}`),t.debug(`Analytics: Type: ${n["Panel.Type"]}`),t.debug("Analytics: Payload:",n)),this.bubbleUpObservable({eventName:e.eventName,data:n})}_applyContextData(e){var t,n,i,a,o,r,s,l,d,c,u;e.data["Panel.WindowID"]=this.windowId,e.data["EventInfo.CorrelationId"]=null===(n=null===(t=this.context)||void 0===t?void 0:t.correlation)||void 0===n?void 0:n.id;const m=null!==(i=this.windowIsVisible)&&void 0!==i?i:null===(a=this.context)||void 0===a?void 0:a.windowProvider.isFocused();e.data["Window.Focus"]=m?Iz.cb.foreground:Iz.cb.background;const g=m?Iz.Lv.maximized:Iz.Lv.minimized;if(e.data["Window.Status"]=g,e.data["Window.Height"]=null===(o=this.context)||void 0===o?void 0:o.windowProvider.innerHeight,e.data["Window.Width"]=null===(r=this.context)||void 0===r?void 0:r.windowProvider.innerWidth,e.data["Window.ViewportContext"]=null===(s=this.context)||void 0===s?void 0:s.windowProvider.viewportContext,null===(l=this.context)||void 0===l?void 0:l.authenticationUser){const t=this.environment===Sb.s.life?null===(d=this.context)||void 0===d?void 0:d.authenticationUser.profile.paddedMsaId:null===(c=this.context)||void 0===c?void 0:c.authenticationUser.profile.objectId;e.data["UserInfo.Id"]=t,e.data["UserInfo.TenantId"]=null===(u=this.context)||void 0===u?void 0:u.authenticationUser.profile.tenantId}e.data=Object.assign(Object.assign({},e.data),this.experimentationEventData)}getCombinedContextData(e){let t={};if(e)for(const n of e){const e=zz(Da.sz,n);t=Object.assign(Object.assign({},t),this.panelContextData[e])}return t}getCombinedDataBagData(e){let t={};if(e)for(const n of e){const e=zz(Da.sz,n);t=Object.assign(Object.assign({},t),this.dataBagContextData[e])}return t}subscribeToMaglevWindowState(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.windowControlsModule&&this.context){this.windowControlsModule=yield this.context.hostCommunicationService.loadModule("windowcontrols"),this.windowState$=new pC.y((e=>{var t;this.windowControlsModule&&this.windowControlsModule.registerForWindowStateChanged&&(this.unregisterForWindowStateChanged=null===(t=this.windowControlsModule)||void 0===t?void 0:t.registerForWindowStateChanged((t=>{if(!t.windowId||this.windowId&&t.windowId===this.windowId){const n=!t.placement.minimized;e.next(n)}})))}));const e=e=>{this.windowIsVisible=e};this.windowStateSubcription$=this.windowState$.subscribe(e)}}))}applySmbUserIntentData(e){var t,n,i,a;const o="function"==typeof(null===(n=null===(t=this.context)||void 0===t?void 0:t.parentUserBiService)||void 0===n?void 0:n.getDataFromBaseInstance)?null===(a=null===(i=this.context)||void 0===i?void 0:i.parentUserBiService)||void 0===a?void 0:a.getDataFromBaseInstance():void 0;o&&(e.data["UserInfo.SmbUserIntent.Intent"]=o["UserInfo.SmbUserIntent.Intent"],e.data["UserInfo.SmbUserIntent.IntentScore"]=o["UserInfo.SmbUserIntent.IntentScore"],e.data["UserInfo.SmbUserIntent.ConfidenceScore"]=o["UserInfo.SmbUserIntent.ConfidenceScore"])}}function Vz(e){const{appName:t,actionGesture:n,actionOutcome:i,actionOutcomeNew:o,actionScenario:r,actionScenarioType:s,actionWorkload:l,actionSubworkload:d,actionInputDelay:c,moduleName:u,moduleNameNew:m,moduleType:g,moduleTypeNew:p,extensibilityData:v,tabId:h,tabIdNew:f,tabOrdinal:y,tabType:k,tabTypeNew:S,callId:b,eventIdentifier:C,appId:w,appIsTenantApp:N,appCapabilityId:T,appScenarioCapability:I,appScope:E}=e,A=zz(Da.rA,u),_=zz(Da.PO,g),D=zz(Da.uS,n),F=zz(Da.Tk,r),M=(0,a.isNil)(C)?[A,_,D,F].filter(Boolean).join("_"):zz(Da.b6,C),R=Object.assign(Object.assign({"Action.Gesture":n,"Action.Outcome":i,"Action.OutcomeNew":o,"Action.Scenario":r,"Action.ScenarioType":s,"Action.WorkLoad":l,"Action.SubWorkLoad":d,"Module.Name":u,"Module.Type":g,"Module.NameNew":m,"Module.TypeNew":p,"Tab.Id":h,"Tab.Type":k,"Tab.IdNew":f,"Tab.TypeNew":S,"Tab.Ordinal":y,"App.Name":t,"App.Id":w,"App.IsTenantApp":N,"App.CapabilityId":T,"App.ScenarioCapability":I,"App.Scope":E,"Call.Id":b},$z(e)),Hz(v));return(0,a.isNil)(M)||(R["EventInfo.Identifier"]=M),(0,a.isNil)(c)||(R["Action.InputDelay"]=c),R}function Hz(e){if(e&&!(0,a.isEmpty)(e))return{"App.Id":e.id,"App.Name":e.name,"App.Scope":zz(_z.Mv,e.scope),"App.ScenarioCapability":zz(_z.Ky,e.scenarioCapability),"App.EntryPoint":zz(_z.sG,e.entryPoint),"App.ExternalId":e.externalId,"App.IsTenantApp":e.isTenantApp,"App.CapabilityId":e.capabilityId,"App.SceneId":e.sceneId,"Bot.Id":e.botId,"App.MsftPartnerAppID":e.mpnId,"App.Source":zz(Dz.RE,e.appDetailsEntryPoint),"App.FromSectionName":e.fromSectionName,"App.Capabilities":e.capabilities,"App.BotScopes":e.botScopes,"App.GalleryTabScopes":e.galleryTabScopes,"App.StaticTabScopes":e.staticTabScopes,"App.StaticTabName":e.staticTabName,"App.ConnectorScopes":e.connectorScopes,"App.ConnectorId":e.connectorId,"App.Version":e.version,"App.ManifestVersion":e.manifestVersion,"App.Categories":e.categories,"App.IsHostedApp":e.isHostedApp}}function $z(e){const{panelRegion:t,panelRegionNew:n,panelType:i,panelTypeNew:o,threadId:r,teamId:s,threadMembers:l,threadType:d,panelLaunchMethod:c,panelUri:u,dataBag:m,extensibilityData:g,eventIdentifier:p,entityType:v,mainSlotApp:h,mainEntityType:f,mainEntityAction:y}=e,k=zz(Da.Ai,t),S=zz(Da.wh,i),b=(0,a.isNil)(p)?[k,S].filter(Boolean).join("_"):zz(Da.b6,p);return Object.assign(Object.assign(Object.assign({"Panel.LaunchMethod":c,"Panel.Region":t,"Panel.Type":i,"Panel.RegionNew":n,"Panel.TypeNew":o,"Panel.Uri":u,"Thread.Id":r,"Team.Id":s,"Thread.Type":d,"Thread.Members":l,"TargetThread.Id":r,"TargetThread.Type":d,"EventInfo.Identifier":b,"Entity.Type":v},m&&m.data),Hz(g)),{"UserInfo.ChannelResourceTenant.Id":e["UserInfo.ChannelResourceTenant.Id"],"SlotConfig.MainSlotApp":h,"SlotConfig.MainEntityType":f,"SlotConfig.MainEntityAction":y})}function zz(e,t){return(0,a.isNil)(t)?void 0:e[t]}class Gz{create(e,t,n,i,a,o){const r=new hS.m(i),s=new Ez.J(Object.assign(Object.assign({},e),{loggerFactory:r}),n,a,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,o),l=new Wz(t),d=new bz.v(r.newLogger("SetUserOnTelemetryContextTask"),o),c={coreScenarioFactory:s,userBiService:l,loggerFactory:r,telemetryContext:d,telemetryService:new qz(s,d,a)};return Gz._cache.set(o,c),c}destroy(e){var t,n,i,a;if(e){const o=Gz._cache.get(e);o&&(null===(n=(t=o.coreScenarioFactory).destroy)||void 0===n||n.call(t),null===(a=(i=o.userBiService).destroy)||void 0===a||a.call(i),Gz._cache.delete(e))}}get(e){let t;return e&&(t=Gz._cache.get(e)),t}clear(){Gz._cache.clear()}}Gz._cache=new Map;class qz{constructor(e,t,n){this.coreScenarioFactory=e,this.coreTelemetryContext=t,this.memoryAnalyzer=n,this.newCoreScenario=(e,t)=>this.coreScenarioFactory.newScenario(e,t),this.stopCoreScenarioIfActive=(e,t,n)=>this.coreScenarioFactory.stopScenarioIfActive(e,t,n),this.createScenarioFactory=(e,t,n,i,a,o="")=>{const{coreSettings:r}=e,{enableCreateWindowLaunchScenarioOnMainWindow:s}=r.get(K.J.Core);return new Ez.J({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:n},parseInt(n.startTimestamp,10)||Date.now(),this.memoryAnalyzer,t,i,this.coreInitTimestamp,!!s||t!==De.ew,void 0,void 0,void 0,{"Window.ViewportContext":a},o||this.coreTelemetryContext.userId)},this.createUserBiService=(e,t,n)=>new Wz({authenticationUser:e.authenticationUser,coreSettings:e.coreSettings,windowProvider:e.windowProvider,platformService:e.platformService,experimentationService:e.experimentationService,hostCommunicationService:e.hostCommunicationService,client:e.client,localStorage:e.localStorage,parentUserBiService:e.userBiService,correlation:n},t),this.setCoreContext=(e,t,n)=>{this.coreTelemetryContext.setContext(e,t,n)},this.setContext=(e,t,n,i="")=>{this.coreTelemetryContext.setContext(e,t,n,i)},this.setDeviceAuthToken=e=>{this.coreTelemetryContext.setDeviceAuthToken(e)},this.setUserId=e=>{this.coreTelemetryContext.setUserId(e)},this.getTelemetryContextService=()=>this.coreTelemetryContext,this.setTelemetryContextService=e=>{this.coreTelemetryContext=e},this.logOutUser=e=>{(0,DC.G)().logOutUser(e)},qz._telemetryServicesCache||(qz._telemetryServicesCache=new Gz)}getMemoryAnaylzer(){return this.memoryAnalyzer}setCoreInitTime(e){var t,n;this.coreInitTimestamp=e,null===(n=(t=this.coreScenarioFactory).setCoreInitTime)||void 0===n||n.call(t,e)}getTelemetryServicesCache(){return qz._telemetryServicesCache}}class Qz extends Fe{constructor(){super(De.Yg.SetUserOnTelemetryContext,["telemetryService","authenticationUser","coreSettings","loggerFactory","diagnosticsService","config","correlation","authenticationService","telemetryContextService","windowProvider","hostCommunicationService","platformService","scenarioFactory"])}execute(e){var t,n,a,o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:s,coreSettings:l,loggerFactory:d,authenticationService:c,correlation:u,telemetryContextService:m,telemetryService:g}=e,p=d.newLogger("SetUserOnTelemetryContextTask");let v;if(l.get(K.J.Telemetry).useTelemetryServicesCache&&(v=g.getTelemetryServicesCache().get(s.id)),v)e.loggerFactory=v.loggerFactory,e.scenarioFactory=v.coreScenarioFactory,e.telemetryService=v.telemetryService,e.userBiService=v.userBiService,e.telemetryContextService=v.telemetryContext;else{const i=s.type===XT.Ch.MsaLife||l.get(K.J.Metadata).environment===Sb.s.life,a=new bz.v(p,s.id);e.loggerFactory=new hS.m(e.diagnosticsService,e.correlation.id,s.id);const o=new Ez.J({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:e.correlation},e.config.startTimeMS,null===(t=e.telemetryService)||void 0===t?void 0:t.getMemoryAnaylzer(),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,s.id);e.scenarioFactory=o,e.telemetryService=new qz(o,a,null===(n=e.telemetryService)||void 0===n?void 0:n.getMemoryAnaylzer()),i&&(s.profile.paddedMsaId=this.getPaddedMsaId(s.profile.objectId,p)),this.setAuthUserOnTelemetryContext(e.telemetryService,s,i)}const h=this.subscribeAndSetUserInfoTelemetryContext(e.telemetryService,s,l),f=null!==(a=l.get(K.J.Telemetry).disableMTMAPrimaryId)&&void 0!==a&&a;iN(f,m,c,u,p),null===(r=(o=e.authenticationService).registerEndTelemetryTask)||void 0===r||r.call(o,(e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t;g.setContext("UserInfo.IsMRU",void 0,void 0,e),h.unsubscribe();try{yield iN(f,m,c,u,p)}catch(e){null===(t=p.errorToTelemetry)||void 0===t||t.call(p,"Failed to update MRU or sync mtma context","telemetry_instrumentation_update_user_context")}yield(0,DC.G)().flush(),(0,DC.G)().logOutUser(e),l.get(K.J.Telemetry).useTelemetryServicesCache&&g.getTelemetryServicesCache().destroy(e)}))))}))}subscribeAndSetUserInfoTelemetryContext(e,t,n){return n.getObservable(K.J.UserResources).subscribe((n=>{const i=n.licenseType||void 0;switch(i&&e.setContext("UserInfo.LicenseType",i),t.role){case XT.w4.Member:n.isTenantAdmin||void 0?e.setContext("UserInfo.TenantRole",Iz.z7.Admin):e.setContext("UserInfo.TenantRole",Iz.z7.Regular);break;case XT.w4.Guest:e.setContext("UserInfo.TenantRole",Iz.z7.Guest);break;case XT.w4.Anonymous:e.setContext("UserInfo.TenantRole",Iz.z7.Anonymous)}}))}setAuthUserOnTelemetryContext(e,t,n){n&&t.profile.paddedMsaId&&this.setUserContext(e,t.profile.paddedMsaId);const i=n&&t.profile.paddedMsaId?t.profile.paddedMsaId:t.profile.objectId;e.setContext("UserInfo.Id",i),e.setContext("UserInfo.TenantId",t.profile.tenantId),e.setContext("UserInfo.Type",t.type),e.setContext("UserInfo.Role",t.role)}setUserContext(e,t){const n=t.slice(19).replace("-","");e.setUserId(t),e.setContext("UserInfo.Id",t),e.setContext("userId",n)}getPaddedMsaId(e,t){try{if(/(\w{8})-(\w{4})-(\w{4})-(\w{4})-(\w{12})/.exec(e)&&e.startsWith("00000000-0000-0000-"))return e;{const t=(0,a.padStart)(e,32,"0"),n=/(\w{8})(\w{4})(\w{4})(\w{4})(\w{12})/;return t.replace(n,"$1-$2-$3-$4-$5")}}catch(e){return void t.error("failed_user_padding")}}}class Jz extends Fe{constructor(){super(De.Yg.CreateUserTelemetryServicesTask,["telemetryService","authenticationUser","diagnosticsService","coreSettings","loggerFactory","windowProvider","correlation","platformService","experimentationService","hostCommunicationService","client","scenarioFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,diagnosticsService:n,telemetryService:i,coreSettings:a,loggerFactory:o,windowProvider:r,correlation:s,platformService:l,experimentationService:d,hostCommunicationService:c,client:u,scenarioFactory:m}=e;a.get(K.J.Telemetry).useTelemetryServicesCache&&!i.getTelemetryServicesCache().get(t.id)&&i.getTelemetryServicesCache().create({coreSettings:a,loggerFactory:o,windowProvider:r,correlation:s,parentScenarioFactory:m},{authenticationUser:t,coreSettings:a,windowProvider:r,platformService:l,experimentationService:d,hostCommunicationService:c,client:u},Date.now(),n,i.getMemoryAnaylzer(),t.id)}))}}const Yz="serviceWorkerDeferInstallDurationInMs",Kz="enableServiceWorkerIntegrityCheck",Zz="enableServiceWorkerDynamicManifest",Xz="localeSettingValue",eG="environment",tG="clientType",nG="swHandleCdlHashRoute",iG="platformId",aG="teams-service-worker-telemetry-v2",oG="1",rG="LogEvents",sG="timestamp",lG="teams-service-worker-v2",dG="2",cG="SwState",uG="key";var mG,gG,pG,vG;!function(e){e.Install="install",e.Activate="activate",e.Fetch="fetch"}(mG||(mG={})),function(e){e.Intermediate="intermediate",e.Old="old"}(gG||(gG={})),function(e){e.Info="sw_info",e.InstallSuccess="sw_install_success",e.InstallFailure="sw_install_failure",e.ActivateSuccess="sw_activate_success",e.ActivateFailure="sw_activate_failure",e.FetchCacheMiss="sw_fetch_cache_miss",e.CleanupCacheSuccess="sw_cleanup_cache_success",e.CleanupCacheFailure="sw_cleanup_cache_failure",e.CleanupCacheRetry="sw_cleanup_cache_retry",e.CleanupNotRun="sw_cleanup_cache_not_run",e.CleanupNotRequired="sw_cleanup_cache_not_required",e.CorruptCache="sw_corrupt_cache",e.CorruptCacheDeleteSuccess="sw_corrupt_cache_delete_success",e.CorruptCacheDeleteFailure="sw_corrupt_cache_delete_failure",e.DeferInstallStarted="sw_install_defer_started",e.DeferInstallCancelled="sw_install_defer_cancelled",e.DeferInstallCancelledOnMaxIncomplete="sw_install_defer_cancelled_max_incomplete",e.DeferInstallOldCacheCleanupInProgress="sw_install_defer_old_cache_cleanup_inprogress",e.DeferInstallTimerCompleted="sw_install_defer_timer_completed",e.DeferInstallRetryAttempted="sw_install_defer_retry",e.ResetInstallIncompleteCounterFailure="sw_install_reset_counter_failure",e.ResetCacheCleanupStateFailure="sw_reset_cache_cleanup_state_failure",e.InstallIntegrityCheckPerformed="sw_install_integrity_check_performed",e.ReadIndexedDbFailure="sw_read_indexeddb_failure",e.AssetSetGenerationFailure="sw_asset_set_generation_failure",e.WriteIndexedDbFailure="sw_write_indexeddb_failure",e.FetchSWAssetsUsingSendMessage="sw_fetch_assets_using_send_message"}(pG||(pG={})),function(e){e.Start="start",e.Success="success",e.Failure="failure",e.CacheMiss="cache_miss",e.HighLatency="high_latency",e.CDNAssetNotInManifest="cdn_asset_not_in_manifest",e.OfflineAssetStart="offline_asset_start",e.OfflineAssetSuccess="offline_asset_success",e.OfflineAssetFailure="offline_asset_failure",e.OfflineAssetCacheMiss="offline_asset_cache_miss"}(vG||(vG={}));const hG=3e5,fG=18e4,yG=72e5,kG="serviceWorkerCheckingForUpdates",SG="serviceWorkerUnregisterSuccess",bG="serviceWorkerUnregisterFailure",CG="serviceWorkerMaxUpdateFailureCountReached",wG="serviceWorkerRegistrationNotFound",NG=5,TG="fundamentals_performance_sw_fetch",IG="fundamentals_performance_sw_offline_fetch";var EG=n(912206);class AG{constructor(e){var t,n,i,a,o;this.context=e,this.fetchTelemetryStore=new Map,this.swEnableIntegrityCheck=!1,this.isSwInstalling=!1,this.isSwWaiting=!1,this.serviceWorkerUpdateFailureCount=0,this.basePath=this.context.config.basePath,this.loggerFactory=this.context.loggerFactory,this.logger=this.loggerFactory.newLogger("WebClientUpdateService"),this.rebootService=this.context.rebootService,this.host=this.context.windowProvider,this.scenarioFactory=this.context.scenarioFactory,this.coreSecurityService=this.context.coreSecurityService;try{this.swRegisterUrlPolicy=this.coreSecurityService.getTrustedTypePolicy("@msteams/services-io-browser-web-client-update#register-service-worker"),this.trustedScriptUrl=null===(t=this.swRegisterUrlPolicy)||void 0===t?void 0:t.createScriptURL(`/${this.basePath}/serviceworker.js`,this.host.location.origin)}catch(e){e instanceof fD.Y&&Ae.G.isFunction(e.toTelemetryEntry)?null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,e.toTelemetryEntry(),"fundamental_performance_trusted_sw_scripturl"):null===(o=(a=this.logger).errorToTelemetry)||void 0===o||o.call(a,"create register service worker url trustedtype policy failed",e)}this.enableSWSubscription=this.context.coreSettings.getObservable(K.J.Core).subscribe((e=>{this.registerOrUnregisterServiceWorker(!!e.enableServiceWorker)}))}cleanup(){this.enableSWSubscription.unsubscribe(),this.clearTimer()}checkForUpdateAndRestartWebClient(){this.configureServiceWorkerEvents(),this.addUpdateServiceWorkerSettings(!0),this.registerAndCheckForServiceWorkerUpdates()}sendMessageToServiceWorker(e,t){return new Promise(((n,i)=>{const a=new MessageChannel;a.port1.onmessage=e=>{e.data.error?i(e.data.error):n(e.data)},e.postMessage(t,[a.port2])}))}handleOnStateChange(e,t,n,i){switch(this.sendServiceWorkerLifeCycleEventTelemetry(),t){case"installed":this.logger.log("Service worker got installed"),this.handleInstalledSWState(i);break;case"activated":this.logger.log("Service worker got activated"),this.isSwWaiting=!1,this.setServiceWorkerContextForScenarios(!0);case"redundant":this.handleRedundantSWState(e,n)}e={state:t}}SendIncompleteEvent(e,t){this.fetchTelemetryStore.set(e.url,e),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(t)}setServiceWorkerContextForScenarios(e=!1){e?this.setScenarioContext(e):this.getServiceWorkerRegistration().then((e=>{this.setScenarioContext(!!e)}))}unregisterServiceWorker(e){"serviceWorker"in this.host.navigator&&(this.getServiceWorkerRegistration().then((t=>{t&&t.unregister().then((t=>{this.logger.log(SG,e)}))})).catch((e=>{this.logger.error(bG,e)})),this.deleteCacheStorage(e),this.clearTimer())}handleRedundantSWState(e,t){"installing"===e.state?(this.isSwInstalling=!1,this.scenarioFactory.markStep(ft.RG.SwStateChange,ft.ck.SwInstallFailure),t.fail(),this.serviceWorkerUpdateFailureCount++,this.triggerForceUpdate()):"installed"===e.state&&(this.isSwWaiting=!1),this.setServiceWorkerContextForScenarios(!0)}triggerForceUpdate(){this.serviceWorkerUpdateFailureCount>=NG&&(this.logger.error("Will force an update when the app is idle as SW update failed repeatedly with",CG),this.handleUpdateReady())}handleInstalledSWState(e){this.isSwInstalling=!1,this.isSwWaiting=!0,this.setServiceWorkerContextForScenarios(!0),this.scenarioFactory.markStep(ft.RG.SwStateChange,ft.ck.SwInstalled),"storage"in this.host.navigator&&"estimate"in this.host.navigator.storage&&this.host.navigator.storage.estimate().then((e=>{var t,n;const i=e.usageDetails,a={storageUsage:e.usage,storageQuota:e.quota,cacheStorageSize:null==i?void 0:i.caches,indexedDBSize:null==i?void 0:i.indexedDB,swRegSize:null==i?void 0:i.serviceWorkerRegistrations};null===(n=(t=this.logger).infoToTelemetry)||void 0===n||n.call(t,"Teams disk footprint","fundamentals_performance_user_storage_info",a)})),this.scenarioFactory.stopScenarioIfActive(ft.RG.SwStateChange),e||this.handleUpdateReady(),this.serviceWorkerUpdateFailureCount=0}logServiceWorkerTelemetry(){this.sendServiceWorkerFetchEventTelemetry(),this.recurringSendSWFetchEventTelemetryInterval=this.host.setInterval(this.sendServiceWorkerFetchEventTelemetry.bind(this),hG),this.sendServiceWorkerLifeCycleEventTelemetry()}sendServiceWorkerLifeCycleEventTelemetry(){const e=parseInt(oG,10);(0,EG.q8)(aG,e,rG,sG,this.scenarioFactory,!0).then((e=>{var t;if(void 0!==e){let n=0;const i=null!==(t=this.recentProcessedLifeCycleEventTimestamp)&&void 0!==t?t:-1;e.map((e=>{var t;const a=null!==(t=e.timestamp)&&void 0!==t?t:0;a>i&&(this.sendServiceWorkerLifeInfoAndInstallTelemetry(e),n=Math.max(n,a))})),this.recentProcessedLifeCycleEventTimestamp=n}})).catch((e=>{this.logger.error("Error fetching service worker state telemetry. Error:",e)})).then((()=>(0,EG.dR)(aG,e,rG,sG,this.scenarioFactory).catch((e=>{this.logger.error("Error deleting service worker state telemetry. Error:",e)}))))}sendServiceWorkerLifeInfoAndInstallTelemetry(e){var t,n,i,a,o,r,s,l,d,c;const u={message:e.message,version:e.version,type:e.type};switch(e.type){case pG.InstallSuccess:null===(n=(t=this.logger).infoToTelemetry)||void 0===n||n.call(t,"success","fundamentals_performance_sw_install",u);break;case pG.InstallFailure:null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,"failure","fundamentals_performance_sw_install",u);break;case pG.ActivateSuccess:null===(r=(o=this.logger).infoToTelemetry)||void 0===r||r.call(o,"success","fundamentals_performance_sw_activate",u);break;case pG.ActivateFailure:null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,"failure","fundamentals_performance_sw_activate",u);break;default:null===(c=(d=this.logger).infoToTelemetry)||void 0===c||c.call(d,"success","fundamentals_performance_sw_state_info",u)}}registerServiceWorker(){const{enableTrustedSWScriptUrl:e}=this.context.coreSettings.get(K.J.Core),t=e&&this.trustedScriptUrl?this.trustedScriptUrl:`/${this.basePath}/serviceworker.js`,n=this.scenarioFactory.newScenario(ft.RG.SwRegistration);this.host.navigator.serviceWorker.register(t,{updateViaCache:"all"}).then((e=>{n.stop(),this.attachEventsToInstallingServiceWorker(e,!0)})).catch((e=>{n.fail({message:`Error: ${e}`})}))}handleUpdateReady(){this.skipWaitingServiceWorkerIfNeeded(),this.rebootService.rebootWhenLongInactive(ET.Z.AppUpdatedUsingServiceWorker,ET.d.WebClientUpdateService)}deleteCacheStorage(e){if(void 0!==this.host.caches){const t=this.scenarioFactory.newScenario(ft.RG.SwCleanupSwCache);this.host.caches.delete(De.eL).then((n=>{n?t.stop({reason:e}):t.fail({reason:"cache not found"})}))}}registerAndCheckForServiceWorkerUpdates(){this.getServiceWorkerRegistration().then((e=>{e?(this.logger.log(kG),e.update()):(this.logger.log(wG),this.registerServiceWorker())})).catch((e=>{this.logger.error(`Error getting Service Worker registration object: ${e}`)}))}configureServiceWorkerEvents(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e?(this.attachEventsToInstallingServiceWorker(e),e.onupdatefound=()=>{this.attachEventsToInstallingServiceWorker(e)}):this.logger.log(wG)}))}registerServiceWorkerAndLogTelemetry(){this.addUpdateServiceWorkerSettings(),this.registerServiceWorker(),this.logServiceWorkerTelemetry()}addUpdateServiceWorkerSettings(e=!1){var t,n;const i=[],{serviceWorkerDeferInstallDurationInMs:a,enableServiceWorkerDynamicManifest:o,handleCdlHashRouteInServiceWorkerInstall:r,enableServiceWorkerIntegrityCheck:s}=this.context.coreSettings.get(K.J.Core);a&&Number.isInteger(a)&&this.swDeferInstallDurationInMs!==a&&(this.swDeferInstallDurationInMs=a,i.push({key:Yz,value:this.swDeferInstallDurationInMs})),this.swEnableDynamicManifest!==o&&(this.swEnableDynamicManifest=null!=o&&o,i.push({key:Zz,value:this.swEnableDynamicManifest})),this.swEnableIntegrityCheck!==s&&(this.swEnableIntegrityCheck=null!=s&&s,i.push({key:Kz,value:this.swEnableIntegrityCheck})),this.swhandleCdlHashRoute!==r&&(this.swhandleCdlHashRoute=null!=r&&r,i.push({key:nG,value:this.swhandleCdlHashRoute}));const l=null!==(n=null===(t=this.context.i18NextWrapper)||void 0===t?void 0:t.locale)&&void 0!==n?n:"en-us";if(this.localeSetting!==l&&(this.localeSetting=l,i.push({key:Xz,value:this.localeSetting})),!e){i.push({key:eG,value:this.context.platformService.ecsOverrides.environment.toString()});const e=this.context.platformService.config.clientType===Ye.Bh.Maglev?"desktop":this.context.platformService.config.clientType.toString();i.push({key:tG,value:e})}i.push({key:iG,value:this.context.platformService.config.platformId.toString()}),i.length&&this.writeSettingsInServiceWorkerDb(i)}writeSettingsInServiceWorkerDb(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=parseInt(dG,10);yield(0,EG.Zl)(lG,t,cG,uG,e,this.scenarioFactory).then((()=>{this.logger.log("Successfully updated service worker settings in Indexed DB")})).catch((e=>{this.logger.error("Error updating service worker settings in Indexed DB. Error:",e)}))}))}sendServiceWorkerFetchEventTelemetry(){this.host.navigator.serviceWorker.controller&&this.sendMessageToServiceWorker(this.host.navigator.serviceWorker.controller,"getFetchTelemetryEvents").then((e=>{e.forEach((e=>{this.sendServiceWorkerFetchEventTelemetryCompletedEvent(e)}))})).catch((e=>{this.logger.error("Error getting service worker fetch telemetry. Error:",e)})),this.sendServiceWorkerFetchEventTelemetryInCompleteEvent(hG)}sendServiceWorkerFetchEventTelemetryInCompleteEvent(e){const t=Date.now();this.fetchTelemetryStore.forEach(((n,i)=>{if(void 0===e||t-n.timestamp>e){const e={endpointUrl:n.url,fetchTelemetryEventDelta:t-n.timestamp,operationType:n.type,version:n.version,message:n.message},a=n.type===vG.OfflineAssetStart?ft.RG.SwOfflineAssetFetchEvent:ft.RG.SwFetchEvent;this.scenarioFactory.newScenario(a).cancel(e),this.fetchTelemetryStore.delete(i)}}))}sendServiceWorkerFetchEventTelemetryCompletedEvent(e){const t={endpointUrl:e.url,operationType:e.type,message:e.message,version:e.version};if(this.captureFetchEvent(e,t)){const n=this.isOfflineFetchOperation(e.type)?IG:TG;this.sendFetchEvent(n,e.type,t)}}isOfflineFetchOperation(e){let t;switch(e){case vG.OfflineAssetSuccess:case vG.OfflineAssetFailure:case vG.OfflineAssetCacheMiss:t=!0;break;default:t=!1}return t}sendFetchEvent(e,t,n){var i,a,o,r,s,l,d,c;const u=n.message||"";switch(t){case vG.Success:case vG.OfflineAssetSuccess:null===(a=(i=this.logger).infoToTelemetry)||void 0===a||a.call(i,u,e,n);break;case vG.CacheMiss:case vG.OfflineAssetCacheMiss:null===(r=(o=this.logger).warnToTelemetry)||void 0===r||r.call(o,u,e,n);break;case vG.Failure:case vG.OfflineAssetFailure:null===(l=(s=this.logger).errorToTelemetry)||void 0===l||l.call(s,u,e,n);break;default:null===(c=(d=this.logger).debugToTelemetry)||void 0===c||c.call(d,u,e,n)}}captureFetchEvent(e,t){switch(e.type){case vG.Start:case vG.OfflineAssetStart:return this.fetchTelemetryStore.set(e.url,e),!1;case vG.Failure:case vG.Success:case vG.OfflineAssetFailure:case vG.OfflineAssetSuccess:case vG.CDNAssetNotInManifest:case vG.CacheMiss:case vG.OfflineAssetCacheMiss:const n=this.fetchTelemetryStore.get(e.url);return n?(t.fetchTelemetryEventDelta=e.timestamp-n.timestamp,this.fetchTelemetryStore.delete(e.url)):t.reason="orphan",!0;case void 0:return this.logger.error("unexpected fetch event type:",e.type),!1}return!1}clearTimer(){this.host.clearInterval(this.recurringCheckForUpdateInterval),this.host.clearTimeout(this.registerSWAndLogTelemetryTimer),this.host.clearInterval(this.recurringSendSWFetchEventTelemetryInterval)}registerOrUnregisterServiceWorker(e){if(e){if(!this.recurringCheckForUpdateInterval){this.recurringCheckForUpdateInterval=this.host.setInterval((()=>this.checkForUpdateAndRestartWebClient()),yG);const{serviceWorkerRegistrationDelayInMs:e}=this.context.coreSettings.get(K.J.Core),t=e&&Number.isInteger(e)?e:fG;this.registerSWAndLogTelemetryTimer=this.host.setTimeout((()=>this.registerServiceWorkerAndLogTelemetry()),t)}}else this.unregisterServiceWorker("Service Worker is not enabled");this.setServiceWorkerContextForScenarios()}setScenarioContext(e){var t,n;null===(n=(t=this.scenarioFactory).setContext)||void 0===n||n.call(t,{isServiceWorkerRegistered:e,isServiceWorkerActive:(0,xH.K4)(this.host),isServiceWorkerInstalling:this.isSwInstalling,isServiceWorkerWaiting:this.isSwWaiting})}attachEventsToInstallingServiceWorker(e,t=!1){if(!e||!e.installing)return;const n=this.scenarioFactory.newScenario(ft.RG.SwStateChange);this.scenarioFactory.markStep(ft.RG.SwStateChange,ft.ck.SwInstalling);const i=e.installing,a={state:i.state};this.isSwInstalling=!0,this.setServiceWorkerContextForScenarios(!0),i.onstatechange=()=>this.handleOnStateChange(a,i.state,n,t)}skipWaitingServiceWorkerIfNeeded(){"serviceWorker"in this.host.navigator&&this.getServiceWorkerRegistration().then((e=>{e&&e.waiting&&e.waiting.postMessage("skipWaiting")}))}getServiceWorkerRegistration(){return this.host.navigator.serviceWorker.getRegistration(`/${this.basePath}/serviceworker.js`)}}class _G extends Fe{constructor(){super(De.Yg.CreateWebClientUpdate,["coreSettings"])}execute(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){t.webClientUpdateService=new AG(e);const{isUnRegisterSWOnLogoutEnabled:n}=e.coreSettings.get(K.J.Core);if(n)return e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"signout":yield t.webClientUpdateService.unregisterServiceWorker(e);break;default:return}}))}))}}var DG=n(493093);class FG extends Fe{constructor(){super(De.Yg.CreateWindow,["config","diagnosticsService","logsCollectorService"]),this.registerShellHandlers=(e,t,n)=>{e.opener.addEventListener(vb.rY.GetLogs,(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield t.getDiagnosticsEvents(),a=yield n.getSystemInfo();let o="System Info: ";a&&a.size>0?a.forEach(((e,t)=>{o+=`${t}: ${e}\n`})):o+="No system info collected",i.unshift({message:`${o}`,level:xw.i.Debug,levelName:xw.i[xw.i.Debug],timeStamp:new Date,isPiiFree:!0}),e.opener.postMessage(vb.rY.GetLogs,{logs:i})}))))}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=DG.n.getInstance(),n=t.config.hostedWindowContext,i=t.window;t.opt={postMessageConfig:e.config.postMessageConfig},i.onAppStart();const{diagnosticsService:a,logsCollectorService:o}=e;this.registerShellHandlers(i,a,o),e.hostedWindowContext=n,e.windowProvider=i}))}}class MG extends Fe{constructor(){super(De.Yg.DisableExperience,["platformService","coreSettings","loggerFactory"])}execute(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{platformService:n,coreSettings:i,loggerFactory:a}=e,o=null===(t=n.config)||void 0===t?void 0:t.browser,{supportedBrowsers:r}=i.get(K.J.Core);if(o&&r){if(!!!(null==r?void 0:r.find((e=>e===o))))throw(0,Mn.Tr)(De.w5.Core,De.jK.Disabled,"DisableUnsupportedBrowsersTask",void 0,`Browser "${o}" is not supported.`)}else o||a.newLogger("DisableUnsupportedBrowsersTask").warn("Unable to detect Browser.")}))}}class RG extends Fe{constructor(){super(De.Yg.DiscoverUser,["discover"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.user=yield e.discover.getUser()}))}}class PG extends Fe{constructor(){super(De.Yg.FetchCriticalDynamicImportsTask,["criticalDynamicImports","loggerFactory","scenarioFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{criticalDynamicImports:t,loggerFactory:n,scenarioFactory:i}=e;t&&0!==t.length&&t.forEach((({importFunc:e,chunkName:t})=>{(0,d.mT)(e,t,i).catch((e=>{var i,a;return null===(a=(i=n.newLogger("FetchCriticalDynamicImportsTask")).errorToTelemetry)||void 0===a?void 0:a.call(i,`Failed to preload chunk ${t} this will regress performance of first load: ${e}`,"webclient_framework_foundation_core_services_tasks",void 0,!0)}))}))}))}}class OG extends Fe{constructor(){super(De.Yg.InitApiServiceProvider,["coreSettingsContext"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield e.coreSettingsContext.initializeApiServiceProvider()}))}}class xG extends Fe{constructor(){super(De.Yg.InitAsyncMediaAuthService,["mediaAuthService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{mediaAuthService:t}=e;return t.initAsyncMediaAuthService(),e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"signout":yield t.logout();break;default:return}}))}))}}var LG=n(987947);class UG extends Fe{constructor(){super(De.Yg.InitATPPolicyTask,["authenticationService","coreSettings","gtmRegistry","scenarioFactory","localStorage","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:t,coreSettings:n,gtmRegistry:i,scenarioFactory:a,localStorage:o,loggerFactory:r}=e,{enableFastSharepointSafelinks:s}=n.get(K.J.Messaging),l=r.newLogger("InitATPPolicyTask");if(!(null==s?void 0:s.enabled))return void l.log("InitATPPolicyTask - Do nothing, FF is disabled");const d=new LG.c(i.bind(Me.l,Lr.Pn.middleTier),t,n,a,r,o);l.log("Getting ATP Safelinks policy"),d.initPolicy()}))}}const BG={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"removeAuthenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeAuthenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reason"},value:{kind:"Variable",name:{kind:"Name",value:"reason"}}}]}]}}]};let jG;class WG{constructor(e,t,n,i,a,o,r,s){var l,d;this._auth=e,this._client=t,this._discover=n,this._networkStateProvider=i,this._windowProvider=o,this._keepTokenActive=!1,this._keepCheckingSignInRestrictions=!1,this._isLoginRequired=void 0,this._tokenIntervalId=void 0,this._logger=r.newLogger("AuthTokenStoreService"),this._mtResourceKey=(null===(l=null==s?void 0:s.get(K.J.Auth))||void 0===l?void 0:l.mtResource)||UC.ej.MT_AAD_KEY,this._tokenWarmingIntervalInMs=(null===(d=null==s?void 0:s.get(K.J.Auth))||void 0===d?void 0:d.tokenWarmingIntervalInMs)||Qo.lP.MT_TOKEN_INTERVAL,this._subscriptions=new Map,this.observeIsLoginRequired(),this.observeAppOnlineState()}observe(e){let t=this._subscriptions.get(e);return t||(t=this.createSubscription(e),this._subscriptions.set(e,t)),t}createSubscription(e){let t;switch(e){case UC.ej.MT_KEY:this._keepTokenActive=!0,t=this._auth.observeMiddleTierToken(),this.keepTokenActive();break;case UC.ej.SIGNIN_RESTRICTIONS_KEY:this._keepCheckingSignInRestrictions=!0,this.keepTokenActive();break;default:this._logger.error("Unable to create subscription, token key %s is not supported",e)}return t}keepTokenActive(){this._tokenIntervalId||(this._keepTokenActive||this._keepCheckingSignInRestrictions)&&(this._tokenIntervalId=this._windowProvider.setInterval((()=>{if(this._keepCheckingSignInRestrictions){let e=(0,BI.pW)();e=`sign${e.substr(UC.uI.FOUR)}`,this._auth.acquireToken(UC.ej.SIGNIN_RESTRICTIONS_KEY,{correlationId:e}).catch((e=>{this.handleSignInRestrictionsError(e)}))}this._keepTokenActive&&this._auth.acquireToken(this._mtResourceKey).then((()=>this._discover.validateSkypeToken())).catch((e=>{this._logger.error("Error occurred in keeping MT token active.",e)}))}),this._tokenWarmingIntervalInMs))}handleSignInRestrictionsError(e){if(this._logger.error(`Error occurred in keeping SignInRestrictions token active. ErrorCode: ${null==e?void 0:e.errorCode}`,e),(null==e?void 0:e.errorCode)===UC.SM.SignInRestrictions){this._logger.error("Sign in restrictions was enabled and caught by the periodic check. Forcibly signing out the user");const e={id:(0,BI.pW)(),source:"auth-token-store",scenarioName:ft.RG.AuthWebLogout},[t,n]=(0,UI.OU)({options:{correlation:e},scenarioName:e.scenarioName,source:e.source,subContext:"auth-token-store::handleSignInRestrictionsError"});t.appendScenarioEventData({operationType:UC.SM.SignInRestrictions}),this._client.mutate({mutation:BG,variables:{reason:UC.SM.SignInRestrictions},context:{correlation:e}}),n()}else this._logger.error("Sign in restrictions token acquisition threw an unexpected error",e)}observeIsLoginRequired(){this._auth.isLoginRequired.subscribe((e=>{if(this._isLoginRequired===e)return;const t=void 0===this._isLoginRequired;this._isLoginRequired=e,t||(this._isLoginRequired?this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0):this.replayKeepTokenActiveState())}))}observeAppOnlineState(){this._networkStateProvider.observeIsOnline().subscribe((e=>{e?this.replayKeepTokenActiveState():this._tokenIntervalId&&(this._windowProvider.clearInterval(this._tokenIntervalId),this._tokenIntervalId=void 0)}))}replayKeepTokenActiveState(){if(0===this._subscriptions.size)return;const e=this._subscriptions.keys();let t=e.next();for(;!t.done;)this.keepTokenActive(),t=e.next()}}class VG extends Fe{constructor(){super(De.Yg.InitAuthenticationService,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{client:t,discover:n,authenticationUser:i,authenticationService:a,networkState:o,loggerFactory:r,coreSettings:s,scenarioFactory:l}=e,{enableSignInRestrictions:d,prefetchTokens:c,disableTokenWarming:u,enableTokenWarming:m,tokenWarmingResources:g}=s.get(K.J.Auth);if(!i)return;const p=((e,t,n,i,a,o,r)=>(jG||(jG=new WG(n,e,t,i,a,(0,Ze.J)(),o,r)),jG))(t,n,a,o,l,r,s);d&&p.observe(UC.ej.SIGNIN_RESTRICTIONS_KEY),!u&&p.observe(UC.ej.MT_KEY);const v=[];null==c||c.forEach((e=>e&&v.push(e))),m&&g&&g.forEach((e=>{e&&v.indexOf(e)<0&&v.push(e)})),v.forEach((e=>a.acquireToken(e).catch((()=>{}))))}))}}class HG{constructor(e,t){this.coreSettings=e,this.brbServiceMap=new Map,this.logger=t.newLogger("BrbServiceManager")}registerUserBrbService(e,t){var n,i;null===(i=(n=this.logger).logNoPii)||void 0===i||i.call(n,"Registering a new BRB service for account"),this.brbServiceMap.set(e,t)}unregisterUserBrbService(e){var t,n;return null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,"Unregistering an existing BRB service for account"),this.brbServiceMap.delete(e)}getBrbFormData(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{categories:n,disclaimer:i}=this.coreSettings.get(K.J.Brb),a=[];return null==n||n.forEach((e=>{e&&a.push({id:e.id,name:e.name})})),null===(t=(e=this.logger).logNoPii)||void 0===t||t.call(e,"Returning data for BRB form",a),{disclaimer:i||De.bA,categories:a}}))}getBrbScreenshots(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getOrCreateUserBrbService(e);return null==n?void 0:n.getBrbScreenshots(t)}))}createBrbItem(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this.getOrCreateUserBrbService(e),i=yield(null==n?void 0:n.createBrbItem(t))||void 0;if(!i)return!1;const{enableMTMA:a}=this.coreSettings.get(K.J.Core);if(a){Array.from(this.brbServiceMap.keys()).filter((t=>t!==e)).forEach((e=>{const n=this.getOrCreateUserBrbService(e);null==n||n.extendBrbReports(t,i)}))}return!0}))}getOrCreateUserBrbService(e){var t,n,i,a;const o=this.brbServiceMap.get(e);if(o&&o instanceof Function){null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,"Creating BRB service for account");const i=o();return this.brbServiceMap.set(e,i),i}return null===(a=(i=this.logger).logNoPii)||void 0===a||a.call(i,"Found existing BRB service for account"),o}}class $G extends Fe{constructor(){super(De.Yg.InitBrbServiceManagerTask,["coreSettings","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n}=e;e.brbServiceManager=new HG(t,n)}))}}class zG extends Fe{constructor(){super(De.Yg.InitDesktopEcsContext,["primaryUser","coreSettings","loggerFactory","platformService","hostCommunicationService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{primaryUser:t,coreSettings:n,loggerFactory:i,platformService:a,hostCommunicationService:o}=e,r=yield o.loadModule("ecs");if(null==r?void 0:r.setEcsContext){const e=yield this.getDesktopEcsFilters(t,n,i,a);r.setEcsContext(e)}}))}getDesktopEcsFilters(e,t,n,a){var o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{ring:i,environment:s}=t.get(K.J.Metadata),{isInternalUser:l}=a.config,{originalRing:d}=a.ecsOverrides;return s||null===(r=(o=n.newLogger("InitPolicyProviderTask")).errorToTelemetry)||void 0===r||r.call(o,"Environment is undefined","webclient_framework_foundation_core_services_tasks",void 0,!0),{ring:(null==i?void 0:i.id)||"general",cloud:s||"",userId:e.profile.objectId,tenantId:e.profile.tenantId,isInternalUser:l,originalRing:d}}))}}class GG{constructor(e,t){var n,i,a,o,r,s,l,d;this.coreSettings=e,this.hostCommunicationService=t;const c=this.coreSettings.get(K.J.Metadata);this.expConfigMetadata=[{client:Fz.j,config:{expIds:null!==(a=null===(i=null===(n=c.configIds)||void 0===n?void 0:n.experiments)||void 0===i?void 0:i.join(","))&&void 0!==a?a:"",rolloutIds:null!==(s=null===(r=null===(o=c.configIds)||void 0===o?void 0:o.rollouts)||void 0===r?void 0:r.join(","))&&void 0!==s?s:"",eTag:null!==(l=c.eTag)&&void 0!==l?l:""}},{client:Fz.t,config:{expIds:"",rolloutIds:"",eTag:null!==(d=c.hostETag)&&void 0!==d?d:""}}],this.subject=new eS.X(this.expConfigMetadata),this.ecmObservable=this.subject.asObservable(),this.registerSyncHostEcm()}updateHostExperimentConfigMetadata(e){const t=e.find((e=>e.client===Fz.t)),n=this.expConfigMetadata.findIndex((e=>e.client===Fz.t));t&&n>-1&&(this.expConfigMetadata[n]=t,this.subject.next(this.expConfigMetadata))}updateWebExperimentConfigMetadata(e){var t;const n=null===(t=this.expConfigMetadata.find((e=>e.client===Fz.j)))||void 0===t?void 0:t.config;n&&e.eTag&&e.configIds&&e.configIds.experiments&&(n.eTag=e.eTag,n.expIds=e.configIds.experiments.join(","))}communicateWithHost(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=null===(e=this.expConfigMetadata.find((e=>e.client===Fz.j)))||void 0===e?void 0:e.config;if(!n)return;const i=yield this.hostCommunicationService.loadModule("ecs");if(!i)return;const a=yield null===(t=i.syncEcm)||void 0===t?void 0:t.call(i,[{client:Fz.j,config:n}]);if(a&&a.client===Fz.t){const e=[{client:Fz.t,config:{eTag:a.config.eTag,expIds:a.config.expIds,rolloutIds:a.config.rolloutIds}}];this.updateHostExperimentConfigMetadata(e)}}))}registerSyncHostEcm(){this.hostCommunicationService.loadModule("ecs").then((e=>{var t;null===(t=null==e?void 0:e.registerForOnSyncEcm)||void 0===t||t.call(e,(e=>{this.updateHostExperimentConfigMetadata(e)}))}))}}class qG extends Fe{constructor(){super(De.Yg.InitExperimentation,["coreSettings","hostCommunicationService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,hostCommunicationService:n}=e;e.experimentationService=new GG(t,n)}))}}class QG extends Fe{constructor(){super(De.Yg.InitializePulsarTask,["coreSettings","loggerFactory","platformService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n,platformService:i}=e,a=new yN(gN.TEAMS_CORE,{sessionId:i.host.sessionId,spanExporter:new kN,loggerFactory:n,logToOTLCollector:!!t.get(K.J.Pulsar).logToOTLCollector});t.get(K.J.Pulsar).enablePulsarTelemetry&&(yield a.initialize()),e.pulsar=a}))}}var JG=n(510991);class YG extends Fe{constructor(){super(De.Yg.InitEcsClientVersionTask,["platformService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{platformService:t}=e;JG.x.getInstance().set(t.config.buildVersion)}))}}class KG{constructor(e,t,n,i,a,o,r){this.scenarioFactory=a,this.host=o,this.clientStateProvider=r,this.namespacesToFetch=[],this.settings={},this.refreshIntervalInMs=36e5,this.fetch=()=>{if(0===this.namespacesToFetch.length)return this.logger.debug("Skipping fetch() as no namespacesToFetch registered."),Promise.resolve();const e=this.scenarioFactory.newScenario(this.getScenarioName());return this.validateEnvironment().then((()=>this.fetchPolicies(e))).catch((t=>{e.stop({errors:t},"abandoned"),this.logger.warn(`Error fetching policies: ${t}`)}))},this.validateEnvironment=()=>new Promise(((e,t)=>{this.clientStateProvider.getState()===VS.pk.VeryActive&&(this.logger.log("Cancel policy fetching, due to app being in a very active state."),t("very active")),e()})),this.cleanupClientStateSubscription=()=>{var e;null===(e=this.clientStateSubscription)||void 0===e||e.unsubscribe(),this.clientStateSubscription=void 0},this.logger=e.newLogger(`CoreSettings/${t}`),this.namespacesToFetch=n("policies").namespaces||[],this.namespacesToFetch.forEach((e=>{this.settings[e]={}})),this.updateConfigs(i)}initialize(e=!0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.isInitialized=!0,yield this.fetchAndSetRefreshCadence()}))}subscribeForSettingsUpdates(e){this.settingsChangedCallbackFunction=e}cleanup(){var e;this.cleanupClientStateSubscription(),this.settingsChangedCallbackFunction=void 0,null===(e=this.coreSubscription)||void 0===e||e.unsubscribe(),this.coreSubscription=void 0}notifySettingsChanged(){const e=()=>{var e;this.cleanupClientStateSubscription(),null===(e=this.settingsChangedCallbackFunction)||void 0===e||e.call(this,this.settings),this.logger.debug("Notified about policy change")};return this.clientStateProvider.getState()!==VS.pk.VeryActive?(e(),!0):(this.clientStateSubscription||(this.clientStateSubscription=this.clientStateProvider.observe().subscribe((t=>{t!==VS.pk.VeryActive&&e()}))),!1)}handleError(e){this.logger.error(`Failed to fetch tenant settings with error: ${e}`)}updateConfigs(e){const t=e.getObservable(K.J.Core);this.coreSubscription=t.subscribe((e=>{e.policyRefreshIntervalInMs&&this.updateRefreshCadence(e.policyRefreshIntervalInMs)}))}updateRefreshCadence(e){this.refreshIntervalInMs=e,this.isInitialized&&this.queueNextPolicyFetch()}fetchAndSetRefreshCadence(){return this.fetch().then((()=>{this.queueNextPolicyFetch()})).catch((e=>{this.logger.error(`Error fetching policies: ${e}`)}))}queueNextPolicyFetch(){if(!this.isInitialized)throw new Error("Service not initialized to queue the fetch.");this.setIntervalHandle&&(this.host.clearInterval(this.setIntervalHandle),this.setIntervalHandle=void 0,this.logger.debug("clearInterval() called.")),this.refreshIntervalInMs>0?(this.setIntervalHandle=this.host.setInterval(this.fetch,this.refreshIntervalInMs),this.logger.debug("setInterval() called.")):this.logger.error(`Refresh interval not valid: ${this.refreshIntervalInMs}`)}}class ZG extends KG{constructor(e,t,n,i,a,o){super(e,"PoliciesIpcDataProvider",t,n,i,a,o),this.handleSetAggregatedSettings=e=>{const{payload:t}=e;Object.keys(t).length>0?(this.logger.log(`handleSetAggregatedSettings() called: ${Object.keys(t).join(", ")}.`),this.parsePolicies(t),this.notifySettingsChanged()):this.logger.log("handleSetAggregatedSettings() called with empty payload.")},this.windowOpener=a.opener}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.windowOpener.addEventListener(vb.rY.SetAggregatedSettings,this.handleSetAggregatedSettings),t.initialize.call(this)}))}cleanup(){super.cleanup(),this.windowOpener.removeEventListener(vb.rY.SetAggregatedSettings,this.handleSetAggregatedSettings)}getScenarioName(){return ft.RG.IPCPolicyFetch}fetchPolicies(e){return this.windowOpener.requestMessage(vb.rY.GetAggregatedSettings).then((t=>{let n=!1,i="success";const a=null==t?void 0:t.data;a&&0!==Object.keys(a).length?(this.logger.log(`fetchPolicies: Got policies for namespaces: ${Object.keys(a).join(", ")}.`),this.parsePolicies(a),n=this.notifySettingsChanged()):(this.logger.log("Failed to fetch policies via IPC, got empty payload data response."),i="incomplete"),e.stop({message:(0,Ci.u4)({notified:n})},i)})).catch((t=>{var n;this.handleError(t),e.fail({errors:null!==(n=t.message)&&void 0!==n?n:"Failed to fetch policies via IPC."})}))}parsePolicies(e){this.namespacesToFetch.forEach((t=>{e[t]&&e[t].hasOwnProperty("value")&&(this.settings[t]=e[t].value)}))}}const XG={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"policies"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"namespaces"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"correlationId"},value:{kind:"Variable",name:{kind:"Name",value:"correlationId"}}},{kind:"Argument",name:{kind:"Name",value:"namespaces"},value:{kind:"Variable",name:{kind:"Name",value:"namespaces"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]},eq={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policiesUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"jsonData"}}]}}]}}]};class tq extends KG{constructor(e,t,n,i,a,o,r){super(e,"PoliciesResolversDataProvider",t,n,i,a,r),this.apolloClient=o,this.handlePoliciesUpdatedEvent=e=>{this.logger.log("handlePoliciesUpdatedEvent() called.");try{void 0!==e&&this.parsePolicies(e)?this.notifySettingsChanged():this.logger.log(`handlePoliciesUpdatedEvent(): policiesString is ${void 0===e?"undefined":"empty"}.`)}catch(e){this.logger.error(`handlePoliciesUpdatedEvent(): ${e.message}`)}}}initialize(e=!0){const t=Object.create(null,{initialize:{get:()=>super.initialize}});return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=this;return this.policiesApolloSubscription=this.apolloClient.subscribe({query:eq}).subscribe({next(t){var n,i,a;e.handlePoliciesUpdatedEvent(null!==(a=null===(i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.policiesUpdatedEvent)||void 0===i?void 0:i.jsonData)&&void 0!==a?a:void 0)}}),t.initialize.call(this)}))}cleanup(){var e;super.cleanup(),null===(e=this.policiesApolloSubscription)||void 0===e||e.unsubscribe(),this.policiesApolloSubscription=void 0}getScenarioName(){return ft.RG.PoliciesFetchDataResolvers}fetchPolicies(e){return this.apolloClient.query({query:XG,variables:{correlationId:e.id,namespaces:this.namespacesToFetch},fetchPolicy:"no-cache"}).then((t=>{var n,i,a,o,r;(null==t?void 0:t.error)&&(null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,`fetchPolicies:then: Message: ${t.error.message}.`,"webclient_framework_policies_resolvers_fetch_failed_event",void 0,!0)),(null==t?void 0:t.errors)&&t.errors.forEach((e=>{var t,n;null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`fetchPolicies:then: Errors:Message: ${e.message}.`,"webclient_framework_policies_resolvers_fetch_failed_event",void 0,!0)}));const s=null!==(r=null===(o=null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.policies)||void 0===o?void 0:o.jsonData)&&void 0!==r?r:void 0;let l=!1,d="success";void 0!==s&&this.parsePolicies(s)?l=this.notifySettingsChanged():(this.logger.log(`fetchPolicies(): Failed to fetch policies, got ${void 0===s?"undefined":"empty"} response.`),d="incomplete"),e.stop({message:(0,Ci.u4)({notified:l})},d)})).catch((t=>{var n;this.handleError(t),e.fail({errors:null!==(n=t.message)&&void 0!==n?n:"Failed to fetch policies via resolvers."})}))}parsePolicies(e){let t={};try{t=JSON.parse(e)}catch(e){throw new Error("parsePolicies(): Unable to parse policies string.")}return 0!==Object.keys(t).length&&(this.namespacesToFetch.forEach((e=>{t[e]&&(this.settings[e]=t[e])})),!0)}}class nq extends Fe{constructor(){super(De.Yg.InitSettingsPolicyProvider,["authenticationUser","coreSettings","coreSettingsContext","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n,coreSettingsContext:i,loggerFactory:a}=e,{disableNonBlockingPolicyProviderInit:o,disablePolicyProvider:r}=n.get(K.J.Core);if(r)return;if(!t||t.role===XT.w4.Anonymous)return;const s=this.createPoliciesDataProvider(e),{enableMainWindowPolicyFetch:l}=n.get(K.J.Host);if(l||o)yield i.initializePolicyProvider(s);else{const e=a.newLogger("InitPolicyProviderTask");i.initializePolicyProvider(s).then((()=>{e.log("Initialized policy provider successfully.")})).catch((t=>{e.errorToTelemetry&&e.errorToTelemetry(`Initialization of policy provider failed. ${t}`,"webclient_framework_foundation_core_services",void 0,!0)}))}return e=>{switch(e){case"signout":s.cleanup()}}}))}createPoliciesDataProvider(e){const{client:t,clientState:n,configLoader:i,coreSettings:a,loggerFactory:o,scenarioFactory:r,windowProvider:s}=e;let l;const{enableMainWindowPolicyFetch:d}=a.get(K.J.Host);return l=d?new ZG(o,i,a,r,s,n):new tq(o,i,a,r,s,t,n),l}}class iq extends Fe{constructor(){super(De.Yg.InitPreAuthSettingsEcsProvider,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=pD("InitPreAuthSettingsEcsProvider",e,"coreSettings","coreSettingsContext","loggerFactory","scenarioFactory","networkState","clientState","windowProvider","endpointsManager"),{coreSettings:n,coreSettingsContext:a,loggerFactory:o}=t,r=(0,i.__rest)(t,["coreSettings","coreSettingsContext","loggerFactory"]),{enablePreAuthEcsFetch:s}=n.get(K.J.Core);if(!s)return;const l=a;yield l.initializeEcsProvider(Object.assign({},r))}))}}var aq=n(634982),oq=n(265784),rq=n(795835);const sq="preReleaseFeaturesAllowed";class lq extends Fe{constructor(){super(De.Yg.InitSettingsClientFiltersProvider,["authenticationService","authenticationUser","config","coreSettings","coreSettingsContext","discover","endpointsManager","localStorage","loggerFactory","platformService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationService:t,authenticationUser:n,config:i,coreSettings:a,coreSettingsContext:o,discover:r,endpointsManager:s,localStorage:l,loggerFactory:d,platformService:c,windowProvider:u}=e;let m={};const{enablePreReleaseClientFilter:g}=a.get(K.J.Core);if(g){const e=yield this.getPreReleaseUserInfo({authenticationService:t,authenticationUser:n,config:i,coreSettings:a,endpointsManager:s,localStorage:l,loggerFactory:d,platformService:c,windowProvider:u});m=Object.assign(Object.assign({},m),{preReleaseFeaturesAllowed:e})}const p=o;yield p.initializeClientFiltersProvider(r,m)}))}getPreReleaseUserInfo({authenticationService:e,authenticationUser:t,config:{experienceName:n},coreSettings:a,endpointsManager:o,localStorage:r,loggerFactory:s,platformService:l,windowProvider:d}){var c;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const u=s.newLogger("InitSettingsClientFiltersProviderTask"),{preReleaseFeaturesAllowed:m}=a.get(K.J.Metadata);if(!m)return u.log("No pre release features are allowed."),!1;if(yield function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield y_(e);return!!n&&n.id===t.id}))}(e,t))return u.log(`Returning preReleaseAllowed filter for primary user: ${m}`),!!m;try{const e=r.get(sq);if(null!=e)return u.log(`Cached preReleaseAllowed filter loaded: ${e}`),JSON.parse(e);const i=(0,aq.xb)({coreSettings:a,experienceName:n,platformService:l,logger:u,authenticationUser:t}),c=new oq.X(i,"ClientFilters",o,d,s),m=yield c.getConfigurationAsync(),g=this.getValueFromPayload(m,i);return void 0!==g?(u.log(`Storing preReleaseAllowed filter in cache: ${g}`),r.set(sq,g.toString())):u.log("Could not get preReleaseAllowed filter from ECS."),!!g}catch(e){null===(c=u.errorToTelemetry)||void 0===c||c.call(u,(0,BI.u4)(e),"web_infra_determine_pre_release_filter_failed")}return!1}))}getValueFromPayload(e,t){var n;if(e.requestStatus===rq.m1.Success)return null===(n=t.namespaces)||void 0===n?void 0:n.some((t=>{var n,i;const a=null===(n=e.ecsConfiguration)||void 0===n?void 0:n[t];return!!(null===(i=null==a?void 0:a.metadata)||void 0===i?void 0:i.preReleaseFeaturesAllowed)}))}}class dq extends Fe{constructor(){super(De.Yg.InitSettingsEcsProvider,["coreSettings","coreSettingsContext","authenticationService","loggerFactory","scenarioFactory","networkState","clientState","windowProvider","endpointsManager"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,coreSettingsContext:n,authenticationService:a,loggerFactory:o,scenarioFactory:r,networkState:s,clientState:l,windowProvider:d,endpointsManager:c}=e,u=n,m=()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){p||(yield u.fetchEcsSettingsIfApplicable())})),{enablePreAuthEcsFetch:g}=t.get(K.J.Core),p=yield this.getPrimaryUser(a,o);yield u.setPrimaryUser(p),g||(yield u.initializeEcsProvider({scenarioFactory:r,networkState:s,clientState:l,windowProvider:d,endpointsManager:c,authenticationUser:p})),yield m()}))}getPrimaryUser(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;try{const t=yield null===(n=e.getCachedUsers)||void 0===n?void 0:n.call(e,{id:(0,BI.pW)(),scenarioName:ft.RG.AuthWebCachedUser,source:"init-settings-ecs-provider-task"},{isPrimaryUser:!0});t&&t.length>0&&(i=(0,li.K)(t[0]))}catch(e){t.newLogger("InitSettingsEcsProviderTask").warn("No primary user returned from authentication: ",e)}return i}))}}class cq extends Fe{constructor(){super(De.Yg.InitSettingsMaglevHostProvider,["coreSettingsContext","hostCommunicationService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettingsContext:t,hostCommunicationService:n}=e,{enableMaglevHostProvider:i}=t.getCoreSettings().get(K.J.Core);i&&(yield t.initializeMaglevHostProvider(n))}))}}class uq extends Fe{constructor(){super(De.Yg.SetPrimaryUserOnCoreSettingsTask,["primaryUser","coreSettingsContext"])}execute({primaryUser:e,coreSettingsContext:t}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return yield t.setPrimaryUser(e),()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield t.setPrimaryUser(void 0)}))}))}}var mq;!function(e){e[e.ComposeMessageTyping=0]="ComposeMessageTyping",e[e.MessageListScroll=1]="MessageListScroll",e[e.PowerbarTyping=2]="PowerbarTyping",e[e.VirtualTreeListScroll=3]="VirtualTreeListScroll",e[e.FeedsFilterTyping=4]="FeedsFilterTyping",e[e.PeoplePickerTyping=5]="PeoplePickerTyping",e[e.SearchBoxTyping=6]="SearchBoxTyping",e[e.FloodgatePopup=7]="FloodgatePopup",e[e.ChatListSearchFilterTyping=8]="ChatListSearchFilterTyping",e[e.ChannelListSearchFilterTyping=9]="ChannelListSearchFilterTyping",e[e.CallingPerfSample=10]="CallingPerfSample",e[e.AllChannelSystemMessagesScroll=11]="AllChannelSystemMessagesScroll",e[e.AllPinnedPostsScroll=12]="AllPinnedPostsScroll",e[e.DiscoverSurfaceFeedListScroll=13]="DiscoverSurfaceFeedListScroll",e[e.TeamsAndChannelsTableScroll=14]="TeamsAndChannelsTableScroll",e[e.PostComposeTyping=15]="PostComposeTyping"}(mq||(mq={}));var gq=n(405204);const pq="getAndClearAriTelemetry";class vq{constructor(e,t){this.host=e,this.context=t,this.startSlot=0,this.blinkInterval=100,this.trailingTimespan=De.B.second,this.rafRecords=new Map,this.activeUserActionType=void 0,this.userActions=new Map,this.validActions=new Map,this.lastEventTimeSlot=this.startSlot,this.isDebugging=!1,this.strategies=[{name:"TwoRafAndLimitedStopTimeStrategy",lowestAllowedRafs:2,allowStopTimeOverwrite:!0}],this.logger=t.loggerFactory.newLogger("ARI"),this.initializeOnAppLaunchAndReinit(),this.__initTestingMode__(this.context.coreSettings.get(K.J.Host)),this.defaultHost=e}trackEvent(e,t,n,i,a){const o=this.getUserActionType(e,t),{isDebugging:r,logger:s}=this;if(void 0===o||!(o in mq))return void(r&&s.debug(`[${this.formatActionKey(e,t)}] TrackEvent | No action found`));const l=this.getMeasurementName(o),d=i.performance.now();if(r&&s.debug(`[${l} TrackEvent | [${Math.round(n)}...${Math.round(d)}] ${Math.round(d-n)}ms`),void 0===this.activeUserActionType)r&&s.debug(`[${l}] track-start`),this.startMeasurement(o,n,i,a);else if(this.activeUserActionType!==o||this.host!==i||this.actionLocation!==a)r&&s.debug(`[${l}] track-stop`),this.stopMeasurement(i),r&&s.debug(`[${l}] track-start`),this.startMeasurement(o,n,i,a);else{if(r){const e=`[${l}] track-continue`;s.debug(e),function(e,t,n){e.mark(t,n),e.clearMarks(t)}(this.host.performance,e,{startTime:n})}this.continueMeasurement(n)}}handleUnmount(e){this.stopMeasurement(e)}getTelemetry(e=gq.xL.HeartbeatMonitor){return this.getTelemetryFilteredByType(e)}getTelemetryTypeForAction(e){return e===mq.CallingPerfSample?gq.xL.CallingPerfMonitor:gq.xL.HeartbeatMonitor}isActionOfTelemetryType(e,t){return this.getTelemetryTypeForAction(e)===t}getTelemetryFilteredByType(e){void 0!==this.activeUserActionType&&this.isActionOfTelemetryType(this.activeUserActionType,e)&&this.stopMeasurement();const t={};let n=!1;const i={totalIntervalCount:0,passIntervalCount:0};this.userActions.forEach(((a,o)=>{if(void 0!==mq[a.type]&&this.isActionOfTelemetryType(a.type,e)){const e={};a.scores.forEach(((t,n)=>{(e=>{e&&(i.passIntervalCount+=e.passIntervalCount,i.totalIntervalCount+=e.totalIntervalCount)})(t),e[n]=this.getAri(t)})),t[o]=e,n=!0,this.userActions.delete(o),this.isDebugging&&this.logger.debug(`[AppResponsivenessService]: clear action for type ${mq[a.type]}`)}})),t.Total=this.getAri(i);let a="";if(n)try{a=JSON.stringify(t)}catch(e){this.logger.error("[AppResponsivenessService]: unexpected error parsing log object. Likely because of circular reference.")}return a}clearTelemetry(){this.userActions.clear(),this.clearTelemetryTimeoutId&&this.context.windowProvider.clearTimeout(this.clearTelemetryTimeoutId),this.clearTelemetryTimeoutId=this.context.windowProvider.setTimeout((()=>{this.clearTelemetry()}),De.B.tenMinutes,!1)}initializeOnAppLaunchAndReinit(){this.initSettings(),this.registerValidActions(),this.clearTelemetry()}__initTestingMode__(e){if(e){const t=e.userType;t&&t.indexOf("test")>-1&&(this.isDebugging=!0,pq in window||(window.getAndClearAriTelemetry=()=>{const e=this.getTelemetry();return this.clearTelemetry(),e}))}}registerValidActions(){this.validActions.set(this.formatActionKey(gq.PG.Floodgate,De.f_.System),mq.FloodgatePopup),this.validActions.set(this.formatActionKey(gq.PG.ComposeMessage,De.f_.Keyup),mq.ComposeMessageTyping),this.validActions.set(this.formatActionKey(gq.PG.MessageList,De.f_.Scroll),mq.MessageListScroll),this.validActions.set(this.formatActionKey(gq.PG.Powerbar,De.f_.Keyup),mq.PowerbarTyping),this.validActions.set(this.formatActionKey(gq.PG.VirtualTreeList,De.f_.Scroll),mq.VirtualTreeListScroll),this.validActions.set(this.formatActionKey(gq.PG.FeedsFilter,De.f_.Keyup),mq.FeedsFilterTyping),this.validActions.set(this.formatActionKey(gq.PG.PeoplePicker,De.f_.Keyup),mq.PeoplePickerTyping),this.validActions.set(this.formatActionKey(gq.PG.PostCompose,De.f_.Keyup),mq.PostComposeTyping),this.validActions.set(this.formatActionKey(gq.PG.SearchBox,De.f_.Keyup),mq.SearchBoxTyping),this.validActions.set(this.formatActionKey(gq.PG.ChatListSearchFilter,De.f_.Keyup),mq.ChatListSearchFilterTyping),this.validActions.set(this.formatActionKey(gq.PG.ChannelListSearchFilter,De.f_.Keyup),mq.ChannelListSearchFilterTyping),this.validActions.set(this.formatActionKey(gq.PG.CallingPerf,De.f_.Sample),mq.CallingPerfSample),this.validActions.set(this.formatActionKey(gq.PG.DiscoverSurfaceFeedList,De.f_.Scroll),mq.DiscoverSurfaceFeedListScroll),this.validActions.set(this.formatActionKey(gq.PG.AllPinnedPosts,De.f_.Scroll),mq.AllPinnedPostsScroll),this.validActions.set(this.formatActionKey(gq.PG.AllChannelSystemMessages,De.f_.Scroll),mq.AllChannelSystemMessagesScroll),this.validActions.set(this.formatActionKey(gq.PG.TeamsAndChannelsTable,De.f_.Scroll),mq.TeamsAndChannelsTableScroll)}getUserActionType(e,t){const n=this.formatActionKey(t,e);return this.validActions.get(n)}formatActionKey(e,t){return`${e}_${t}`}registerRafCallback(){this.rafCallbackId||(this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}unregisterRafCallback(){this.rafCallbackId&&(this.host.cancelAnimationFrame(this.rafCallbackId),this.clearRaf())}clearRaf(){this.rafCallbackId=void 0,this.rafRecords.clear()}getAri(e){return e&&0!==e.totalIntervalCount?Math.round(e.passIntervalCount/e.totalIntervalCount*De.B.second)/De.B.second:0}initSettings(){const{enableAriDebugging:e,appResponsivenessConstants:t}=this.context.coreSettings.get(K.J.Telemetry),n=this.context.coreSettings.get(K.J.Host).showScenarioStepsInPerfTrace||this.context.coreSettings.get(K.J.Core).showScenarioStepsInPerfTrace;this.isDebugging=e||n||!1,this.blinkInterval=t&&t.blinkInterval||100,this.trailingTimespan=t&&t.trailingTimespan||De.B.second}startMeasurement(e,t,n,i){this.assignHost(n),this.actionLocation=i,this.activeUserActionType=e,this.eventStartTime=t||this.host.performance.now(),this.lastEventTimeSlot=this.getTimeSlot(this.eventStartTime);const a=this.getMeasurementName(e);if(this.isDebugging){const e=`[${a}] START`,t=`${e} | ${this.host.performance.now()} | Event: ${this.eventStartTime}`;this.host.performance.mark(e,{startTime:this.eventStartTime}),this.logger.debug(t)}this.registerRafCallback();let o=this.userActions.get(a);void 0===o&&(o={scores:new Map,startTime:this.startSlot,type:e},this.userActions.set(a,o)),o.startTime=this.eventStartTime}stopMeasurement(e=this.host){if(void 0===this.activeUserActionType)return;const t=this.getMeasurementName(this.activeUserActionType),n=this.userActions.get(t);if(void 0!==n){if(this.isDebugging){const e=`[${t}] END`;this.host.performance.mark(e),this.logger.debug(`${e} | ${this.host.performance.now()}`)}this.finalizeMeasurement(n)}this.unregisterRafCallback(),this.activeUserActionType=void 0,this.actionLocation=void 0,e===this.host&&this.assignHost(this.defaultHost)}continueMeasurement(e){this.lastEventTimeSlot=this.getTimeSlot(e)}finalizeMeasurement(e,t){this.strategies.forEach((n=>{const i=t&&n.allowStopTimeOverwrite?t:this.getCurrentTimeSlot(),a=this.getResponsivenessScore(this.startSlot,i,n),o=e.scores.get(n.name);o?(o.passIntervalCount+=a.passIntervalCount,o.totalIntervalCount+=a.totalIntervalCount):e.scores.set(n.name,{totalIntervalCount:a.totalIntervalCount,passIntervalCount:a.passIntervalCount});const r=(a.passIntervalCount/a.totalIntervalCount).toFixed(2);if(this.logger.log(`[${this.getMeasurementName(e.type)}] duration: ${Math.round(this.host.performance.now()-e.startTime)}ms measurement: ${a.passIntervalCount}/${a.totalIntervalCount} (${r})`),this.isDebugging){const t=this.getMeasurementName(e.type),n={name:t,pass:a.passIntervalCount,total:a.totalIntervalCount,result:r},i=`ari-measurement => ${JSON.stringify(n)}`,o=`[${t}] START`,s=`[${t}] END`;JA(this.host.performance,i,o,s)}}))}measureRaf(){const e=this.getCurrentTimeSlot();let t=this.rafRecords.get(e);void 0===t?t=1:t++,e-this.lastEventTimeSlot>=this.trailingTimespan?this.stopMeasurement():(this.rafRecords.size>1e3&&(this.stopMeasurement(),this.rafRecords.clear()),this.rafRecords.set(e,t),this.rafCallbackId=this.host.requestAnimationFrame((()=>this.measureRaf())))}getCurrentTimeSlot(){const e=this.host.performance.now();return this.getTimeSlot(e)}getTimeSlot(e){const t=void 0!==this.eventStartTime?e-this.eventStartTime:-1;return t<0?-1:Math.floor(t/this.blinkInterval)*this.blinkInterval}getResponsivenessScore(e,t,n){let i=0,a=0;for(;e<t;){const t=this.rafRecords.get(e);this.isDebugging&&this.logger.debug(`${e}: ${void 0===t?0:t}`),a+=void 0!==t&&t>=n.lowestAllowedRafs?1:0,i++,e+=this.blinkInterval}return{passIntervalCount:a,totalIntervalCount:i}}assignHost(e){this.host=e}getMeasurementName(e){let t=mq[e];return this.actionLocation&&(t+=`-${this.actionLocation}`),t}}class hq{constructor(e){var t,n;if(this.context=e,null===(t=this.context.host)||void 0===t?void 0:t.performance){this.deprecatedNavigationTiming=this.context.host.performance.timing,this.navigationStart=null===(n=this.deprecatedNavigationTiming)||void 0===n?void 0:n.navigationStart;const e=this.context.host.performance.getEntriesByType("navigation");e&&e[0]&&(this.navigationTiming=e[0]),this.init()}}get altScenario(){return this._altScenario}get clientStartScenario(){return this._clientStartScenario}markCoreInitSteps(){const e=this.context.host.performance.getEntriesByType("mark");e&&this.navigationStart&&(this._altScenario&&this.processCoreInitPerfMarks(this._altScenario,this.navigationStart,e),this._clientStartScenario&&(this._clientStartScenario.appendEventData({scenarioPhase:U_.Core}),this.processCoreInitPerfMarks(this._clientStartScenario,this.navigationStart,e)))}processCoreInitPerfMarks(e,t,n){const i=n;for(const n of i)switch(n.name){case`${uS}${De.sM.Initialization}`:e.mark(ft.ck.PreCoreInitializationTasks,{overrideTimestamp:Math.round(n.startTime)+t});continue;default:n.name.startsWith(mS)&&e.mark(n.name.replace("_end_","_"),{overrideTimestamp:Math.round(n.startTime)+t})}}markAltExpLoaderSteps(e,t){this.markNavigationSteps(e,t);const n=this.context.host.performance.getEntriesByName("start-execute-main-bundle","mark");n&&n[0]&&e.mark(ft.ck.MainBundleDownloadParse,{overrideTimestamp:Math.round(n[0].startTime)+t})}markClientStartExpLoaderSteps(e,t){e.appendEventData({scenarioPhase:U_.ExpLoader}),this.markNavigationSteps(e,t);const n=[l$.IndexPageStart,l$.CoreModuleLoaded,l$.NotifyDesktop,l$.ConfigLoaded,l$.MainChunksLoadingStart,l$.MainChunksLoadingStop,l$.IndexPageStop,ft.ck.MainBundleDownloadParse,"start-execute-main-bundle"],i=this.context.host.performance.getEntriesByType("mark");i&&i.filter((e=>n.includes(e.name)||e.name.startsWith("exp_loader_err_"))).forEach((n=>{e.mark(n.name,{overrideTimestamp:Math.round(n.startTime)+t})}))}markNavigationSteps(e,t){var n,i,a,o;(null===(n=this.navigationTiming)||void 0===n?void 0:n.workerStart)&&e.mark(ft.ck.IndexServiceWorkerStartup,{overrideTimestamp:t+Math.round(this.navigationTiming.workerStart)}),(null===(i=this.deprecatedNavigationTiming)||void 0===i?void 0:i.fetchStart)&&e.mark(ft.ck.IndexFetchIPC,{overrideTimestamp:this.deprecatedNavigationTiming.fetchStart}),(null===(a=this.deprecatedNavigationTiming)||void 0===a?void 0:a.requestStart)&&e.mark(ft.ck.IndexFetchIPCWait,{overrideTimestamp:this.deprecatedNavigationTiming.requestStart}),(null===(o=this.deprecatedNavigationTiming)||void 0===o?void 0:o.responseStart)&&e.mark(ft.ck.IndexFetchProcessing,{overrideTimestamp:this.deprecatedNavigationTiming.responseStart})}init(){var e,t;this.navigationStart&&(this._altScenario=null===(e=this.context.scenarioFactory)||void 0===e?void 0:e.newScenario(ft.RG.ApplicationLaunchTime,{startTime:this.navigationStart}),this._clientStartScenario=null===(t=this.context.scenarioFactory)||void 0===t?void 0:t.newScenario(ft.RG.ClientStart,{startTime:this.navigationStart}),this._altScenario&&this.markAltExpLoaderSteps(this._altScenario,this.navigationStart),this._clientStartScenario&&this.markClientStartExpLoaderSteps(this._clientStartScenario,this.navigationStart),this.markCoreInitSteps())}}class fq{constructor(e,t){this.isScenarioMemorySnapshotEnabled=e,this.globalWindow=t,this.cachedMemoryData={},this.cacheToExpireTime=0}snapshotMemoryUsage(){return this.isScenarioMemorySnapshotEnabled?(this.cacheToExpireTime<Date.now()&&this.snapshot(),this.cachedMemoryData):{}}snapshotMemoryUsageAsync(){if(!this.isScenarioMemorySnapshotEnabled)return Promise.resolve({});if(this.ongoingPromise)return this.ongoingPromise;const e=this.cacheToExpireTime-Date.now();return e>0?(this.ongoingPromise=new Promise((t=>{this.globalWindow.setTimeout((()=>{this.snapshot(),t(this.cachedMemoryData),this.ongoingPromise=void 0}),e)})),this.ongoingPromise):(this.snapshot(),Promise.resolve(this.cachedMemoryData))}snapshot(){this.cachedMemoryData={jsHeapStatistics:this.globalWindow.envPerformance.getJSHeapStatistics()||this.cachedMemoryData.jsHeapStatistics,processMemoryInfo:this.globalWindow.envPerformance.getProcessMemoryInfo()||this.cachedMemoryData.processMemoryInfo},this.cacheToExpireTime=Date.now()+3e4}}var yq=n(761481),kq=n(558487);class Sq{constructor(e){this.eventTimeTracker=Lz(e&&e>0?e:100)}markResponse(e){return this.eventTimeTracker.markEvent(e)}getResponsesBetweenStartAndLast(e){return this.eventTimeTracker.getEventsBetweenStartAndLast(e)}getResponsesBetween(e,t){return this.eventTimeTracker.getEventsBetween(e,t)}}const bq=e=>{var t;const{apolloLeakInfoViewportContext:n,apolloLeakInfoEntityType:i=""}=null!==(t=e.apolloLeakInfo)&&void 0!==t?t:{};return n===hb.R.primary?`main:${i}`:i},Cq=e=>e.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{});class wq{constructor(e,t,n,i){this.coreSettings=e,this.leakDetectorService=t,this.userTrackingService=n,this.shouldCollectStats=i,this.measurementTimeOverflow=!1,this.resultMeasurementTimeOverflow=!1,this.isLeakingUser=e=>e&&this.userTrackingService&&!this.userTrackingService.has(e);const{apolloCacheStatsThrottleTime:o,logCdlOperationsDuringWaitSettings:r}=e.get(K.J.Core);var s;this.getTelemetry=o?(0,a.throttle)((()=>this.getTelemetryInternal()),o,{leading:!0,trailing:!1}):this.getTelemetryInternal,r&&(r.enableTrackingCdlOperationsDuringWait||r.enableLoggingCdlOperationsDuringWait)&&(this.cdlResponseTracker=(s=r.trackingCdlOperationsDuringWaitBufferSize,new Sq(s)))}getTelemetryInternal(){var e,t,n,i,a,o;const{enableApolloCacheStats:r,enableApolloCacheSizeStats:s,enableApolloResultCacheSizeStats:l,enableApolloDataEviction:d}=this.coreSettings.get(K.J.Core);if(!r)return;const c=null!==(t=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects(JN.I.DataClient).size)&&void 0!==t?t:0,u=Array.from(null!==(i=null===(n=this.leakDetectorService)||void 0===n?void 0:n.getReachableObjects(JN.I.ApolloCache))&&void 0!==i?i:[]),m=[...Array.from(null!==(o=null===(a=this.leakDetectorService)||void 0===a?void 0:a.getReachableObjects(JN.I.UnwrappedWindow))&&void 0!==o?o:[]).map((e=>{var t;return null===(t=e.windowLeakInfo)||void 0===t?void 0:t.windowLeakInfoWindowId})).filter((e=>!!e)),De.ew],g=e=>!e||!m.includes(e),p=u.filter((e=>{const{apolloLeakInfo:{apolloLeakInfoWindowId:t}={}}=e;return g(t)})),v=this.getLeakedUserCaches(u),h=u.map(bq),f=p.map(bq),y=s&&!this.measurementTimeOverflow&&this.shouldCollectStats(),k=l&&!this.resultMeasurementTimeOverflow&&this.shouldCollectStats(),S={clientsCount:c,cacheCount:u.length,allEntityTypes:Array.from(new Set(h)),entityTypeStats:Cq(h),leakedCacheCount:f.length,leakedEntityTypes:Array.from(new Set(f)),leakedEntityTypeStats:Cq(f),leakedUserCachesCount:v.length,caches:u.map((e=>{const{apolloLeakInfo:{apolloLeakInfoWindowId:t,apolloLeakInfoEntityType:n,apolloLeakInfoViewportContext:i}={}}=e,a={windowId:t,isLeaking:g(t),entityType:n,viewportContext:i};if(y){const{cacheSize:t,measuringTime:n}=(0,yq.T)(e);a.cacheSize=t,a.measuringTime=n}if(k){const{cacheSize:t,measuringTime:n}=(0,kq.TP)(e);a.resultCacheSize=t,a.resultMeasuringTime=n}return a})),enableApolloDataEviction:null!=d?d:void 0},b=S.caches.reduce(((e,t)=>({cacheSize:void 0===t.cacheSize||void 0===e.cacheSize?void 0:e.cacheSize+t.cacheSize,measuringTime:void 0===t.measuringTime||void 0===e.measuringTime?void 0:e.measuringTime+t.measuringTime,resultCacheSize:void 0===t.resultCacheSize||void 0===e.resultCacheSize?void 0:e.resultCacheSize+t.resultCacheSize,resultMeasuringTime:void 0===t.resultMeasuringTime||void 0===e.resultMeasuringTime?void 0:e.resultMeasuringTime+t.resultMeasuringTime})),{cacheSize:0,measuringTime:0,resultCacheSize:0,resultMeasuringTime:0});return b.measuringTime&&b.measuringTime>500&&(this.measurementTimeOverflow=!0),b.resultMeasuringTime&&b.resultMeasuringTime>500&&(this.resultMeasurementTimeOverflow=!0),Object.assign(Object.assign({},S),b)}unthrottle(){"function"==typeof this.getTelemetry.cancel&&this.getTelemetry.cancel()}markResponse(e){var t;null===(t=this.cdlResponseTracker)||void 0===t||t.markResponse(e)}getResponsesBetweenStartAndLast(e){var t;return(null===(t=this.cdlResponseTracker)||void 0===t?void 0:t.getResponsesBetweenStartAndLast(e))||[]}getResponsesBetween(e,t){var n;return(null===(n=this.cdlResponseTracker)||void 0===n?void 0:n.getResponsesBetween(e,t))||[]}getLeakedUserCaches(e){return e.filter((e=>{const{apolloLeakInfo:{apolloLeakInfoUserContextId:t}={}}=e;return this.isLeakingUser(t)}))}}const Nq={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeWindows"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},Tq=(e,t,n)=>{const i=void 0!==e[t]||Object.keys(e).length<n?t:"other";return e[i]=(e[i]||0)+1,i},Iq=new Set([u.p.breakoutroomspanel,u.p.calendar,u.p.callablechannels,u.p.callsmain,u.p.chats,u.p.channels,u.p.schedulingform,u.p.search,u.p.store,u.p.transcriptcontent]);var Eq;!function(e){e.mainActive="mainActive",e.mainContentRecord="mainContentRecord"}(Eq||(Eq={}));class Aq{constructor(e){this.entityTypeLimit=e,this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.activeWindowIds=new Set}update(e,t){Object.keys(this.active).forEach((e=>{this.active[e]=0})),this.activeWindowIds.clear(),e.forEach((e=>{const n=e.activeEntities.mainEntity.type;this.allEntityTypes.add(n),this.activeWindowIds.add(e.id),Tq(this.active,n,this.entityTypeLimit),Iq.has(n)&&this.usedEntityTypes.add(n),!this.isFirstUse(n)&&this.wasInPreviousUpdate(e,t)||Tq(this.record,n,this.entityTypeLimit)}))}getStats(){return{mainActive:this.active,mainContentRecord:this.record,allEntityTypes:Array.from(this.allEntityTypes),usedEntityTypes:Array.from(this.usedEntityTypes),activeWindowIds:Array.from(this.activeWindowIds)}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const n=t.find((t=>t.id===e.id));return!!n&&n.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type&&n.activeEntities.mainEntity.id===e.activeEntities.mainEntity.id&&n.correlation.id===e.correlation.id}}const _q=new Set([u.p.calls,u.p.chats,u.p.channels,u.p.extensions,u.p.schedulingform]);var Dq;!function(e){e.popOutActive="popOutActive",e.popOutRecord="popOutRecord"}(Dq||(Dq={}));class Fq{constructor(e){this.entityTypeLimit=e,this.active={},this.record={},this.allEntityTypes=new Set,this.usedEntityTypes=new Set,this.activeWindowIds=new Set}update(e,t){Object.keys(this.active).forEach((e=>{this.active[e]=0})),this.activeWindowIds.clear(),e.forEach((e=>{const n=e.activeEntities.mainEntity.type;this.allEntityTypes.add(n),this.activeWindowIds.add(e.id),Tq(this.active,n,this.entityTypeLimit),_q.has(n)&&this.usedEntityTypes.add(n),!this.isFirstUse(n)&&this.wasInPreviousUpdate(e,t)||Tq(this.record,n,this.entityTypeLimit)}))}getStats(){return{popOutActive:this.active,popOutRecord:this.record,allEntityTypes:Array.from(this.allEntityTypes),usedEntityTypes:Array.from(this.usedEntityTypes),activeWindowIds:Array.from(this.activeWindowIds)}}isFirstUse(e){return!this.record[e]}wasInPreviousUpdate(e,t){const n=t.find((t=>t.id===e.id));return!!n&&n.activeEntities.mainEntity.type===e.activeEntities.mainEntity.type}}const Mq=e=>Object.keys(e).reduce(((t,n)=>t+e[n]),0),Rq=(e,t)=>{const n=Array.from(e).filter((e=>{var n;return!(null===(n=e.windowLeakInfo)||void 0===n?void 0:n.windowLeakInfoWindowId)||!t.includes(e.windowLeakInfo.windowLeakInfoWindowId)})).map((e=>{var t;const{windowLeakInfoEntityType:n=""}=null!==(t=e.windowLeakInfo)&&void 0!==t?t:{};return e.viewportContext===hb.R.primary?`main:${n}`:n}));return{allEntityTypes:Array.from(new Set(n)),memActive:n.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{})}};class Pq{constructor({client:e,leakDetectorService:t,entityTypeStatsLimit:n}){this.isBackInMain=!1,this.main=new Aq(null!=n?n:20),this.popOut=new Fq(null!=n?n:20),this._activeWindowsSubscription=(0,NS.G)(e.watchQuery({query:Nq})).pipe((0,rS.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,aS.U)((({data:{activeWindows:e}})=>(this.isBackInMain=e.some((e=>e.id===De.ew)),e))),(0,mC.G)()).subscribe((([e,t])=>{this.update(e,t)})),this.leakDetectorService=t}destroy(){this._activeWindowsSubscription.unsubscribe()}getStats(){var e,t,n;const a=null===(e=this.leakDetectorService)||void 0===e?void 0:e.getReachableObjects(JN.I.UnwrappedWindow),o=this.main.getStats(),{activeWindowIds:r}=o,s=(0,i.__rest)(o,["activeWindowIds"]),l=this.popOut.getStats(),{activeWindowIds:d}=l,c=(0,i.__rest)(l,["activeWindowIds"]),u=Mq(c.popOutActive),m={backInMain:this.isBackInMain?{allEntityTypes:s.allEntityTypes,usedEntityTypes:s.usedEntityTypes,backInMainActive:s.mainActive,backInMainActiveCount:Mq(s.mainActive),backInMainContentRecord:s.mainContentRecord}:void 0,t2main:this.isBackInMain?void 0:{allEntityTypes:s.allEntityTypes,usedEntityTypes:s.usedEntityTypes,t2MainActive:s.mainActive,t2MainActiveCount:Mq(s.mainActive),t2MainContentRecord:s.mainContentRecord},popOut:Object.assign(Object.assign({},c),{popOutActiveCount:u,hasActivePopout:u>0}),windowCount:null==a?void 0:a.size,inMem:a?Rq(a,[...r,...d]):void 0,windows:a?Array.from(a).map((e=>{var t;const{windowLeakInfoEntityType:n,windowLeakInfoWindowId:i}=null!==(t=e.windowLeakInfo)&&void 0!==t?t:{};return{windowLeakInfoWindowId:i,windowLeakInfoEntityType:n,viewportContext:e.viewportContext}})):void 0};return Object.assign(Object.assign({},m),{windowLeaks:void 0===m.windowCount?void 0:m.windowCount-(null!==(n=null===(t=m.t2main)||void 0===t?void 0:t.t2MainActiveCount)&&void 0!==n?n:0)-m.popOut.popOutActiveCount})}update(e,t){this.main.update(t.filter((e=>e.isMainWindow)),e.filter((e=>e.isMainWindow))),this.popOut.update(t.filter((e=>!e.isMainWindow)),e.filter((e=>!e.isMainWindow)))}}class Oq{constructor(e){this.context=e,this.inited=!1,this.logger=e.loggerFactory.newLogger("WindowTrackerService")}init(){var e;if(!this.inited){const{client:t,leakDetectorService:n,coreSettings:i}=this.context,a=(null!==(e=this.logger.errorToTelemetry)&&void 0!==e?e:this.logger.error).bind(this.logger);if(t){this.inited=!0;try{this.windowEntityTypeStats=new Pq({client:t,leakDetectorService:n,entityTypeStatsLimit:null==i?void 0:i.get(K.J.Core).entityTypeStatsLimit})}catch(e){a("Failed to initialize WindowEntityTypeStats","webclient_framework_window_tracker_service")}}else a("Failed to initialize WindowEntityTypeStats - missing client","webclient_framework_window_tracker_service")}}getTelemetry(){var e;return this.inited||this.init(),null===(e=this.windowEntityTypeStats)||void 0===e?void 0:e.getStats()}}function xq(e,t){const n=e.location.hostname;return t&&t!==n}var Lq=n(109874);function Uq(e,t,n,i,a,o){const r=o&&o.delta||0,s=function(e,t,n){let i;switch(e){case"share-to-teams":i=function(e,t){let n;if(t.performance&&t.performance.navigation&&0===t.performance.navigation.type){const{s:i}=e.getSearchState();if(i)n=parseInt(i,10);else{const e="outlook"===t.document.head.dataset.host,i=t.localStorage.getItem(Lq.qB.STT_START_TIME);e&&i&&(n=parseInt(i,10),t.localStorage.removeItem(Lq.qB.STT_START_TIME))}}return n}(t,n)}return i}(e,i,a),l=s?{name:ft.ck.ClickTimeAction,timestamp:n-r}:void 0,d=l?[l]:[];o&&d.push({name:o.name,timestamp:n});const c=s||n-r,u=t.newScenario(ft.RG.ExperienceReady,{startTime:c});d.forEach((e=>{u.mark(e.name,{overrideTimestamp:e.timestamp})}))}function Bq(e,t,n,i,a,o,r={cached:!1}){const s={name:e,delta:0},l=QA(e,t,n,i.performance,o);return void 0!==l&&(s.delta=l,a.createScenarioWithoutStarting(e).stop({delta:l,cached:r.cached})),s}var jq=n(790688),Wq=n(665790),Vq=n(255850),Hq=n(216967),$q=n(870319);const zq="Teams",Gq=/(windows|win32)/i,qq=/ arm;/i,Qq=/windows\sphone\s\d+\.\d+/i,Jq=/(macintosh|mac os x|mac)/i,Yq=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,Kq=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,Zq=/android/i,Xq=(e,t)=>{var n,i;if(t){const a=null!==(n=e.get(K.J.Telemetry).workerEnabled)&&void 0!==n&&n,o=null!==(i=e.get(K.J.Telemetry).enableSharedWorker)&&void 0!==i&&i,r=a?o?"shared":"dedicated":"embed",{coreSecurityService:s,windowBaseUrl:l}=t,d=s.getTrustedTypePolicy("@msteams/core-services-telemetry-worker#TelemetryWorker");return{workerType:r,workerUrlCallback:e=>d.createScriptURL(e,l)}}return{workerType:"embed",workerUrlCallback:e=>e}},eQ=(e,t,n)=>{jq.H.getInstance().initialize(t);const i=new Wq.O(t);return Lw.ip.getInstance().initialize(e,n),{eventSuppression:jq.H.getInstance(),columnSuppression:i,telemetrySender:Lw.ip.getInstance()}},tQ=(e,t,n,i)=>{var a;const{clientType:o,userAgent:r}=n.config,{deviceId:s,sessionId:l,sessionStartTime:d}=n.host,c=i.get(K.J.Telemetry),{defaultToken:u,enableSharedWorker:m,isSilent:g,telemetryServer:p,enableCustomCacheSize:v,eventsLimitInMem:h,normalPrioritySendTimeInSecs:f,highPrioritySendTimeInSecs:y,autoFlushPercent:k,enableOneDsSdkNs:S,oneDsCollectorUrl:b,enableCompression:C,enablePrivacyGuard:w,enableLoggingGlobalDeviceId:N,privacyGuardIngestionToken:T,disableMTMAPrimaryId:I,debugMenuCaptureContext:E,debugMenuCaptureEvents:A}=c,{sharedWorkerUrl:_}=i.get(K.J.Host),D=null===(a=null==i?void 0:i.get(K.J.Core))||void 0===a?void 0:a.enableMTMA;if(!p||!u)throw t.error("Telemetry server url or app token not supplied. This is required by Aria"),(0,Mn.Tr)("telemetry-initialization",De.jK.Undefined,"init");const F=(e=>{let t=e;return t||(t=(0,mt.v4)()),t})(s),M=e.windowType!==Hq.N.Anglr?"NS":"",R={userAgent:r,firstLaunchTime:e.appStartTime,tablePostfix:M,deviceId:F},P={debugMenuCaptureContext:!!E,debugMenuCaptureEvents:!!A},O=new Vq.Mk;return O.collectorUrl=p,v&&h&&(O.eventsLimitInMem=h),{config:O,appTokens:{default:u},documentInfo:R,debugMenuSettings:P,isSilent:!!g,sessionId:l||void 0,sessionStartTime:d,clientType:o,sharedWorkerUrl:_||void 0,enableSharedWorker:!!m,eventsLimitInMem:h||3e3,normalPrioritySendTimeInSecs:f||15,highPrioritySendTimeInSecs:y||15,autoFlushPercent:k||.33,enableOneDsSdkNs:!!S,oneDsCollectorUrl:b||void 0,enableCompression:!!C,enablePrivacyGuard:!!w,enableLoggingGlobalDeviceId:!!N,privacyGuardIngestionToken:T||void 0,enableMTMA:D||void 0,disableMTMAPrimaryId:!!I,createTelemetryWorkerFn:$q.w}},nQ=(e,t,n,i,a,o,r,s,l)=>{var d;const{browser:c,browserVersion:u,clientContext:m,clientType:g,clientVersion:p,osPlatform:v,osVersion:h,platformId:f}=n.config,{bootType:y,panelContext:k,sessionId:S,startReason:b}=n.host,C=i.get(K.J.Telemetry),{defaultToken:w,telemetryServer:N,disableRingNamePrefixing:T,disablePlatformServiceOsVersion:I}=C,E=i.get(K.J.Metadata),{hostAppWebVersion:A}=i.get(K.J.Host);if(!N||!w)throw t.error("Telemetry server url or app token not supplied. This is required by Aria"),(0,Mn.Tr)("telemetry-initialization",De.jK.Undefined,"init");const _=E.environment===Sb.s.life?Iz.OV.Life:Iz.OV.Work,D=Pz(E,iQ(!!T,e,o),l).ring,F=dQ(a.userAgent),M=uQ(a.userAgent),R=mQ(!!C.enableRegexRemoval,v),P=gQ(v),O=vQ();r.setContext("AppInfo.ClientType",null!==(d=e.clientTypeTelemetry)&&void 0!==d?d:g),r.setContext("AppInfo.ClientContext",m),r.setContext("AppInfo.HostAppVersion",F),r.setContext("AppInfo.ProcessArchitecture",M),r.setContext("AppInfo.WebVersion",A),A&&r.setContext("AppInfo.HostAppWebVersion",lQ(A)),r.setContext("AppInfo.Language",s.localeCode),r.setContext("AppInfo.Locale",s.localeCode),r.setContext("AppInfo.PlatformId",f);const x=cQ(p,A);C.enableEnhancedTelemetry?r.setContext("AppInfo.Version",x):r.setContext("AppInfo.Version",p),r.setContext("AppInfo.VersionNew",x),r.setContext("AppInfo.ReactAppVersion",p),r.setContext("AppInfo.ExperienceName",e.experienceName),r.setContext("DeviceInfo.OsName",P),I||r.setContext("DeviceInfo.OsVersion",h),r.setContext("DeviceInfo.OsFamily",R),r.setContext("EventInfo.isNS",!0),r.setContext("Panel.Context",k),r.setContext("Session.Id",S),r.setContext("startReason",b),r.setContext("UserInfo.Language",s.userLanguage),r.setContext("UserInfo.Ring",D),r.setContext("UserInfo.TimeZone",O),r.setContext("userAgent",a.userAgent),r.setContext("Window.Type",e.windowType),r.setContext("DeviceInfo.BrowserName",c),r.setContext("DeviceInfo.BrowserVersion",u),r.setContext("DeviceInfo.Id",a.deviceId),r.setContext("Tenant.Model",_),r.setContext("Session.TelemetryContext","web"),r.setContext("AppInfo.BootType",y),r.setContext("UserInfo.UserLocale",s.originLocaleCode),r.setContext("UserInfo.OSorBrowserLocale",Ye.Bh.Desktop===g||Ye.Bh.Maglev===g?s.osLocale:s.userLanguage),r.setContext("telemetryRegionFetchComplete",C.telemetryRegionFetchComplete),r.setContext("UserInfo.TelemetryRegion",C.telemetryRegion),aQ(i,r,e,o,l),oQ(i,r),rQ(x,i,r)},iQ=(e,t,n)=>!(!n||"react-web-client"!==t.experienceName)||e,aQ=(e,t,n,i,a)=>{const o=e.getObservable(K.J.Metadata),{disableRingNamePrefixing:r}=e.get(K.J.Telemetry);if(o.subscribe((e=>{null==a||a.updateWebExperimentConfigMetadata(e),null==a||a.communicateWithHost();const o=Pz(e,iQ(!!r,n,i),a);t.setContext("UserInfo.Ring",o.ring),t.setContext("UserInfo.ETag",o.eTag),t.setContext("UserInfo.HostETag",o.hostETag),t.setContext("AppInfo.ExpIds",o.expIds),t.setContext("AppInfo.Environment",o.environment)})),a){a.ecmObservable.subscribe((e=>{const n=e.find((e=>e.client===Fz.t)),i=e.map((e=>e.config.expIds)).filter((e=>e.length>0)).join(",");t.setContext("UserInfo.HostETag",null==n?void 0:n.config.eTag),t.setContext("AppInfo.ExpIds",i)}))}},oQ=(e,t)=>{e.getObservable(K.J.UserResources).subscribe((e=>{const n=e.licenseType||void 0;t.setContext("UserInfo.LicenseType",n)}))},rQ=(e,t,n)=>{t.getObservable(K.J.Host).subscribe((i=>{i&&sQ(e,t,n,i)}))},sQ=(e,t,n,i)=>{const{enableEnhancedTelemetry:a,enableGetUserTypeFromHost:o}=t.get(K.J.Telemetry),r=i.desktopVersion||void 0,s=r?e.concat(",",r):e;r&&n.setContext("AppInfo.DesktopVersion",r),n.setContext("AppInfo.VersionNew",s),i.systemManufacturer&&n.setContext("DeviceInfo.Make",i.systemManufacturer),i.systemProductName&&n.setContext("DeviceInfo.Model",i.systemProductName),n.setContext("rendererCount",i.rendererCount),a&&n.setContext("AppInfo.Version",s),n.setContext("AppInfo.WebVersion",i.hostAppWebVersion),i.hostAppWebVersion&&n.setContext("AppInfo.HostAppWebVersion",lQ(i.hostAppWebVersion)),o&&i.userType&&n.setContext("userType",i.userType)},lQ=e=>{let t="";const n=e.indexOf("/");return n>-1&&(t=e.substring(n+1,e.length)),t},dQ=e=>{let t;const n=e.indexOf(zq);if(n>-1){t=e.substring(n+zq.length+1);const i=t.indexOf(" ");t=t.substring(0,i)}return t},cQ=(e,t)=>t?e.concat(",",t):e,uQ=e=>{let t=Iz.Wz.unknown;return pQ(e,Iz.Wz.x64)?t=Iz.Wz.x64:pQ(e,Iz.Wz.x86)?t=Iz.Wz.x86:pQ(e,Iz.Wz.ia32)&&(t=Iz.Wz.ia32),t},mQ=(e,t)=>{if(!e){let e=Iz.Zc.UNKNOWN;const n=(null==t?void 0:t.match(Gq))||(null==t?void 0:t.match(qq))||(null==t?void 0:t.match(Qq)),i=(null==t?void 0:t.match(Kq))||(null==t?void 0:t.match(Zq)),a=(null==t?void 0:t.match(Jq))||(null==t?void 0:t.match(Yq));return n?e=Iz.Zc.WINDOWS:i?e=Iz.Zc.UNIX:a&&(e=Iz.Zc.MACOSX),e}switch(t){case Ye.NR.Windows:case Ye.NR.WindowsPhone:return Iz.Zc.WINDOWS;case Ye.NR.ChromeOS:case Ye.NR.Android:case Ye.NR.Linux:return Iz.Zc.UNIX;case Ye.NR.IOS:case Ye.NR.Mac:return Iz.Zc.MACOSX;default:return Iz.Zc.UNKNOWN}},gQ=e=>{switch(e){case Ye.NR.Windows:return"Windows";case Ye.NR.Mac:return"Mac OS X";case Ye.NR.Linux:return"Linux";case Ye.NR.ChromeOS:return"Chrome OS";case Ye.NR.Android:return"Android";case Ye.NR.IOS:return"iOS";case Ye.NR.WindowsPhone:return"Windows Phone";case Ye.NR.Unknown:return"Unknown";default:return e}},pQ=(e,t)=>!!(e.indexOf(t)>-1),vQ=()=>{const e=(new Date).getTimezoneOffset();let t=e%60,n=(e-t)/60;const i=n>0?"-":"+";t=Math.abs(t),n=Math.abs(n);const a=t<10?`0${t}`:t.toString();return`${i}${n<10?`0${n}`:n.toString()}:${a}`};class hQ extends Fe{constructor(){super(De.Yg.InitTelemetry,["coreSettings","coreSettingsContext","diagnosticsService","windowProvider","telemetryContextService","loggerFactory"])}execute(e){var t,n,a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.loggerFactory.newLogger("init-telemetry-task"),r=e.coreSettings.get(K.J.Telemetry),s=this.createMemoryAnalyzer(e.windowProvider,r);r.disableAriService||(e.appResponsivenessService=new vq(e.windowProvider,{loggerFactory:e.loggerFactory,windowProvider:e.windowProvider,coreSettings:e.coreSettings})),e.dataClientTrackingService=this.createDataClientTrackerService(e),this.createWindowTrackerService(e),yield this.createHeartbeatMonitor(e);const{crossClientRegistrationMethods:l,desktopActiveScenarios:d,desktopContext:c,deviceInfo:u,finalizeLegacyCrossClient:m,notifyDesktopScenarioFactoryReady:g,systemCpuInfo:p,systemMemoryInfo:v}=yield this.initializeCrossClientTelemetry(i,e.hostCommunicationService),h={deviceInfo:u,systemCpuInfo:p,systemMemoryInfo:v},f=this.createCoreScenarioFactory(e,s,m,d,l);null==g||g(),null===(t=e.hostCommunicationService)||void 0===t||t.setScenarioFactory(f),e.diagnosticsService.setScenarioFactory(f),e.coreSettingsContext.setScenarioFactory(f),yield this.createCoreTelemetryService(e,s,f,h,e.telemetryContextService,c),null===(o=null===(a=null===(n=e.windowProvider)||void 0===n?void 0:n.loader)||void 0===a?void 0:a.stopPieTimer)||void 0===o||o.call(a),this.createCoreUserBiService(e),this.startAppStartScenarios(e,f),e.altScenarioService=new hq({host:e.windowProvider,loggerFactory:e.loggerFactory,coreSettings:e.coreSettings,scenarioFactory:f});const y=new qz(f,e.telemetryContextService,s);e.hostCommunicationService&&(yield this.handOffContextCommsCallback(e.hostCommunicationService,e.coreSettings,y))}))}initializeCrossClientTelemetry(e,t){var n,a,o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i={};if(t){try{const e=yield t.loadModule("scenario");e&&(e.getActiveScenarios&&(i.desktopActiveScenarios=yield e.getActiveScenarios({})),e.setScenarioCompletion&&(i.finalizeLegacyCrossClient=e.setScenarioCompletion),i.crossClientRegistrationMethods={},e.registerForScenarioMark&&e.registerForScenarioStart&&e.registerForScenarioStop&&(i.crossClientRegistrationMethods.marks={registerForScenarioStart:e.registerForScenarioStart,registerForScenarioMark:e.registerForScenarioMark,registerForScenarioStop:e.registerForScenarioStop}),e.registerForScenarioAppendEventData&&(i.crossClientRegistrationMethods.appendEventData=e.registerForScenarioAppendEventData),i.notifyDesktopScenarioFactoryReady=()=>{var t;null===(t=e.setWebAvailability)||void 0===t||t.call(e,!0)})}catch(t){e.errorToTelemetry&&e.errorToTelemetry(mI.LoadModuleScenarioFailed,"webclient_framework_host_comms",void 0,!0)}try{const e=yield t.loadModule("osutils");e&&(i.deviceInfo=yield null===(n=e.getDeviceInfo)||void 0===n?void 0:n.call(e),i.systemCpuInfo=yield null===(a=e.getSystemCpuInfo)||void 0===a?void 0:a.call(e),i.systemMemoryInfo=yield null===(o=e.getSystemMemoryInfo)||void 0===o?void 0:o.call(e))}catch(t){e.errorToTelemetry&&e.errorToTelemetry(mI.LoadModuleOsUtilsFailed,"webclient_framework_host_comms",void 0,!0)}try{const e=yield t.loadModule("telemetry");i.desktopContext=yield null===(r=null==e?void 0:e.getContext)||void 0===r?void 0:r.call(e,{columns:["launchIntent","desktopVersion","deviceAuthToken","windowsChannel","windowsSku","storageInfo","outOfProcState"]})}catch(t){e.errorToTelemetry&&e.errorToTelemetry(mI.LoadModuleTelemetryFailed,"webclient_framework_host_comms",void 0,!0)}}return i}))}handOffContextCommsCallback(e,t,n){var a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield e.loadModule("telemetry"),r=yield null===(a=null==i?void 0:i.getPreAuthUserSamplingId)||void 0===a?void 0:a.call(i);if(r&&(null===(o=this.setPreAuthUserId)||void 0===o||o.call(this,t,n,r)),i&&i.setContext){const e=i.setContext;(0,DC.G)().setMultiContextCallback(((t,n,i)=>e([{column:t,value:n,userContextId:i}])))}}))}createMemoryAnalyzer(e,t){const{enableDesktopMemoryAnalyzer:n,isScenarioMemorySnapshotEnabled:i}=t;return n?new fq(!!i,e):void 0}createCoreScenarioFactory(e,t,n,i,a){const o=new Ez.J({parentScenarioFactory:e.scenarioFactory,coreSettings:e.coreSettings,platformService:e.platformService,loggerFactory:e.loggerFactory,hostCommunicationService:e.hostCommunicationService,windowProvider:e.windowProvider,authenticationUser:e.authenticationUser,correlation:e.correlation},e.config.startTimeMS,t,void 0,void 0,void 0,void 0,i,a,n);return e.scenarioFactory=o,o}createHeartbeatMonitor(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=new rz(e);yield t.start(),e.heartbeatMonitor=t}))}createDataClientTrackerService(e){const t=e.platformService.config.clientType===Ye.Bh.Maglev?()=>!!e.clientState&&[VS.pk.Inactive,VS.pk.LongInactive].includes(e.clientState.getState()):()=>!!e.appStateService&&[De.eT.Inactive,De.eT.LongInactive].includes(e.appStateService.getState());return new wq(e.coreSettings,e.leakDetectorService,e.userTrackingService,t)}createWindowTrackerService(e){e.windowTrackerService=new Oq(e)}createCoreTelemetryService(e,t,n,a,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{config:i,coreSettings:s,coreSecurityService:l,experimentationService:d,hostCommunicationService:c,loggerFactory:u,platformService:m,routingServices:g,windowProvider:p}=e,v=yield jH(c),h=(0,xH.pf)(p),f={osLocale:v,userLanguage:BH(p),localeCode:WH(p,g,h.localeCode),originLocaleCode:VH(p,g,h.localeCode)},{telemetryContext:y}=((e,t,n,i,a,o,r,s)=>{const l=t.newLogger("Telemetry"),d=tQ(e,l,n,i),c=r||new bz.v(l),{columnSuppression:u}=eQ(t.newLogger("TelemetrySender"),i,d.documentInfo.tablePostfix),m=Xq(i,o);return(0,DC.G)().initialize(d,l,i,m,u),nQ(e,l,n,i,d.documentInfo,!1,c,a,s),{telemetryContext:c}})({appStartTime:i.startTimeMS,experienceName:i.experienceName,windowType:i.windowType,clientTypeTelemetry:i.clientTypeTelemetry},u,m,s,f,{coreSecurityService:l,windowBaseUrl:p.document.location.origin},o,d),k=new qz(n,y,t);if(p.localStorage){const e=p.localStorage.getItem("ts.latestOid");null==k||k.setContext("UserInfo.Id",e)}i.externalCorrelationId&&k.setCoreContext("EventInfo.ExternalCorrelationId",i.externalCorrelationId),i.embedContext&&(k.setCoreContext("Window.EmbedContext",i.embedContext),k.setCoreContext("AppInfo.EmbedReferrer",function(e,t){try{const{referrer:n}=t.getSearchState(),i=e.document.referrer,a=e.parent.opener;let o=n;return xq(e,o)||(o=i&&(0,YN.Lp)(i),xq(e,o)||(o=a&&a.location&&a.location.hostname||void 0,!xq(e,o)&&e.location.ancestorOrigins&&e.location.ancestorOrigins.length>0&&(o=e.location.ancestorOrigins[0]))),o||""}catch(e){return""}}(p,g.state))),this.setTelemetryContext(k,a,r),k.setCoreContext("AppInfo.ArchVersion","V2"),e.telemetryService=k}))}setPreAuthUserId(e,t,n){const i=e.get(K.J.Telemetry);n&&i.enablePreAuthIdSampling&&(t.setCoreContext("AppInfo.PreAuthUserSamplingId",n),jq.H.getInstance().setSamplingByPreAuthId(n))}createCoreUserBiService(e){var t;const{config:n}=e,i=null===(t=e.telemetryService)||void 0===t?void 0:t.createUserBiService(e,De.ew,{id:(0,mt.v4)(),source:Ot.D.StandAlone,startTimestamp:n.startTimeMS});e.userBiService=i}setTelemetryContext(e,t,n){const{deviceInfo:i,systemCpuInfo:a,systemMemoryInfo:o}=t;if(i&&(e.setCoreContext("DeviceInfo.Make",i.make),e.setCoreContext("DeviceInfo.Model",i.model),e.setCoreContext("DeviceInfo.CpuArchitecture",i.cpuArchitecture),e.setCoreContext("DeviceInfo.OsVersion",i.osVersion)),a&&(e.setCoreContext("CpuInfo.Cores",a.cpuCores.length.toString()),e.setCoreContext("CpuInfo.Model",a.cpuCores[0].model),e.setCoreContext("CpuInfo.Speed",a.cpuCores[0].speed)),o&&e.setCoreContext("DeviceInfo.TotalMemory",o.totalPhysicalMemoryBytes),n&&0!==n.length){const t=n.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.column]:t.value})),{}),i=t.launchIntent,a=t.desktopVersion,o=t.deviceAuthToken,r=t.windowsChannel,s=t.windowsSku,l=t.storageInfo,d=t.outOfProcState;i&&e.setCoreContext("AppInfo.LaunchIntent",i),a&&e.setCoreContext("AppInfo.DesktopVersion",a),d&&e.setCoreContext("AppInfo.OutOfProcState",d),o&&e.setDeviceAuthToken(o),r&&e.setCoreContext("DeviceInfo.WindowsChannel",r),s&&e.setCoreContext("DeviceInfo.WindowsSku",s),l&&e.setCoreContext("DeviceInfo.StorageInfo",l)}}startAppStartScenarios(e,t){const{config:n,loggerFactory:i,routingServices:a,telemetryService:o,windowProvider:r}=e,s=this.getDownloadAndParseStepData(i,t,r);null==o||o.newCoreScenario(ft.RG.AppStart,{startTime:n.startTimeMS}),Uq(n.experienceName,t,n.startTimeMS,a.state,r,s)}getDownloadAndParseStepData(e,t,n){let i;if(n.performance){const a=e.newLogger("InitTelemetryTask");n.performance.timing&&t.createScenarioWithoutStarting(ft.RG.DomLoadingStart,{startTime:n.performance.timing.domLoading}).stop();const o=n.performance.getEntriesByType("resource").find((e=>"script"===e.initiatorType&&e.name.indexOf("main")>=0)),r=void 0!==o&&0===o.transferSize;i=Bq(ft.RG.DownloadAndParse,"execute-index-html-script","start-execute-main-bundle",n,t,a,{cached:r}),Bq(ft.RG.ResolveMainImports,"start-execute-main-bundle","resolve-main-imports-end",n,t,a)}return i}}var fQ=n(295670);class yQ extends Fe{constructor(){super(De.Yg.InitUserBrbServiceTask,["scenarioFactory","loggerFactory","coreSettings","logsCollectorService","authenticationService","authenticationUser","platformService","discover","windowProvider","hostCommunicationService","endpointsManager","brbServiceManager","client","i18n"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:t,loggerFactory:n,coreSettings:i,logsCollectorService:a,authenticationService:o,authenticationUser:r,platformService:s,discover:l,windowProvider:d,hostCommunicationService:c,endpointsManager:u,brbServiceManager:m,client:g,i18n:p}=e;if(!r)throw new Error("authenticationUser is invalid, cannot register user brb service.");const v=(0,li.b)(r);return m.registerUserBrbService(v,(()=>new fQ.w(n,i,a,o,s,l,d,c,u,t,p,r,g))),e=>{switch(e){case"signout":m.unregisterUserBrbService(v);break;default:return}}}))}}class kQ extends Fe{constructor(){super(De.Yg.RegisterCustomFrameThemes,["coreSettings","hostCommunicationService"])}execute(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:i,hostCommunicationService:a}=e,{primaryWindowTitleBarHeightPx:o,secondaryWindowTitleBarHeightPx:r}=i.get(K.J.Core),s=yield a.loadModule("windowcontrols");o&&r&&(null===(t=null==s?void 0:s.defineCustomFrameTheme)||void 0===t||t.call(s,"main",{buttonHeight:o,buttonWidth:44}),null===(n=null==s?void 0:s.defineCustomFrameTheme)||void 0===n||n.call(s,"default",{buttonHeight:r,buttonWidth:44}))}))}}var SQ=n(60952);class bQ extends Fe{constructor(){super(De.Yg.ReloadExperience,["coreSettings","platformService","rebootService","loggerFactory","scenarioFactory","windowProvider"]),this.isReloadRequired=(e,t)=>e&&t&&e!==t}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,platformService:n,rebootService:i,loggerFactory:a,scenarioFactory:o,windowProvider:r}=e,s=a.newLogger("ReloadExperienceTask"),{buildRing:l,assignedRing:d}=this.getRings(n,t);if(this.isReloadRequired(l,d)&&d){s.log(`Reload required: Assigned: ${d}, Build: ${l}`);return(yield i.rebootApp(ET.Z.RingSwitch,ET.d.ReloadAppTask,{qsps:{ring:d},maxRetries:1}))?this.deleteEcsCaches(r):this.reportReloadNotTriggered(l,d,s,o),e=>{switch(e){case"signout":i.clearRetryCount(ET.d.ReloadAppTask);break;default:return}}}s.debug(`No reload required: Assigned: ${d}, Build: ${l}`),i.clearRetryCount(ET.d.ReloadAppTask)}))}getRings(e,t){const{ring:n}=t.get(K.J.Metadata);return{assignedRing:(null==n?void 0:n.id)||void 0,buildRing:e.ecsOverrides.ring||void 0}}reportReloadNotTriggered(e,t,n,i){n.warn(`Ring Discrepancy: Assigned: ${t}, Build: ${e} `),i.createScenarioWithoutStarting(ft.RG.BuildRingDiscrepancy).fail({message:e})}deleteEcsCaches(e){Object.keys(e.localStorage).filter((e=>e.endsWith(SQ.Z.EcsCache))).forEach((t=>e.localStorage.removeItem(t)))}}class CQ extends Fe{constructor(){super(De.Yg.SetRingFinderCookieTask,["authenticationUser","coreSettings","loggerFactory","windowProvider","discover"]),this.setAuthCookie=(e,t,n,i)=>{var a;if(void 0===(null===(a=e.document)||void 0===a?void 0:a.cookie))return void t.warn(`Cannot set cookie: '${n}'.`);t.log(`Setting '${n}' cookie.`);const o=new Date,r=o.setMonth(o.getMonth()+5);e.document.cookie=`${n}=${i};expires=${new Date(r).toUTCString()};path=/;secure;samesite=none`},this.cleanUpCookie=(e,t,n)=>{var i;void 0!==(null===(i=e.document)||void 0===i?void 0:i.cookie)&&(t.log(`Expiring '${n}' cookie.`),e.document.cookie=`${n}=;max-age=0;path=/;secure;samesite=none`)}}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n,discover:i,loggerFactory:a,windowProvider:o}=e,r=a.newLogger("SetRingFinderCookieTask");try{const{windowsInsiderChannel:e}=n.get(K.J.Host),{enableRegionParamForPDS:a}=n.get(K.J.Core);let s;a&&(s=yield i.getRegion({id:t.id,tenantId:t.profile.tenantId,oid:t.profile.objectId,accountType:t.type,userName:t.loginUserName||""}));const l={oid:t.profile.objectId,tid:t.profile.tenantId,wip:e,region:s},d="ringFinder";return this.setAuthCookie(o,r,d,encodeURIComponent((0,Ci.u4)(l))),e=>{switch(e){case"signout":this.cleanUpCookie(o,r,d);break;default:return}}}catch(e){r.error(`Failed to set ring finder cookie: ${(0,Mn.VK)(e)}`)}}))}}class wQ extends Fe{constructor(){super(De.Yg.SetPrimaryUserOnTelemetry,["primaryUser","loggerFactory","telemetryContextService","hostCommunicationService"])}execute(e){var t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{primaryUser:i,loggerFactory:o,telemetryContextService:r,hostCommunicationService:s}=e;try{const e=(0,li.b)(i),n=i.profile.tenantId;r.setPrimaryUser(e,n);const a=yield s.loadModule("telemetry");null===(t=null==a?void 0:a.setPrimaryUser)||void 0===t||t.call(a,e,n)}catch(e){const t=new zS.G(zS.$.TELEMETRY_PRIMARY_USER_SET_FAILURE,e,(0,li.b)(i));null===(a=(n=o.newLogger("SetUserOnTelemetryContext")).error)||void 0===a||a.call(n,t.toTelemetryEntry())}}))}}class NQ{constructor(){this.id=De.Yg.SetUserOnDiagnosticsService}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{authenticationUser:t,coreSettings:n,diagnosticsService:i,logsCollectorService:a,platformService:o}=pD("SetUserOnDiagnosticsServiceTask",e,"authenticationUser","coreSettings","diagnosticsService","logsCollectorService","platformService");a.setPrimaryUserID(t.id);const{enableMTMA:r}=n.get(K.J.Core);if(r){const n=i.createUserDiagnosticsService(t.profile.tenantId,t.profile.objectId,o.host.sessionId,t.id);n&&(e.diagnosticsService=n,a.registerUserLogsProvider(t.id,n),e.loggerFactory=new hS.m(n,e.loggerFactory.cID))}else i.updateDiagnosticInfo(t.profile.tenantId,t.profile.objectId);return e=>{switch(e){case"quit":i.persistDiagnosticsAsPreviousSessionLogs();break;case"signout":t.id&&a.handleUserLogout(t.id),i.handleUserLogout(t.id)}}}))}}function TQ(e){return!!(null==e?void 0:e.isAuthenticated)}function IQ(e,t){const{enableTflFreProfileConsentDialog:n}=e.get(K.J.Fre);return!(!n||t&&"true"===t.get("TflFreProfileCardDisplayed"))}class EQ extends Fe{constructor(){super(De.Yg.SignalCoreLifecycleChangesTask,["authenticationUser","client","clientState","config","coreSecurityService","coreSettings","coreUtilities","correlation","entityCommanding","experienceChangeReportingService","experienceLifecycleManager","hostCommunicationService","i18n","i18NextWrapper","localStorage","loggerFactory","networkState","platformService","rebootService","scenarioFactory","userBiService","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{activeWindowsHistoryService:t,authenticationUser:n,client:a,clientState:o,clientAccessAdminPolicyCheckService:r,config:s,coreSecurityService:l,coreSettings:d,coreUtilities:{isEntityInView:c},correlation:u,entityCommanding:m,experienceChangeReportingService:g,experienceLifecycleManager:p,hostCommunicationService:v,i18n:h,i18NextWrapper:f,localStorage:y,loggerFactory:k,networkState:S,platformService:b,rebootService:C,scenarioFactory:w,userBiService:N,userTrackingService:T,windowProvider:I}=e,E=k.newLogger("SignalCoreLifecycleChangesTask");if(!n||!TQ(n))return void E.warn("Not creating user lifecycle manager as authenticated user is not available.");const{disableExperience:A}=d.get(K.J.Core);if(A)return void E.warn("Not creating user lifecycle manager as experience is disabled.");if(r&&!r.isUserAllowed())return void E.warn("Not creating user lifecycle manager as experience is disabled by admin policy.");const _=u.id,D=(0,li.b)(n);return p.manageUser(D,{activeWindowsHistoryService:t,authenticationUser:n,client:a,clientState:o,config:s,coreSecurityService:l,coreSettings:d,entityCommanding:m,i18n:h,i18NextWrapper:f,isEntityInView:c,loggerFactory:k,networkState:S,platformService:b,rebootService:C,scenarioFactory:w,hostCommunicationService:v,userTrackingService:T,windowProvider:I,localStorage:y,userBiService:N}),g.report({correlationId:_,userContextId:D,type:bb.yU.UserAuthenticated,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),IQ(d,y)||g.report({correlationId:_,type:bb.yU.UserConsentedToConsumeResources,userContextId:D,context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){switch(e){case"quit":case"signout":yield p.removeUser(e,D);break;default:return}}))}))}}class AQ extends Fe{constructor(){super(De.Yg.StoreBuildInfoTask,["localStorage","platformService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{localStorage:t,platformService:n}=e,i=n.config.buildVersion;i&&!i.toLocaleLowerCase().startsWith("local")&&t.set("buildNumber",i,NT.f.Experience)}))}}class _Q extends Fe{constructor(){super(De.Yg.TrackExperienceIdle,["clientState","correlation","coreSettings","experienceChangeReportingService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{clientState:t,correlation:n,coreSettings:a,experienceChangeReportingService:o}=e,{enableExperienceIdleStateManagement:r}=a.get(K.J.Core);if(!r)return;const s=t.observe().subscribe((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=e===VS.pk.LongInactive;o.report({correlationId:n.id,type:bb.yU.ExperienceIdleStateChanged,context:{target:"core-tasks-signal-core-lifecycle-changes-task",isIdle:t}})}))));return e=>{switch(e){case"signout":case"quit":s.unsubscribe()}}}))}}class DQ extends Fe{constructor(){super(De.Yg.TrackUserTask,["authenticationUser","userTrackingService"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=(0,li.b)(e.authenticationUser);return e.userTrackingService.trackUser(t),n=>{switch(n){case"signout":e.userTrackingService.removeUser(t)}}}))}}class FQ extends Fe{constructor(){super(De.Yg.UpdateDataClientContext,[])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){!function(e,t){var n,i,a;const o=Object.assign(Object.assign({},t),{pubsub:e.getServices().pubsub,send:(0,gE.UZ)(Me.l,t.networkState.observeIsOnline())}),r=uM.singletonLink,s=yx.clientResolvers;if(!r||!s)throw new Error("Link and client resolvers should be created at this point");const{maxApolloResultCacheSize:l,enableApolloDoubleWriteFix:d}=t.coreSettings.get(K.J.Core),{enableApolloDevtools:c}=t.coreSettings.get(K.J.Diagnostics),u=null!=l?l:void 0,m=null===(n=t.leakDetectorService)||void 0===n?void 0:n.create(),g=hV({leakDetector:m,windowId:null===(i=e.cache.apolloLeakInfo)||void 0===i?void 0:i.apolloLeakInfoWindowId,entityType:null===(a=e.cache.apolloLeakInfo)||void 0===a?void 0:a.apolloLeakInfoEntityType,viewportContext:"cmd"},void 0,s,u,t.loggerFactory,t.scenarioFactory,void 0,c,tF.t.cmd,t.graphqlStoreStatsReporterService,d);mF(g,"cmdApolloClient",Boolean(c),t.platformService,t.config.experienceName);const p=gV.createUserDataRequestContext(o,g),v=SV(p,r);e.updateContext(p,v),g.setLink(v)}(e.client,e)}))}}class MQ extends Fe{constructor(){super(De.Yg.UpdateNetworkStateDetection,[])}execute(e){var t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.authenticationUser&&(0,li.b)(e.authenticationUser)||"",a=null===(n=(t=e.networkState).subscribeToEndpointsNetworkStateTracking)||void 0===n?void 0:n.call(t,i,e.endpointsManager.networkState);return e=>{switch(e){case"signout":a();break;default:return}}}))}}class RQ extends Fe{constructor(){super(De.Yg.UpdateUserMetadataProperties,["coreSettingsContext","user","localStorage"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettingsContext:t,user:n,localStorage:i}=e;i.setSafe("cachedUser",(0,Ci.u4)(n),NT.f.User),t.updatePlatformProviderSettings({region:null==n?void 0:n.region})}))}}class PQ extends Fe{constructor(){super(De.Yg.WaitForCDLWorkerTask,["loggerFactory","coreSettings","coreSettingsContext"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t,coreSettings:n,coreSettingsContext:i}=e,{cdlWorkerService:a}=e,o=t.newLogger("WaitForCDLWorkerTask");if(!(0,BA.Q6)(n))return;const{isCDLWorkerCriticalToStartup:r}=n.get(K.J.Core);if(a){o.log("Waiting for CDL worker to finish initialization");const e=yield a.getCDLWorkerManager();if(e)e.syncEngineInitializationPromise.then((e=>{i.updatePlatformProviderSettings({bootType:e.bootType})}));else if(o.error("CDL worker manager not initialized."),r)throw new zS.G(zS.$.CDL_WORKER_FAILURE)}else if(o.warn("CDL worker service not present in core context."),r)throw new zS.G(zS.$.CDL_WORKER_FAILURE)}))}}class OQ extends Fe{constructor(){super(De.Yg.WrapChangeReportingServicesTask,["commandChangeReportingService","experienceChangeReportingService","authenticationUser"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{commandChangeReportingService:t,experienceChangeReportingService:n,authenticationUser:i}=e,a=(0,li.b)(i);return e.commandChangeReportingService=Object.assign(Object.assign({},e.commandChangeReportingService),{report:e=>{t.report(Object.assign({userContextId:a},e))},observeChanges:t.observeChanges.bind(t)}),e.experienceChangeReportingService=Object.assign(Object.assign({},e.experienceChangeReportingService),{report:e=>{n.report(Object.assign({userContextId:a},e))},observeChanges:n.observeChanges.bind(n)}),Promise.resolve()}))}}class xQ{constructor(e,t){this.coreSettings=e,this.logger=t.newLogger("ClientAccessAdminPolicyCheckService")}isUserAllowed(){this.logger.log("isUserAllowed::start");let e=!0;const{useNewTeamsClient:t}=this.coreSettings.get(K.J.Core,["useNewTeamsClient"]);switch(this.logger.log(`isUserAllowed: useNewTeamsClient: ${t}`),t){case Lr.KN.AdminDisabled:e=!1;break;case Lr.KN.MicrosoftChoice:const{installedThroughAppSwitcher:t}=this.coreSettings.get(K.J.Host,["installedThroughAppSwitcher"]);this.logger.log(`isUserAllowed: installedThroughAppSwitcher: ${t}`),t||(e=!1);break;case Lr.KN.UserChoice:default:e=!0}return this.logger.log(`isUserAllowed: returned ${e}`),e}}class LQ extends Fe{constructor(){super(De.Yg.InitClientAccessAdminPolicyCheck,["coreSettings","loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:t,loggerFactory:n}=e,i=n.newLogger("InitClientAccessAdminPolicyCheckTask"),{enableAppSwitcherTACSettingsSync:a}=t.get(K.J.Core,["enableAppSwitcherTACSettingsSync"]);a?e.clientAccessAdminPolicyCheckService=new xQ(t,n):i.log(`enableAppSwitcherTACSettingsSync is ${a}. Skipping ClientAccessAdminPolicyCheckService initialization.`)}))}}class UQ extends Fe{constructor(){super(De.Yg.ClearHostSettingsTask,["loggerFactory"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{loggerFactory:t}=e,n=t.newLogger("ClearHostSettingsTask");e.hostSettings=void 0,n.log("ClearHostSettingsTask: Host settings cleared from task init context.")}))}}class BQ extends Fe{constructor(){super(De.Yg.CreateHostedWindowContext,["hostedWindowContext","hostSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{hostedWindowContext:t,hostSettings:n}=e,i=n.hostSettings;i&&(t.sessionStartTime=i.createdTime,t.localeCode=i.localeCode,t.ring=i.hostRingId),"general_gcc"===t.ring&&(null==i?void 0:i.enableDevTools)&&(t.ring="ring0_gcc")}))}}class jQ extends Fe{constructor(){super(De.Yg.FetchHostSettingsTask,["config","hostedWindowContext","loggerFactory","windowProvider"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{config:t,hostedWindowContext:n,loggerFactory:i,windowProvider:a}=e,{isInCypressFrame:o,isInIframe:r}=n,s=i.newLogger("FetchHostSettingsTask");if(t.shouldFetchBootstrapData&&r&&!o)try{s.log("Hosted in web. Fetching host settings from host over IPC.");const t=yield a.opener.requestMessage(vb.rY.GetStateData,{requestType:"hostSettings"});s.log("Host settings fetched, setting context.hostSettings"),e.hostSettings=Object.assign({},t.hostSettings)}catch(e){s.errorToTelemetry&&s.errorToTelemetry(`Error fetching host settings over IPC ${e}`,"webclient_framework_foundation_core_services_tasks",void 0,!0)}else{s.log("Hosted in desktop. Getting host settings from window object.");const t=window;t.hostSettings&&(s.log("Found window.hostSettings."),e.hostSettings=Object.assign({},t.hostSettings),delete t.hostSettings)}}))}}var WQ;!function(e){e[e.Unknown=5e4]="Unknown",e[e.GetSingletonStoreFailed=4e4]="GetSingletonStoreFailed",e[e.CreateStoreFailed=40001]="CreateStoreFailed",e[e.ActionNotSupported=40002]="ActionNotSupported"}(WQ||(WQ={}));var VQ=n(537330),HQ=n(24932),$Q=n(702760);const zQ={code:WQ.CreateStoreFailed,message:"Store is not available"};function GQ(e){return new qQ(e)}class qQ extends pC.y{constructor(e){const t=e?QQ(e):(0,VQ._)(zQ);super((e=>t.subscribe(e))),this._dispatcher=e?Promise.resolve(e):Promise.reject(zQ)}dispatch(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(yield this._dispatcher).dispatch(e)}))}}const QQ=e=>(0,iS.D)(Promise.resolve(e)).pipe((0,kb.w)((e=>new pC.y((t=>e.subscribe((e=>t.next(e))))))),(0,HQ._)(1),(0,$Q.x)());class JQ extends pC.y{constructor(e,t){const n=t.pipe((0,aS.U)((t=>{var n;return null===(n=null==t?void 0:t.windows[e])||void 0===n?void 0:n.lifecycle})),(0,sI.x)(a.isEqual),(0,rS.h)((e=>void 0!==e)),(0,uC.o)((e=>void 0===e.closedTime),!0));super((e=>n.subscribe(e))),this._id=e,this._dispatcher=t}pushWltMarks(e){return this._dispatcher.dispatch({type:"RECORD_WINDOW_LIFECYCLE_MARKS",windowId:this._id,markers:e})}}var YQ=n(962360),KQ=n(841532);class ZQ{constructor(e,t,n){if(this.exitFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!1}))(e)),this.focus=e=>this._observableStore.dispatch((e=>({type:"FOCUS_WINDOW",windowId:e}))(e)),this.maximize=e=>this._observableStore.dispatch((e=>({type:"TOGGLE_MAXIMIZE_WINDOW",windowId:e}))(e)),this.minimize=e=>this._observableStore.dispatch((e=>({type:"MINIMIZE_WINDOW",windowId:e}))(e)),this.requestFullscreen=e=>this._observableStore.dispatch((e=>({type:"SET_FULLSCREEN",windowId:e,fullscreen:!0}))(e)),this.show=e=>this._observableStore.dispatch((e=>({type:"SHOW_WINDOW",windowId:e}))(e)),this.windowTitleDblClick=e=>this._observableStore.dispatch((e=>({type:"INVOKE_DOUBLE_CLICK",windowId:e}))(e)),e.createInterprocessStore){const i=e.createInterprocessStore({logDebug:(...e)=>t.debug(...e),logError:(...e)=>t.error(...e),logInfo:(...e)=>t.log(...e),logScenario:e=>{n.newScenario(e.name).stop(void 0,e.status)}});this._observableStore=GQ(i)}else this._observableStore=GQ(null)}onWindowFullscreen(e){return this._observableStore.pipe((0,YQ.j)("windows",e),(0,KQ.n)((e=>void 0===e)),(0,uC.o)((e=>{var t;return void 0===(null===(t=e.lifecycle)||void 0===t?void 0:t.closedTime)})),(0,YQ.j)("layout","fullscreen"),(0,sI.x)())}onLifecycleMarks(e){return new JQ(e,this._observableStore)}}class XQ extends Fe{constructor(){super(De.Yg.InitInterprocessStore,["windowProvider","loggerFactory","scenarioFactory","coreSettings"])}execute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{windowProvider:t,loggerFactory:n,scenarioFactory:i,coreSettings:a}=e;a.get(K.J.Core).disableInterprocessStore||(e.interprocessStoreService=new ZQ(t,n.newLogger("InterProcessStore"),i)),delete t.createInterprocessStore}))}}class eJ extends Fe{constructor(){super(De.Yg.Polyfills,[])}execute(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.applyAsyncIteratorPolyfillIfNeeded()}))}applyAsyncIteratorPolyfillIfNeeded(){void 0===Symbol.asyncIterator&&(Symbol.asyncIterator=Symbol.asyncIterator||n(212673).$$asyncIterator)}}class tJ extends Fe{constructor(){super(De.Yg.ReinitSettingsEcsProvider,["authenticationUser","coreSettingsContext"])}execute({coreSettingsContext:e,authenticationUser:t}){return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield e.reinitializeEcsProvider(t)}))}}var nJ=n(656907);class iJ{constructor(e){this.logsProviderTimeoutMs=2e4,this.coreProviders=[],this.userProviders={},this.primaryUserID="",this.allowZipLogFiles=!1,this.environmentName="",this.logger=e.newLogger("LogsCollectorService")}subscribeToCoreSettings(e){if(!e)return void this.logger.error("Failed to subscribe to core settings");e.getObservable(K.J.Diagnostics,["logsProviderTimeoutMs","shouldZipLogFiles"]).subscribe((({logsProviderTimeoutMs:e,shouldZipLogFiles:t})=>{e&&(this.logsProviderTimeoutMs=e),this.allowZipLogFiles=!!t}));e.getObservable(K.J.Metadata,["environment"]).subscribe((({environment:e})=>{e&&(this.environmentName=e)}))}registerCoreLogsProvider(e){var t,n;e.logsProviderName===nJ.d.DIAGNOSTICSSERVICE?this.diagnosticsLogProvider=e:this.coreProviders.some((t=>t.logsProviderName===e.logsProviderName))?null===(n=(t=this.logger).warnNoPii)||void 0===n||n.call(t,`Registering redundant core logger with name ${e.logsProviderName}`):this.coreProviders.push(e)}registerUserLogsProvider(e,t){var n,i;this.primaryUserID&&!e&&(e=this.primaryUserID),this.userProviders[e]?this.userProviders[e].some((e=>e.logsProviderName===t.logsProviderName))?null===(i=(n=this.logger).warnNoPii)||void 0===i||i.call(n,`Registering redundant user logger with name ${t.logsProviderName}`):this.userProviders[e].push(t):this.userProviders[e]=[t]}handleUserLogout(e){delete this.userProviders[e]}callOnLogsFiles(e,t=!1,n=!1,a=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.callOnUserLogsFiles(Object.keys(this.userProviders),e,t,n,a)}))}callOnUserLogsFiles(e,t,a=!1,o=!1,r=0){var s,l,d;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;if(a&&this.allowZipLogFiles)try{const e=null===(s=yield n.e(81578).then(n.t.bind(n,262467,23)))||void 0===s?void 0:s.default;e&&(i=new e)}catch(e){null===(d=(l=this.logger).errorToTelemetry)||void 0===d||d.call(l,`Load jszip failed - ${e}`,"logs_loading_jszip")}const c={fileName:"summary.txt",content:"",isPiiFree:!0},u=e=>(null==i?void 0:i.file)?(i.file(e.fileName,e.content),Promise.resolve(!0)):(e.fileName=`WebLogs/${e.fileName}`,t(e)),m=yield this.callOnOnlyCoreLogsFiles(u,c,o,r),g=yield this.callOnOnlyUserLogsFiles(e,u,c,o,r),p=yield this.createSummaryFile(u,c);if(i){const e=yield i.generateAsync({type:"blob",compression:"DEFLATE"}),n=this.environmentName?`${this.environmentName.toUpperCase()}-`:"";return t({fileName:`${n}WebLogs-${(new Date).toISOString()}.zip`,content:e,isPiiFree:!0})}return m&&g&&p}))}getSystemInfo(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let e=new Map;try{const t=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,Rn.E)(e.getSystemInfo(),this.logsProviderTimeoutMs)}catch(t){if((0,Rn.T)(t))return this.logger.error(`Timed out fetching system info from logs provider - ${e.logsProviderName}`),new Map;throw t}})),n=this.coreProviders.map(t);this.diagnosticsLogProvider&&n.push(t(this.diagnosticsLogProvider));const a=yield Promise.all(n);a&&a.length>0&&(e=a.reduce(((e,t)=>new Map([...Array.from(e.entries()),...Array.from(t.entries())]))))}catch(e){this.logger.error("Fetching system info from logs providers failed with error:",e)}return e}))}setPrimaryUserID(e){if(e&&!this.primaryUserID){this.primaryUserID=e;const t=this.userProviders[""];t&&(this.userProviders[this.primaryUserID]=t,delete this.userProviders[""])}}setGetSummaryFunction(e){this.generateSummary=e}getUserLogFileName(e,t){return`User (${e===this.primaryUserID?"Primary; ":""}${e})/${t}`}getCoreLogFileName(e){return`Core/${e}`}callOnOnlyCoreLogsFiles(e,t,n=!1,a=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i=t=>(t.fileName=t.userId?this.getUserLogFileName(t.userId,t.fileName):this.getCoreLogFileName(t.fileName),e(t));this.logger.log(`Fetching files from providers: ${this.coreProviders.reduce(((e,t)=>e+`${null==t?void 0:t.logsProviderName}, `),"")}`);const o=yield this.callOnLogsFilesOfLogsProviders(this.coreProviders,i,t,n,a),r=!this.diagnosticsLogProvider||(yield this.callOnLogsFilesOfLogsProviders([this.diagnosticsLogProvider],i,t,n,a));return o&&r}catch(e){return this.logger.error("Error calling callback on logs files from all logs providers - error:",e),!1}}))}callOnOnlyUserLogsFiles(e,t,n,a=!1,o=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=[];return e.length>0&&e.forEach((e=>{if(this.userProviders[e]&&this.userProviders[e].length>0){const r=n=>(n.fileName=this.getUserLogFileName(e,n.fileName),t(n));i.push(this.callOnLogsFilesOfLogsProviders(this.userProviders[e],r,n,a,o))}})),(yield Promise.all(i)).every(Boolean)}))}timeoutSafeGetLogsFiles(e,t=!1,n=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,Rn.E)(e.getLogsFiles(t,n),this.logsProviderTimeoutMs)}catch(t){if((0,Rn.T)(t))return this.logger.error(`Timed out fetching logs files from logs provider - ${e.logsProviderName}`),[];throw t}}))}callOnLogsFilesOfLogsProviders(e,t,n,a=!1,o=0){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.map((e=>this.timeoutSafeGetLogsFiles(e,a,o))),r=yield Promise.all(i),s=[];r.forEach((e=>{e&&e.length>0&&s.push(...e)}));const l=s.map((e=>{try{return"latestErrors"===e.fileName?(n.content=`${n.content}${e.content}\r\n`,Promise.resolve(!0)):t(e)}catch(t){return this.logger.error(`Error calling callback on logs file, ${null==e?void 0:e.fileName} - error:`,t),!1}}));return(yield Promise.all(l)).every((e=>e))}))}createSummaryFile(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield null===(n=this.generateSummary)||void 0===n?void 0:n.call(this);return i&&(t.content=`${i}\r\n${t.content}`),e(t)}))}}var aJ=n(486101);class oJ{constructor(e,t){this.coreTaskManager=e,this.userRenderingContextMap=new Map,this.logger=t.newLogger("RenderingContextManager")}cleanupWithPriority(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new zS.G(zS.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=this.userRenderingContextMap.keys(),n=Array.from(t).map((t=>()=>this.cleanupActiveWindowsHistoryService(e,t)));yield lJ(n,this.defaultRenderingContext)}))}createCoreServices(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("createCoreServices: start");const e=yield this.coreTaskManager.notifyLifeCycleEvent(De.sM.Initialization),{coreTaskErrors:t}=e,n=(0,i.__rest)(e,["coreTaskErrors"]);return this.defaultRenderingContext=n,this.logger.log("createCoreServices: done"),Object.assign(Object.assign({},n),{error:sJ(t,n)})}))}executePrimaryUserTasks(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new zS.G(zS.$.RENDERING_CONTEXT_DOES_NOT_EXIST));this.logger.log(`executePrimaryUserTasks(${null==e?void 0:e.id}): start`);const t=yield this.coreTaskManager.notifyLifeCycleEvent(De.sM.OnPrimaryUser,Object.assign(Object.assign({},this.defaultRenderingContext),{primaryUser:e,authenticationUser:e})),{coreTaskErrors:n}=t,a=(0,i.__rest)(t,["coreTaskErrors"]),o=sJ(n,this.defaultRenderingContext);if(delete a.authenticationUser,this.primaryUserContext=a,o)throw o;return this.logger.log(`executePrimaryUserTasks(${null==e?void 0:e.id}): done`),this.primaryUserContext}))}removeAllRenderingContexts(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.defaultRenderingContext)return Promise.reject(new zS.G(zS.$.RENDERING_CONTEXT_DOES_NOT_EXIST));const t=this.userRenderingContextMap.keys(),n=Array.from(t).map((t=>()=>this.removeUserRenderingContext(e,t)));yield lJ(n,this.defaultRenderingContext),this.primaryUserContext&&(yield this.coreTaskManager.destroyContext(this.primaryUserContext,e)),yield this.coreTaskManager.destroyContext(this.defaultRenderingContext,e)}))}getUserRenderingContext(e){return this.userRenderingContextMap.get(e)}getDefaultRenderingContext(){return this.defaultRenderingContext}getOrCreateUserRenderingContext(e){const t=(0,li.b)(e);return this.defaultRenderingContext?(this.userRenderingContextMap.get(t)||this.userRenderingContextMap.set(t,this.createUserContextWithTelemetry(e,this.defaultRenderingContext)),this.userRenderingContextMap.get(t)):Promise.reject(new zS.G(zS.$.RENDERING_CONTEXT_DOES_NOT_EXIST,void 0,t))}removeUserRenderingContext(e,t){var n,a,o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=this.userRenderingContextMap.get(t);if(i){let s;"unknown_destroy"===e&&(null===(a=(n=this.logger).errorToTelemetry)||void 0===a||a.call(n,"Removing user context due to unknown.","webclient_framework_foundation_core_services",void 0,!0)),this.userRenderingContextMap.delete(t);try{s=yield i}catch(e){let t;return t=e instanceof Ae.G&&Ae.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():e&&`${e.name}::${e.message}`,null===(r=(o=this.logger).errorToTelemetry)||void 0===r||r.call(o,`${zS.$.CLEANUP}::contextPromise::${t}`,"webclient_framework_foundation_core_services",void 0,!0),!1}return this.cleanupUserRenderingContext(s,"unknown_destroy"===e?"signout":e)}return this.logger.warn("RenderingContextManager::contextPromise is not defined"),!1}))}createUserContextWithTelemetry(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{scenarioFactory:i}=t,a=!!(null===(n=t.coreSettings.get(K.J.Core))||void 0===n?void 0:n.enableMTMA),o=i.findScenario(ft.RG.GetAuthUser),[r,s]=ib(i);null==r||r.mark(ft.ck.CoreUserContextStart);const l=Date.now(),d=(0,li.b)(e);try{const t=yield this.createUserRenderingContext(e,a);return this.reportUserContextSuccess({getUserAuthScenario:o,expReadyScenario:s,clientStartScenario:r,scenarioStartTime:l,userContextId:d,isMTMAEnabled:a,scenarioFactory:t.scenarioFactory}),t}catch(e){const n=ab(e,d);throw this.reportUserContextFailure({getUserAuthScenario:o,expReadyScenario:s,scenarioStartTime:l,error:n,userContextId:d,isMTMAEnabled:a,scenarioFactory:t.scenarioFactory}),n}}))}reportUserContextSuccess({getUserAuthScenario:e,expReadyScenario:t,clientStartScenario:n,scenarioStartTime:i,userContextId:a,isMTMAEnabled:o,scenarioFactory:r}){var s;e&&e.stop(),null==t||t.mark(ft.ck.GetAuthUser),null==n||n.mark(ft.ck.CoreUserContextStop),o&&rJ(r,a,i,null===(s=this.defaultRenderingContext)||void 0===s?void 0:s.windowProvider.performance).stop(void 0,"success")}reportUserContextFailure({getUserAuthScenario:e,expReadyScenario:t,scenarioStartTime:n,error:i,userContextId:a,isMTMAEnabled:o,scenarioFactory:r}){var s;e&&e.fail(),null==t||t.mark(ft.ck.GetAuthUser,void 0,"failure"),o&&rJ(r,a,n,null===(s=this.defaultRenderingContext)||void 0===s?void 0:s.windowProvider.performance).fail({message:`Failed to create user context for ${a}`,errorCode:Ae.G.isFunction(i.toTelemetryEntry)?i.toTelemetryEntry():`${i.code}::${i.message}`})}cleanupActiveWindowsHistoryService(e,t){var n,a,o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;try{i=yield this.getUserRenderingContext(t)}catch(e){return}try{null===(n=null==i?void 0:i.activeWindowsHistoryService)||void 0===n||n.cleanup(e)}catch(e){const t=new zS.G(zS.$.CLEANUP,e);null===(o=(a=this.logger).errorToTelemetry)||void 0===o||o.call(a,t.toTelemetryEntry(),"webclient_framework_foundation_core_services_active_windows_history",void 0,!0)}}))}cleanupUserRenderingContext(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return yield this.coreTaskManager.destroyContext(e,t),!0}))}createUserRenderingContext(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=(0,li.b)(e);this.logger.log(`createUserContext(${n}): start`);const a=yield this.coreTaskManager.notifyLifeCycleEvent(t?De.sM.OnUserAuthenticated_MTMA:De.sM.OnUserAuthenticated,Object.assign(Object.assign({},this.defaultRenderingContext),{authenticationUser:e}),(e=>{var i,a;return t&&(null===(i=this.defaultRenderingContext)||void 0===i?void 0:i.windowProvider.performance)&&function(e,t,n){const i=`mtma_core_task_end_${t}`;n.mark(i,{detail:{taskId:De.Yg[e]}})}(e,n,null===(a=this.defaultRenderingContext)||void 0===a?void 0:a.windowProvider.performance)})),{coreTaskErrors:o}=a,r=(0,i.__rest)(a,["coreTaskErrors"]),s=sJ(o,this.defaultRenderingContext);if(s)throw s;return this.logger.log(`createUserContext(${n}): done`),r}))}}function rJ(e,t,n,i){const a=e.createScenarioWithoutStarting(ft.RG.CoreUserContextCreate,{startTime:n});return i&&function(e,t,n,i){const a=i.timeOrigin,o=i.getEntriesByName(t,"mark")||[];for(const t of o){const i=t.detail.taskId;e.mark(`${n}${i}`,{overrideTimestamp:Math.round(t.startTime+a)})}i.clearMarks(t)}(a,`mtma_core_task_end_${t}`,"core_task_",i),a}function sJ(e,t){let n;return e&&(null==e?void 0:e.length)>0&&(n=(null==t?void 0:t.coreSettings.get(K.J.Core).strictErrorMode)?e[0]:e.find((e=>e instanceof zS.G||e instanceof cE.l||e instanceof _e&&(e.prevError instanceof zS.G||e.prevError instanceof cE.l)))),n}function lJ(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(null===(n=null==t?void 0:t.coreSettings.get(K.J.Core))||void 0===n?void 0:n.readInSequence)for(const t of e)yield t();else yield Promise.all(e.map((e=>e())))}))}const dJ="authenticated_user_subscription_failed",cJ="create_user_context_failed",uJ="init_core_service_failure",mJ="show_taskbar_caution_indicator_failed",gJ="user_data_undefined",pJ="user_renderingContext_generation_error",vJ=(e,t,n)=>{e.errorToTelemetry&&e.errorToTelemetry(t,n,void 0,!0)};class hJ{constructor(e){var t,n,a,o,r,s;this._activeWindows=new eS.X([]),this._contextSubject=new tS.t(1),this._isCleanupRunning=!1,this.AppStateToCleanupReasonMap=new Map([[zn.quit,"quit"],[zn.restart,"restart"]]),this.cleanupOnAppStateChangedCallback=e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{appState:t}=e;if(!lb.has(t))return;if(this._isCleanupRunning){const e=new zS.G(zS.$.CLEANUP,new Error(`cleanupOnAppStateChangedCallback run more than once ${t}`));return void(this._logger.warnToTelemetry&&this._logger.warnToTelemetry(e.toTelemetryEntry(),"webclient_framework_foundation_core_services",void 0,!0))}this._isCleanupRunning=!0;const n=this.AppStateToCleanupReasonMap.get(t);if(!n){const e=new zS.G(zS.$.CLEANUP,new Error(`cleanupOnAppStateChangedCallback has undefined reason from ${t}`));throw vJ(this._logger,e.toTelemetryEntry(),"webclient_framework_foundation_core_services"),e}yield db({hostCommunicationService:this.coreServices.hostCommunicationService,logger:this._logger,reason:n,renderingContextManager:this._renderingContextManager})})),this.trackAuthUsers=e=>{const t=this.isMTMACoreEnabled(e.coreSettings);return(0,nS.z)((0,aS.U)((e=>t?e:e.slice(0,1))),(0,aS.U)((e=>e.map((e=>Object.assign(Object.assign({},e),{id:(0,li.b)(e)}))))),SS((e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.onUserAuthenticated(e)}))),(e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.onUserDestroy(yield e)}))),((e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){return t}))),((e,n)=>{if(!t)throw n})))};const l=(0,Ze.J)(),d=(null==l?void 0:l.defaultConsoleLogLevel)||(null===(n=null===(t=null==l?void 0:l.loader)||void 0===t?void 0:t.getInitConsoleLogLevel)||void 0===n?void 0:n.call(t)),c=null===(o=null===(a=null==l?void 0:l.loader)||void 0===a?void 0:a.getProperties)||void 0===o?void 0:o.call(a),u=new vS.w((null==c?void 0:c.sessionId)||"",e.config.experienceName,dS.U.DiagnosticsLogsMain,null==d?void 0:d.preECSConsoleLogLevel,null==d?void 0:d.userConsoleLogLevel),m=new hS.m(u,"00000000-0000-0000-0000-000000000000");this._config=e.config;const g=new xS(m,this._config,e.apps);this._logger=m.newLogger("Core");const p=new iJ(m);let v;c&&c.isMaglev&&c.preCoreHostCommService&&(v=c.preCoreHostCommService),this._preCoreLogsFileService=new aJ.N(m,p,void 0,v),l.addEventListener("downloadLogs",(()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){yield this._preCoreLogsFileService.downloadLogsFiles(l)})))),p.registerCoreLogsProvider(u);const h=null===(s=null===(r=null==l?void 0:l.loader)||void 0===r?void 0:r.getLogsProvider)||void 0===s?void 0:s.call(r);h&&p.registerCoreLogsProvider(h),c&&c.isMaglev&&c.preCoreHostCommService&&this.registerForLogsDownloadSignalFromDesktop(l,c.preCoreHostCommService);const f=e.config.useReactWebClientCoreTasks?{Initialization:()=>[new T_,new Cz,new FG,new D$,new m$,new zV,new E_,new ED,new QG,new TD,new FH,new cq,new MG,new Nz,new KH,new qG,new hQ,new NH,new zH,new tH,new PI,new YG,new iq,new w$,new hE,new SH,new vH,new bE,new $G,new GV,new CH,new xI,new dq,new OG,new WV,new N_,new S_,new jA,new PG,new vD,new qH,new wV,new __,new A_,new aH,new DD,new BV,new iH,new hD,new gH,new FD,new yz,new kQ,new AQ,new NE,new b$,new YH,new JH,new LQ],OnPrimaryUser:()=>[new NQ,new wQ,new Qz,new CQ,new uq,new zG,new bQ],OnUserAuthenticated:()=>[new NQ,new Qz,new pE,new VG,new wE,new ZH,new EE,new OQ,new FQ,new WA,new nq,new _G,new UG,new eI,new Sz,new EQ,new RG,new RQ,new lq,new hD,new o$,new iI,new yQ,new Pe,new xG,new _Q,new PQ],OnUserAuthenticated_MTMA:()=>[new NQ,new Jz,new Qz,new ZH,new DQ,new AD,new pE,new CH,new xI,new tH,new wE,new MQ,new OQ,new RG,new RQ,new lq,new EE,new k_,new Tz,new __,new DD,new iH,new hD,new VG,new WA,new nq,new _G,new UG,new eI,new Sz,new EQ,new o$,new iI,new yQ,new Pe,new xG,new _Q,new PQ]}:{Initialization:()=>[new eJ,new T_,new Cz,new FG,new D$,new jQ,new BQ,new m$,new zV,new E_,new ED,new QG,new TD,new FH,new MG,new KH,new hQ,new zH,new tH,new PI,new YG,new UQ,new w$,new SH,new vH,new hE,new bE,new $G,new GV,new CH,new xI,new dq,new WV,new N_,new S_,new jA,new vD,new qH,new wV,new __,new A_,new aH,new BV,new iH,new FD,new yz,new gH,new XQ,new NE,new b$,new YH],OnUserAuthenticated:()=>[new NQ,new Qz,new CQ,new tJ,new lq,new VG,new ZH,new EE,new FQ,new WA,new nq,new UG,new EQ,new RG,new RQ,new yQ,new PQ]};this._taskManagerService=new LS(m,g,e.config,e.loadConfigs,this.getDefaultCorrelation(),f,u,p,this.waitForRenderingContextReady.bind(this),this.isEntityInView.bind(this),e.criticalDynamicImports,e.getPlatformConfigurationOverrides),this._templateGenerator=e.generateChildWindowTemplate,this._trackWindowsOperator=uT,this._renderingContextManager=new oJ(this._taskManagerService,m)}get activeWindows(){return this._activeWindows}init(){var e,t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield this.initializeCoreServices();!function(e){const{coreSettings:t,logsCollectorService:n}=e,{testAutomation:i}=t.get(K.J.Test);if(i){const e=window;e.WeakRef&&(e.hooks||(e.hooks={}),e.hooks.__TEST_ONLY_LOGS_COLLECTOR_SERVICE_REF=new e.WeakRef(n))}}(n),this._config.supportsAsyncUserContext||(yield this.awaitUserContextIfAvailable()),this._preCoreLogsFileService.setBannerRelatedServices(n.entityCommanding,n.i18n),this.signalCoreInitSuccess(n);const i={logger:this._logger,renderingContextManager:this._renderingContextManager};null===(t=null===(e=n.authenticationService)||void 0===e?void 0:e.registerCleanUpOnLogoutCallback)||void 0===t||t.call(e,Ot.D.Core,(e=>cb(Object.assign(Object.assign({},i),{coreSettings:n.coreSettings,reason:"signout",user:e&&(0,li.K)(e)})))),this.registerForAppStateChanged(n.hostCommunicationService)}catch(e){throw this.reportCoreInitError(e,this._coreServices),e}}))}get coreServices(){if(!this._coreServices)throw(0,Mn.Tr)("Entry",De.jK.NotPresent,"CoreServices not available");return this._coreServices}getDefaultCorrelation(){const e=JS({source:Ot.D.ExternalCommand,externalId:this._config.externalCorrelationId});return e.id=`Core-${e.id}`,e}initializeCoreServices(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const e=yield this._renderingContextManager.createCoreServices(),{error:t}=e,n=(0,i.__rest)(e,["error"]);return this._coreServices=n,this.initializeKPIs(n.scenarioFactory),t&&this.handleError(t),this.setupNavigationHandling(n),this.observeAuthenticatedUsers(n),n}))}signalCoreInitSuccess(e){var t,n,i,a,o,r,s;const[l,d]=ib(e.scenarioFactory);null==d||d.mark(ft.ck.InitCoreServicesComplete),null==l||l.mark(ft.ck.CoreInitStop),l&&(null===(i=null===(n=null===(t=(0,Ze.J)())||void 0===t?void 0:t.loader)||void 0===n?void 0:n.stopPieTimer)||void 0===i||i.call(n)),this._logger.log("hostComms::setCoreInitialized"),e.hostCommunicationService.loadModule("core").then((e=>{var t;null===(t=null==e?void 0:e.setCoreInitialized)||void 0===t||t.call(e)})),this.markCoreInitCompleteInAltScenario(e.altScenarioService);const c=Date.now();e.telemetryService.setCoreInitTime(c),e.logsCollectorService.setGetSummaryFunction(ob(null===(a=this._coreServices)||void 0===a?void 0:a.platformService,null===(o=this._coreServices)||void 0===o?void 0:o.i18n,null===(r=this._coreServices)||void 0===r?void 0:r.authenticationService,null===(s=this._coreServices)||void 0===s?void 0:s.coreSettings))}handleError(e){if(!this.canDisplayCriticalErrorPage(this._coreServices))throw this.reportCoreInitError(e,this._coreServices),e;this.reportCoreInitError(e,this._coreServices,ft.ck.CoreInitFailure),this._contextSubject.error(ab(e))}setupNavigationHandling(e){if(!this.canHandleNavigationIntents(e))throw(0,Mn.Tr)(De.w5.Core,De.jK.CoreNavigationServicesMissing,"Unable to process navigation intents");e.coreSettings.get(K.J.Core).enableIframeTracking&&(this._trackWindowsOperator=UN),this.observeWindows(e).subscribe(this._activeWindows),((e,t)=>{const{windowProvider:n,loggerFactory:a,clientState:o,dataClientTrackingService:r,windowTrackerService:s,graphqlOpsCountService:l,leakDetectorService:d}=e,c=a.newLogger("Main-Window-Event-Listeners");(0,$N.R)(n.opener,vb.rY.ShouldShowChatNotification).pipe((0,zN.M)(t,o.observe())).subscribe((([a])=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{if(!a||!a.payload||!a.payload.convId)throw new Error(`Invalid payload for shouldShowChatNotification with ${JSON.stringify(a)}`);let i=L.pyR.chats;a.payload.entityType?i=a.payload.entityType:c.log(`null entityType received: ${a.payload.entityType}`),c.log(`Received shouldShowNotification request for conv ${a.payload.convId} with entityType ${i}`);const o=yield eb({action:u.u.view,id:a.payload.convId,linkedEntity:null,type:i},e.client,c),r=!tb(o,t,e.clientState,c);GN(n,r,o),c.log(`Sending windowid: ${o} and shouldShowChatNotification: ${r} for conv ${a.payload.convId}`)}catch(e){c.error(`Failed to query window for entity with error ${e}`),GN(n,!0,void 0)}})))),null==s||s.init(),(0,$N.R)(n.opener,vb.rY.GetWindowEntityTypeStats).subscribe((()=>{n.opener.postMessage(vb.rY.GetWindowEntityTypeStats,{windowEntityTypeStats:null==s?void 0:s.getTelemetry()})})),(0,$N.R)(n.opener,vb.rY.GetApolloCacheStats).subscribe((()=>{n.opener.postMessage(vb.rY.GetApolloCacheStats,{apolloCacheStats:null==r?void 0:r.getTelemetry()})})),l&&(0,$N.R)(n.opener,vb.rY.GetCdlStats).subscribe((()=>{n.opener.postMessage(vb.rY.GetCdlStats,{cdlStats:null==l?void 0:l.getLatestDataAndClear()})}));(0,$N.R)(n.opener,vb.rY.GetHeartbeat).subscribe((()=>{let t="";e.appResponsivenessService&&(t=e.appResponsivenessService.getTelemetry()),n.opener.postMessage(vb.rY.GetHeartbeat,{windowEntityTypeStats:null==s?void 0:s.getTelemetry(),apolloCacheStats:null==r?void 0:r.getTelemetry(),ariTelemetry:t,OLDStats:null==d?void 0:d.getTelemetry()})}))})(e,this.activeWindows),e.deeplinkService.init()}awaitUserContextIfAvailable(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){yield this._contextSubject.pipe((0,oS.P)()).toPromise()}))}initializeKPIs(e){var t,n,i;if(e){const a=e.findScenario(ft.RG.ClientStart),o=null===(i=null===(n=null===(t=(0,Ze.J)())||void 0===t?void 0:t.loader)||void 0===n?void 0:n.getProperties)||void 0===i?void 0:i.call(n);(null==o?void 0:o.deeplinkId)&&(null==a||a.appendEventData({deeplinkId:o.deeplinkId})),(null==o?void 0:o.RelaunchReason)&&(null==a||a.appendEventData({RelaunchReason:o.RelaunchReason})),null==a||a.mark(ft.ck.CoreInitStart)}const a=null==e?void 0:e.findScenario(ft.RG.ExperienceReady);null==a||a.mark(ft.ck.InitCoreServices),null==a||a.startStep(ft.ck.GetAuthUser)}reportCoreInitError(e,t={},n){var a,o,r,s,l,d,c,u,m,g,p,v;const h=e instanceof Ae.G?(e=>e.prevError||(0,Mn.Tr)(De.w5.Core,De.jK.NotInitialized,e.code,void 0,e.message))(e):e,f=h.context===De.w5.Core?h:(0,Mn.Tr)(De.w5.Core,h.code||De.jK.NotInitialized,h.context,{innerError:h}),y=f.subContext||"UnknownCoreInitFailure",k=(0,ta.A)((0,Mn.B9)(f));this._logger.warn(`Initializing Core failed. Message: ${k}, subContext: ${y}`);const[S,b]=ib(t.scenarioFactory),C={errorCode:e instanceof Ae.G&&Ae.G.isFunction(e.toTelemetryEntry)?e.toTelemetryEntry():null!==(a=f.code)&&void 0!==a?a:De.jK.CoreInitFailure,reason:De.jK.CoreInitFailure},w=null===(o=(0,Ze.J)())||void 0===o?void 0:o.loader;n?(null==S||S.mark(n,C),null===(s=null===(r=null==t?void 0:t.altScenarioService)||void 0===r?void 0:r.altScenario)||void 0===s||s.mark(n,C)):(null==S||S.fail(C),null===(d=null===(l=null==t?void 0:t.altScenarioService)||void 0===l?void 0:l.altScenario)||void 0===d||d.fail(C)),S&&(null===(c=null==w?void 0:w.stopPieTimer)||void 0===c||c.call(w)),null===(m=null===(u=this._coreServices)||void 0===u?void 0:u.diagnosticsService)||void 0===m||m.persistDiagnosticsAsPreviousSessionLogs(),null==w||w.persistLoaderLogsAsPreviousSession(),null==b||b.fail({contentType:(0,ta.A)(`${f.context}-${f.subContext}`),errorCode:(0,Mn.qZ)(f),errors:k,reason:uJ}),null===(g=null==t?void 0:t.windowProvider)||void 0===g||g.opener.postMessage(cS.W.CoreInitializationFailed,{errorDescription:y}),(null===(v=null===(p=null==t?void 0:t.coreSettings)||void 0===p?void 0:p.get(K.J.Core))||void 0===v?void 0:v.enableTaskbarIconOnCoreInitFailure)&&function(e,t){var n;(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield null==e?void 0:e.loadModule("taskbar");null===(n=null==t?void 0:t.showBadge)||void 0===n||n.call(t,{icon:{glyphBadge:{glyph:pS.attention}}})}catch(e){vJ(t,`${mJ}: ${e}`,"webclient_framework_foundation_core_services")}}))}(null==t?void 0:t.hostCommunicationService,this._logger)}markCoreInitCompleteInAltScenario(e){var t,n;null===(t=null===performance||void 0===performance?void 0:performance.mark)||void 0===t||t.call(performance,gS),null===(n=null==e?void 0:e.altScenario)||void 0===n||n.mark(ft.ck.PostCoreInitializationTasks)}waitForRenderingContextReady(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.isMTMACoreEnabled(null===(n=this._coreServices)||void 0===n?void 0:n.coreSettings)?this.getOrCreateRenderingContextForId(t):this._contextSubject.pipe((0,rS.h)((t=>{var n;return!e||!!(null===(n=t.authenticationUser)||void 0===n?void 0:n.isAuthenticated)})),(0,oS.P)()).toPromise()}))}getExistingContextForId(e){if(!e){const e=this._renderingContextManager.getDefaultRenderingContext();return e&&Promise.resolve(e)||Promise.reject(new zS.G(zS.$.RENDERING_CONTEXT_DOES_NOT_EXIST))}return this._renderingContextManager.getUserRenderingContext(e)}getContextObservable(e,t){var n;return!e||this._contextSubject.hasError?this._contextSubject:(0,iS.D)(null!==(n=this.getExistingContextForId(t))&&void 0!==n?n:Promise.reject(new zS.G(zS.$.RENDERING_CONTEXT_DOES_NOT_EXIST)))}getOrCreateRenderingContextForId(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getExistingContextForId(e);if(n)return n;const a=e&&this._coreServices&&(yield function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield n.getUser({correlation:e,accountId:t});return i&&i.isAuthenticated?(0,li.K)(i):void 0}))}(Object.assign(Object.assign({},JS({source:Ot.D.Core})),{scenarioName:ft.RG.AuthWebCachedUser}),e,null===(t=this._coreServices)||void 0===t?void 0:t.authenticationService));return a?(yield this.tryExecutePrimaryUserTasks(),this._renderingContextManager.getOrCreateUserRenderingContext(a)):Promise.reject(new zS.G(zS.$.USER_DOES_NOT_EXIST,void 0,e))}))}isMTMACoreEnabled(e){var t;return!!(null===(t=null==e?void 0:e.get(K.J.Core))||void 0===t?void 0:t.enableMTMA)&&!!this._config.supportsAsyncUserContext}tryExecutePrimaryUserTasks(){var e,t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this._taskManagerService.hasTasks(De.sM.OnPrimaryUser))return;if(null===(e=this._coreServices)||void 0===e?void 0:e.primaryUser)return;if(this._primaryUserTasksPromise)return this._primaryUserTasksPromise;const i=null===(t=this._coreServices)||void 0===t?void 0:t.authenticationService,o=yield null===(n=null==i?void 0:i.getCachedUsers)||void 0===n?void 0:n.call(i,Object.assign(Object.assign({},JS({source:Ot.D.Core})),{scenarioName:ft.RG.AuthWebCachedUser}),{isPrimaryUser:!0,isAuthenticated:!0}),r=null===(a=null==o?void 0:o.filter((e=>!0===e.isAuthenticated)))||void 0===a?void 0:a[0];return r&&!this._primaryUserTasksPromise&&(this._primaryUserTasksPromise=this._renderingContextManager.executePrimaryUserTasks((0,li.K)(r)).then((e=>{this._coreServices=e}))),this._primaryUserTasksPromise}))}observeAuthenticatedUsers(e){this.observeUsers(e,this._logger).pipe(this.trackAuthUsers(e),(0,sS.K)((t=>{var n,i,a;const o=t instanceof Ae.G&&Ae.G.isFunction(t.toTelemetryEntry)?t:new zS.G(null==t?void 0:t.code,t||new Error("Unknown error"));null===(i=(n=this._logger).errorToTelemetry)||void 0===i||i.call(n,`Core Initialization: ${pJ}`,"webclient_framework_foundation_core_services",{errorCode:o.toTelemetryEntry(),message:null==t?void 0:t.message},!0);const r=(0,Mn.Tr)("Core",De.jK.NotInitialized,null===(a=o.prevError)||void 0===a?void 0:a.context,{innerError:o.prevError});throw e.errorState.error=r,e.coreSettings.get(K.J.Core).enableCoreErrorsV2?o:r})),(0,lS.b)((()=>{const[t,n]=ib(e.scenarioFactory);null==t||t.mark(ft.ck.CoreRenderingContextReady)})),(0,aS.U)((e=>e.length>0?e[0]:this._renderingContextManager.getDefaultRenderingContext()))).subscribe(this._contextSubject)}canDisplayCriticalErrorPage(e){return!!((null==e?void 0:e.rebootService)&&e.i18n&&e.scenarioFactory&&e.coreSettings&&e.hostCommunicationService&&e.coreSettings.get(K.J.Core).enableCoreErrorsV2)}canHandleNavigationIntents(e){return!!((null==e?void 0:e.client)&&e.deeplinkService&&e.entityCommanding)}registerForAppStateChanged(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let n;try{n=yield e.loadModule("core")}catch(e){const t=`HostComms:: ${mI.LoadModuleCoreFailed} registerForAppStateChanged`;return void vJ(this._logger,t,"webclient_framework_host_comms")}try{null===(t=null==n?void 0:n.registerForAppStateChanged)||void 0===t||t.call(n,this.cleanupOnAppStateChangedCallback)}catch(e){const t=`HostComms:: ${mI.RegisterForAppStateChangedFailed}`;return void vJ(this._logger,t,"webclient_framework_host_comms")}}))}observeWindows(e){const t=this.isMTMACoreEnabled(e.coreSettings);return(0,NS.G)(e.client.watchQuery({query:BS})).pipe((0,rS.h)((({errors:e,loading:t})=>void 0===e&&!t)),(0,aS.U)((({data:{activeWindows:e}})=>e.map((t=>Object.assign(Object.assign({},t),{screenState:{numOpenWindows:e.length}}))))),this._trackWindowsOperator(this.getContextObservable.bind(this,t),e,this._templateGenerator))}observeUsers(e,t){const n=this.observeUsersEvents(e.client);return(0,NS.G)(n).pipe((0,aS.U)((e=>this.toUserContexts(e,t))),(0,sS.K)((e=>{var t,n;const i=`Core Initialization: ${dJ}`;throw null===(n=(t=this._logger).errorToTelemetry)||void 0===n||n.call(t,i,"webclient_framework_foundation_core_services",{errorCode:e.code,context:e.context,message:e.message,errors:`${null==e?void 0:e.reason}-${(0,Ci.u4)(null==e?void 0:e.serverResponse)}`},!0),ab(e)})))}observeUsersEvents(e){const t={filter:{isAuthenticated:!0}},n=e.watchQuery({query:WS,variables:t});return n.subscribeToMore({document:jS,variables:t,updateQuery:(e,t)=>t.subscriptionData.data.authenticationUsersEvent}),n}onUserAuthenticated(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return yield this.tryExecutePrimaryUserTasks(),this._renderingContextManager.getOrCreateUserRenderingContext(e)}))}onUserDestroy(e){const t={logger:this._logger,renderingContextManager:this._renderingContextManager},n=e.authenticationUser;n&&cb(Object.assign(Object.assign({},t),{coreSettings:e.coreSettings,reason:"unknown_destroy",user:n}))}toUserContexts({data:e,loading:t,errors:n},i){var a;if(n)throw vJ(i,cJ,"webclient_framework_foundation_core_services"),(0,fS.E6)({graphQLErrors:n.concat(),extraInfo:void 0,networkError:null,name:"AuthenticationUsers subscription error",message:"Error in authentication users subscription"});if(!t){if(!e)return vJ(i,gJ,"webclient_framework_foundation_core_services"),[];return(null!==(a=e.authenticationUsers)&&void 0!==a?a:[]).filter((e=>!0===e.isAuthenticated)).map(this.toUserContext)}return[]}toUserContext(e){const{id:t,isAuthenticated:n,cloud:i,profile:{tenantId:a,objectId:o,puid:r},role:s,type:l,subType:d,loginUserName:c,homeAccountId:u}=e;return{id:t,isAuthenticated:n,profile:{tenantId:a,objectId:o,puid:r},cloud:i,role:s,type:l,subType:d,loginUserName:c,homeAccountId:u||void 0}}isEntityInView(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this._coreServices)return Promise.resolve(!1);const{clientState:n}=this._coreServices;return function(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return tb(yield eb(e,t,o),a,n,o)}))}(e,t,n,this._activeWindows,this._logger)}))}registerForLogsDownloadSignalFromDesktop(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=yield t.loadModule("logscollection");i&&(null===(n=null==i?void 0:i.registerForRequestWebLogsDownload)||void 0===n||n.call(i,(t=>{const n=!t.webLogsId;this._preCoreLogsFileService.downloadLogsFiles(e,n,t.webLogsId)})))}))}}var fJ=n(549692);const yJ={auth:{enableRedirectToSignIn:[{viewportContext:["iFrame"],value:!1}],enableAuthenticateOrGetUser:[{viewportContext:["iFrame"],value:!1}],enableLoginFlow:[{viewportContext:["primary"],value:!0}],skipAmsAuthRequest:[{viewportContext:["primary"],value:!1}]},calendar:{disableCalendarOptimisticClosingForm:[{viewportContext:["secondary"],value:!0}],enableCalendarBIMSpecificOperations:[{viewportContext:["iFrame","primary"],value:!0}],enableCalendarBlockingDiscardConfirmationDialog:[{viewportContext:["flyout","primary","secondary"],value:!1}],enableExtensionTabsInSchedulingForm:[{viewportContext:["secondary"],value:!1}]},calling:{isCallingScreenInteractive:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomfrontofroom","meetingroomfrontofroomcontent","meetingroomfrontofroomgallery"],value:!1}],isCallingAlertDismissEnabled:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!1}],enableExternalCallMonitor:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!1}],allowMultipleCallingAlertBanners:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!1}],allowPinningParticipantFromOutside:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],allowGalleryToggleFromOutside:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],isCallingAlertActionEnabled:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!1}],isContentSharingShownOnCallingScreen:[{entityType:["callsgallery"],value:!1}],isContentOnlyCallingScreen:[{entityType:["callscontent","stagecontent"],value:!0}],isLayoutSwitcherSupported:[{entityType:["callsgalleryandcontent"],value:!0}],showAllCallingAlertsAsBanner:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!0}],isContentCameraSharingSupported:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isIncomingCallScreenSupported:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],enableCallCloseHook:[{entityType:["stagecontent"],value:!1}],enableMeetingReactions:[{entityType:["stagecontent"],value:!1}],enableHideMyselfV2:[{entityType:["callsmonitor"],value:!1}],closeCallingWindowOnError:[{entityType:["callsgalleryandcontent","callsgallery","callscontent"],value:!0}],isParticipantRosterDialogSupported:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomCallingDialog:[{entityType:["callsgalleryandcontent","callsgallery"],value:!0}],isMeetingRoomFrontOfRoomCallPanels:[{entityType:["callsgalleryandcontent","callsgallery"],value:!0}],isMeetingRoomCallHeader:[{entityType:["callsgalleryandcontent","callsgallery"],value:!0}],isMeetingRoomSplitGallery:[{entityType:["callscontent","callsgallery"],value:!0}],isMeetingRoomMainContextItemsManager:[{entityType:["callsgallery"],value:!0}],isMeetingRoomSingleFoRMeetingContextItemsManager:[{entityType:["callsgalleryandcontent"],value:!0}],isMeetingRoomHeroContextItemsManager:[{entityType:["callscontent"],value:!0}],shouldRenderMyselfVideoAtBottom:[{entityType:["callsgalleryandcontent","callsgallery"],value:!0}],shouldMeetingRoomOverrideCQFSampling:[{entityType:["meetingroomconsolecall"],value:!0}],shouldResetCQFTimeoutOnTokenChange:[{entityType:["meetingroomconsolecall"],value:!0}],shouldCQFScreenFillScreen:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomCallingRoster:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomLayoutPanel:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isMeetingRoomFoRUfd:[{entityType:["callsgalleryandcontent","callsgallery"],value:!0}],isMeetingRoomConsoleUfd:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomConsoleUbar:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomConsoleCalling:[{entityType:["meetingroomconsolecall"],value:!0}],shouldUseMultiWindowCallSidePanelControl:[{entityType:["meetingroomconsolecall","callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isMeetingRoomConsoleHome:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomConsoleCalendar:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomFoRCalendar:[{entityType:["meetingroomfrontofroom","meetingroomfrontofroomcontent","meetingroomfrontofroomgallery"],value:!0}],isMeetingRoomCallingAlerts:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomJoinByCode:[{entityType:["meetingroomconsolecall"],value:!0}],isMeetingRoomNewCallScreen:[{entityType:["meetingroomconsolecall"],value:!0}],isNonInteractiveMeetingChat:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isMeetingRoomFrontRowRoster:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],isTouchOnlySmallDisplay:[{entityType:["meetingroomconsolecall"],value:!0}],allowMultiWindowPinningParticipant:[{entityType:["callscontent","callsgallery","callsgalleryandcontent","meetingroomconsolecall"],value:!0}],isPtzCameraControlStateSupported:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}],shouldUbarSubscribeToParticipantChanges:[{entityType:["meetingroomconsolecall"],value:!0}],disableCoachmarksInUbar:[{entityType:["meetingroomconsolecall","callsmonitor"],value:!0}],enableEspCoachmarksInUbar:[{entityType:["meetingroomconsolecall","callsmonitor"],value:!1}]},core:{isHeaderDisabled:[{viewportContext:["iFrame"],value:!0}],isBorderDisabled:[{viewportContext:["iFrame"],value:!0}],enableUnmeasuredSlotDetectionOnThisWindow:[{viewportContext:["iFrame"],value:!0}],disablePopupDragAbility:[{viewportContext:["secondary"],platform:["desktopWindows"],value:!0}],disallowAppRegionOverrides:[{viewportContext:["iFrame"],platform:["desktopWindows","desktopMac","desktopLinux"],value:!0}],isNotificationBannerDisabled:[{viewportContext:["iFrame"],value:!0}],enableWaitForRouteOnSlotTransition:[{viewportContext:["iFrame"],value:!0}],enableLonglivedSubscriptionForChannelsAppViewportSetting:[{viewportContext:["primary","iFrame"],value:!0}],shouldSetBodyTransparent:[{viewportContext:["iFrame"],value:!0}],enableBIMSlots:[{viewportContext:["iFrame"],value:!0}],disableTitleBarForIframe:[{viewportContext:["iFrame"],value:!0}]},people:{isInIframe:[{viewportContext:["iFrame"],value:!0}]},search:{enableChannelsInUnifiedSearch:[{entityType:["email"],value:!0}],enablePeopleSearchV2:[{entityType:["email"],value:!0}],enableChatSearchByPartialMembers:[{entityType:["email"],value:!0}],enableRemoveChatDisabledUsers:[{entityType:["email"],value:!0}],enableLoadingSpinnerAtTop:[{entityType:["email"],value:!0}],resultLimitPerSuggestionType:[{entityType:["email"],value:12}],enableEagerSeedSuggestions:[{entityType:["email"],value:!0}],showTopEagerSeedSuggestions:[{entityType:["email"],value:!0}]},channels:{enableOnlyInMainWindowNotPopouts:[{viewportContext:["iFrame","primary"],value:!0}],showCloseButtonInChannelsRepliesPane:[{viewportContext:["iFrame","primary"],value:!0}],allowPostPopout:[{viewportContext:["iFrame","primary"],value:!0}],enableTabsInChannels:[{viewportContext:["secondary"],value:!1}]},extensibility:{enableAtGetBots:[{entityType:["email"],value:!1}],launchAngularDialog:[{viewportContext:["iFrame"],value:!0}]},files:{showPreferenceDialog:[{viewportContext:["iFrame"],value:!0}],setMessageListenersOnHostForSuperPicker:[{viewportContext:["iFrame"],value:!0}],enablePopups:[{viewportContext:["iFrame"],value:!0}],loadItemsViewStringsFromHost:[{viewportContext:["iFrame"],value:!0}]},meetingRecap:{isRecapInPopout:[{viewportContext:["secondary"],value:!0}]},messaging:{fluidIsRenderingInPopout:[{viewportContext:["secondary"],value:!0}],isHeaderDisabled:[{viewportContext:["iFrame"],value:!0}],enableChatHeaderPopoutButton:[{viewportContext:["iFrame"],value:!0}],enableChatHeaderMeetingDetailsButton:[{viewportContext:["iFrame"],value:!0}],enableInlineVideoMessageDownload:[{viewportContext:["flyout"],value:!1}],disableInlineVideoMessageFullscreen:[{viewportContext:["flyout"],value:!0}],inlineVideoIsRenderingInPopout:[{viewportContext:["secondary"],value:!0}],recorderIsRenderingInPopout:[{viewportContext:["secondary"],value:!0}],notifyMessageListRender:[{viewportContext:["iFrame"],value:!0}],showSingeMessageView:[{viewportContext:["iFrame"],value:!0}],showContextualSearchPrompt:[{viewportContext:["iFrame"],value:!0}],setFocusOnImmersiveReaderClose:[{viewportContext:["iFrame"],value:!1}],enableComposeCriticalPhaseLoadSecondaryViewport:[{viewportContext:["secondary"],value:!0}],enableComposeDebouncedDraftSyncSecondaryViewport:[{viewportContext:["secondary"],value:!0}],enableDraftImageWithServiceWorker:[{viewportContext:["secondary"],value:!1}],entityCommandingTransitionForceFlush:[{viewportContext:["iFrame"],value:!0}],enableLogUnsupportedContent:[{viewportContext:["iFrame"],value:!0}],sendDiscardConversationHideCommand:[{viewportContext:["iFrame"],value:!1}],enableSaveNewChatDraftOnMainWindow:[{viewportContext:["iFrame"],value:!0}],enableDisableAutoScrollForHighActivityMeetings:[{viewportContext:["iFrame","primary"],value:!1}],lightboxTitleInChatMultiWindow:[{viewportContext:["secondary"],value:!1}]},chat:{enableWaitChatNetworkFetch:[{entityType:["callscontent","callsgallery","callsgalleryandcontent"],value:!0}],disableChatPaneLoader:[{viewportContext:["iFrame"],value:!0}]},compose:{editorAddonTextPredictionEnabled:[{viewportContext:["secondary"],value:!1}]},csaService:{enableV3ChatsAPI:[{entityType:["email","messages"],value:!0}]},shortcuts:{shortcutsForIframe:[{viewportContext:["iFrame"],value:!0}],shortcutsForPopout:[{viewportContext:["secondary"],value:!0}]},broadcast:{isRenderingInEmbedMode:[{viewportContext:["iFrame"],value:!0},{viewportContext:["primary"],value:!1}]},cortana:{isCortanaEnabled:[{entityType:["callsgallery","callsgalleryandcontent"],value:!0}]},ufd:{maxUnstackedPermanentDialogs:[{entityType:["meetingroomconsolecall"],value:4}],overrideUfdSyncSeverities:[{entityType:["meetingroomconsolecall"],value:["Critical"]}]}},kJ={},SJ={mappings:{calendar:{isOnCloud:{name:"userPropertiesSettings.isOnCloud"},autodiscoverSettings:{name:"userPropertiesSettings.autodiscoverSettings"},allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},allowChannelMeetingSchedulingPolicy:{name:"meetingPolicy.allowChannelMeetingScheduling"},allowEngagementReportPolicy:{name:"meetingPolicy.allowEngagementReport"},enableCoachByPolicy:{name:"meetingPolicy.allowMeetingCoach"},allowFluidCollaboratePolicy:{name:"messagingPolicy.allowFluidCollaborate"},allowMeetingRegistrationPolicy:{name:"meetingPolicy.allowMeetingRegistration"},allowBroadcastSchedulingPolicy:{name:"broadcastMeetingPolicy.allowBroadcastScheduling"},whoCanRegisterPolicy:{name:"meetingPolicy.whoCanRegister"},allowWebinarsV2Policy:{name:"teamsEventsPolicy.allowWebinars"}},calling:{allowPrivateCallingPolicy:{name:"callingPolicy.allowPrivateCalling"},myPhoneNumber:{name:"voiceAdminSettings.phoneNumber"},voiceAdminSettings:{name:"voiceAdminSettings"},delegationSettingsPolicy:{name:"voiceAdminSettings.delegationSettings"},dialPlanPolicy:{name:"policySettings.dialPlanPolicy"},safeTransferPolicy:{name:"callingPolicy.safeTransferEnabled"},allowCloudRecordingPolicy:{name:"meetingPolicy.allowCloudRecording"},allowRecordingStorageOutsideRegion:{name:"meetingPolicy.allowRecordingStorageOutsideRegion"},recordingStorageMode:{name:"meetingPolicy.recordingStorageMode"},allowCloudRecordingForCallsPolicy:{name:"callingPolicy.allowCloudRecordingForCalls"},closedCaptionsPolicy:{name:"meetingPolicy.liveCaptionsEnabledType"},closedCaptionsForCallingPolicy:{name:"callingPolicy.liveCaptionsEnabledTypeForCalling"},isFluidWhiteboardAllowedByPolicy:{name:"meetingPolicy.allowFluidWhiteboard"},isPptSharingAllowedByPolicy:{name:"meetingPolicy.allowPowerPointSharing"},areMeetingNotesEnabledByPolicy:{name:"meetingPolicy.allowSharedNotes"},isMeetingReactionsAllowedByPolicy:{name:"meetingPolicy.allowMeetingReactions"},customVideoBackgroundsFilterByPolicy:{name:"meetingPolicy.videoFiltersMode"},screenSharingModePolicy:{name:"meetingPolicy.screenSharingMode"},meetingChatEnableTypePolicy:{name:"meetingPolicy.meetingChatEnableType"},allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},allowMeetNowPolicy:{name:"meetingPolicy.allowMeetNow"},isVideoAllowedByPolicy:{name:"meetingPolicy.allowIPVideo"},enableCallTranscriptByPolicy:{name:"meetingPolicy.allowTranscription"},enableCallTranscriptInCallsByPolicy:{name:"callingPolicy.allowTranscriptionForCalling"},teamsVoiceApplicationsPolicy:{name:"teamsVoiceApplicationsPolicy"},enableCoachByPolicy:{name:"meetingPolicy.allowMeetingCoach"},allowSIPDialing:{name:"teamsRoomVideoTeleConferencingPolicy.enabled"},configuredSIPBotId:{name:"teamsRoomVideoTeleConferencingPolicy.areaCode"},enableMeetingRoomGiveFeedback:{name:"feedbackPolicy.userInitiatedMode"},allowFluidMeetingCalendarPolicy:{name:"callingPolicy.allowFluidMeetingCalendar"},allowDocumentCollaborationPolicy:{name:"meetingPolicy.allowDocumentCollaboration"},allowPrivateMeetNowPolicy:{name:"meetingPolicy.allowPrivateMeetNow"}},tenant:{isOrganizationTabEnabled:{name:"tenantSettingsV2.miscellaneous.isOrganizationTabEnabled",defaultValue:!0},tenantSiteUrl:{name:"tenantSiteUrl"}},channels:{enableChannelMeetNowInPostReplyPolicy:{name:"tenantSettingsV2.meetups.isAdhocChannelMeetingEnabled"},enableChannelMeetNowInL1HeaderPolicy:{name:"tenantSettingsV2.meetups.isAdhocChannelMeetingEnabled"}},esp:{enableSmbExternalMeetingCoachmarkExp1:{name:"externalAccessPolicy.enableFederationAccess"},enableSmbExternalMeetingCoachmarkExp2:{name:"externalAccessPolicy.enableFederationAccess"}},extensibility:{isSideLoadingInteractionEnabled:{name:"tenantSettingsV2.apps.isSideLoadingInteractionEnabled"},storeAppTenantBackground:{name:"tenantSettingsV2.apps.lobBackground"},storeAppTenantLogo:{name:"tenantSettingsV2.apps.lobLogo"},storeAppTenantTextColor:{name:"tenantSettingsV2.apps.lobTextColor"},storeAppTenantIcon:{name:"tenantSettingsV2.apps.lobLogomark"}},files:{nativeFileEntryPoints:{name:"filesPolicy.nativeFileEntryPoints",defaultValue:"Enabled"},enableFederationAccess:{name:"externalAccessPolicy.enableFederationAccess",defaultValue:!0}},guardians:{parentGuardianPreferredContactMethod:{name:"educationSettings.parentGuardianPreferredContactMethod"}},meetingArtifacts:{allowEngagementReportPolicy:{name:"meetingPolicy.allowEngagementReport"},allowTrackingInReportPolicy:{name:"meetingPolicy.allowTrackingInReport"}},messaging:{allowPasteInternetImage:{name:"messagingPolicy.allowPasteInternetImage",defaultValue:!0},EnableUpToEditInMW:{name:"messagingPolicy.allowUserEditMessage",defaultValue:!0},allowUserEditMessage:{name:"messagingPolicy.allowUserEditMessage",defaultValue:!0},allowGiphy:{name:"messagingPolicy.allowGiphy",defaultValue:!0},allowGiphyDisplay:{name:"messagingPolicy.allowGiphyDisplay",defaultValue:!0},allowStickers:{name:"messagingPolicy.allowStickers",defaultValue:!0},giphyRatingType:{name:"messagingPolicy.giphyRatingType",defaultValue:"Moderate"},allowPriorityMessages:{name:"messagingPolicy.allowPriorityMessages",defaultValue:!0},allowImmersiveReader:{name:"messagingPolicy.allowImmersiveReader",defaultValue:!0},allowUserChat:{name:"messagingPolicy.allowUserChat",defaultValue:!0},allowRemoveUser:{name:"messagingPolicy.allowRemoveUser",defaultValue:!0},areUrlPreviewsAllowed:{name:"messagingPolicy.allowUrlPreviews",defaultValue:!0},allowUserDeleteMessage:{name:"messagingPolicy.allowUserDeleteMessage",defaultValue:!0},enableSms:{name:"voiceAdminSettings.isSmsEnabled"},messagingPolicy:{name:"messagingPolicy"},allowFluidCollaborate:{name:"messagingPolicy.allowFluidCollaborate",defaultValue:!1},enableVideoMessaging:{name:"messagingPolicy.allowVideoMessages",defaultValue:!1},enableInlineVideoMessageClosedCaptions:{name:"teamsMessagingConfiguration.enableVideoMessageCaptions",defaultValue:!0},allowPrivateMeetingSchedulingPolicy:{name:"meetingPolicy.allowPrivateMeetingScheduling"},isMailboxDiscoverable:{name:"userPropertiesSettings.isMailboxDiscoverable"},isOnCloud:{name:"userPropertiesSettings.isOnCloud"},autodiscoverSettings:{name:"userPropertiesSettings.autodiscoverSettings"},allowCommunicationComplianceEndUserReporting:{name:"messagingPolicy.allowCommunicationComplianceEndUserReporting",defaultValue:!1},receiptsEnabledType:{name:"messagingPolicy.readReceiptsEnabledType",defaultValue:"UserPreference"},allowSmartReply:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},useQuickRepliesSchema:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableSmartRepliesForGroupChat:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableAnimatedEmojisInSmartReplies:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableSmartFilesSuggestions:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},enableSmartSchedulingSuggestions:{name:"messagingPolicy.allowSmartReply",defaultValue:!0},allowMemes:{name:"messagingPolicy.allowMemes",defaultValue:!0},allowUserTranslation:{name:"messagingPolicy.allowUserTranslation",defaultValue:!1},chatPermissionRole:{name:"messagingPolicy.chatPermissionRole",defaultValue:"Restricted"},allowFullChatPermissionUserToDeleteAnyMessage:{name:"messagingPolicy.allowFullChatPermissionUserToDeleteAnyMessage",defaultValue:!1},allowOwnerDeleteMessage:{name:"messagingPolicy.allowOwnerDeleteMessage",defaultValue:!0},userInitiatedMode:{name:"feedbackPolicy.userInitiatedMode"},restrictTeamsConsumerAccessToExternalUserProfiles:{name:"externalAccessPolicy.restrictTeamsConsumerAccessToExternalUserProfiles",defaultValue:!1},enableTeamsConsumerAccess:{name:"externalAccessPolicy.enableTeamsConsumerAccess",defaultValue:!0},allowSecurityEndUserReporting:{name:"messagingPolicy.allowSecurityEndUserReporting",defaultValue:!1}},peopleTargeting:{tagPermissions:{name:"targetingPolicy.manageTagsPermissionMode"},ownersCanOverwriteTagSettings:{name:"targetingPolicy.teamOwnersEditWhoCanManageTagsMode"},suggestedTags:{name:"targetingPolicy.suggestedPresetTags"},customTagMode:{name:"targetingPolicy.customTagsMode"},disallowedSources:{name:"targetingPolicy.disallowedSources"}},teamsAndChannels:{allowPrivateChannelCreation:{name:"teamsAndChannelsPolicy.allowPrivateChannelCreation"},allowPrivateTeamDiscovery:{name:"teamsAndChannelsPolicy.allowPrivateTeamDiscovery"},allowOrgWideTeamCreation:{name:"teamsAndChannelsPolicy.allowOrgWideTeamCreation"},restrictedSenderList:{name:"clientSettings.restrictedSenderList"}},chat:{allowRoleBasedChatPermissions:{name:"clientSettings.allowRoleBasedChatPermissions",defaultValue:!1}},broadcast:{sdnConfiguration:{name:"broadcastMeetingPolicy.broadcastMeetingSDNConfigurationJsonBlob"}},userResources:{isSfbCloud:{name:"userResourcesSettings.isSfbCloud"},isSipEnabled:{name:"userResourcesSettings.isSipEnabled"},isSfbCloudInBVD:{name:"voiceAdminSettings.isSfbCloud"},isSipEnabledInBVD:{name:"voiceAdminSettings.isSipEnabled"},licenseSettings:{name:"userResourcesSettings.licenseSettings"},licenseType:{name:"userResourcesSettings.licenseType"},userClassifications:{name:"userResourcesSettings.userClassifications"}},coach:{enableCoachByPolicy:{name:"meetingPolicy.allowMeetingCoach"}},distributionLists:{allowChatWithGroup:{name:"messagingPolicy.allowChatWithGroup",defaultValue:!0}},virtualEvents:{eventAccessTypePolicy:{name:"teamsEventsPolicy.eventAccessType"},allowEmailEditingPolicy:{name:"teamsEventsPolicy.allowEmailEditing"}},ageConsent:{ageGroup:{name:"ageConsentPolicy.ageGroup"}},feedback:{receiveSurveysMode:{name:"feedbackPolicy.receiveSurveysMode"},allowEmailCollection:{name:"feedbackPolicy.allowEmailCollection"},allowScreenshotCollection:{name:"feedbackPolicy.allowScreenshotCollection",defaultValue:!1},allowLogCollection:{name:"feedbackPolicy.allowLogCollection",defaultValue:!1},enableFeatureSuggestions:{name:"feedbackPolicy.enableFeatureSuggestions"}},sdk:{licenseCategories:{name:"tenantSettingsV2.licenseCategorySettingsMap"}}},namespaces:["userPropertiesSettings","meetingPolicy","messagingPolicy","broadcastMeetingPolicy","teamsEventsPolicy","callingPolicy","voiceAdminSettings","policySettings","teamsVoiceApplicationsPolicy","teamsRoomVideoTeleConferencingPolicy","feedbackPolicy","tenantSettingsV2","tenantSiteUrl","externalAccessPolicy","filesPolicy","educationSettings","teamsMessagingConfiguration","targetingPolicy","teamsAndChannelsPolicy","clientSettings","userResourcesSettings","ageConsentPolicy"]};function bJ(e){switch(e){case"ag08":return n.e(27573).then(n.bind(n,967379)).then((e=>e.default));case"ag09":return n.e(29709).then(n.bind(n,531166)).then((e=>e.default));case"dod":return n.e(48735).then(n.bind(n,254643)).then((e=>e.default));case"gallatin":return n.e(93334).then(n.bind(n,913051)).then((e=>e.default));case"gcc":return n.e(24925).then(n.bind(n,925990)).then((e=>e.default));case"gcchigh":return n.e(54668).then(n.bind(n,965546)).then((e=>e.default));case"life":return n.e(72564).then(n.bind(n,430866)).then((e=>e.default));case"prod":return n.e(62376).then(n.bind(n,343487)).then((e=>e.default));case"viewportOverrides":return yJ;case"clientFilters":return kJ;case"policies":return SJ;default:throw new Error(`Requested config does not exist: ${e}`)}}var CJ=n(706827),wJ=n(747884);const NJ=Ft.WL.END,TJ=Ft.WL.HEADER,IJ=Ft.WL.MAIN,EJ=Ft.WL.MODAL,AJ=Ft.WL.NOTIFICATIONS,_J=Ft.WL.TITLE_BAR,DJ="minmax(0, 1fr)",FJ="minmax(1rem, 1fr)",MJ="3.9rem",RJ=[{slots:[IJ,EJ,AJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}"    auto\n        "${IJ}"             ${DJ} /\n        ${FJ}\n      `}]},{slots:[IJ,EJ,AJ,_J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${_J}"         3.9rem\n        "${AJ}"    auto\n        "${IJ}"             ${DJ} /\n        ${FJ}\n      `}]},{slots:[TJ,IJ,EJ,AJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}"    auto\n        "${TJ}"           auto\n        "${IJ}"             ${DJ} /\n        ${FJ}\n      `}]},{slots:[TJ,IJ,EJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${TJ}"           auto\n        "${IJ}"             ${DJ} /\n        ${FJ}\n      `}]},{slots:[TJ,IJ,EJ,AJ,_J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${_J}"        3.9rem\n        "${AJ}"   auto\n        "${TJ}"          auto\n        "${IJ}"            ${DJ} /\n        ${FJ}\n      `}]},{slots:[NJ,IJ,EJ,AJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}    ${AJ}"    auto\n        "${IJ}             ${NJ}"              ${DJ} /\n        ${FJ}         32rem\n      `}]},{slots:[NJ,IJ,EJ,AJ,_J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${_J}         ${_J}"         3.9rem\n        "${AJ}    ${AJ}"    auto\n        "${IJ}             ${NJ}"              ${FJ} /\n        ${FJ}         32rem\n      `}]},{slots:[NJ,TJ,IJ,EJ,AJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}    ${AJ}"    auto\n        "${TJ}           ${TJ}"           auto\n        "${IJ}             ${NJ}"              ${DJ} /\n        ${FJ}         32rem\n      `}]},{slots:[NJ,TJ,IJ,EJ,AJ,_J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${_J}         ${_J}"         3.9rem\n        "${AJ}    ${AJ}"    auto\n        "${TJ}           ${TJ}"           auto\n        "${IJ}             ${NJ}"              ${DJ} /\n        ${FJ}         32rem\n      `}]},{layoutKey:wJ.FU.HYER,slots:[IJ,EJ,AJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}"   auto\n        "${IJ}"            ${DJ} /\n        ${FJ}\n      `}]},{layoutKey:wJ.FU.HYER,slots:[IJ,EJ,AJ,_J],responsiveTemplates:e=>{var t;const n=(null===(t=e[_J])||void 0===t?void 0:t.height)||MJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${_J}"        ${n}\n        "${AJ}"   auto\n        "${IJ}"            ${DJ} /\n        ${FJ}\n      `}]}},{layoutKey:wJ.FU.HYER,slots:[TJ,IJ,EJ,AJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}"   auto\n        "${TJ}"          auto\n        "${IJ}"            ${DJ} /\n        ${FJ}\n      `}]},{layoutKey:wJ.FU.HYER,slots:[TJ,IJ,EJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${TJ}"          auto\n        "${IJ}"            ${DJ} /\n        ${FJ}\n      `}]},{layoutKey:wJ.FU.HYER,slots:[TJ,IJ,EJ,AJ,_J],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[TJ])||void 0===t?void 0:t.height)||"auto",a=(null===(n=e[_J])||void 0===n?void 0:n.height)||MJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${_J}"        ${a}\n        "${AJ}"   auto\n        "${TJ}"          ${i}\n        "${IJ}"            ${DJ} /\n        ${FJ}\n      `}]}},{layoutKey:wJ.FU.HYER,slots:[NJ,IJ,EJ,AJ],responsiveTemplates:e=>{var t,n,i,a;const o="32rem",r=(null===(n=null===(t=e[NJ])||void 0===t?void 0:t.width)||void 0===n?void 0:n.get(Ur.Rd.IS_GREATER_THAN_0))||o,s=(null===(a=null===(i=e[NJ])||void 0===i?void 0:i.width)||void 0===a?void 0:a.get(Ur.Rd.IS_AT_LEAST_1350))||o;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}    ${AJ}"    auto\n        "${IJ}             ${NJ}"              ${DJ} /\n        ${FJ}         ${r}\n      `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_1350,template:`\n        "${AJ}    ${AJ}"    auto\n        "${IJ}             ${NJ}"              ${DJ} /\n        ${FJ}         ${s}\n      `}]}},{layoutKey:wJ.FU.HYER,slots:[NJ,TJ,IJ,EJ,AJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}    ${AJ}"    auto\n        "${TJ}           ${TJ}"           auto\n        "${IJ}             ${NJ}"              ${DJ} /\n        ${FJ}        32rem\n      `}]},{layoutKey:wJ.FU.HYER,slots:[NJ,TJ,IJ,EJ,AJ,_J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${_J}         ${_J}"         3.9rem\n        "${AJ}    ${AJ}"    auto\n        "${TJ}           ${TJ}"           auto\n        "${IJ}             ${NJ}"              ${DJ} /\n        ${FJ}        32rem\n      `}]},{layoutKey:wJ.FU.HEADER_AT_BOTTOM,slots:[TJ,IJ,EJ,AJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}"    auto\n        "${IJ}"             ${DJ}\n        "${TJ}"           auto /\n        ${FJ}\n      `}]},{layoutKey:wJ.FU.HEADER_AT_BOTTOM,slots:[TJ,IJ,EJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${IJ}"             ${DJ}\n        "${TJ}"           auto /\n        ${FJ}\n      `}]},{layoutKey:wJ.FU.HEADER_AT_BOTTOM,slots:[TJ,IJ,EJ,AJ,_J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${_J}"        3.9rem\n        "${AJ}"   auto\n        "${IJ}"            ${DJ}\n        "${TJ}"          auto /\n        ${FJ}\n      `}]},{layoutKey:wJ.FU.HEADER_AT_BOTTOM,slots:[NJ,TJ,IJ,EJ,AJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${AJ}    ${AJ}"    auto\n        "${IJ}             ${NJ}"              ${DJ}\n        "${TJ}           ${TJ}"           auto /\n        ${FJ}         32rem\n      `}]},{layoutKey:wJ.FU.HEADER_AT_BOTTOM,slots:[NJ,TJ,IJ,EJ,AJ,_J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n        "${_J}         ${_J}"         3.9rem\n        "${AJ}    ${AJ}"    auto\n        "${IJ}             ${NJ}"              ${DJ}\n        "${TJ}           ${TJ}"           auto /\n        ${FJ}         32rem\n      `}]}],PJ="6.1rem",OJ="4.8rem",xJ="6.8rem",LJ=Ft.WL.END,UJ=Ft.WL.HEADER,BJ=Ft.WL.MAIN,jJ=Ft.WL.MODAL,WJ=Ft.WL.NAV,VJ=Ft.WL.NOTIFICATIONS,HJ=Ft.WL.SUBNAV,$J=Ft.WL.TITLE_BAR,zJ=[{slots:[BJ,jJ,VJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${VJ}"    auto\n          "${BJ}"             minmax(0, 1fr) /\n           minmax(1rem, 1fr)\n        `}]},{slots:[BJ,jJ,VJ,$J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${$J}"         4.8rem\n          "${VJ}"    auto\n          "${BJ}"             minmax(0, 1fr) /\n           minmax(1rem, 1fr)\n        `}]},{slots:[UJ,BJ,jJ,VJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${VJ}"    auto\n          "${UJ}"           auto\n          "${BJ}"             minmax(0, 1fr) /\n           minmax(1rem, 1fr)\n        `}]},{slots:[UJ,BJ,jJ,VJ,$J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${$J}"         4.8rem\n          "${VJ}"    auto\n          "${UJ}"           auto\n          "${BJ}"             minmax(0, 1fr) /\n           minmax(1rem, 1fr)\n        `}]},{slots:[LJ,UJ,BJ,jJ,VJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${VJ}    ${VJ}"    auto\n          "${UJ}           ${UJ}"           auto\n          "${BJ}             ${LJ}"              minmax(0, 1fr) /\n           minmax(1rem, 1fr)        32rem\n        `}]},{slots:[LJ,UJ,BJ,jJ,VJ,$J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${$J}         ${$J}"         4.8rem\n          "${VJ}    ${VJ}"    auto\n          "${UJ}           ${UJ}"           auto\n          "${BJ}             ${LJ}"              minmax(0, 1fr) /\n           minmax(1rem, 1fr)        32rem\n        `}]},{layoutKey:wJ.FU.HYER,slots:[UJ,BJ,jJ,VJ],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[UJ])||void 0===t?void 0:t.height)||PJ,a=(null===(n=e[VJ])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${VJ}"    ${a}\n            "${UJ}"           ${i}\n            "${BJ}"             minmax(0, 1fr) /\n             minmax(1rem, 1fr)\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[UJ,BJ,jJ,VJ,$J],responsiveTemplates:e=>{var t,n,i;const a=(null===(t=e[UJ])||void 0===t?void 0:t.height)||PJ,o=(null===(n=e[VJ])||void 0===n?void 0:n.height)||"auto",r=(null===(i=e[$J])||void 0===i?void 0:i.height)||OJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}"         ${r}\n            "${VJ}"    ${o}\n            "${UJ}"           ${a}\n            "${BJ}"             minmax(0, 1fr) /\n             minmax(1rem, 1fr)\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[LJ,UJ,BJ,jJ,VJ],responsiveTemplates:e=>{var t,n;const i=(null===(t=e[UJ])||void 0===t?void 0:t.height)||PJ,a=(null===(n=e[VJ])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${VJ}    ${VJ}"    ${a}\n            "${UJ}           ${UJ}"           ${i}\n            "${BJ}             ${LJ}"              minmax(0, 1fr) /\n             minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[LJ,UJ,BJ,jJ,VJ,$J],responsiveTemplates:e=>{var t,n,i;const a=(null===(t=e[UJ])||void 0===t?void 0:t.height)||PJ,o=(null===(n=e[VJ])||void 0===n?void 0:n.height)||"auto",r=(null===(i=e[$J])||void 0===i?void 0:i.height)||OJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}         ${$J}"         ${r}\n            "${VJ}    ${VJ}"    ${o}\n            "${UJ}           ${UJ}"           ${a}\n            "${BJ}             ${LJ}"              minmax(0, 1fr) /\n             minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[BJ,jJ,WJ,VJ,$J],responsiveTemplates:e=>{var t,n,i,a;const o=(null===(t=e[VJ])||void 0===t?void 0:t.height)||"auto",r=(null===(n=e[$J])||void 0===n?void 0:n.height)||OJ,s=(null===(a=null===(i=e[WJ])||void 0===i?void 0:i.width)||void 0===a?void 0:a.get(Ur.Rd.IS_GREATER_THAN_0))||xJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}    ${$J}"         ${r}\n            "${WJ}         ${VJ}"    ${o}\n            "${WJ}         ${BJ}"             minmax(0, 1fr) /\n             ${s}    minmax(1rem, 1fr)\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[UJ,BJ,jJ,WJ,VJ,$J],responsiveTemplates:e=>{var t,n,i,a,o;const r=(null===(t=e[UJ])||void 0===t?void 0:t.height)||PJ,s=(null===(n=e[VJ])||void 0===n?void 0:n.height)||"auto",l=(null===(i=e[$J])||void 0===i?void 0:i.height)||OJ,d=(null===(o=null===(a=e[WJ])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(Ur.Rd.IS_GREATER_THAN_0))||xJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}    ${$J}"         ${l}\n            "${WJ}         ${VJ}"    ${s}\n            "${WJ}         ${UJ}"           ${r}\n            "${WJ}         ${BJ}"             minmax(0, 1fr) /\n             ${d}    minmax(1rem, 1fr)\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[LJ,BJ,jJ,WJ,VJ,$J],responsiveTemplates:e=>{var t,n,i,a;const o=(null===(t=e[VJ])||void 0===t?void 0:t.height)||"auto",r=(null===(n=e[$J])||void 0===n?void 0:n.height)||OJ,s=(null===(a=null===(i=e[WJ])||void 0===i?void 0:i.width)||void 0===a?void 0:a.get(Ur.Rd.IS_GREATER_THAN_0))||xJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}    ${$J}"         ${r}\n            "${WJ}         ${VJ}"    ${o}\n            "${WJ}         ${BJ}"             minmax(0, 1fr) /\n             ${s}    minmax(1rem, 1fr)\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[LJ,UJ,BJ,jJ,WJ,VJ,$J],responsiveTemplates:e=>{var t,n,i,a,o;const r=(null===(t=e[UJ])||void 0===t?void 0:t.height)||PJ,s=(null===(n=e[VJ])||void 0===n?void 0:n.height)||"auto",l=(null===(i=e[$J])||void 0===i?void 0:i.height)||OJ,d=(null===(o=null===(a=e[WJ])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(Ur.Rd.IS_GREATER_THAN_0))||xJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}    ${$J}         ${$J}"         ${l}\n            "${WJ}         ${VJ}    ${VJ}"    ${s}\n            "${WJ}         ${UJ}           ${UJ}"           ${r}\n            "${WJ}         ${BJ}             ${LJ}"              minmax(0, 1fr) /\n             ${d}    minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[BJ,jJ,WJ,VJ,HJ,$J],responsiveTemplates:e=>{var t,n,i,a;const o=(null===(t=e[VJ])||void 0===t?void 0:t.height)||"auto",r=(null===(n=e[$J])||void 0===n?void 0:n.height)||OJ,s=(null===(a=null===(i=e[WJ])||void 0===i?void 0:i.width)||void 0===a?void 0:a.get(Ur.Rd.IS_GREATER_THAN_0))||xJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}    ${$J}    ${$J}"         ${r}\n            "${WJ}         ${HJ}      ${VJ}"    ${o}\n            "${WJ}         ${HJ}      ${BJ}"             minmax(0, 1fr) /\n             ${s}    0              minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_947,template:`\n            "${$J}    ${$J}    ${$J}"         ${r}\n            "${WJ}         ${HJ}      ${VJ}"    ${o}\n            "${WJ}         ${HJ}      ${BJ}"             minmax(0, 1fr) /\n             ${s}    28rem          minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_1350,template:`\n            "${$J}    ${$J}    ${$J}"         ${r}\n            "${WJ}         ${HJ}      ${VJ}"    ${o}\n            "${WJ}         ${HJ}      ${BJ}"             minmax(0, 1fr) /\n             ${s}    32rem          minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_1500,template:`\n            "${$J}    ${$J}    ${$J}"         ${r}\n            "${WJ}         ${HJ}      ${VJ}"    ${o}\n            "${WJ}         ${HJ}      ${BJ}"             minmax(0, 1fr) /\n             ${s}    36rem          minmax(1rem, 1fr)\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[UJ,BJ,jJ,WJ,VJ,HJ,$J],responsiveTemplates:e=>{var t,n,i,a,o,r;const s=(null===(t=e[UJ])||void 0===t?void 0:t.height)||PJ,l=(null===(n=e[VJ])||void 0===n?void 0:n.height)||"auto",d=(null===(i=e[$J])||void 0===i?void 0:i.height)||OJ,c=(null===(o=null===(a=e[WJ])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(Ur.Rd.IS_GREATER_THAN_0))||xJ,u=null===(r=e[HJ])||void 0===r?void 0:r.width,m=(null==u?void 0:u.get(Ur.Rd.IS_GREATER_THAN_0))||"0",g=(null==u?void 0:u.get(Ur.Rd.IS_AT_LEAST_947))||"28rem",p=(null==u?void 0:u.get(Ur.Rd.IS_AT_LEAST_1350))||"32rem",v=(null==u?void 0:u.get(Ur.Rd.IS_AT_LEAST_1500))||"36rem";return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}    ${$J}    ${$J}"        ${d}\n            "${WJ}         ${HJ}      ${VJ}"   ${l}\n            "${WJ}         ${HJ}      ${UJ}"          ${s}\n            "${WJ}         ${HJ}      ${BJ}"            minmax(0, 1fr) /\n             ${c}    ${m}              minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_947,template:`\n            "${$J}    ${$J}    ${$J}"        ${d}\n            "${WJ}         ${HJ}      ${VJ}"   ${l}\n            "${WJ}         ${HJ}      ${UJ}"          ${s}\n            "${WJ}         ${HJ}      ${BJ}"            minmax(0, 1fr) /\n             ${c}    ${g}          minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_1350,template:`\n            "${$J}    ${$J}    ${$J}"        ${d}\n            "${WJ}         ${HJ}      ${VJ}"   ${l}\n            "${WJ}         ${HJ}      ${UJ}"          ${s}\n            "${WJ}         ${HJ}      ${BJ}"            minmax(0, 1fr) /\n             ${c}    ${p}          minmax(1rem, 1fr)\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_1500,template:`\n            "${$J}    ${$J}    ${$J}"        ${d}\n            "${WJ}         ${HJ}      ${VJ}"   ${l}\n            "${WJ}         ${HJ}      ${UJ}"          ${s}\n            "${WJ}         ${HJ}      ${BJ}"            minmax(0, 1fr) /\n             ${c}    ${v}          minmax(1rem, 1fr)\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[LJ,BJ,jJ,WJ,VJ,HJ,$J],responsiveTemplates:e=>{var t,n,i,a,o;const r=(null===(t=e[LJ])||void 0===t?void 0:t.width)||"0",s=(null===(n=e[VJ])||void 0===n?void 0:n.height)||"auto",l=(null===(i=e[$J])||void 0===i?void 0:i.height)||OJ,d=(null===(o=null===(a=e[WJ])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(Ur.Rd.IS_GREATER_THAN_0))||xJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}    ${$J}    ${$J}         ${$J}"         ${l}\n            "${WJ}         ${HJ}      ${VJ}    ${VJ}"    ${s}\n            "${WJ}         ${HJ}      ${BJ}             ${LJ}"              minmax(0, 1fr) /\n             ${d}    0              minmax(1rem, 1fr)        ${r}\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_947,template:`\n            "${$J}    ${$J}    ${$J}         ${$J}"         ${l}\n            "${WJ}         ${HJ}      ${VJ}    ${VJ}"    ${s}\n            "${WJ}         ${HJ}      ${BJ}             ${LJ}"              minmax(0, 1fr) /\n             ${d}    28rem          minmax(1rem, 1fr)        ${r}\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_1350,template:`\n            "${$J}    ${$J}    ${$J}         ${$J}"         ${l}\n            "${WJ}         ${HJ}      ${VJ}    ${VJ}"    ${s}\n            "${WJ}         ${HJ}      ${BJ}             ${LJ}"              minmax(0, 1fr) /\n             ${d}    32rem          minmax(1rem, 1fr)        32rem\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_1500,template:`\n            "${$J}    ${$J}    ${$J}         ${$J}"         ${l}\n            "${WJ}         ${HJ}      ${VJ}    ${VJ}"    ${s}\n            "${WJ}         ${HJ}      ${BJ}             ${LJ}"              minmax(0, 1fr) /\n             ${d}    36rem          minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:wJ.FU.HYER,slots:[LJ,UJ,BJ,jJ,WJ,VJ,HJ,$J],responsiveTemplates:e=>{var t,n,i,a,o,r;const s=(null===(t=e[LJ])||void 0===t?void 0:t.width)||"0",l=(null===(n=e[UJ])||void 0===n?void 0:n.height)||PJ,d=(null===(i=e[VJ])||void 0===i?void 0:i.height)||"auto",c=(null===(a=e[$J])||void 0===a?void 0:a.height)||OJ,u=(null===(r=null===(o=e[WJ])||void 0===o?void 0:o.width)||void 0===r?void 0:r.get(Ur.Rd.IS_GREATER_THAN_0))||xJ;return[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n            "${$J}    ${$J}    ${$J}         ${$J}"         ${c}\n            "${WJ}         ${HJ}      ${VJ}    ${VJ}"    ${d}\n            "${WJ}         ${HJ}      ${UJ}           ${UJ}"           ${l}\n            "${WJ}         ${HJ}      ${BJ}             ${LJ}"              minmax(0, 1fr) /\n             ${u}    0              minmax(1rem, 1fr)        ${s}\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_947,template:`\n            "${$J}    ${$J}    ${$J}         ${$J}"         ${c}\n            "${WJ}         ${HJ}      ${VJ}    ${VJ}"    ${d}\n            "${WJ}         ${HJ}      ${UJ}           ${UJ}"           ${l}\n            "${WJ}         ${HJ}      ${BJ}             ${LJ}"              minmax(0, 1fr) /\n             ${u}    28rem          minmax(1rem, 1fr)        ${s}\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_1350,template:`\n            "${$J}    ${$J}    ${$J}         ${$J}"         ${c}\n            "${WJ}         ${HJ}      ${VJ}    ${VJ}"    ${d}\n            "${WJ}         ${HJ}      ${UJ}           ${UJ}"           ${l}\n            "${WJ}         ${HJ}      ${BJ}             ${LJ}"              minmax(0, 1fr) /\n             ${u}    32rem          minmax(1rem, 1fr)        32rem\n          `},{minWidthBreakpoint:Ur.Rd.IS_AT_LEAST_1500,template:`\n            "${$J}    ${$J}    ${$J}         ${$J}"         ${c}\n            "${WJ}         ${HJ}      ${VJ}    ${VJ}"    ${d}\n            "${WJ}         ${HJ}      ${UJ}           ${UJ}"           ${l}\n            "${WJ}         ${HJ}      ${BJ}             ${LJ}"              minmax(0, 1fr) /\n             ${u}    36rem          minmax(1rem, 1fr)        32rem\n          `}]}},{layoutKey:wJ.FU.HEADER_AT_BOTTOM,slots:[UJ,BJ,jJ,VJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${VJ}"    auto\n          "${BJ}"             minmax(0, 1fr)\n          "${UJ}"           auto /\n           minmax(1rem, 1fr)\n        `}]},{layoutKey:wJ.FU.HEADER_AT_BOTTOM,slots:[UJ,BJ,jJ,VJ,$J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${$J}"        3.9rem\n          "${VJ}"   auto\n          "${BJ}"            minmax(0, 1fr)\n          "${UJ}"          auto /\n           minmax(1rem, 1fr)\n        `}]},{layoutKey:wJ.FU.HEADER_AT_BOTTOM,slots:[LJ,UJ,BJ,jJ,VJ],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${VJ}    ${VJ}"    auto\n          "${BJ}             ${LJ}"              minmax(0, 1fr)\n          "${UJ}           ${UJ}"           auto /\n           minmax(1rem, 1fr)        32rem\n        `}]},{layoutKey:wJ.FU.HEADER_AT_BOTTOM,slots:[LJ,UJ,BJ,jJ,VJ,$J],responsiveTemplates:[{minWidthBreakpoint:Ur.Rd.IS_GREATER_THAN_0,template:`\n          "${$J}         ${$J}"         3.9rem\n          "${VJ}    ${VJ}"    auto\n          "${BJ}             ${LJ}"              minmax(0, 1fr)\n          "${UJ}           ${UJ}"           auto /\n           minmax(1rem, 1fr)        32rem\n        `}]}];function GJ({layoutKey:e,layoutMode:t}){const n={[c.lO.focus]:RJ,[c.lO.minimal]:[],[c.lO.standard]:zJ};return new wJ.ZG({layoutKey:e,layoutMode:t,layoutTemplatesPerLayoutMode:n})}const qJ=e=>e instanceof Error?e:(console.error("Promise rejected with non-Error reason",e),(0,Mn.Tr)("SanePromise",De.jK.UndefinedGlobalError,"",{reason:e},"Non-Error rejection"));performance&&performance.mark&&performance.mark("start-execute-main-bundle"),n(484298);const QJ={Application:{onPreWarm:["settings-ecs-fetch","search-data-load","bootstrap-floodgate","start-meeting-bot","esp-signal-handler-job"]}},JJ=({osPlatform:e,theme:t,cspNonce:n,publicPathScript:i,containerVer:a,shouldStubConsoleError:o=!0})=>{const{favicons:r,preloadTitleBar:s}=Kk.L;return CJ({htmlWebpackPlugin:{options:{containerVer:a,publicPathScript:i,cspNonce:n,theme:t,shouldStubConsoleError:o,partials:{favicons:r(),preloadTitleBar:s({osPlatform:e})}},files:{}}})},YJ=(e,t)=>{let i=!1;(0,d.mT)((()=>Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(47113),n.e(15803),n.e(75916),n.e(50611),n.e(60567),n.e(84460),n.e(10440),n.e(75912),n.e(45746),n.e(19351),n.e(7983),n.e(1839),n.e(4759),n.e(5227),n.e(99834),n.e(62514),n.e(21439),n.e(38393),n.e(68865),n.e(2205),n.e(88978),n.e(23054),n.e(28430),n.e(79e3),n.e(27631),n.e(2054)]).then(n.bind(n,460887))),"core-essentials",t).catch((t=>{e.newLogger("Multi-Window").error(`Failed to prefetch Core Layout: ${t}`),i=i||(e=>((0,Ze.J)().opener.postMessage(cS.W.ExperienceStarted,{message:e.message,errorCode:-1,errorDescription:`${e.code}: ${e.subContext}`}),!0))(t)}))},KJ=(e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{renderErrorScreen:i}=yield Promise.all([n.e(70197),n.e(50633),n.e(17512),n.e(18861),n.e(287),n.e(28441),n.e(47113),n.e(15803),n.e(75916),n.e(50611),n.e(60567),n.e(10440),n.e(75912),n.e(45746),n.e(19351),n.e(7983),n.e(1839),n.e(4759),n.e(5227),n.e(62514),n.e(21439),n.e(38393),n.e(2205),n.e(99126),n.e(79e3),n.e(27631),n.e(14682)]).then(n.bind(n,653494)),a=document.getElementById("app");a&&i(e,a,(0,Ze.J)(),void 0,t)})),ZJ=e=>{const t={},n=e.vdiSettings;if(n){let e;switch(n.provider){case"1":e=fJ.P.CitrixXenDesktop;break;case"2":e=fJ.P.CitrixXenApp;break;case"3":e=fJ.P.VMWare;break;case"5":e=fJ.P.WVD;break;default:e=fJ.P.None}t.vdi={provider:e,mode:n.mode,isAvRemoted:n.isAvRemoted,configFilter:(0,a.isEmpty)(n.configFilter)?null:n.configFilter}}const i=(e.navigator.userAgent||"").toLowerCase();return-1===i.indexOf("teamssamsungtv")&&-1===i.indexOf("teamscherrydevice")||(t.platformId=Ye.us.TV),-1!==i.indexOf("teamstesla")&&(t.platformId=Ye.us.Automotive),t};(()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e;const t=Date.now(),i=(0,Ze.J)();i.opener.postMessage(cS.W.ExperienceStarted,{message:"beforeCoreStart"}),i.handleGlobalWindowError&&(i.removeEventListener("error",i.handleGlobalWindowError),i.handleGlobalWindowError=void 0),i.consoleErrorFn&&(console.error=i.consoleErrorFn,i.consoleErrorFn=void 0);const a=n(759455),o=[C(),x(),Y(),pe(),Ee(),Qe(),ht(),dn(),Fn(),Aa(),oo(),So(),Cs(),Ps(),qs(),Jl(),ud(),Ud(),Wd(),nc(),gc(),hc(),Ec(),Vc(),Xc(),cu(),Au(),Wu(),Xu(),pm(),Tm(),xm(),Uk(),wg(),Qg(),up(),Tp(),jv(),Xv(),nh(),fh(),jh(),ry(),Yk(),yy(),Fy(),$y(),nk(),pk()];((e,t)=>{try{const t=e.localStorage.getItem("logLevel");if(t){const n=parseInt(t,10);if(n>=xw.i.None&&n<=xw.i.Max)return void(e.defaultConsoleLogLevel={userConsoleLogLevel:n})}}catch(e){}let n={preECSConsoleLogLevel:xw.i.Warn};if(e.location.host.indexOf("local")>=0)n={preECSConsoleLogLevel:xw.i.Warn};else{let e="unknown";if(t&&"object"==typeof t&&"ring"in t){const n=t.ring;n&&("string"==typeof n?e=n:"object"==typeof n&&"id"in n&&(e=n.id||"unknown"))}n=e.indexOf("general")>=0||e.indexOf("ring3")>=0?{preECSConsoleLogLevel:xw.i.None}:{preECSConsoleLogLevel:xw.i.Warn}}e.defaultConsoleLogLevel=n})(i,a);const r=new hJ({config:Object.assign(Object.assign({},a),{startTimeMS:t,lifeCycleJobPermissions:QJ}),apps:o,loadConfigs:bJ,generateChildWindowTemplate:JJ,getPlatformConfigurationOverrides:ZJ});let s;try{yield r.init(),s=r.coreServices}catch(e){return void KJ(e)}if(!s)return;const{coreSettings:l,loggerFactory:d,scenarioFactory:c}=s,{sanePromise:u}=l.get(K.J.Core);u&&(s.windowProvider.Promise=function(e){var t,n;class i{constructor(t){this[n]=e.prototype[Symbol.toStringTag],this._promise=new e(((e,n)=>{try{t(e,(e=>n(qJ(e))))}catch(e){n(qJ(e))}}))}then(e,t){return new i(((n,i)=>this._promise.then(e,t).then(n,i)))}catch(e){return new i(((t,n)=>this._promise.catch(e).then(t,n)))}finally(e){return new i(((t,n)=>{let i=!1;return this._promise.catch((e=>(i=!0,e))).then(e).then(i?n:t)}))}always(e){return new i(((t,n)=>this._promise.then((n=>{e(n),t(n)}),(t=>{e(t),n(t)}))))}}return t=Symbol.species,n=Symbol.toStringTag,i.all=t=>new i(((n,i)=>e.all(t).then(n,i))),i.race=t=>new i(((n,i)=>e.race(t).then(n,i))),i.reject=t=>new i(((n,i)=>e.reject(t).then(n,i))),i.resolve=t=>new i(void 0===t?(t,n)=>e.resolve().then(t,n):(n,i)=>e.resolve(t).then(n,i)),i[t]=i,i}(Promise));const m={config:a,getLayoutResponsiveTemplates:GJ,uiVariables:{isMultiWindow:!0}};yield(0,Zk.o)(r.activeWindows,s,(0,Xk.c)(m)),YJ(d,c),null===(e=s.scenarioFactory.findScenario(ft.RG.ExperienceReady))||void 0===e||e.stop()})))().catch((e=>{KJ(e)}))},494032:(e,t,n)=>{"use strict";n.d(t,{rY:()=>o,Ok:()=>r});var i=n(109458);function a(e){if(e.definitions.length>1)return null;const t=e.definitions[0];return"FragmentDefinition"!==t.kind?null:t}function o(e){const t=(0,i.S)(e);if(!(null==t?void 0:t.name))throw new Error("Operation name must be set");return t.name.value}function r(e){var t;let n=(0,i.S)(e);return n||(n=a(e)),(null===(t=null==n?void 0:n.name)||void 0===t?void 0:t.value)||null}},834357:(e,t,n)=>{"use strict";n.d(t,{$Z:()=>p,aw:()=>m,nl:()=>u});var i=n(231191),a=n(637666),o=n(966009),r=n(651459),s=n(402052),l=n(628235);class d extends s.h{constructor(e,t){super(e),this.definitionOverflowLogged=new Set,this.isDuplicateWrite=e=>this.lastWrite&&this.lastDiff&&this.lastWrite===this.lastDiff.precedingWrite&&e.result===this.lastDiff.result;const{loggerFactory:n,scenarioFactory:i,graphqlStoreStatsReporterService:a,storeType:o,enableApolloDoubleWriteFix:r}=t;this.storeType=o,this.enableApolloDoubleWriteFix=r,n&&(this.logger=n.newLogger("InMemoryCacheWrapper")),i&&(this.scenarioFactory=i),a&&(this.graphqlStoreStatsReporterService=a)}write(e){var t,n,i,a,o,r,s;let l,d=0;try{if(this.lastWrite&&this.isDuplicateWrite(e)&&(null===(t=this.graphqlStoreStatsReporterService)||void 0===t||t.markDuplicateWrite(this.storeType,e.query,null!==(n=this.lastWrite.elapsed)&&void 0!==n?n:0),this.enableApolloDoubleWriteFix))return this.lastWrite.result;l=null===(i=this.graphqlStoreStatsReporterService)||void 0===i?void 0:i.markWriteStart(this.storeType,e.query);const r=super.write(e);return l&&(d=null!==(o=null===(a=this.graphqlStoreStatsReporterService)||void 0===a?void 0:a.markWriteEnd(l))&&void 0!==o?o:0),this.lastWrite={result:r,elapsed:d},r}catch(e){throw null===(r=this.logger)||void 0===r||r.error(e.message),l&&(null===(s=this.graphqlStoreStatsReporterService)||void 0===s||s.markWriteError(l)),e}}read(e){var t,n;let i;try{i=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markReadStart(this.storeType,e.query);const a=super.read(e);return i&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markReadEnd(i)),a}finally{this.logResultCacheOverflowOnce("read",e.query)}}modify(e){var t,n,i,a;let o;try{o=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markWriteStart(this.storeType,`modify ${e.id||"ROOT_QUERY"}`);const i=super.modify(e);return o&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markWriteEnd(o)),i}catch(e){throw null===(i=this.logger)||void 0===i||i.error(e.message),o&&(null===(a=this.graphqlStoreStatsReporterService)||void 0===a||a.markWriteError(o)),e}}diff(e){var t,n;let i;try{i=null===(t=this.graphqlStoreStatsReporterService)||void 0===t?void 0:t.markDiffStart(this.storeType,e.query);const a=super.diff(e);return i&&(null===(n=this.graphqlStoreStatsReporterService)||void 0===n||n.markDiffEnd(i)),this.lastDiff={result:a.result,precedingWrite:this.lastWrite},a}finally{this.logResultCacheOverflowOnce("diff",e.query)}}logResultCacheOverflowOnce(e,t){var n,i,a,o,r;const s=t.definitions[0],d=this.getLastResultCacheOverflow();if(!this.scenarioFactory||d<=0||"OperationDefinition"!==s.kind)return;let c;if(s.name||1!==s.selectionSet.selections.length||"FragmentSpread"!==s.selectionSet.selections[0].kind){c={definitionKind:"query",definitionName:null!==(r=null===(o=s.name)||void 0===o?void 0:o.value)&&void 0!==r?r:"(unnamed)",overflowSize:d,method:e}}else{c={definitionKind:"fragment",definitionName:null!==(a=null===(i=null===(n=s.selectionSet.selections[0])||void 0===n?void 0:n.name)||void 0===i?void 0:i.value)&&void 0!==a?a:"",overflowSize:d,method:e}}const u=`${c.definitionKind}-${c.definitionName}`;if(!this.definitionOverflowLogged.has(u)){this.scenarioFactory.createScenarioWithoutStarting(l.RG.ApolloResultCacheOverflow).stop(c),this.definitionOverflowLogged.add(u)}}getLastResultCacheOverflow(){var e,t,n;return(null!==(n=(null!==(t=(null!==(e=this.storeReader)&&void 0!==e?e:{}).executeSelectionSet)&&void 0!==t?t:{}).__DEBUG_ONLY_optimismCache)&&void 0!==n?n:{}).__DEBUG_ONLY_lastOverflow||0}}const c=d,u=(e={})=>{const{apolloLeakOptions:t,cache:n,loggerFactory:r,scenarioFactory:s,enableApolloDevtools:l,enableApolloDoubleWriteFix:d,storeType:c=o.t.other,graphqlStoreStatsReporterService:u}=e,p=(0,i.__rest)(e,["apolloLeakOptions","cache","loggerFactory","scenarioFactory","enableApolloDevtools","enableApolloDoubleWriteFix","storeType","graphqlStoreStatsReporterService"]),v=new a.f(Object.assign(Object.assign({},p),{cache:n||m({apolloLeakOptions:t,loggerFactory:r,scenarioFactory:s,storeType:c,graphqlStoreStatsReporterService:u,enableApolloDoubleWriteFix:d}),assumeImmutableResults:!0,connectToDevTools:Boolean(l)}));return g(v,t),v},m=(e={})=>{var t,{apolloLeakOptions:n,loggerFactory:a,scenarioFactory:s,graphqlStoreStatsReporterService:l,storeType:d,enableApolloDoubleWriteFix:u}=e,m=(0,i.__rest)(e,["apolloLeakOptions","loggerFactory","scenarioFactory","graphqlStoreStatsReporterService","storeType","enableApolloDoubleWriteFix"]);const p={loggerFactory:a,scenarioFactory:s,graphqlStoreStatsReporterService:l,storeType:d||o.t.other,enableApolloDoubleWriteFix:u},v=new c(m,p);return null===(t=null==n?void 0:n.leakDetector)||void 0===t||t.track(r.I.ApolloCache,v),g(v,n),v},g=(e,{userContextId:t,windowId:n,entityType:i,viewportContext:a}={})=>{e.apolloLeakInfo={apolloLeakInfoStartTime:(new Date).toUTCString(),apolloLeakInfoEntityType:i,apolloLeakInfoUserContextId:t,apolloLeakInfoViewportContext:a,apolloLeakInfoWindowId:n}},p=e=>{e.apolloLeakInfo||(e.apolloLeakInfo={}),e.apolloLeakInfo.apolloLeakInfoEndTime=(new Date).toUTCString()}},761481:(e,t,n)=>{"use strict";n.d(t,{T:()=>a});var i=n(883180);const a=e=>{const t=performance.now();return{cacheSize:i({data:e.data.data,optimisticData:e.optimisticData.data}),measuringTime:performance.now()-t}}},558487:(e,t,n)=>{"use strict";n.d(t,{TP:()=>o,ad:()=>r,U:()=>l});var i=n(883180);function a(e){var t,n;const i=e.storeReader;return{selectionSetCache:null===(t=null==i?void 0:i.executeSelectionSet)||void 0===t?void 0:t.__DEBUG_ONLY_optimismCache,selectionSetArrayCache:null===(n=null==i?void 0:i.executeSubSelectedArray)||void 0===n?void 0:n.__DEBUG_ONLY_optimismCache}}function o(e){const{selectionSetCache:t,selectionSetArrayCache:n}=a(e),o=performance.now(),r=[Array.from(t.map),Array.from(n.map)];return{cacheSize:i(r),measuringTime:performance.now()-o}}function r(e){const{selectionSetCache:t,selectionSetArrayCache:n}=a(e);return{objectCount:t.map.size,arrayCount:n.map.size}}function s(e){var t,n,i,a;if(0===e.length)return"[Dirty]";let o="";return e[0]&&e[0].result&&(o=null!==(n=null===(t=e[0].result)||void 0===t?void 0:t.__typename)&&void 0!==n?n:"[Query]"),e[1]&&(o+=` (Error: ${null!==(a=null===(i=e[1])||void 0===i?void 0:i.message)&&void 0!==a?a:""})`),o}function l(e){var t;const{selectionSetCache:n}=a(e),i=new Map;for(const e of n.map.values()){const n=s(e.value.value),a=null!==(t=i.get(n))&&void 0!==t?t:0;i.set(n,a+1)}return Array.from(i).sort(((e,t)=>t[1]-e[1]))}},691442:(e,t,n)=>{"use strict";n.d(t,{Hl:()=>i,TV:()=>a,OX:()=>o,Rc:()=>r,ST:()=>s,sb:()=>l});const i="ComposeInlineImageCardExtension",a="ComposeClipboardInlineImageCardExtension",o="teams-image-placeholder",r="data-image-url",s="InlineImageCard",l="SingleInlineImageCard"},45417:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var i=n(454948),a=n(558103);const o=["NoNetwork","RemoteOperationFailed"];class r extends i.G{constructor(e,t){super({type:"AuthError",code:s(e,t),prevError:"boolean"==typeof e?void 0:e})}getBoundaryProps(){switch(this.code){case"SIGN_IN_RESTRICTIONS":return{title:"default_signinrestrictions_title",description:"default_signinrestrictions_description",actions:["RESTART"]};case"ERROR_GETUSER_WHEN_ANON_NOT_SUPPORTED":return{title:"default_error_getuser_when_anon_not_supported_title",description:"default_error_getuser_when_anon_not_supported_description"};case"OFFLINE":return{title:"default_auth_no_network_title",description:"default_auth_no_network_description",actions:["RESTART"]};default:return{title:"default_authentication_title",description:"default_authentication_description",actions:["RESTART","SIGN_OUT"]}}}static fromSerialized(e){if("AuthError"!==(null==e?void 0:e.type))return null;const t=new r(void 0,e.code);return t.deserialize(e),t}}function s(e,t){if(t)return t;if("boolean"==typeof e)return e?"SIGN_IN_RESTRICTIONS":"UNKNOWN";if((0,a.a)(e)){const t=e.code;switch(t){case"SignInRestrictions":return"SIGN_IN_RESTRICTIONS";case"ErrorGetUserWhenAnonNotSupported":return"ERROR_GETUSER_WHEN_ANON_NOT_SUPPORTED";default:return o.includes(t)?"OFFLINE":"UNKNOWN"}}return"UNKNOWN"}},605809:(e,t,n)=>{"use strict";var i;n.d(t,{P:()=>i,X:()=>a}),function(e){e.DefaultDark="defaultDark",e.Default="default",e.NoLongerAllowed="noLongerAllowed"}(i||(i={}));const a={[i.DefaultDark]:"/evergreen-assets/illustrations/error/something-went-wrong-v2-dark.svg",[i.Default]:"/evergreen-assets/illustrations/error/something-went-wrong-v2.svg",[i.NoLongerAllowed]:"/evergreen-assets/illustrations/error/license-error-no-longer-allowed-hero.svg"}},117772:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});var i=n(231191);const a=()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return n.e(76983).then(n.bind(n,376983))}))},5317:(e,t,n)=>{"use strict";n.d(t,{b:()=>T});var i=n(231191),a=n(391606),o=n(913469),r=n(41594),s=n(84574),l=n(878233),d=n(661564),c=n(893088),u=n(118824),m=n(324819),g=n(843149),p=n(856382),v=n(769088),h=n(538606),f=n(640568),y=n(642115);const k=3e5;var S=n(11574);const b="beta/imageauth/cookie",C="beta/users/{objectId}/cookiev2",w=1e3,N=new Map([[v.ej.SKYPE_KEY,[s.Pn.ams,s.Pn.amsV2]],[v.ej.MT_KEY,[s.Pn.mtImageService]]]);class T{constructor(e,t,n,i,m,v,S,N,T,I,E,A){var _;this._gtmRegistry=t,this._discover=n,this.coreSettings=m,this.windowProvider=v,this.platformService=S,this.localStorage=T,this._authenticationService=I,this.config=E,this.user=A,this._imageAuthCookieExpiryTsKey="ImageAuthCookieExpiryTime",this._activeAmsRequest={},this._baseImageUrlSubject=new g.X(null),this._isInitialized=!1,this._isImageAuthCookieValidSubject=new g.X(!1),this._imageCookieRetryInterval=2e4,this._imageCookieRetryMaxCount=5,this._isSetupImageCookieInProgress=!1,this.checkImageAuthCookie=()=>{let e=-1;const t=(new Date).getTime()/w,n=this.localStorage&&this.localStorage.get(this._imageAuthCookieExpiryTsKey,l.f.Global)||"-1";e=parseInt(n,10);const i=e>t,a=i?`Image auth cookie has NOT expired. Expiry time stamp: ${e}`:`Image auth cookie has expired. Expiry time stamp: ${e}`;this._logger.log(a),this._isImageAuthCookieValidSubject.next(i),this.startImageAuthCookiePollingTimer(i,e)},this.getRequest=(e,{requestUrl:t,requestBody:n,headers:i,serviceName:a},o)=>this._gtmRegistry.bind(this._send,e)({url:t,headers:i,credentials:"include",method:"POST",body:n,serviceName:a,apiName:o}),this.setupImageAuthCookie=()=>Promise.resolve({constructRequest:()=>{var e,t;return{url:this._isMTMAProfilePicturesEnabled&&(null===(e=this.user)||void 0===e?void 0:e.id)?C.replace("{objectId}",null===(t=this.user)||void 0===t?void 0:t.id):b,method:"POST",headers:{"x-ms-client-caller":"imageAuthCookieSetupEM","x-ms-client-type":(0,p.I)(this.platformService,this.config)},credentials:"include",apiName:"imageAuthCookie"}},allowedResponses:[d.qj.HTTP_2XX],retryPolicy:this.imageCookieRetryPolicy()}),this.setupImageAuthCookieEndpoints=({discover:e,authenticationResources:t})=>({baseUrlPromise:()=>e.regionGtm(s.Pn.middleTier),serviceName:c.EJ.MiddleTier,authResource:t.mtAuthResource,models:{setupImageAuthCookie:this.setupImageAuthCookie()}}),this._logger=i.newLogger("Content Media Auth"),this._send=(0,a.r)((0,o.B)((0,r.S)(e),d.qb.NO_CONTENT,d.qb.OK),(_=this._logger,{shouldRetry:e=>(0,y.o7)(e)||[d.qb.THROTTLED,-1].indexOf(e)>-1,errorHandler:(e,t)=>{const{serverResponse:{status:n}}=e;if(!t.retriesTable[n])throw new Error(`AsyncMediaAuthServiceRetryPolicy: retry count for ${n} is empty`);return _.error(`asyncMediaAuthServiceRetryPolicy: retrying '[${t.retryCount}]' times due to response status - '[${n}]'`),(0,h._)(t.delay.next())},retryMaxTimeMs:k,maxRetryCount:6,createDelay:()=>new f.df(1e3,2,k)})),this._setupImageAuthCookieApi=N.createApi(this.setupImageAuthCookieEndpoints),this._imageCookieRetryInterval=m.get(u.J.People).imageCookieRetryInterval||2e4,this._imageCookieRetryMaxCount=m.get(u.J.People).imageCookieRetryMaxCount||5,this._isMTMAProfilePicturesEnabled=!!m.get(u.J.People).enableProfilePicturesWithObjectId,this._isDeleteImageAuthCookieEnabled=!!m.get(u.J.People).enableDeleteImageAuthCookie,this._isMTMAProfilePicturesEnabled&&(this._imageAuthCookieExpiryTsKey=`${this._imageAuthCookieExpiryTsKey}_${null==A?void 0:A.id}`)}initAsyncMediaAuthService(){if(this._isInitialized)return;this.initBaseImageUrl().catch((()=>{this._logger.error("Error in initCookieImageAuth")}));const{enableAmsCookieValidation:e}=this.coreSettings.get(u.J.Core),{isImageAuthCookiePollingCheckEnabled:t}=this.coreSettings.get(u.J.People),{skipAmsAuthRequest:n,disableTokenCacheReadEvent:i}=this.coreSettings.get(u.J.Auth);e&&t?this.checkImageAuthCookie():n?this._isImageAuthCookieValidSubject.next(!0):(this._discover.validateSkypeToken().catch((()=>{})),this.subscribeToToken(v.ej.SKYPE_KEY),i?this.subscribeToMiddleTierToken():this.subscribeToToken(v.ej.MT_KEY)),this._isInitialized=!0}logout(){var e,t,n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o=c.EJ.Skype;const r=v.ej.MT_KEY,{mtResource:s}=yield this.coreSettings.get(u.J.Auth);if(s&&this._isDeleteImageAuthCookieEnabled&&(null===(e=this.user)||void 0===e?void 0:e.id)&&(null===(t=this._authenticationService)||void 0===t?void 0:t.acquireTokenV2)){const{token:e}=yield null===(n=this._authenticationService)||void 0===n?void 0:n.acquireTokenV2(s),t=null!==(a=N.get(r))&&void 0!==a?a:[],l=this.getHeaders(e,r);i=this._isMTMAProfilePicturesEnabled?"beta/users/{objectId}/deletecookiev2".replace("{objectId}",this.user.id):"beta/imageauth/deletecookie",o=c.EJ.MiddleTier;const{requireSkypetokenForMT:d}=this.coreSettings.get(u.J.Auth);return d&&(l["x-skypetoken"]=yield this._discover.validateSkypeToken()),this._logger.log("queueing request for deleting image auth cookie"),this.queueRequests(t,r,{requestUrl:i,headers:l,requestBody:undefined,serviceName:o},"deleteCookieOnLogout"),this._activeAmsRequest[r][0]}}))}startImageAuthCookiePollingTimer(e,t){this._imageAuthCookiePollingTimerId&&(this._logger.log(`Clearing image auth cookie polling. Timer ID: ${this._imageAuthCookiePollingTimerId}`),this.windowProvider.clearInterval(this._imageAuthCookiePollingTimerId));const n=Math.abs(t*w-(new Date).getTime()),i=e?n:5e3;this._imageAuthCookiePollingTimerId=this.windowProvider.setInterval((()=>this.checkImageAuthCookie()),i);const a=e?`Image auth cookie valid. expiry check timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`:`Image auth cookie NOT valid. polling validity timer started. Timer ID: ${this._imageAuthCookiePollingTimerId}`;e||this._logger.warn(a)}initBaseImageUrl(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=null!==(e=N.get(v.ej.MT_KEY))&&void 0!==e?e:[],n=yield this.getBaseUrl(t[0]);n&&this._baseImageUrlSubject.next(n)}))}getBaseUrl(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this._discover.regionGtm(e);return t||this._logger.error("baseImageUrl is undefined"),t}catch(t){const n=`Fetching baseImageUrl failed from regionGTM, passed gtm: ${e.length}, errorCode: ${null==t?void 0:t.code}, errorContext: ${null==t?void 0:t.context}, errorMessage: ${null==t?void 0:t.message}`,i=(0,S.A)(n);return this._logger.errorToTelemetry?this._logger.errorToTelemetry(i,"async_media_auth_service",void 0,!0):this._logger.error(n),Promise.reject(t)}}))}subscribeToToken(e){var t;e===v.ej.SKYPE_KEY&&this._discover.observeSkypeToken().subscribe((e=>this.persistTokenToAMS(e,v.ej.SKYPE_KEY))),e===v.ej.MT_KEY&&(null===(t=this._authenticationService)||void 0===t||t.observeMiddleTierToken().subscribe((e=>this.persistTokenToAMS(e,v.ej.MT_KEY))))}getHeaders(e,t){const n={},i=(0,m.v4)();return n.Authorization=`${t===v.ej.SKYPE_KEY?"skype_token":"Bearer"} ${e}`,n["Content-Type"]="application/x-www-form-urlencoded",n.RequestId=i,n.CorrelationId=i,n.TransactionId=i,n["x-ms-client-type"]=(0,p.I)(this.platformService,this.config),n}persistTokenToAMS(e,t){var n,a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i,o,r,s=c.EJ.Skype;const l=null!==(n=N.get(t))&&void 0!==n?n:[],d=this.getHeaders(e,t);if(!e)return Promise.resolve(null);if(this._activeAmsRequest[t])return this._activeAmsRequest[t];switch(this._logger.log("persistTokenToAMS: received new token"),t){case v.ej.SKYPE_KEY:i=`skypetoken=${e}`,o="v1/skypetokenauth",s=c.EJ.Skype;break;case v.ej.MT_KEY:o=this._isMTMAProfilePicturesEnabled&&(null===(a=this.user)||void 0===a?void 0:a.id)?C.replace("{objectId}",this.user.id):b,s=c.EJ.MiddleTier,r=yield this.getBaseUrl(l[0]);const{requireSkypetokenForMT:t}=this.coreSettings.get(u.J.Auth);t&&(d["x-skypetoken"]=yield this._discover.validateSkypeToken())}return this._logger.log(`persistTokenToAMS: queueing request for ${t}`),this.queueRequests(l,t,{requestUrl:o,headers:d,requestBody:i,serviceName:s},"persistTokenToAMS"),Promise.all(this._activeAmsRequest[t]).then((()=>{this._activeAmsRequest[t]=void 0,t===v.ej.MT_KEY&&(this._isImageAuthCookieValidSubject.next(!0),r?this._baseImageUrlSubject.next(r):this._logger.error("baseImageUrl is undefined"))})).catch((e=>{this._logger.error(`Unable to persist skype token to AMS. ${e}`),this._activeAmsRequest[t]=void 0})),this._activeAmsRequest[t]}))}queueRequests(e,t,n,i){this._activeAmsRequest[t]=[],e.map((e=>{this._activeAmsRequest[t].push(this.getRequest(e,n,i))}))}subscribeToMiddleTierToken(){var e;null===(e=this._authenticationService)||void 0===e||e.observeMiddleTierToken().subscribe((e=>{if(e||this.isImageCookieExpired()){const t=e?"token changed":"cookie expired";this._logger.log(`Set up image auth cookie due to: ${t}`),this.setupImageAuthCookieAndExpiry()}else this._isImageAuthCookieValidSubject.next(!0)}))}setupImageAuthCookieAndExpiry(){var e,t,n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this._isSetupImageCookieInProgress){this._isSetupImageCookieInProgress=!0,this._logger.log("Setting up image auth cookie");try{yield this._setupImageAuthCookieApi.setupImageAuthCookie(),this._isImageAuthCookieValidSubject.next(!0);const{mtResource:i}=yield this.coreSettings.get(u.J.Auth);if(i&&(null===(e=this._authenticationService)||void 0===e?void 0:e.acquireTokenV2)){const e=yield null===(t=this._authenticationService)||void 0===t?void 0:t.acquireTokenV2(i);null===(n=this.localStorage)||void 0===n||n.set(this._imageAuthCookieExpiryTsKey,`${null==e?void 0:e.expires}`,l.f.Global),this._logger.log(`Successfully set up image auth cookie expiry ${null==e?void 0:e.expires}`)}}catch(e){this._logger.error(`setupImageAuthCookieAndExpiry error ${e}`)}finally{this._isSetupImageCookieInProgress=!1}}}))}isImageCookieExpired(){var e;const t=Math.round(Date.now()/w),n=(null===(e=this.localStorage)||void 0===e?void 0:e.get(this._imageAuthCookieExpiryTsKey,l.f.Global))||"-1";return parseInt(n,10)<t}imageCookieRetryPolicy(){return{shouldRetry:(e,t,n)=>{if(t>=d.qb.OK&&t<=d.qb.NOT_MODIFIED)return!1;const i=e<this._imageCookieRetryMaxCount&&t!==d.qb.BAD_REQUEST&&t!==d.qb.NOT_AUTHORIZED;return this._logger.warn(`imageCookieRetryPolicy retry count ${e} responseCode ${t} canRetry ${i}`),i},nextDelay:e=>this._imageCookieRetryInterval*Math.pow(2,e)}}get baseImageUrlObservable(){return this._baseImageUrlSubject.asObservable()}get isImageAuthCookieValidObservable(){return this._isImageAuthCookieValidSubject.asObservable()}}},764378:(e,t,n)=>{"use strict";var i;n.d(t,{p:()=>i}),function(e){e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.Fluid="application/vnd.microsoft.card.fluid",e.FluidEmbed="application/vnd.microsoft.card.fluidEmbedCard"}(i||(i={}))},82132:(e,t,n)=>{"use strict";n.d(t,{i:()=>p,O:()=>v});var i=n(231191),a=n(892891),o=n(118824),r=n(113491),s=n(827957),l=n(265351),d=n(503266),c=n(889705),u=n(764378),m=n(628235),g=n(525965);const p="~~~~###@@TACOCAT@@###~~~~";let v=class{transform(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t.messageProperties)return;this._logger=t.loggerFactory.newLogger("CodeSnippetsSerializer"),this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;const n=(0,a.unescape)(l.N.DomUtils.getAttributeValue(e,r.Qq)),i=l.N.DomUtils.getAttributeValue(e,r.fK),[o]=l.N.DomUtils.getElementsByTagName("code",e);if(!n)return this._logger.error("The props was missing"),null;if(!o)return this._logger.error("The code snippet was missing"),null;if(!i)return this._logger.error("The id of the card was missing"),null;try{yield this._uploadAndUpdateCard(i,JSON.parse(n),o,t);const e=(0,d.ln)("span",{content:i,itemprop:"cardId"}),a=(0,d.ln)("span",{class:"inline-compose-card",itemid:i,itemscope:"",itemtype:c.T.inputExtension});return l.N.DomUtils.appendChild(a,e),this._logger.debug("Uploaded code snippet",i),a}catch(e){return this._logger.error("Failed to upload the code snippet!"),null}}))}_uploadCodeSnippet(e,t,n){var a;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{source:i}=e,r=l.N.DomUtils.getInnerHTML(t),s=`${i}${p}${r}`,d=null===(a=this._scenarioFactory)||void 0===a?void 0:a.newScenario(m.RG.CodeSnippetUpload);try{const{objectId:e}=yield this._uploadToAMS(s,n,this._logger);return null==d||d.stop(),{objectId:e,uploadType:"AMS"}}catch(e){this._logger.error("_uploadCodeSnippet: code snippet upload to ams failed!"),null==d||d.fail();const{enableCacheStorageInSendMessageMW:t}=this._settings.get(o.J.Messaging);if(t){this._logger.debug("Trying to upload code snippet to cache storage");const{objectId:e}=yield this._uploadToCache(s,n,this._logger);return{objectId:e,uploadType:"OfflineCache"}}throw this._logger.debug("_uploadCodeSnippet: enableCacheStorageInSendMessageMW is not enabled!"),e}finally{null==d||d.stop()}}))}_uploadToAMS(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){n.log("Uploading to code snippet to ams");const{objectId:i}=yield t.asyncMediaService.uploadItem(e,t.conversationId,"DOCUMENT",g.r1.Attached);return{objectId:i}}))}_uploadToCache(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{n.log("uploading inline image to offline cache storage");const[i,a]=yield t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":"text/html","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.length}`,Date:(new Date).toUTCString()})}));return n.log(`Uploaded image to offline cache, image: ${a} objectId: ${i}`),{objectId:i}}catch(e){throw n.error("_uploadToCache: uploading inline image to offline cache store failed!"),e}}))}_uploadAndUpdateCard(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{amsReferenceId:i}=t,{name:o,language:r,wrap:s}=t,l=a.messageProperties.cards||[];let d={objectId:i,uploadType:"AMS"};if(i||(d=yield this._uploadCodeSnippet(t,n,a)),"AMS"===d.uploadType){const e=a.messageProperties.amsReferences||[];a.messageProperties.amsReferences=[...e,d.objectId]}else if("OfflineCache"===d.uploadType){const e=a.messageProperties.offlineAssets||[];a.messageProperties.offlineAssets=[...e,d.objectId]}a.messageProperties.cards=[...l.filter((t=>t.cardClientId!==e)),{appId:e,cardClientId:e,contentType:u.p.CodeSnippet,content:JSON.stringify({type:u.p.CodeSnippet,editable:!0,id:e,name:o,language:r,wrap:s,lines:n.children?n.children.length:0,cardClientId:e,amsReferenceId:d.objectId})}],a.telemetryDatabag["DataBag.codeSnippets"]=(a.telemetryDatabag["DataBag.codeSnippets"]||0)+1}))}};v=(0,i.__decorate)([(0,s.HR)({name:"CodeSnippets",filter:{[r.$S]:"CodeSnippetCard"}})],v)},275028:(e,t,n)=>{"use strict";n.d(t,{D:()=>g});var i=n(231191),a=n(827957),o=n(889705),r=n(169728),s=n(265351),l=n(892891);const d=new RegExp(/animated-emoticon.*?/),c=/img|table/,u=e=>!!e&&(s.N.DomUtils.getAttributeValue(e,"itemtype")===o.T.emoji||d.test(s.N.DomUtils.getAttributeValue(e,"class")||"")||(0,r.x)(e)),m=3;let g=class{preTransform(e,t){const n=(0,l.isUndefined)(t.superSizeEmoticons)?0:t.superSizeEmoticons;var i;"br"===e.name?t.containsPotentiallyIncludedWhitespace=!0:(0,l.isNumber)(n)&&(t.superSizeEmoticons=u(e)?(i=n,!t.containsPotentiallyIncludedWhitespace&&i<m&&i+1):!(e=>e&&!u(e.parent)&&!(e.parent&&u(e.parent.parent))&&(c.test(e.name||"")||!(!e.data||!e.data.replace("","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim())))(e)&&n)}};g=(0,i.__decorate)([(0,a.wx)({name:"BigEmoticonPreprocessor",filter:"*"})],g)},639763:(e,t,n)=>{"use strict";n.d(t,{D:()=>$e,fh:()=>We,Vf:()=>He,bl:()=>Ve});var i=n(231191),a=n(827957),o=n(265351),r=n(582463),s=n(889705),l=n(892891),d=n(215235),c=n(78946),u=n(870003);const m=e=>{e&&o.N.DomUtils.hasAttrib(e,r.zj.type)&&delete e.attribs[r.zj.type]};var g=n(162948),p=n(118824),v=n(366785),h=n(395816);const f={fileDetailsPromiseResolved:"file_deatails_promise_resolved"};var y=n(628235);let k=class{constructor(){this._allowAsyncChicletCreation=!1,this._asyncLinkConversionDetailsByItemId=new Map,this._loggerCb=l.noop,this._timeout=0}preTransform(e,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t||!o.N.DomUtils.hasAttrib(e,"href"))return;this._setupConstants(t);const i=e.attribs[r.zj.itemid];if(i){if(this._allowAsyncChicletCreation&&o.N.DomUtils.hasAttrib(e,r.zj.type)&&e.attribs[r.zj.type]===u.le.asyncLinkToChicletConversionIdentifier){const a=(0,l.unescape)(e.attribs.href),{fileReferenceService:o}=t,r=o.parseFileLabelFromUrl(a);if(!r)return void m(e);const s=null===(n=this._scenarioFactory)||void 0===n?void 0:n.newScenario(y.RG.AsyncLinkToChiclet),c=this._asyncLinkConversionDetailsByItemId.get(i);if(c)return void F(c,a,s,(e=>this._asyncLinkConversionDetailsByItemId.set(i,e)));try{const e=(0,d.E)(o.getFileDetails(r,"chat",["fluid"]),this._timeout,"file details call timed out");this._asyncLinkConversionDetailsByItemId.set(i,{fileDetailsPromise:e,scenario:s,linkInfo:{href:a,count:1}})}catch(t){const n=(null==t?void 0:t.message)||"";return D(e,s,n)}}return e}}))}transform(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!(e&&o.N.DomUtils.hasAttrib(e,"href")&&t&&t.files&&t.messageProperties&&t.existingLinks))return;const n=e.attribs[r.zj.itemid];if(!n)return;const i=this._asyncLinkConversionDetailsByItemId.get(n);if(i){const{scenario:n}=i;try{const a=yield b(t,e,i);return n&&n.stop(),a}catch(t){return m(e),void(0,g.V)(t,this._loggerCb,n)}}if(!o.N.DomUtils.hasAttrib(e,r.zj.itemProps))return _(e,t);const{files:a}=t;try{const i=A(a,e);if(!i)return;const{shareUrl:o,title:r}=i;o&&(e.attribs.href=o),w(e,r,o),C(i,n,t)}catch(e){return}return e}))}_setupConstants({coreSettings:e,loggerFactory:t,scenarioFactory:n}){this._loggerCb=S(t.newLogger("SharepointLinkSerializer")),this._scenarioFactory=n;const{enableFilesAsyncChicletCreationInMultiWindow:i,asyncChicletCreationTimeout:a}=e.get(p.J.Files);this._allowAsyncChicletCreation=!!i,this._timeout=a||3e3}};k=(0,i.__decorate)([(0,a.HR)({name:"SharepointLinkSerializer",filter:"a"})],k);const S=e=>t=>{e.error(t)},b=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{fileDetailsPromise:i,scenario:a}=n,o=yield i;return a&&a.mark(f.fileDetailsPromiseResolved),C(o,o.fileId,e),((e,t)=>{const{files:n}=t;return-1!==n.findIndex((t=>t.id===e.fileId))})(o,e)||E(e,(({objectUrl:e,shareUrl:t,type:n,fileId:i,title:a,baseUrl:o,shareId:r,fileSourceDetail:s})=>{const l=(0,v.gD)(e),{permissionScope:d}=s||{permissionScope:""};return{id:i,baseUrl:o,objectUrl:e,shareUrl:t,shareId:r,type:n,title:a,permissionScope:d,state:h.cj1.reference,isReferencedFile:!0,serviceName:h.a4b.p2p,previewUrl:"",chicletBreadcrumbs:{sourceChannelName:(null==l?void 0:l.sourceChannelName)||null,sourceTeamName:(null==l?void 0:l.sourceTeamName)||null},previewHeight:null,previewWidth:null,progressComplete:null,hasUploadFailed:!1}})(o)),m(t),t})),C=(e,t,n)=>{const{objectUrl:i,shareUrl:a,title:o,type:r}=e,s=T({objectUrl:i,shareUrl:a,itemid:t,type:r,title:o});I(n,s)},w=(e,t,n)=>{e.children&&N(t,e,n)},N=(e,t,n)=>{const i=[t];for(;0!==i.length;){const a=i.pop();if(a&&a.children)for(const o of a.children){if("text"===o.type&&(0,l.startsWith)(o.data,"https"))return o.data=e,t.attribs&&(t.attribs.title=n),!0;i.push(o)}}return!1},T=({objectUrl:e,shareUrl:t,itemid:n,type:i,title:a})=>({title:a,objectUrl:e,description:"",fileShareUrlMeta:{id:n,objectUrl:e,type:i,shareUrl:t}}),I=(e,t)=>{e.messageProperties.embeddedLinks=[...e.messageProperties.embeddedLinks||[],t],e.telemetryDatabag["DataBag.links"]=(e.telemetryDatabag["DataBag.links"]||0)+1},E=(e,t)=>{e.files.push(t)},A=(e,t)=>{const n=t.attribs[r.zj.itemid],i=e.find((e=>e.id===n));if(i){const{shareUrl:e,title:t,objectUrl:n,type:a}=i;return{shareUrl:e||"",title:t||"",type:a||"",objectUrl:n||""}}if(t.attribs[r.zj.itemtype]===s.T.filesHyperlink){const e=t.attribs[r.zj.itemProps];if(e){const t=(0,l.unescape)((0,l.unescape)(e)),n=JSON.parse(t),{type:i,objectUrl:a,shareUrl:o,title:r}=n;return{shareUrl:o,title:r,objectUrl:a,type:i}}}},_=(e,t)=>{if(o.N.DomUtils.hasAttrib(e,"href")){const n=e.attribs.href||"",i=t.existingLinks.filter((e=>{var t;return(null===(t=e.fileShareUrlMeta)||void 0===t?void 0:t.shareUrl)===n}));if(i&&i.length&&i[0].fileShareUrlMeta)return I(t,(0,c.i)(i[0],"__typename")),e}},D=(e,t,n)=>{m(e),null==t||t.fail({errorCode:u.le.telemetry.errorCodes.asyncLinkConversionPretransformFailure,errors:JSON.stringify(n)})},F=(e,t,n,i)=>{const{linkInfo:a}=e;let o="";if(a&&t===a.href){const{count:n}=a;o=`Duplicate links: ${n}`,i(Object.assign(Object.assign({},e),{linkInfo:{href:t,count:n+1}}))}else o="Different href for same itemid";null==n||n.incomplete({errorCode:u.le.telemetry.errorCodes.asyncLinkMultiplePretransform,errors:o})};var M=n(230570),R=n(503266),P=n(907207),O=n(870209);let x=class{constructor(){this._removeExtraSpacesInMention=e=>{var t;null===(t=e.parent)||void 0===t||t.children.forEach((e=>{"text"===e.type&&" "===e.data&&o.N.DomUtils.removeElement(e)}))},this._getMentionKey=e=>{var t,n,i;const a=null===(n=null===(t=e.children)||void 0===t?void 0:t[0])||void 0===n?void 0:n.data;return`${null===(i=e.attribs)||void 0===i?void 0:i[r.zj.mri]}_${a}`},this._mergeMentions=(e,t)=>{if(!e.attribs)return;const n=e.attribs[r.zj.mri]||"";let i=this._getNextContigousMention(e,n);for(;e.children&&e.children.length>0&&i;){const a=i.children;if(a&&a.length>0&&a[0].data){const n=this._getMentionKey(i),o=t.get(n);o?t.set(n,o+1):t.set(n,1),e.children[0].data+=` ${a[0].data}`}i=this._getNextContigousMention(i,n)}},this._getNextContigousMention=(e,t)=>{var n;if(!e||!e.next)return null;const i=e.next,a=t===(null===(n=null==i?void 0:i.attribs)||void 0===n?void 0:n[r.zj.mri]);return" "===i.data||a?i:null}}transform(e,t){var n;if(!(e&&t&&t.messageProperties&&o.N.DomUtils.hasAttrib(e,r.zj.mri)))return;t.seenMentions||(t.seenMentions=new Map);const i=this._getMentionKey(e),a=t.seenMentions.get(i);if(a)return 1===a?t.seenMentions.delete(i):t.seenMentions.set(i,a-1),null;this._mergeMentions(e,t.seenMentions);const{messageProperties:d,telemetryDatabag:c}=t;d.mentions||(d.mentions=[]);const u=`${d.mentions.length}`,m=(0,R.Q)(e),g=(null===(n=null==e?void 0:e.attribs)||void 0===n?void 0:n[r.zj.type])||(L(e)?"bot":"person");c["DataBag.atmentions"]=(c["DataBag.atmentions"]||0)+1;const p=(0,R.ln)(M.s.span),v=(0,R.rw)((0,l.escape)(m)),h=o.N.DomUtils.hasAttrib(e,r.zj.stale),f=o.N.DomUtils.getAttributeValue(e,r.zj.mri)||"";return o.N.DomUtils.appendChild(p,v),h||(d.mentions.push({itemId:u,displayName:m,userId:f,mentionType:g}),"webhook"===g&&d.mentions.push({itemId:u,displayName:m,userId:P.BB.InterceptorBotMris[0],mentionType:"person"}),p.attribs[r.zj.itemtype]=s.T.mention,p.attribs[r.zj.itemscope]="",p.attribs[r.zj.itemid]=u),this._removeExtraSpacesInMention(e),p}};x=(0,i.__decorate)([(0,a.wx)({name:"AtMentionSerializer",filter:"mention"})],x);const L=e=>{var t;return(0,O.bl)((null===(t=null==e?void 0:e.attribs)||void 0===t?void 0:t[r.zj.mri])||"")};let U=class{transform(e,t){if(!e.attribs)return void t.logger.error("image attribs is missing");const n=o.N.DomUtils.getAttributeValue(e,r.zj.cacheKey);if(n&&n.length)return e.attribs["data-cke-saved-src"]=void 0,e.attribs.src=t.offlineCacheManager.getCachedUrlByKey(n),e;t.logger.error("image missing cache key")}};U=(0,i.__decorate)([(0,a.wx)({name:"CachedImageSerializer",filter:[{itemtype:s.T.cachedImage}]})],U);let B=class{preTransform(e){return null}};B=(0,i.__decorate)([(0,a.wx)({name:"RemoveHiddenSelectionSerializer",filter:["data-cke-hidden-sel"]})],B);var j=n(113491);let W=class{transform(e){if(e.data&&j.Eh.test(e.data))return e.data=e.data.replace(new RegExp(j.Eh,"g"),""),e}};W=(0,i.__decorate)([(0,a.wx)({name:"RemoveZwsSerializer",filter:"text",transient:!0})],W);const V="data-only-whitespace",H=/^(\s|[\u200B-\u200D\uFEFF])*$/;let $=class{preTransform(e,t){return z(e)?void(t.whiteSpaceId&&t.whiteSpaceId++):(t.whiteSpaceId||(t.whiteSpaceId=1),e.attribs||(e.attribs={}),e.attribs[V]=`${t.whiteSpaceId+1}`,e)}};$=(0,i.__decorate)([(0,a.wx)({name:"WhiteSpacePreprocessor",filter:["div","p","br","span","text"],transient:!0})],$);const z=e=>!H.test((0,R.Q)(e))||!!o.N.DomUtils.findOne((e=>{if(e.attribs&&Object.keys(e.attribs).length||!e.name)return!0;switch(e.name.toLowerCase()){case"br":case"div":case"p":case"span":break;default:return!0}return!1}),[e]);let G=class{transform(e,t){const n=o.N.DomUtils.getAttributeValue(e,V);return!t.whiteSpaceId||!n||+n>t.whiteSpaceId?null:(e.attribs&&delete e.attribs[V],e)}};G=(0,i.__decorate)([(0,a.wx)({name:"TrailingWhiteSpaceSerializer",filter:[V],transient:!0})],G);var q=n(82132),Q=n(275028),J=n(301210);let Y=class{transform(e,t){const n=`${!!t.superSizeEmoticons?j.G4:j.Mw}px`;return e.attribs||(e.attribs={}),e.attribs.height=n,e.attribs.width=n,(0,R.A_)(e,{"max-height":n,"max-width":n,height:n,width:n}),e}};Y=(0,i.__decorate)([(0,a.wx)({name:"EmojiOneSerializer",filter:{class:new RegExp(J.Uu)}})],Y);var K=n(342131);let Z=class{transform(e,t){const n=t.superSizeEmoticons?"large":"small",i=(0,K.cn)(n),a=t=>o.N.DomUtils.getAttributeValue(e,t)||"",r=a("itemid");t.telemetryDatabag&&(t.telemetryDatabag["DataBag.emojiList"]=[...t.telemetryDatabag["DataBag.emojiList"]||[],`Skype.${r}`],t.telemetryDatabag["DataBag.emoji"]=t.telemetryDatabag["DataBag.emojiList"].length);const l=(0,R.ln)("span",{contenteditable:"false",title:a("title"),type:`(${r})`,class:`animated-emoticon-${i}-${r}`}),d=a("alt")||a("itemscope"),c=(0,R.ln)("img",{itemscope:"",itemtype:s.T.emoji,itemid:r,src:(0,K.rO)(r,n,t.coreSettings.get(p.J.Messaging),!1),title:a("title"),alt:d,style:`width:${i}px;height:${i}px;`});return o.N.DomUtils.appendChild(l,c),l}};Z=(0,i.__decorate)([(0,a.wx)({name:"EmoticonSerializer",filter:{itemtype:s.T.emoji}})],Z);let X=class{transform(e){return o.N.DomUtils.getAttributeValue(e,r.zj.itemProps)&&delete e.attribs[r.zj.itemProps],e}};X=(0,i.__decorate)([(0,a.wx)({name:"FluidEmbedSerializer",filter:{itemtype:s.T.fluidEmbedLink}})],X);var ee=n(46522),te=n(764378);let ne=class{transform(e,t){const n=o.N.DomUtils.getAttributeValue(e,"href");if(!n||!e.attribs)return;const i=n.replace(/&amp;/g,"&");o.N.DomUtils.getAttributeValue(e,r.zj.itemProps)&&delete e.attribs[r.zj.itemProps];const a={appId:"fluid-card",cardClientId:(0,ee.Z)(),contentType:te.p.Fluid,content:JSON.stringify({componentUrl:i})};return t.messageProperties.cards=[a],t.files=void 0,e}};ne=(0,i.__decorate)([(0,a.wx)({name:"FluidSerializer",filter:{itemtype:s.T.fluidLink}})],ne);var ie=n(661564),ae=n(525965),oe=n(397754),re=n(731793),se=n(220496);let le=class{constructor(){this.getImageBlobUrlFromCache=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.offlineCacheManager.get(t),i=yield n.blob();return URL.createObjectURL(i)})),this.processCachedImage=(e,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var n;const i=o.N.DomUtils.getAttributeValue(e,r.zj.cacheKey);if(!i)return void this._logger.error("Cached image missing key attribute.");this._logger.log(`processing cached image: ${i}`);const a=null===(n=this._scenarioFactory)||void 0===n?void 0:n.newScenario(y.RG.SerializeCachedImage);try{const n=o.N.DomUtils.getAttributeValue(e,"src"),s=!!(null==n?void 0:n.startsWith("blob"));let l;try{const e=yield t.offlineCacheManager.get(i);l=yield null==e?void 0:e.blob()}catch(e){l=null,this._logger.warn(`processCachedImage: Could not find cached image with key=${i} in offlineCacheManager`)}if(!l&&s&&n&&(l=yield(0,se.Hk)(n)),null===l)throw Error("Could not get image Blob neither from cache nor from blob data");null==a||a.mark(y.ck.SerializeCachedImageGotData);const d=yield this.uploadImage(l,t);if(de(e,d,t),null==a||a.mark(y.ck.SerializeCachedImageUploadedData),"OfflineCache"!==d.uploadType){const n=yield t.offlineCacheManager.delete(i);null==a||a.mark(y.ck.SerializeCachedImageDeletedEntry,void 0,n?"success":"failure"),n||this._logger.warn(`Failed to delete cached image with key: ${i}`),e.attribs&&delete e.attribs[r.zj.cacheKey]}}catch(e){throw this._logger.error(`processCachedImage: Failed to process cached image with key=${i}`),null==a||a.fail(),e}finally{null==a||a.stop()}return e}))}transform(e,t){if(this._logger=t.loggerFactory.newLogger("InlineImageSerializer"),!this.isConfigValid(t))return this._logger.error("invalid config"),Promise.resolve(void 0);this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;let n=o.N.DomUtils.getAttributeValue(e,"src");const{enableImprovedImageHandling:i,enableComposeFrameworkV2:a,enableImageBlobConversionForMessageEdit:l}=this._settings.get(p.J.Messaging);if((i||l)&&a&&(n=o.N.DomUtils.getAttributeValue(e,"data-orig-src")||n),!n)return this._logger.error("image src is missing"),Promise.resolve(void 0);const d=(0,oe.KD)(n);if(d)return this.handleAmsSourceTag(d,e,t);return o.N.DomUtils.getAttributeValue(e,r.zj.itemtype)===s.T.cachedImage?this.processCachedImage(e,t):n.startsWith("http://")||n.startsWith("https://")?(0,re.kf)(n)?this.processKnownImage(n,t.telemetryDatabag):this.handleKnownProtcolSourceTag(n,"HttpUrl",e,t):n.startsWith("blob:")?this.handleKnownProtcolSourceTag(n,"BlobUrl",e,t):(this._logger.error("Unsupported image! deleting it."),Promise.resolve(null))}handleAmsSourceTag(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i="AMS",a=yield n.asyncMediaService.forwardContent(e,n.conversationId);return this._logger.log(`forwarded ams image ${e} to ${a.objectId}`),n.messageProperties.amsReferences=[...n.messageProperties.amsReferences||[],a.objectId],de(t,Object.assign(Object.assign({},a),{uploadType:i}),n),t}catch(e){throw this._logger.error("handleAmsSourceTag: forward content failed!"),e}}))}handleKnownProtcolSourceTag(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield ce(e,t,a),o=yield this.uploadImage(i,a);return de(n,o,a),n}catch(e){throw this._logger.error("handleKnownProtcolSourceTag: pasted from web image upload failed"),this.addDiagnosticCodeToError(e),e}}))}uploadImage(e,t,n=!1){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.uploadImageToAms(e,t,this._logger)}catch(i){this._logger.error("uploadImage: image upload to AMS failed!");const{enableCacheStorageInSendMessageMW:a,msgEnableRestrictImagePasting:o}=this._settings.get(p.J.Messaging);if(!a||o||n)throw i;this._logger.debug("Trying to upload inline image to cache storage");return yield this.uploadToCache(e,t,this._logger)}}))}uploadImageToAms(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=t.asyncMediaService.createAmsScenario(y.RG.AmsImageUpload);try{const a="AMS",o=yield t.asyncMediaService.uploadItem(e,t.conversationId,"IMAGE","MicrosoftTeams-image.png",ae.r1.Inline);return n.log(`Uploaded image to ams, image: ${o.inlineSizeUrl} objectId: ${o.objectId}`),i.stop(),t.messageProperties.amsReferences=[...t.messageProperties.amsReferences||[],o.objectId],Object.assign(Object.assign({},o),{uploadType:a})}catch(e){throw i.fail({errors:e.message}),n.error("Ams image upload failed!"),e}}))}uploadToCache(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{n.log("uploading inline image to offline cache storage");const[i,a]=yield t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":e.type,"Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.size}`,Date:(new Date).toUTCString()})}));n.log(`Uploaded image to offline cache, image: ${a} objectId: ${i}`);const o="OfflineCache";t.messageProperties.offlineAssets=[...t.messageProperties.offlineAssets||[],i];return{objectId:i,inlineSizeUrl:yield this.getImageBlobUrlFromCache(t,i),uploadType:o}}catch(e){throw n.error("uploadToCache: uploading inline image to offline cache store failed!"),e}}))}isConfigValid(e){return!!(e&&e.asyncMediaService&&e.messageProperties&&e.imageProxyService&&e.conversationId&&e.telemetryDatabag&&e.offlineCacheManager)}processKnownImage(e,t){return e.endsWith(".gif")&&(t["DataBag.giphy"]=(t["DataBag.giphy"]||0)+1),Promise.resolve(void 0)}addDiagnosticCodeToError(e){if(e.serverResponse&&e.serverResponse.status){switch(e.serverResponse.status){case ie.qb.UNSUPPORTED_MEDIA_TYPE:e.reason=Object.assign(Object.assign({},e.reason),{errorCode:oe.hA.IMAGE_SIZE_TOO_LARGE})}}}};le=(0,i.__decorate)([(0,a.HR)({name:"InlineImageSerializer",filter:["img","image"]})],le);const de=(e,t,n)=>{e.attribs||(e.attribs={}),e.attribs.id=t.objectId,e.attribs.itemid=t.objectId,e.attribs.href=t.inlineSizeUrl,e.attribs["target-src"]=t.inlineSizeUrl,e.attribs.src=t.inlineSizeUrl,e.attribs[r.zj.itemtype]="AMS"===t.uploadType?s.T.amsImage:s.T.cachedImage,n.telemetryDatabag["DataBag.inlineImages"]=(n.telemetryDatabag["DataBag.inlineImages"]||0)+1},ce=(e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let i=null;return"BlobUrl"===t?i=yield(0,se.Hk)(e):"HttpUrl"===t&&(i=yield n.imageProxyService.getImageAsBlob(e)),i}));var ue=n(70404),me=n(29410),ge=n(204386),pe=n(465759);let ve=class{transform(e,t){var n,a,o,r;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this._logger=t.loggerFactory.newLogger("InlineVideoSerializer");const i=t.scenarioFactory.newScenario(y.RG.InlineVideoAsyncTransform),{conversationId:s,videoMessageLieUpdater:l}=t;if(!(e&&e.attribs&&0!==Object.keys(e.attribs).length&&t.asyncMediaService&&t.offlineCacheManager&&l))return i.fail({errorCode:"unexpected_precondition"}),void(null===(a=(n=this._logger).errorToTelemetry)||void 0===a||a.call(n,`unexpected precondition : element - ${e}`,"messaging_inline_video_serializer_error_tracking",void 0,!0));this._offlineCacheManager=t.offlineCacheManager,this._asyncMediaService=t.asyncMediaService;const d=he(e);if(!d)return i.fail({errorCode:"malformed_video_message"}),void(null===(r=(o=this._logger).errorToTelemetry)||void 0===r||r.call(o,`malformed video message: element - ${e}, additionalData - ${t}`,"messaging_inline_video_serializer_error_tracking",void 0,!0));i.appendEventData({correlationId:d.cacheKey});const c=yield this.resolveAMSItem(i,s,l,d),u=t.scenarioFactory.newScenario(y.RG.VideoMessageThumbnailUpload);u.appendEventData({correlationId:d.cacheKey}),yield this.bestEffortUploadAMSVideoThumbnail(u,c,l,d),u.stop(),yield this.uploadAMSVideo(i,c,l,d),t.messageProperties.amsReferences=[...t.messageProperties.amsReferences||[],c];const m=this.createVideoMessageTag(e.attribs,d.src);return this.bestEffortCleanOfflineCacheManager(i,d.cacheKey,!!d.thumbnailUploadProgress),i.stop(),m}))}createVideoMessageTag(e,t){const n=(0,R.ln)("video",{src:t,itemscope:"",itemtype:s.T.amsVideo,"data-duration":e[r.zj.duration],width:e[r.zj.width],height:e[r.zj.height]});return n.children=[(0,R.rw)(me.R2)],n}resolveAMSItem(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield this.createAMSObjectIfRequired(e,t,n,a.cacheKey,a.src);return a.src=i.src,i.objectId}catch(t){throw e.fail({errorCode:"create_ams_object_failed"}),new Error(`create ams object failed:${t.toString()}`)}}))}createAMSObjectIfRequired(e,t,n,a,o){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!o){e.mark(y.ck.ItemCreationStart);const i=yield this._asyncMediaService.createVideoObject(t,a),o=(0,me.$N)(i.amsUrl,i.objectId);return this.bestEffortMessageLieUpdate(e,n,a,r.zj.src,o),e.mark(y.ck.ItemCreationStop),Object.assign(Object.assign({},i),{src:o})}e.mark(y.ck.UploadRetry);return{objectId:(0,oe.KD)(o),amsUrl:(0,ue.DW)(o),src:o}}))}bestEffortUploadAMSVideoThumbnail(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(a.thumbnailUploadProgress&&a.thumbnailUploadProgress.progress!==a.thumbnailUploadProgress.total)try{const i=yield this.uploadAMSVideoThumbnail(e,t,n,a.cacheKey);a.thumbnailUploadProgress=i}catch(t){this._logger.warn("video thumbnail upload failed",t),e.fail({errorCode:"thumbnail_upload_failed"})}}))}uploadAMSVideoThumbnail(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){e.mark(y.ck.ThumbnailUploadStart);const i=yield this._offlineCacheManager.get((0,ge.cQ)(a)),o=yield i.blob();yield this._asyncMediaService.uploadVideoThumbnail(t,o,a);const s={progress:o.size,total:o.size};return this.bestEffortMessageLieUpdate(e,n,a,r.zj.thumbnailUploadProgress,(0,me.tl)(s.progress,s.total)),e.mark(y.ck.ThumbnailUploadStop),s}))}uploadAMSVideo(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{e.mark(y.ck.VideoUploadStart);const i=yield this._offlineCacheManager.get((0,ge.If)(a.cacheKey)),o=yield i.blob();yield this._asyncMediaService.uploadVideo(t,a.uploadProgress.progress,o,this.updateMessageLieVideoUploadProgress(e,n,a),a.cacheKey),e.mark(y.ck.VideoUploadStop)}catch(t){throw e.fail({errorCode:"video_upload_failed"}),new Error(`video upload failed:${t.toString()}`)}}))}bestEffortCleanOfflineCacheManager(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{yield this._offlineCacheManager.delete((0,ge.If)(t))}catch(t){this._logger.warn("video cache cleanup failed",t),e.mark(y.ck.VideoCacheCleanFailed)}try{n&&(yield this._offlineCacheManager.delete((0,ge.cQ)(t)))}catch(t){this._logger.warn("thumbnail cache cleanup failed",t),e.mark(y.ck.ThumbnailCacheCleanFailed)}}))}updateMessageLieVideoUploadProgress(e,t,n){return i=>{const a=i+1;n.uploadProgress.progress=a,this.bestEffortMessageLieUpdate(e,t,n.cacheKey,r.zj.uploadProgress,(0,me.tl)(n.uploadProgress.progress,n.uploadProgress.total))}}bestEffortMessageLieUpdate(e,t,n,i,a){try{t(n,i,a)}catch(t){e.mark(y.ck.MessageLieUpdateFailed),this._logger.warn(t.toString())}}};ve=(0,i.__decorate)([(0,a.HR)({name:"InlineVideo",filter:[{itemtype:s.T.amsVideo}]})],ve);const he=e=>{const t=o.N.DomUtils.getAttributeValue,n=t(e,r.zj.itemtype),i=t(e,r.zj.cacheKey),a=t(e,r.zj.src),s=t(e,r.zj.uploadProgress),l=t(e,r.zj.thumbnailUploadProgress),d=t(e,r.zj.duration),c=t(e,r.zj.width),u=t(e,r.zj.height);if(!n||!i||!s||!c||!u||!d||Number.isNaN(c)||Number.isNaN(u)||!(0,me.cJ)(s))return;const m={itemType:n,cacheKey:i,uploadProgress:(0,me.VI)(s),width:+c,height:+u,duration:+(0,pe.J)(d)};return a&&(m.src=a),l&&(m.thumbnailUploadProgress=(0,me.VI)(l)),m};var fe=n(410313);const ye=(e,t,n)=>{e.forEach((e=>ke(e,t,n)))},ke=(e,t,n)=>{(0,fe.gU)(e,{type:"TextBlock"},(e=>{Se(e.text,t,n)})),(0,fe.gU)(e,{type:"FactSet"},(e=>{e.facts.forEach((e=>{Se(e.title,t,n),Se(e.value,t,n)}))}))},Se=(e,t,n)=>{const i=e.toLowerCase(),a='itemid="',o=i.indexOf(a),r=o+a.length;if(o>-1){const a=i.substring(r,r+1);if(t&&a){const i=be(a,t,n);i&&(e=e.replace(new RegExp(a,"g"),i))}}},be=(e,t,n)=>{let i="";return t.forEach((t=>{if(t.itemId===e){const{messageProperties:e,telemetryDatabag:a}=n;e.mentions||(e.mentions=[]),i=`${e.mentions.length}`;const o=t.displayName||"",r=t.mentionType||"",s=t.userId||"";a["DataBag.atmentions"]=(a["DataBag.atmentions"]||0)+1,e.mentions.push({itemId:i,displayName:o,userId:s,mentionType:r})}})),i};var Ce=n(283177);let we=class{transform(e,t){if(!e||!t||!t.messageProperties)return;const{loggerFactory:n,coreSettings:a}=t,r=a.get(p.J.Extensibility).enableJITInstallForACv2FromComposeV2||!1,d=n.newLogger("MessageExtensionCardSerializer"),c=(0,l.unescape)(o.N.DomUtils.getAttributeValue(e,j.Qq)),u=o.N.DomUtils.getAttributeValue(e,j.fK);if(!c)return d.error("The props was missing"),null;if(!u)return d.error("The id of the card was missing"),null;try{const n=t.messageProperties.cards||[],{card:a,renderJitInstallConsentFooter:d}=JSON.parse(c);if(!(0,l.isObject)(a))throw new Error("not valid JSON object");(0,l.isString)(a.contentType)&&a.contentType.toLowerCase()===Ce.s.Adaptive&&a.content&&((e,t)=>{const n=JSON.parse(e),i=n.body,a=(0,fe.NI)(n);a&&i&&ye(i,a,t)})(a.content,t);const{__typename:m}=a,g=(0,i.__rest)(a,["__typename"]);g.cardClientId=u,t.messageProperties.cards=[...n,g];const p=o.N.DomUtils.getElements({"data-tid":"jit-install-consent-footer"},e);(r?!!d:!(0,l.isEmpty)(p))&&(t.messageProperties.appIdsToInstall=(0,l.union)(t.messageProperties.appIdsToInstall,[a.appId]));const v=(0,R.ln)("span",{content:u,itemprop:"cardId"}),h=(0,R.ln)("span",{class:"inline-compose-card",itemid:u,itemscope:"",itemtype:s.T.inputExtension});return o.N.DomUtils.appendChild(h,v),h}catch(e){return d.error("Error while adding message extension card to message",e),null}}};we=(0,i.__decorate)([(0,a.wx)({name:"MessageExtension",filter:{[j.$S]:"MessageExtensionCard"}})],we);var Ne=n(967215);let Te=class{constructor(){}transform(e,t){const{loggerFactory:n}=t;if(!e)return;const i=(0,l.unescape)(o.N.DomUtils.getAttributeValue(e,j.Qq));if(!i)return;const a=(0,Ne.D)(i);if((0,l.isEmpty)(a))return void n.newLogger("QuotedReplySerializer").error("Json parsing failed: ",i);const{from:r,messageId:d,preview:c,timestamp:u,userName:m}=a;if(!(r&&d&&c&&m))return void n.newLogger("QuotedReplySerializer").error("Json parsing failed: ",i);const g=(0,R.ln)("blockquote",{itemscope:"",itemtype:s.T.reply,itemid:d}),p=(0,R.ln)("strong",{itemprop:"mri",itemid:r}),v=(0,R.rw)((0,l.escape)(m));if(o.N.DomUtils.appendChild(p,v),o.N.DomUtils.appendChild(g,p),u){const e=(0,R.ln)("span",{itemprop:"time",itemid:u.toString()});o.N.DomUtils.appendChild(g,e)}const h=(0,R.ln)("p",{itemprop:"preview"}),f=(0,R.rw)((0,l.escape)(c));return o.N.DomUtils.appendChild(h,f),o.N.DomUtils.appendChild(g,h),g}};Te=(0,i.__decorate)([(0,a.wx)({name:"QuotedReply",filter:{[j.$S]:"QuotedReplyCard"}}),(0,i.__metadata)("design:paramtypes",[])],Te);let Ie=class{transform(e){return(0,l.isEmpty)(e.children)&&o.N.DomUtils.appendChild(e,(0,R.rw)("")),e}};Ie=(0,i.__decorate)([(0,a.wx)({name:"TableCellSerializer",filter:"td",transient:!0})],Ie);let Ee=class{transform(e){return e.attribs.class="copy-paste-table",e.attribs.itemprop="copy-paste-table",e}};Ee=(0,i.__decorate)([(0,a.wx)({name:"TableSerializer",filter:"table",transient:!0})],Ee);var Ae=n(281857);let _e=class{transform(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=t.coreSettings.get(p.J.Extensibility).postSendTimeoutInMs||2e3,{areUrlPreviewsAllowed:i}=t.coreSettings.get(p.J.Messaging);if(!!!i||!t.connectedExperienceEnabled||!e||!t.messageProperties||t.messageProperties.urlPreview||!t.urlPreviewService||!t.appBasedLinkService||!o.N.DomUtils.hasAttrib(e,"href"))return;const a=t.loggerFactory.newLogger("UrlPreviewSerializer"),r=e.attribs.href||"",s=[this.getUrlPreviewFromAppTimed(r,n,t,a),this.getUrlPreviewTimed(r,n,t,a)],[l,d]=yield Promise.all(s),c=l||d&&Fe(d);return c?(t.messageProperties.urlPreview=c,e):void 0}))}getUrlPreviewFromAppTimed(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enableAppBasedLink:i}=n.coreSettings.get(p.J.Extensibility);if(!i)return Promise.resolve(void 0);const o=n.scenarioFactory.newScenario(y.RG.ExtGetAppPreviewPostSend),r=n.getInstalledMessageExtensionApps(),s="post send app preview timed out";try{const i=yield(0,d.E)(n.appBasedLinkService.getUrlPreviewFromApp(e,r,n.getAppDefinitions,o,n.convId),t,s);return o.stop(),i}catch(t){return De(t)&&t.code===Ae.jK.TimedOut&&t.context===Ae.w5.Timed?o.incomplete({errors:s}):o.fail(),void a.warn(`fetching app preview for url: ${e} failed with error: ${t}`)}}))}getUrlPreviewTimed(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{return yield(0,d.E)(n.urlPreviewService.getPreview(e),t,"url preview timed out")}catch(t){return void a.warn(`fetching url preview for url: ${e} failed with error: ${t}`)}}))}};_e=(0,i.__decorate)([(0,a.HR)({name:"URLPreviewSerializer",filter:"a",transient:!0})],_e);const De=e=>!!(e&&((0,l.get)(e,"code")&&(0,l.get)(e,"context")||(0,l.get)(e,"reason"))),Fe=e=>({url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta});var Me=n(679578);let Re=class{transform(e,t){if(!e||!o.N.DomUtils.hasAttrib(e,r.zj.itemid))return;const n=(0,R.ln)(M.s.span),i=(0,R.rw)((0,R.Q)(e));o.N.DomUtils.appendChild(n,i);const a=o.N.DomUtils.getAttributeValue(e,r.zj.itemid)||"",l=(0,Me.I6)({userAadObjectId:t.authenticationUser.profile.objectId,tenantAadObjectId:t.authenticationUser.profile.tenantId});return null==l||l.logEvent("Cortex.TopicAnnotations.ManualTag.Send",{topicId:a,isTopicNameNumeric:!isNaN(parseFloat(this._getTopicName(e))),contextId:t.convId}),n.attribs[r.zj.itemtype]=s.T.topic,n.attribs[r.zj.itemid]=a,n}_getTopicName(e){const t=(0,R.Q)(e);return t.startsWith("#")?t.substring(1):t}};Re=(0,i.__decorate)([(0,a.wx)({name:"TopicSerializer",filter:"topic"})],Re);var Pe=n(691442);const Oe=[Pe.TV,Pe.Hl];let xe=class{constructor(){}transform(e){var t,n,i;if(e&&(null===(t=e.children)||void 0===t?void 0:t.length)){const t=(0,R.kE)(e.children)[0],a=null===(n=null==e?void 0:e.prev)||void 0===n?void 0:n.attribs[j.$S],o=null===(i=null==e?void 0:e.next)||void 0===i?void 0:i.attribs[j.$S];let r=Pe.sb;return(a&&Oe.includes(a)||o&&Oe.includes(o))&&(r=Pe.ST),t.attribs={itemtype:r,[j.$S]:null==e?void 0:e.attribs[j.$S]},t}}};xe=(0,i.__decorate)([(0,a.wx)({name:"InlineImageCardsSerializer",filter:[{[j.$S]:Pe.TV},{[j.$S]:Pe.Hl}]}),(0,i.__metadata)("design:paramtypes",[])],xe);let Le=class{transform(e,t){if(!(e&&t&&t.messageProperties&&o.N.DomUtils.hasAttrib(e,r.zj.itemtype)))return;const n=o.N.DomUtils.getAttributeValue(e,r.zj.itemtype);if(n!==s.T.editorCiqFile&&n!==s.T.editorCiqPeople)return;const{messageProperties:i,coreSettings:a}=t,d=o.N.DomUtils.getAttributeValue(e,r.zj.itemProps);return d&&Ue((0,l.unescape)(d),i,a,n),e}};Le=(0,i.__decorate)([(0,a.wx)({name:"CopilotSerializer",filter:"*"})],Le);const Ue=(e,t,n,i)=>{var a;let o=null===(a=t.mentions)||void 0===a?void 0:a.find((e=>e.mentionType===je));o||(o={itemId:"0",userId:"3209c41b-0e5c-45cb-b72e-68dcecbaa23d",mentionType:je,displayName:JSON.stringify({copilotBotDataVersion:"1.0",files:[],people:[]})});const r=JSON.parse(o.displayName),l=r.files,d=r.people,{copilotBotDataVersion:c}=n.get(p.J.Messaging);let u;try{u=JSON.parse(Be(Be(e)))}catch(e){return}i===s.T.editorCiqFile&&l.push(u),i===s.T.editorCiqPeople&&d.push(u);const m={copilotBotDataVersion:c||r.CopilotBotDataVersion,files:l,people:d};o.displayName=JSON.stringify(m),t.mentions=[o]},Be=e=>e?e.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g,"").replace(/&amp;/g,"&"):"",je="Copilot",We=[x],Ve=[W,B,Q.D,x,Le,Re,Ie,Ee,Z,Y,$,G,ne,X,we,Te,xe],He=[le,q.O,_e,k,ve],$e=[U]},301210:(e,t,n)=>{"use strict";n.d(t,{hE:()=>i,Uu:()=>a,pT:()=>o,ez:()=>r,rW:()=>s,vH:()=>l});const i=20,a="emojione",o="^:(middle_fin|ok_hand)",r="sake|cocktail|wine|wine_glass|beers?|champagne|tropical_drink|bomb",s="https://statics.teams.cdn.office.net/evergreen-assets/emojioneassets/assets-png/",l=".png"},169728:(e,t,n)=>{"use strict";n.d(t,{x:()=>r,B:()=>s});var i=n(301210),a=n(265351);const o=new RegExp(i.Uu),r=e=>o.test(a.N.DomUtils.getAttributeValue(e,"class")||""),s=(e,t="")=>{const n=`max-height: ${i.hE}px; max-width: ${i.hE}px; height: ${i.hE}px; width: ${i.hE}px`;return`<img class="${i.Uu}" alt="${t}" src="${e}" width="${i.hE}" height="${i.hE}" style="${n}"/>`}},342131:(e,t,n)=>{"use strict";n.d(t,{L1:()=>l,xU:()=>c,if:()=>u,I:()=>m,Q4:()=>g,uT:()=>p,js:()=>v,_R:()=>h,rO:()=>f,cn:()=>y,Du:()=>k,rJ:()=>S,$w:()=>b,oM:()=>C,TG:()=>w,th:()=>N,QX:()=>T,ct:()=>E,WK:()=>A,pt:()=>_});var i=n(113491),a=n(889705),o=n(84237),r=n(229421),s=n(852949);const l=4250,d=new Map([["angry","angryV2"]]),c=(e,t)=>{var n,i;return"legacy"===t||!e.enableSkypeCMSEmoticons&&"skype"!==t?null!==(n=e.emoticonCdnAssetsUrl)&&void 0!==n?n:"https://statics.teams.cdn.office.net/evergreen-assets/skype/v2":null!==(i=e.pesEmoticonCdnAssetsUrl)&&void 0!==i?i:"https://statics.teams.cdn.office.net/evergreen-assets/personal-expressions/v2/assets/emoticons"},u=(e,t,n=!1,i=!0)=>{var a;const r=e.description;if(!i&&!n)return r;const{id:s,skinTone:l}=(0,o.M)(e.id),d=(null===(a=e.shortcuts)||void 0===a?void 0:a[0])||`(${s})`;if(e.diverse){const e=t.stringTranslate("funstuff",`emoticon_skintone_${o.j[l].name}`);return n?t.stringTranslate("funstuff","emoticon_combined_skintone_title",{name:r,skinTone:e,shortName:d}):t.stringTranslate("funstuff","emoticon_name_with_skintone",{name:r,skinTone:e})}return n?t.stringTranslate("funstuff","emoticon_combined_title",{name:r,shortName:d}):r},m=(e,t,n)=>{var i,a;const{id:r}=(0,o.M)(e.id),s=(null===(a=null===(i=e.shortcuts)||void 0===i?void 0:i[0])||void 0===a?void 0:a.slice(1,-1))||r;return n?t.stringTranslate("funstuff","emoticon_aria_combined_title",{name:u(e,t,!1,n),shortName:s,openingParenthesis:t.stringTranslate("funstuff","emoticon_aria_opening_parenthesis"),closingParenthesis:t.stringTranslate("funstuff","emoticon_aria_closing_parenthesis")}):e.description},g=(e,t,n,i)=>s.uU.has(e)?f(p(e,t,n),"small",{enableSkypeCMSEmoticons:t,pesEmoticonCdnAssetsUrl:i},!0):void 0,p=(e,t,n=!1)=>{var i;return null!==(i=t?n?(0,r.Z)(e):s.uU.get(e):s.Ao.get(e))&&void 0!==i?i:e},v=(e,t,n,i,a)=>{_(n,a).forEach((n=>{const a=g(n,e,i,t);if(a){(new Image).src=a}}))},h=(e,t)=>t.stringTranslate("funstuff",`emoticon_${e}_keywords`),f=(e,t,n,i=!0,a="",r=!1,s=!1,l=null)=>{const u=s?k(t,l,r):y(t,r),{id:m,skinTone:g}=(0,o.M)(e),p=0!==g?`_s${g+1}`:"";if(!n||!n.enableSkypeCMSEmoticons&&C(m)&&0===g||s){let e=d.get(m)||m;return C(m)||(e=`${e}${p}`),`${c(n,"legacy")}/${e}/${u}${i?"a":""}.png`}{const e=i?"_anim":"",t=a&&""!==a?`?v=${a}`:"";return`${c(n,"skype")}/${m}/default/${u}${e}_f${p}.png${t}`}},y=(e,t=!1)=>{switch(e){case"extra-large":return i.hU;case"large":return t?i.hU:i.G4;case"medium":return t?i.$y:i.ZO;case"extra-small":return t?i.Mw:i.fs;case"small":default:return t?i.G4:i.Mw}},k=(e,t=null,n=!1)=>{const i=S(e,t);return n?2*i:i},S=(e,t=null)=>{switch(e){case"meeting-giant":return(null==t?void 0:t.xxxLargeIconSize)||224;case"meeting-jumbo":return(null==t?void 0:t.xxLargeIconSize)||168;case"meeting-overlay":return(null==t?void 0:t.overlayIconSize)||64;case"extra-large":return(null==t?void 0:t.xLargeIconSize)||140;case"large":return(null==t?void 0:t.largeIconSize)||112;case"medium":return(null==t?void 0:t.mediumIconSize)||84;case"small":return(null==t?void 0:t.smallIconSize)||56;case"extra-small":return(null==t?void 0:t.xSmallIconSize)||42;case"meeting-tiny":default:return(null==t?void 0:t.xxSmallIconSize)||32}},b=e=>{switch(e){case i.hU:case i.$y:return i.G4;case i.G4:return i.ZO;case i.ZO:return i.Mw;default:return e}},C=e=>s.uQ.has(e)||s.Ye.has(e),w=e=>{var t,n;return(null===(t=s.uQ.get(e))||void 0===t?void 0:t.unicode)||(null===(n=s.Ye.get(e))||void 0===n?void 0:n.unicode)||void 0},N=(e,t,n,r)=>{if(!e)return t.document.createElement("span");const{id:s,skinTone:l}=(0,o.M)(e.id);let d=`${e.description}`;if(0!==l){const t=`emoticon_skintone_${o.j[l].name}`;d=n.stringTranslate("funstuff","emoticon_name_with_skintone",{name:e.description,skinTone:n.stringTranslate("funstuff",t)})}const c="small",u=t.document.createElement("img"),m=`${y(c)}px`;u.setAttribute("src",f(e.id,c,r,!1,e.etag,t.isHighResolution)),u.setAttribute("alt",e.description),u.setAttribute("draggable","false"),u.setAttribute("width",m),u.setAttribute("height",m),u.setAttribute("aria-label",e.description),u.style.overflow="hidden",u.style.margin="0 1px",r.enableSkypeCMSEmoticons||"yes"!==s||(u.style.transform="scaleX(-1)");const g=t.document.createElement(i.Od);return g.setAttribute("contenteditable","false"),g.setAttribute("title",d),g.setAttribute("itemid",e.id),g.setAttribute("itemtype",a.T.emoji),g.setAttribute("itemscope",e.unicode||d),g.setAttribute("aria-label",e.description),g.appendChild(u),g},T=(e,t,n,i=!0,a="funstuff")=>{const o=s.uQ.get(e)||s.Ye.get(e);if(!o)throw new RangeError(`Invalid emoticon ${e}`);const r=o.steps,l=r/o.duration;return{id:e,description:t&&i&&t.stringTranslate(a,`emoticon_${o.pastName||e}_name`)||n||e,unicode:o.unicode,etag:"",animation:{fps:l,firstFrame:"kiss"===e?30:1,framesCount:r}}};let I;const E=()=>(I||(I=new Map,s.uQ.forEach(((e,t)=>e.shortcuts.forEach((e=>I.set(e.toLowerCase(),t)))))),I),A=e=>E().get(e),_=(e,t)=>Array.isArray(t)&&t.length&&e?t:Array.from(s.uU.keys())},84237:(e,t,n)=>{"use strict";n.d(t,{j:()=>i,M:()=>a});const i=[{name:"default"},{name:"light",code:57339},{name:"medium_light",code:57340},{name:"medium",code:57341},{name:"medium_dark",code:57342},{name:"dark",code:57343}],a=e=>{const t=e.match(/(\S+)-tone(\S+)/);return t&&3===t.length?{id:t[1],skinTone:Number.parseInt(t[2],10)}:{id:e,skinTone:0}}},229421:(e,t,n)=>{"use strict";n.d(t,{I:()=>o,Z:()=>r});const i=new Map([["like","likeWithFaceMSER"],["star","starMSER"],["yes","like"]]),a=new Map([["like","yes"],["likeWithFaceMSER","like"],["starMSER","star"]]),o=e=>{var t;return null!==(t=i.get(e))&&void 0!==t?t:e},r=e=>{var t;return null!==(t=a.get(e))&&void 0!==t?t:e}},852949:(e,t,n)=>{"use strict";n.d(t,{uQ:()=>i,Ye:()=>a,uU:()=>o,Ao:()=>r,c$:()=>s});const i=new Map([["smile",{unicode:"",shortcuts:[":)",":-)",":=)","(smile)"],duration:2.2083,steps:53}],["laugh",{unicode:"",shortcuts:[":d",":-d",":=d","(laugh)",":>",":->","(lol)"],duration:3.2083,steps:77}],["heart",{unicode:"",shortcuts:["(heart)","<3"],duration:.7083,steps:16}],["kiss",{unicode:"",shortcuts:["(kiss)",":*",":-*",":=*","(xo)"],duration:2.875,steps:50}],["sad",{unicode:"",shortcuts:[":(",":-(",":=(","(sad)",":<",":-<"],duration:2.625,steps:63}],["tongueout",{unicode:"",shortcuts:[":p",":-p",":=p","(tongueout)","(yum)"],duration:2.9583,steps:71}],["wink",{unicode:"",shortcuts:[";)",";-)",";=)","(wink)"],duration:1.5,steps:36}],["cry",{unicode:"",shortcuts:[";(",";-(",";=(","(cry)",":'("],duration:2.0833,steps:50}],["inlove",{unicode:"",shortcuts:["(inlove)","(love)",":]",":-]"],duration:2.625,steps:63}],["hug",{unicode:"",shortcuts:["(hug)","(bear)"],duration:3.1667,steps:76}],["cwl",{unicode:"",shortcuts:["(cwl)","(cryingwithlaughter)"],duration:2.5417,steps:61}],["lips",{unicode:"",shortcuts:["(lips)"],duration:3.7083,steps:89}],["blush",{unicode:"",shortcuts:[":$",":-$",":=$",':">',"(blush)"],duration:2.875,steps:69}],["surprised",{unicode:"",shortcuts:[":o",":-o",":=o","(surprised)"],duration:2.8333,steps:68}],["penguin",{unicode:"",shortcuts:["(penguin)","(dancingpenguin)","(penguindance)"],duration:2.6667,steps:64}],["yes",{unicode:"",shortcuts:["(y)","(yes)","(thumbsup)"],duration:1.6667,steps:40}],["cool",{unicode:"",shortcuts:["(cool)","8-)","8=)","b-)","b=)","(sunglasses)"],duration:1.5833,steps:38}],["rofl",{unicode:"",shortcuts:["(rofl)","(rotfl)"],duration:3.375,steps:81}],["cat",{unicode:"",shortcuts:["(cat)","(meow)","(kitty)"],duration:5,steps:120}],["monkey",{unicode:"",shortcuts:["(monkey)","(ape)"],duration:2.0833,steps:50}],["hi",{unicode:"",shortcuts:["(wave)","(hi)","(bye)"],duration:2.375,steps:57}],["snowangel",{unicode:"",shortcuts:["(snowangel)"],duration:2.5,steps:60}],["flower",{unicode:"",shortcuts:["(flower)"],duration:3.4583,steps:83}],["giggle",{unicode:"",shortcuts:["(chuckle)","(giggle)"],duration:1.875,steps:45}],["devil",{unicode:"",shortcuts:["(devil)"],duration:2.7917,steps:67}],["party",{unicode:"",shortcuts:["(party)","<o)","<:o)"],duration:2.9583,steps:71}],["worry",{unicode:"",shortcuts:["(worry)",":s",":-s",":=s","(worried)","(scared)"],duration:2.3333,steps:56}],["champagne",{unicode:"",shortcuts:["(champagne)","(sparkling)"],duration:2.5833,steps:62}],["sun",{unicode:"",shortcuts:["(sun)"],duration:1.0833,steps:26}],["star",{unicode:"",shortcuts:["(star)"],duration:2.6667,steps:64}],["polarbear",{unicode:"",shortcuts:["(polarbear)","(polarbearhug)"],duration:5,steps:120}],["dull",{unicode:"",shortcuts:["|-(","|(","|=(","(dull)","(eyeroll)"],duration:3.2083,steps:77}],["speechless",{unicode:"",shortcuts:[":|",":-|",":=|","(speechless)"],duration:2.7917,steps:67}],["wonder",{unicode:"",shortcuts:[":^)","(wonder)","(skeptical)"],duration:2.9167,steps:70}],["angry",{unicode:"",shortcuts:["(angry)",":@",":-@",":=@","x(","x-(","x=(",";@",";-@","(rage)"],duration:4.375,steps:105}],["puke",{unicode:"",shortcuts:["(puke)",":&",":-&",":=&","+o("],duration:3.2917,steps:79}],["facepalm",{unicode:"",shortcuts:["(facepalm)","(fail)"],duration:3.2083,steps:77}],["sweat",{unicode:"",shortcuts:["(:|","(sweat)"],duration:2.875,steps:69}],["holidayspirit",{unicode:"",shortcuts:["(holidayspirit)","(crazyxmas)","(crazychristmas)"],duration:1.5,steps:36}],["sleepy",{unicode:"",shortcuts:["|-)","i-)","i=)","(snooze)","(sleepy)","(sleeping)"],duration:3,steps:72}],["bow",{unicode:"",shortcuts:["(bow)"],duration:2.5,steps:60}],["makeup",{unicode:"",shortcuts:["(makeup)"],duration:4.5,steps:108}],["cash",{unicode:"",shortcuts:["(cash)","(money)"],duration:1.125,steps:27}],["lipssealed",{unicode:"",shortcuts:[":x",":-x",":#",":-#",":=x",":=#","(lipssealed)"],duration:2.0833,steps:50}],["shivering",{unicode:"",shortcuts:["(shivering)","(cold)","(freezing)"],duration:7.9167,steps:190}],["cake",{unicode:"",shortcuts:["(cake)"],duration:4.125,steps:99}],["headbang",{unicode:"",shortcuts:["(headbang)","(banghead)"],duration:2.9583,steps:71}],["dance",{unicode:"",shortcuts:["o/",":d/","(dance)"],duration:8.5833,steps:206}],["wasntme",{unicode:"",shortcuts:["(wasntme)"],duration:3.1667,steps:76}],["hungover",{unicode:"",shortcuts:["(hungover)"],duration:3.0417,steps:73}],["yawn",{unicode:"",shortcuts:["(yawn)"],duration:3.0833,steps:74}],["gift",{unicode:"",shortcuts:["(gift)"],duration:.5417,steps:13}],["angel",{unicode:"",shortcuts:["(angel)"],duration:3.5,steps:84}],["xmastree",{unicode:"",shortcuts:["(xmastree)","(christmastree)"],duration:1.125,steps:27}],["brokenheart",{unicode:"",shortcuts:["(brokenheart)"],duration:4.375,steps:105}],["think",{unicode:"",shortcuts:["(think)",":-?",":?",":=?","*-)"],duration:2.4583,steps:59}],["clap",{unicode:"",shortcuts:["(clap)"],duration:1.6667,steps:40}],["punch",{unicode:"",shortcuts:["(punch)","*|","*-|"],duration:1.8333,steps:44}],["envy",{unicode:"",shortcuts:["(envy)"],duration:2.8333,steps:68}],["handshake",{unicode:"",shortcuts:["(handshake)"],duration:2.5833,steps:62}],["nod",{unicode:"",shortcuts:["(nod)"],duration:2.125,steps:51}],["nerdy",{unicode:"",shortcuts:["(nerd)","8-|","b-|","8|","b|","8=|","b=|","(nerdy)"],duration:2,steps:48}],["emo",{unicode:"",shortcuts:["(emo)"],duration:2.25,steps:54}],["muscle",{unicode:"",shortcuts:["(flex)","(muscle)"],duration:2.4583,steps:59}],["mmm",{unicode:"",shortcuts:["(mm)","(mmm)","(mmmm)"],duration:3.875,steps:93}],["highfive",{unicode:"",shortcuts:["(highfive)","(hifive)","(h5)"],duration:1.5833,steps:38}],["turkey",{unicode:"",shortcuts:["(turkey)","(turkeydance)"],duration:2.0833,steps:50}],["call",{unicode:"",shortcuts:["(call)"],duration:1.9167,steps:46}],["movember",{unicode:"",shortcuts:["(movember)","(moustache)","(mustache)",":{"],duration:4.5833,steps:110}],["dog",{unicode:"",shortcuts:["(dog)"],duration:2.25,steps:54}],["coffee",{unicode:"",shortcuts:["(coffee)"],duration:1.1667,steps:28}],["poke",{unicode:"",shortcuts:["(poke)","(nudge)"],duration:3.125,steps:75}],["swear",{unicode:"",shortcuts:["(swear)"],duration:3.2083,steps:77}],["donttalktome",{unicode:"",shortcuts:["(donttalk)","(donttalktome)"],duration:2.5,steps:60}],["fingerscrossed",{unicode:"",shortcuts:["(fingers)","(fingerscrossed)","(crossedfingers)"],duration:2.6667,steps:64}],["rainbow",{unicode:"",shortcuts:["(rainbow)"],duration:.8333,steps:20}],["headphones",{unicode:"",shortcuts:["(headphones)"],duration:3.5,steps:84}],["waiting",{unicode:"",shortcuts:["(waiting)"],duration:2.125,steps:51}],["festiveparty",{unicode:"",shortcuts:["(festiveparty)"],duration:3.0417,steps:73}],["heidy",{unicode:"",shortcuts:["(squirrel)","(heidy)"],duration:3.125,steps:75}],["beer",{unicode:"",shortcuts:["(beer)"],duration:3.1667,steps:76}],["doh",{unicode:"",shortcuts:["(doh)"],duration:2.5,steps:60}],["bomb",{unicode:"",shortcuts:["(bomb)","(explosion)","(explode)"],duration:7.1667,steps:172}],["happy",{unicode:"",shortcuts:["(happy)"],duration:2.9167,steps:70}],["ninja",{unicode:"",shortcuts:["(ninja)"],duration:5.0833,steps:122}]]),a=new Map([["angryface",{unicode:"",shortcuts:[],duration:4.375,steps:105,pastName:"angry"}],["smileeyes",{unicode:"",shortcuts:[],duration:2.875,steps:69}]]),o=new Map([["like","yes"],["heart","heart"],["laugh","laugh"],["surprised","surprised"],["sad","sad"],["angry","angry"]]),r=o,s=new Map([["laughV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehand",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehandV3",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["heartV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["clapV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["surprisedV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["laughV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehand-3D",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehandV3-3D",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["heartV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["clapV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["surprisedV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesGestureLoading",{unicode:"",shortcuts:[],duration:1.5417,steps:37}],["yesGestureComplete",{unicode:"",shortcuts:[],duration:4.7083,steps:113}],["raisehandGestureLoading",{unicode:"",shortcuts:[],duration:1.5417,steps:37}],["raisehandGestureComplete",{unicode:"",shortcuts:[],duration:4.7083,steps:113}]])},786152:(e,t,n)=>{"use strict";n.d(t,{E4:()=>a,$c:()=>o,C9:()=>r,vV:()=>s,xu:()=>l,mQ:()=>d,Np:()=>c});var i,a,o,r,s,l,d,c;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(i||(i={})),function(e){e.web="web",e.desktop="desktop",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows"}(a||(a={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(o||(o={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(r||(r={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(s||(s={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(l||(l={})),function(e){e.card="card",e.deepLink="deepLink",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.adaptiveCardCollabStage="adaptiveCardCollabStage",e.platformAppView="platformAppView",e.channelTab="channelTab",e.sidePanel="sidePanel",e.privateMeetingSchedulingForm="privateMeetingSchedulingForm",e.channelMeetingSchedulingForm="channelMeetingSchedulingForm",e.personalApp="personalApp",e.botConfig="botConfig"}(d||(d={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(c||(c={}))},564396:(e,t,n)=>{"use strict";n.d(t,{eG:()=>s,Ax:()=>l,um:()=>d,so:()=>c,cL:()=>u,p0:()=>m});var i=n(142980),a=n(76087),o=n(628235);const r={af_ZA:1078,am_ET:1118,ar_AE:14337,ar_BH:15361,ar_DZ:5121,ar_EG:3073,ar_IQ:2049,ar_JO:11265,ar_KW:13313,ar_LB:12289,ar_LY:4097,ar_MA:6145,ar_OM:8193,ar_QA:16385,ar_SA:1025,ar_SY:10241,ar_TN:7169,ar_YE:9217,arn_CL:1146,as_IN:1101,az_AZ:2092,ba_RU:1133,be_BY:1059,bg_BG:1026,bn_IN:1093,bo_BT:2129,bo_CN:1105,br_FR:1150,bs_BA:8218,ca_ES:1027,co_FR:1155,cs_CZ:1029,cy_GB:1106,da_DK:1030,de_AT:3079,de_CH:2055,de_DE:1031,de_LI:5127,de_LU:4103,div_MV:1125,dsb_DE:2094,el_GR:1032,en_AU:3081,en_BZ:10249,en_CA:4105,en_CB:9225,en_GB:2057,en_IE:6153,en_IN:18441,en_JA:8201,en_MY:17417,en_NZ:5129,en_PH:13321,en_TT:11273,en_US:1033,en_ZA:7177,en_ZW:12297,es_AR:11274,es_BO:16394,es_CL:13322,es_CO:9226,es_CR:5130,es_DO:7178,es_EC:12298,es_ES:3082,es_GT:4106,es_HN:18442,es_MX:2058,es_NI:19466,es_PA:6154,es_PE:10250,es_PR:20490,es_PY:15370,es_SV:17418,es_UR:14346,es_US:21514,es_VE:8202,et_EE:1061,eu_ES:1069,fa_IR:1065,fi_FI:1035,fil_PH:1124,fo_FO:1080,fr_BE:2060,fr_CA:3084,fr_CH:4108,fr_FR:1036,fr_LU:5132,fr_MC:6156,fy_NL:1122,ga_IE:2108,gbz_AF:1164,gl_ES:1110,gsw_FR:1156,gu_IN:1095,ha_NG:1128,he_IL:1037,hi_IN:1081,hr_BA:4122,hr_HR:1050,hu_HU:1038,hy_AM:1067,id_ID:1057,ii_CN:1144,is_IS:1039,it_CH:2064,it_IT:1040,iu_CA:2141,ja_JP:1041,ka_GE:1079,kh_KH:1107,kk_KZ:1087,kl_GL:1135,kn_IN:1099,ko_KR:1042,kok_IN:1111,ky_KG:1088,lb_LU:1134,lo_LA:1108,lt_LT:1063,lv_LV:1062,mi_NZ:1153,mk_MK:1071,ml_IN:1100,mn_CN:2128,mn_MN:1104,moh_CA:1148,mr_IN:1102,ms_BN:2110,ms_MY:1086,mt_MT:1082,my_MM:1109,nb_NO:1044,ne_NP:1121,nl_BE:2067,nl_NL:1043,nn_NO:2068,ns_ZA:1132,oc_FR:1154,or_IN:1096,pa_IN:1094,pl_PL:1045,ps_AF:1123,pt_BR:1046,pt_PT:2070,qut_GT:1158,quz_BO:1131,quz_EC:2155,quz_PE:3179,rm_CH:1047,ro_RO:1048,ru_RU:1049,rw_RW:1159,sa_IN:1103,sah_RU:1157,se_FI:3131,se_NO:1083,se_SE:2107,si_LK:1115,sk_SK:1051,sl_SI:1060,sma_NO:6203,sma_SE:7227,smj_NO:4155,smj_SE:5179,smn_FI:9275,sms_FI:8251,sq_AL:1052,sr_BA:7194,sr_SP:3098,sv_FI:2077,sv_SE:1053,sw_KE:1089,syr_SY:1114,ta_IN:1097,te_IN:1098,tg_TJ:1064,th_TH:1054,tk_TM:1090,tmz_DZ:2143,tn_ZA:1074,tr_TR:1055,tt_RU:1092,ug_CN:1152,uk_UA:1058,ur_IN:2080,ur_PK:1056,uz_UZ:2115,vi_VN:1066,wen_DE:1070,wo_SN:1160,xh_ZA:1076,yo_NG:1130,zh_CHS:4,zh_CHT:31748,zh_CN:2052,zh_HK:3076,zh_MO:5124,zh_SG:4100,zh_TW:1028,zu_ZA:1077};function s(e){const[t,n]=e.split("-");let i="";return t&&n&&(i=`${t.toLowerCase()}_${n.toUpperCase()}`),r[i]||r.en_US}function l(e,t,n){return d(t,n?n.toLocaleLowerCase():e.toLowerCase())}function d(e,t){const n=(0,i.vw)(t);if(n.locale!==t){e.createScenarioWithoutStarting(o.RG.I18nLangFallback).stop({origin:t,message:n.reason})}return n.locale?n.locale:"en-us"}function c(e){return e.split("-")[1]||""}const u={locale:""};class m{static get locale(){return u.locale}static isRtl(e){return e=e||this.locale,(0,a.$)(e)}static setLangAttribute(e,t){t=t||this.locale,e.getAttribute("lang")!==t&&e.setAttribute("lang",t)}static setDirAttribute(e,t,n){void 0===t&&(t=this.isRtl(n||this.locale));const i=e.getAttribute("dir");t&&"rtl"!==i?e.setAttribute("dir","rtl"):t||""===i||"ltr"===i||e.removeAttribute("dir")}}},356629:(e,t,n)=>{"use strict";n.d(t,{E:()=>c,o:()=>m});var i=n(564396),a=n(329371),o=n(54363),r=n(424097),s=n(628235),l=n(651473),d=n(764858);const c=(e,t)=>(null==e?void 0:e.endsWith("_mf"))?Object.assign(Object.assign({},t),{skipInterpolation:!0}):t,u={hour:!0,minute:!0,second:!0};class m{get locale(){var e;return(null===(e=this.i18nextWrapper)||void 0===e?void 0:e.locale)||"en-us"}get originLocale(){var e;return null===(e=this.i18nextWrapper)||void 0===e?void 0:e.originLocale}get userLanguage(){var e;return null===(e=this.i18nextWrapper)||void 0===e?void 0:e.userLanguage}get isRtl(){return i.p0.isRtl(this.locale)}constructor(e){if(this.i18nextWrapper=e,this.timeSettings={},this.scenarioFactory=e.scenarioFactory,!this.i18nextWrapper.osLocaleInfo||!this.isSupportedOsRegionalFormat()){const t=(null==e?void 0:e.locale)||"en-us";return this.dateTimeFormatter=new r.bg(t),void(this.dateTimeFormatterNoYear=this.dateTimeFormatter)}if(this._osLocaleInfo=this.i18nextWrapper.osLocaleInfo,this._osDateTimeLocale=this._osLocaleInfo.regionalFormat,this.isUnsupportedCalendar())return this.dateTimeFormatter=new r.bg(this._osLocaleInfo.regionalFormat),void(this.dateTimeFormatterNoYear=this.dateTimeFormatter);const t={platform:this.i18nextWrapper.osPlatform===a.NR.Mac?"macos":"windows",regionalFormat:this._osLocaleInfo.regionalFormat,shortDate:this.i18nextWrapper.osLocaleInfo.date.shortDate,longDate:this.i18nextWrapper.osLocaleInfo.date.longDate,shortTime:this.i18nextWrapper.osLocaleInfo.date.shortTime,longTime:this.i18nextWrapper.osLocaleInfo.date.longTime},n=Object.assign(Object.assign({},t),{shortDate:(0,l.L)(t.shortDate),longDate:(0,l.L)(t.longDate),shortTime:(0,l.L)(t.shortTime),longTime:(0,l.L)(t.longTime)});this.dateTimeFormatter=new r.bg(t),this.dateTimeFormatterNoYear=new r.bg(n)}setLocale(e){var t;return null===(t=this.i18nextWrapper)||void 0===t?void 0:t.setLocale(e)}get osDateTimeLocale(){return this._osDateTimeLocale}get osFirstDayOfWeek(){if(this.osLocaleInfo&&this.osLocaleInfo.date){const e=parseInt(this.osLocaleInfo.date.firstDayOfWeek,10);if(!Number.isNaN(e))return e}}get firstDayOfWeek(){var e;return null!==(e=this.osFirstDayOfWeek)&&void 0!==e?e:(0,d.O)(this.i18nextWrapper.originLocale)}get osLocaleInfo(){return this._osLocaleInfo}stringTranslate(e,t,n){this.i18nextWrapper.latestTranslation.namespace=e,this.i18nextWrapper.latestTranslation.key=t;return this.i18nextWrapper.i18next.getFixedT(this.locale,e)(t,c(t,n))}waitForNamespace(e){return this.i18nextWrapper.namespaceLoader.waitForNamespace(this.i18nextWrapper,e)}getNamespaceState(e){return this.i18nextWrapper.namespaceLoader.getState(e)}isNamespaceLoaded(e){const t=this.getNamespaceState(e);return!(t===o.i.Loading||t===o.i.Missing)}formatDateTime(e,t,n){var i,a,o;try{return n?this.dateTimeFormatterNoYear.formatDateTime(e,(0,l.M)(t)):this.dateTimeFormatter.formatDateTime(e,t)}catch(n){if(this.shouldLogFormatFallback(t)){const e=`Date format ${JSON.stringify(t)} is not supported, falling back to Intl.DateTimeFormat`;this.scenarioFactory.createScenarioWithoutStarting(s.RG.I18nFallbackToIntl).stop({errors:e,origin:null===(i=this.osLocaleInfo)||void 0===i?void 0:i.regionalFormat})}const l=null!==(o=null===(a=this.osLocaleInfo)||void 0===a?void 0:a.regionalFormat)&&void 0!==o?o:this.locale;try{return(0,r.fM)(l,t).format(e)}catch(n){const i=`Date format ${JSON.stringify(t)} for date ${e.toLocaleString()} fallback failed: ${n&&n.message}`;return this.scenarioFactory.createScenarioWithoutStarting(s.RG.I18nFallbackToIntl).fail({errors:i,origin:l}),""}}}formatNumber(e,t){return Intl.NumberFormat(this.osDateTimeLocale||this.locale,t).format(e)}formatNumberWithRegionalFormat(e,t){return Intl.NumberFormat(this.originLocale,t).format(e)}getStringComparer(e){return Intl.Collator(this.locale,e).compare}sortStrings(e,t){const n=this.getStringComparer(t);return e.sort(n)}getLocaleTimeSettings(){if(this.timeSettings[this.locale])return this.timeSettings[this.locale];const e=new Date(0,0,0,1,2,3).toLocaleTimeString(this.locale).match(new RegExp(`[${this.formatNumber(0)}-${this.formatNumber(9)}]+`,"g")),t={hour:"2-digit",minute:"2-digit",second:"2-digit"};if(Array.isArray(e)){const n=this.formatNumber(1),i=this.formatNumber(2),a=this.formatNumber(3);for(const o of e)o.indexOf(n)>-1?t.hour=1===o.length?"numeric":"2-digit":o.indexOf(i)>-1?t.minute=1===o.length?"numeric":"2-digit":o.indexOf(a)>-1&&(t.second=1===o.length?"numeric":"2-digit")}return this.timeSettings[this.locale]=t,t}isSupportedOsRegionalFormat(){const e=[a.NR.Mac,a.NR.Windows].indexOf(this.i18nextWrapper.osPlatform)>-1;return this.i18nextWrapper.osLocaleInfo&&e&&this.i18nextWrapper.osLocaleInfo.regionalFormat&&"UNKNOWN"!==this.i18nextWrapper.osLocaleInfo.regionalFormat}isUnsupportedCalendar(){return!this.i18nextWrapper.osLocaleInfo||!this.i18nextWrapper.osLocaleInfo.date||"gregorian"!==this.i18nextWrapper.osLocaleInfo.date.calendar&&"1"!==this.i18nextWrapper.osLocaleInfo.date.calendar}shouldLogFormatFallback(e){if(!e)return!0;if(e===r.Eq||e===r.W2)return!1;let t=!1;return Object.keys(e).map((e=>{u[e]||(t=!0)})),t}}},912206:(e,t,n)=>{"use strict";n.d(t,{q8:()=>d,dR:()=>c,Zl:()=>u});var i=n(231191),a=n(119423),o=n(642115),r=n(281857),s=n(628235);const l="Browser does not support IndexedDB APIs";function d(e,t,n,d,c,u){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;const g=(0,a.J)().indexedDB;return new Promise(((a,p)=>{const v=c.newScenario(s.RG.IndexedDBFetch);v.appendEventData({dataSource:n});try{g||p((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,l)),i=g.open(e,t),i.onerror=()=>{p((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,"Error in indexedDB open request"))},i.onupgradeneeded=e=>{m(t,n,d,i,e,a,p,v)},i.onsuccess=function(e,t,n,i,a,s,l){return()=>{try{const d=e.result,c=d.transaction([t]).objectStore(t),u=l?c.getAll():c.get(n);u.onsuccess=e=>{d.close(),i.stop();const t=e.target.result;a(l?t:t&&(t.value||u.result))},u.onerror=()=>{d.close(),i.fail(),s((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,"Error trying to get chat service sync end point from indexedDB"))}}catch(e){i.fail(),s((0,o.Tr)(r.w5.IndexDb,r.jK.IndexDbException,`Failed to read from '${t}' object store on the indexedDB.`))}}}(i,n,d,v,a,p,u)}catch(e){v.fail({errors:e.message}),p(e)}}))}))}function c(e,t,n,o,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){{let i;const d=(0,a.J)().indexedDB;return new Promise(((a,c)=>{const u=r.newScenario(s.RG.IndexedDBDelete);u.appendEventData({dataSource:n});try{d||c(new Error(l)),i=d.open(e,t),i.onerror=()=>{c(new Error(l)),u.fail({errors:l})},i.onsuccess=()=>{!function(e,t,n,i,a){try{const o=e.result,r=o.transaction([t],"readwrite"),s=r.objectStore(t).clear();s.onsuccess=e=>{o.close(),n.stop(),i(e.target.result)},s.onerror=e=>{o.close(),n.fail(),a(`Error trying to delete data from indexedDB: ${e}`)}}catch(e){n.fail(),a(`Error trying to delete data from indexedDB: ${e}`)}}(i,n,u,a,c)},i.onupgradeneeded=e=>{m(t,n,o,i,e,a,c,u)}}catch(e){u.fail({errors:e.message}),c(e)}}))}}))}function u(e,t,n,o,r,d){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i;const c=(0,a.J)().indexedDB;return new Promise(((a,u)=>{const g=d.newScenario(s.RG.IndexedDBWrite);g.appendEventData({dataSource:n});try{c||u(new Error(l)),i=c.open(e,t),i.onerror=()=>{u(new Error(l)),g.fail({errors:l})},i.onsuccess=()=>{!function(e,t,n,i,a,o){try{const r=e.result,s=r.transaction([t],"readwrite").objectStore(t);let l;n.forEach((e=>{l=s.put(e),l.onsuccess=e=>{r.close(),i.stop(),a(e.target.result.value)},l.onerror=e=>{r.close(),i.fail(),o(`Error trying to write into indexedDB: ${e}`)}}))}catch(e){i.fail(),o(`Error trying to write into indexedDB: ${e}`)}}(i,n,r,g,a,u)},i.onupgradeneeded=e=>{m(t,n,o,i,e,a,u,g)}}catch(e){g.fail({errors:e.message}),u(e)}}))}))}function m(e,t,n,i,a,o,r,l){try{a.oldVersion<e&&i.result.createObjectStore(t,{keyPath:n}),l.mark(s.ck.IndexedDBUpgrade),o()}catch(e){l.fail(),r(`Failed to create object stores on the indexedDB: ${e}`)}}},142980:(e,t,n)=>{"use strict";n.d(t,{$n:()=>o,vw:()=>r});var i=n(191175),a=n(961776);const o=e=>{for(const t of e){const n=s(t);if(null!==n.locale)return n.originalLocale=e.toLocaleString(),n}return{locale:"en-us",reason:"No supported language found - falling back to en-us",originalLocale:e.toLocaleString()}},r=e=>{const t=s(e);return null!==t.locale?t:{locale:"en-us",reason:"No supported language found - falling back to en-us",originalLocale:e}},s=e=>{const t=e.trim().toLowerCase();let n=d(t);return i.W[n]?(n=i.W[n],{locale:n,reason:"Found in fallback table",originalLocale:e}):l(n)?{locale:n,reason:"Supported language"}:{locale:null,reason:"Didn't find supported language.",originalLocale:e}},l=e=>{const t=e.toLowerCase();for(const e of a.x)if(t===e.toLowerCase())return!0;return!1},d=e=>{const t=(new Date).getTimezoneOffset();return"fr"===e&&t>=120&&t<=420?"fr-ca":e}},486101:(e,t,n)=>{"use strict";n.d(t,{N:()=>l});var i=n(231191),a=n(118824),o=n(519194),r=n(215235),s=n(395816);class l{constructor(e,t,n,i,a,o){this.logsCollectorService=t,this.coreSettings=n,this.hostCommunicationService=i,this.entityCommanding=a,this.i18n=o,this.defaultLogsFilesDownloadDelayIntervalMs=333,this.defaultLogsFileUploadTimer=15e3,this.logger=e.newLogger("LogsFilesService")}downloadLogsFiles(e,t=!0,n){var o,r,s,l;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.showBanner();let d=!0,c=this.defaultLogsFilesDownloadDelayIntervalMs;if(this.coreSettings){const e=this.coreSettings.get(a.J.Diagnostics);d=e.enableLogsFilesDownload||!1,c=e.logsFilesDownloadDelayIntervalMs||this.defaultLogsFilesDownloadDelayIntervalMs}if(!d)return this.logger.error(`Unabled to download logs files - logs files download is not enabled: ${d}`),!1;if(!e)return this.logger.error(`Unabled to download logs files - no host present: ${e}`),!1;const u=this.hostCommunicationService&&n;let m=0;const g=yield this.logsCollectorService.callOnLogsFiles((t=>(0,i.__awaiter)(this,void 0,void 0,(function*(){let a;const o=new Promise((o=>{a=e.setTimeout((()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=u?yield this.uploadLogsFileToVirtualServer(t,e,n,!1):yield this.downloadLogsFile(t,e);o(i)}))),m*c)})).then((t=>(void 0!==a&&e.clearTimeout(a),t)));return m++,o}))),t);if(g){if(u){const e=yield null===(s=this.hostCommunicationService)||void 0===s?void 0:s.loadModule("logscollection");null===(l=null==e?void 0:e.webLogsDownloadCompleted)||void 0===l||l.call(e,{webLogsId:n})}}else{if(u)return null===(r=(o=this.logger).errorToTelemetry)||void 0===r||r.call(o,"Failed to upload all logs files to virtual server","logs_downloading"),this.downloadLogsFiles(e,!0);this.logger.error("Failed to download all logs files")}return g}))}setBannerRelatedServices(e,t){this.entityCommanding=e,this.i18n=t}downloadLogsFile(e,t){let n,i="";try{let a;a="string"==typeof e.content?new Blob([null==e?void 0:e.content],{type:"text/plain;charset=utf-8"}):e.content,i=URL.createObjectURL(a);const o=t.document.createElement("a");o.setAttribute("href",i),o.setAttribute("download",null==e?void 0:e.fileName),o.click(),o.remove(),n=!0}catch(t){this.logger.error(`Failed to download logs file ${null==e?void 0:e.fileName} - error:`,t),n=!1}return i&&URL.revokeObjectURL&&URL.revokeObjectURL(i),Promise.resolve(n)}uploadLogsFileToVirtualServer(e,t,n,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i=!1;try{const o=`${t.location.origin}/desktop/upload/log-collector/${n}/${e.fileName}`,s=t.fetch(o,{method:"PUT",headers:{"Content-Type":"text/plain"},body:e.content}),l=yield(0,r.E)(s,this.defaultLogsFileUploadTimer);l.ok?i=!0:this.logger.error(`Failed to upload logs file to virtual server - ${null==e?void 0:e.fileName}, isRetry - ${a}, status - ${l.statusText}`)}catch(t){this.logger.error(`Failed to upload logs file to virtual server - ${null==e?void 0:e.fileName}, - isRetry- ${a}, - in ${this.defaultLogsFileUploadTimer} ms, - error:`,t)}return i||a?Promise.resolve(i):this.uploadLogsFileToVirtualServer(e,t,n,!0)}))}showBanner(){var e,t;try{this.entityCommanding&&this.i18n&&this.entityCommanding.shell.showBanner({id:"downloading_weblogs",source:o.D.LogsDownloading,bannerScenario:"downloading_Weblogs",intentLevel:s.XuV.Neutral,duration:10,text:this.i18n.stringTranslate("framework","downloading_weblogs")})}catch(n){null===(t=(e=this.logger).errorNoPii)||void 0===t||t.call(e,"Showing downloading logs banner failed")}}}},191538:(e,t,n)=>{"use strict";n.d(t,{o:()=>l});var i=n(843149),a=n(119351),o=n(722474),r=n(929331),s=n(329371);const l=(e,t,n)=>{const{interprocessStoreService:l,loggerFactory:c,platformService:u}=e,m=c.newLogger("WindowUtilities");if(u.config.clientType===s.Bh.Desktop)return l?l.onWindowFullscreen(n).pipe((0,a.b)((e=>m.log(`WindowHook[onFullscreen] update to: ${e}`)))):(m.error("WindowHook[onFullscreen] on desktop failed due to interprocessStoreService missing"),new i.X(!1));{const e=t,n=new i.X(d(e)),a=new e.ResizeObserver((()=>n.next(d(e))));return a.observe(e.document.documentElement),n.pipe((0,o.x)((()=>a.disconnect())),(0,r.x)())}},d=e=>!(!e.matchMedia("(display-mode: fullscreen)").matches&&!e.document.fullscreenElement)},584487:(e,t,n)=>{"use strict";n.d(t,{So:()=>m,dP:()=>g,YR:()=>v});var i=n(329371),a=n(729788),o=n(575082),r=n(843211),s=n(280905),l=n(997665),d=n(843149),c=n(550070),u=n(191538);const m=(e,t)=>{var n,i,a,o;let u;try{u={DOMRect:e.DOMRect,loader:e.loader,loaderConfig:e.loaderConfig,preCoreUiAdapter:e.preCoreUiAdapter,Cypress:e.Cypress,document:e.document,HTMLVideoElement:e.HTMLVideoElement,Element:e.Element,emitDebugEvent:e.emitDebugEvent,external:e.external,location:e.location,history:e.history,navigator:e.navigator,caches:e.caches,crypto:e.crypto,parent:e.parent,self:e.self,top:e.top,performance:e.performance,msCrypto:e.msCrypto&&e.msCrypto,IntersectionObserver:e.IntersectionObserver,ResizeObserver:(0,s.S)(e),WeakRef:e.WeakRef,chunkLoader:new l.t(e.document,e.__experienceWindowChunks__),screen:e.screen,viewportContext:t.viewportContext,chrome:e.chrome,open:e.loader&&e.loader.openWindow?e.loader.openWindow.bind(e.loader):e.open.bind(e),fetch:e.fetch&&e.fetch.bind(e),close:e.close.bind(e),alert:e.alert.bind(e),requestAnimationFrame:e.requestAnimationFrame.bind(e),cancelAnimationFrame:e.cancelAnimationFrame.bind(e),requestIdleCallback:e.requestIdleCallback?e.requestIdleCallback.bind(e):e.requestAnimationFrame.bind(e),cancelIdleCallback:e.cancelIdleCallback?e.cancelIdleCallback.bind(e):e.cancelAnimationFrame.bind(e),setInterval:e.setInterval.bind(e),clearInterval:e.clearInterval.bind(e),clearTimeout:e.clearTimeout.bind(e),setTimeout:e.setTimeout.bind(e),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e),dispatchEvent:e.dispatchEvent.bind(e),focus:e.focus.bind(e),getScreenDetails:()=>e.getScreenDetails?e.getScreenDetails():Promise.resolve(void 0),getSelection:e.getSelection.bind(e),getComputedStyle:e.getComputedStyle.bind(e),onpagehide:null===(n=e.onpagehide)||void 0===n?void 0:n.bind(e),setBounds:e.setBounds,setMinimumSize:e.setMinimumSize,createInterprocessStore:e.createInterprocessStore,Logging:e.Logging,matchMedia:e.matchMedia?e.matchMedia.bind(e):null,proxyPostMessage:(t,n,i)=>{e.proxyPostMessage&&e.proxyPostMessage(t,n,i)},getLocaleInfoAsync:()=>e.getLocaleInfoAsync?e.getLocaleInfoAsync():Promise.resolve(void 0),getUserMedia:t=>{var n,i;return(null===(i=null===(n=e.navigator)||void 0===n?void 0:n.mediaDevices)||void 0===i?void 0:i.getUserMedia)?e.navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("Not available"))},handleGlobalWindowError:null===(i=e.handleGlobalWindowError)||void 0===i?void 0:i.bind(e),decodeURIComponent,encodeURIComponent,getDesktopCapturerSources:t=>e.getDesktopCapturerSources?e.getDesktopCapturerSources(t):Promise.reject(new Error("Not available")),get __experienceWindowChunks__(){return e.__experienceWindowChunks__},get __webpack_nonce__(){return e.__webpack_nonce__},get __VERSION__(){return e.__VERSION__},get __webpack_public_path__(){return e.__webpack_public_path__},get devicePixelRatio(){return e.devicePixelRatio},get localStorage(){return e.localStorage},get sessionStorage(){return e.sessionStorage},get indexedDB(){return e.indexedDB},get CKEDITOR(){return e.CKEDITOR},get ITEMS_VIEW_STRINGS(){return e.ITEMS_VIEW_STRINGS},get CodeMirror(){return e.CodeMirror},get MutationObserver(){return e.MutationObserver},get LivePersonaCardStrings(){return e.LivePersonaCardStrings},get LivePersonaCardHoverTargetV2(){return e.LivePersonaCardHoverTargetV2},get LPC(){return e.LPC},get SlimCore(){return e.SlimCore},get authLogger(){return e.Logging},get Microsoft(){return e.Microsoft},get Office(){return e.Office},get Image(){return e.Image},get DOMParser(){return e.DOMParser},videoRenderer:e.videoRenderer,get FrameSinkReader(){return e.FrameSinkReader},get continueExternalAuth(){return e.continueExternalAuth},set continueExternalAuth(t){e.continueExternalAuth=t},get continueMsaAuth(){return e.continueMsaAuth},set continueMsaAuth(t){e.continueMsaAuth=t},get FabricConfig(){return e.FabricConfig},set FabricConfig(t){e.FabricConfig=t},get CKEDITOR_BASEPATH(){return e.CKEDITOR_BASEPATH},get ClipboardItem(){return e.ClipboardItem},get PerformanceObserver(){return e.PerformanceObserver},get opener(){return t.opener},get envPerformance(){return t.envPerformance},getHostedWindowContext:t.getHostedWindowContext.bind(t),onAppStart:t.onAppStart.bind(t),get isHighResolution(){if(e){const t=1.3,n=e.navigator&&e.navigator.userAgent&&e.navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(void 0!==e.devicePixelRatio&&!n)return e.devicePixelRatio>t;if(e.matchMedia){const t="(-webkit-min-device-pixel-ratio: 1.3),            (min--moz-device-pixel-ratio: 1.3),            (-o-min-device-pixel-ratio: 1.3),            (min-resolution: 120dpi)";return e.matchMedia(t).matches}}return!1},get screenX(){return e.screenX},get screenY(){return e.screenY},get innerWidth(){return e.innerWidth},get innerHeight(){return e.innerHeight},isFocused:()=>e.isFocused?e.isFocused():e.document.hasFocus(),onFullscreen:()=>new d.X(!1),exitFullscreen:()=>{},maximize:()=>{},minimize:()=>{},requestFullscreen:()=>{},show:()=>{},windowTitleDblClick:()=>{},clearCache:()=>{var t;return null===(t=e.clearCache)||void 0===t?void 0:t.call(e)},getZoomFactor:()=>e.getZoomFactor?e.getZoomFactor():0,zoomFactors:null!==(a=e.zoomFactors)&&void 0!==a?a:c.E,zoomIn:()=>e.zoomIn?e.zoomIn():void 0,zoomOut:()=>e.zoomOut?e.zoomOut():void 0,zoomReset:()=>e.zoomReset?e.zoomReset():void 0,vdiSettings:e.vdiSettings,setSelectedAudioOutputDevice:t=>e.setSelectedAudioOutputDevice?e.setSelectedAudioOutputDevice(t):Promise.resolve()}}catch(e){throw new r.G(r.$.CREATE_WINDOW_WRAPPER,e)}e.CKEDITOR_BASEPATH=e.CKEDITOR_BASEPATH||`${e.__webpack_public_path__||(null===(o=null==t?void 0:t.getHostedWindowContext())||void 0===o?void 0:o.__webpack_public_path__)||""}ckeditor/4.15.1-msft-11/`||"";const m=new Proxy(u,{deleteProperty:(t,n)=>delete e[n]});return u.__lpcWindowProxy=m,u};function g(e,t,n,i,a){const{coreSecurityService:o,windowProvider:r}=t,s=e,d=m(s,r),c=v(i,a),g=new l.t(s.document,r.__experienceWindowChunks__);g.configureCoreSecurityService(o);const h={chunkLoader:g,parent:r,viewportContext:c,FabricConfig:{mergeStyles:{namespace:"cw"}},exitFullscreen:()=>p("exitFullscreen",e,t,n),focus:()=>p("focus",e,t,n),maximize:()=>p("maximize",e,t,n),minimize:()=>p("minimize",e,t,n),requestFullscreen:()=>p("requestFullscreen",e,t,n),windowTitleDblClick:()=>p("windowTitleDblClick",e,t,n),onFullscreen:()=>(0,u.o)(t,e,n)};return Object.assign(d,h)}function p(e,t,n,a){const{interprocessStoreService:o,loggerFactory:r,platformService:s}=n,l=r.newLogger("WindowUtilities");if(l.log(`Performing action ${e}`),s.config.clientType===i.Bh.Desktop){if("focus"===e&&(null==t?void 0:t.document.hidden)&&(e="show"),!o)return void l.error(`WindowAction[${e}] on Desktop failed due to interprocessStoreService missing`);o[e](a).then((()=>{l.log(`WindowAction[${e}] on Desktop succeeded.`)})).catch((t=>{l.error(`WindowAction[${e}] on Desktop failed with: ${t&&t.message} (${t&&t.code})`)}))}else{const n=t;switch(e){case"exitFullscreen":n.document.exitFullscreen().catch((t=>{l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;case"requestFullscreen":n.document.documentElement.requestFullscreen().catch((t=>{l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;default:try{n[e]()}catch(t){l.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}}}}function v(e,t){let n;return n=e?t===a.lO.minimal?o.R.flyout:o.R.primary:o.R.secondary,n}},717330:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m,g,p,v,h,f,y,k,S,b,C,w,N,T,I,E,A,_,D,F,M,R,P,O,x,L,U,B,j,W,V,H,$,z,G,q,Q,J,Y,K,Z,X,ee,te,ne,ie,ae,oe,re,se,le,de,ce,ue,me,ge,pe,ve,he,fe,ye,ke,Se,be,Ce,we,Ne,Te,Ie,Ee,Ae,_e,De,Fe,Me,Re,Pe,Oe,xe,Le,Ue,Be,je,We,Ve,He,$e,ze,Ge,qe,Qe,Je,Ye,Ke,Ze,Xe,et,tt,nt;n.d(t,{OX:()=>i,ki:()=>o,Fz:()=>r,YY:()=>l,Z$:()=>d,b1:()=>c,NW:()=>u,fD:()=>m,Qq:()=>g,nh:()=>p,sx:()=>v,jx:()=>h,dW:()=>f,Sg:()=>y,p8:()=>S,$q:()=>b,Qp:()=>w,By:()=>N,DD:()=>T,nc:()=>I,by:()=>E,Fx:()=>A,WN:()=>_,aR:()=>D,cs:()=>F,TQ:()=>P,bo:()=>x,n8:()=>L,x1:()=>B,yb:()=>W,BK:()=>H,nU:()=>$,zk:()=>z,TS:()=>q,rf:()=>Q,Wr:()=>J,Yn:()=>Z,hu:()=>X,m$:()=>te,EZ:()=>ie,Zs:()=>ae,iv:()=>oe,uH:()=>re,UZ:()=>se,nB:()=>ue,L6:()=>me,Yi:()=>ge,Xg:()=>pe,my:()=>ve,cx:()=>he,MK:()=>fe,Es:()=>be,vY:()=>Ce,yT:()=>Ne,Gn:()=>Te,FU:()=>Ae,Um:()=>De,vg:()=>Fe,bp:()=>Be,T6:()=>je,xy:()=>Ve,Jp:()=>qe,eI:()=>Qe,yC:()=>Je,r4:()=>Ye,HO:()=>Ze,fi:()=>Xe,w8:()=>tt,qw:()=>nt}),function(e){e[e.None=0]="None",e[e.Notified=1]="Notified",e[e.Connecting=2]="Connecting",e[e.Connected=3]="Connected",e[e.LocalHold=4]="LocalHold",e[e.RemoteHold=5]="RemoteHold",e[e.Disconnecting=6]="Disconnecting",e[e.Disconnected=7]="Disconnected",e[e.Observing=8]="Observing",e[e.EarlyMedia=9]="EarlyMedia",e[e.InLobby=10]="InLobby",e[e.Preheating=11]="Preheating",e[e.Preheated=12]="Preheated",e[e.Staging=13]="Staging",e[e.NegotiatingEncryption=14]="NegotiatingEncryption",e[e.NegotiatingEncryptionLobby=15]="NegotiatingEncryptionLobby"}(i||(i={})),function(e){e[e.Testing=0]="Testing",e[e.MicrosoftWNS=1]="MicrosoftWNS",e[e.MicrosoftWP7NS=2]="MicrosoftWP7NS",e[e.AppleAPN=3]="AppleAPN",e[e.GoogleAGCM=4]="GoogleAGCM",e[e.Hotmail=5]="Hotmail",e[e.GoogleAC2DM=6]="GoogleAC2DM",e[e.Trouter=7]="Trouter",e[e.Griffin=8]="Griffin",e[e.ADM=9]="ADM",e[e.NNA=10]="NNA"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Started=1]="Started",e[e.Accepted=2]="Accepted",e[e.Completed=3]="Completed",e[e.Failed=4]="Failed"}(o||(o={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Transfer=1]="Transfer",e[e.Park=2]="Park",e[e.TransferToVoicemail=3]="TransferToVoicemail"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Started=1]="Started",e[e.Parking=2]="Parking",e[e.Parked=3]="Parked",e[e.Failed=4]="Failed"}(s||(s={})),function(e){e[e.Team=0]="Team",e[e.SharedLine=1]="SharedLine",e[e.ServerHold=2]="ServerHold",e[e.ServerHoldV2=3]="ServerHoldV2",e[e.SharedLineV2=4]="SharedLineV2"}(l||(l={})),function(e){e[e.Transfer=0]="Transfer",e[e.Park=1]="Park",e[e.TransferToVoicemail=2]="TransferToVoicemail"}(d||(d={})),function(e){e[e.None=0]="None",e[e.Connecting=1]="Connecting",e[e.Ringing=2]="Ringing",e[e.Connected=3]="Connected",e[e.Disconnected=4]="Disconnected",e[e.OnHold=5]="OnHold",e[e.EarlyMedia=6]="EarlyMedia",e[e.InLobby=7]="InLobby",e[e.Staging=8]="Staging",e[e.NegotiatingEncryption=9]="NegotiatingEncryption",e[e.NegotiatingEncryptionLobby=10]="NegotiatingEncryptionLobby"}(c||(c={})),function(e){e[e.None=0]="None",e[e.AddingFailed=1]="AddingFailed",e[e.NoResponse=2]="NoResponse",e[e.Declined=3]="Declined",e[e.NotReachable=4]="NotReachable",e[e.Blocked=5]="Blocked",e[e.NotFriendOrAuthorized=6]="NotFriendOrAuthorized",e[e.CallLimitReached=7]="CallLimitReached",e[e.CallNotFound=8]="CallNotFound",e[e.NetworkError=9]="NetworkError",e[e.MediaDroppedError=10]="MediaDroppedError",e[e.OtherError=11]="OtherError",e[e.PstnInsufficientFunds=12]="PstnInsufficientFunds",e[e.PstnSkypeoutAccountBlocked=13]="PstnSkypeoutAccountBlocked",e[e.PstnCouldNotConnectToSkypeProxy=14]="PstnCouldNotConnectToSkypeProxy",e[e.PstnBlockedByUs=15]="PstnBlockedByUs",e[e.PstnBlockedRegulatoryIndia=16]="PstnBlockedRegulatoryIndia",e[e.PstnInvalidNumber=17]="PstnInvalidNumber",e[e.PstnNumberForbidden=18]="PstnNumberForbidden",e[e.Busy=19]="Busy",e[e.PstnCallTerminated=20]="PstnCallTerminated",e[e.PstnNumberUnavailable=21]="PstnNumberUnavailable",e[e.PstnEmergencyCallDenied=22]="PstnEmergencyCallDenied",e[e.Cancelled=23]="Cancelled",e[e.Dropped=24]="Dropped",e[e.PstnNoSubscriptionCover=25]="PstnNoSubscriptionCover",e[e.PstnCreditExpired=26]="PstnCreditExpired",e[e.PstnCreditExpiredButEnough=27]="PstnCreditExpiredButEnough",e[e.EnterprisePstnInternalError=28]="EnterprisePstnInternalError",e[e.EnterprisePstnUnavailable=29]="EnterprisePstnUnavailable",e[e.EnterprisePstnForbidden=30]="EnterprisePstnForbidden",e[e.EnterprisePstnInvalidNumber=31]="EnterprisePstnInvalidNumber",e[e.EnterprisePstnMiscError=32]="EnterprisePstnMiscError",e[e.Kicked=33]="Kicked",e[e.NetworkRequestTimeoutError=34]="NetworkRequestTimeoutError",e[e.CallDoesNotExist=35]="CallDoesNotExist",e[e.MediaSetupFailure=36]="MediaSetupFailure",e[e.ServiceUnavailable=37]="ServiceUnavailable",e[e.SignalingError=38]="SignalingError",e[e.ConversationEstablishmentFailed=39]="ConversationEstablishmentFailed",e[e.TemporarilyUnavailable=40]="TemporarilyUnavailable",e[e.CannotConnectToNetworkError=41]="CannotConnectToNetworkError",e[e.NoSignalingFromPeer=42]="NoSignalingFromPeer",e[e.ParticipantDoesNotExist=43]="ParticipantDoesNotExist",e[e.DeniedInLobby=44]="DeniedInLobby",e[e.TimedOutInLobby=45]="TimedOutInLobby",e[e.ConfParticipantCountLimitReached=46]="ConfParticipantCountLimitReached",e[e.Abandoned=47]="Abandoned",e[e.ActionNotAllowed=48]="ActionNotAllowed",e[e.ForbiddenDueToPolicy=49]="ForbiddenDueToPolicy",e[e.InsufficientCapabilitiesForCallee=50]="InsufficientCapabilitiesForCallee",e[e.AccessDenied=51]="AccessDenied",e[e.NoPermission=52]="NoPermission",e[e.AnonymousJoinDisabledByPolicy=53]="AnonymousJoinDisabledByPolicy",e[e.NoLobbyForBroadcastJoin=54]="NoLobbyForBroadcastJoin",e[e.NotAllowedDueToInformationBarrier=55]="NotAllowedDueToInformationBarrier",e[e.BroadcastLimitReached=56]="BroadcastLimitReached",e[e.B2bJoinDisabledByPolicy=57]="B2bJoinDisabledByPolicy",e[e.LocationBasedRoutingError=58]="LocationBasedRoutingError",e[e.ConfLobbyParticipantCountLimitReached=59]="ConfLobbyParticipantCountLimitReached",e[e.LobbyUserLeft=60]="LobbyUserLeft"}(u||(u={})),function(e){e[e.Supported=0]="Supported",e[e.BrowserNotSupported=1]="BrowserNotSupported",e[e.IncompatibleVersions=2]="IncompatibleVersions",e[e.Failed=1e3]="Failed",e[e.LazyLoadFailed=1001]="LazyLoadFailed"}(m||(m={})),function(e){e[e.CallSetupFailed=0]="CallSetupFailed",e[e.CallDropped=1]="CallDropped",e[e.Undefined=2]="Undefined"}(g||(g={})),function(e){e[e.Unknown=0]="Unknown",e[e.Good=1]="Good",e[e.Poor=2]="Poor",e[e.Bad=3]="Bad"}(p||(p={})),function(e){e[e.NetworkSendQuality=1]="NetworkSendQuality",e[e.NetworkRecvQuality=2]="NetworkRecvQuality",e[e.NetworkDelay=3]="NetworkDelay",e[e.NetworkBandwidthLow=4]="NetworkBandwidthLow",e[e.NetworkReconnect=5]="NetworkReconnect",e[e.NetworkPacketLoss=6]="NetworkPacketLoss",e[e.NetworkJitter=7]="NetworkJitter",e[e.NetworkRateMatching=8]="NetworkRateMatching",e[e.DeviceCaptureNotFunctioning=9]="DeviceCaptureNotFunctioning",e[e.DeviceRenderNotFunctioning=10]="DeviceRenderNotFunctioning",e[e.DeviceRenderGlitches=11]="DeviceRenderGlitches",e[e.DeviceLowSNR=12]="DeviceLowSNR",e[e.DeviceLowSpeechLevel=13]="DeviceLowSpeechLevel",e[e.DeviceClipping=14]="DeviceClipping",e[e.DeviceEcho=15]="DeviceEcho",e[e.DeviceNearEndToEchoRatio=16]="DeviceNearEndToEchoRatio",e[e.DeviceHalfDuplexAec=17]="DeviceHalfDuplexAec",e[e.DeviceMultipleEndpoints=18]="DeviceMultipleEndpoints",e[e.DeviceHowling=19]="DeviceHowling",e[e.DeviceRenderZeroVolume=20]="DeviceRenderZeroVolume",e[e.DeviceRenderMute=21]="DeviceRenderMute",e[e.NetworkSendCatastrophic=22]="NetworkSendCatastrophic",e[e.NetworkRecvCatastrophic=23]="NetworkRecvCatastrophic",e[e.CpuInsufficient=24]="CpuInsufficient",e[e.DeviceCaptureMute=25]="DeviceCaptureMute",e[e.DeviceCaptureNotMuteButSilent=26]="DeviceCaptureNotMuteButSilent",e[e.DeviceSpeakWhileMuted=27]="DeviceSpeakWhileMuted",e[e.VideoVbssRendered=28]="VideoVbssRendered",e[e.NetworkEthernetInterfaceUsed=29]="NetworkEthernetInterfaceUsed",e[e.NetworkWlanInterfaceUsed=30]="NetworkWlanInterfaceUsed",e[e.NetworkWwanInterfaceUsed=31]="NetworkWwanInterfaceUsed",e[e.NetworkRelaysNotReachable=32]="NetworkRelaysNotReachable",e[e.VideoCapturerDeviceStartFailed=33]="VideoCapturerDeviceStartFailed",e[e.VideoCapturerDeviceStartTimedOut=34]="VideoCapturerDeviceStartTimedOut",e[e.VideoCapturerDeviceStartFailureLackSystemRes=35]="VideoCapturerDeviceStartFailureLackSystemRes",e[e.VideoCapturerDeviceStartFailureMFResConflict=36]="VideoCapturerDeviceStartFailureMFResConflict",e[e.NoNetwork=37]="NoNetwork",e[e.NetworkNotWorking=38]="NetworkNotWorking",e[e.DeviceCaptureNotFunctioningDeviceInUse=39]="DeviceCaptureNotFunctioningDeviceInUse",e[e.DeviceRenderNotFunctioningDeviceInUse=40]="DeviceRenderNotFunctioningDeviceInUse",e[e.DeviceCaptureNotFunctioningAudioSrvNotRunning=41]="DeviceCaptureNotFunctioningAudioSrvNotRunning",e[e.DeviceRenderNotFunctioningAudioSrvNotRunning=42]="DeviceRenderNotFunctioningAudioSrvNotRunning",e[e.ZeroCaptureDevicesEnumerated=43]="ZeroCaptureDevicesEnumerated",e[e.ZeroRenderDevicesEnumerated=44]="ZeroRenderDevicesEnumerated",e[e.VideoCaptureDeviceFreeze=45]="VideoCaptureDeviceFreeze",e[e.AudioCapturePermissionDenied=46]="AudioCapturePermissionDenied",e[e.VideoCapturePermissionDenied=47]="VideoCapturePermissionDenied",e[e.VideoCaptureFreezeRecovered=48]="VideoCaptureFreezeRecovered",e[e.DeviceRenderHowling=49]="DeviceRenderHowling",e[e.LowFarEndInput=50]="LowFarEndInput",e[e.ImageRenderingQuality=51]="ImageRenderingQuality",e[e.RemoteNetworkConnectivityIssue=52]="RemoteNetworkConnectivityIssue",e[e.PresentationAudioLoopbackDeviceState=53]="PresentationAudioLoopbackDeviceState",e[e.AudioCaptureUltrasoundDetected=54]="AudioCaptureUltrasoundDetected",e[e.ScreenshareRecordingDisabled=55]="ScreenshareRecordingDisabled",e[e.MultichannelAudioBandwidth=56]="MultichannelAudioBandwidth",e[e.MusicModeNotAvailable=57]="MusicModeNotAvailable",e[e.MusicModeSupported=58]="MusicModeSupported",e[e.AudioCaptureMusicDetectedWithHighNS=59]="AudioCaptureMusicDetectedWithHighNS",e[e.AudioCaptureMusicDetectedWithLowNS=60]="AudioCaptureMusicDetectedWithLowNS",e[e.CameraLighting=61]="CameraLighting",e[e.DeviceCaptureVoiceActive=62]="DeviceCaptureVoiceActive",e[e.AudioLoopbackDeviceReady=63]="AudioLoopbackDeviceReady",e[e.NoRequiredVideoCodecs=64]="NoRequiredVideoCodecs",e[e.SpatialAudioMUCHUnavailable=65]="SpatialAudioMUCHUnavailable"}(v||(v={})),function(e){e[e.Video=0]="Video",e[e.ScreenSharing=1]="ScreenSharing"}(h||(h={})),function(e){e[e.All=0]="All",e[e.Specified=1]="Specified"}(f||(f={})),function(e){e[e.Incoming=0]="Incoming",e[e.Outgoing=1]="Outgoing",e[e.WarmPush=2]="WarmPush",e[e.MediaInit=3]="MediaInit"}(y||(y={})),function(e){e[e.AllSupported=0]="AllSupported",e[e.NoDirectConnection=1]="NoDirectConnection"}(k||(k={})),function(e){e[e.Stretch=0]="Stretch",e[e.Crop=1]="Crop",e[e.Fit=2]="Fit"}(S||(S={})),function(e){e[e.Unknown=-1]="Unknown",e[e.CaptureError=0]="CaptureError",e[e.RendererFailed=1]="RendererFailed",e[e.RendererFailedGpuContext=2]="RendererFailedGpuContext",e[e.RendererFailedUnavailable=3]="RendererFailedUnavailable"}(b||(b={})),function(e){e[e.Unknown=-1]="Unknown",e[e.VideoElement=0]="VideoElement",e[e.WebGLv1=1]="WebGLv1",e[e.WebGLv2=2]="WebGLv2",e[e.Pepper=3]="Pepper",e[e.ReactNative=4]="ReactNative"}(C||(C={})),function(e){e[e.Unknown=-1]="Unknown",e[e.None=0]="None",e[e.Software=1]="Software",e[e.Hardware=2]="Hardware"}(w||(w={})),function(e){e[e.Default=1]="Default",e[e.Auto=2]="Auto",e[e.Check=4]="Check",e[e.Rect=8]="Rect",e[e.Slider=16]="Slider",e[e.Selection=32]="Selection"}(N||(N={})),function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video",e[e.ScreenShare=2]="ScreenShare",e[e.Data=3]="Data"}(T||(T={})),function(e){e[e.MuteMicrophone=1]="MuteMicrophone",e[e.MuteSpeaker=2]="MuteSpeaker",e[e.MuteAll=3]="MuteAll"}(I||(I={})),function(e){e[e.IsPreheatOnly=1]="IsPreheatOnly"}(E||(E={})),function(e){e[e.CanSupportOverflow=1]="CanSupportOverflow",e[e.CanSupportBreakOutRoom=2]="CanSupportBreakOutRoom",e[e.supportsWeatherPersonPresenter=4]="supportsWeatherPersonPresenter",e[e.allowTrackingInReport=8]="allowTrackingInReport",e[e.supportsParticipantMapping=16]="supportsParticipantMapping",e[e.supportsStreaming=32]="supportsStreaming",e[e.e2eEncryptionEnabled=64]="e2eEncryptionEnabled",e[e.SupportsSharedLineAppearanceV2=128]="SupportsSharedLineAppearanceV2",e[e.supportsMdpAudioRecording=256]="supportsMdpAudioRecording"}(A||(A={})),function(e){e[e.Disabled=0]="Disabled",e[e.ReceiveOnly=1]="ReceiveOnly",e[e.SendOnly=2]="SendOnly",e[e.Inactive=3]="Inactive",e[e.Bidirectional=4]="Bidirectional"}(_||(_={})),function(e){e[e.Succeeded=0]="Succeeded",e[e.ErrorLocalInternal=1]="ErrorLocalInternal",e[e.ErrorRemoteInternal=2]="ErrorRemoteInternal",e[e.OfferNotAcceptable=3]="OfferNotAcceptable",e[e.OfferDeclined=4]="OfferDeclined",e[e.LocalCancel=5]="LocalCancel",e[e.RemoteCancel=6]="RemoteCancel",e[e.FailedNoRetry=7]="FailedNoRetry",e[e.Terminated=8]="Terminated",e[e.GeneralFailure=9]="GeneralFailure"}(D||(D={})),function(e){e[e.AnswerWithAudioOnly=0]="AnswerWithAudioOnly",e[e.AnswerWithAudioVideo=1]="AnswerWithAudioVideo",e[e.AnswerWithScreenshareOnly=2]="AnswerWithScreenshareOnly"}(F||(F={})),function(e){e[e.Receive=0]="Receive",e[e.Send=1]="Send"}(M||(M={})),function(e){e[e.Started=0]="Started",e[e.Inactive=1]="Inactive",e[e.Active=2]="Active",e[e.Stopped=3]="Stopped",e[e.Failed=4]="Failed",e[e.Cancelled=5]="Cancelled"}(R||(R={})),function(e){e[e.Specified=0]="Specified",e[e.Other=1]="Other"}(P||(P={})),function(e){e[e.All=0]="All",e[e.Specified=1]="Specified",e[e.Presenters=2]="Presenters",e[e.Attendees=3]="Attendees"}(O||(O={})),function(e){e[e.None=0]="None",e[e.RequestSent=1]="RequestSent",e[e.WaitingForControlAck=2]="WaitingForControlAck",e[e.RemoteControlling=3]="RemoteControlling",e[e.LocalControlling=4]="LocalControlling",e[e.WaitingForTerminateAck=5]="WaitingForTerminateAck"}(x||(x={})),function(e){e[e.None=0]="None",e[e.SharerDenied=1]="SharerDenied",e[e.SharerNoResponse=2]="SharerNoResponse",e[e.SharerBusy=3]="SharerBusy",e[e.AckTimeout=4]="AckTimeout",e[e.SharerTerminated=5]="SharerTerminated",e[e.ViewerTerminated=6]="ViewerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ViewerCancelled=8]="ViewerCancelled",e[e.SharerControlDisabled=9]="SharerControlDisabled",e[e.UnknownSender=10]="UnknownSender"}(L||(L={})),function(e){e[e.UnRestricted=0]="UnRestricted",e[e.DisableAudio=1]="DisableAudio",e[e.DisableVideo=2]="DisableVideo",e[e.DisableAv=3]="DisableAv",e[e.DisableChat=4]="DisableChat"}(U||(U={})),function(e){e.broadcast="broadcast"}(B||(B={})),function(e){e.ContentOnly="ContentOnly",e.Weatherperson="Weatherperson",e.SideBySide="SideBySide",e.NewsAnchor="NewsAnchor"}(j||(j={})),function(e){e[e.Undefined=0]="Undefined",e[e.Success=1]="Success",e[e.NoNgcEndpoint=2]="NoNgcEndpoint",e[e.NetworkError=3]="NetworkError",e[e.MediaDroppedError=4]="MediaDroppedError",e[e.BadRequest=5]="BadRequest",e[e.CallEstablishmentTimeout=6]="CallEstablishmentTimeout",e[e.CallSetupError=7]="CallSetupError",e[e.NoPermission=8]="NoPermission",e[e.Missed=9]="Missed",e[e.Declined=10]="Declined",e[e.Busy=11]="Busy",e[e.Cancelled=12]="Cancelled",e[e.Dropped=13]="Dropped",e[e.PstnInsufficientFunds=14]="PstnInsufficientFunds",e[e.PstnSkypeoutAccountBlocked=15]="PstnSkypeoutAccountBlocked",e[e.PstnCouldNotConnectToSkypeProxy=16]="PstnCouldNotConnectToSkypeProxy",e[e.PstnBlockedByUs=17]="PstnBlockedByUs",e[e.PstnBlockedRegulatoryIndia=18]="PstnBlockedRegulatoryIndia",e[e.PstnInvalidNumber=19]="PstnInvalidNumber",e[e.PstnNumberForbidden=20]="PstnNumberForbidden",e[e.PstnCallTerminated=21]="PstnCallTerminated",e[e.PstnNumberUnavailable=22]="PstnNumberUnavailable",e[e.PstnEmergencyCallDenied=23]="PstnEmergencyCallDenied",e[e.CallNotFound=24]="CallNotFound",e[e.LocalError=25]="LocalError",e[e.NotAcceptableHere=26]="NotAcceptableHere",e[e.CallForwarded=27]="CallForwarded",e[e.CallForwardedToVoicemail=28]="CallForwardedToVoicemail",e[e.SkypeTokenError=29]="SkypeTokenError",e[e.CallAccepted=30]="CallAccepted",e[e.LocalHttpStackError=31]="LocalHttpStackError",e[e.UnknownError=32]="UnknownError",e[e.PstnNoSubscriptionCover=33]="PstnNoSubscriptionCover",e[e.SessionNotFound=34]="SessionNotFound",e[e.SessionTimedOut=35]="SessionTimedOut",e[e.PstnCreditExpired=36]="PstnCreditExpired",e[e.PstnCreditExpiredButEnough=37]="PstnCreditExpiredButEnough",e[e.RetargetNotSupported=38]="RetargetNotSupported",e[e.EnterprisePstnInternalError=39]="EnterprisePstnInternalError",e[e.EnterprisePstnUnavailable=40]="EnterprisePstnUnavailable",e[e.EnterprisePstnForbidden=41]="EnterprisePstnForbidden",e[e.EnterprisePstnInvalidNumber=42]="EnterprisePstnInvalidNumber",e[e.EnterprisePstnMiscError=43]="EnterprisePstnMiscError",e[e.Kicked=44]="Kicked",e[e.NetworkRequestTimeoutError=45]="NetworkRequestTimeoutError",e[e.CallDoesNotExist=46]="CallDoesNotExist",e[e.MediaSetupFailure=47]="MediaSetupFailure",e[e.ServiceUnavailable=48]="ServiceUnavailable",e[e.SignalingError=49]="SignalingError",e[e.ConversationEstablishmentFailed=50]="ConversationEstablishmentFailed",e[e.TemporarilyUnavailable=51]="TemporarilyUnavailable",e[e.CannotConnectToNetworkError=52]="CannotConnectToNetworkError",e[e.MediaRelayWhiteListingIssue=53]="MediaRelayWhiteListingIssue",e[e.NoSignalingFromPeer=54]="NoSignalingFromPeer",e[e.DeniedInLobby=55]="DeniedInLobby",e[e.TimedOutInLobby=56]="TimedOutInLobby",e[e.CallFailedConflict=57]="CallFailedConflict",e[e.DevicePermissionDenied=58]="DevicePermissionDenied",e[e.ConfParticipantCountLimitReached=59]="ConfParticipantCountLimitReached",e[e.ActionNotAllowed=60]="ActionNotAllowed",e[e.Abandoned=61]="Abandoned",e[e.ForbiddenDueToPolicy=62]="ForbiddenDueToPolicy",e[e.InsufficientCapabilitiesForCallee=63]="InsufficientCapabilitiesForCallee",e[e.UserBlocked=64]="UserBlocked",e[e.AccessDenied=65]="AccessDenied",e[e.AnonymousJoinDisabledByPolicy=66]="AnonymousJoinDisabledByPolicy",e[e.NoLobbyForBroadcastJoin=67]="NoLobbyForBroadcastJoin",e[e.NotAllowedDueToInformationBarrier=68]="NotAllowedDueToInformationBarrier",e[e.BroadcastLimitReached=69]="BroadcastLimitReached",e[e.TeamParkPolicyDisabled=70]="TeamParkPolicyDisabled",e[e.B2bJoinDisabledByPolicy=71]="B2bJoinDisabledByPolicy",e[e.LocationBasedRoutingError=72]="LocationBasedRoutingError",e[e.ConfLobbyParticipantCountLimitReached=73]="ConfLobbyParticipantCountLimitReached",e[e.DowngradeToStreamingClient=74]="DowngradeToStreamingClient",e[e.CallRedirected=75]="CallRedirected"}(W||(W={})),function(e){e[e.Num0=0]="Num0",e[e.Num1=1]="Num1",e[e.Num2=2]="Num2",e[e.Num3=3]="Num3",e[e.Num4=4]="Num4",e[e.Num5=5]="Num5",e[e.Num6=6]="Num6",e[e.Num7=7]="Num7",e[e.Num8=8]="Num8",e[e.Num9=9]="Num9",e[e.Star=10]="Star",e[e.Pound=11]="Pound",e[e.A=12]="A",e[e.B=13]="B",e[e.C=14]="C",e[e.D=15]="D",e[e.Flash=16]="Flash"}(V||(V={})),function(e){e[e.ConsumerTwoParty=0]="ConsumerTwoParty",e[e.ConsumerPstn=1]="ConsumerPstn",e[e.ConsumerMultiParty=2]="ConsumerMultiParty",e[e.EnterpriseTwoPartyOnlineOnly=3]="EnterpriseTwoPartyOnlineOnly",e[e.EnterpriseTwoPartyHybrid=4]="EnterpriseTwoPartyHybrid",e[e.EnterpriseMultiParty=5]="EnterpriseMultiParty",e[e.EnterprisePstnOnlineOnly=6]="EnterprisePstnOnlineOnly",e[e.EnterprisePstnHybrid=7]="EnterprisePstnHybrid",e[e.EnterpriseFederated=8]="EnterpriseFederated",e[e.EnterpriseUnknown=9]="EnterpriseUnknown",e[e.EnterpriseMultiPartyBroadcasting=10]="EnterpriseMultiPartyBroadcasting"}(H||(H={})),function(e){e.Default="Default",e.LongrangeSpeaker="LongrangeSpeaker",e.Auditorium="Auditorium"}($||($={})),function(e){e.Off="Off",e.Auto="Auto",e.Low="Low",e.High="High",e.Medium="Medium"}(z||(z={})),function(e){e.Default="Default",e.NoiseSuppression="NoiseSuppression",e.SpeechRecognition="SpeechRecognition",e.Recording="Recording"}(G||(G={})),function(e){e.HighNoiseSuppression="HighNoiseSuppression",e.PersonalNoiseSuppression="PersonalNoiseSuppression"}(q||(q={})),function(e){e[e.Unknown=-1]="Unknown",e[e.P2P=1]="P2P",e[e.Conference=2]="Conference"}(Q||(Q={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Private=1]="Private",e[e.Channel=2]="Channel"}(J||(J={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(Y||(Y={})),function(e){e[e.Off=0]="Off",e[e.NoiseSuppressionDeep=1]="NoiseSuppressionDeep",e[e.NoiseSuppressionClassic=2]="NoiseSuppressionClassic"}(K||(K={})),function(e){e[e.Off=0]="Off",e[e.BackgroundBlurDefault=1]="BackgroundBlurDefault",e[e.BackgroundBlurLight=2]="BackgroundBlurLight",e[e.BackgroundBlurExperimental_1=4]="BackgroundBlurExperimental_1",e[e.BackgroundBlurExperimental_2=8]="BackgroundBlurExperimental_2",e[e.BackgroundReplacement=16]="BackgroundReplacement",e[e.WhiteboardZoom=32]="WhiteboardZoom",e[e.WhiteboardCleanup=64]="WhiteboardCleanup",e[e.WhiteboardMotionDetection=128]="WhiteboardMotionDetection",e[e.WhiteboardZoomAndCleanup=96]="WhiteboardZoomAndCleanup",e[e.WhiteboardCleanupAndMotion=192]="WhiteboardCleanupAndMotion",e[e.WhiteboardZoomAndCleanupAndMotion=224]="WhiteboardZoomAndCleanupAndMotion"}(Z||(Z={})),function(e){e.onVideoEffectQualityChanged="onVideoEffectQualityChanged"}(X||(X={})),function(e){e[e.R360P=0]="R360P",e[e.R480P=1]="R480P",e[e.R540P=2]="R540P",e[e.R720P=3]="R720P",e[e.R1080P=4]="R1080P"}(ee||(ee={})),function(e){e[e.NV12=0]="NV12",e[e.RGB=1]="RGB",e[e.RGBA=2]="RGBA",e[e.BGR=3]="BGR",e[e.ABGR=4]="ABGR"}(te||(te={})),function(e){e[e.BadNotificationPayload=0]="BadNotificationPayload",e[e.CallSetupSucceeded=1]="CallSetupSucceeded",e[e.CallSetupFailed=2]="CallSetupFailed",e[e.BadNotificationEventType=3]="BadNotificationEventType",e[e.CallAlreadyExists=4]="CallAlreadyExists",e[e.CallFailedCannotConnect=5]="CallFailedCannotConnect",e[e.CallFailedNoSignaling=6]="CallFailedNoSignaling",e[e.CallFailedConflict=7]="CallFailedConflict",e[e.CallFailedPushIgnored=8]="CallFailedPushIgnored",e[e.CallFailedAnsweredElsewhere=9]="CallFailedAnsweredElsewhere",e[e.CallFailedCallAlreadyEnded=10]="CallFailedCallAlreadyEnded",e[e.CallSetupInProgress=11]="CallSetupInProgress"}(ne||(ne={})),function(e){e[e.Ok=0]="Ok",e[e.Started=1]="Started",e[e.Stopped=2]="Stopped",e[e.Error=3]="Error",e[e.WindowMinimized=4]="WindowMinimized",e[e.WindowRestored=5]="WindowRestored",e[e.WindowFullyOccluded=6]="WindowFullyOccluded",e[e.WindowExposed=7]="WindowExposed",e[e.WindowClosed=8]="WindowClosed",e[e.PPTPresenterView_Enter=9]="PPTPresenterView_Enter",e[e.PPTPresenterView_Exit=10]="PPTPresenterView_Exit",e[e.WindowInPriviledgedProcess=11]="WindowInPriviledgedProcess",e[e.OcclusionRemovalDisabled=12]="OcclusionRemovalDisabled",e[e.FrameCount=13]="FrameCount",e[e.Resolution=14]="Resolution"}(ie||(ie={})),function(e){e[e.None=0]="None",e[e.Ringing=1]="Ringing",e[e.Connecting=2]="Connecting",e[e.Connected=3]="Connected",e[e.Disconnected=4]="Disconnected"}(ae||(ae={})),function(e){e[e.Skype=1]="Skype",e[e.Pop=2]="Pop"}(oe||(oe={})),function(e){e.Resurrect="resurrect",e.DoNotResurrect="doNotResurrect"}(re||(re={})),function(e){e[e.NoLocationInfo=0]="NoLocationInfo",e[e.LocationContent=1]="LocationContent",e[e.NetworkContent=2]="NetworkContent",e[e.AreaContent=3]="AreaContent"}(se||(se={})),function(e){e[e.All=1]="All"}(le||(le={})),function(e){e.Mri="mri"}(de||(de={})),function(e){e.Default="default",e.Voicemail="voicemail"}(ce||(ce={})),function(e){e[e.VbssRendered=0]="VbssRendered"}(ue||(ue={})),function(e){e[e.None=0]="None",e[e.RealTime=1]="RealTime",e[e.Streaming=2]="Streaming"}(me||(me={})),function(e){e[e.Camera=1]="Camera",e[e.Microphone=2]="Microphone",e[e.Speaker=3]="Speaker",e[e.CompositeAudioDevice=4]="CompositeAudioDevice",e[e.ChildVideoDevice=5]="ChildVideoDevice",e[e.CompositeVideoDevice=6]="CompositeVideoDevice"}(ge||(ge={})),function(e){e[e.Unknown=0]="Unknown",e[e.Front=1]="Front",e[e.Back=2]="Back",e[e.External=3]="External",e[e.LeftFront=4]="LeftFront",e[e.RightFront=5]="RightFront",e[e.Panoramic=6]="Panoramic",e[e.Participant=7]="Participant"}(pe||(pe={})),function(e){e[e.Monitor=1]="Monitor",e[e.Window=2]="Window",e[e.Camera=3]="Camera"}(ve||(ve={})),function(e){e[e.Unknown=0]="Unknown",e[e.USB=1]="USB",e[e.PCI=2]="PCI",e[e.HDAudio=3]="HDAudio",e[e.Bluetooth=4]="Bluetooth",e[e.XBOX_Kinect=5]="XBOX_Kinect",e[e.Virtual=6]="Virtual",e[e.Internal=7]="Internal",e[e.External=8]="External"}(he||(he={})),function(e){e[e.Unknown=0]="Unknown",e[e.Speakers=1]="Speakers",e[e.Headphones=2]="Headphones",e[e.Headset=3]="Headset",e[e.Handset=4]="Handset",e[e.Speakerphone=5]="Speakerphone"}(fe||(fe={})),function(e){e.Granted="granted",e.Denied="denied",e.Prompt="prompt",e.Unknown="unknown"}(ye||(ye={})),function(e){e.Microphone="microphone",e.Camera="camera"}(ke||(ke={})),function(e){e[e.None=0]="None",e[e.AutoGainControl=1]="AutoGainControl",e[e.EchoCancellation=2]="EchoCancellation",e[e.NoiseSuppression=4]="NoiseSuppression"}(Se||(Se={})),function(e){e[e.CallTypeGroup=0]="CallTypeGroup",e[e.CallTypeS2s=1]="CallTypeS2s",e[e.CallTypePstn=2]="CallTypePstn",e[e.CallTypeMeeting=3]="CallTypeMeeting"}(be||(be={})),function(e){e[e.ContextCallStart=0]="ContextCallStart",e[e.ContextSelectedDeviceChangedFromUI=1]="ContextSelectedDeviceChangedFromUI",e[e.ContextSelectedDeviceChangedFromHid=2]="ContextSelectedDeviceChangedFromHid",e[e.ContextPairedBTDeviceUpdated=3]="ContextPairedBTDeviceUpdated",e[e.ContextPeriodicSelectedDeviceData=4]="ContextPeriodicSelectedDeviceData",e[e.ContextInvalidContext=5]="ContextInvalidContext"}(Ce||(Ce={})),function(e){e[e.VeryBad=0]="VeryBad",e[e.Bad=1]="Bad",e[e.Average=2]="Average",e[e.Good=3]="Good",e[e.VeryGood=4]="VeryGood",e[e.NotApplicable=5]="NotApplicable"}(we||(we={})),function(e){e.Zero="Zero",e.Basic="Basic",e.Full="Full"}(Ne||(Ne={})),function(e){e[e.Amp=0]="Amp",e[e.Hls=1]="Hls"}(Te||(Te={})),function(e){e.Townhall="Townhall",e.Overflow="Overflow",e.TLE="TLE"}(Ie||(Ie={})),function(e){e.LoadStart="LoadStart",e.LoadedData="LoadedData",e.LoadedMetadata="LoadedMetadata",e.Start="Start",e.Ready="Ready",e.Play="Play",e.Resume="Resume",e.Playing="Playing",e.Paused="Paused",e.Buffering="Buffering",e.Seeking="Seeking",e.Seeked="Seeked",e.Ended="Ended",e.Error="Error",e.Destroyed="Destroyed",e.Initialized="Initialized"}(Ee||(Ee={})),function(e){e.UnsupportedPlatform="UnsupportedPlatform",e.NetworkError="NetworkError",e.PlaybackRetried="PlaybackRetried",e.PlaybackError="PlaybackError",e.Unknown="Unknown"}(Ae||(Ae={})),function(e){e.media="media",e.signaling="signaling",e.rootTools="rootTools"}(_e||(_e={})),function(e){e[e.SourceAndSink=0]="SourceAndSink",e[e.Source=1]="Source",e[e.Sink=2]="Sink"}(De||(De={})),function(e){e[e.Disabled=0]="Disabled",e[e.Detection=1]="Detection",e[e.Pointer=2]="Pointer",e[e.Control=3]="Control"}(Fe||(Fe={})),function(e){e[e.MouseClick=0]="MouseClick",e[e.MouseEntering=1]="MouseEntering",e[e.MouseLeaving=2]="MouseLeaving"}(Me||(Me={})),function(e){e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e[e.Clipboard_Text=2]="Clipboard_Text",e[e.StopSending=3]="StopSending",e[e.Reserved=255]="Reserved"}(Re||(Re={})),function(e){e[e.Move=0]="Move",e[e.Wheel=1]="Wheel",e[e.Button=2]="Button"}(Pe||(Pe={})),function(e){e[e.Button1=0]="Button1",e[e.Button2=1]="Button2",e[e.Button3=2]="Button3",e[e.XButton1=3]="XButton1",e[e.XButton2=4]="XButton2",e[e.XButton3=5]="XButton3"}(Oe||(Oe={})),function(e){e[e.ScanCode=0]="ScanCode",e[e.VirtualKey=1]="VirtualKey",e[e.NonKbdInput=2]="NonKbdInput",e[e.Invalid=3]="Invalid"}(xe||(xe={})),function(e){e[e.Success=0]="Success",e[e.Error=-1]="Error",e[e.E_Disabled=-2]="E_Disabled",e[e.E_AvatarNotSet=-3]="E_AvatarNotSet",e[e.E_InvalidData=-4]="E_InvalidData",e[e.E_InvalidPointer=-5]="E_InvalidPointer",e[e.E_CtrlNotAllowed=-6]="E_CtrlNotAllowed",e[e.E_InjectMouse=-7]="E_InjectMouse",e[e.E_InjectKeyboard=-8]="E_InjectKeyboard",e[e.E_InjectClipboard=-9]="E_InjectClipboard",e[e.E_PermissionDenied=-10]="E_PermissionDenied"}(Le||(Le={})),function(e){e[e.ScreenSharingControl=0]="ScreenSharingControl",e[e.Adapter=1]="Adapter",e[e.PTZSessionControl=2]="PTZSessionControl"}(Ue||(Ue={})),function(e){e[e.None=0]="None",e[e.Attendee=1]="Attendee",e[e.Presenter=2]="Presenter"}(Be||(Be={})),function(e){e[e.None=0]="None",e[e.Connecting=1]="Connecting",e[e.Ringing=2]="Ringing",e[e.Presenting=3]="Presenting",e[e.Connected=4]="Connected",e[e.Viewing=5]="Viewing",e[e.Finishing=6]="Finishing",e[e.Done=7]="Done",e[e.Failed=8]="Failed"}(je||(je={})),function(e){e[e.Unknown=0]="Unknown",e[e.Available=1]="Available",e[e.Starting=2]="Starting",e[e.Active=3]="Active",e[e.Stopping=4]="Stopping",e[e.NotStarted=5]="NotStarted"}(We||(We={})),function(e){e[e.Unknown=0]="Unknown",e[e.Sharer=1]="Sharer",e[e.Viewer=2]="Viewer"}(Ve||(Ve={})),function(e){e[e.Unknown=0]="Unknown",e[e.Sending=1]="Sending",e[e.Resending=2]="Resending",e[e.Acking=3]="Acking",e[e.Dropping=4]="Dropping",e[e.Succeeded=5]="Succeeded",e[e.Terminated=6]="Terminated",e[e.Rejecting=7]="Rejecting"}(He||(He={})),function(e){e[e.Unknown=0]="Unknown",e[e.Succeeded=1]="Succeeded",e[e.Shutdown=2]="Shutdown",e[e.DataChannel=3]="DataChannel",e[e.Replaced=4]="Replaced",e[e.TimedOut=5]="TimedOut",e[e.UnknownSender=6]="UnknownSender",e[e.SharerDenied=7]="SharerDenied"}($e||($e={})),function(e){e[e.SetInjectorConfigError=0]="SetInjectorConfigError",e[e.InjectRawInputError=1]="InjectRawInputError",e[e.SetInjectionRectError=2]="SetInjectionRectError",e[e.AllowSingleControllerError=3]="AllowSingleControllerError",e[e.AvailableAckTimeout=4]="AvailableAckTimeout",e[e.SendDataError=5]="SendDataError",e[e.DataChannelInactive=6]="DataChannelInactive"}(ze||(ze={})),function(e){e[e.SetInjectionFailed=0]="SetInjectionFailed",e[e.DisabledDWM=1]="DisabledDWM"}(Ge||(Ge={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Initialized=1]="Initialized",e[e.Failed=2]="Failed",e[e.Uninitialized=3]="Uninitialized"}(qe||(qe={})),function(e){e.None="none",e.All="all"}(Qe||(Qe={})),function(e){e.RaiseHands="raiseHands",e.UFD="ufd",e.AttendeeModalitiesUnrestricted="attendeeModalitiesUnrestricted",e.AttendeeAudioRestricted="attendeeAudioRestricted",e.AttendeeVideoRestricted="attendeeVideoRestricted",e.AttendeeVideoUnrestricted="attendeeVideoUnrestricted",e.Spotlight="spotlight",e.WeatherPerson="weatherPerson",e.SharingLayoutType="sharingLayoutType",e.ManageBreakoutRooms="manageBreakoutRooms",e.TogetherMode="togetherMode"}(Je||(Je={})),function(e){e.User="user",e.Endpoint="endpoint"}(Ye||(Ye={})),function(e){e[e.Unknown=0]="Unknown",e[e.Controllee=1]="Controllee",e[e.Controller=2]="Controller"}(Ke||(Ke={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(Ze||(Ze={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(Xe||(Xe={})),function(e){e[e.Reset=1]="Reset",e[e.ZoomIn=2]="ZoomIn",e[e.ZoomOut=4]="ZoomOut",e[e.PanLeft=8]="PanLeft",e[e.PanRight=16]="PanRight",e[e.TiltUp=32]="TiltUp",e[e.TiltDown=64]="TiltDown"}(et||(et={})),function(e){e[e.Available=0]="Available",e[e.Error=1]="Error",e[e.Reset=2]="Reset",e[e.ZoomIn=4]="ZoomIn",e[e.ZoomOut=8]="ZoomOut",e[e.PanLeft=16]="PanLeft",e[e.PanRight=32]="PanRight",e[e.TiltUp=64]="TiltUp",e[e.TiltDown=128]="TiltDown"}(tt||(tt={})),function(e){e[e.None=0]="None",e[e.Optical=1]="Optical",e[e.Digital=2]="Digital"}(nt||(nt={}))},757185:(e,t,n)=>{"use strict";n.d(t,{XD:()=>r,jW:()=>s,F$:()=>l,OB:()=>d,bF:()=>c});var i=n(231191),a=n(395816),o=n(264091);const r=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{data:t}=yield e.query({query:o.i8});return null==t?void 0:t.activeWindows})),s=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield r(e);return null==t?void 0:t.find((e=>e.isMainWindow&&e.layoutConfig.layoutMode===a.lOW.standard))})),l=e=>{try{const t=e.readQuery({query:o.i8});return null==t?void 0:t.activeWindows}catch(e){return}},d=e=>e.watchQuery({query:o.i8}),c=(e,t)=>{try{return e.writeQuery({query:o.i8,data:{activeWindows:t}}),!0}catch(e){return!1}}},594178:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataActiveWindowsSaveReactiveVarsToHistoryMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveReactiveVarsToHistory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}}},{kind:"Argument",name:{kind:"Name",value:"appIds"},value:{kind:"Variable",name:{kind:"Name",value:"appIds"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},264091:(e,t,n)=>{"use strict";n.d(t,{i8:()=>c});const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowOptions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}},{kind:"Field",name:{kind:"Name",value:"options"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"}}]}},{kind:"Field",name:{kind:"Name",value:"linkedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_linkedEntity"}}]}},{kind:"Field",name:{kind:"Name",value:"entityState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"flushableByLinkedEntity"}}]}}]}},...i.definitions,{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_linkedEntity"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LinkedEntity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_coreViewState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CoreViewState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"slotsConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotsConfig"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotsConfig"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SlotsConfig"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contextualNotificationsSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"endSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"headerSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"mainSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"navSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"notificationsSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"startSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"subNavSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"titleBarSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"toastsSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}},{kind:"Field",name:{kind:"Name",value:"configurationsSlotConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_slotConfig"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SlotConfig"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appRenderMode"}},{kind:"Field",name:{kind:"Name",value:"slotName"}},{kind:"Field",name:{kind:"Name",value:"viewEntityName"}},{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"appId"}}]}},...a.definitions]}.definitions]}.definitions]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_window"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"clientLaunchId"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedEntityContainerState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"containerState"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}}]}},{kind:"Field",name:{kind:"Name",value:"blockingEntityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"blockedCommand"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibilityState"}},{kind:"Field",name:{kind:"Name",value:"stateTransition"}},{kind:"Field",name:{kind:"Name",value:"correlation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"startTimestamp"}},{kind:"Field",name:{kind:"Name",value:"source"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"blockedEntityOptions"}}]}},{kind:"Field",name:{kind:"Name",value:"isMainWindow"}},{kind:"Field",name:{kind:"Name",value:"isInitialWindowStateHidden"}},{kind:"Field",name:{kind:"Name",value:"userContextId"}},{kind:"Field",name:{kind:"Name",value:"coreViewState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_coreViewState"}}]}},{kind:"Field",name:{kind:"Name",value:"layoutConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"layoutMode"}},{kind:"Field",name:{kind:"Name",value:"isFullscreen"}},{kind:"Field",name:{kind:"Name",value:"slots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"header"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"subNav"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"contextualNotifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"end"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"nav"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"main"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"start"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"titleBar"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"toasts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}},{kind:"Field",name:{kind:"Name",value:"notifications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}}]}}]}}]}},...a.definitions,...o.definitions]},s={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActiveEntities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subNavEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"headerEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"startEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"mainEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"endEntity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}},{kind:"Field",name:{kind:"Name",value:"entityExtension"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}}]}},...a.definitions]},l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"reactiveVars"}}]}},...s.definitions]},d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"windowHistoryNavigationState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canNavigateBack"}},{kind:"Field",name:{kind:"Name",value:"canNavigateForward"}},{kind:"Field",name:{kind:"Name",value:"backHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"}}]}},{kind:"Field",name:{kind:"Name",value:"forwardHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WindowHistoryNavigationItem"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"windowHistoryIndex"}},{kind:"Field",name:{kind:"Name",value:"entity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_entity"}}]}}]}},...a.definitions]}.definitions]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataActiveWindowsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeWindows"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeWindows"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeWindows"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Window"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"windowOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowOptions"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_window"}},{kind:"Field",name:{kind:"Name",value:"activeEntities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_activeEntities"}}]}},{kind:"Field",name:{kind:"Name",value:"windowHistory"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryItem"}}]}},{kind:"Field",name:{kind:"Name",value:"currentWindowHistoryIndex"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataActiveWindowsFragment_windowHistoryNavigationState"}}]}},...i.definitions,...r.definitions,...s.definitions,...l.definitions,...d.definitions]}.definitions]}},593656:(e,t,n)=>{"use strict";n.d(t,{x:()=>b});var i,a=n(231191),o=n(892891);!function(e){e.Info="Info",e.Warning="Warning",e.Error="Error",e.Debug="Debug"}(i||(i={}));var r=n(729788),s=n(519194),l=n(118824),d=n(395816),c=n(9522);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationUserQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"defaultName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}},{kind:"Argument",name:{kind:"Name",value:"defaultName"},value:{kind:"Variable",name:{kind:"Name",value:"defaultName"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}}]}}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationGetUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriOrEmailArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"emailForQuery"}}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationPresenceSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"lastSeenAt"}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationPresencesQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userPresenceRequestArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPresenceRequest"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presences"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userPresenceRequestArray"},value:{kind:"Variable",name:{kind:"Name",value:"userPresenceRequestArray"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"lastSeenAt"}}]}}]}}]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationFireCallingIntentMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataOfficeIntegrationUserCallingSettingsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userCallingSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isCallingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isPstnCallingAllowed"}}]}}]}}]};var f,y;!function(e){e[e.UnInitialized=0]="UnInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(f||(f={})),function(e){e.FreDialogDisplayedKey="office-integration-fre-dialog-displayed",e.HasManuallyUnregisteredIMProviderKey="office-integration-has-manually-unregistered"}(y||(y={}));const k="sip:",S=new Map([["InACall","OnThePhone"],["InAConferenceCall","InAMeeting"],["InAMeeting","InAMeeting"],["Presenting","Presenting"],["OffWork","Offline"],["Available","Online"],["Inactive","Idle"],["Busy","Busy"],["DoNotDisturb","Focusing"],["BeRightBack","BeRightBack"],["Away","Away"],["Offline","Offline"],["UrgentInterruptionsOnly","Focusing"],["PresenceUnknown","Unknown"],["OutOfOffice","OutOfOffice"]]);class b{static Instance(e,t,n,i,a,o,r,s){return b.instance||(b.instance=new b(e,t,n,i,a,o,r,s)),b.instance}static defaultInstance(){return b.instance}constructor(e,t,n,i,a,o,l,c){this.hostCommunicationService=e,this.coreSettings=t,this.client=n,this.entityCommanding=a,this.windowProvider=o,this.localStorage=l,this.authenticationUser=c,this.initializedState=f.UnInitialized,this.unsubscribers=[],this.entityCommand={stateTransition:r.su.none,visibilityState:r.fe.show,correlation:{source:s.D.OfficeIntegration}},this.presenceSubscriptionMap=new Map,this.uriToMriCacheMap=new Map,this.selfMri="",this.selfActivity=d.cS$.PresenceUnknown,this.logger=i.newLogger("OfficeIntegration")}initialize(){var e,t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(l.J.People).enableOfficeIntegration)return!1;if(this.initializedState!==f.UnInitialized)return!1;this.initializedState=f.Initializing;const n=yield this.hostCommunicationService.loadModule("officeintegration");if(n){const{isRegistered:a,isAdminAccessRequired:o,isUacEnabled:r}=(yield null===(e=n.isRegisteredIMProvider)||void 0===e?void 0:e.call(n))||{};if(this.logger.log(`initialize isRegistered ${a} isAdminAccessRequired ${o} isUacEnabled ${r}`),a)return this.startService(n);if(o&&r)this.startOfficeIntegrationFREDialog();else if(o||this.isLocalStoragePropertySet(y.HasManuallyUnregisteredIMProviderKey)){const e=`Failed to register due to isAdminAccessRequired ${o} isUacEnabled \n          ${r} HasManuallyUnregisteredIMProviderKey ${this.isLocalStoragePropertySet(y.HasManuallyUnregisteredIMProviderKey)}`;this.handleLogToTelemetry(e,"office_integration_register_im_provider",i.Warning)}else{const e=yield null===(t=n.registerIMProvider)||void 0===t?void 0:t.call(n,!1,!!r);if(0===e)return this.startService(n);{const t=`Failed to register during silent registration with result ${e}`;this.handleLogToTelemetry(t,"office_integration_register_im_provider",i.Warning,{errorCode:null==e?void 0:e.toString(16)})}}return!1}return!1}))}finalize(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(!this.coreSettings.get(l.J.People).enableOfficeIntegration)return!1;if(this.initializedState!==f.Initializing)return!1;const t=yield this.hostCommunicationService.loadModule("officeintegration");if(t){const{isRegistered:n}=(yield null===(e=t.isRegisteredIMProvider)||void 0===e?void 0:e.call(t))||{};if(n)return this.startService(t);const a="finalize is called without IM provider registered";return this.handleLogToTelemetry(a,"office_integration_fre_register_finalize_failed",i.Warning),!1}return!1}))}shutdown(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.initializedState!==f.Initialized)return!1;this.initializedState=f.UnInitialized,this.unsubscribers.forEach((e=>e()));const t=yield this.hostCommunicationService.loadModule("officeintegration");if(t){return!!(null===(e=t.stopComServer)||void 0===e?void 0:e.call(t))}return!1}))}isRegisteredIMProvider(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("officeintegration");return null===(e=null==t?void 0:t.isRegisteredIMProvider)||void 0===e?void 0:e.call(t)}))}registerIMProvider(e,t,n){var o;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const a=yield this.hostCommunicationService.loadModule("officeintegration");if(a){const r=yield null===(o=a.registerIMProvider)||void 0===o?void 0:o.call(a,e,t),s=`registerIMProvider result ${r} from ${n}. isAdminAccessRequired ${e} isUacEnabled ${t}`;return this.handleLogToTelemetry(s,"office_integration_register_im_provider",i.Info,{errorCode:null==r?void 0:r.toString(16)}),0===r}return!1}))}unregisterIMProvider(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("officeintegration");if(n){const a=yield null===(t=n.unregisterIMProvider)||void 0===t?void 0:t.call(n),o=`unregisterIMProvider result ${a} from ${e}`;return this.handleLogToTelemetry(o,"office_integration_unregister_im_provider",i.Info,{errorCode:null==a?void 0:a.toString(16)}),0===a}return!1}))}toggleIMProvider(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{isRegistered:t,isAdminAccessRequired:n,isUacEnabled:i}=(yield this.isRegisteredIMProvider())||{};if(t){this.setLocalStorageProperty(y.HasManuallyUnregisteredIMProviderKey,"true");const t=yield this.unregisterIMProvider(e);return yield this.waitForRegistryUpdate(),t}if(yield this.registerIMProvider(!!n,!!i,e)){const e=yield this.hostCommunicationService.loadModule("officeintegration");return!!e&&(this.startService(e),yield this.waitForRegistryUpdate(),!0)}return!1}))}waitForRegistryUpdate(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){let e;yield new Promise((t=>{e=this.windowProvider.setTimeout(t,250)})),this.windowProvider.clearTimeout(e)}))}isLocalStoragePropertySet(e){var t;return"true"===(null===(t=this.localStorage)||void 0===t?void 0:t.get(e))}setLocalStorageProperty(e,t){var n;null===(n=this.localStorage)||void 0===n||n.set(e,t)}startService(e){var t,n,i,o,r,s,l,d,c;return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.initializedState===f.Initialized)return!1;let a;this.initializedState=f.Initialized,a=null===(t=e.registerForStartChat)||void 0===t?void 0:t.call(e,(e=>this.handleStartChat(e))),a&&this.unsubscribers.push(a),a=null===(n=e.registerForStartCall)||void 0===n?void 0:n.call(e,((e,t,n)=>this.handleStartCall(e,t,n))),a&&this.unsubscribers.push(a),a=null===(i=e.registerForTrackPresence)||void 0===i?void 0:i.call(e,(e=>this.handleTrackPresence(e))),a&&this.unsubscribers.push(a),a=null===(o=e.registerForUntrackPresence)||void 0===o?void 0:o.call(e,(e=>this.handleUntrackPresence(e))),a&&this.unsubscribers.push(a),a=null===(r=e.registerForLogStatement)||void 0===r?void 0:r.call(e,((e,t)=>this.handleLogStatement(e,t))),a&&this.unsubscribers.push(a);const m=(null===(s=this.authenticationUser)||void 0===s?void 0:s.loginUserName)||"",{data:g}=yield this.client.query({query:u,variables:{userId:m,isMailAddress:!0},context:{callerInfo:"office-integration-start"}}),p=null==g?void 0:g.user;if(p){const e=null===(l=p.userPrincipalName)||void 0===l?void 0:l.toLowerCase(),t=null===(d=p.email)||void 0===d?void 0:d.toLowerCase();p.mri&&(this.selfMri=p.mri,e&&this.uriToMriCacheMap.set(e,p.mri),t&&t!==e&&this.uriToMriCacheMap.set(t,p.mri))}return!!(yield null===(c=e.startComServer)||void 0===c?void 0:c.call(e,(null==p?void 0:p.userPrincipalName)||m))}))}startOfficeIntegrationFREDialog(){if(this.isLocalStoragePropertySet(y.FreDialogDisplayedKey))this.logger.log("Skipping FRE as it has already been displayed for user");else{this.entityCommanding.shell.openFreDialog(this.entityCommand),this.setLocalStorageProperty(y.FreDialogDisplayedKey,"true");const e="Start office integration FRE through user dialog registration";this.handleLogToTelemetry(e,"office_integration_fre_register_dialog",i.Info)}}notifyPresence(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("officeintegration");return null===(t=null==n?void 0:n.notifyPresence)||void 0===t?void 0:t.call(n,e)}))}convertLastSeenAt(e){if(e){return new Date(e).getTime()}}notifyInitialPresence(e,t){const n=[];e.presences.forEach((e=>{const i=d.cS$[e.activity||d.cS$.PresenceUnknown];e.id===this.selfMri&&e.activity&&(this.selfActivity=e.activity),n.push({id:e.id,requestedUri:t.get(e.id)||"",status:S.get(i)||i,lastSeenAt:this.convertLastSeenAt(e.lastSeenAt)})})),this.notifyPresence(n)}handleTrackPresence(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.mapUrisToMris(e),n=[],i=new Map;if(e.forEach((e=>{const a=t.get(e);if(a){const t=this.presenceSubscriptionMap.get(a);if(t)(!t.requestedUris.has(e)||a===this.selfMri&&d.cS$.PresenceUnknown===this.selfActivity)&&(t.requestedUris.add(e),n.push({userId:a,source:d.W8Z.ups}),i.set(a,e));else{const t=this.client.subscribe({query:g,variables:{userId:a,source:d.W8Z.ups}}).subscribe((({data:e})=>{e&&this.notifyUpdatedPresence(e)})),o={requestedUris:new Set,presenceSubscription:t};o.requestedUris.add(e),this.presenceSubscriptionMap.set(a,o),n.push({userId:a,source:d.W8Z.ups}),i.set(a,e)}}})),!(0,o.isEmpty)(n)){const{data:e}=yield this.client.query({query:p,variables:{userPresenceRequestArray:n}});e&&this.notifyInitialPresence(e,i)}}))}mapUrisToMris(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=this.resolveUrisToMrisFromCache(e);if(t.size===e.length)return t;{const n=[];return e.forEach((e=>{if(!t.has(e)){const t=e.startsWith(k)?e.substring(k.length):e;n.push(t)}})),(0,o.isEmpty)(n)?t:(yield this.resolveUrisToMrisFromServiceIntoCache(n),this.resolveUrisToMrisFromCache(e))}}))}resolveUrisToMrisFromServiceIntoCache(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{data:n}=yield this.client.query({query:m,variables:{mriOrEmailArray:e,isMailAddress:!0},context:{callerInfo:"office-integration-uri-resolution"}});null===(t=null==n?void 0:n.getUsers)||void 0===t||t.forEach((e=>{var t,n,i;if(e.mri&&"unknown_email_address@invalid.teams.ms"!==e.email){const a=null===(t=e.userPrincipalName)||void 0===t?void 0:t.toLowerCase(),o=null===(n=e.email)||void 0===n?void 0:n.toLowerCase(),r=null===(i=e.emailForQuery)||void 0===i?void 0:i.toLowerCase();a&&this.uriToMriCacheMap.set(a,e.mri),o&&o!==a&&this.uriToMriCacheMap.set(o,e.mri),r&&r!==a&&r!==o&&this.uriToMriCacheMap.set(r,e.mri)}}))}))}resolveUrisToMrisFromCache(e){const t=new Map;return e.forEach((e=>{const n=e.toLowerCase(),i=n.startsWith(k)?n.substring(k.length):n,a=this.uriToMriCacheMap.get(i);a&&t.set(e,a)})),t}notifyUpdatedPresence(e){const t=e.presenceUpdateEvent;if(t){const e=t.id,n=this.presenceSubscriptionMap.get(e);if(n){const i=[],a=d.cS$[t.activity||d.cS$.PresenceUnknown],o=S.get(a)||a,r=this.convertLastSeenAt(t.lastSeenAt);n.requestedUris.forEach((t=>{i.push({id:e,requestedUri:t,status:o,lastSeenAt:r})})),e===this.selfMri&&t.activity&&(this.selfActivity=t.activity),this.notifyPresence(i)}}}handleUntrackPresence(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){(yield this.mapUrisToMris(e)).forEach(((e,t)=>{const n=this.presenceSubscriptionMap.get(e);n&&(n.requestedUris.delete(t),(0,o.isEmpty)(n.requestedUris)&&(n.presenceSubscription.unsubscribe(),this.presenceSubscriptionMap.delete(e)))}))}))}handleStartChat(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){this.logger.log("Starting chat");const t=e.split(";").filter((e=>!!e.trim())),n=yield this.mapUrisToMris(t),a=`mapped ${n.size} uris`;this.handleLogToTelemetry(a,"office_integration_handle_chat",i.Info);const r=Array.from(n.values());(0,o.isEmpty)(r)?this.handleLogToTelemetry("No mapped uris to start chat","office_integration_handle_chat",i.Warning):this.navigateToChat(r)}))}navigateToChat(e,t=r.su.new){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.entityCommanding.chat.chatWithUsers({userIds:e,entityCommand:{stateTransition:t,visibilityState:r.fe.show,correlation:{source:s.D.OfficeIntegrationChat}}})}))}handleStartCall(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{enableOfficeIntegrationCalling:a}=this.coreSettings.get(l.J.Calling);try{const{data:{userCallingSettings:o}}=yield this.client.query({query:h,variables:{}});if(!a||n&&!(null==o?void 0:o.isPstnCallingAllowed)||!n&&!(null==o?void 0:o.isCallingAllowed))return void this.handleLogToTelemetry("Office integration calling or policy is disabled","office_integration_handle_call",i.Warning,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t,isCallingAllowed:null==o?void 0:o.isCallingAllowed,isPstnCallingAllowed:null==o?void 0:o.isPstnCallingAllowed})});this.handleLogToTelemetry("Starting call","office_integration_handle_call",i.Info,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t})});const r=n?this.getPstnCallingIntent(e):yield this.getVoipCallingIntentAndNavigateChat(e,t);yield this.client.mutate({mutation:v,variables:{callingIntent:r}}),this.handleLogToTelemetry("Successfully triggered call","office_integration_handle_call",i.Info,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t})})}catch(e){this.handleLogToTelemetry("Failed to start call","office_integration_handle_call",i.Error,{context:JSON.stringify({enableOfficeIntegrationCalling:a,isPSTN:n,isVideo:t}),errors:(null==e?void 0:e.message)||e})}}))}getPstnCallingIntent(e){return{type:d.GXC.OneToOneCall,joinOptions:{},coordinates:{oneToOne:{mri:(0,c.DI)(e)}}}}getVoipCallingIntentAndNavigateChat(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const n=(yield this.mapUrisToMris([e])).get(e);if(!n)throw new Error("No mapped uri to start call");return yield this.navigateToChat([n],r.su.flush),{type:d.GXC.OneToOneCall,coordinates:{oneToOne:{mri:n}},joinOptions:{outgoingVideo:t}}}))}handleLogStatement(e,t){switch(t){case i.Info:this.logger.log(e);break;case i.Debug:this.logger.debug(e);break;case i.Error:this.logger.error(e);break;case i.Warning:this.logger.warn(e)}}handleLogToTelemetry(e,t,n,a,o=!0){switch(n){case i.Info:this.logger.infoToTelemetry?this.logger.infoToTelemetry(e,t,a,o):this.logger.log(e);break;case i.Debug:this.logger.debugToTelemetry?this.logger.debugToTelemetry(e,t,a,o):this.logger.debug(e);break;case i.Error:this.logger.errorToTelemetry?this.logger.errorToTelemetry(e,t,a,o):this.logger.error(e);break;case i.Warning:this.logger.warnToTelemetry?this.logger.warnToTelemetry(e,t,a,o):this.logger.warn(e)}}}},797229:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u,m,g,p,v,h,f,y;n.d(t,{qi:()=>i,OM:()=>a,Pw:()=>o,aZ:()=>r,Aj:()=>s,jD:()=>l,BU:()=>d,YV:()=>c,Ye:()=>u,XW:()=>m,Z9:()=>g,o1:()=>p,g7:()=>v,Hd:()=>h,_W:()=>f,n$:()=>y}),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat"}(i||(i={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(a||(a={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector"}(o||(o={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced"}(r||(r={})),function(e){e.Unknown="Unknown",e.SidePanel="SidePanel",e.Stage="Stage"}(s||(s={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(l||(l={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.TeamLevelApp="TeamLevelApp"}(d||(d={})),function(e){e.Application="Application",e.Delegated="Delegated"}(c||(c={})),function(e){e.MRU="MRU",e.AlphabeticalAsc="AlphabeticalAsc",e.AlphabeticalDesc="AlphabeticalDesc"}(u||(u={})),function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(m||(m={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(g||(g={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(p||(p={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(v||(v={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition"}(h||(h={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(f||(f={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(y||(y={}))},197893:(e,t,n)=>{"use strict";n.d(t,{di:()=>a,DS:()=>o,Km:()=>r,Ms:()=>s,bv:()=>l,bh:()=>d,if:()=>c,F4:()=>u,MD:()=>m});var i=n(79231);class a{static GetBytes(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t}}class o{static GetString(e){var t,n,i,a,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],s=e.length%3;for(t=0,i=e.length-s;t<i;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],r.push([o.charAt((a=n)>>18&63),o.charAt(a>>12&63),o.charAt(a>>6&63),o.charAt(63&a)].join(""));switch(s){case 1:n=e[e.length-1],r.push(o.charAt(n>>2)),r.push(o.charAt(n<<4&63)),r.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],r.push(o.charAt(n>>10)),r.push(o.charAt(n>>4&63)),r.push(o.charAt(n<<2&63)),r.push("=")}return r.join("")}}class r{static GetBytes(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t}}class s{static GetBytes(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i}}class l{static GetBytes(e){if(i.KS.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(4));t.setFloat32(0,e,!0);for(var n=[],a=0;a<4;++a)n.push(t.getUint8(a));return n}return g.ConvertNumberToArray(e,!1)}}class d{static GetBytes(e){if(i.KS.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],a=0;a<8;++a)n.push(t.getUint8(a));return n}return g.ConvertNumberToArray(e,!0)}}class c{static EncodeZigzag16(e){return(e=i.Mr.ToInt16(e))<<1^e>>15}static EncodeZigzag32(e){return(e=i.Mr.ToInt32(e))<<1^e>>31}static EncodeZigzag64(e){var t=e.low,n=e.high,a=n<<1|t>>>31,o=t<<1;2147483648&n&&(a=~a,o=~o);var r=new i.zM("0");return r.low=o,r.high=a,r}}class u{static GetString(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(i<=191)t.push(String.fromCharCode(i));else if(i<=223){var a=e[++n];t.push(String.fromCharCode((31&i)<<6|63&a))}else if(i<=239){a=e[++n];var o=e[++n];t.push(String.fromCharCode((15&i)<<12|(63&a)<<6|63&o))}else{i=(7&i)<<18|(63&(a=e[++n]))<<12|(63&(o=e[++n]))<<6|63&e[++n],i-=65536,t.push(String.fromCharCode(55296|i>>10&1023)),t.push(String.fromCharCode(56320|1023&i))}}return t.join("")}}class m{static GetBytes(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=0;i<e.length;++i){var a=t.indexOf(e.charAt(i++)),o=t.indexOf(e.charAt(i++)),r=t.indexOf(e.charAt(i++)),s=t.indexOf(e.charAt(i));n.push(a<<2|o>>4),r>=0&&(n.push(o<<4&240|r>>2),s>=0&&n.push(r<<6&192|s))}return n}}class g{static ConvertNumberToArray(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,i=(1<<(t?11:8)-1)-1,a=1-i,o=i,r=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),l=e-s,d=2*(i+2)+n,c=new Array(d),u=0;u<d;)c[u++]=0;for(u=i+2;u&&s;)c[--u]=s%2,s=Math.floor(s/2);for(u=i+1;u<d-1&&l>0;)(l*=2)>=1?(c[++u]=1,--l):c[++u]=0;for(var m=0;m<d&&!c[m];++m);var g=i+1-m,p=m+n;if(c[p+1]){for(u=p;u>m&&!(c[u]=1-c[u]);--u);u==m&&++g}if(g>o||s)return r?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(g<a)return t?this._doubleZero:this._floatZero;if(t){var v=0;for(u=0;u<20;++u)v=v<<1|c[++m];for(var h=0;u<52;++u)h=h<<1|c[++m];return[255&h,h>>8&255,h>>16&255,h>>>24,255&(v=r<<31|2147483647&(v|=g+i<<20)),v>>8&255,v>>16&255,v>>>24]}var f=0;for(u=0;u<23;++u)f=f<<1|c[++m];return[255&(f=r<<31|2147483647&(f|=g+i<<23)),f>>8&255,f>>16&255,f>>>24]}static ConvertArrayToNumber(e,t){var n=(1<<(t?11:8)-1)-1,a=0!=(128&e[t?7:3]),o=t?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==o)throw new i.Pp("Not a valid float/double buffer.");var r=1,s=1;if(t){var l=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,d=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!o&&!l&&!d)return 0;for(var c=0;c<20;++c)s/=2,l<0&&(r+=s),l<<=1;for(c=0;c<32;++c)s/=2,d<0&&(r+=s),d<<=1}else{var u=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!o&&!u)return 0;for(c=0;c<23;++c)s/=2,u<0&&(r+=s),u<<=1}return r*=Math.pow(2,o-n),a?0-r:r}}g._floatZero=[0,0,0,0],g._doubleZero=[0,0,0,0,0,0,0,0],g._floatInifinity=[0,0,128,127],g._floatNegInifinity=[0,0,128,255],g._doubleInifinity=[0,0,0,0,0,0,240,127],g._doubleNegInifinity=[0,0,0,0,0,0,240,255]},295670:(e,t,n)=>{"use strict";n.d(t,{w:()=>R});var i,a,o,r,s=n(231191),l=n(118824),d=n(628235),c=n(893088),u=n(661564),m=n(324819),g=n(329371),p=n(604781);function v(e){const{clientId:t}=e.get(l.J.Brb);return t}function h(e){const{licenseType:t}=e.get(l.J.UserResources);return t}function f(e,t,n,a){const{adoTagsForAllItems:o,categories:r}=e.get(l.J.Brb),s=null==r?void 0:r.find((e=>(null==e?void 0:e.id)===t));return[o,(null==s?void 0:s.additionalAdoTags)||"",n.get(i.Ring)||"unknownRing",function(e,t){var n,i,a;const{platformAdoTagPrefix:o,platformAdoTagSuffix:r}=e.get(l.J.Brb);let s=`${o||"teams"}_${r||t.config.browser}`;return o&&r&&(null===(n=null==t?void 0:t.config)||void 0===n?void 0:n.platformId)===g.us.Web&&(s=(null===(i=null==t?void 0:t.config)||void 0===i?void 0:i.browser)?`${s}_${null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.browser}`:s),s}(e,a),n.get(i.MTMA)?"MTMA":""].filter((e=>e)).join(";")}function y(e,t,n){const a=`${function(e){const t=e.get(i.Build)||"";return t.startsWith("local")?"[LOCAL] ":t.indexOf("oncdn")>=0?"[CONTAINER] ":""}(n)||""}${e||""}`,{brbItemTitleMaxLength:o}=t.get(l.J.Brb);return S(a,o||1500)}function k(e,t){const{brbItemDescriptionMaxLength:n}=t.get(l.J.Brb);return S(e||"",n||5e3)}function S(e,t){return(e=e||"No text provided").length>t?`${e.substring(0,t-3)}...`:e}function b(e){let t="";const n=e.get(i.MTMA);n&&"MTMA"===n&&(t="<h3>(This is MTMA scenario, please check logs from user's other accounts under Links tab)</h3><br>");let a="";return null==e||e.forEach(((e,t)=>{a=`${a}<b>${t}:</b> ${e}<br>`})),`<h3><strong>All the logs & screenshots (if attached) are available in the devlogs link which is present in the Links tab.</strong></h3><br>${t}${a}`.trim()}function C(e){return e.get(i.WebClientBuild)||"1.1.11.1111_11/1.1.1.1111111111"}function w(e,t,n,i,a){let o=i;o=o?o===r.ApiFailure?r.ApiFailure:o.includes(r.TimedOut)?r.TimedOut:r.Unknown:void 0;let s=e.get(t);return s?(s.uploadStatus=n,s.byteSize=null!=a?a:s.byteSize,s.error=null!=o?o:s.error):(s={uploadStatus:n,byteSize:a,error:o},e.set(t,s)),o}!function(e){e.UserEmail="UserEmail",e.TenantID="TenantID",e.Ring="Ring",e.UserID="UserID",e.WebClientBuild="WebClient build",e.Build="Build",e.MTMA="MTMA",e.MSAlias="MSAlias",e.DeviceID="Device ID",e.Language="Language",e.SystemManufacturer="System Manufacturer",e.DeviceModel="Device Model",e.DesktopVersion="Desktop Version",e.slimCoreVersion="Slimcore Version"}(i||(i={})),function(e){e.FocusAssistant="Focus Assistant",e.GlobalNotificationSettings="Global Notification Settings"}(a||(a={})),function(e){e.Requested="Requested",e.Success="Success",e.Failure="Failure"}(o||(o={})),function(e){e.TimedOut="TimedOut",e.Unknown="Unknown",e.ApiFailure="ApiFailure"}(r||(r={}));var N=n(992744);const T=e=>{const t=e.loggerFactory.newLogger("BrbServiceEndpointsManager");return{baseUrl:"https://brbv2",serviceName:c.EJ.BRB,models:{createBrbItem:E(e,t),uploadLogsFile:A(e,t),releaseBrbItem:_(e,t),extendBrbReports:I(e,t)}}},I=(e,t)=>(0,s.__awaiter)(void 0,void 0,void 0,(function*(){return{allowedResponses:[u.qb.OK],constructRequest:(n,a,o,r)=>{if(!a){const e=`Skype token is not present: ${a}`;throw t.error(e),new Error(e)}const{extendBrbReportsUrl:s}=e.coreSettings.get(l.J.Brb);if(!s){const e=`Failed to retrieve extend BRB report url from core settings: ${s}`;throw t.error(e),new Error(e)}let d;try{d=function(e,t,n,a,o){return(0,p.u4)({ReportTitle:y(e.text,a,o),ReportDescription:k(e.text,a),CategoryName:e.categoryId,SkypeAuthToken:t,UploadID:(0,m.v4)(),InitiatorIDs:[n],ClientID:v(a),ClientVersion:C(o),Email:o.get(i.UserEmail),TenantID:o.get(i.TenantID),UserID:o.get(i.UserID),Ring:o.get(i.Ring)})}(n,a,o,e.coreSettings,r)}catch(e){throw t.error("Failed to get extend BRB report request body:",e),e}const c=new URL(s);return{method:"POST",url:c.href,headers:{Host:c.hostname,"Content-Type":"application/json","Content-Length":`${d.length}`},body:d}},abortOnTimeout:!1}})),E=(e,t)=>(0,s.__awaiter)(void 0,void 0,void 0,(function*(){return{allowedResponses:[u.qb.OK],constructRequest:(n,a,o)=>{if(!n){const e=`Skype token is not present: ${n}`;throw t.error(e),new Error(e)}const{createBrbRequestUrl:r}=e.coreSettings.get(l.J.Brb);if(!r){const e=`Failed to retrieve create BRB request url from core settings: ${r}`;throw t.error(e),new Error(e)}let s;try{s=function(e,t,n,a,o){return(0,p.u4)({ReportTitle:y(e.text,t,a),ReportDescription:k(e.text,t),CategoryName:e.categoryId,UploadID:(0,m.v4)(),InitiatorIDs:[],ClientID:v(t),ClientVersion:C(a),CorelibVersion:"",Ring:a.get(i.Ring),SkypeAuthToken:n,TenantName:"",TenantID:a.get(i.TenantID),UserID:a.get(i.UserID),Email:a.get(i.UserEmail),MSAlias:a.get(i.MSAlias)||"",SkipEmailNotification:!1,SkipVsoTicketCreation:!1,SystemInfo:b(a),VsoTags:f(t,e.categoryId,a,o),LicenseType:h(t)})}(a,e.coreSettings,n,o,e.platformService)}catch(e){throw t.error("Failed to get create BRB item request body:",e),e}const d=new URL(r);return{method:"POST",url:d.href,headers:{Host:d.hostname,"Content-Type":"application/json","Content-Length":`${s.length}`},body:s}}}})),A=(e,t)=>Promise.resolve({allowedResponses:[u.qb.CREATED],constructRequest:(n,i)=>{if(!n){const e=`Create BRB item response body is not present: ${n}`;throw t.error(e),new Error(e)}if(!i){const e=`Logs file is not present: ${i}`;throw t.error(e),new Error(e)}const{enableGzipUpload:a,minSizeToGzip:o}=e.coreSettings.get(l.J.Brb,["enableGzipUpload","minSizeToGzip"]),r=new URL(n.ContainerUrl);let s,d,c;return a&&"string"==typeof i.content&&i.content.length>(null!=o?o:2e3)?(s=(0,N.gzip)(i.content),d=s.length,c=!0):(s=i.content,d="string"==typeof i.content?i.content.length:i.content.size,c=!1),{method:"PUT",url:`${r.href}/${i.fileName}?${n.SASToken}`,headers:Object.assign({Host:r.hostname,"Content-Type":"text/plain","Content-Length":d.toString(),"x-ms-blob-type":"BlockBlob"},c?{"Content-Encoding":"gzip"}:{}),body:s}},transformResponse:()=>Promise.resolve(!0),abortOnTimeout:!1}),_=(e,t)=>Promise.resolve({allowedResponses:[u.qb.OK],constructRequest:n=>{if(!n){const e=`Container ID is not present: ${n}`;throw t.error(e),new Error(e)}const{releaseBrbRequestUrlPrefix:i}=e.coreSettings.get(l.J.Brb);if(!i){const e=`Failed to retrieve release BRB request url prefix from core settings: ${i}`;throw t.error(e),new Error(e)}const a=new URL(`${i}${n}`);return{method:"POST",url:a.href,headers:{Host:a.hostname,"Content-Length":"0"}}},transformResponse:()=>Promise.resolve(!0),abortOnTimeout:!1});var D=n(215235),F=n(757185);class M{constructor(e,t,n,i,a,o,r,s,l,d,c,u){this.coreSettings=t,this.logsCollectorService=n,this.authenticationService=i,this.platformService=a,this.discover=o,this.host=r,this.hostCommunicationService=s,this.brbServiceApi=l,this.i18n=d,this.authenticationUser=c,this.apolloClient=u,this.defaultUploadDesktopLogsTimeoutMs=2e4,this.logger=e.newLogger("BrbServiceTasks")}getSystemInfo(){var e,t,n,o,r,c,u,p,v,h,f,y,k;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const S=new Map;let b;S.set("TimeStamp",(new Date).toISOString()),this.logger.debug("... starting getSystemInfo() brb");try{b=yield this.authenticationService.getUser()}catch(e){this.logger.error("Failed to fetch user:",e)}!function(e,t,n,a){var o,r,s,d,c,u,m,p,v,h,f,y;e.set(i.UserEmail,(null===(o=null==t?void 0:t.profile)||void 0===o?void 0:o.email)||(null===(r=null==t?void 0:t.profile)||void 0===r?void 0:r.upn)||(null===(s=null==t?void 0:t.profile)||void 0===s?void 0:s.preferred_username)||""),e.set("UserType",(null===(d=null==t?void 0:t.type)||void 0===d?void 0:d.toString())||""),e.set(i.TenantID,(null===(c=null==t?void 0:t.profile)||void 0===c?void 0:c.tid)||""),e.set(i.Ring,(null===(m=null===(u=n.get(l.J.Metadata))||void 0===u?void 0:u.ring)||void 0===m?void 0:m.id)||""),e.set(i.UserID,(null===(v=null===(p=null==t?void 0:t.profile)||void 0===p?void 0:p.oid)||void 0===v?void 0:v.toString())||"");const k=(null===(h=n.get(l.J.Brb))||void 0===h?void 0:h.sendBrbMSAlias)?a.config.clientType===g.Bh.Maglev?null==t?void 0:t.userName:(null===(f=null==t?void 0:t.profile)||void 0===f?void 0:f.upn)||(null===(y=null==t?void 0:t.profile)||void 0===y?void 0:y.email):"";e.set(i.MSAlias,k||"")}(S,b,this.coreSettings,this.platformService),function(e,t){var n,i,a,o,r,s,l,d;e.set("Platform",(null===(i=null===(n=null==t?void 0:t.config)||void 0===n?void 0:n.platformId)||void 0===i?void 0:i.toString())||""),e.set("OS",(null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.osPlatform)||""),e.set("OS Version",(null===(r=null===(o=null==t?void 0:t.config)||void 0===o?void 0:o.osVersion)||void 0===r?void 0:r.toString())||""),e.set("Browser",(null===(s=null==t?void 0:t.config)||void 0===s?void 0:s.browser)||""),e.set("Browser Version",(null===(d=null===(l=null==t?void 0:t.config)||void 0===l?void 0:l.browserVersion)||void 0===d?void 0:d.toString())||"")}(S,this.platformService);const{enableMTMA:C}=this.coreSettings.get(l.J.Core);C&&(yield function(e,t){var n;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const a=yield null===(n=null==t?void 0:t.getCachedUsers)||void 0===n?void 0:n.call(t,{id:(0,m.v4)(),scenarioName:d.RG.AuthWebCachedUser,source:"brb-utils::addMTMAInfo"}),o=(null==a?void 0:a.length)&&a.length>1;e.set(i.MTMA,o?"MTMA":"")}))}(S,this.authenticationService)),S.set("Client",(null===(e=this.coreSettings.get(l.J.Brb))||void 0===e?void 0:e.systemInfoClient)||""),S.set(i.WebClientBuild,(null===(n=null===(t=this.platformService)||void 0===t?void 0:t.config)||void 0===n?void 0:n.clientVersion)||""),S.set(i.Build,(null===(r=null===(o=this.platformService)||void 0===o?void 0:o.config)||void 0===r?void 0:r.buildVersion)||"");try{S.set(i.slimCoreVersion,(null===(u=null===(c=this.host)||void 0===c?void 0:c.SlimCore)||void 0===u?void 0:u.getVersion().toString())||"unkown slimcore version")}catch(e){this.logger.log("Error while fetching SlimCoreVersion:",e)}const{sessionId:w}=this.coreSettings.get(l.J.Platform);S.set("SessionID",w||""),S.set(i.Language,(null===(p=this.i18n)||void 0===p?void 0:p.locale)||"");const N=yield this.hostCommunicationService.loadModule("osutils"),T=yield null===(v=null==N?void 0:N.getDeviceInfo)||void 0===v?void 0:v.call(N);S.set(i.DeviceID,(null==T?void 0:T.deviceId)||"unkown deviceID"),S.set(i.SystemManufacturer,(null==T?void 0:T.make)||(null===(h=this.hostSettings)||void 0===h?void 0:h.systemManufacturer)||"");const I=yield this.hostCommunicationService.loadModule("toasts");if(I){try{const e=yield null===(f=null==I?void 0:I.getFocusAssistStateAsync)||void 0===f?void 0:f.call(I);S.set(a.FocusAssistant,e||"")}catch(e){this.logger.log("Error while fetching focus assistant state:",e)}try{const e=yield null===(y=null==I?void 0:I.getGlobalNotificationSettingsAsync)||void 0===y?void 0:y.call(I);S.set(a.GlobalNotificationSettings,(null==e?void 0:e.global)||"")}catch(e){this.logger.log("Error while fetching global notification settings:",e)}}else this.logger.log("Error while loading toast settings module. Toast settings will not be collected.");S.set(i.DeviceModel,(null==T?void 0:T.model)||(null===(k=this.hostSettings)||void 0===k?void 0:k.systemProductName)||"");let E=new Map;try{E=(yield this.logsCollectorService.getSystemInfo())||new Map}catch(e){this.logger.error("Failed to fetch system info from logs collector service:",e)}return new Map([...Array.from(S.entries()),...Array.from(E.entries())])}))}createBrbItem(e,t){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let n;try{const i=yield this.discover.validateSkypeToken();n=yield this.brbServiceApi.createBrbItem(i,e,t)}catch(e){return this.logger.error("Failed creating BRB item:",e),null}return n}))}extendBrbReports(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let i;try{const a=yield this.discover.validateSkypeToken();i=yield this.brbServiceApi.extendBrbReports(e,a,t,n)}catch(e){return this.logger.error("Failed extending BRB report"),null}return i}))}uploadWebLogsFiles(e,t){var n;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const i=new Map,{enableMTMA:a}=this.coreSettings.get(l.J.Core),{maxBRBLogsCountInLogFile:c}=this.coreSettings.get(l.J.Diagnostics),u=n=>(0,s.__awaiter)(this,void 0,void 0,(function*(){const a=n.content instanceof Blob?n.content.size:new Blob([n.content]).size,s=`File name: ${n.fileName}, size: ${a} bytes`;w(i,n.fileName,o.Requested,void 0,a);const l=function(e){const t=e.split("/"),n=t.length>1?t[t.length-1]:e;return e.includes("WebLogs/Core")?`WebLogs/Core/${n}`:e.includes("WebLogs/User")?`WebLogs/User/${n}`:n}(n.fileName);try{const c=yield this.brbServiceApi.uploadLogsFile(e,n),u=c?o.Success:o.Failure;return w(i,n.fileName,u,u?void 0:r.ApiFailure,a),null==t||t.mark(d.ck.UploadWebLogsFiles,{reason:s,size:a,context:l},u?"success":"failure"),c}catch(e){return this.logger.error(`Failed to upload logs file - ${n.fileName} - error:`,e),w(i,n.fileName,o.Failure,e.toString(),a),null==t||t.mark(d.ck.UploadWebLogsFiles,{reason:s,size:a,context:l},"failure"),!1}}));try{a&&(null===(n=this.authenticationUser)||void 0===n?void 0:n.id)?yield this.logsCollectorService.callOnUserLogsFiles([this.authenticationUser.id],u,!1,!1,c||void 0):yield this.logsCollectorService.callOnLogsFiles(u,!1,!1,c||void 0)}catch(e){return this.logger.error("Failed when calling upload on all logs files:",e),i}return i}))}uploadDesktopLogsFiles(e,t,n){var i;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const a="Desktop-Logs-and-Screenshots",s=new Map,c=yield this.hostCommunicationService.loadModule("brb");if(!c)return this.logger.log("uploadDesktopLogsFiles(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),s;let u;const{enableMTMA:m}=this.coreSettings.get(l.J.Core);if(m&&this.apolloClient){const e=null===(i=this.authenticationUser)||void 0===i?void 0:i.id,n=yield(0,F.XD)(this.apolloClient),a=[];n.forEach((t=>{t.userContextId===e&&a.push(t.id)})),u=null==t?void 0:t.filter((e=>a.includes(e)))}else u=t;if(!c.uploadDesktopLogs)return this.logger.error("uploadDesktopLogs not available on brb module."),s;const g={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature},screenshotIds:u},{uploadDesktopLogsTimeoutMs:p}=this.coreSettings.get(l.J.Brb),v=null!=p?p:this.defaultUploadDesktopLogsTimeoutMs;try{const e=yield(0,D.E)(c.uploadDesktopLogs(g),v,`uploadDesktopLogs timed out. Ran for ${v} ms.`),t=!!(null==e?void 0:e.status);return w(s,a,t?o.Success:o.Failure,t?void 0:r.ApiFailure),null==n||n.mark(d.ck.UploadDesktopLogsFiles,t?void 0:{reason:`${r.ApiFailure}`},t?"success":"failure"),s}catch(e){this.logger.error("Failed to upload desktop logs files. Error:",e);const t=(0,D.T)(e)?r.TimedOut:r.Unknown;return w(s,a,o.Failure,t),null==n||n.mark(d.ck.UploadDesktopLogsFiles,{reason:t},"failure"),s}}))}uploadHeapSnapshotFiles(e,t){var n,i;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const a="Heap-Snapshot",s=new Map,l=yield this.hostCommunicationService.loadModule("brb");if(!l)return this.logger.log("uploadHeapSnapshotFiles(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),s;if(!l.uploadHeapSnapshot)return this.logger.error("uploadHeapSnapshot not available on brb module."),s;const c={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature}};try{const e=yield l.uploadHeapSnapshot(c),n=!!(null==e?void 0:e.status);return w(s,a,n?o.Success:o.Failure,n?void 0:r.ApiFailure),null==t||t.mark(d.ck.UploadHeapSnapshotFiles,n?void 0:{reason:`${r.ApiFailure}`},n?"success":"failure"),s}catch(e){this.logger.error("Failed to upload heapsnapshot files. Error:",e),null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,"Failed to upload heap snapshot file","brb");const r=w(s,a,o.Failure,e.toString());return null==t||t.mark(d.ck.UploadHeapSnapshotFiles,{reason:r},"failure"),s}}))}uploadMemoryTracingFile(e,t){var n,i;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const a="Memory-Tracing",s=new Map,l=yield this.hostCommunicationService.loadModule("brb");if(!l)return this.logger.log("uploadMemoryTracingFile(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."),s;if(!l.uploadMemoryTracing)return this.logger.error("uploadMemoryTracing not available on brb module."),s;const c={azureBlobStorageInfo:{sharedAccessSignature:e.SharedAccessSignature}};try{const e=yield l.uploadMemoryTracing(c),n=!!(null==e?void 0:e.status);return w(s,a,n?o.Success:o.Failure,n?void 0:r.ApiFailure),null==t||t.mark(d.ck.UploadMemoryTracingFile,n?void 0:{reason:`${r.ApiFailure}`},n?"success":"failure"),s}catch(e){this.logger.error("Failed to upload memory tracing file. Error:",e),null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,"Failed to upload memory tracing file","brb");const r=w(s,a,o.Failure,e.toString());return null==t||t.mark(d.ck.UploadMemoryTracingFile,{reason:r},"failure"),s}}))}releaseBrbItem(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){let t;try{t=yield this.brbServiceApi.releaseBrbItem(e)}catch(e){return this.logger.error("Failed to release the BRB item - error:",e),!1}return t}))}uploadFileUploadSummary(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const i=function(e){let t=!0;const n=[];for(const[i,a]of e.entries()){const e=a.byteSize?`(${a.byteSize} bytes)`:"",r=`Status: ${a.uploadStatus}`;t=a.uploadStatus===o.Success&&t;const s=`FileName: ${i} ${e}, ${r}${a.error?`, error: ${a.error}`:""}`;n.push(s)}return{content:n.join("\r\n"),allLogFilesUploaded:t,summaryFileUploaded:!1}}(t);try{const t=yield this.brbServiceApi.uploadLogsFile(e,{fileName:"brb-file-upload-summary.txt",content:i.content,isPiiFree:!0});return null==n||n.mark(d.ck.UploadFileUploadSummary),i.summaryFileUploaded=t,i}catch(e){const t=e.toString().includes("TimedOut")?r.TimedOut:r.Unknown;return null==n||n.mark(d.ck.UploadFileUploadSummary,{reason:t},"failure"),i.summaryFileUploaded=!1,i}}))}}class R{constructor(e,t,n,i,a,o,r,s,l,d,c,u,m){this.coreSettings=t,this.hostCommunicationService=s,this.scenarioFactory=d,this.defaultDisclaimer='NOTE: Data sent in feedback submissions will be "Support Data" under your agreement for Microsoft 365, including any information that would otherwise be considered "Customer Data" or "Personal Data". Please do not submit feedback that may include data you do not wish to provide to Microsoft as "Support Data".',this.logger=e.newLogger("BrbService");const g=l.createApi(T);this.brbServiceTasks=new M(e,t,n,i,a,o,r,s,g,c,u,m)}getBrbFormData(){var e,t;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const{categories:n,disclaimer:i}=this.coreSettings.get(l.J.Brb),a=[];return null==n||n.forEach((e=>{e&&a.push({id:e.id,name:e.name})})),null===(t=(e=this.logger).logNoPii)||void 0===t||t.call(e,"Returning data for BRB form",a),{disclaimer:i||this.defaultDisclaimer,categories:a}}))}getBrbScreenshots(e){var t,n,i,a,o,r,l;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const s=yield this.hostCommunicationService.loadModule("brb");if(!s)return void(null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,"getBrbScreenshots(): HostComms is unable to load brb module. We are running on Web or Teams 1.0. Bailing out."));null===(a=(i=this.logger).logNoPii)||void 0===a||a.call(i,"Requesting screenshots from host");const d=yield null===(o=s.getScreenshotThumbnails)||void 0===o?void 0:o.call(s,{width:e.width,height:e.height||void 0});return null===(l=(r=this.logger).logNoPii)||void 0===l||l.call(r,"Returning host-provided screenshots"),null==d?void 0:d.screenshots}))}createBrbItem(e){var t,n;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const{enableBrb:i}=this.coreSettings.get(l.J.Brb);if(!i)return void(null===(n=(t=this.logger).logNoPii)||void 0===n||n.call(t,"Create BRB item not enabled - setting:",i));const a=this.scenarioFactory.newScenario(d.RG.BrbCreateItem,{timeoutMs:36e5});a.mark(d.ck.BrbSubmitted);const o=yield this.processCreateBrbRequest(e);if("error"!==o.kind)return a.stop(),o.response.ContainerID;a.fail({reason:o.reason})}))}extendBrbReports(e,t){var n,i,a,o;return(0,s.__awaiter)(this,void 0,void 0,(function*(){const{isInternalRingAccount:r}=this.coreSettings.get(l.J.Core),s=this.scenarioFactory.newScenario(d.RG.BrbExtendReports);if(!r){const e="Current account is not internal ring account";return null===(i=(n=this.logger).errorNoPii)||void 0===i||i.call(n,e),s.cancel({reason:e}),!1}const c=yield this.processExtendBrbReportsRequest(e,t);return c?s.stop():s.fail(),null===(o=(a=this.logger).logNoPii)||void 0===o||o.call(a,"Finished extending brb report"),c}))}processExtendBrbReportsRequest(e,t){var n,i,a,o;return(0,s.__awaiter)(this,void 0,void 0,(function*(){let r=new Map;try{r=yield this.brbServiceTasks.getSystemInfo()}catch(e){null===(i=(n=this.logger).errorNoPii)||void 0===i||i.call(n,"Failed to fetch system info")}let s=null;try{s=yield this.brbServiceTasks.extendBrbReports(e,t,r)}catch(e){return null===(o=(a=this.logger).errorNoPii)||void 0===o||o.call(a,"Failed to Extend BRB Reports"),!1}if(!s)return this.logger.error(`Request to Extend BRB Reports failed to receive response body: ${s}`),!1;let l=!1;try{l=yield this.uploadFilesToBrbItem(s,e.includeHeapSnapshot,e.screenshotIds?[...e.screenshotIds]:void 0),l||this.logger.error(`Failed to upload all logs files to first party container: ${t}`)}catch(e){this.logger.error(`Error when uploading all logs files to first party container: ${t}`)}return!0}))}processCreateBrbRequest(e){var t,n,i,a;return(0,s.__awaiter)(this,void 0,void 0,(function*(){let o=new Map;try{o=yield this.brbServiceTasks.getSystemInfo()}catch(e){this.logger.error("Failed to fetch system info:",e)}let r=null;try{r=yield this.brbServiceTasks.createBrbItem(e,o)}catch(e){return this.logger.error("Failed to create BRB item:",e),{kind:"error",reason:"Failed to create BRB item"}}if(!r)return this.logger.error(`Request to create BRB item failed to receive response body: ${r}`),{kind:"error",reason:"Request to create BRB item failed to receive response body"};let s=!1;try{s=yield this.uploadFilesToBrbItem(r,e.includeHeapSnapshot,e.screenshotIds?[...e.screenshotIds]:void 0)}catch(e){this.logger.error("Failed to upload all logs files:",e)}s||null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,"Failed to upload all logs files - attempting to complete BRB item","brb");let l=!1;try{l=yield this.brbServiceTasks.releaseBrbItem(r.ContainerID)}catch(e){return this.logger.error("Failed to release BRB item:",e),{kind:"error",reason:"Failed to release BRB item"}}if(!l){const e="Failed to release the BRB item";return null===(a=(i=this.logger).errorNoPii)||void 0===a||a.call(i,e),{kind:"error",reason:e}}return{kind:"response",response:r}}))}uploadFilesToBrbItem(e,t=!1,n){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const i=this.scenarioFactory.newScenario(d.RG.BrbUploadLogs),a=[];let o=new Map;t&&(o=yield this.brbServiceTasks.uploadHeapSnapshotFiles(e,i),a.push(this.brbServiceTasks.uploadMemoryTracingFile(e,i))),a.push(this.brbServiceTasks.uploadWebLogsFiles(e,i)),a.push(this.brbServiceTasks.uploadDesktopLogsFiles(e,n,i));(yield Promise.all(a)).forEach((e=>{e.forEach(((e,t)=>{o.set(t,e)}))}));const r=yield this.brbServiceTasks.uploadFileUploadSummary(e,o,i),s=r.allLogFilesUploaded&&r.summaryFileUploaded;return s?i.stop():i.fail(),s}))}}},61858:(e,t,n)=>{"use strict";n.d(t,{V:()=>i,N:()=>a});const i="broadcast-updated-event",a={streamUpdateHubEvent:"streamUpdate",captionsUpdate:"captionsUpdate",subscribeToStreamUpdatesHubEvent:"subscribeToStreamUpdates",notifyStreamSwitch:"notifyStreamSwitch",transcriptionStateUpdate:"transcriptionStateUpdate"}},443732:(e,t,n)=>{"use strict";n.d(t,{Bc:()=>i,l4:()=>a,FW:()=>o,kH:()=>r});const i={INVALID_START_DATE:"Invalid start date. Start date cannot be null or undefined",INVALID_END_DATE:"Invalid end date. End date cannot be null or undefined",INVALID_GROUP_IDENTIFIER:"Invalid group identifier. Group identifier cannot be null or undefined",INVALID_START_AND_END_DATE:"Start date cannot greater than end date",INVALID_EVENT_ID:"Invalid event id",INVALID_UID:"Invalid uid",ATLEAST_ONE_ATTENDEE_REQUIRED:"atleast one attendee is required",INVALID_MRI:"invalid mri",INVALID_MEETING_RESPONSE:"Invalid Meeting Response",INVALID_START_TIME_FOR_ICALUID_OP:"Invalid start time. Start time cannot be null or undefined for operation on instance of a series event using iCalUId",INVALID_CONNECTED_ACCOUNT_ID:"Invalid connected account id",FAILED_TO_GENERATE_URL:"Failed to generate URL to call"},a={MiddleTier:{V1:{Private:{CREATE_EMPTY_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/schedulingService/create",UPDATE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/update",DELETE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/delete",CREATE_EVENT_USING_EXISTING_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/exchangeandlink?useGraphApi=false",UPDATE_CALENDAR_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}?useSchedulingService=true&useGraphApi=false",GET_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENTS:"beta/me/calendarEvents?StartDate={startDate}&EndDate={endDate}",DELETE_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}",UPDATE_MEETING_RESPONSE:"beta/me/calendarEvents/{eventId}/respond?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"beta/me/calendarEvents/{eventId}/attendeeEvent?useICalUId={useICalUId}",CANCEL_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}/cancel?useICalUId={useICalUId}",CANCEL_PRIVATE_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}/cancel?useSchedulingService=true&useICalUId={useICalUId}",GET_USER_MAILBOX_SETTINGS:"beta/users/mailboxSettings",GET_USER_TIMEZONE:"beta/me/calendarEvents/timeZoneSettingsWithOffset?timezone={timezone}",GET_BUILDINGS:"beta/me/calendarEvents/roomlist",GET_ROOMS_IN_BUILDING:"beta/me/calendarEvents/roomlist?topLevel={buildingAddress}",GET_SUGGESTED_TIME:"beta/me/calendarEvents/availability"},Channel:{GET_CHANNEL_EVENTS:"beta/teams/{smtpAddress}/calendarEvents?StartDate={startDate}&EndDate={endDate}",GET_CHANNEL_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",ADD_TO_MY_CALENDAR:"beta/teams/{smtpAddress}/addtomycalendar/{eventId}?useICalUId={useICalUId}",CANCEL_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/cancel?useICalUId={useICalUId}&useSchedulingService=true",CREATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents?useSchedulingService=true&useGraphApi=false&enablePstn={enablePstn}",UPDATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/update?useICalUId=true&useSchedulingService=true&useGraphApi=false",GET_ATTACHMENT_BY_ID:"beta/teams/{smtpAddress}/calendarEvents/{eventId}/attachments/{attachmentId}"}},V2:{Private:{GET_CALENDAR_EVENTS:"v2.0/me/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}&shouldDecryptData={shouldDecryptData}",FORWARD_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/forward?useICalUId={useICalUId}",IMPORT_CALENDAR_EVENT:"v2.0/me/calendars/events/import",GET_SCHEDULES:"v2.0/me/calendars/schedules",GET_ATTENDEE_WORK_HOURS:"v2.0/me/calendars/attendeeWorkHours",FIND_MEETING_TIMES:"v2.0/me/calendars/findMeetingTimes",CREATE_CALENDAR_EVENT:"v2.0/me/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",UPDATE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",GET_CALENDAR_EVENT_WITH_ICALUID:"v2.0/me/calendars/events/iCalUId/{eventId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_EVENT_WITH_UID:"v2.0/me/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",GET_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?shouldDecryptData={shouldDecryptData}",DELETE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",PATCH_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",UPDATE_MEETING_RESPONSE:"v2.0/me/calendars/events/{eventId}/respond",UPDATE_MEETING_RESPONSE_WITH_ICALUID:"v2.0/me/calendars/events/{eventId}/respond?eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"v2.0/me/calendars/events/{eventId}/attendeeEvent",CANCEL_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/cancel",GET_MASTER_CATEGORIES:"v2.0/me/calendars/masterCategories",GET_CALENDAR_VIEW_V2_1:"v2.1/me/calendars/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_ROOM_LISTS:"v2.0/places/roomLists?$count={count}&$top={top}&$skip={skip}",GET_ALL_ROOMS:"v2.0/places/rooms?$count={count}&$top={top}&$skip={skip}",GET_ROOMS_IN_ROOM_LIST:"v2.0/places/{roomListAddress}/roomList/rooms?$count={count}&$top={top}&$skip={skip}",GET_MEETING_ARTIFACTS:"v2.0/me/calendars/events/collabs",GET_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",UPDATE_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail"},Channel:{FORWARD_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/forward?useICalUId={useICalUId}&isBackedBySubstrateGroup={isBackedBySubstrateGroup}",GET_CHANNEL_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isBackedBySubstrateGroup={isBackedBySubstrateGroup}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_ICALUID:"v2.0/groups/{groupIdentifier}/calendars/events/iCalUId/{iCalUId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_UID:"v2.0/groups/{groupIdentifier}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW:"v2.0/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_BULK_CHANNEL_EVENTS:"v2.0/unified/calendars/calendarViews?startDate={startDate}&endDate={endDate}",CREATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT_V2_1:"/v2.1/groups/{groupIdentifier}/calendars/{calendarId}/events?isOnlineMeeting={isOnlineMeeting}",UPDATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",CANCEL_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/cancel",ADD_TO_MY_CALENDAR:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/addtomycalendar?isBackedBySubstrateGroup={isBackedBySubstrateGroup}"}},CONNECTED:{Private:{GET_CALENDAR_VIEW_V2_1:"v1.1/connected/{connectedAccountId}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_CALENDAR_EVENTS_CALENDAR_VIEW:"v1.0/connected/{connectedAccountId}/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}",GET_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",GET_CALENDAR_EVENT_WITH_ICALUID:"v1.0/connected/{connectedAccountId}/calendars/events/iCalUid/{eventId}?eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENT_BY_UID:"v1.0/connected/{connectedAccountId}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",CREATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}",FORWARD_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/forward?useICalUId={useICalUId}",UPDATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",CANCEL_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/cancel",UPDATE_MEETING_RESPONSE:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/respond",DELETE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",UPDATE_ATTENDEE_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/attendeeEvent"}}}},o="Personal",r={DEEP_LINK:"deep-link",NOTIFICATION_POPOVER:"notification-popover"}},162024:(e,t,n)=>{"use strict";var i,a;n.d(t,{mN:()=>i,GB:()=>a,yR:()=>o,oo:()=>r,Q0:()=>s,ex:()=>l,PR:()=>d,gh:()=>c,LC:()=>u,Ky:()=>m,ji:()=>g}),function(e){e.InProgress="InProgress",e.Success="Success",e.Error="Error",e.PartialSuccess="PartialSuccess"}(i||(i={})),function(e){e.StatusEntity="Microsoft.SkypeSpaces.MiddleTier.Models.StatusEntity"}(a||(a={}));const o="x-serverrequestid",r="call_blocking_list_refreshed",s=36e5,l="https://teams.microsoft.com/";var d;!function(e){e.getBlockedContacts="getBlockedContacts",e.postBlockedContacts="postBlockedContacts"}(d||(d={}));const c="api/",u=[{id:d.getBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist"},{id:d.postBlockedContacts,path:"mt/part/msft/beta/userSettings/blocklist/manage"}],m="https://teams.live.com/";var g;!function(e){e.Add="Add",e.Remove="Remove"}(g||(g={}))},596992:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});var i=n(231191),a=n(395816),o=n(722915);const r=e=>{const t=[];return e.primaryActionCallback&&t.push({name:a.sRD.PrimaryAction,action:e.primaryActionCallback}),e.dismissActionCallback&&t.push({name:a.sRD.DismissAction,action:e.dismissActionCallback}),t};class s{constructor(e,t,n){this.logger=e.newLogger("CallingBannerServiceAdapter"),this.callingAppEventsService=t,this.bannerCallbacks=new Map,this.i18n=n}showBanner(e,t){var n,s,l,d,c;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=r(e.bannerActions);this.bannerCallbacks.set(e.id,i);const u={source:{name:"ShowBannerNotification",description:e.bannerScenario}},m={event:this.getCallingContentEvent(e,i,o.cP.Show),context:u};try{yield this.callingAppEventsService.trigger(m,t),null===(s=(n=this.logger).infoToTelemetry)||void 0===s||s.call(n,`[showBanner] Successfully triggered banner event for showBanner with [bannerId: ${e.id}]`,"cmd_horizontals_banner_service_show_banner_app_event_triggered_success")}catch(t){const n=`[showBanner] Failed to trigger the banner event for showBanner with [bannerId: ${e.id}, error.name: ${t.name}, error.message: ${t.message}]`;return null===(d=(l=this.logger).errorToTelemetry)||void 0===d||d.call(l,n,"cmd_horizontals_banner_service_show_banner_app_event_triggered_error"),Promise.reject(new Error(n))}const g=(null===(c=i.find((e=>e.name===a.sRD.DismissAction)))||void 0===c?void 0:c.action)||(()=>{});return Promise.resolve({id:e.id,dismiss:g,dismissPromise:Promise.resolve({id:"",value:""})})}))}executeBannerAction(e,t){var n,i,a;null===(i=(n=this.logger).infoToTelemetry)||void 0===i||i.call(n,`Attempting to execute ${t.toString()} action for banner with ${e}`,"cmd_horizontals_banner_service_execute_banner_action");const o=null===(a=this.getBannerActions(e).find((e=>e.name===t)))||void 0===a?void 0:a.action;if(!o)throw new Error(`Action ${t.toString()} not found for banner ${e}`);o()}getBannerActions(e){var t,n;null===(n=(t=this.logger).infoToTelemetry)||void 0===n||n.call(t,`Getting actions for banner ${e}`,"cmd_horizontals_banner_service_get_banner_actions");return this.bannerCallbacks.get(e)||[]}dismissBanner(e,t,n){var a,s,l,d,c,u,m,g,p,v;return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(null===(s=(a=this.logger).infoToTelemetry)||void 0===s||s.call(a,`[dismissBanner] Attempting to cleanup callbacks for banner ${e.id} when dismissed by clicking the X or user joining the call or hidden when call is no longer active.`,"cmd_horizontals_banner_service_start_dismiss_banner_service"),this.bannerCallbacks.has(e.id)){if(n){const n=r(e.bannerActions),i={source:{name:"HideBannerNotification",description:e.bannerScenario}},a={event:this.getCallingContentEvent(e,n,o.cP.Hide),context:i};try{yield this.callingAppEventsService.trigger(a,t),null===(u=(c=this.logger).infoToTelemetry)||void 0===u||u.call(c,`[hide] Successfully triggered banner event for dismissBanner with [bannerId: ${e.id}]`,"cmd_horizontals_banner_service_dismiss_banner_app_event_triggered_success")}catch(t){const n=`[hide] Failed to trigger the banner event for dismissBanner with [bannerId: ${e.id}, error.name: ${t.name}, error.message: ${t.message}]`;throw null===(g=(m=this.logger).errorToTelemetry)||void 0===g||g.call(m,n,"cmd_horizontals_banner_service_dismiss_banner_app_event_triggered_error"),new Error(n)}}this.bannerCallbacks.delete(e.id),null===(v=(p=this.logger).infoToTelemetry)||void 0===v||v.call(p,`[dismissBanner] Successfully cleaned the callbacks for banner with [bannerId: ${e.id}] when dismissed or hidden.`,"cmd_horizontals_banner_service_end_dismiss_banner_service")}else null===(d=(l=this.logger).errorToTelemetry)||void 0===d||d.call(l,`[dismissBanner] Banner already dismissed or hidden. Callbacks does not exist for banner ${e.id}`,"cmd_horizontals_banner_service_callbacks_missing_dismiss_banner_service")}))}getCallingContentEvent(e,t,n){const i={visibility:n};return{typeName:"calling-content-event",content:{contentType:"banner",id:e.id,text:e.bannerText,intentLevel:e.bannerIntentLevel,dismissable:e.dismissable,duration:e.duration,bannerScenario:e.bannerScenario,source:e.bannerSource,dismissOnAction:e.dismissOnAction,joinButtonText:this.i18n.stringTranslate("calling","calling_join"),bannerActions:t.map((e=>e.name))},action:i}}}},809207:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});class i extends Error{constructor(e,t,n){super(t),this._code=e,this.message=t,this._subCode=n}get code(){return this._code}get subCode(){return this._subCode}}},488752:(e,t,n)=>{"use strict";n.d(t,{n:()=>l});var i=n(231191),a=n(324819),o=n(296546),r=n(809207),s=n(628235);class l{constructor(e,t,n,i){this.host=i,this.logger=e.newLogger("CallingAppEventsService"),this.asObservable=t.createObservable(),this.deferredEventsResolution=new Map,this.scenarioFactory=n}trigger(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{externalId:n,timeStamp:i,source:l}=e.context,d=Object.assign(e,{id:`calling-app-event-${(0,a.v4)()}`});this.logger.log(`[trigger] Calling app event received [id=${d.id}, externalId=${n}, timeStamp=${i}, source=${l}]`);const c=this.scenarioFactory.newScenario(s.RG.CallingAppEventTriggerInitiated,{clientId:d.id});if(c.appendEventData({dataSource:e.context.source.name,correlationId:n}),!t)return this.logger.log(`[trigger] Timeout not provided. Resolving promise immediately [id=${d.id}, externalId=${n}, timeStamp=${i}, source=${l}, timeout=${t}]`),this.asObservable.trigger(void 0,void 0,d),void c.stop({message:"no timeout provided, fire and forget."});const u=(0,o.P)();let m;this.deferredEventsResolution.set(d.id,u);const g=new Promise(((e,a)=>{m=this.host.setTimeout((()=>{const e=`[trigger] Timeout waiting for event resolution signal [id=${d.id}, externalId=${n}, timeStamp=${i}, source.name=${l.name}, source.description=${l.description}]`;this.logger.error(e);const t=new r.w("event-resolution-timeout",e);c.fail({errorCode:t.code,message:t.message}),a(t)}),t)})),p=Promise.race([u.promise,g]);this.asObservable.trigger(void 0,void 0,d);try{yield p}finally{void 0!==m&&this.host.clearTimeout(m),this.deferredEventsResolution.delete(d.id)}}))}resolve(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{eventId:t,resolution:n}=e;this.logger.log(`[resolve] Received event resolution [eventId=${t}, resolutionType=${n.resolutionType}]`);const i=this.scenarioFactory.findScenarioByNameAndId(s.RG.CallingAppEventTriggerInitiated,t)||this.scenarioFactory.newScenario(s.RG.CallingAppEventResolveInitiated,{clientId:t}),a=this.deferredEventsResolution.get(t);if(!a){const e=`[resolve] No deferred resolution found for event [eventId=${t}, resolutionType=${n.resolutionType}]`;this.logger.error(e);const a=new r.w("event-to-resolve-not-found",e);throw i.fail({errorCode:a.code,message:a.message}),a}if("success"===n.resolutionType)return this.logger.log(`[resolve] Resolving succesful event [eventId=${t}]`),a.resolve(),void i.stop();if("error"===n.resolutionType){const{name:e,message:o}=n,s=`[resolve] Resolving event error from external resolution [eventId=${t}, resolution.name=${e}, resolution.message=${o}]`;this.logger.error(s);const l=new r.w("external-resolution-error",s,e);return a.reject(l),void i.fail({errorCode:l.code,message:l.message})}const o=`[resolve] Invalid resolution type received. No changes on deferred promise for event [eventId=${t}]`;this.logger.error(o);const l=new r.w("invalid-resolution-type",o);throw i.fail({errorCode:l.code,message:l.message}),l}))}subscribe(e,t){const n=this.asObservable.subscribe(((t,n)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){if(n){const t=n.id;this.logger.log(`Resolver received app event [eventId=${t}]`);try{e(n)}catch(e){this.logger.error(`[callingAppEventResolver] handling app event error. [errorName=${e.name}, errorMessage=${e.message}]`);const n={eventId:t,resolution:{resolutionType:"error",name:e.name,message:e.message},context:{source:{name:"calling-app-event-resolver-error",description:`[callingAppEventResolver] Error processing event in resolvers [eventId=${t} error.errorCode=${e.name}, error.message=${e.message}]`}}};try{yield this.resolve(n)}catch(e){this.logger.error(`[callingAppEventResolver] error resolution failed in resolvers [eventId=${t}, errorCode[${e.name}], errorMessage[${e.message}]`)}}}else this.logger.error("[subscribe] Received invalid args.")}))));t&&this.handleOnResolverSubscriptionCancellation(t);return this.trigger({event:{typeName:"calling-setup-event",result:{resultType:"calling-setup-success"}},context:{source:{name:"CallingAppEventsService.subscribe",description:"subscribe"}}}),n}unsubscribe(e){this.logger.log(`[unsubscribe] calling app events subscription closed. [subscriptionId=${e}]`),this.asObservable.unsubscribe(e)}handleOnResolverSubscriptionCancellation(e){const t=e=>{let t=this.scenarioFactory.findScenario(e);return t||(t=this.scenarioFactory.newScenario(e)),t};e.subscribe({next:e=>{this.logger.log(`[callingAppEventResolver] cancellation listener next. [reason=${e}]`),t(s.RG.CallingAppEventsSubscriptionCancellationListener).appendEventData({reason:e||"cancellation-listener-reason-undefined"})},complete:()=>{this.logger.log("[callingAppEventResolver] cancellation listener complete."),t(s.RG.CallingAppEventsSubscriptionCancellationListener).mark("cancellation-listener-complete",{reason:"cancellation-listener-complete"})},error:e=>{this.logger.log(`[callingAppEventResolver] cancellation listener found an error. [errorName=${e.name}, errorMessage=${e.message}]`),t(s.RG.CallingAppEventsSubscriptionCancellationListener).fail({errorCode:e.name,message:e.message,reason:"cancellation-listener-error"})}}),t(s.RG.CallingAppEventsSubscribe).mark("cancellation-listener-subscribed")}}},722915:(e,t,n)=>{"use strict";var i,a,o,r,s,l,d,c,u;n.d(t,{cP:()=>i,cA:()=>a,lC:()=>o,JL:()=>r,XD:()=>s,WB:()=>c,k$:()=>u}),function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"}(i||(i={})),function(e){e[e.Calling=0]="Calling",e[e.RigelGallery=1]="RigelGallery",e[e.RigelContent=2]="RigelContent",e[e.RigelGalleryAndContent=3]="RigelGalleryAndContent"}(a||(a={})),function(e){e.MultiWindow="MultiWindow",e.SingleWindow="SingleWindow"}(o||(o={})),function(e){e[e.Chat=0]="Chat"}(r||(r={})),function(e){e.EndpointTransfer="EndpointTransfer"}(s||(s={})),function(e){e.MostSevere="MostSevere",e.Live="Live",e.Severe="Severe",e.Positive="Positive",e.Neutral="Neutral"}(l||(l={})),function(e){e.BannerNotification="BannerNotification"}(d||(d={})),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.Confirm="ConfirmDialog",e.OptionsSettings="optionsSettingsDialog",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="UserMedia"}(c||(c={})),function(e){e.OneToOne="OneToOne",e.GroupCall="GroupCall",e.Meeting="Meeting",e.Chat="Chat",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.Like="Like",e.Mention="Mention",e.Download="Download",e.AppUpdated="AppUpdated",e.NeedMoreDiskSpace="NeedMoreDiskSpace",e.TeamMembershipChange="TeamMembershipChange",e.Follow="Follow",e.OneToOnePstn="OneToOnePstn",e.Thirdparty="Thirdparty",e.MessageSendFailed="MessageSendFailed",e.CallTransferFailed="CallTransferFailed",e.ShareFromChat="ShareFromChat",e.Inferred="Inferred",e.Trending="Trending",e.MeetingWentLive="MeetingWentLive",e.PresenceStatus="PresenceStatus",e.Reaction="Reaction",e.Priority="Priority",e.TeamsTasks="TeamsTasks",e.Dlp="Dlp",e.TeamsEngagementActivity="TeamsEngagementActivity",e.MsGraph="MsGraph",e.StaffHub="StaffHub",e.CallAnsweredElsewhere="CallAnsweredElsewhere",e.CallSafeTransferRingback="CallSafeTransferRingback",e.SkypeConsumerCall="SkypeConsumerCall",e.SpamCall="SpamCall",e.Default="Default"}(u||(u={}))},379733:(e,t,n)=>{"use strict";n.d(t,{L:()=>u});var i=n(231191),a=n(118824),o=n(324819),r=n(722915);function s(e){switch(e){case 1:return r.k$.OneToOne;case 2:return r.k$.GroupCall;case 3:return r.k$.Meeting;case 4:return r.k$.Chat;case 5:return r.k$.Reply;case 6:return r.k$.ReplyToReply;case 7:return r.k$.Like;case 8:return r.k$.Mention;case 9:return r.k$.Download;case 10:return r.k$.AppUpdated;case 11:return r.k$.NeedMoreDiskSpace;case 12:return r.k$.TeamMembershipChange;case 13:return r.k$.Follow;case 14:return r.k$.OneToOnePstn;case 15:return r.k$.Thirdparty;case 16:return r.k$.MessageSendFailed;case 19:return r.k$.CallTransferFailed;case 20:return r.k$.ShareFromChat;case 21:return r.k$.Inferred;case 26:return r.k$.Trending;case 27:return r.k$.MeetingWentLive;case 28:return r.k$.PresenceStatus;case 29:return r.k$.Reaction;case 30:return r.k$.Priority;case 34:return r.k$.TeamsTasks;case 35:return r.k$.Dlp;case 36:return r.k$.TeamsEngagementActivity;case 37:return r.k$.MsGraph;case 38:return r.k$.StaffHub;case 40:return r.k$.CallAnsweredElsewhere;case 41:return r.k$.CallSafeTransferRingback;case 42:return r.k$.SkypeConsumerCall;case 43:return r.k$.SpamCall;default:return r.k$.Default}}var l=n(735736),d=n(909446),c=n(917034);class u{constructor(e,t,n){this.loggerFactory=e,this.coreSettings=t,this.callingAppEventsService=n,this.logger=this.loggerFactory.newLogger("CallingNotificationService"),this.logger.log("Instantiated CallingNotificationService"),this.notificationsMap=new Map,this.callToNotificationMap=new Map}createNotificationWithActions(e){var t,n;const{enableCallingNotifications:i,enableOutgoingVideo:l,enableIncomingCallCrossClientTelemetry:d}=this.coreSettings.get(a.J.Calling);if(!i)return this.logger.log(`[createNotificationWithActions] Feature flag enableCallingNotifications, current value: ${i}), is required for incoming call notifications is not enabled`),this.getNoopReturnValue();const c=(0,o.v4)(),u=Date.now(),m=[],g=[],p=e.sourceId||"sourceId";if(e.actions)for(const t of e.actions){const e=t.actionType;if(!e||"Unknown"===e)return this.logger.error(`[createNotificationWithActions] unknown action type for action ${t}`),this.getNoopReturnValue();l||"AcceptIncomingCallWithVideo"!==e?(m.push({actionType:e,id:c,label:t.label||"",icon:this.getNotificationIcon(t)}),g.push({action:t.action,actionType:e})):this.logger.log(`[createNotificationWithActions] Feature flag enableOutgoingVideo, current value: ${l}), is not enabled video button cannot be added`)}(null===(t=e.timeoutAction)||void 0===t?void 0:t.action)&&g.push({action:e.timeoutAction.action,actionType:"TimeOut"}),this.addTelemetryCleanupActions(e,g),this.notificationsMap.set(c,g);const v={typeName:"calling-content-event",action:{visibility:r.cP.Show},content:{id:c,contentType:"notification",image:this.getDefaultImage(e.type),title:e.title,subtitle:this.getSubTitle(e),time:u,userid:e.callerMri||"",type:s(e.type),primaryAction:(null===(n=e.primaryAction)||void 0===n?void 0:n.actionType)||"AcceptIncomingCallWithAudio",actions:m,toastType:e.toastType}};e.headerData&&e.headerData.headerTitle&&e.headerData.headerMessage&&e.headerData.headerMri&&(v.content.header={defaultImageDataUrl:this.getDefaultImage(e.type),title:e.headerData.headerTitle,subtitle:e.headerData.headerMessage,mri:e.headerData.headerMri});const h=this.getRingtoneAssetUrl(e.ringtoneCallType);h&&(v.content.ringtoneAssetUrl=h),d&&(v.content.callId=null==e?void 0:e.callId,v.content.crossClientScenarioName=null==e?void 0:e.crossClientScenarioName);const f={event:v,context:{source:{name:"CreateNotificationWithActions",description:e.sourceId||"undefinedContextName"}}},y=v.content;return this.logger.log(`triggering callingAppEventsService id=${y.id}, type=${y.type}, sourceId=${e.sourceId}, callId=${e.callId}`),this.callingAppEventsService.trigger(f),this.callToNotificationMap.set(p,f),this.getNotificationWithActions(p)}executeCallingToastCallback(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.canTryGetEntriesForToastId(e,t))return Promise.resolve(!1);const i=this.tryGetEntriesForToastId(e);if(!i)return Promise.resolve(!1);const a=this.tryGetEntryForActionType(i,e,t);return a?this.tryExecuteCallback(a,e,n):Promise.resolve(!1)}))}canNotifyForActionNotification(){return this.logger.error("[canNotifyForActionNotification] NYI"),!0}getAppUserSettings(){this.logger.error("[getAppUserSettings] NYI");return{soundsSettings:{alertSound:"All"}}}getAriaShortcutLabel(){return this.logger.error("[getAriaShortcutLabel] NYI"),""}getCallGroupMembershipSettings(){var e,t;const{voiceAdminSettings:n}=this.coreSettings.get(a.J.Calling);return Promise.resolve({callGroupMembershipDetails:null!==(t=null===(e=null==n?void 0:n.callGroupMembershipSettings)||void 0===e?void 0:e.callGroupMembershipDetails)&&void 0!==t?t:[],callGroupNotificationOverride:"Ring"})}cleanupNotificationsTelemetry(e,t,n){this.logger.log(`[cleanupIncomingCallTelemetry] Handling incoming_call scenario with reason=${n} for sourceId=${e}, actionType=${t}`);const i=this.callToNotificationMap.get(e);if(i&&i.event&&"content"in i.event&&i.event.content&&"notification"===i.event.content.contentType){const e=i.event.content.id;this.notificationsMap.has(e)&&this.executeCallingToastCallback(e,t,n)}else this.logger.error(`[cleanupIncomingCallTelemetry] Corresponding event not found for [sourceId: ${e}`)}getPanelActionScenario(){return this.logger.error("[getPanelActionScenario] NYI"),l.Lc.closeActiveCallBanner}isSfCNotificationEnabledDesktop(){return this.logger.error("[isSfCNotificationEnabledDesktop] NYI"),!0}isSpamNotificationEnabledDesktop(e){const{enableSpamCallNotification:t}=this.coreSettings.get(a.J.Calling);return Boolean(!e||t)}shouldMuteAudio(){return this.logger.error("[shouldMuteAudio] NYI"),!1}getDefaultImage(e){return e===d.qp.meetingWentLive?"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTkyIDE5MiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjZWRlYmU5IiBkPSJNMCAwaDE5MnYxOTJIMHoiLz48cGF0aCBkPSJNNzguNTI4IDEwMC4xMWE1LjEzOSA1LjEzOSAwIDEgMCAwLTEwLjI3NyA1LjEzOSA1LjEzOSAwIDAgMCAwIDEwLjI3N3ptMjIuNjEyLTUuMTM5QTUuMTM5IDUuMTM5IDAgMCAxIDk2IDEwMC4xMWE1LjEzOSA1LjEzOSAwIDEgMSAwLTEwLjI3NyA1LjE0IDUuMTQgMCAwIDEgNS4xNCA1LjEzOHptMTIuMzMyIDUuMTM5YTUuMTM4IDUuMTM4IDAgMSAwIDAtMTAuMjc4IDUuMTM4IDUuMTM4IDAgMCAwIDAgMTAuMjc4em0tMjkuODA1IDExLjMwN2E1LjE0IDUuMTQgMCAxIDEtMTAuMjc4IDAgNS4xNCA1LjE0IDAgMCAxIDEwLjI3OCAwek05NiAxMTYuNTU2YTUuMTQgNS4xNCAwIDEgMCAuMDAxLTEwLjI3OUE1LjE0IDUuMTQgMCAwIDAgOTYgMTE2LjU1NnpNNTkgNzEuODQ3QzU5IDY0Ljc1NCA2NC43NTIgNTkgNzEuODQ3IDU5aDQ4LjMwNkMxMjcuMjUgNTkgMTMzIDY0Ljc1NCAxMzMgNzEuODQ3djQ4LjMwNmMwIDcuMDk1LTUuNzUgMTIuODQ3LTEyLjg0NyAxMi44NDdINzEuODQ3QzY0Ljc1MiAxMzMgNTkgMTI3LjI0OCA1OSAxMjAuMTUzVjcxLjg0N3ptMTIuODQ3LTcuNzA3YTcuNzA2IDcuNzA2IDAgMCAwLTcuNzA3IDcuNzA3djMuNTk2aDYzLjcydi0zLjU5NmE3LjcwNiA3LjcwNiAwIDAgMC03LjcwNy03LjcwN0g3MS44NDd6bS03LjcwNyA1Ni4wMTNjMCA0LjI2IDMuNDUgNy43MDcgNy43MDcgNy43MDdoNDguMzA2YTcuNzA0IDcuNzA0IDAgMCAwIDcuNzA3LTcuNzA3di0zOS41N0g2NC4xNHYzOS41N3oiIGZpbGw9IiM2MDVlNWMiLz48L3N2Zz4=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAADsiSURBVHgB7d17bFz3deDxc+8MXyIl6mXRci1IFhW7yUayngtTsFMJsCy5QRA7COAFbGy8Gxc24C6QKCjcAE2Ljf8IvEWcAFsD9hZFk4W9u0bRSt2gtRWpkJpoSbcWRVly4zgOFQlyJNGWKVEkxdfM3L3nkkNTFMl53N+9cx/fD8DMiJIda0jOOb/zO7/zswRA5O06ejQ71tBQ19DU1CCFkZX6uUa77k7vN+1Mu/dgFW7Li9Wmzy3H2T7zn3ccWWNZslbKd7z4xBLntwXLvjT9a8d613tSyPfqw2hh4sMGp354LJMZGRsZGWsYG5s4tnt3TgBEmiUAasdxrI6ursYl9fVLC42ZtkyucJdY1nLHcj6vQbyKwB0Z7n/7edty3tLkISNOXyHvvJWvy16zR/N9miwc27x5wP27OgKgJkgAgIDp6r1h8eLbigHetp17Co58Mc7B3ZRikmBZ1qlCwXo/n7V/MzEh57SS0LVz54gACAwJAGDITYE+72yzJL+n4Fj3pT3I++FuP7zuJQdu9cDJW+9fHx+/RmIAmEECAFRqqmzfsqTpHgJ9+LRqILZ1wCrIz4oVg2NbtlwTABUhAQBK6OjsbJoZ7B2xHhNEjlYLHDtz2JK6Y9cGBy9SKQAWRgIAzOSu7nedOtXaaBV2O7Z8QQrOo6zs42m6UpAv/P2oZE/RdAjcjAQA6eYG/L3d3bdbWS3hFx5jdZ9sXpXAsV93cs5bh7Ztu0xCgDQjAUC6zFjhE/BRTAhGHfsofQRIGxIAJF5xD98uFL5GSR8LcSzrhwXb/vHQ9ZH36SFA0pEAIHlmrPLFcva7n7lfgIo5x8XO/Gg0Z/0t1QEkEQkAkkGD/smu9oa6hmdZ5cM0bSjM2PKyYzX8zciVK+cZdYwkIAFAfLlBf8+/nbpXS/uW43xDgJDoVoFt1f8FyQDijAQA8ULQR8SQDCCuSAAQfQR9xEQxGXjj858/yxFDRB0JACJrV0/P0kYr/4z7LvoMe/qIHdt+yhkr/OOh7dsvCRBBJACIFA36TQ3OvYXxwo8J+kiGqdMEVwZ+zBYBooQEALVHiR8pwRYBooQEADUzWeIv7HbE+QGrfaSJHiu0MvbzVAVQSyQACJfO3j95sl3q5FlW+8CMqsDGjb0ChIgEAOFwA//D7/V8gb19YD70CiBcJAAIVLGT3/1O+54AKI9tPzUwOPq/uI8AQSIBQCA08DdkCn9GmR+oHtsDCBIJAMyZ6ubP5PP/XbiABzDIOW7ZjU+SCMAkEgD4x/4+EJLJRICxwzCBBADVI/ADNeImAnWZPxnpG/h/JAKoFgkAKkfgByKCRADVIwFA+Qj8QESRCKByJAAojcAPxASJAMpHAoD5EfiBmOLUAEojAcCc9nZ3b5CMc4TAD8QZiQDmRwKAm3gDfOzcy5ZYjwmAhCARwK1IAOBhch+QfDpZcOyT639EfwAUCUDaufv8D53p/rLtyAEBkA62/RSXDoEEIMUe/sXJ36PBD0iryRMDb3xu6z8LUokEIIW8G/rs/E+Eef0A6A9ILRKAFNl19Gi2YcWSP2efH8At2BZIHRKAlKDcD6AcVp29i22BdCABSDjK/QAq5xwfGJ54qGvnzhFBYpEAJBXd/QD8Ylsg0UgAEmjviROrJStdlPsB+EeTYFKRACQITX4AAkM1IHFIABLi99/t2ZzP5Q+y6gcQHKoBSUICEHOs+gGEjmpAIpAAxNjDZ860F/Jj/8SqH0D4qAbEHQlAHDmOte9M93PiyPcEAGqJakBskQDEDOf6AUSPc3y0kP3SsS1brgligwQgRh46feIRzvUDiCqmCMYLCUAMeI1+y1tetcR6TAAg0txqQP/QbrYEoo8EIOI43gcgbhyR8/lx59EjO3b0CCLLFkST41hfPPP21wv5fA/BH0CcuCvLtdl66+S+Mye/ru9lgkjiCxNBHRc6m1r7638qNPoBiD22BKKKBCBiKPkDSBq2BKKJBCAquL0PQMJZVubRNzZtOSiIBBKACKDLH0B6sCUQFSQANaaDfRqs/ClK/gDSg8FBUUACUEO6369d/gIAKcTgoNriGGAtzDjiJwCQUs5E4djDp3seEdQEFYCQsd8PALPRF1ALJAAh4nw/AMyHJCBsJAAhefjMmfZCfuyfaPYDgLnpvACZkI5D27dfEgSOBCAE+3re3iW2dVQAACXRHBgOmgADplf4EvwBoHw0B4aDBCAojmPtPd39Ayb7AUDlHCd/YN/pE3/MZULB4YUNAJ3+AGAKzYFBIQEwTIN/4/LFWvKn0x8AjCAJCAJbAAbpMT+CPwCYZt3fuLzlaEdnZ5PAGCoAhjDTHwCCpccErw+Pf7Zr584RgW8kAAboGX+nMPZrAQAEzslZnzm0bRvvuT6xBeCTXuhD8AeA8FhZ54MH3357i8AXEgAfdMAPF/oAQPiy9dbJh39x8vcEVWMLoEpM9wOA2mNqYPVIAKpA8AeA6CAJqA4JQIUI/gAQPSQBlSMBqADBHwCiiySgMiQAZSL4A0D0kQSUjwSgDAR/AIgPkoDykACUQPAHgPghCSiNBGABBH8AiC+SgIWRAMyD4A8A8UcSMD8SgDnoeF8m/AFAMuTGna1HduzgPX0WEoBZuNgHAJKHC4RuRQIwQ8eFzqbW/vobAgBInNFCZtmxLVuuCTxcBjRFg/+ST+rfEwBAIjXY+VMdnZ1NAg8JgGvX0aNZd+X/U8uStQIASCS35L22tbnup/qeL2ALQL8RGpcv1m7/+wUAkALO8dH+od3Hdu/OSYqluwLgOBbBHwDSxrq/YXnLqxoDJMVSnQDsO9P9nBD8ASB1LLEe23vm5IuSYqnNfh46feIR25EDAgBILcvKPPrGpi0HJYVSmQAw5Q8AUJTWaYGpSwAY9AMAmC2Ng4JS1QOgHf+F/Ng/CQAAM2WdI2mbEZCaBKB43I+z/gCA2dI4IyA1CQDH/QAAC0vX8cBUJADa8S8EfwBACXo8cN+7Pf9ZUiDxWQ4d/wCASqXhCuFEJwC7enqWNtr5qwIAQIWSfntgYrcAvKY/O/8TAQCgCnp7YJKbAhObAND0BwDwQ08GJLkpMJEJAE1/AAATtCnw4TOnviwJlLis5vff7dlcyOcT3bgBAAhXEpsCE1UB0L2afC6fyksdAADBydRbB5I2KTA5CYC7R8OkPwBAEIqTApPUD5CYBGDv6X/9urDvDwAIjHV/koYEJSKTYd8fABCWpPQDxL4CwL4/ACBM2g+QhPkAsU8A2PcHAIRpej5AzMU6AfDm/LPvDwAImTcf4HTPIxJjse0BYM4/AKDW4nxfQCwrAMz5BwBEQaOd+0lcjwbGMgFoWL7oSaH0DwCoOev+fWe6n5MYil3Wsre7e4OVdT4QAAAiwpmQOw5t335JYiRWFQAt/bvB/68FAIAoqZOuuB0NjFUCQOkfABBF3tHAFUv+XGIkNlsAlP4BAFEXpymBsagAUPoHAMRBnKYExiIBoPQPAIiDOG0FRH4LgNI/ACBu4nAqINIVAEr/AIBYqpOuqA8IinQCQOkfABBHuhXw8JlTX5YIi2x20nHhQlNrf98NAQAgpqJ8V0BkKwBu8P+pAAAQY95dAREVyQSAa34BAMlg3T8V0yInclsA3k1/yxdPCAAACeCInB/rH9xwbPfunERI5CoAU41/AAAkQlRnA0SqAsCZfwBAUkWtITBSFQDO/AMAkipqDYGRSQBo/AMAJFu0GgIjcWGBd3GCbT0vAHxbVVcv65sWye319dJW1yDNmYy06XP3Q7XVN8z5z/WNj8lQPi/DUx994+PSNzEmvSMj7q9zcnZ0RAD449jWj8Rx7hLLcqTGIpEAMPEPqI4G+00ti6W9cZFsbGlxg/5kwK+GJgZtC/y+JgW9IzfkrJsQvDM8KL9xn/dNjAuA8hUnBL4hclBqrOZNgBz7A8rXbGfc1X2T7FyyTDpaW+ddzYelmBAcvvqJnHGTAgDliUJDYM0rAA3L9WhEzSshQKRtbG6RPctWys7WpVWv8IPQ7m416Mee5Su8CkHnwDXpvH5N3roeycmnQGQ0ZAp/5j58U2qophUAjv0B81vf2OSu8pfKoyvbIhX0y6H9A6eHBuW1votsEwDzqHUVoKYVAI79AbfS1f4TbXd4e/txpQ2HWhXQD00EXu27xBYBMEuDnXvZffgPUiM1qwCw+gduloTAvxCtCrzqVgSOXP1EAEyy7IYNb2zc2Cs1ULMEYN87J34udP4DiQ/8s5EIAJ/SewIObdpWk2OBNUkAWP0Dbpm8rl72r1mXmsA/W9fANXnl4gV6BICCs/vNLTuOSchCTwCmjv0dFVb/SCk9yvfIbau8VT/EqwYcvPKRd4oASKNaVQFCTwC8MYi2dVSAFNJy/7fW3DU9lQ+TdFvgxQvn5DSNgkirGlQBQk0AWP0jrXTV/8Ttq+WRlW2C+R38+CN55dIFAdKmFlWAUC8DalzaooGf4I9U0b3+l+7+HMG/DLo18qPf3ei9ZkCa6IjgfadO/J6EKLQEgAt/kEYPLlvhBX9K/uXT12oyYVolQJpMXRQUWmU+tASA1T/S5uk77nT3+9fFbopfFOhr9vQda+TxttUCpEXYVYBQEgBW/0gT3e9/Yf3dlPwN0JMSf7q2nSQKqRFmFSCU/xM6/5EWunf9nXUbpL2pSWppOJ+T3tER76a+vvExr8v+I/djKJ+XoULuliN3GmBb7KxXftfn+qg3DerNg+2NTe7nantvmP73P9f7PjMDkA4hnQgIPAGg8x9pocH/hfZ7arLfrwG/8/qAnBkalNNDQ26gHBOT2hsXecmADi3So4y1uIaYJABpEdaJgMATAKb+IQ1qEfw16B++2u9N1Av7/Pym5sXeRT9hJwMkAUiNEKoAgScAzPxH0oUd/DXYv3b5UmSG5nQsWeolA/oYBpIApEEYVYBAEwBW/0i6sIJ/cbV/8EqfFwCjSF8DbdrTo49BIwlAGuTGna1HduzokYAEmgCw+keSabd/GGf8dU6+zsuPy6z8sBKB3pEb8tzZX3GHABLMOf7mvTsekIAElgCw+kfS6fG0jtbgyt5a4tf5+FFd8ZcSRiJwemjQSwKApBotZJYd27LlmgQguDkAWXlWgITSATVBBX89tvfdc71uiftXsQ3+Sv/bv+8mMJNJjNlTCUV6KuHp1WsESKqGTOHPJCCBVAB29fQsbbTzVwVIIB1Rq1PqgnDk6ify8sULiStrB10N0ERDXzsgiYKqAgRSAWiwx78qQAJp058GMtO0ye+Vix96gSyJe9rFasArASU3z7gJGRcIIakaM/lnJADGKwBTg38mBEgg76Y6w01/Wh7Xfew4l/sroa+fjko2PT9AX79nP/gFTYFIpDc3bbNNHwk0XgFoWL7oSQESSC/3MR38tZP92Q/eS03wV94RPjfh0b+7Sd42wyrz1RkgCoK4JMh4AmBJ5msCJIxOvDN9uY/uWf+hG/zTuGLVJED/7kf6ze7bP3LbKm9KIZA0QVwSZDQB0KN/wrl/JIye9//WmrvEJD3br3viaff9D895r4VJ+7mCGQmkVwU//O6768UgsxUAjv4hgXRVabL0rwFPm+EwSV8Lk0mAfq30pAaQNAVn/A/FIGPlBJr/kETaWf6jz24UU7Tsz8p/bt+6c508uNzcMcEn3zvDqGAkjskjgcYqADT/IYlMnvfXpjeC//x0O8BkY6BuBQBJ05gt7BZDzCQAjmMVJPMnAiTInmUrjE3706N+z5/vFSxs8jikmamBOiWQhkAkjVNwfmCqGdBIArD35Mn2jMhaARLkcUMDf3TIT5rO+fuhJyJMXvCjI5uBJNFmwAdPnNgsBpipAND8h4TR1b+pxr9X+y4T/Cugr5XefmgCVQAkUabB/o9igO8EQJv/LHG+IUCCmFr9H776iRy80ieojJ4KMDUjgCoAksZynG/onTvik+8EgOY/JI0O/TGx+te97NcMrWTT6OVLF4z0A1AFQBI1Ss73NoDvBIDJf0gaU5f9vNp3idK/D9oHoBckmUAVAEnjTQb0yVcC8MCJE/pTxeQ/JIae+9cVo19a+ud6Wv+6rl+T00OD4pd+Tdc3NgmQFNoM6HcbwFcCsKgu/0UBEsTU6p/SvzkvfnhOTDB1pBOICr/XBFefADiO5Zb//1KABNloaPVP6d8cfS1NjAp+1PBlTkCtOY4842cmQNUJgJ79FyBBOpYsNdL8x+rfPD0W6Hc2gF4QRDMgksTvTIDqKwCc/UfC7Fziv0TM6j8YGvwPX70ifpm8awCIAj8zAapKADj7jyQysUfM6j84JrYBNMnjqmAkic4EqHYboKoEoGHJknUCJIie/fcbGLRjndV/cPS19XsiQL/G7Y2LBEiSarcBqtsCoPyPhHlo2Urx63A/x/6C9lrfJfHrvtZWAZKk2m2AihMAyv9Iorua/K0KdWKdVgAQrNPDg76bAXcuWSZAklS7DVBxAkD5H0mjw3/am/wNiTk9PCQIh99mQD3pscrQRU9AVFSzDVD5FgDlfyTM+ib/e8JHKP+HpmtgQPziOCCSppptgIoSAMr/SKJNLS3ih5b/tTSNcJjYBljfxFhgJEs12wAVJQCU/5FE6312hVP+D1/n9avix71UAJBAlQ7oqygBsOqcrwqQMO0+twBMXFaDypwZ8pd0tdU3CJA4dZVt0VeUAOR17jCQIHpDnN/z/2dHbwjC5XfLRb/mNAIicRzn0Uq2AcpOAPTaQfdtcq0ACeI3+Ote9NmREUG4dCiQ3z4ABgIhabwrgk+dKnvQRdkJQIM9TvkfieO3/N/L6r9mekf8vfZtVACQQI3Zwu5y/2zZCYAlma8JkDB+g4DfIITq+d16YQsAiVSQ/eX+0bISgI7OTj0zc78ACdNW568Z7CNm/9eM33sXWjJZAZLHuX8qZpdUVgKwdFHd7wqQQH57ALj8p3b8vvZsASCpmuvKi9llJQAFq/r7hoEoa/a5CvTbiIbq6QAmP/xWf4CoKncqYFkJANP/kFQtmeouxCy6POEvCKF6wwWSL2BOZR4HLPnup8f/BEgovwNhqADUzpDP154tACRVuccBSyYAdYXxso8UAGlDAlA7vPbA/Mo5DlgyAbCz1mMCAABiwykUSsbuhRMAdw/BEpsEAACAGLHEXbyX6ANYMAF4oLv7dgEAALGzt0QMXzABaLTy9wmAefmdI4Dq8doDC7MarAVj+IIJAPv/SDq/Z8kJQrXTwhAnYEGl+gDmTwDY/wdKaiEBqJlVdf6O8Q3ncwIkWak+gHkTgEquFATiyvc4WabJ1YzfWf5DDBJCCiwUy+dNABolt1mAhOvzOcmPYTK14/e1Z44A0mCheQDzJgCObX9ZgITzGwS4UrZ2/CYAl8cZ44zkcxz5wny/N28CUBDnUQESzu8WQHvjIkFtrPf52nOVM1LBmT+Wz5kA6F3CGZG1AiSc7wSgiQSgVvy+9mdHRgRIOr0XQGP6XL83ZwKwpKHhdwRIgbOjN8QPPQbINkD41jc2+T6COVTgFADSobmu7nfn+vzcWwDZ3C4BUkArAH77ADY1LxaEy+/qX7/mVACQFtnGzNa5Pj9PD4D1oAApcdnnNsCmFhKAsPlNunp9Vn6AOHEK+T1zfX7OBIABQEiTM8PXxY+dS5YKwrXRZ9LVO0ICgPSYbyDQLQnArp4e3s2QKn5LwboXzTZAeDY2t/g+AnhmaEiANOno6mqc/blbEoAmK3eXAClyenhQ/LqvlcGZYXlo2Urx6yxbAEiZuRoBb0kAcvnCOgFSRBsB/V4KZCIooTx+y/9n3fI/FwEhbeZqBLwlAbCz2S8IkDJd16+JH2wDhKNjyVLf5f/eUbr/kT5zNQLekgAwARBp1DUwIH493rZaEKw9y1aIX0f6PxEgfaz7Zn/mpgSACYBIKz0W5nsegFuabqtjKFBQ9LXtaPXXo6xfYxM9H0Dc6ETAXUeP3nSF5k0JQLa+nhMASCUNDJ3Xr4pfX75tlSAYT7TdIX51+tzqAeKsYfHi22b++qYEoDnj3CNASh3p7xe/tBnQ74ha3EpX/w8u91/+7xogAUB65R3n9pm/vrkHIHPrHgGQFloa9rsNoMH/iVX+V6q4mYnVv5706KICgBSbfRLgpgTAcQqbBUixA1f6xK9H3G0AegHMMbX6Pz3M8B+k2+yTADclAIwARtqZWiHuX7NOYIaJ1b96re+iAOl2c5V/OgGY775gIE10LPDpIf9d4noioIM7AnzTY39mVv+DDP9B6s0+CTCdADQ0NTUIAHeleElMePqONTQE+qCl/8dNrf4vm/maAnE38yTAdALAHQDAJF0tmqgC6MS6p1evEVRHS/9+p/4pbf7j7D8waeZJgOkEgDsAgE+ZqgLsccvXj6xkNkCl9DUzUfpXr/ax+geKso32uuLz6QQgU5dhBgAwxVQVQHkrWU4FlE1fK1ONf7r6P3KV0b/AtIn89K2A0wkARwCBm5mqAmgfwAvt99APUAYN/iZfK1b/wCyZzO8Xn04nAAWxGQIEzGCyCqB72S+sv1uwsO+s22Bk31/pkU5W/8DNHHGmG5MmEwDHsbgECLjVix+eE1PamxbJ/jvXCea2f81a9zUydxr5lYsXBMDN9Cigxnx97iUAu06dahUAt9Cz468aHCCjTYGcDLjV03fcKXuWrRRTdPuGc//A3Dq6uhr10UsA8vk8Q4CAeRy88pHXTGaKjgomCfiUBv9HVraJKfq1MjHSGUiqJVM3/3oJQEv25huCAHxKLwh68cJ5MUmTALYDJsv+JoO/0q+V30udgCQrzgLwEgDHEbYAgAVoQ6BWAkzS7YC/+MxnU3lEsNnOuH/3zxkt+yv9GjH0B1hYcRbAZBMg1wADJWkvgMmtAKWNgXrsLU1JgP5dX7r7c0Yb/pR+bWj8A8phLdf/naoAWGZrcEACaVn5ubO/Ml5e1mNvGhDTMDFQ/476dzV11K9oOJ/zvjYASnMK+c/r49QcgPxqAVCSdpYHscrUwTd6eZD2BSSxGqAl/z9d2x7YBUmv9l2m6x8okyX2dn30rgXUIUDMKAPKc/jqJ7LeLd0HsWLXvgC9Sli3G5IyxEavRdbAb3rVX6RH/g7S9Q+UrTgMyEsAGAIEVEarALpS72hdKqZpoPzWmnWyqXmxG9wuSt9EPFe2+vrs17+Hm9AERaf9mZzTAKSBNRXzrV1Hj2Ybly+eEAAV8Wb8r7/ba+QL0uH+T2KVCGi5/4nbVxs/3jebNv09+8F7HPkDqjDaP1hndXR2NrU2198QABUrzvhvq2+QoEU9EdAVvwZ93cYI+uIjDf7a9Me+P1CdgeHxRdaunp6ljXb+qgCoSphJgOoauCY/vfqJvOWWv6NgY3OLd31vkKX+mQj+gH+jhcwy64ETJ1Y31wmbaIAPYScBSgOg3laoTYlnQh5+o0F/55Jloaz2ZyL4A2Y4Oesz1t7uzg1Wtv4DAeBLLZKAomIyoFPwzo7ckLOjI2LSKre8ryt8bUzc2bo01KBfRPAHzPESgH09b+8S2zoqAHyrZRIwkzbG9WoiMDIifRNjctkNmvo5DaL6OFy4uXFOG/c0qLe4H6vc//bb3b9HW12DrG9q8pocaxHwZ9K/y/Pnewn+gCkFZ3dWABijAUo7079157pAjgiWSwO2t2IPaV8+SHrU7/sXztHtDxhmO05hgwAwRgPVd93Vqg6ogT96uc93z/US/AHTspl2KgBAQHRAzVA+53XI17qEHjc62/+Vi7+Vw1evCIBg2JLJ/jsBEAhdwT77wS+M3yKYZMUBPwR/IEATuVW2AAiU9gU8+ct3vWQAC5tMmN6j2Q8ImJOxVrEFAIRE7w/QIT7716yt+SmBqNFV/4sXznvHGAGEw+YqYCA8GuB0hUuD4Kf0tdDXhOAPhEevBM66//M7AiA02tGuDYK6x63X5Op1uWmkAf/FC+co9wM1whYAUCMa+PSI255lK+TxttWp2RbQwP/a5Uus+IEaIwEAakxn+etH0hMBAj8QLda+d044AiAydN7+47ev9h6TgMAPRI8b+M+TAAARpfcK6BAhvXkvblUBHeRz8MrH0jlwTc6O3hAA0UMCAMSANgrqLXwdS1qlORPNnTsN+p3XB+RI/yes9oEYIAEAYka3BvYsXyF36U19jYuklvSmwa6BAW++Qa+70mdmPxAfNAECMaOr6+IKW7cJ1rtJgN76513d29gUWIVAV/iXJ8blzNCQnB25IafdR00AAMQTCQAQY3qUUD/0ytwirQro5UOaEGjvgCYJ+mv9aHE/2urm7icoBvPiv1NX8zqhT5+fHRkh2AMJQwIAJEzvVNMd+/AAFsJlQAAApBAJAAAAKUQCAABACpEAAACQQnZe5LwAAIBUsTMiFwQAAKSIdZwtAAAAUogEAACAFCIBAAAgZRwp/NZ2xDohAAAgTS5RAQAAIIVsy3L6BAAApIrt5PJXBAAApIZlZ95lCwAAgBRytwDsXwsAAEiPXL43K0CENdsZ2diyWO5tXizNmYysb2qSFvexrb5BgKjoGx+ToXxePhofl97RG9I7MiK/GbkhfRPjAkRV1ilMfGjZ9QJExcbmFtm5ZJl0tLYS6BEL+n3a5j62Ny1yv2+XTn++z00ITg8NyuGrn8iZ4UEBosIp2B9SAUAk6Er/kdtWSceSpd6bKJAEbfX1smf5Cu9Dk4FX+y7KGTchoDKAmnOcYWtXT8/SRjt/VYAaKAb+R1e2eSV+IOmG3a2CA1f65Ej/JyQCqJnRQmaZ1dHZ2dTaXH9DgJA9snKVPNF2B4EfqVSsCBxxtweAsA0Mjy+ydh09mm1cvnhCgJC01dXL/jXrZFPLYgHSThOB53rfpxqAUI32D9ZZ+mTfOyccAULw4LIV8swda1j1AzPotoBWAw5e+UiAMLx573bLawLMi5x3347XChCgx9tWeyV/ADfThPjpqcT4tb5LAgTJXfGf10dvEqAb/C8IEKD9a9YS/IES9Gdk/53rBAiW85b+r5cAcCUwgqTBf8+ylQKgND0y+ML6uwUIkFdmmrwLIJ/7NwECQPAHKqcNslQCEBQr73jNJl4CUHCEcygwTvf8Cf5AdbQS8PTqNQIYZ1ld+uAlANmMfU4Ag4pn/AFUT4dk6c8SYFIuJwP66CUAQznrsgCG6Dl/gj9ghv4s6c8UYErGmoz5XgKQGx+/JoAhL7Tfwzl/wBD9WdLBWYApY5nMiD56CUBXR8eoAAbsWbbCuwAFgDnaFMhWAEw5tnmztwUweRugZTn5d04wDAi+aJny8YBK/8P5nHReH5CzIzfkzNCQd/d638SYALWmK/Tb6xpkfVOTF6g7lrS6nzN/0apuBei1wjo1EKiWNwTIjfn6fPq7dGoYEAkAqqYNS6ZX/33jY954VN74EFX6fdmbvyG9oze871OllTA9BdNW3yCmaKKhVQAmBcKfySFAyp7+nCX/IECVdPX/yMo2MUVX/PpG9+Qv3/USAII/4kQTAf3efeWi2SGrXJsNv6y8807x+XQCkJ/Ivy9AlUze7Ker/mc/eM+7HAWIM01en/zlGe972oRiFQCoWl3ml8Wn0wkAswDgh6m9f32jfO7sr7wrUoEk8K77db+ne0duiAmPGqy0IX1yo4VzxefTCQCzAFCtjc0tRvb+Cf5IKv2efv58r5FKgFYBNjWbq7ghXXLZ7G+Kz6cTgMzg4McCVOEhQ+N+Cf5IsmIlwEQ/y32trQJUY2xkZDoLnU4Aju3enctP3REMVGKjgf1/bfgj+CPp9HvcRG/LziXLBKhG186dI8Xn9szfsKXwlgAV0O5/v+V/LYvS8Ie00MZAv1sB+jO3ioFbqJAjzuszf31TAiB554gAFVjftEj8epVzzUgZTQL8og8AlZp5BFDdXAGw7W4BKrCppUX80P3QI1e5jRrpYmKwlU4eBCoydQ1w0U0JACcBUKm2On+Tzjqvcw8V0keDf+f1q+LH7QanDCIdnLx107yfmxIATgKgUqt8vgmdHhoUII30Tgs/uCIYlbo+6+bfmxIATgKgUi0ZW/w4O2pmOAoQN34HAwVx4RCSSy8BmnkCQN3y7s1JAFTC72UnHP1DWvVN+Pve59ptVMY5MPszty7fOAmAEHHJD9KK732EybLtn83+3K0VAE4CAACQKDPvACi6JQG4dmPilwIAABJj5h0ARbckAF0dHaMCAAAS49iWLbecub61B8CyHEcKrwtQBr8jTRlnirTy28RHDwHKNXsEcNHcZ7hoBASAQDXbGfFjiAQAZbIkc3iuz8+ZANAIiHIN5Qvix+11TDNDOjVn/CUAw/mcAOVwcs4/z/X5ORMAGgFRLr9vQmwBIK1afA7yGSpQAUB5ro+N/Xauz8+ZAOi0ICYCohx9E/56AFp8roKAuKIHAGGYawJg0bxzXG2xDghQgt83ISoASCu/CcBlnw24SAtn3lg+bwJQyOV+JkAJfkf5cqMZ0mp94yLx4yPGaKMMVkH+fr7fmzcBmLDrjwpQgt8EwO+bIBBX7U3+vvfPjowIUMqoZE/N93vzJgDHNm8eEKAEv7f5aRm0mT4ApIx+z/v9vh8qcAoApS0Uy+e/y5WBQCiDidv8NjUvFiBN1jc2iV9UAFCKNwDIjeXz/f6Cl7kXcg4JAErq9flGtLGlRYA02dTiL+k9O+Kv8oZ0sGx7wRi+YAIw6mTeEqCEs6PD4kc7fQBIGb9Vr74JGgBRmjPmLBjDF0wAfr5t22UBSvBbitTVEH0ASAv9XvdbATg9NChAKYdKxPAFEwD6AFAOE3uR9AEgLUx8r7P/j1JK7f+rhRMAoQ8ApZ0eHvQ9EKijdakAabBzib/vdf1Z0585YCGl9v9VyQSAeQAoR6/PpiR9U2QbAGngN9ntHaUBEKWN5uySsbtkAqBnCLkXAKV0Xb8mfmjwpxkQSbdn2QrfiW7XgL+fNaTDsS1bSn6jlEwAdA+BewFQiommpMfbVguQZB1L/G91Uf5HKY44Pyznz5VOAPQPOYX/KcACzo6O+O4D4DQAkqytrt53+b9vfIwGQJSUH5eyYnZZCcC1GxO/FKCEw1eviF+PrFwlQBI90XaH+HV6eEiAUoYnyovZZSUAU3cJHxdgAV0D/q+PeHRlG1UAJI6u/je2+D/+d6T/EwEW5hyfitkllZUAqHwu/6IACzBxHFCDP1UAJM2Dy1d4F1/5oeV/9v9RWuZH5f7JshMAjgOiHAeu9IlfVAGQJLr637NspfjVeZ3uf5Q2WrD+ttw/W3YCwHFAlOPglY/EL6oASBITq3/19wZ+tpBsjhujyzn+V1R2AsBxQJTDm1Jm4EigVgF05QTEmX4Pm2n+GzRy9TaSzcoXXqnkz5efAKjc2EsClPBa3yXxS6sA+9esEyDOTAR/dZjmP5TBcTJ/U8mfrygBOLS1o1eAEiZXK2Pil84FMDE4BagFnfqn5X+/9GfpyFUSAJQ2dv36uUr+fGUVAO92QKusCUNINxNVAPUttwpAQyDiRkv/jxta/b9q6GcJyabT/47t3p2r5J+pLAEQpgKiPNqx7PdIoNLg/6dr2wWIEy39m2j8Y/WPsuXsirfoK04A3rh3+ykBStDg/2rfRTFBtwI4FYC40DstTJT+Fat/lKvS8r+qOAFgGwDl0iOBJnoB1NN3rJFNzf4nqQFBam9sMtb4x+of5aqm/K8qTwCEbQCU78UL5kZH6KkAjgYiqvR78zvrNogprP5RtirK/6qqBIBtAJRLTwSYmAugdE/1hfZ7aApE5DTbGe9708S+v9KfG1b/KFc15X9VVQLANgAq8T8ufiimeEnA+rsFiBKTwV+9eOGcAOWotvyvqksAhG0AlK939IaREcFF7U2LZP+d6wSIgv1r1rrfk01iih6hZeofylZl+V9VnQDoNgB3A6BceiLAVEOg2rN8BUkAak6Dv4mLfor0Z8TU6Rmkw6GtW6se0Fd1AqDbAJYjLwtQBj0WaLIhUBWTAHoCEDbd8zcd/NVzZ38lQPnspzQWS5WqTwBc406GBABl08amg4ZvNNMkQHsCSAIQlmLDn+ngT+kflXImCv8oPvhKAPTaQbYBUIlXLl6Q3pEbYpL2BLz0mc9xRBCB0++xl+7+nNE9f0XpH5Vzjh/avt3XWVFfCYDKFJwnBajA8+d7jYwJnql4RHB94yIBgrCxucV4t7/S4E/pH5XL/Eh88p0ADIxM/IsAFdAy53fPmb9YUt+YX7r7s94oVsAkHUX93wII/uqVix9S+kfFRvsHfiw++U4AunbuHGEmACql/QCvBTTpTEexanMgWwLwS/f79TIqHUUdBP0Z6Lp+TYBK+Dn7P5PvBMD7lzATAFXQPU/TTYFFXnOgu2Lj/gBUS0v+ut/f0bpUgqDf++z7oyo+zv7PZIkJjmPtOd39m4zIWgEqpF38euNfUA5+7L7RfnTReN8BkklX/U/cvtot+7dJULQC9lwv+/6onCNy/tCmbXf5Of5XZKQC4P2H5PLfFKAK3z3fa/xkwEyP3LbKOyXw4DIzV7QiuYqr/iCDv36vB9EDg3SwxH7eRPCf/HcZsqunZ2mjnb8qQBWKM/7b6hskSIf7P3H3XS9K3wRNV/iU9ovoPn9Q5f6iYsc/TX+o1mj/YJ2J/X9lLAFQe9/p/oElzjcEqEJYSYAq9h+wLZBuWu7XCtGj7oo/6GFSBH/4pc1/h+7dYazabjYB6O7eYGWdDwSoUphJgL4RayLAtavppMdFwwj8iuAPE5yc9ZlD27b9WgwxmgDQDAgTNAn4ztp2b8JfGEgE0mXPshVu8L8jkDP9c9E9fw3+VJvgj3P8zXt3PCAGmU0AXPt63t4ltnVUAB90VfatO9cFvic7UzER6Bq4JsMF3qyTJMxS/0x6xv/7F84R/GGA/dSb9279KzHIeAKgVYB9p7sLAhigjVk6hS1MmgicHhqkWTABahX4lfaY6N0XgAkmm/+KzCcArodOnfhj25LvCWCATvar1XhfPTVw2N0aODM8KIgPPc6n3zdBzpdYiI73PXilTwAzzK/+VSAJAEcCYVrHkqVuNeDOUJoD56JVgcNXr8gRNyGgKhBNq+rqvQmQtVjtFw3nc/Ldc2e9QT+AKQPD44t07L4YFkgCoDgSCNPCPCGwEN0e8KoC7iPJQG1piV+DviaItVrtF2mzn950Sac/TDJ99G+mwBIAqgAISi23BGbTZEAbvbRxkGQgHLrS39m6NBJBv4j9fgTF9NG/mQJLANS+d0783H24XwDDar0lMBdd+Wki0OkmBPQMmKOr/PVNTbJzyTLpaG2N2Nd8TF68cJ6SPwJi/ujfTIEmAA+fenuLY1knBQiAbgloNSCqM/61OqCB4fTQEAlBBYoBX1f3epujzoOo1Z7+Qjjih6AFufpXgSYADAZCGCYHu6yO1MpwLpoQnB0ZkXfcZOAjd+V4dtR4T08saUlfg3174yLZ2NIS2gCoaumqX7v8NQEAghPs6l8FmwAIg4EQjqhXA+aiK0dtHNOkoG9izH0+4j6/kdghRLqy16/TejfAa7DXVX5UV/fz0b1+HRbFqh9BC3r1rwJPAKgCIExROSngRzEx8B5Hb3iJgT7XledHEW801NW8vvb6dfA+6hq8QH+7+7k4BfrZdCvntcuX2OtHSJzjo/1Du00P/pkt+ARAqAIgfHHZFqiGJgOX3WRgMikY9x6HCrnp42fFRz2TPjRjpVpu8qBBvKjFDdrNmaz3vDg7Xx9b7KwX0PX3V+mvM5lEvtaadL3ad4l7IhCugrP7zS07jknAQkkAqAKgVpKcCCA4mjwdvPKxHLjSR7kfIQtn9a/CSQCEKgBqR1ese5atlAeXLScRwIII/Ki5kFb/KrQEgCoAao1EAPMh8CMawlv9q/ASAKEKgOhgawBK9/i1s19HOxP4UXMhrv5VqAkAVQBEjSYCDy5f4Q2cQXrQ1Y/oCXf1r8JNAIQqAKKpOEdAr5GlKpBMxTJ/58A1OTt6Q4BICXn1r0JPAKgCIOq0KtAxddkM4q+42teZCpT5EU3hr/5V+AmAUAVAPGhVQLcG2CKIHw36ejETe/uIgzCm/s2lJgkAVQDEDclA9BH0EU/Bz/yfT20SANfe7u4NVtb5QICYKSYDeoFNx5LW6Ul5CJfu6XdeH5AzQ4PeFcwEfcRRrVb/qmYJgNr7ztv/xxLrMQFiTJMBnXevfQNUB4KjAb93dMQN+EPTVy0D8Va71b+qaQKwq6dnaaOdvypAgsxMCNobm6gQVEkD/unhoelrlGniQ9LUcvWvapoAqL3vdP/AEucbAiSUXn2rF+boloF3BS5JwS2Kq/uzU1cin3ZX+XpFMpBUjjg/PHTvjm9KDdU8AaAKgDQqJgVeQtA0+fz2uvrEJwYa6C9PjE8Her25UJ8T7JE2o/2DdWEf+5ut5gmA2tPd/Wgm6/ydACnXVtfgNRnqxyrv8dNf6+9FnXcFcWHymuLJjzH5aCrI69XEBHpA2U+9ee/Wv5Iai0QCwLFAoDzNmYxbKWjwHvVDEwN9bHErB5OPk58v/tmWqeeq3ARidpDWQD7zUffhh9xA/9GMz+vHUCHHHj1QUm2G/swlGgmAMBwIAJACNRj5O5/IJABq3zsnfu4+3C8AACRObY/9zWZLhIwWMl8SAAASyMnZ/0kiJFIJwLEtW645Yv1QAABIFPupWp75n0ukEgA11n/9j/Ii5wUAgIQY7R/4sURM5BIA7YzMFJwnBQCAJCg4kej6ny1STYAz0RAIAIi/aDX+zRS5CkARDYEAgLgbGJ54SCIqsgmANgTmc9ZXBACAWLKf6tq5c0QiKrIJgDq8detBGgIBAPGjE/+i1/g3U6QTALEsZ3RCOgQAgBjRM/9RbPybKdoJgOvn27dfYjYAACA+onfmfy6RTwAUswEAAPEQ/dJ/UWSPAc728KnOLY5Vf1IAAIgoJ2d9Jg6rfxWLCoB6Y/POHrYCAADRFY/Sf1FsEgDFVgAAIJriU/ovis0WQNEDJ06sbq6TiwIAQETEqfRfFKsKgNJTAeLItwUAgEiIV+m/KHYJgHrz3m0vuA/HBQCAmopf6b8olgmANyCIuwIAADU2Wsh+KeoDf+YTzwRAuCsAAFBjes2vG4skpmKbAKjD27YdcMR5XQAACJVz/M0tO45JjMU6AVBj/UNPcDQQABCWvCPnR/uHdkvMxe4Y4FyYEggACIvlOFvf2LyjR2Iu9hUApVMC6QcAAATPfioJwV8logLgcRxr3+nun7nP7hcAAIxz9/03bf+CnkSTBEhEBcCjRwP7B3fTDwAAMG163z8hwV8lpwIwhX4AAIBpSdn3nyk5FYAp9AMAAIyyra8kLfirxFUAPI5j7T194n9bYj0mAABUzd33v3fHA5JAiasAeNw9GuYDAAD80Tn/8T/vP59kVgCm7OrpWdpo568KAAAVGi1klsV51G8pyawATNEvnOWMbxUAACoR8zn/5Uh0AqC0KdCR/B8IAADlsK2vxH3OfzkSvQUwjaZAAEBZktv0N1viKwCeqaZA99lxAQBgTslu+pstHRWAKR0XOpta+uvfy4isFQAApuikv4mrgxuO7d6dk5RIVQKg9nZ3b7CyzgcCAMAUZ0LuOLR9+yVJkXRsAcxwaNu2X2t3pwAAoNyYkLbgr1KXACjt7mRcMAAgLR3/c0llAqAOb9t2wBHrhwIASKWCI99+c+O2A5JSqesBuAnHAwEgpZzjb27a/oUkXe9bqdRWADwcDwSAFJo67pfi4K/SXQGYsuvo0Wzj8sVH3af3CwAgwSaDf5qO+82HBGAKMwIAINn0rP/QivHPdq3ZOSIgAZiJ2wMBILkGlo8vIvh/Kt09ALPozU9OzvqMAAASpd59byf434wEYBYdFMQVwgCQHJbjbP2/OgQONyEBmINeIcy0QABIAPe9/I3NO3oEt6AHYAH7et7eJbZ1VAAA8eMG/7RO+SsHCUAJJAEAEEME/5JIAMpAEgAAMULwLwsJQJlIAgAgBgj+ZSMBqABJAABEGMG/IiQAFSIJAIAIIvhXjASgCiQBABAhBP+qkABUiSQAACKA4F81EgAfSAIAoIYI/r6QAPj08KnOLY5Vf1IAAKHR8b5M+POHBMCAvd3dG6ys84EAAAKnF/sw298/EgBDOi50NrX017+XEVkrAADj8o6cn3Aym/XmVoFvXAZkiF4zObR8/LPu0+MCADDMOT60YvyzBH9zSAAM0iRgtH9QbxEkCQAAY5zjo/1Du/U9VmAMCYBhx3bvzpEEAIAZjjiva/DX91aBUfQABMVxrH3vdD/nvsLfEwBAxdzg/8NDm7bvF8tyBMaRAARsT3f3o5ms83cCACifbX3lzY3bDggCQwIQAgYGAUAFGPATChKAkDxw4sTqxjrp4pggAMxNj/k15a0HOeMfDpoAQ/Lz7dsvTfQPbhCaAwFgDpPH/Aj+4SEBCBEnBADgVsVOf475hYstgBqhORAANPjn/+DQpn//V3T6h48EoIZoDgSQZlzoU1skADW2q6dnaaOd/4n79H4BgBRgpn800ANQY/oDQF8AgLTQ/f6Jq4MbCP61RwUgQugLAJBoOtzn81sPst8fDVQAIuTwtm0HLGd8a17kvABAQmjJX/f7vcl+BP/IIAGImDc27+xhXgCA5HCOa8mfZr/oYQsgqhzH2tvzr1+3Mpm/FACII0r+kUYCEHEPn+rckrPqDzBCGEBcaMk/K86jrPqjjS2AiGNLAECcFLv8Cf7RRwUgRhgcBCDSuMI3VkgAYobBQQCixzk+Wsh+ibP98UICEEO7jh7NNrQuepIGQQC1VnDk2z+9d9sLNPrFDwlAjO3t7t5gZZ2/FqoBAEKmjX52TjoObd9+SRBLNAHG2KFt236tY4SdfP4PBABC4ojzQ230I/jHGxWAhKAaACBoHO9LFioACUE1AECQiqt+gn9yUAFIIKoBAExhrz+5SAASipMCAHxjlG+ikQAkXEdnZ1Nrc/1PhWoAgLJxrj8NSABSgimCAErRcn/GcZ58c8uOY4LEowkwJfQHerR/sI4mQQBzKTb5EfzTgwpACtEkCOBTlPvTigQgxaa2BZ4XEgEgdSj3gwQg5TgtAKQQ3f0QEgBM8RKB5S1/bon1DQGQSLrPP1bI/lfK/VAkALgJ/QFA8riB/3U38D9D4MdMJACYE4kAEH/eFL+89aCOChdgFhIALIhEAIif6Qa/zdv/mX1+zIcEACVpf0Dj0pb7OTEARBuBH5UgAUDZSASAaCLwoxokAKgYiQAQDQR++EECgKqRCAC1QeCHCSQA8M2bIbBkyTqaBYFgEfhhEgkAjOLUABAE57idyf6Xf/x3m98h8MMUEgAEQhMByRaeZbIgUD0m9yFIJAAIVMeFzqYlH2ce564BoAKOfHvUybxM4EeQSAAQihmXDn1N2B4AbsH+PsJGAoDQsT0AfErL/JKzXzq0dWsvgR9hIgFAzRSrAgU78ycZS9YKkBLeal+sb4469lHK/KgVEgDUnuNYe0+ebKcqgKTT1X4mk/0x3fyIAhIARAq9Akia4t7+wMjEv3Tt3DkiQESQACCyHjhxYvUiO/9FThAgbiZL/PIynfyIMhIARB9bBIgJSvyIExIAxEpx7DDJAKKCoI+4IgFAbJEMoFYI+kgCEgAkQjEZcDLOV91342c4VgiTdE/ftpwDkpt46dDWDs7rIxFIAJBIu3p6ljY441/lNAF8OC6O9aJ3Vn/z5gGCPpKGBACJp/cRLBtouiefz32NrQLMp7jK19L+jY+vvXts9+6cAAlGAoDU0epAo1XY7Uj+McuyHxOkluMUXrck8zqrfKQRCQDSzXGsB7q7b2/OWveRECRfMeAP55y3fr5t22UCPtKMBACYyU0Idp061doouc2OLV8uONajNBTGU7Gkbzn2z1jhA7ciAQBK0B6CJR81/I5YuV1iWw9SJYgmXd07VvZwNmN1X20deb9rDWN3gYWQAABV0D6CRXWyrpAr3OVYhS9QKQiPt7KXwls3Bfs7O0ZZ3QOVIQEADNFKQbavfmlzxrmnYFn3WVLYTLWgerMD/eBovi8zOPgx3fmAGSQAQMA0MWi40tRQrBgUxLlHk4OC2PelvWrgXZpjyYWCI/9gi/W+nbV/Q6AHwkECANTSVNNhPp9vWtyYaStM5JZ61QPLaXN/b3Wck4RicHfEOeFI5l3bcfqLAT7XNn6Nsj1QWyQAQAzoqOOxDQ11WknQZGGRNd5s2XV36u8V7Ey7PlqS//z0P+AmD+72w+/M+FeUPQ2xGLhnfk6D+OS/1uoTy/5Yn9uFfK/3ucLEh/o4ZjddGVs5Mtbw67EJVu9A9P1/chzdCoDsCuEAAAAASUVORK5CYII="}getRingtoneAssetUrl(e){var t,n;const{enableCallSettingsTab:i,voiceAdminSettings:o}=this.coreSettings.get(a.J.Calling);let r="";const s=null===(n=null===(t=null==o?void 0:o.ringtoneSettings)||void 0===t?void 0:t.assignments)||void 0===n?void 0:n.ringToneAssignments;if(i&&s)for(const t of s)t.type&&t.value&&c.s[t.type]===e&&(r=`msteams-asset://${t.value.toLocaleLowerCase()}.mp3`,this.logger.log(`[createNotificationWithActions] Using  Custom ringtone: [${r}] for call type [${t.type}]`));return r}getNotificationIcon(e){switch(e.icon){case"call-video":return"msteams-asset://accept-call-video.svg";case"call-audio":return"msteams-asset://accept-call.svg";case"call-reject":return"msteams-asset://decline-call.svg";default:return void(e.icon&&this.logger.error("[getNotificationIcon] Unknown notification action icon",e.icon))}}canTryGetEntriesForToastId(e,t){const{enableCallingNotifications:n}=this.coreSettings.get(a.J.Calling);return n?!(!e||!t)||(this.logger.error(`[canTryGetEntriesForToastId] notificationId and actionType are required to find calling notification action callback. notificationId: ${e}, actionType: ${t}.`),!1):(this.logger.log(`[canTryGetEntriesForToastId] Feature flag enableCallingNotifications, current value: ${n}), required for processing call notification activation is not enabled`),!1)}dismissNotificationFromCall(e,t){const n=this.callToNotificationMap.get(e);if(n&&n.event&&"content"in n.event&&n.event.content&&"notification"===n.event.content.contentType){n.event.action.visibility=r.cP.Hide;const e=n.event.content.id;return!t&&this.notificationsMap.has(e)&&this.executeCallingToastCallback(e,"TimeOut"),n.event.content.callId&&delete n.event.content.callId,n.event.content.crossClientScenarioName&&delete n.event.content.crossClientScenarioName,this.callingAppEventsService.trigger(n),Promise.resolve(!0)}return this.logger.error(`[dismissNotificationFromCall] Corresponding event not found. No op [sourceId: ${e}]`),Promise.resolve(!1)}updateNotificationFromCall(e,t){var n,i,a,o,r,l,d,c;const u=this.callToNotificationMap.get(e);if(u&&u.event&&"content"in u.event&&u.event.content&&"notification"===u.event.content.contentType){const{title:e,subtitle:m,image:g}=u.event.content;if(u.event.content.title=null!==(n=t.title)&&void 0!==n?n:e,u.event.content.subtitle=null!==(i=t.subtitle)&&void 0!==i?i:m,u.event.content.image=null!==(a=t.image)&&void 0!==a?a:g,u.event.content.type=s(t.type),u.event.content.header&&t.headerData){const{title:e,subtitle:n,defaultImageDataUrl:i,mri:a}=u.event.content.header;u.event.content.header.title=null!==(o=t.headerData.headerTitle)&&void 0!==o?o:e,u.event.content.header.subtitle=null!==(r=t.headerData.headerMessage)&&void 0!==r?r:n,u.event.content.header.defaultImageDataUrl=null!==(l=t.headerData.headerImage)&&void 0!==l?l:i,u.event.content.header.mri=null!==(d=t.headerData.headerMri)&&void 0!==d?d:a}return"CallQueueAnsweredElsewhere"===t.toastType&&(u.event.content.subtitle=(null===(c=u.event.content.header)||void 0===c?void 0:c.subtitle)||"",u.event.content.image="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgNTIgNTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjYgNTBDMzkuMjU0OCA1MCA1MCAzOS4yNTQ4IDUwIDI2QzUwIDEyLjc0NTIgMzkuMjU0OCAyIDI2IDJDMTIuNzQ1MiAyIDIgMTIuNzQ1MiAyIDI2QzIgMzkuMjU0OCAxMi43NDUyIDUwIDI2IDUwWiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTI2IDUwLjY2NDFDMzkuNjIxNiA1MC42NjQxIDUwLjY2NDEgMzkuNjIxNiA1MC42NjQxIDI2QzUwLjY2NDEgMTIuMzc4NCAzOS42MjE2IDEuMzM1ODggMjYgMS4zMzU4OEMxMi4zNzg0IDEuMzM1ODggMS4zMzU4OCAxMi4zNzg0IDEuMzM1ODggMjZDMS4zMzU4OCAzOS42MjE2IDEyLjM3ODQgNTAuNjY0MSAyNiA1MC42NjQxWiIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLW9wYWNpdHk9IjAuMDU3OCIgc3Ryb2tlLXdpZHRoPSIxLjMyODI0Ii8+CjxwYXRoIGQ9Ik0zMy42NDIgMjIuMDY2NUMzNC4xMTkzIDIxLjU5MzggMzQuMTE5MyAyMC44MjczIDMzLjY0MiAyMC4zNTQ2QzMzLjE2NDcgMTkuODgxOCAzMi4zOTA4IDE5Ljg4MTggMzEuOTEzNSAyMC4zNTQ2TDIzLjYxMTEgMjguNTc3NUwxOS41ODY1IDI0LjU5MTRDMTkuMTA5MiAyNC4xMTg3IDE4LjMzNTMgMjQuMTE4NyAxNy44NTggMjQuNTkxNEMxNy4zODA3IDI1LjA2NDEgMTcuMzgwNyAyNS44MzA2IDE3Ljg1OCAyNi4zMDMzTDIyLjc0NjkgMzEuMTQ1NEMyMy4yMjQyIDMxLjYxODIgMjMuOTk4IDMxLjYxODIgMjQuNDc1NCAzMS4xNDU0TDMzLjY0MiAyMi4wNjY1WiIgZmlsbD0iIzQwNDA0MCIvPgo8L3N2Zz4K",u.event.content.title=t.message||"",u.event.content.actions=[],u.event.content.header=void 0),this.logger.log(`[updateNotificationFromCall] trigger calling app event. [callId: ${u.event.content.callId}] [id: ${u.event.content.id}] [userId: ${u.event.content.userid}] [title: ${u.event.content.title}] [subTitle: ${u.event.content.subtitle}].`),void this.callingAppEventsService.trigger(u,t.timeout).catch((e=>this.logger.error(`[updateNotificationFromCall] trigger calling app event failed. [error: ${e}].`)))}this.logger.error(`[updateNotificationFromCall] Corresponding event not found. No op [sourceId: ${e}]`)}getNotificationWithActions(e){return{update:t=>this.updateNotificationFromCall(e,t),cancel:t=>{this.dismissNotificationFromCall(e,t)}}}tryGetEntriesForToastId(e){const t=this.notificationsMap.get(e);return t||this.logger.error(`[tryGetEntriesForToastId] entries for calling toast with notificationId ${e} not found in notifications map`),t}tryGetEntryForActionType(e,t,n){const i=e.find((e=>this.isMatchingAction(e,n)));if(!i){const e=this.removeFromMap(t);this.logger.error(`[tryGetEntryForActionType] no entry for actionType ${n} found for calling toast activation. ${e}`)}return i}tryExecuteCallback(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!e.action){const e=this.removeFromMap(t);return this.logger.error(`[tryExecuteCallback] no action is defined for calling toast activation with notificationId ${t}. ${e}`),Promise.resolve(!1)}try{yield e.action(n),this.logger.log(`[tryExecuteCallback] callback action was executed for calling toast activation with notificationId ${t}.`)}catch(e){this.logger.error(`[tryExecuteCallback] callback action threw an exception with with error: ${e}`)}finally{this.logger.log(this.removeFromMap(t))}return Promise.resolve(!0)}))}isMatchingAction(e,t){return e.actionType===t}removeFromMap(e){return`Removed from map: ${this.notificationsMap.delete(e)}`}getNoopReturnValue(){return{update:()=>{},cancel:()=>{}}}addTelemetryCleanupActions(e,t){var n,i;(null===(n=e.acceptTelemetryCleanupAction)||void 0===n?void 0:n.action)&&t.push({action:e.acceptTelemetryCleanupAction.action,actionType:e.acceptTelemetryCleanupAction.actionType}),(null===(i=e.dismissTelemetryCleanupAction)||void 0===i?void 0:i.action)&&t.push({action:e.dismissTelemetryCleanupAction.action,actionType:e.dismissTelemetryCleanupAction.actionType})}getSubTitle(e){const t=e.subtitle||"";return e.type===d.qp.spamCall?` ${t}`:t}}},219475:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var i=n(231191),a=n(324819),o=n(628235),r=n(899297),s=n(722915);class l{constructor(e,t,n){this.scenarioFactory=t,this.logger=e.newLogger("CallingDialogServiceAdapter"),this.callingAppEventsService=n,this.dialogCallback=new Map,this.dialogData=new Map}open(e,t={}){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){this.logger.log(`[open] Opening ${e} dialog in dialog service`);const i=(0,a.v4)(),l=this.scenarioFactory.newScenario(o.RG.CallingDialogOpen);l.clientId=i,l.appendEventData({dialogName:e,tabItemId:t.tabItemId,dialogTitle:t.dialogTitle,alertTitle:t.alertTitle,confirmMessageTitle:t.confirmMessageTitle,correlationId:i});const d=(e=>{if(!e)return[];const t=[];return e.postConfirmCallback&&t.push({name:r.lR.PostConfirm,action:e.postConfirmCallback}),e.preCloseCallback&&t.push({name:r.lR.PreClose,action:e.preCloseCallback}),e.postCloseCallback&&t.push({name:r.lR.PostClose,action:e.postCloseCallback}),e.preActiveElementIds&&t.push({name:r.lR.PreActiveElementIds,action:e.preActiveElementIds}),e.closeByDocument&&t.push({name:r.lR.CloseByDocument,action:e.closeByDocument}),t})(t);this.dialogCallback.set(i,d);const c=(e=>{if(!e)return[];const t=[];return e.dialogTitle&&t.push({title:r._d.DialogTitle,text:e.dialogTitle}),e.dialogText&&t.push({title:r._d.DialogText,text:e.dialogText}),e.primaryButton&&t.push({title:r._d.PrimaryButton,text:e.primaryButton.text||""}),e.confirmMessageTitle&&t.push({title:r._d.ConfirmMessageTitle,text:e.confirmMessageTitle}),e.confirmMessageHtmlBody&&t.push({title:r._d.ConfirmMessageHtmlBody,text:e.confirmMessageHtmlBody}),e.okButtonText&&t.push({title:r._d.OkButtonText,text:e.okButtonText}),t})(t);this.dialogData.set(i,{dialogContent:c});const u="calling-content-event",m={visibility:s.cP.Show},g={source:{name:"DialogOpen",description:e}},p={event:e===s.WB.OptionsSettings?{typeName:u,content:{contentType:"calling-external-settings-pane",tabItemId:t.tabItemId},action:m}:{typeName:u,content:{contentType:"dialog",id:i,name:e,dialogActions:d.map((e=>e.name)),dialogStrings:c},action:m},context:g};l.mark(o.ck.BeforeCallingDialogCallingAppEventTriggered);try{yield this.callingAppEventsService.trigger(p)}catch(e){const t=`[open] Opening dialog error [dialogId: ${i}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`;return this.logger.error(t),l.fail({errors:t,errorCode:"calling-app-event-not-triggered"}),Promise.reject(null)}l.mark(o.ck.AfterCallingDialogCallingAppEventTriggered);const v=(null===(n=d.find((e=>e.name===r.lR.PostClose)))||void 0===n?void 0:n.action)||(()=>{});return Promise.resolve({id:i,close:v,closePromise:Promise.resolve({id:"",value:""})})}))}getDialogData(e){if(this.logger.log(`Getting dialog data for dialog ${e}`),!this.dialogData.get(e))throw new Error(`Unable to find out dialog data with id: ${e}`);return this.dialogData.get(e)||{}}executeDialogAction(e,t){var n;this.logger.log(`Attempting to execute ${t.toString()} action for dialog ${e}`);const i=null===(n=this.dialogActions(e).find((e=>e.name===t)))||void 0===n?void 0:n.action;if(!i)throw new Error(`Action ${t.toString()} not found for dialog ${e}`);i()}dialogActions(e){var t;this.logger.log(`Getting actions for dialog ${e}`);return(null===(t=this.dialogCallback)||void 0===t?void 0:t.get(e))||[]}}},899297:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{WB:()=>i,lR:()=>a,_d:()=>o}),function(e){e.Alert="Alert",e.CallingConfirm="CallingConfirm",e.CallingUnparkCall="CallingUnparkCall",e.OptionsSettings="optionsSettingsDialog",e.PrejoinOverlay="PrejoinOverlay",e.UserMedia="GetUserMediaDialog"}(i||(i={})),function(e){e.PostConfirm="PostConfirm",e.PreClose="PreClose",e.PostClose="PostClose",e.PreActiveElementIds="PreActiveElementIds",e.CloseByDocument="CloseByDocument"}(a||(a={})),function(e){e.DialogTitle="DialogTitle",e.DialogText="DialogText",e.PrimaryButton="PrimaryButton",e.ConfirmMessageTitle="ConfirmMessageTitle",e.ConfirmMessageHtmlBody="ConfirmMessageHtmlBody",e.OkButtonText="OkButtonText"}(o||(o={}))},907207:(e,t,n)=>{"use strict";var i;n.d(t,{at:()=>i,iW:()=>a,Uy:()=>o,Ii:()=>r,B3:()=>s,ep:()=>l,XM:()=>d,hV:()=>c,Yv:()=>u,TO:()=>m,ng:()=>g,pk:()=>p,Fp:()=>v,eA:()=>h,g_:()=>f,Jh:()=>y,WX:()=>k,Dr:()=>S,Mt:()=>b,IS:()=>C,M9:()=>w,U0:()=>N,P_:()=>T,cz:()=>I,iO:()=>E,Md:()=>A,YP:()=>_,BQ:()=>D,kK:()=>F,m_:()=>M,WU:()=>R,mz:()=>P,Jq:()=>O,GQ:()=>x,pW:()=>L,zt:()=>U,RS:()=>B,vN:()=>j,f0:()=>W,IK:()=>V,ZI:()=>H,qC:()=>$,DC:()=>z,uV:()=>G,E9:()=>q,Vg:()=>Q,Ei:()=>J,ty:()=>Y,rK:()=>K,dT:()=>Z,q0:()=>X,Y3:()=>ee,aJ:()=>te,_j:()=>ne,Sj:()=>ie,B_:()=>ae,VJ:()=>oe,$H:()=>re,Pc:()=>se,b6:()=>le,EI:()=>de,PA:()=>ce,L$:()=>ue,oz:()=>me,b$:()=>ge,rl:()=>pe,Tn:()=>he,wS:()=>fe,qj:()=>ye,Z:()=>ke,Ov:()=>Se,kR:()=>be,Bb:()=>Ce,rJ:()=>we,rf:()=>Ne,MW:()=>Te,$R:()=>Ie,dh:()=>Ee,Mp:()=>Ae,GE:()=>_e,QV:()=>De,d7:()=>Fe,XT:()=>Me,CZ:()=>Re,j2:()=>Pe,BB:()=>Oe,nP:()=>xe,fA:()=>Le,QI:()=>Ue,S1:()=>Be,X2:()=>je,At:()=>We,Q5:()=>Ve,yJ:()=>He,ms:()=>$e,i1:()=>ze,wJ:()=>Ge,uI:()=>qe,Ff:()=>Qe,C8:()=>Je,e0:()=>Ye,Cs:()=>Ke,lZ:()=>Ze,BM:()=>Xe,tw:()=>et,pj:()=>tt,nL:()=>it,Cy:()=>at,UQ:()=>ot,UC:()=>rt,IX:()=>st}),function(e){e.SkypeSpacesThread="19:",e.PrivateFeed="48:",e.SkypeSpacesUser="8:",e.Pstn="4:",e.BotPrefix="28:",e.TFLSmsPrefix="50:sms:",e.RootResourceGroupIdPrefix="92:",e.PhonelinkSmsPrefix="phonelink:"}(i||(i={}));const a=864e13,o=2,r=/^[\d]+\:/,s="unq.gbl.spaces",l="messageid=",d=`;${l}`,c=Date.UTC(2e3,0,1),u=new Date("2016-07-01").getTime(),m="ag08:",g="ag08-sfb:",p="ag09:",v="ag09-sfb:",h="4:anonymous",f="teamsvisitor:",y="clientId",k="blah/",S="dod:",b="dod-sfb:",C="@sfbonprem.unq.gbl.spaces",w="@fed.unq.gbl.spaces",N="fed:",T="gal:",I="gal-sfb:",E="gcch:",A="gcch-sfb:",_="preview-",D="tfl:preview-",F="newchat",M="nativefed:",R="tflfed:",P="tfl:",O="orgid:",x="@sfb.unq.gbl.spaces",L="sfb:",U="sip:",B="@sfc.unq.gbl.spaces",j="sfc:",W="orgid:",V="8:",H="28:30005246-e706-444f-ba61-8647ef09db75",$="imBack",z="custom",G="suggestion",q=`:${M}`,Q=`:${N}`,J=`:${P}`,Y=`:${j}`,K=i.SkypeSpacesUser+W,Z=i.SkypeSpacesUser+f,X=i.SkypeSpacesUser+"guest:",ee=i.SkypeSpacesUser+"spool:",te=i.SkypeSpacesUser+"acs:",ne=i.SkypeSpacesUser+L,ie=V+"guest:",ae="50:sms:",oe="50:smsunverified:",re=["live","sip_profile","myspace","c2c","sms"],se="8:tfloffnetwork:",le=`${se}email:`,de=`${se}phone:`,ce="19:meeting",ue=":nativefed:preview",me=":fed:preview",ge={SfBGatewayChat:x,OnPremFederatedGatewayChat:C,FederatedGatewayChat:w},pe="Message";var ve;!function(e){e.PSTN="PSTN",e.Thread="thread",e.User="user",e.Bot="bot",e.Unknown="unknown"}(ve||(ve={}));new Map([[i.Pstn,ve.PSTN],[i.SkypeSpacesThread,ve.Thread],[i.PrivateFeed,ve.Thread],[i.SkypeSpacesUser,ve.User],[i.BotPrefix,ve.Bot]]);const he="drafts",fe=`${i.PrivateFeed}calllogs`,ye=`${i.PrivateFeed}starred`,ke=`${i.PrivateFeed}notes`,Se=`${i.PrivateFeed}${he}`,be=`${i.BotPrefix}integration:`,Ce=`${i.BotPrefix}app`,we=`${i.PrivateFeed}notifications`,Ne="streamof",Te="notifications",Ie=i.BotPrefix+W,Ee=(i.SkypeSpacesUser,i.BotPrefix,`${i.SkypeSpacesThread}sfb:`),Ae="0;0;0",_e={VoiceAppPrefix:`${i.BotPrefix}orgid:`,BotPrefixOld:i.SkypeSpacesUser+i.BotPrefix},De=(i.SkypeSpacesThread,i.SkypeSpacesThread+j),Fe=i.SkypeSpacesUser+O,Me=i.SkypeSpacesUser+E,Re=i.SkypeSpacesUser+S,Pe="unknown_email_address@invalid.teams.ms",Oe={InterceptorBotMris:["28:22e50a9b-80cc-4eab-a092-ce64796d28d7","28:aee3af68-f70b-4f3d-a98e-28acc47ac522","28:6d2635c7-5f7b-4274-b0b5-e44d64e20dd9","28:f7206cef-8727-438b-9724-e1c508e3e54b"]},xe="application/vnd.microsoft.card.adaptive";var Le,Ue,Be;!function(e){e.NORMAL="normal",e.HIGH="high",e.URGENT="urgent"}(Le||(Le={})),function(e){e[e.NoAccess=209]="NoAccess",e[e.InvalidToken=230]="InvalidToken",e[e.ThreadNotFound=732]="ThreadNotFound",e[e.ChatPermissionAndIBRejection=206]="ChatPermissionAndIBRejection"}(Ue||(Ue={})),function(e){e[e.IBRejection=40318]="IBRejection"}(Be||(Be={}));const je=i.SkypeSpacesThread+N,We=i.SkypeSpacesThread+M;var Ve,He;!function(e){e.ArchivalLevel="archivalLevel",e.ThemeId="themeId",e.CallableChannel="callableChannel",e.ChannelDefaultSectionId="channelDefaultNotesSectionId",e.ChannelSettings="channelSettings",e.Classification="classification",e.CreatedAt="createdat",e.CreatingFromTemplate="creatingFromTemplate",e.Creator="creator",e.DocumentLibraryId="channelDocsDocumentLibraryId",e.DynamicMembership="dynamicMembership",e.FavDefault="favDefault",e.FolderRelativeUrl="channelDocsFolderRelativeUrl",e.GapDetectionEnabled="gapDetectionEnabled",e.GroupId="groupId",e.GuestUsers="guestUsersCategory",e.DisabledReason="disabledReason",e.GuardianChatInfo="guardianChatInfo",e.HasTranscript="hasTranscript",e.WebinarId="webinarId",e.CoOrganizers="coOrganizers",e.MeetingObjectsConfig="meetingObjectsConfig",e.MeetingContent="meetingContent",e.ImportState="importState",e.ImmutableRoster="immutableRoster",e.Integration="integration:",e.IsDeleted="isdeleted",e.IsFederated="isFederated",e.IsStickyThread="isStickyThread",e.Cfet="cfet",e.JoiningEnabled="joiningenabled",e.ConsumerGroupId="consumerGroupId",e.IsTeamLocked="isTeamLocked",e.IsUnlockMembershipSyncRequired="isUnlockMembershipSyncRequired",e.IsThreadDisabled="isDisabled",e.MeetingChatPolicy="meetingChatPolicy",e.LastJoinAt="lastjoinat",e.LastLeaveAt="lastleaveat",e.LastSyncTime="lastSyncTime",e.Meeting="meeting",e.MemberLimitExceeded="isMaxMemberLimitExceeded",e.NotebookId="notebookId",e.NotesSectionInfo="notesSectionInfo",e.ParentSpaces="parentSpaces",e.Picture="picture",e.PictureETag="pictureETag",e.PinnedItems="pinnedItems",e.RetentionHorizon="retentionHorizon",e.RetentionHorizonV2="retentionHorizonV2",e.RosterVersion="rosterVersion",e.SharepointRootLibrary="sharepointRootLibrary",e.SensitivityLabelDisplayName="sensitivityLabelDisplayName",e.SensitivityLabelId="sensitivityLabelId",e.SensitivityLabelName="sensitivityLabelName",e.SensitivityLabelParentDisplayName="sensitivityLabelParentDisplayName",e.SensitivityLabelParentName="sensitivityLabelParentName",e.SensitivityLabelParentTooltip="sensitivityLabelParentTooltip",e.SensitivityLabelTooltip="sensitivityLabelToolTip",e.SensitivityLabelIsCopyBlocked="sensitivityLabelIsCopyBlocked",e.ShareHistoryTime="sharehistorytime",e.SiteUrl="sharepointSiteUrl",e.SpaceId="spaceId",e.SpaceThreadTopic="spaceThreadTopic",e.SpaceThreadVersion="spaceThreadVersion",e.SpaceType="spaceType",e.SpaceType_Class="class",e.SpaceType_Edu="edu",e.SpaceType_HealthcareCareCoordination="healthcareCareCoordination",e.SpaceType_Plc="plc",e.SpaceType_Staff="staff",e.SpaceType_Standard="standard",e.SpaceType_Community="community",e.SpaceTypes="spaceTypes",e.SubstrateGroupId="substrateGroupId",e.SharedInSpaces="sharedInSpaces",e.TabType="tab::",e.TeamAdminSettings="spaceAdminSettings",e.TeamSmtpAddress="teamSmtpAddress",e.TeamStatus="teamStatus",e.TemplateType="templateType",e.TemplateInformation="templateInformation",e.TenantId="tenantid",e.ThreadSubType="threadSubType",e.ThreadType="threadType",e.TopicDescription="description",e.TopicThreadTopic="topicThreadTopic",e.TopicThreadVersion="topicThreadVersion",e.Version="version",e.Visibility="visibility",e.Topics="topics",e.Liveness="awareness_conversationLiveState",e.TopicName="topic",e.GroupTemplate="groupTemplate",e.XTeamName="spaceThreadTopic",e.ExtensionDefinitionContainer="extensionDefinitionContainer",e.Hidden="hidden",e.P2PChatDefaultNotesInfo="groupDefaultNotesInfo",e.P2PChatFilesIndexId="chatFilesIndexId",e.P2PChatFilesIndexId_Value="2",e.P2PChatFixedRosters="fixedRoster",e.P2PChatUniqueRosterThread="uniquerosterthread",e.P2PMessagingDisabled="messagingdisabled",e.isRgBackedThread="isRgBackedThread"}(Ve||(Ve={})),function(e){e.IsNewConversation="isNewConversation"}(He||(He={}));const $e=[Ve.IsDeleted,Ve.LastJoinAt,Ve.LastLeaveAt,Ve.ShareHistoryTime,Ve.SpaceId,Ve.ThreadType,Ve.Picture];var ze,Ge,qe,Qe,Je,Ye,Ke;!function(e){e.Chat="Chat",e.Conversation="Conversation",e.Meeting="Meeting",e.OneOnOne="1on1",e.PhoneChat="PhoneChat",e.ReplyChain="ReplyChain",e.Team="Space",e.StreamOfNotes="StreamOfNotes",e.Thread="Thread",e.Topic="Topic"}(ze||(ze={})),function(e){e.Scheduled="Scheduled",e.Broadcast="Broadcast",e.Adhoc="Adhoc",e.Recurring="Recurring",e.MeetNow="MeetNow"}(Ge||(Ge={})),function(e){e.AcceptPending="AcceptPending",e.ExtendedDirectoryAcceptPending="ExtendedDirectoryAcceptPending",e.Accepted="Accepted",e.Blocked="Blocked",e.Quarantined="Quarantined"}(qe||(qe={})),function(e){e.AddedBy="addedBy",e.AddedByTenantId="addedByTenantId",e.Alerts="alerts",e.BlockedAtTime="conversationblockedat",e.ClearHistoryTime="clearHistoryTime",e.ChatHistoryHiddenTime="historyHiddenTime",e.Collapsed="collapsed",e.ConsumptionHorizon="consumptionhorizon",e.ConsumptionHorizonBookmark="consumptionHorizonBookmark",e.DraftVersion="draftVersion",e.Favorite="favorite",e.Followed="isfollowed",e.Hidden="hidden",e.HiddenTime="unpinnedTime",e.InteropConversationStatus="interopconversationstatus",e.isDeleted="isDeleted",e.isPinned="ispinned",e.LastImportantImTime="lastimportantimreceivedtime",e.LastUrgentImTime="lasturgentimreceivedtime",e.Loud="loud",e.Muted="muted",e.Normal="normal",e.PinnedConsumptionHorizon="consumptionHorizonForPinnedMessages",e.PinnedItems="pinnedItems",e.RetentionHorizon="retentionHorizon",e.RetentionHorizonV2="retentionHorizonV2",e.SmartReplies="quickReplyAugmentation",e.Subscription="subscription",e.SuggestedActions="augmentation",e.Version="spaceConversationVersion"}(Qe||(Qe={})),function(e){e.None="none",e.Space="space",e.Topic="topic"}(Je||(Je={})),function(e){e.ChannelOnlyMember="channelOnlyMember",e.ExpirationTime="memberExpirationTime",e.ExplicitlyAdded="explicitlyAdded",e.Following="isFollowing",e.IsFavorite="isFavorite",e.IsModerator="isModerator",e.IsPinned="isPinned",e.Reader="isReader",e.Role="role",e.RelationshipState="relationshipState",e.MemberMaskId="memberMaskId"}(Ye||(Ye={})),function(e){e.AddCustomApp="ThreadActivity/AddCustomApp",e.AddMember="ThreadActivity/AddMember",e.BotMessageBack="BotMessageBack",e.Call="Event/Call",e.CallPushNotification="Signal/Flamingo",e.CallRecording="RichText/Media_CallRecording",e.CallLogRecording="RichText/Media_CallLogRecording",e.CallTranscript="RichText/Media_CallTranscript",e.CallLogTranscript="RichText/Media_CallLogTranscript",e.MeetingObjects="RichText/Media_MeetingObjects",e.ClearTyping="Control/ClearTyping",e.Collaborate="Collaborate",e.ConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.Contacts="RichText/Contacts",e.Custom="Custom",e.DeleteCustomApp="ThreadActivity/DeleteCustomApp",e.DeleteMember="ThreadActivity/DeleteMember",e.Embed="Embed",e.Files="RichText/Files",e.FlikMessage="RichText/Media_FlikMsg",e.HistoryDisclosedUpdate="ThreadActivity/HistoryDisclosedUpdate",e.HTML="RichText/Html",e.IsReaderUpdated="ThreadActivity/MemberFeatureFlagUpdate",e.JoiningEnabledUpdate="ThreadActivity/JoiningEnabledUpdate",e.LegacyMemberAdded="ThreadActivity/LegacyMemberAdded",e.LegacyMemberUpgraded="ThreadActivity/LegacyMemberUpgraded",e.Location="RichText/Location",e.MediaCard="RichText/Media_Card",e.Meeting="Meeting",e.MeetingPolicyUpdated="ThreadActivity/MeetingPolicyUpdated",e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.MemberJoined="ThreadActivity/MemberJoined",e.MemberLeft="ThreadActivity/MemberLeft",e.Moji="RichText/Media_FlikMsg",e.PictureUpdate="ThreadActivity/PictureUpdate",e.RetentionDeleted="ThreadActivity/RetentionDeleted",e.RichText="RichText",e.RoleUpdate="ThreadActivity/RoleUpdate",e.ScreenShare="ScreenShare",e.Sms="RichText/Sms",e.SpaceDescriptionUpdated="ThreadActivity/SpaceDescriptionUpdated",e.SpaceThreadChannelAdded="ThreadActivity/SpaceThreadChannelAdded",e.SpaceThreadChannelDeleted="ThreadActivity/SpaceThreadChannelDeleted",e.SpaceThreadChannelRenamed="ThreadActivity/SpaceThreadChannelRenamed",e.SharedInSpacesUpdated="ThreadActivity/SharedInSpacesUpdated",e.SpaceTopicUpdated="ThreadActivity/SpaceTopicUpdated",e.TabUpdated="ThreadActivity/TabUpdated",e.Text="Text",e.ThreadActivityMessageTypePrefix="ThreadActivity/",e.ThreadArchivalUpdate="ThreadActivity/ThreadArchivalUpdate",e.TopicDeleted="ThreadActivity/TopicDeleted",e.TopicDescriptionUpdated="ThreadActivity/TopicDescriptionUpdated",e.TopicTopicUpdated="ThreadActivity/TopicTopicUpdated",e.TopicUpdated="ThreadActivity/TopicUpdate",e.ThreadShared="ThreadActivity/ThreadShared",e.Typing="Control/Typing",e.UpdateFavDefault="ThreadActivity/UpdateFavDefault",e.UpgradeCustomApp="ThreadActivity/UpgradeCustomApp",e.URIObject="RichText/UriObject",e.Video="Event/SkypeVideoMessage",e.ShowHiddenChatHistory="ThreadActivity/ShowChatHistory",e.PinnedItemsUpdate="ThreadActivity/PinnedItemsUpdate",e.ConsentInvites="ThreadActivity/ConsentInvites"}(Ke||(Ke={}));const Ze=[Ke.AddMember,Ke.DeleteMember,Ke.RoleUpdate,Ke.ThreadShared,Ke.TopicTopicUpdated,Ke.TopicUpdated,Ke.TopicDeleted,Ke.SpaceTopicUpdated,Ke.SpaceThreadChannelAdded,Ke.SpaceThreadChannelDeleted,Ke.SpaceDescriptionUpdated,Ke.TopicDescriptionUpdated,Ke.SharedInSpacesUpdated,Ke.PictureUpdate,Ke.HistoryDisclosedUpdate,Ke.JoiningEnabledUpdate,Ke.LegacyMemberAdded,Ke.LegacyMemberUpgraded,Ke.AddCustomApp,Ke.DeleteCustomApp,Ke.UpgradeCustomApp,Ke.UpdateFavDefault,Ke.MemberJoined,Ke.MemberLeft,Ke.ThreadArchivalUpdate,Ke.RetentionDeleted,Ke.TabUpdated,Ke.MeetingPolicyUpdated,Ke.PinnedItemsUpdate];var Xe,et,tt,nt,it,at,ot,rt;!function(e){e.Activity="activity",e.AdminDelete="adminDelete",e.CallLog="call-log",e.Cards="cards",e.CrossPostId="crossPostId",e.DeleteTime="deletetime",e.DeliveryState="deliveryState",e.DraftId="draftId",e.EditTime="edittime",e.EmailDetails="emaildetails",e.Emotions="emotions",e.Files="files",e.GenericStreamMetadata="genericStreamMetadata",e.HardDeleteReason="hardDeleteReason",e.HardDeleteTime="hardDeleteTime",e.Importance="importance",e.InnerThreadId="innerThreadId",e.InteropType="interopType",e.IsRead="isread",e.Links="links",e.Meeting="meeting",e.MeetingScheduledInfo="scheduledmeetinginfo",e.MeetingTitle="meetingtitle",e.MeetingType="@type",e.Mentions="mentions",e.Meta="meta",e.OnBehalfOf="onbehalfof",e.ParentsAnnouncementsStatus="parentsAnnouncementsStatus",e.Pinned="pinned",e.PolicyViolation="policyViolation",e.ReplyPermissions="replyPermission",e.SendAt="sendAt",e.SkipFanoutToBots="skipfanouttobots",e.SoftDeleteReason="softDeleteReason",e.Starred="starred",e.Subject="subject",e.SystemDelete="systemdelete",e.Title="title",e.UserMetaData="userMetaData"}(Xe||(Xe={})),function(e){e.ConversationUpdate="ConversationUpdate",e.CustomUserProperties="CustomUserProperties",e.MessageUpdate="MessageUpdate",e.NewMessage="NewMessage",e.ThreadPropertyUpdate="ThreadPropertyUpdate",e.ThreadUpdate="ThreadUpdate",e.ResolveConversationLie="ResolveConversationLie",e.NewDraft="NewDraft"}(et||(et={})),function(e){e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate"}(tt||(tt={})),function(e){e[e.None=0]="None",e[e.Network=1]="Network",e[e.Local=2]="Local"}(nt||(nt={})),function(e){e.Admin="Admin",e.User="User",e.Guest="Guest",e.Shadow="Shadow",e.None="None"}(it||(it={})),function(e){e.MeetingsUserParticipatesIn="participated",e.MeetingsUserIsInvitedTo="all",e.MeetingsManuallyUnmuted="none"}(at||(at={})),function(e){e.Unknown="0",e.Available="1",e.NotAvailable="2"}(ot||(ot={})),function(e){e[e.ChatWithRestrictedUserNotAllowed=40323]="ChatWithRestrictedUserNotAllowed",e[e.ChatWithLimitedUserNotAllowed=40324]="ChatWithLimitedUserNotAllowed",e[e.GroupChatNotAllowed=40325]="GroupChatNotAllowed",e[e.AddUserToChatNotAllowed=40326]="AddUserToChatNotAllowed",e[e.AddRestrictedUserInvalidOwnerNotAllowed=40327]="AddRestrictedUserInvalidOwnerNotAllowed",e[e.AddRestrictedUserNoOwnerNotAllowed=40328]="AddRestrictedUserNoOwnerNotAllowed",e[e.RemoveChatOwnerNotAllowed=40329]="RemoveChatOwnerNotAllowed",e[e.RemoveUserFromChatNotAllowed=40330]="RemoveUserFromChatNotAllowed",e[e.LeaveChatNotAllowed=40331]="LeaveChatNotAllowed",e[e.ChatWithExternalNotAllowed=40332]="ChatWithExternalNotAllowed",e[e.AddRestrictedUserExternalNotAllowed=40333]="AddRestrictedUserExternalNotAllowed",e[e.RemoveFullUserNotAllowed=40334]="RemoveFullUserNotAllowed",e[e.AddRestrictedUserFederatedChatNotAllowed=40335]="AddRestrictedUserFederatedChatNotAllowed",e[e.RemoveUserFromFederatedChatNotAllowed=40336]="RemoveUserFromFederatedChatNotAllowed"}(rt||(rt={}));const st="meeting"},870209:(e,t,n)=>{"use strict";n.d(t,{ab:()=>_,_W:()=>D,WD:()=>M,Q5:()=>R,dV:()=>P,mh:()=>O,W7:()=>x,Nl:()=>L,Cq:()=>U,oJ:()=>B,lp:()=>j,mr:()=>W,mJ:()=>V,IM:()=>H,vX:()=>$,m:()=>z,vC:()=>G,y:()=>q,Fd:()=>Q,Q2:()=>J,EG:()=>K,$i:()=>Z,xn:()=>X,_c:()=>ee,o_:()=>te,P5:()=>ne,tv:()=>ae,uY:()=>oe,zH:()=>re,iK:()=>se,PA:()=>le,Ue:()=>de,Vq:()=>ce,bl:()=>ue,W9:()=>me,cQ:()=>ge,yj:()=>pe,MR:()=>ve,vq:()=>he,Q:()=>fe,tL:()=>ye,TV:()=>ke,eZ:()=>Se,kz:()=>be,B4:()=>Ce,YQ:()=>we,mA:()=>Ne,Kt:()=>Te,i4:()=>Ie,y1:()=>Ae,pu:()=>_e,gs:()=>De,lh:()=>Fe,eb:()=>Me,n:()=>Re,gu:()=>Pe,j6:()=>Oe,u5:()=>xe,fP:()=>Le,nN:()=>Ue,o7:()=>Be,e9:()=>je,ug:()=>We,WA:()=>Ve,kw:()=>$e,eX:()=>ze,_K:()=>Ge});var i=n(351497),a=n(87308),o=n(892891),r=n(990538),s=n(907207),l=n(284931),d=n(975652),c=n(118824),u=n(84574),m=n(455304);const g=s.at.SkypeSpacesUser+s.f0,p=s.at.SkypeSpacesUser+s.pW,v=s.at.SkypeSpacesUser+s.iO,h=s.at.SkypeSpacesUser+s.Md,f=s.at.SkypeSpacesUser+s.Dr,y=s.at.SkypeSpacesUser+s.Mt,k=s.at.SkypeSpacesUser+s.TO,S=s.at.SkypeSpacesUser+s.ng,b=s.at.SkypeSpacesUser+s.pk,C=s.at.SkypeSpacesUser+s.Fp,w=s.at.SkypeSpacesUser+s.P_,N=s.at.SkypeSpacesUser+s.cz,T="tfl:",I=s.at.SkypeSpacesUser+T,E="sfc:",A=s.at.SkypeSpacesUser+E,_="receiverSfB",D="Text";function F(e,t){return!!e&&e.startsWith(t)}function M(e){return e>=400&&e<500}function R(e,t){return F(e,s.at.SkypeSpacesThread)||O(e,t)}function P(e){return F(e,s.at.PrivateFeed)}function O(e,t){return P(e)||F(t,s.rf)}function x(e=""){const t=/syncState=([^&]+)/;let n;return e&&t.test(e)&&(n=e.match(t)[1]),n}function L(e){if(!e||!e.startsWith(s.IK))return!1;const t=e.split(":");return 2===t.length||3===t.length&&(n=t[1],-1!==s.$H.indexOf(n));var n}function U(e){return!!e&&e.startsWith(I)}function B(e){return e&&U(e)?e.replace(T,""):e}function j(e){return!!e&&(W(e)||q(e)||L(e)||e.startsWith(I)||V(e)||H(e)||$(e)||z(e)||G(e))}function W(e){return!!e&&(e.startsWith(g)||e.startsWith(p))}function V(e){return!!e&&(e.startsWith(v)||e.startsWith(h))}function H(e){return!!e&&(e.startsWith(f)||e.startsWith(y))}function $(e){return!!e&&(e.startsWith(k)||e.startsWith(S))}function z(e){return!!e&&(e.startsWith(b)||e.startsWith(C))}function G(e){return!!e&&(e.startsWith(w)||e.startsWith(N))}function q(e){return!!e&&(e.startsWith(s.dT)||e.startsWith(s.Sj))}function Q(e){return!!e&&(W(e)||V(e)||H(e)||$(e)||z(e)||G(e))}function J(e){if((0,o.isString)(e)&&!(0,o.isEmpty)(e)){if(K(e))return Y("PSTN",e,i.A4.PhoneNumber);if(L(e)||Z(e))return Y("SfC",e,i.A4.Identity)}return e}const Y=(e,t,n)=>`${e}-${new a.F(t,n).scrub()}`;function K(e){return!!e&&0===e.indexOf(s.at.Pstn)}function Z(e){return!!e&&e.startsWith(s.Pc)}function X(e){return Boolean("unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e||e===s.j2)}function ee(e,t){let n=e;return t&&(n=[e,s.XM,t].join("")),n}function te(e){return Te((0,r.F)(e.conversationLink)).conversationId}function ne(e){if(!e||!e.conversationLink)throw TypeError("Chat-Service-Utils: Missing conversationLink");const t=Te((0,o.last)(e.conversationLink.split("/"))||"");return t.isValid?t.itemId:e.id}function ie(e){const t=Number(e);return!t||t<s.hV}function ae(e){const{properties:t}=e;if(!t)return;const n=t[s.BM.EditTime];return n?Number(n):void 0}function oe(e){const{properties:t}=e;if(!t)return;const n=t[s.BM.DeleteTime];return n?Number(n):void 0}function re(e){const{properties:t}=e;if(!t)return;const n=t[s.BM.HardDeleteTime];return n?Number(n):void 0}function se(e,t,n){const i=e;if(t&&(t[s.Q5.ExtensionDefinitionContainer]||t[s.Q5.P2PChatUniqueRosterThread]&&i&&i.length>2)){const{members:t,botMembers:i}=le(e,n);return{members:t,botMembers:i}}return{members:i,botMembers:[]}}function le(e,t){if(e&&e.length>2){const n=(0,o.partition)(e,(e=>!ue(e.id)||t&&t.indexOf(e.id)>-1));return{members:n[0],botMembers:n[1]}}return{members:e,botMembers:[]}}const de=e=>e.startsWith(s.eA),ce=e=>e.startsWith(s.dT)||e.startsWith(s.eA)||e.startsWith(s.q0)||e.startsWith(s.Y3)||e.startsWith(s.aJ);function ue(e){return!!e&&(!e.startsWith(s.GE.VoiceAppPrefix)&&(e.startsWith(s.at.BotPrefix)||e.startsWith(s.GE.BotPrefixOld)))}const me=(e,t)=>{if(!t)return!1;const{enableM365ChatBot:n,m365ChatBotIds:i}=e.get(c.J.Messaging);return!!(n&&ue(t)&&(null==i?void 0:i.includes(t)))},ge=e=>!!e&&e.startsWith(s.kR),pe=e=>e.startsWith(s.B_),ve=e=>e&&e.startsWith(s.VJ)||!1,he=e=>e&&e.split(":")[2]||"",fe=e=>L(e)&&!e.startsWith(I)?e.replace(s.at.SkypeSpacesUser,s.at.SkypeSpacesUser+T):e,ye=e=>L(e)&&!e.startsWith(A)?e.replace(s.at.SkypeSpacesUser,s.at.SkypeSpacesUser+E):e,ke=(e,t=s.Jq)=>j(e)||ue(e)||K(e)||Ce(e,t)||pe(e)||ve(e),Se=e=>j(e)&&!ce(e),be=e=>{const t=Number(e),n=Date.now()+30*m.Zd;return 0!==t&&!isNaN(t)&&t<n},Ce=(e,t)=>{if(!e)return!1;const n=s.at.BotPrefix+t;return e.startsWith(n)};function we(e){return!!ue(e)&&s.BB.InterceptorBotMris.some((t=>t===e))}function Ne(e){return!!e&&e.includes(s.ep)}function Te(e){if(!e)return{isValid:!1,conversationId:"",itemId:""};const t=e.split(";");if(1===t.length)return{isValid:!1,conversationId:t[0],itemId:""};if(2!==t.length||0!==t[1].indexOf(s.ep)||t[1].indexOf(s.Jh)>-1)return{isValid:!1,conversationId:"",itemId:""};const n=t[1].substr(s.ep.length);return{isValid:!ie(n),conversationId:t[0],itemId:n}}function Ie(e){switch(e){case l.T.Team:return s.i1.Team;case l.T.Topic:return s.i1.Topic;case l.T.SfbInteropChat:case l.T.Chat:return s.i1.Chat;case l.T.Meeting:return s.i1.Meeting;case l.T.PhoneChat:return s.i1.PhoneChat;case l.T.Community:return s.i1.Team;default:return s.i1.Thread}}function Ee(e){const{properties:t}=e;return t&&t[s.BM.Importance]?t[s.BM.Importance]:s.fA.NORMAL}function Ae(e){return Ee(e)===s.fA.HIGH}function _e(e){return Ee(e)===s.fA.URGENT}function De(e){return(0,o.includes)(s.lZ,e.messagetype)}function Fe(e){switch(e){case d.UB.Admin:return s.nL.Admin;case d.UB.Guest:return s.nL.Guest;case d.UB.User:return s.nL.User;case d.UB.Shadow:return s.nL.Shadow;case d.UB.Undefined:default:return s.nL.None}}const Me=(e,t)=>{if(e){const n=e[s.BM.Emotions],i=n&&(0,o.find)(n,{key:"star"}),a=i&&i.users;if(a)return!!(0,o.some)(a,{mri:t})}return!1},Re=({resourceType:e,resource:t})=>{switch(e){case"NewMessage":case"MessageUpdate":return t.conversationid||te(t);case"ThreadUpdate":case"ConversationUpdate":return t.id;default:return}},Pe=({resourceType:e,resource:t})=>{switch(e){case"NewMessage":case"MessageUpdate":return ne(t);default:return}},Oe=e=>e===l.T.StreamOfNotifications,xe=e=>e===l.T.StreamOfCalllogs,Le=e=>e===l.T.StreamOfDrafts,Ue=e=>e===l.T.StreamOfNotes,Be=e=>{var t;if(!e)return"";if((0,o.isString)(e)){const t=e;return 0===t.lastIndexOf(s.IK,0)||0===t.lastIndexOf(s.at.BotPrefix,0)||K(t)||pe(t)||ve(t)?t:s.IK+t}return null!==(t=(0,o.first)(e.mris))&&void 0!==t?t:""},je=e=>null==e?void 0:e.startsWith(s.PA);function We(e){if(!e)return!1;if(!e.startsWith(s.IK))return!1;return(e.startsWith(g)||e.startsWith(s.XT)||e.startsWith(s.CZ))&&3===e.split(":").length}const Ve=e=>{const{enableTfwTflFederation:t}=e.get(c.J.Messaging),{enableGuardiansChat:n}=e.get(c.J.Guardians),{licenseType:i}=e.get(c.J.UserResources);return!!(t||n&&He(i))},He=e=>e===u.oj.Teacher,$e=e=>{if(!e)return;const t=Number(e.sendAt);return isNaN(t)?new Date(e.sendAt).getTime():t},ze=e=>!!e&&(e.includes(s.oz)||e.endsWith(s.b$.FederatedGatewayChat)||e.endsWith(s.b$.OnPremFederatedGatewayChat)),Ge=(e,t,n,i,a)=>{const o=e&&e.includes(s.L$),r=null==a?void 0:a.some((e=>L(e)));return o||!(t||!n||!i||r)}},186930:(e,t,n)=>{"use strict";n.d(t,{dP:()=>i,qN:()=>a,iv:()=>o,vO:()=>s,VS:()=>c,f1:()=>u,b:()=>m});var i,a,o,r,s,l,d=n(907207);!function(e){e.ScheduledDraft="ScheduledDraft"}(i||(i={})),function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync",e[e.SyncOnDemandFromLongpoll=8]="SyncOnDemandFromLongpoll",e[e.AdHocPropertyUpdate=9]="AdHocPropertyUpdate"}(a||(a={})),function(e){e[e.Sending=0]="Sending",e[e.Delivered=1]="Delivered",e[e.Received=2]="Received",e[e.Error=3]="Error",e[e.Deleted=4]="Deleted"}(o||(o={})),function(e){e[e.Muted=0]="Muted",e[e.Simple=1]="Simple",e[e.Important=2]="Important",e[e.Mentioned=3]="Mentioned"}(r||(r={})),function(e){e[e.StartupSyncClean=1]="StartupSyncClean",e[e.StartupSyncUpdate=2]="StartupSyncUpdate",e[e.ThreadDetailsSync=3]="ThreadDetailsSync",e[e.LongPoll=4]="LongPoll",e[e.ResolverPutConversation=5]="ResolverPutConversation",e[e.LocalUpdate=6]="LocalUpdate",e[e.PutConversationLie=7]="PutConversationLie",e[e.AddUsersToConversation=8]="AddUsersToConversation",e[e.ConversationFetchJob=9]="ConversationFetchJob",e[e.GroupChatsStartupJob=10]="GroupChatsStartupJob",e[e.OneToOneChatFetchJob=11]="OneToOneChatFetchJob",e[e.NonRecentChatsStartupJob=12]="NonRecentChatsStartupJob",e[e.NonRecentChatsStartupRetryJob=13]="NonRecentChatsStartupRetryJob"}(s||(s={}));class c{}c.NotificationConversationId=`${d.at.PrivateFeed}notifications`,c.StarredConversationId=`${d.at.PrivateFeed}starred`,c.CallLogConversationId=`${d.at.PrivateFeed}calllogs`,c.AnnotationsConversationId=`${d.at.PrivateFeed}annotations`,function(e){e[e.Message=0]="Message"}(l||(l={}));const u="x-ms-request-priority";var m;!function(e){e[e.RealTimeSync=0]="RealTimeSync",e[e.ForegroundSync=10]="ForegroundSync",e[e.BackgroundSync=20]="BackgroundSync"}(m||(m={}))},975652:(e,t,n)=>{"use strict";n.d(t,{wC:()=>m,N:()=>g,ge:()=>p,x6:()=>v,F3:()=>h,aO:()=>f,Be:()=>y,$_:()=>k,ex:()=>S,Ky:()=>b,LC:()=>C,D2:()=>w,bn:()=>N,TU:()=>T,aX:()=>I,cL:()=>E,C9:()=>A,B5:()=>_,eU:()=>D,tG:()=>M,yt:()=>R,s8:()=>P,jK:()=>O,zW:()=>x,UB:()=>L,XI:()=>U,Wr:()=>B,RQ:()=>j,m1:()=>W,xu:()=>V,Vn:()=>H,wJ:()=>$,fD:()=>z,uN:()=>G,mr:()=>q,eO:()=>Q,iO:()=>J,gB:()=>Y,k2:()=>K,AO:()=>Z,lT:()=>X,A6:()=>ee,YF:()=>te,FG:()=>ne,kN:()=>ie,lR:()=>ae});var i=n(231191),a=n(84574),o=n(281857),r=n(118824),s=n(6293),l=n(467757),d=n(215235),c=n(70404),u=n(642115);const m=1,g=200,p=1,v="api/v1/",h="api/v2/",f="api/v3/",y=12e4,k=12e4,S="https://chatsvcagg.teams.microsoft.com",b="https://teams.microsoft.com/api/csa",C={startupclean:"teams/users/me",startupdelta:"teams/users/me/updates",startupgroupchats:"teams/users/me/groupchats",startupnonrecentchats:"teams/users/me/nonrecentchats",startupcleananonymous:"teams/users/anonymous",startupdeltaanonymous:"teams/users/anonymous/updates"},w="xx",N=100,T=50,I=50,E=50;var A,_,D,F,M,R,P,O,x,L,U,B,j,W,V,H,$,z,G,q,Q,J,Y,K,Z,X,ee,te,ne;!function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff",e[e.HealthcareCareCoordination=5]="HealthcareCareCoordination",e[e.Community=6]="Community"}(A||(A={})),function(e){e.None="none",e.Owners="owners",e.Members="members",e.OwnersAndMembers="ownersAndMembers"}(_||(_={})),function(e){e[e.None=0]="None",e[e.Private=1]="Private",e[e.Secret=2]="Secret",e[e.Public=3]="Public",e[e.HiddenMembership=4]="HiddenMembership",e[e.Unknown=5]="Unknown",e[e.All=6]="All"}(D||(D={})),function(e){e[e.InProgress=0]="InProgress",e[e.Success=1]="Success",e[e.Error=2]="Error"}(F||(F={})),function(e){e[e.None=0]="None",e[e.Private=1]="Private",e[e.TenantWide=2]="TenantWide",e[e.Shared=4]="Shared"}(M||(M={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators"}(R||(R={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators"}(P||(P={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed"}(O||(O={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed"}(x||(x={})),function(e){e[e.Undefined=0]="Undefined",e[e.User=1]="User",e[e.Admin=2]="Admin",e[e.Guest=3]="Guest",e[e.Shadow=4]="Shadow"}(L||(L={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators",e[e.EveryoneButGuests=2]="EveryoneButGuests"}(U||(U={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Private=1]="Private",e[e.Channel=2]="Channel"}(B||(B={})),function(e){e[e.AnyonePost=0]="AnyonePost",e[e.AnyoneWithWarning=1]="AnyoneWithWarning",e[e.OwnersPost=2]="OwnersPost"}(j||(j={})),function(e){e[e.Strict=0]="Strict",e[e.Moderate=1]="Moderate",e[e.NoRestriction=2]="NoRestriction"}(W||(W={})),function(e){e[e.Standard=0]="Standard",e[e.Private=1]="Private",e[e.Shared=4]="Shared"}(V||(V={})),function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(H||(H={})),function(e){e[e.None=0]="None",e[e.Adhoc=1]="Adhoc",e[e.Scheduled=2]="Scheduled",e[e.Recurring=3]="Recurring",e[e.Broadcast=4]="Broadcast",e[e.MeetNow=5]="MeetNow"}($||($={})),function(e){e[e.None=0]="None",e[e.Daily=1]="Daily",e[e.Weekly=2]="Weekly",e[e.Monthly=3]="Monthly",e[e.RelativeMonthly=4]="RelativeMonthly",e[e.Yearly=5]="Yearly",e[e.RelativeYearly=6]="RelativeYearly"}(z||(z={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last"}(G||(G={})),function(e){e[e.January=1]="January",e[e.February=2]="February",e[e.March=3]="March",e[e.April=4]="April",e[e.May=5]="May",e[e.June=6]="June",e[e.July=7]="July",e[e.August=8]="August",e[e.September=9]="September",e[e.October=10]="October",e[e.November=11]="November",e[e.December=12]="December"}(q||(q={})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(Q||(Q={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last"}(J||(J={})),function(e){e[e.None=0]="None",e[e.Sfb=1]="Sfb"}(Y||(Y={})),function(e){e[e.Meeting=1]="Meeting",e[e.None=0]="None",e[e.Channel=2]="Channel"}(K||(K={})),function(e){e[e.Success=0]="Success",e[e.TranslationFailed=1]="TranslationFailed",e[e.MessageNotFound=2]="MessageNotFound",e[e.VersionNotFound=3]="VersionNotFound",e[e.SkipTranslation=4]="SkipTranslation",e[e.ContentIsEmpty=5]="ContentIsEmpty",e[e.LanguageDetectionFailed=6]="LanguageDetectionFailed",e[e.UnsupportedSourceLanguage=7]="UnsupportedSourceLanguage",e[e.UnknownError=10]="UnknownError"}(Z||(Z={})),function(e){e.Badges="badges",e.Chat="chat",e.ChatMessages="chatmessages",e.ChatMessage="chatmessage",e.Chats="chats",e.ChatsV2="chats_v2",e.ChatsV3="chats_v3",e.ChatsByTitle="chatsByTitle",e.ChatSummarization="chatSummarization",e.ChatWithUser="chatwithuser",e.CrossPost="crosspost",e.GetPost="getPost",e.GetSupportedTranslationLanguages="getSupportedTranslationLanguages",e.PostAuthors="postAuthors",e.ReplyChain="replychain",e.ReplyChains="replychains",e.ReplyChainsV2="replychains_v2",e.RepliesInChain="repliesInChain",e.StartupGroupChats="startupgroupchats",e.StartupNonRecentChats="startupnonrecentchats",e.ScheduleMessage="schedulemessage",e.SystemMessages="systemmessages",e.Teams="teams",e.TranslateMessages="translatemessages",e.PinnedChannels="pinnedChannels",e.PinnedPost="pins",e.PinPost="pinPost",e.UnpinPost="unpinPost",e.Parents="parents"}(X||(X={})),function(e){e.ContentType="content-type",e.XChatserviceEndpoint="x-csendpoint",e.XClientUiLanguage="x-client-ui-language",e.XRequestPriority="x-ms-request-priority"}(ee||(ee={})),function(e){e.SharedChannel="sharedchannel",e.PrivateChannel="privatechannel",e.Unknown=""}(te||(te={})),function(e){e[e.Embed=4]="Embed"}(ne||(ne={}));function ie(e){const{apiConstants:t}=e.get(r.J.CsaService),{resource:n=S,version:i=v,endpoints:a=C}=t||{};return{resource:n,version:i,endpoints:a}}function ae(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{csaHostOverrideUrl:n}=e.get(r.J.Test),m=`${b}/`;if(n)return(0,c.m)(n)||m;const{host:g}=e.get(r.J.CsaService).apiConstants||{};if(!!e.get(r.J.CsaService).useHostFromGtmTable){const n=e.get(r.J.Core).endpointsManagerBaseUrlResolutionTimeoutInMs||12e4,p=(yield((e,t)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const n=e.regionGtm(a.Pn.chatSvcAggAfd);return(0,d.E)(n,t,l.A.BaseUrlTimeout).catch((e=>{if(!(0,s.B)(e)&&!(0,d.T)(e))throw(0,u.Tr)(l.A.BaseUrlFailedToResolve,o.jK.FailedToGet,"getCSAHostFromGtm",void 0,null==e?void 0:e.message)}))})))(t,n))||g||m;return(0,c.m)(p)}{const e=g||m;return(0,c.m)(e)}}))}},378720:(e,t,n)=>{"use strict";n.d(t,{wT:()=>g,GS:()=>p,c_:()=>v,B8:()=>h,_2:()=>f,LQ:()=>y,Jn:()=>k,Iy:()=>S,Bu:()=>b,vJ:()=>C,re:()=>w,mO:()=>N,dk:()=>T,io:()=>I,x:()=>E,X5:()=>A,$n:()=>_,_T:()=>D,MQ:()=>F,Xc:()=>M,DA:()=>R,gw:()=>P,lj:()=>O,oy:()=>x,lF:()=>L});var i=n(118824),a=n(907207),o=n(284931),r=n(892891),s=n(186930),l=n(870209),d=n(395816),c=n(455304),u=n(96220),m=n(975652);const g=({isActionToAccept:e,isUserBlocked:t,isInQuarantine:n,quarantineCounter:o,creator:r,currentUserMri:s},l)=>{let d=a.uI.Accepted;if(e){if(t){const e=r===s,{maxInviteFreeQuarantineCounter:t}=l.get(i.J.People),c=o>=(t||0);n&&!e?d=a.uI.AcceptPending:e&&c&&(d=a.uI.Quarantined)}}else d=a.uI.Blocked;return d},p=(e,t)=>v(e.id,t)&&f(e,t),v=(e,t)=>{if(e===a.kK||e===a.Ov||e.includes(a.YP))return!1;const{overrideThreadTypeForPrivateFeeds:n}=t.get(i.J.Sync);return!(0,l.dV)(e)||!n},h=e=>e.startsWith(a.IK)?"MRI conv id":e,f=(e,t)=>!(y(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(i.J.Messaging),{isSfbCloud:n,isSipEnabled:a,isSfbCloudInBVD:o,isSipEnabledInBVD:r}=e.get(i.J.UserResources);return!!(t?r&&o:a&&n)}(t));function y(e){return((0,r.isString)(e)?e:e.id).endsWith(a.GQ)}const k=e=>!!e&&y(e),S=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[a.e0.RelationshipState];return!!(null==n?void 0:n.edRedemptionRequired)},b=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[a.e0.RelationshipState];return!!(null==n?void 0:n.blockTime)};const C=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[a.e0.IsModerator])},w=e=>e.threadProperties&&!!e.threadProperties[a.Q5.ParentSpaces],N=e=>e.threadProperties&&e.threadProperties[a.Q5.ThreadType]===o.T.Team&&w(e),T=e=>{var t,n;if(e.threadProperties&&(null===(t=e.threadProperties)||void 0===t?void 0:t[a.Q5.ParentSpaces]))try{const t=JSON.parse(null===(n=e.threadProperties)||void 0===n?void 0:n[a.Q5.ParentSpaces]);return t&&t.linkedSpaceInfoItems&&t.linkedSpaceInfoItems[0]&&t.linkedSpaceInfoItems[0].spaceThreadId&&t.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},I=e=>{if(e.threadProperties)try{const t=e.threadProperties.meeting,n=t?JSON.parse(t):void 0;return n?n.meetingType:void 0}catch(e){return}},E=e=>A(e.type),A=e=>!!e&&e.toLowerCase&&e.toLowerCase()===a.i1.Meeting.toLowerCase(),_=e=>{let t;if(E(e)&&e.threadProperties.meeting)try{const n=JSON.parse(e.threadProperties.meeting);n.subject&&(t=n.subject)}catch(e){return t}return t},D=e=>e===a.Cs.Text||e===a.Cs.RichText||e===a.Cs.HTML,F=e=>{var t;return!!(null===(t=e.members)||void 0===t?void 0:t.some((e=>(0,l.Nl)(e.id))))},M=e=>{var t;return e.id===s.VS.CallLogConversationId||(0,l.u5)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},R=e=>{const t=u.I*c.kg*u.s;if(!e||isNaN(e))return!0;return e-Date.now()<t},P=e=>(null==e?void 0:e.threadProperties)&&((null==e?void 0:e.threadProperties[a.Q5.ThreadType])===o.T.Community||(null==e?void 0:e.threadProperties[a.Q5.SpaceType])===a.Q5.SpaceType_Community),O=e=>e.threadProperties&&e.threadProperties[a.Q5.SubstrateGroupId]||"",x=e=>{var t,n;const i=null===(n=null===(t=e.threadProperties)||void 0===t?void 0:t[a.Q5.ThreadSubType])||void 0===n?void 0:n.toLowerCase();return i||m.YF.Unknown},L=e=>{const t=e.threadProperties&&e.threadProperties[a.Q5.ThreadType];return U(t)},U=e=>{if(e)return"space"===e||"topic"===e?d.k2e.Channel:"meeting"===e?d.k2e.Meeting:d.k2e.None}},129350:(e,t,n)=>{"use strict";n.d(t,{MJ:()=>m,K6:()=>g,Du:()=>p,ut:()=>v,uY:()=>h,pl:()=>f,ky:()=>y,Fz:()=>k,zb:()=>S,s6:()=>b,rt:()=>C,xb:()=>w,eb:()=>N,HU:()=>T,X3:()=>I,Dq:()=>A,iX:()=>_,S5:()=>D,$V:()=>F,JJ:()=>M,J6:()=>R,sL:()=>P,pi:()=>O,Cd:()=>x,hk:()=>L,rj:()=>U,Fv:()=>B,hu:()=>j,dO:()=>W,BL:()=>V,jo:()=>H,nZ:()=>$,iE:()=>z,hP:()=>G,qo:()=>q,CB:()=>Q,au:()=>J,ZY:()=>Y,T7:()=>K,Xg:()=>Z,YP:()=>X,j8:()=>te,dG:()=>oe,Lg:()=>re,Su:()=>se,rP:()=>le,As:()=>de,nL:()=>ce,Bl:()=>ue,mB:()=>me,Eu:()=>ge,hC:()=>pe,DZ:()=>ve,me:()=>he,BU:()=>fe,Ii:()=>ye,$c:()=>ke,tl:()=>Se,Ts:()=>be,wU:()=>Ce,jM:()=>Te,Il:()=>Ie,Fx:()=>Ee,Ki:()=>Ae,rf:()=>_e,cu:()=>De,ln:()=>Fe,iK:()=>Me});var i=n(186930),a=n(892891),o=n(118824),r=n(870209),s=n(907207),l=n(284931),d=n(975652),c=n(378720),u=n(275879);var m;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(m||(m={}));const g=e=>{const t=N(e);return(0,c.LQ)(e)?t:t||(0,c.Jn)(e)},p=e=>{var t;return(null===(t=e.threadProperties)||void 0===t?void 0:t[s.Q5.Creator])||null},v=e=>e.threadProperties&&e.threadProperties[s.Q5.CreatedAt]?e.threadProperties[s.Q5.CreatedAt]:null,h=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[s.Q5.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},f=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[s.Ff.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},y=(e,t)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const n=W(e,t);return 0!==n&&(!(0,a.isNil)(e.lastMessageTimeUtc)&&n>=e.lastMessageTimeUtc)},k=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Followed])&&"true"===(null===(t=e.properties[s.Ff.Followed])||void 0===t?void 0:t.toLowerCase())},S=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Collapsed])&&"true"===(null===(t=e.properties[s.Ff.Collapsed])||void 0===t?void 0:t.toLowerCase())},b=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,C=e=>b(e)||!G(e);function w(e){return e.includes(s.YP)||e===s.kK}const N=e=>{var t;return(0,r.Q5)(e.id,null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)&&w(e.id)},T=e=>e.threadProperties&&(e.threadProperties[s.Q5.ThreadType]===l.T.Team||e.threadProperties[s.Q5.ThreadType]===l.T.Community)&&!(0,c.re)(e),I=e=>O(e)?he(e)||"":K(e)||"";function E(e){return!!e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===l.T.Team}const A=e=>{var t;if(e.properties){if(e.properties[s.Ff.Favorite])return"true"===(null===(t=e.properties[s.Ff.Favorite])||void 0===t?void 0:t.toLowerCase());if(E(e))return!0}return!1},_=(e,t=!1)=>D(e.type,t),D=(e,t=!1)=>!(0,a.isNil)(e)&&(e.toLowerCase()===s.i1.Chat.toLowerCase()||e.toLowerCase()===s.i1.PhoneChat.toLowerCase()||e.toLowerCase()===s.i1.OneOnOne.toLowerCase()||e.toLowerCase()===s.i1.StreamOfNotes.toLowerCase()||!t&&(0,c.X5)(e)),F=e=>{var t;return e.id===i.VS.NotificationConversationId||(0,r.j6)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},M=e=>e===i.VS.AnnotationsConversationId,R=e=>e.type===s.i1.Team||e.type===s.i1.Topic,P=e=>q(e)===d.xu.Shared,O=e=>(0,c.mO)(e)&&(0,c.dk)(e)&&q(e)===d.xu.Private,x=e=>T(e)&&!!e.memberProperties&&!!e.memberProperties[s.e0.ChannelOnlyMember],L=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===s.wJ.Adhoc},U=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===s.wJ.Scheduled},B=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(s.rK)?s.rK+t:t),j=(e,t)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:n}=t.get(o.J.Sync),i=n||P(e)?e.threadProperties.retentionHorizonV2:0;return i&&isFinite(Number(i))?Number(i):0},W=(e,t)=>{if(!e.properties)return 0;if(f(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const n=(!t||!!t.get(o.J.Messaging).enableDeleteChat)&&_(e)?e.properties.clearHistoryTime:0;return n&&isFinite(Number(n))?Number(n):0},V=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,H=(e,t,n)=>{const i=j(t,n);return!isNaN(Number(e))&&!isNaN(i)&&Number(e)<i},$=(e,t,n)=>{const i=W(t,n),a=Number(e);return!isNaN(a)&&!isNaN(i)&&a<i},z=(e,t,n=!1)=>{var i;if((0,r.Q5)(e.id,null===(i=null==e?void 0:e.threadProperties)||void 0===i?void 0:i.threadType)&&!b(e)){if(e.memberProperties&&n)return e.memberProperties[s.e0.ExpirationTime];if(e.members&&t){const n=(0,a.find)(e.members,(e=>e&&e.id===t));return n&&n.memberExpirationTime}return e.memberProperties&&e.memberProperties[s.e0.ExpirationTime]}},G=(e,t)=>{var n;return!(0,r.Q5)(e.id,null===(n=null==e?void 0:e.threadProperties)||void 0===n?void 0:n.threadType)||!b(e)&&!h(e)&&((0,a.isArray)(e.members)&&t?(0,a.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&R(e)&&!e.threadProperties[s.Q5.LastLeaveAt]&&!e.threadProperties[s.Q5.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[s.Q5.LastLeaveAt]&&(!e.threadProperties[s.Q5.LastJoinAt]||e.threadProperties[s.Q5.LastJoinAt]<e.threadProperties[s.Q5.LastLeaveAt])))};function q(e){if(!e||!R(e))return;const t=e.threadProperties[s.Q5.SpaceTypes],n=t?parseInt(t,10):0,i=!!e.threadProperties[s.Q5.SubstrateGroupId],a=(0,c.oy)(e);return i?a===d.YF.PrivateChannel?d.xu.Private:d.xu.Shared:(n&d.tG.Private)===d.tG.Private?d.xu.Private:d.xu.Standard}const Q=(e,t)=>{var n;if(!!e.threadProperties.isLastMessageFromMe)return!0;const i=null===(n=e.lastMessage)||void 0===n?void 0:n.from;if(!i)return!1;return t===(0,a.last)(i.split("/"))},J=(e,t)=>(0,a.reduce)(e.members,((e,n)=>{const i=n.id;return i&&i!==t&&e.push(i),e}),[]),Y=(e,t,n)=>{let i;const o=!e.members||!!e.members&&(0,a.some)(e.members,(e=>!e));if(n&&!o){const a=J(e,t);i=N(e)&&1===a.length?n[a[0]]:n[e.id]}return i},K=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(_(e)){let t=e.threadProperties.topic;if(t&&-1!==t.indexOf(":")&&(t=void 0),!t&&(0,c.x)(e)){const n=(0,c.$n)(e);n&&(t=n)}return t}if(E(e)&&oe(e)){const t=he(e);if(t&&t.trim())return t}else{const t=e.threadProperties.topic,n=e.threadProperties[s.Q5.TopicThreadTopic];if(t&&t.trim())return t;if(n&&n.trim())return n}}return""},Z=(e,t=!1)=>_(e,!0)&&!X(e,t),X=(e,t=!1)=>{var n;const i=e.members&&e.members.length<=2;return _(e,!0)&&i&&(N(e)||ae(e)||!t&&ie(e)||ee(e))&&!(null===(n=e.members)||void 0===n?void 0:n.some((e=>(0,r.$i)(e.id))))},ee=e=>e.members&&e.members.length<=2&&ne(e)&&(e.type===s.i1.PhoneChat||e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===l.T.PhoneChat),te=e=>!!(null==e?void 0:e.startsWith(s.at.PhonelinkSmsPrefix)),ne=e=>(0,a.some)(e.members,(e=>!!e.id&&e.id.startsWith(s.at.Pstn))),ie=e=>_(e,!0)&&e.members&&2===e.members.length&&!(0,a.isNil)(e.threadProperties)&&parseInt(e.threadProperties[s.Q5.CreatedAt],10)<s.Yv,ae=e=>{var t,n;return!!e.id&&e.id.indexOf(s.B3)>-1||"true"===(null===(n=null===(t=e.threadProperties[s.Q5.P2PChatUniqueRosterThread])||void 0===t?void 0:t.toString())||void 0===n?void 0:n.toLowerCase())||we(e)},oe=e=>e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===l.T.Topic||O(e)||P(e),re=e=>(0,c.Jn)(e),se=e=>ue(e&&e.id),le=e=>re(e)||(e=>de(e))(e)||se(e),de=e=>{const t=(0,a.isString)(e)?e:e.id;return(0,a.endsWith)(t,s.M9)||(0,a.endsWith)(t,s.IS)||(0,a.startsWith)(t,s.X2)},ce=e=>de(e)||Ce(e),ue=e=>!!e&&((0,a.endsWith)(e,s.RS)||(0,a.startsWith)(e,s.QV)),me=e=>e===s.Z,ge=e=>{const t=(0,a.endsWith)(e,s.M9)||(0,a.endsWith)(e,s.IS)||(0,a.startsWith)(e,s.X2),n=e.endsWith(s.GQ),i=ue(e);return t||n||i},pe=e=>{const t=z(e),n=t&&t<Date.now();return G(e)&&!n},ve=e=>{if(e.threadProperties&&e.threadProperties[s.Q5.Topics]){const t=e.threadProperties[s.Q5.Topics];if("["!==t.substr(0,1))return t.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(t)}catch(e){return[]}}return[]},he=e=>{if(e.threadProperties){if(e.threadProperties[s.Q5.XTeamName])return e.threadProperties[s.Q5.XTeamName];if(e.type===s.i1.Team&&e.threadProperties.topic)return e.threadProperties.topic}},fe=e=>{const t=ve(e),n=he(e);return t.map((t=>{const i={},a=t.name;return i[s.Q5.CreatedAt]=parseInt(t.createdat,10),i[s.Q5.Picture]=t.picture,i[s.Q5.IsDeleted]=t.isdeleted,i[s.Q5.XTeamName]=t.isShared?a:n,i.topic=a,i[s.Q5.TopicThreadTopic]=a,{threadProperties:i,id:t.id,members:[],messages:"",properties:{},version:0,type:s.i1.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},ye=e=>{if(e.parentId)return e.parentId;if((0,c.re)(e))try{const t=JSON.parse(e.threadProperties[s.Q5.ParentSpaces]),n=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,a.isEmpty)(n))return n}catch(e){return}},ke=e=>{const t=e.threadProperties&&e.threadProperties[s.Q5.SpaceId];return(T(e)?e.id:(0,c.re)(e)?ye(e):t)||e.teamId},Se=e=>{var t;const n=e.properties?null===(t=e.properties[s.Ff.Alerts])||void 0===t?void 0:t.trim().toLowerCase():void 0;return"true"!==n&&("false"===n||void 0)},be=e=>e.threadProperties&&((0,a.isBoolean)(e.threadProperties[s.Q5.GapDetectionEnabled])?e.threadProperties[s.Q5.GapDetectionEnabled]:"true"===(0,a.lowerCase)(e.threadProperties[s.Q5.GapDetectionEnabled])),Ce=e=>{const t=Te(e);return t&&!de(e)&&X(e)&&(0,a.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||Ne(e.id)||Ne(e.localClientId||"")},we=e=>{var t,n;return!(0,a.isNil)(e.threadProperties)&&(e.threadProperties[s.Q5.TemplateType]===s.Q5.ImmutableRoster||"true"===(null===(n=null===(t=e.threadProperties[s.Q5.IsStickyThread])||void 0===t?void 0:t.toString())||void 0===n?void 0:n.toLowerCase()))},Ne=e=>(0,a.startsWith)(e,s.At),Te=e=>e.threadProperties&&e.threadProperties[s.Q5.TenantId],Ie=e=>{const t=T(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Space.toLowerCase(),n=R(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Topic.toLowerCase();return t||n},Ee=e=>function(e){if(!e.properties)return!1;return function(e){if(!e)return 0;const t=new Date(e),n=t?t.getTime():0;return isNaN(n)?0:n}(e.properties[s.Ff.LastImportantImTime])>Number(Ae(e).originalArrivalTime)}(e),Ae=e=>(0,a.isEmpty)(e.properties&&e.properties[s.Ff.ConsumptionHorizonBookmark])?(0,u.bf)(e):(0,u.BU)(e);const _e=e=>{if(!e||!e.properties)return!1;const t=e.properties[s.Ff.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},De=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return!!(null==n?void 0:n.inQuarantine)},Fe=e=>{var t;const n=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return"number"==typeof(null==n?void 0:n.quarantineCounter)?null==n?void 0:n.quarantineCounter:0},Me=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.ExplicitlyAdded])}},817102:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>i,$:()=>a}),function(e){e.feed="TeamsFeed",e.syncFeed="TeamsFeedSync"}(i||(i={}));const a={defaultSection:"TeamsFeed",defaultTimeSortedSection:"TeamsFeedTimeSorted",defaultItemsToFetch:3,defaultLoadMoreItemsCount:5,defaultItemsToCompare:3,defaultReadSignalMinDwellTime:5e3,defaultDataSyncIntervalTime:3e5,defaultDiscoverTriagingTime:3e5}},987896:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{Jv:()=>i,OP:()=>a,cw:()=>o}),function(e){e.NotInstalled="NotInstalled",e.InstalledNotActive="InstalledNotActive",e.InstalledActive="InstalledActive"}(i||(i={})),function(e){e.Teams1="Teams1",e.Teams2="Teams2"}(a||(a={})),function(e){e.DownloadedAndInstalled="DownloadedAndInstalled",e.FailedToDownload="FailedToDownload",e.FailedToInstall="FailedToInstall",e.DownloadPageOpened="DownloadPageOpened"}(o||(o={}))},231776:(e,t,n)=>{"use strict";var i,a;n.d(t,{$:()=>i,f:()=>a}),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Unknown="Unknown",e.Resumed="Resumed",e.Suspending="Suspending"}(i||(i={})),function(e){e.Light="Light",e.Dark="Dark",e.Contrast="Contrast",e.OSTheme="OSTheme"}(a||(a={}))},791273:(e,t,n)=>{"use strict";var i,a,o,r,s,l;n.d(t,{px:()=>i,i$:()=>r}),function(e){e.None="None",e.Core="Core",e.MeetNow="MeetNow",e.Loading="Loading",e.Main="Main",e.ChatPopout="ChatPopout",e.Meeting="Meeting"}(i||(i={})),function(e){e.MouseEnter="MouseEnter",e.MouseLeave="MouseLeave",e.Click="Click"}(a||(a={})),function(e){e.Text="Text",e.Pointer="Pointer"}(o||(o={})),function(e){e.ButtonsOnly="ButtonsOnly",e.FullWidth="FullWidth"}(r||(r={})),function(e){e.TopLeft="TopLeft",e.TopRight="TopRight",e.BottomLeft="BottomLeft",e.BottomRight="BottomRight"}(s||(s={})),function(e){e.Hidden="Hidden",e.Visible="Visible",e.Disabled="Disabled"}(l||(l={}))},422074:(e,t,n)=>{"use strict";var i;n.d(t,{$:()=>i}),function(e){e.None="none",e.DayStart="dayStart",e.MeetingPrep="meetingPrep",e.MeetingStart="meetingStart",e.MeetingStarted="meetingStarted",e.MeetingEnd="meetingEnd",e.Feedback="feedback",e.InMeetingActionStatusUpdated="inMeetingActionStatusUpdated",e.InMeetingGreeting="inMeetingGreeting",e.InMeetingShareFile="inMeetingShareFile",e.RunningLate="inMeetingRunningLate",e.ReportUsage="reportUsage"}(i||(i={}))},6366:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{TS:()=>i,Cb:()=>a,H8:()=>o,zt:()=>r,GM:()=>s,rh:()=>l,Tj:()=>d}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.calendarPeoplePicker="calendarPeoplePicker",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.allFalse="allFalse",e.allTrue="allTrue",e.meetingRoomCall="meetingRoomCall",e.voicemailTransferTarget="voicemailTransferTarget",e.custom="custom"}(i||(i={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.CallQandAA="CallQandAA",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap",e.TflOffNetworkEmails="TflOffNetworkEmails",e.TflOffNetworkPhones="TflOffNetworkPhones",e.TflConsumer="TflConsumer",e.TflSmsName="TflSmsName",e.ImplicitContacts="ImplicitContacts",e.ExtendedDirectoryUsers="ExtendedDirectoryUsers",e.MTOUsers="MTOUsers"}(a||(a={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache",e.Memory="Memory",e.TFLZeroState="TFLZeroState"}(o||(o={}));const r={IDBFedBot:"IDB-FedBot",IDBPeopleGroup:"IDB-PeopleGroup",TeamTag:"TeamTag",Memory:"Memory",MT:"MT"},s={EntityActionTaken:"EntityActionTaken",EntityClicked:"EntityClicked",MouseHover:"MouseHover"},l={OpenContactCard:"OpenContactCard",Remove:"Remove"},d={Vertical:"vertical"}},326476:(e,t,n)=>{"use strict";var i,a,o,r;n.d(t,{WH:()=>i,xd:()=>a,$D:()=>o,Uj:()=>r,Zh:()=>s,z_:()=>l,Ei:()=>d,iu:()=>c,UJ:()=>u,Je:()=>m,IE:()=>g}),function(e){e.ConsumerUser="ConsumerUser",e.NotFound="NotFound",e.Success="Success"}(i||(i={})),function(e){e[e.CoreScenario=0]="CoreScenario",e[e.DialToneScenario=1]="DialToneScenario",e[e.BackgroundTask=2]="BackgroundTask"}(a||(a={})),function(e){e.XSmall="HR32x32",e.Small="HR64x64",e.Medium="HR96x96",e.XMedium="HR120x120",e.Large="HR196x196"}(o||(o={})),function(e){e.TfwWithSfc="tfwWithSfc",e.TfwWithTfl="tfwWithTfl",e.TflWithTfw="tflWithTfw",e.TfwWithTfwFederated="tfwWithTfwFederated",e.ExtendedDirectoryTflWithTfw="extendedDirectoryTflWithTfw"}(r||(r={}));const s=["Large","XMedium","Medium","Small","XSmall"];var l,d,c,u,m;!function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Other="Other"}(l||(l={})),function(e){e.Private="Private",e.Public="Public"}(d||(d={})),function(e){e.success="success",e.invalid="invalid",e.inTenantUser="intenantuser",e.consumerUser="consumeruser",e.notFound="notfound",e.notAllowed="notallowed",e.failed="failed",e.missingResponse="missingresponse",e.backendrequestfailed="backendrequestfailed"}(c||(c={})),function(e){e.UpdateMSASearchabilityStamping="updateMSASearchabilityStamping",e.UpdateMsaAliasVisibilitySetting="updateMsaAliasVisibilitySetting",e.GetPeopleProfilesByMris="getPeopleProfilesByMris",e.GetFederatedPeopleProfilesByMris="getFederatedPeopleProfilesByMris",e.GetPeopleProfilesByEmails="getPeopleProfilesByEmails",e.GetFederatedPeopleProfilesByEmails="getFederatedPeopleProfilesByEmails",e.GetMeProfile="getMeProfile",e.GetOfficeGroup="getOfficeGroup",e.GetUser="getUser",e.FetchAllUsersByMrisInSharedChannel="people_get_all_users_sharedChannel",e.FetchAllUsersByMrisInSharedChannelBatch="people_get_users_sharedChannel_batch",e.UpdateMsaUserName="update_msa_profile_displayname",e.UpdateMsaProfileAvatar="update_msa_profile_avatar",e.removeSelfProfilePicture="remove_msa_profile_picture",e.UpdateGroupProfileAvatar="update_group_profile_avatar",e.DeleteGroupProfileAvatar="delete-group-profile-avatar",e.GetTflConsumerProfilesByMris="getTflConsumerProfilesByMris",e.GetSkypeConsumerProfilesByMris="getSkypeConsumerProfilesByMris",e.FetchWorkingSet="fetchWorkingSet",e.GetTenantPrivacyPolicyStatementUrl="getTenantPrivacyPolicyStatementUrl"}(u||(u={})),function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.PUT="PUT",e.DELETE="DELETE"}(m||(m={}));const g=["displayName","imageUri"]},142604:(e,t,n)=>{"use strict";n.d(t,{MD:()=>i,t:()=>a,vf:()=>o,p_:()=>r,cT:()=>s});const i={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},a={botType:"BOT"},o={member:"Member",guest:"Guest",anonymousUser:"AnonymousUser",voiceApp:"ADVoiceApp",DistributionList:"Group",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",tflOffNetwork:"TFLOffNetwork",personalContactUser:"PersonalContactUser",tflConsumer:"TflConsumer",pstn:"pstn",extendedDirectoryUser:"EDUser",PendingOrgContact:"PendingOrgContact",OrgContact:"OrgContact",MTOUser:"MTOUser",B2BMember:"B2BMember",ADUser:"ADUser"},r={MTOUser:64,B2BMember:32},s={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"}},523556:(e,t,n)=>{"use strict";n.d(t,{M:()=>u,T0:()=>p,wo:()=>f,DS:()=>y,Im:()=>k,S4:()=>S,$V:()=>b,$l:()=>C,eo:()=>w});var i=n(231191),a=n(6366),o=n(118824),r=n(723373),s=n(142604),l=n(455304),d=n(892891),c=n(502798);const u="unknown_email_address@invalid.teams.ms",m=l.Xg*l.A_*16,g=2*l.Yx*l.Ix*l.Xg*l.A_,p="4:",v="8:tfloffnetwork:",h="50:sms:",f="50:smsunverified:",y="unknown user",k="8:teamsvisitor:",S="8:guest:",b="TflContacts";var C;!function(e){e.NotResolved="NotResolved",e.External="External",e.User="User",e.DistributionList="DistributionList"}(C||(C={}));class w{static isUnknownUser(e){return e.email===u||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return u}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static sanitizeUserProfileObject(e){if(!e)throw new Error("Invalid user profile object passed");const t=Object.assign({isSelf:void 0,managerLevel:void 0},e),{isSelf:n,managerLevel:a,userClassification:o}=t;return(0,i.__rest)(t,["isSelf","managerLevel","userClassification"])}static getCacheExpiryCallbackForUser(e,t=null){return function(n){if(n.isAnonymousUser)return 0;const i=n.skypeTeamsInfo&&n.skypeTeamsInfo.isSkypeTeamsUser,{enableNonTeamsUserShortCacheExpiry:a}=e.get(o.J.People);return a&&!i?m:t||g}}static addDescription(e,t=!1,n=!1){if(e.description||this.isBot(e))return;if(n&&e.type===s.vf.federated)return void(e.description=e.tenantName||"");const i=e.userPrincipalName.substr(0,e.userPrincipalName.indexOf("@")).toUpperCase();e.description=e.jobTitle?`(${i}) ${e.jobTitle}`:e.userType===s.vf.guest||t?e.email||e.userPrincipalName:i}static addUserDisplaynamePostFix(e,t,n){const{enableTaglessNameForAnonConsumerUser:i}=t.get(o.J.People),a=i&&e.isAnonymousUser;return e.displayName=w.removeMismatchedPostFix(i,e.displayName,n),a?this.addExternalIndicator(e,n):this.addGuestIndicator(e,n)}static addExternalIndicator(e,t){const n=t.stringTranslate("peoplePicker","external_user_postfix"),i=e.guestlessDisplayName&&e.guestlessDisplayName.indexOf(n);if(i&&i>=0)return void(e.guestlessDisplayName=e.guestlessDisplayName.substring(0,i-1));!e.displayName.includes(n)&&e.displayName!==t.stringTranslate("peoplePicker","default_external_displayname")&&(e.displayName=`${e.displayName} ${n}`),e.givenName&&(e.guestGivenName=`${e.givenName} ${n}`),e.surname&&(e.guestSurname=`${e.surname} ${n}`)}static addGuestIndicator(e,t){const n=t.stringTranslate("peoplePicker","guest_user_postfix"),i=e.guestlessDisplayName.indexOf(n);i>-1?e.guestlessDisplayName=e.guestlessDisplayName.substring(0,i).trimRight():(e.displayName=`${e.displayName} ${n}`,e.givenName&&(e.guestGivenName=`${e.givenName} ${n}`),e.surname&&(e.guestSurname=`${e.surname} ${n}`))}static getUserDisplaynamePostFix(e,t,n,i,a,s,l,d){var c;if(!t)return null;const{enableTaglessNameForAnonConsumerUser:u}=i.get(o.J.People),m=i.get(o.J.Metadata).environment===r.s.life,g=e.startsWith(k),p=e.startsWith(S);if(m&&p)t=u?w.removeMismatchedPostFix(u,t,a):w.checkAndAddGuestTag(t,a);else if(!m&&g)t=w.removeMismatchedPostFix(u,t,a),t=u?w.checkAndAddExternalTag(t,a):w.checkAndAddGuestTag(t,a);else if(n||s){let e=!1;n&&(e=Boolean(null===(c=null==i?void 0:i.get(o.J.Messaging))||void 0===c?void 0:c.enableConsumerConversations)),e||(t=w.checkAndAddExternalTag(t,a))}else(l||d)&&(t=w.checkAndAddExternalTag(t,a));return t}static checkAndAddGuestTag(e,t){const n=this.getDefaultGuestDisplayName(t),i=this.getGuestUserTag(t);let a=e;return e.includes(i)||e===n||(a+=` ${i}`),a}static checkAndAddExternalTag(e,t){const n=this.getDefaultExternalDisplayname(t),i=this.getExternalTag(t);let a=e;return e.includes(i)||e===n||(a+=` ${i}`),a}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname",{defaultValue:"Guest"})}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix",{defaultValue:"(Guest)"})}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname",{defaultValue:"External"})}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix",{defaultValue:"(External)"})}static removeMismatchedPostFix(e,t,n){const i=e?"guest_user_postfix":"external_user_postfix",a=n.stringTranslate("peoplePicker",i),o=t.indexOf(a);return o>-1?t.substring(0,o).trimRight():t}static addUserTypeInfo(e){e.type&&e.type===s.vf.ADUser||"User"===e.objectType?(e.type=s.cT.type.person,e.$$subType="ADUser"):e.type&&(e.$$subType=e.type)}static applyFeatureFlagSettings(e,t){let n=e.includeFeatures;const i=Boolean(t.get(o.J.Messaging).enableConsumerConversations);switch(e.name){case a.TS.addToMeeting:{const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:r}=t.get(o.J.Federated);r||(n=(0,d.difference)(n,[a.Cb.Federated])),e&&(n=(0,d.difference)(n,[a.Cb.Bot])),n=i?(0,d.difference)(n,[a.Cb.Federated]):(0,d.difference)(n,[a.Cb.TflConsumer]);break}case a.TS.allTrue:{const{enableTflTfwFederation:e,enableTfwTflFederation:r}=t.get(o.J.Host);i?e&&(n=(0,d.difference)(n,[a.Cb.Federated])):r&&(n=(0,d.difference)(n,[a.Cb.TflConsumer]));break}case a.TS.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:r}=t.get(o.J.Federated);r||(n=(0,d.difference)(n,[a.Cb.Federated])),e&&(n=(0,d.difference)(n,[a.Cb.Bot]));break;case a.TS.addToChat:const{enableFederatedUsersInAddToChat:s}=t.get(o.J.Federated),{enableTfwFederationOnTfl:l,enableTfwTflFederation:c}=t.get(o.J.Host);i?l||(n=(0,d.difference)(n,[a.Cb.Federated])):(s||(n=(0,d.difference)(n,[a.Cb.Federated])),c||(n=(0,d.difference)(n,[a.Cb.TflConsumer])));const{enableDLsInAddToChat:u}=t.get(o.J.DistributionLists);u||(n=(0,d.difference)(n,[a.Cb.DL]));break;case a.TS.addToTeam:const{enableFederatedUsersInAddToTeam:m}=t.get(o.J.Federated);m||(n=(0,d.difference)(n,[a.Cb.Federated]));break;case a.TS.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:g}=t.get(o.J.Federated);g||(n=(0,d.difference)(n,[a.Cb.Federated]))}return c.a.createFrom(e,n)}static filterSearchResults(e,t,n){let i=t;return(e=w.applyFeatureFlagSettings(e,n)).includeFederated||(i=i.filter((e=>!(w.isFederatedUser(e)||w.isSfcUser(e)||w.isTFLConsumerUser(e))))),e.includeGuest||(i=i.filter((e=>!w.isGuestUser(e)))),e.includeBot||(i=i.filter((e=>!w.isBot(e)))),e.includeDL||(i=i.filter((e=>!w.isDistributionList(e)))),e.includePstn||(i=i.filter((e=>!w.isPSTNUser(e)))),e.includeAADTenant||(i=i.filter((e=>!w.isInTenantUser(e)))),e.includeCallQandAA||(i=i.filter((e=>!w.isCallQorAAUser(e)))),e.includeTflConsumer||(i=i.filter((e=>!w.isTFLConsumerUser(e)))),e.includeTflSmsName||(i=i.filter((e=>!w.isTFLSmsFriendlyNameUser(e)))),i}static getTflOffNetworkUserDefaultDisplayName(e){return e&&e.substring(e.lastIndexOf(":")+1)}static matchEmailAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>{var n;return e.toLowerCase()===(null===(n=t.address)||void 0===n?void 0:n.toLowerCase())}))}static matchPhoneAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>e===t.number))}static generatePstnProfile(e,t){return{mri:e,displayName:t,givenName:t,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:s.vf.pstn}}static convertStringToBlobFile(e){const t=e.split(",")[1];if((0,d.isEmpty)(t))return;const n=atob(t),i=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(n.length),o=new Uint8Array(a);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);return new Blob([o],{type:i})}static getPhoneNumbers(e){let t=[];return(null==e?void 0:e.telephoneNumber)&&t.push(e.telephoneNumber),(null==e?void 0:e.phones)&&e.phones.length>0&&(t=t.concat(e.phones.map((e=>e.number)))),t}static getExtendedDirectoryPhoneNumber(e){return w.getPhoneNumbers(e)[0]}static isPartialSCContext(e,t){return!!(e&&!t||!e&&t)}static getFederationType(e,t){let n;const i={type:t};return e?w.isTFLUser(i)?n="tflWithTfl":w.isFederatedUser(i)&&(n="tflWithTfw"):w.isSfcUser(i)?n="tfwWithSfc":w.isTFLConsumerUser(i)?n="tfwWithTfl":w.isFederatedUser(i)&&(n="tfwWithTfwFederated"),n}static getTfwExtendedDirectoryMembership(e,t={}){const{mri:n,userType:i}=e,{excludeOffNetwork:a=!0}=t;return!a&&this.isTFLOffNetworkUser(n)?"offNetwork":this.isPEUPUser(i)?"pending":this.isEUPUser(i)?"accepted":void 0}static getTflExtendedDirectoryMembership(e){return!0===e?"pending":!1===e?"accepted":void 0}static getExtendedDirectoryMembership(e,t,n){if(n&&w.isFederatedUser(t))return w.getTflExtendedDirectoryMembership(null==e?void 0:e.extendedDirectoryRedemptionRequired)}static determineM365PersonaType(e){if(!e)return C.NotResolved;const{type:t,userType:n,profileType:i}=e;if(!t)return C.NotResolved;switch(t){case"Federated":case"TflConsumer":case"SkypeConsumer":return C.External;case"person":case"ADUser":return n&&"Guest"===n?C.NotResolved:w.isMTOUser({profileType:i})?C.External:C.User;case"Group":return C.DistributionList;default:return C.User}}}w.isFederatedUser=e=>!!e.isFederated||e.type===s.vf.federated,w.isGuestUser=e=>e.type===s.vf.guest||e.userType===s.vf.guest,w.isPersonalContactUser=e=>e.type===s.vf.personalContactUser||e.userType===a.Cb.PersonalContact,w.isTFLUser=e=>e.type===s.vf.tflUser,w.isTFLConsumerUser=e=>e.type===s.vf.tflConsumer,w.isTFLSmsUser=e=>e.id&&w.isTFLSmsMri(e.id),w.isTFLSmsFriendlyNameUser=e=>e.id&&w.isTFLSmsMri(e.id)&&e.friendlyName,w.isInTenantUser=e=>{var t;return!((null===(t=e.type)||void 0===t?void 0:t.toLowerCase())!==s.cT.type.person.toLowerCase()&&e.type!==s.vf.ADUser||w.isGuestUser(e)||e.isFederated)},w.isBot=e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toUpperCase())===s.t.botType},w.isDistributionList=e=>e.type===s.vf.DistributionList&&(!e.objectType||e.objectType===s.vf.DistributionList),w.isPSTNUser=e=>e.mri&&0===e.mri.indexOf(p),w.isSfcUser=e=>e.type===s.vf.skypeConsumer,w.isMTOUser=e=>e.profileType===s.p_.MTOUser||e.userType===s.vf.MTOUser,w.isB2BMemberMTOUser=e=>w.isMTOUser(e)&&e.type===s.vf.ADUser,w.isFederatedMTOUser=e=>w.isMTOUser(e)&&w.isFederatedUser(e),w.isB2BMember=e=>e.profileType===s.p_.B2BMember||e.userType===s.vf.B2BMember,w.isB2BGuest=e=>e.userType===s.vf.guest,w.isExtendedDirectoryUser=e=>w.isPEUPUser(e.userType)||w.isEUPUser(e.userType)||e.type===s.vf.extendedDirectoryUser,w.isPEUPUser=e=>e===s.vf.PendingOrgContact,w.isEUPUser=e=>e===s.vf.OrgContact,w.isSfBUser=e=>Boolean(e.mri&&-1!==e.mri.indexOf("sfb:")),w.isCallQorAAUser=e=>e.type===s.vf.voiceApp,w.isMaskedOrExternalUser=e=>null==e?void 0:e.startsWith(k),w.isTFLOffNetworkUser=e=>0===(null==e?void 0:e.indexOf(v)),w.isTFLOffNetworkPhoneUser=e=>0===(null==e?void 0:e.indexOf("8:tfloffnetwork:phone:")),w.isTFLOffNetworkEmailUser=e=>0===(null==e?void 0:e.indexOf("8:tfloffnetwork:email:")),w.isTFLSmsUnVerifiedMri=e=>0===(null==e?void 0:e.indexOf(f)),w.isTFLSmsVerifiedMri=e=>0===(null==e?void 0:e.indexOf(h)),w.isTFLSmsMri=e=>0===(null==e?void 0:e.indexOf(h))||0===(null==e?void 0:e.indexOf(f)),w.isTFLSmsOrOffNetworkPhoneMri=e=>w.isTFLOffNetworkPhoneUser(e)||w.isTFLSmsMri(e),w.isTflSmsUnverifiedOrOffNetworkPhoneMri=e=>w.isTFLSmsUnVerifiedMri(e)||w.isTFLOffNetworkPhoneUser(e),w.isEnterpriseUserMri=e=>0===(null==e?void 0:e.indexOf("8:orgid:")),w.isDisplayNameUnknownUser=e=>(null==e?void 0:e.toLowerCase())===y||"unknown"===(null==e?void 0:e.toLowerCase()),w.isConversationItem=e=>{var t;return 0===(null===(t=e.id)||void 0===t?void 0:t.indexOf("19:"))},w.isTag=e=>"Tag"===e.type,w.getPhoneNumberFromMri=e=>e&&w.isTFLSmsUnVerifiedMri(e)?e.slice(f.length):""},882450:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});class i{constructor(){}static getInstance(){return this.platformAppConversationService||(this.platformAppConversationService=new i),this.platformAppConversationService}setSubEntityDeepLinkInfo(e){this.deepLink=e}getSubEntityDeepLinkInfo(){return this.deepLink}setClientMessageId(e){this.clientMessageId=e}getClientMessageId(){return this.clientMessageId}}},525965:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{f5:()=>i,Ko:()=>a,r1:()=>o}),function(e){e.ActiveUserOperation="AUO",e.PassiveOperation="PO",e.BackgroundOperation="BO"}(i||(i={})),function(e){e.UploadFile="ShareUploadFile",e.RemoveFile="ShareAbort"}(a||(a={})),function(e){e.Unknown="Unknown",e.Inline="Inline",e.Attached="Attached"}(o||(o={}))},46694:(e,t,n)=>{"use strict";n.d(t,{vc:()=>i,Bd:()=>a,d5:()=>o});const i={EmptyEvent:"EmptyEvent",NotEnabled:"NotEnabled",RequiredFieldMissing:"RequiredFieldMissing",SubscriptionFailed:"SubscriptionFailed",MethodNotAvailable:"showBadge not available on taskbar module.",ModuleUnableToLoad:"HostComms is unable to load taskbar module. We are running on Web or Teams 1.0. Bailing out."},a={ModuleLoaded:"HostComms has loaded taskbar module. Setting badge.",UpdatedEvent:"Updated Taskbar Badge Count:"},o="TaskbarService"},946286:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var i=n(231191),a=n(118824),o=n(46694);class r{constructor(e,t,n){this.coreSettings=t,this.hostCommunicationService=n,this.getBadge=e=>({icon:{countBadge:{value:e}}}),this.logger=e.newLogger(o.d5)}showBadge(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){if(!this.enableTaskbarBadgeMaglev)return void this.logger.log(o.vc.NotEnabled);const t=yield this.hostCommunicationService.loadModule("taskbar");if(t){if(t.showBadge)return this.logger.log(o.Bd.ModuleLoaded),t.showBadge(e);this.logger.log(o.vc.MethodNotAvailable)}else this.logger.error(o.vc.ModuleUnableToLoad)}))}showBadgeCount(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.showBadge(this.getBadge(e))}))}resetBadge(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return this.showBadgeCount(0)}))}get enableTaskbarBadgeMaglev(){return!!this.coreSettings.get(a.J.Core).enableTaskbarBadgeMaglev}}},599820:(e,t,n)=>{"use strict";n.d(t,{Em:()=>i,kz:()=>o,vi:()=>r,yw:()=>s,eI:()=>l,j7:()=>d,me:()=>c,vH:()=>u,Ju:()=>m,yR:()=>g,VD:()=>p,GF:()=>v,IC:()=>h,ex:()=>f,gh:()=>y,MX:()=>k,Q0:()=>S,Gq:()=>b,fh:()=>C,Sq:()=>w,LC:()=>N,CQ:()=>T});var i,a=n(604781);!function(e){e.getVoicemails="getVoicemails",e.getAttachments="getAttachments",e.markReadUnread="markReadUnread",e.deleteVoicemail="deleteVoicemail"}(i||(i={}));const o="voicemail-service",r="application/json",s="odata.metadata=none",l="odata.streaming=true",d="odata.metadata=minimal",c="IEEE754Compatible=false",u="charset=utf-8",m=(0,a.LQ)(`${r};${d};${l};${c};${u}`),g="x-serverrequestid",p="<MESSAGE_ID>",v="<GROUP_ID>",h="DeletedItems",f="https://outlook.office.com/",y="api/v2.0/",k="api/beta/",S=9e5,b="voicemails_refreshed",C=(0,a.LQ)("&$filter=SingleValueExtendedProperties/Any(ep: ep/PropertyId eq 'String 0x1a' and ep/Value eq 'IPM.Note.Microsoft.Voicemail.UM.CA')"),w=(0,a.LQ)("?$expand=SingleValueExtendedProperties($filter=PropertyId eq 'Integer {00020328-0000-0000-C000-000000000046} Id 0x6801' or PropertyId eq 'String {00020386-0000-0000-C000-000000000046} Name X-VoiceMessageConfidenceLevel' or PropertyId eq 'String {00020386-0000-0000-C000-000000000046} Name X-VoiceMessageTranscription')&$top=30&$select=From,Body,IsRead,Id,ReceivedDateTime,InternetMessageHeaders"),N=[{id:i.getVoicemails,path:"me/mailfolders/voicemail/messages"},{id:i.getAttachments,path:"me/messages/<MESSAGE_ID>/attachments"},{id:i.markReadUnread,path:"me/messages/<MESSAGE_ID>"},{id:i.deleteVoicemail,path:"me/messages/<MESSAGE_ID>/move"}],T=[{id:i.getVoicemails,path:"groups/<GROUP_ID>/messages"},{id:i.getAttachments,path:"groups/<GROUP_ID>/messages/<MESSAGE_ID>/attachments"},{id:i.markReadUnread,path:"groups/<GROUP_ID>/messages/<MESSAGE_ID>"},{id:i.deleteVoicemail,path:"groups/<GROUP_ID>/messages/<MESSAGE_ID>/move"}]},174195:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});class i{static get Instance(){return i._instance||(i._instance=new i),i._instance}constructor(){this.outstandingRequests=void 0,this.mostRecentRequest=void 0,this.requestsMapping=void 0,this.decimalPlaces=void 0,this.subscriber=void 0,this.decimalPlaces=3}processRequest(e,t,n){if(!this.subscriber)return;const{requests:i}=this.outstandingRequests;i.has(e)||i.set(e,{requestsByName:new Map});const{requestsByName:a}=i.get(e),o=a.get(t)||0;a.set(t,o+1),this.requestsMapping.set(n,{operationName:t,operationType:e}),this.notify()}processResponse(e,t){if(!this.subscriber||!this.requestsMapping.has(e))return;const{operationName:n,operationType:i}=this.requestsMapping.get(e);if("subscription"===i)return;this.requestsMapping.delete(e);const a=this.outstandingRequests&&this.outstandingRequests.requests;if(a.has(i)){const{requestsByName:e}=a.get(i);let t=e.get(n);1===t?e.delete(n):t>0&&e.set(n,--t)}const o={requestInfo:{operationName:n,operationType:i},responseTime:t&&parseFloat(t.toFixed(this.decimalPlaces))};this.mostRecentRequest=o,this.notify()}subscribe(e){this.subscriber=e,this.outstandingRequests={requests:new Map},this.requestsMapping=new Map}unsubscribe(){this.subscriber=void 0,this.outstandingRequests=void 0,this.requestsMapping=void 0}notify(){this.subscriber.processUpdate(this.outstandingRequests,this.mostRecentRequest)}}i._instance=void 0},412787:(e,t,n)=>{"use strict";n.d(t,{K:()=>s,g:()=>l});var i=n(231191),a=n(946234),o=n(84574),r=n(303851);const s=(e,t,n)=>s=>{const{discover:l,authenticationResources:c,platformService:u,config:m}=s,g=(0,r.h)(u,m),{headers:p}=t,v=(0,i.__rest)(t,["headers"]),h=Object.assign(Object.assign({},g),p);return{baseUrlPromise:()=>l.regionGtm(o.Pn.middleTier),serviceName:e,authResource:c.mtAuthResource,models:n((e=>{const t=Promise.resolve(Object.assign({constructRequest:(0,a.$)(e,h)},v));return d(t)}))}},l=(e,t,n)=>i=>{const o=e((0,a.$)(i,t),n);return d(o)},d=e=>{const t=Object.assign(e,{allow:n=>(e.then((e=>e.allowedResponses=n)),t),withCustomTelemetry:n=>(e.then((e=>e.customTelemetry=n)),t),withRetry:n=>(e.then((e=>e.retryPolicy=n)),t),withResponse:n=>(e.then((e=>e.responseType=n)),t),withTransform:n=>(e.then((e=>e.transformResponse=n)),t)});return t}},731793:(e,t,n)=>{"use strict";n.d(t,{LP:()=>c,kf:()=>m,Ji:()=>g});var i=n(978278),a=n(70404),o=n(119423);const r=new RegExp("media.*\\.giphy\\.com$","i"),s=new RegExp([".*\\.asm\\.skype\\.com$",".*\\.asyncgw\\.teams\\.microsoft\\.com$",".*\\.ams\\.gcc\\.teams\\.microsoft\\.com$",".*\\.ams\\.gov\\.teams\\.microsoft\\.us$",".*\\.ams\\.dod\\.teams\\.microsoft\\.us$",".*\\.asyncgw\\.teams\\.microsoft\\.scloud$",".*\\.asyncgw\\.teams\\.microsoftonline\\.cn$","\\urlp\\.sfbassets\\.com$","statics\\.gov\\.teams\\.microsoft\\.us$","statics\\.dod\\.teams\\.microsoft\\.us$","statics\\.teams\\.microsoft\\.com$","statics\\.teams\\.cdn\\.office\\.net$","staticsint\\.teams\\.cdn\\.office\\.net$","statics-dev\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.cdn\\.live\\.net$","staticsint\\.teams\\.cdn\\.live\\.net$","statics-dev\\.teams\\.cdn\\.live\\.net$","statics-cn\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.eaglex\\.ic\\.gov$","statics\\.teams\\.microsoft\\.scloud$","media.*\\.giphy\\.com$","local\\.teams\\.(?:office|live)\\.com$"].join("|"),"i"),l=new RegExp([".*\\logout*"].join("|"),"i"),d=/^\/asm\/[a-z]+/i,c=e=>`data:${u(e)};base64,${e}`,u=e=>{const t=(0,i.v)(e);let n;return n=255===t[0]&&216===t[1]?"image/jpg":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?"image/png":71===t[0]&&73===t[1]&&70===t[2]?"image/gif":66===t[0]&&77===t[1]?"image/bmp":"image/unknown",n},m=e=>(e=>{const t=(0,o.J)().location.origin;if((0,a.nz)(e,t))return!0;const n=(0,a.Lp)(e).toLowerCase(),i=(0,a.DW)(e).toLowerCase();return s.test(n)||"teams.microsoft.com"===n&&d.test(i)})(e)&&(e=>{const t=(0,a.DW)(e).toLowerCase();return!l.test(t)})(e)||e.startsWith("data:image"),g=e=>{const t=(0,a.Lp)(e).toLowerCase();return r.test(t)}},397754:(e,t,n)=>{"use strict";n.d(t,{hA:()=>d,w2:()=>c,KD:()=>u,$O:()=>g,jo:()=>p,Pg:()=>v,Q3:()=>h,fY:()=>f,DP:()=>y,Ky:()=>k,yf:()=>S});var i=n(231191),a=n(70404);const o="/v1/objects",r="/views/video",s=/^\/asm\/[a-z]+/i,l=/^\/asm\/[a-z]+\/v1\/objects/i;var d,c;function u(e){if(e&&g(e)){const t=new RegExp("/v1/objects/([\\w|\\-]+)","i"),n=e.match(t);return n&&n[1]||""}return""}function m(e){const t=(0,a.Lp)(e).toLowerCase(),n=(0,a.DW)(e);return t.endsWith("asm.skype.com")||"api.ams.gcc.teams.microsoft.com"===t||"api.ams.gov.teams.microsoft.us"===t||"api.ams.dod.teams.microsoft.us"===t||"api.asyncgw.teams.microsoft.scloud"===t||"api.asyncgw.teams.microsoftonline.cn"===t||t.endsWith("asyncgw.teams.microsoft.com")||"teams.microsoft.com"===t&&s.test(n)}function g(e){if(y(e))return!0;const t=(0,a.DW)(e);return m(e)&&(t.startsWith(o)||l.test(t))}function p(e){if(!e)return!1;const t=(0,a.DW)(e);return!(!y(e)||!t.endsWith(r))||m(e)&&t.endsWith(r)}function v(e){return p(e)?c.Video:g(e)?c.Image:c.None}function h(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=e instanceof Blob?new Uint8Array(yield null===(t=e.arrayBuffer)||void 0===t?void 0:t.call(e)):e;if(!n||n.length<6)return!1;if(71!==n[0]||73!==n[1]||70!==n[2])return function(e){if(!e)return!1;let t=-1,n=-1;for(let i=0;i<e.length-4;i++)if(97===e[i]&&99===e[i+1]&&84===e[i+2]&&76===e[i+3]&&(n=i),73===e[i]&&68===e[i+1]&&65===e[i+2]&&84===e[i+3]){t=i;break}return n>=0&&t>n}(n);let i=0;for(let e=0;e<n.length-9&&!(33===n[e]&&249===n[e+1]&&4===n[e+2]&&44===n[e+8]&&(i++,i>1));e++);return i>1}))}function f(e,t){if(!e||!g(e)||!t||e.startsWith(t))return e;return[t,new URL(e).pathname.substring(1)].join("")}function y(e){return(0,a.DW)(e).toLowerCase().startsWith("/ams/v1/objects")}function k(e){return e>20971520}function S(e){if(!e||"image/*"===e)return"";const t=e.match(/^image\/([^*]+)$/);return t?t[1]:e}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(d||(d={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(c||(c={}))},651459:(e,t,n)=>{"use strict";n.d(t,{E:()=>r,I:()=>i});var i,a=n(118824);class o{constructor(e,t){this.host=e,this.parentLeakDetector=t,this.trackedObjectsByKey={}}track(e,t){var n,i;(null===(n=this.host)||void 0===n?void 0:n.WeakRef)&&(this.trackedObjectsByKey[e]||(this.trackedObjectsByKey[e]=[]),null===(i=this.parentLeakDetector)||void 0===i||i.track(e,t),this.trackedObjectsByKey[e].push({weakReference:new this.host.WeakRef(t)}))}getLeaks(e){return this.cleanupReferencesOfType(e),this.trackedObjectsByKey[e]?this.trackedObjectsByKey[e].map((e=>e.weakReference.deref())):[]}getAllLeaks(){const e={};for(const t of Object.keys(this.trackedObjectsByKey)){const n=this.getLeaks(t);n.length>0&&(e[t]=n)}return e}cleanup(){for(const e of Object.keys(this.trackedObjectsByKey))this.cleanupReferencesOfType(e)}cleanupReferencesOfType(e){this.trackedObjectsByKey[e]&&(this.trackedObjectsByKey[e]=this.trackedObjectsByKey[e].filter((e=>void 0!==e.weakReference.deref())),0===this.trackedObjectsByKey[e].length&&delete this.trackedObjectsByKey[e])}}!function(e){e.UnwrappedWindow="unwrappedWindow",e.DataClient="dataClient",e.ApolloCache="apolloCache",e.ChatPaneContainer="ChatPaneContainer",e.CalendarMainSlotContentContainer="CalendarMainSlotContentContainer",e.CalendarRenderer="CalendarRenderer",e.CalendarSchedulingFormRenderer="CalendarSchedulingFormRenderer",e.ChannelPaneContainer="ChannelPaneContainer",e.ChannelRepliesPaneContainer="ChannelRepliesPaneContainer",e.GridViewContainer="GridViewContainer",e.SearchAllPaneContainer="SearchAllPaneContainer",e.SingleTeamViewContainer="SingleTeamViewContainer",e.PlatformAppViewsContainer="PlatformAppViewsContainer",e.ChannelListContainer="ChannelListContainer",e.ActivityFeedContainer="ActivityFeedContainer",e.ChatRailContainer="ChatRailContainer",e.CallMonitorPopout="CallMonitorPopout",e.CallsAppContainer="CallsAppContainer"}(i||(i={}));class r{constructor(e,t){this.coreSettings=e,this.host=t,this.leakDetectorReferences=[],this.leaksAggregator=new o(t)}create(){var e;if(!(null===(e=this.host)||void 0===e?void 0:e.WeakRef))return;const t=new o(this.host,this.leaksAggregator),n=new this.host.WeakRef(t);return this.leakDetectorReferences.push(n),this.cleanup(),t}getReachableObjects(e){this.cleanup();const t=this.leaksAggregator.getLeaks(e);return new Set(t)}getReachableObjectsByKey(){this.cleanup();const e={},t=this.leaksAggregator.getAllLeaks();for(const n of Object.keys(t))e[n]=new Set(t[n]);return e}getReachableObjectCountsByKey(){const e={},t=this.getReachableObjectsByKey();for(const n of Object.keys(t))e[n]=t[n].size;return e}getReachableObjectsTrackingInfo(){this.cleanup();const e={};return this.addWindowLeakInfo(e),this.addApolloCacheLeakInfo(e),e}cleanup(){this.leaksAggregator.cleanup(),this.leakDetectorReferences=this.leakDetectorReferences.filter((e=>void 0!==e.deref())),this.leakDetectorReferences.forEach((e=>{var t;null===(t=e.deref())||void 0===t||t.cleanup()}))}getTelemetry(){var e,t,n,o,r,s,l,d,c,u,m,g,p,v,h;const{enableOLDStats:f}=this.coreSettings.get(a.J.Core),y=f&&this.getReachableObjectCountsByKey();if(y)return{ChatPaneContainer:null!==(e=y[i.ChatPaneContainer])&&void 0!==e?e:0,ChannelPaneContainer:null!==(t=y[i.ChannelPaneContainer])&&void 0!==t?t:0,ChannelRepliesPaneContainer:null!==(n=y[i.ChannelRepliesPaneContainer])&&void 0!==n?n:0,CalendarMainSlotContentContainer:null!==(o=y[i.CalendarMainSlotContentContainer])&&void 0!==o?o:0,CalendarRenderer:null!==(r=y[i.CalendarRenderer])&&void 0!==r?r:0,CalendarSchedulingFormRenderer:null!==(s=y[i.CalendarSchedulingFormRenderer])&&void 0!==s?s:0,GridViewContainer:null!==(l=y[i.GridViewContainer])&&void 0!==l?l:0,SearchAllPaneContainer:null!==(d=y[i.SearchAllPaneContainer])&&void 0!==d?d:0,SingleTeamViewContainer:null!==(c=y[i.SingleTeamViewContainer])&&void 0!==c?c:0,PlatformAppViewsContainer:null!==(u=y[i.PlatformAppViewsContainer])&&void 0!==u?u:0,ChannelListContainer:null!==(m=y[i.ChannelListContainer])&&void 0!==m?m:0,ActivityFeedContainer:null!==(g=y[i.ActivityFeedContainer])&&void 0!==g?g:0,ChatRailContainer:null!==(p=y[i.ChatRailContainer])&&void 0!==p?p:0,CallMonitorPopout:null!==(v=y[i.CallMonitorPopout])&&void 0!==v?v:0,CallsAppContainer:null!==(h=y[i.CallsAppContainer])&&void 0!==h?h:0}}addApolloCacheLeakInfo(e){const t=this.leaksAggregator.getLeaks(i.ApolloCache).map((e=>e.apolloLeakInfo));t.length>0&&(e[i.ApolloCache]=t)}addWindowLeakInfo(e){const t=this.leaksAggregator.getLeaks(i.UnwrappedWindow).map((e=>e.windowLeakInfo));t.length>0&&(e[i.UnwrappedWindow]=t)}}},119423:(e,t,n)=>{"use strict";n.d(t,{J:()=>a,l:()=>o});var i=n(493093);function a(){return i.n.getInstance().window}function o(e,...t){const n=window.electronSafeIpc;n&&n.send(e,...t)}},415637:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});const i={type:"safelinks",safelinksAtpMT:{type:"safelinksmt",getUrlReputationRestEndpoint:"beta/atpsafelinks/geturlreputationrest/",getpolicyEndpoint:"beta/atpsafelinks/getpolicy/",RESOURCE_KEY:"https://dataservice.o365filtering.com"},telemetry:{getPolicy:"atp_get_policy",getUrlReputation:"atp_get_url_reputation"},policyKey:"atp-safelinks-policy"}},987947:(e,t,n)=>{"use strict";n.d(t,{c:()=>u});var i=n(231191),a=n(118824),o=n(661564),r=n(893088),s=n(628235),l=n(415637),d=n(913469),c=n(988306);class u{constructor(e,t,n,i,a,o){this.send=e,this.authenticationService=t,this.coreSettings=n,this.scenarioFactory=i,this.localStorage=o,this.handleGetATPAuthToken=()=>this.authenticationService.acquireToken(l.V.safelinksAtpMT.RESOURCE_KEY),this.logger=a.newLogger("AtpSafelinksService")}initPolicy(){const e=this.scenarioFactory.newScenario(s.RG.ATPGetPolicyTask);this.getPolicy().then((()=>e.stop())).catch((t=>{const n=`Error getting ATP Safelinks policy: ${t.message||""}`;this.logger.error(n),e.fail({errors:n})}))}getPolicy(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){return null!==(e=this.getPolicyFromLocalStore())&&void 0!==e?e:this.getPolicyFromRemote()}))}getUrlReputationRestMT(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const{enabledATPSafelinks:n}=this.coreSettings.get(a.J.Messaging);if(!n||!this._isAtpSafelinksSubscriptionEnabled())return this.logger.log("enabledATPSafelinks false"),{status:o.qb.OK,url:t};try{const n=yield this.handleGetATPAuthToken(),i=yield this._post(l.V.safelinksAtpMT.getUrlReputationRestEndpoint,this._getRequestBody(t,n),this._getHeaders(e));this.logger.log("getUrlReputationRestMT started");const a=yield i.body.json();return{url:t,status:i.status,data:a&&a.isATPSafelinksEnabled?a:{isATPSafelinksEnabled:!1}}}catch(e){return this.logger.error(`AtpSafelinks MT API failed with Error: ${e&&e.message}`),{url:t,status:-1}}}))}getPolicyFromLocalStore(){let e=null;try{const t=this.localStorage.get(l.V.policyKey);if(t){const n=JSON.parse(t);(0,c.z)(n.cookie,n.webAffinitizedUrl)?e=n:this.logger.error("Invalid policy found from localStorage")}}catch(e){this.logger.error(`Error while getting ATP safelinks policy from localStorage: ${e}`)}return e}getPolicyFromRemote(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let e=null;const t=this.scenarioFactory.newScenario(s.RG.ATPGetPolicy);try{const n=yield this._get(l.V.safelinksAtpMT.getpolicyEndpoint),i=yield n.body.json();this.localStorage&&this.localStorage.setSafe(l.V.policyKey,JSON.stringify(i));const a=`getPolicy status: ${n.status}`;this.logger.debug(a),t.stop({reason:a}),e=i}catch(e){this.logger.error(`AtpSafelinks GetPolicy API failed with Error: ${e&&e.message}`),t.fail({errors:`${l.V.telemetry.getPolicy}_failed`})}return e}))}_getRequestBody(e,t){return{urlList:[e],atptoken:t}}_getHeaders(e){const t={"content-type":"application/json"};return e&&(this._addHeader(e.user,"X-sourceUser",t),this._addHeader(e.id,"X-sourceId",t),this._addHeader(e.detail,"X-sourceDetail",t)),t}_addHeader(e,t,n){n[t]=e}_post(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(0,d.B)(this.send,o.qb.OK)({url:e,method:"POST",body:JSON.stringify(t),headers:n,serviceName:r.EJ.MiddleTier,apiName:"safelink"})}))}_get(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return(0,d.B)(this.send,o.qb.OK)({url:e,method:"GET",serviceName:r.EJ.MiddleTier,apiName:"safelink"})}))}_isAtpSafelinksSubscriptionEnabled(){const{licenseSettings:e}=this.coreSettings.get(a.J.UserResources);return!(!e||!e.isAtpSafelinksEnabled)}}},648062:(e,t,n)=>{"use strict";n.d(t,{aw:()=>i,ZU:()=>a,Fz:()=>o,l6:()=>r,$N:()=>s,yc:()=>l,DT:()=>d,SM:()=>c,nQ:()=>u,wK:()=>m,IY:()=>g,rz:()=>p,ru:()=>v,op:()=>h,ej:()=>f,Hw:()=>y,QN:()=>S,gX:()=>b,ex:()=>w,s9:()=>N,uI:()=>T,rF:()=>I,zP:()=>E,GA:()=>A,f:()=>_,kI:()=>D,j:()=>F,Tv:()=>M,$l:()=>R});const i="TflFreProfileCardDisplayed",a="LogoutState",o="authSessionId",r="tmp.previous.silent.signin",s="in-progress",l={nopa:"2"},d={coa:"1"},c={AuthProviderLoadError:"AuthProviderLoadError",ErrorGetUserWhenAnonNotSupported:"ErrorGetUserWhenAnonNotSupported",UserNotLicensed:"Forbidden",InitFailure:"Core-auth init failure",InteractionRequired:"InteractionRequired",InvalidScopeResource:"invalid_scope",MultipleUsersPresentWithSpecifiedIdentifier:"MultipleUsersPresentWithSpecifiedIdentifier",NativeAuthModuleNotPresent:"NativeAuthModuleNotPresent",NoAccountFound:"NoAccountFound",RemoteOperationFailed:"RemoteOperationFailed",SignInRestrictions:"SignInRestrictions",SsoFirstAccountFailed:"SsoFirstAccountFailed",TenantUnredeemed:"TenantUnredeemed",ErrorCodeMissingForTenantLogin:"ErrorCodeMissingForTenantLogin",UserNotAuthenticated:"UserNotAuthenticated",UserNotFoundError:"User not found",LoginRequired:"login_required",ConsentRequired:"consent_required",PopUpWindowError:"popup_window_error",EmptyResponse:"EmptyResponse",InvalidResponse:"InvalidResponse",InvalidToken:"InvalidToken",UnsupportedParameter:"UnsupportedParameter",UserAuthNotAvailable:"UserAuthNotAvailable",MissingRequiredFields:"MissingRequiredFields",CannotUpdateCurrentAccount:"CannotUpdateCurrentAccount",FallbackWithSkypeToken:"FallbackWithSkypeToken"},u={NoLicense:403},m={NoNetwork:"NoNetwork",ApiContractViolation:"ApiContractViolation",UiAlreadyShowing:"Cannot sign in when UI is showing"},g="InteractionRequiredAuthError",p="skype-token",v="discover-user-details",h="discover-region-gtm";var f,y;!function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.SIGNIN_RESTRICTIONS_KEY="SignInRestrictions",e.AUTHZ_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.IC3_GATEWAY_CAE_KEY="https://ic3.teams.office.com",e.IC3_GATEWAY_AAD_KEY="https://ic3-non-cae.teams.office.com"}(f||(f={})),function(e){e.openId="openId",e.profile="profile"}(y||(y={}));let k=["[auth][authserviceBack][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","aborted","A silent sign-in request was sent but none of the currently signed in user(s) match the requested login hint","Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","Cannot start retry fetch of ADAL tokens, isPassive: false","Cancelling all retries due to: orchestration authenticationService_offline","Cancelling all retries due to: Relogin succeeded. Need to refresh tokens","Due to current app state cannot start retry fetch of ADAL tokens","noAccessForResource","resourceRequiresConsent","resourceDisabled","Seamless single sign on failed for the user. This can happen if the user is unable to access on premises AD or intranet zone is not configured correctly","tokenRevoked","tpmError","Webclient Auth request reached maximum timeout - 60000.","popup_window_error"];const S=e=>(e&&(k=[...k,...e]),k),b=()=>k;let C=[];const w=e=>(e&&(C=[...C,...e]),C),N=e=>C.includes(e);var T,I;!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.TWENTYFOUR=24]="TWENTYFOUR",e[e.THIRTY=30]="THIRTY"}(T||(T={})),function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.SECONDS_FIVE_MINUTES=300]="SECONDS_FIVE_MINUTES",e[e.ONE_HOUR=36e5]="ONE_HOUR",e[e.ONE_DAY=864e5]="ONE_DAY"}(I||(I={}));const E="9188040d-6c67-4c5b-b112-36a304b66dad",A="wids",_="74ebf54e-8a4c-453c-a5ea-3ff41b70afe6",D="X-MS-Migration",F=(T.TWO,I.MILLI_PER_SECOND,I.SECONDS_PER_MINUTE,{SKYPE_REQUEST:"skype_request_start",SKYPE_REQUEST_STOP:"skype_request_stop",SKYPE_SEND_REQUEST:"skype_send_request_start",SKYPE_SEND_REQUEST_STOP:"skype_send_request_stop",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim"}),M={MTO:"MTO"},R={TENANTSV2:"/beta/users/tenantsv2"}},798703:(e,t,n)=>{"use strict";n.d(t,{K:()=>a,b:()=>o});var i=n(69226);function a(e){var t;const{oid:n,tid:a,puid:o}=e.profile,r=n||`8:defaultOid:${a}`;return{cloud:e.cloud||i.G7.prod,profile:{objectId:r,tenantId:a,puid:o||null},id:null!==(t=e.id)&&void 0!==t?t:n,isAuthenticated:e.isAuthenticated&&!0,role:e.role||i.w4.Member,type:e.type||i.Ch.Aad,subType:e.subType||i.Yf.Default,loginUserName:e.userName||null,homeAccountId:e.homeAccountId}}function o(e){return e.id}},372304:(e,t,n)=>{"use strict";n.d(t,{Tr:()=>a,MD:()=>o,Yf:()=>r,ZG:()=>s});var i=n(648062);function a(e){const t=new Error(e.message);return Object.assign(t,{context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}function o(e){const t=new Error(e.message);return Object.assign(t,{authSubErrorCode:e.authSubErrorCode,errorMetaData:e.errorMetaData,context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}function r(e){return(0,i.gX)().indexOf(e)>=0}function s(e){return e&&(e.isExpected||r(e.errorCode)||!!(t=e.message)&&(0,i.gX)().map((e=>t.indexOf(e)>=0)).filter(Boolean).length>0);var t}},759207:(e,t,n)=>{"use strict";n.d(t,{lw:()=>a,iV:()=>o,G5:()=>r,o3:()=>s,gI:()=>l,Dk:()=>d,gZ:()=>c});const i="__",a=e=>e.split(i)[0],o=e=>e.split(i)[1],r=e=>e.split(i)[2],s=e=>e.split(i)[3],l=e=>e.split(i)[4],d=(e,t,n)=>{let i=t.replace("{broadcastId}",e);return n&&(i+=`?isanonymous=true&tenantId=${a(e)}`),i},c=e=>{if(e){const t=e.stream,n=null==t?void 0:t.wamsStreamingUrl,i=!!(null==t?void 0:t.decryptionToken),a=e.altStream,o=null==a?void 0:a.wamsStreamingUrl,r=!!(null==a?void 0:a.decryptionToken);return!!(n&&i||o&&r)}return!1}},505889:(e,t,n)=>{"use strict";n.d(t,{Kz:()=>a,uO:()=>o,aE:()=>r,eA:()=>s,h5:()=>l,vf:()=>d});var i=n(892891);const a=e=>{const t=decodeURIComponent(e),n=new RegExp("context=(.*)$","g").exec(t);if(!n||n.length<2)throw new Error(`Meeting context is not in valid format ${t}`);const i=JSON.parse(n[1]);if(!i||!i.Tid||!i.Oid)throw new Error("Meeting url is malformed Tid or Oid is missing");return{tenantId:i.Tid,organizerId:i.Oid}},o=e=>{var t,n,i,a;try{return new URL(e).hostname}catch(o){return(null===(a=null===(i=null===(n=null===(t=e.split("/"))||void 0===t?void 0:t[2])||void 0===n?void 0:n.split("@"))||void 0===i?void 0:i.pop())||void 0===a?void 0:a.split(":").shift())||""}},r=e=>{let t=!1;if(e&&e.skypeTeamsDataObj){t=1===e.skypeTeamsDataObj.type}return t};function s(e){return!(!e||!e.skypeTeamsDataObj||(0,i.isEmpty)(e.skypeTeamsDataObj))&&!1===e.skypeTeamsDataObj.private}const l=e=>{var t;return!!(null===(t=e.webinarRegistration)||void 0===t?void 0:t.webinarId)},d=e=>{var t;return!!(null===(t=e.virtualEventsData)||void 0===t?void 0:t.eventId)}},303493:(e,t,n)=>{"use strict";n.d(t,{wr:()=>o,W5:()=>g,sM:()=>p,ae:()=>v,g0:()=>h,ZC:()=>f,ZD:()=>y});var i=n(395816),a=n(410061);const o={publicCommercialCloud:"teams.microsoft.com",gccHighCloud:"gov.teams.microsoft.us",dodCloud:"dod.teams.microsoft.us",ag08Cloud:"https://teams.eaglex.ic.gov",ag09Cloud:"https://teams.microsoft.scloud",dev:"local.teams.office.com",devLive:"local.teams.live.com",liveCloud:"teams.live.com"},r=/^(\s|\/)+|(\s|\/)+$/g,s=4,l=2,d="meetup-join",c=2,u=1,m="meet",g=e=>({coordinates:{meetingData:{instantMeetingOptions:void 0,isAdhoc:!0}},joinOptions:{outgoingVideo:!0,outgoingAudio:!0,context:"WatchParty",meeting:{deeplinkId:e,isWatchParty:!0,showPrejoin:!0}},type:i.GXC.Meeting}),p=(e,t)=>{let n;if((0,a.N6)(e)){const{conversationId:t,messageId:i,rootMessageId:a,isChannel:o,isAdhoc:r,tenantId:s,organizerId:l,meetingCloud:d,registration:c}=e;n={legacyMeeting:{conversationId:t,messageId:i,rootMessageId:a,isChannel:o,isAdhoc:r,tenantId:s,organizerId:l,meetingCloud:d,registration:c,broadcast:null==e?void 0:e.broadcast}}}else{const{meetingCode:t,passcode:i,meetingUrl:a}=e.meetingData;n={meetingData:{meetingCode:t,passcode:i,meetingUrl:a}}}return{coordinates:n,joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:"DeepLink",meeting:{deeplinkId:t,showPrejoin:!0,isPSTN:!1}},type:i.GXC.Meeting}},v=(e,t)=>[o.dev,o.publicCommercialCloud].includes(t)?[o.devLive,o.liveCloud].includes(e):!![o.devLive,o.liveCloud].includes(t)&&[o.dev,o.publicCommercialCloud].includes(e),h=e=>e===o.publicCommercialCloud,f=(e,t,n)=>{let i,a;try{i=new URL(e).hostname,a=n&&((e,t)=>{let n;try{n=new URL(e)}catch(e){return!1}const i=n.pathname.replace(r,"").split("/"),a=n.hostname;return!!(i.length===s&&i[1]===d&&i[l]||i.length===c&&i[0]===m&&i[u])&&v(a,t)})(t,i)}catch(e){a=!1}return a},y=e=>{let t;try{t=new URL(e)}catch(e){return!1}const n=t.pathname.replace(r,"").split("/");return n.length===s&&n[1]===d&&!!n[l]}},410061:(e,t,n)=>{"use strict";n.d(t,{N6:()=>s,aW:()=>l,xz:()=>c,r1:()=>u,R0:()=>m,Yy:()=>g});var i=n(892891),a=n(395816),o=n(118824),r=n(791439);const s=e=>!e||e.joinType!==a.cku.MeetingData,l=({user:e,coreSettings:t})=>{var n,i;return(0,r.n2)(e)?Boolean(null===(n=t.get(o.J.Calling))||void 0===n?void 0:n.enableImprovedFreemiumExperience):Boolean(null===(i=t.get(o.J.Calling))||void 0===i?void 0:i.enableMeetNowShareInvite)},d=(e,t)=>{const{enableInstantMeeting:n}=e.get(o.J.Calendar),{enableMeetNowInLandingPage:i,enableMeetNowInChatList:a}=e.get(o.J.Calling);switch(t){case"calendar":case"calendarMigration":return Boolean(n);case"chatList":return Boolean(a);case"landingPage":return Boolean(i);default:return!1}},c=(e,t,n)=>{const{allowMeetNowPolicy:i,allowPrivateMeetNowPolicy:a}=e.get(o.J.Calling);return n?Boolean(d(e,t)&&a):Boolean(d(e,t)&&i)},u=e=>{const{deepLinkDomain:t,deepLinkPath:n}=e.get(o.J.Calling);return t&&n?t+n:""},m=(e,t,n)=>{var i,a;const r=Boolean(null===(i=t.get(o.J.Calling))||void 0===i?void 0:i.enableShareMeetCode),s=Boolean(null===(a=t.get(o.J.Calling))||void 0===a?void 0:a.allowOnlyMeetCodeLink),l=g(t,n);return r&&l?l:s?null:e},g=(e,t)=>!t||(0,i.isEmpty)(t)?"":t.meetingUrl?t.meetingUrl:`${u(e)}${t.meetingCode}`},791439:(e,t,n)=>{"use strict";n.d(t,{n2:()=>o,L5:()=>r});var i=n(118824),a=n(107844);const o=e=>{var t;return(null===(t=null==e?void 0:e.tenant)||void 0===t?void 0:t.type)===a.OV.Freemium},r=({user:e,coreSettings:t})=>(e=>{var t;return Boolean(null===(t=e.get(i.J.Calling))||void 0===t?void 0:t.enableImprovedFreemiumExperience)})(t)&&o(e)},881933:(e,t,n)=>{"use strict";var i,a,o;n.d(t,{Eh:()=>i,kI:()=>a,RM:()=>o}),function(e){e.Attendee="attendee",e.Presenter="presenter",e.Organizer="organizer"}(i||(i={})),function(e){e.Interactive="interactive",e.NonInteractive="nonInteractive"}(a||(a={})),function(e){e.DeeplinkNonoffice="DeeplinkNonoffice",e.DeeplinkOffice="DeeplinkOffice",e.DeeplinkFileChiclet="DeeplinkFileChiclet",e.MeetingSidepanel="MeetingSidepanel",e.DocCollab="DocCollab",e.Annotation="Annotation"}(o||(o={}))},410313:(e,t,n)=>{"use strict";n.d(t,{NI:()=>o,gU:()=>l});var i=n(892891);const a="</at>",o=e=>{var t;const n=null!==(t=e.msTeams)&&void 0!==t?t:e.msteams;if(!n||!(0,i.isObject)(n)||!n.entities)return;let a;try{a=r(n.entities)}catch(e){return}return a},r=e=>{const t=new Map;let n=0;return e.forEach((e=>{e.type&&"mention"===e.type&&!c(e.text)&&e.mentioned&&!c(e.mentioned.id)&&s(e.text)&&!t.has(e.text)&&t.set(e.text,{itemId:(n++).toString(),mentionType:"person",displayName:e.mentioned.name,userId:e.mentioned.id,id:`${e.mentioned.id}|person`})})),t},s=e=>{const t=e.toLowerCase(),n=0===t.lastIndexOf("<at>"),i=t.indexOf(a)===t.length-a.length;return n&&i},l=(e,t,n)=>{d(e,t,n)},d=(e,t,n)=>{(0,i.forEach)(e,((a,o)=>{(0,i.isEqual)(t,{[o]:a})&&n(e),a instanceof Array?(0,i.forEach)(a,(e=>{d(e,t,n)})):(0,i.isObject)(a)&&d(a,t,n)}))},c=e=>!e||!e.trim()},596805:(e,t,n)=>{"use strict";n.d(t,{lq:()=>o,hY:()=>r,bE:()=>s,s0:()=>l,oh:()=>d,gu:()=>c,JY:()=>u});var i=n(642115),a=n(281857);const o="announcement-card",r="application/vnd.microsoft.teams.messaging-announcementBanner",s=878,l=244,d=(e=[])=>{const t=e.findIndex((e=>e.contentType===r));return{announcementCard:e[t],announcementCardIndex:t}},c=e=>{const{announcementCard:t}=d(e);if(t)try{return JSON.parse(t.content)}catch(e){throw(0,i.Tr)("PostComposeHelpers",a.jK.Undefined,"getAnnouncementCardContentFromDraft::JsonParseError")}},u=e=>{var t,n,i,a,o,r,s,l,d,u,m;const g=c((null===(t=null==e?void 0:e.computed)||void 0===t?void 0:t.cards)||[]);return{title:(null==e?void 0:e.title)||"",colorTheme:(null==g?void 0:g.colorTheme)||null,originalImageUrl:(null===(i=null===(n=null==g?void 0:g.imageData)||void 0===n?void 0:n.origImage)||void 0===i?void 0:i.src)||null,croppedImageUrl:(null===(o=null===(a=null==g?void 0:g.imageData)||void 0===a?void 0:a.croppedImage)||void 0===o?void 0:o.src)||null,croppedImageHeight:(null===(s=null===(r=null==g?void 0:g.imageData)||void 0===r?void 0:r.croppedImage)||void 0===s?void 0:s.imageHeight)||null,croppedImageWidth:(null===(d=null===(l=null==g?void 0:g.imageData)||void 0===l?void 0:l.croppedImage)||void 0===d?void 0:d.imageWidth)||null,croppedImageAltText:(null===(m=null===(u=null==g?void 0:g.imageData)||void 0===u?void 0:u.croppedImage)||void 0===m?void 0:m.imageAltText)||null,isTeamsIllustration:null}}},255044:(e,t,n)=>{"use strict";n.d(t,{q:()=>d});var i=n(395816),a=n(907207),o=n(870209),r=n(129350),s=n(378720),l=n(628235);const d=(e,t,n,d,c,u)=>{const m=c;switch(null==t?void 0:t.postType){case i.hQF.Guardians:return l.RG.GuardiansSendAnnouncement}const g=(null==d?void 0:d.length)===a.Uy,p=null==d?void 0:d.some((e=>(0,o.Nl)(e))),v=null==d?void 0:d.some((e=>(0,o.ug)(e))),h=n||"",f=!m&&g&&p&&!(0,r.Bl)(h),y=m&&g&&v;switch(e){case i.xyM.Create:return(0,s.Jn)(h)?l.RG.P2PSendNewMessageSfB:(0,r.Bl)(h)?l.RG.P2PSendNewMessageSfC:(0,r.As)(h)?l.RG.P2PSendNewMessageFederated:u?l.RG.P2PSendNewMessageNativeFederated:f?l.RG.P2PSendNewMessageTfl:y?l.RG.P2PSendNewMessageTfw:(null==t?void 0:t.crossPostChannels)&&(null==t?void 0:t.crossPostChannels.length)>1?l.RG.CrossPostSendMessage:l.RG.ChatSendMessage;case i.xyM.Update:return(null==t?void 0:t.crossPostChannels)&&(null==t?void 0:t.crossPostChannels.length)>1?l.RG.CrossPostEditMessage:l.RG.EditMessage}return l.RG.ChatSendMessage}},539841:(e,t,n)=>{"use strict";function i(e,t,n){e.splice(function(e,t,n){let i=0,a=e.length;const o=n(t);for(;i<a;){const t=Math.floor((i+a)/2);o<n(e[t])?a=t:i=t+1}return i}(e,t,n),0,t)}n.d(t,{M:()=>i})},220496:(e,t,n)=>{"use strict";n.d(t,{Hk:()=>o,Rd:()=>r,By:()=>s});var i=n(231191);function a(e,t){if(!e.startsWith("blob"))return Promise.reject("invalid blob url");const n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType=t,new Promise(((e,t)=>{n.onload=()=>{200===n.status&&n.response?e(n.response):t(200!==n.status?{status:n.status,statusText:n.statusText}:{status:404,statusText:"no response data"})},n.send()}))}function o(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return yield a(e,"blob")}))}function r(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=yield a(e,"arraybuffer");return new Uint8Array(t)}))}function s(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return e.then((e=>URL.createObjectURL(e)))}))}},978278:(e,t,n)=>{"use strict";function i(e){if(!e)return new Uint8Array(0);return a(e.split(",")[1])}function a(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}n.d(t,{H:()=>i,v:()=>a})},640568:(e,t,n)=>{"use strict";n.d(t,{cN:()=>i,BC:()=>a,df:()=>o,yX:()=>r,YM:()=>s,cS:()=>l});class i{constructor(e,t,n){this.maxDelay=e,this.initialDelay=t,this.calculate=n,this.errCount=0}get errorCount(){return this.errCount}next(){return Math.min(this.maxDelay,this.calculate(this.initialDelay,++this.errCount))}reset(){this.errCount=0}}class a extends i{constructor(e,t){super(e,t,((e,t)=>Math.pow(e,t)))}}class o extends i{constructor(e,t,n){super(n,e,((e,n)=>e*Math.pow(t,n-1)))}}class r extends i{constructor(e){super(e,e,(()=>e))}}class s extends i{constructor(e){super(e,e,(()=>Math.floor(Math.random()*e)))}}class l extends i{constructor(e,t){super(t,e,((e,t)=>{const n=Math.random()*Math.pow(2,t-1);return Math.floor((.5*Math.pow(4,t-1)+n)*e)}))}}},604781:(e,t,n)=>{"use strict";n.d(t,{Uw:()=>a,XC:()=>o,ZT:()=>r,LQ:()=>l,u4:()=>d});var i=n(892891);function a(e,t,n){return e=s(e,t,n=n||o),1===t.length&&"object"==typeof t[0]&&(e=s(e,t[0],n)),e}function o(e){if(null===e)return"null";if(void 0===e)return"undefined";const t=typeof e;if("string"===t)return e;if("number"===t||"boolean"===t)return String(e);if("function"===t)return"";if((0,i.isDate)(e))return e.toISOString();try{return JSON.stringify(e)}catch(t){return d(e)}}function r(e,t){if(!t){const t=e;return t.message||t.name||`${t}`}return o(e)}function s(e,t,n){for(const i in t)t.hasOwnProperty(i)&&(e=e.replace(`{${i}}`,n(t[i])));return l(e)}function l(e){return null==e||0===e.length?e:` ${e}`.substr(1)}function d(e,t){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!n.has(t)){if(t&&"object"==typeof t){if(n.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}},776118:(e,t,n)=>{"use strict";n.d(t,{Ni:()=>a,CB:()=>c,Qn:()=>u,fC:()=>m,bs:()=>g});const i="((?:(?:(?:(?:ht|f)tp(?:s?)):\\/\\/(?:www\\.)?)|(?:www\\.))(?:\\S+)",a=`${i}(?:[^,\\s]))`,o=`${i}(?:[^\\s]))`,r=new RegExp(`^${a}$`,"i"),s=new RegExp(`^${o}$`,"i"),l=new RegExp(a,"i"),d=new RegExp("^(?:(?:ht|f)tp(?:s?)):\\/\\/[\\S| ]+$","i"),c=e=>r.test(e),u=e=>s.test(e),m=e=>l.test(e),g=e=>d.test(e)},933740:(e,t,n)=>{"use strict";n.d(t,{iU:()=>i,fh:()=>a,Mr:()=>o});const i=e=>{const t=e.getComputedStyle(e.document.documentElement).fontSize||"10px";return parseFloat(t)},a=(e,t)=>i(e)*t,o=(e,t)=>t/i(e)},825998:(e,t,n)=>{"use strict";function i(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}n.d(t,{is:()=>i,V:()=>a});const a=(e,t)=>!!i(e,t)||null!=e&&null!=t&&(Array.isArray(e)&&Array.isArray(t)?r(e,t):e instanceof Set&&t instanceof Set?o(e,t):s(e,t)),o=(e,t)=>{if(e.size!==t.size)return!1;if(0===e.size)return!0;const n=e.values();let i=n.next();do{if(!t.has(i.value))return!1;i=n.next()}while(!i.done);return!0},r=(e,t)=>{if(e.length!==t.length)return!1;for(let n=e.length-1;n>=0;n--)if(!i(e[n],t[n]))return!1;return!0},s=(e,t)=>{const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const a of n)if(!i(e[a],t[a]))return!1;return!0}},659387:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var i=n(118824),a=n(384560);const o=(e,t)=>{let n=!1;const{storagePartitionSettings:o}=e.get(i.J.Core);if(o){const{enableStoragePartition:e,minimumEdgeBrowserVersion:i}=o;if(e&&i){let e;const{userAgent:o}=t.config,r=o.indexOf("Edg/");if(r>-1){e=o.substring(r+4);const t=e.indexOf(" ");e=e.substring(0,t),n=!!(0,a.compare)(e,i,">=")}}}return n}},70404:(e,t,n)=>{"use strict";n.d(t,{y4:()=>o,N0:()=>r,Lp:()=>s,DW:()=>l,Nm:()=>c,_K:()=>u,ZN:()=>m,nz:()=>g,pZ:()=>p,kU:()=>v,xl:()=>h,IC:()=>f,eb:()=>y,m:()=>k});var i=n(892891),a=n(776118);function o(e,t,n,i){try{return t(new URL(n,i))}catch(t){return e}}function r(e){const t=new URL(e);return t.protocol+"//"+t.host}function s(e){return d(e)}function l(e){return d(e,!0)}function d(e,t=!1){let n=e.indexOf("://");n=n<=0?0:n+"://".length;const a=e.indexOf(":",n),o=e.indexOf("/",n),r=e.indexOf("?",n),s=[o,r,a,e.length],l=Math.min.apply(Math,(0,i.without)(s,-1));if(!t)return e.slice(n,l).toLowerCase();let d=l;if(a===l){const t=[o,r,e.length];d=Math.min.apply(Math,(0,i.without)(t,-1))}return e.slice(d).toLowerCase()}function c(e,t){if(!e)return"";if(e.startsWith("/"))return e;const n=e.indexOf(":");if(n<=0)return"";const i=(e=(e=(e=(e=e.replace(/(\')/g,"%27")).replace(/(\")/g,"%22")).replace(/{/g,"%7B")).replace(/}/g,"%7D")).substring(0,n).toLowerCase();for(const n of t)if(i===n)return e;return"http"===i?`https${e.substring(n)}`:""}function u(e,t){if(!t)return t;const n=new RegExp(`[?&]${e}=([^&#]*)`).exec(t);return n&&n.length>1?decodeURI(n[1]):""}function m(e,t,n){if(!e||!t||e.match(new RegExp(`[?&]${t}=`)))return e;const i=`${e.indexOf("?")>=0?"&":"?"}${t}=${n}`;if(-1!==e.indexOf("#")){const t=e.split("#");return`${t[0]}${i}#${t[1]}`}return`${e}${i}`}const g=(e,t)=>new RegExp(`^(blob:)(${t})`,"i").test(e),p=e=>/^(data:)/i.test(e),v=e=>/^(http)(s?):\/\//i.test(e);function h(e,t){if(!e||!t)return e;const n=e.indexOf("?");if(n<0)return e;let a=e.indexOf("#");a<0&&(a=e.length);const o=e.substring(a),r=e.substring(0,n),s=e.substring(n+1,a),l=`${encodeURIComponent(t)}=`,d=s.split(/[&;]/g);return(0,i.forEachRight)(d,((e,t)=>{-1!==e.lastIndexOf(l,0)&&d.splice(t,1)})),`${r}${d.length>0?`?${d.join("&")}`:""}${o}`}function f(e){if(!e)return e;return e.indexOf("#")>=0?e.substring(0,e.indexOf("#")):e}function y(e){return(0,a.bs)(e)?e:`https://${e}`}const k=e=>(e.endsWith("/")||(e+="/"),e)},632822:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});const i={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,zero:48,a:65,c:67,v:68,command:91,contextMenu:93,number0:48,number9:57,numpad0:96,numpad9:105,numpadAdd:107,numpadSubtract:109,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,equal:187,hyphen:189,forwardslash:191}},75565:(e,t,n)=>{"use strict";var i,a,o,r,s,l;n.d(t,{NR:()=>i,Q2:()=>a,f8:()=>o,Qs:()=>r,ci:()=>s,s0:()=>l}),function(e){e.Windows="windows",e.Mac="mac",e.Linux="linux",e.ChromeOS="chromeos",e.Android="android",e.IOS="ios",e.WindowsPhone="windowsphone",e.Unknown="unknown"}(i||(i={})),function(e){e.Default="default",e.DefaultV2="defaultV2",e.DefaultTfl="tfl-default",e.Dark="dark",e.DarkV2="darkV2",e.DarkTfl="tfl-dark",e.HighContrast="contrast"}(a||(a={})),function(e){e.Dark="dark",e.Light="light",e.Contrast="contrast"}(o||(o={})),function(e){e.Light="0",e.Dark="1",e.Contrast="2",e.DefaultV2="3",e.DarkV2="4",e.DefaultTfl="5",e.DarkTfl="6"}(r||(r={})),function(e){e.HighContrast="#FFFFFF_#000000_#FFFF00"}(s||(s={})),function(e){e.ColorContrastOverride="(forced-colors: active)",e.Light="(prefers-color-scheme: light)",e.Dark="(prefers-color-scheme: dark)"}(l||(l={}))},455304:(e,t,n)=>{"use strict";n.d(t,{A_:()=>i,kg:()=>a,Xg:()=>o,Z_:()=>r,Yr:()=>s,JJ:()=>l,NO:()=>d,Ix:()=>c,Yx:()=>u,F8:()=>m,vx:()=>g,Zd:()=>p,ee:()=>v,bS:()=>h,vj:()=>f,tL:()=>y,qc:()=>k,eO:()=>S,mr:()=>b,dn:()=>C,CK:()=>w,iW:()=>N,m$:()=>T});const i=6e4,a=1e3,o=60,r=1440,s=3600,l=60,d=1e3,c=24,u=7,m=12,g="h:mm a",p=864e5,v=36e5,h=6e4,f=new Date(0).toISOString(),y=300;var k,S,b,C,w,N;!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(k||(k={})),function(e){e.Sunday="sunday",e.Monday="monday",e.Tuesday="tuesday",e.Wednesday="wednesday",e.Thursday="thursday",e.Friday="friday",e.Saturday="saturday"}(S||(S={})),function(e){e.January="January",e.Febuary="February",e.March="March",e.April="April",e.May="May",e.June="June",e.July="July",e.August="August",e.September="September",e.October="October",e.November="November",e.December="December"}(b||(b={})),function(e){e.Day="day",e.Week="week",e.Month="month",e.Year="year"}(C||(C={})),function(e){e.First="first",e.Second="second",e.Third="third",e.Fourth="fourth",e.Last="last"}(w||(w={})),function(e){e.Sunday="sunday",e.Monday="monday",e.Tuesday="tuesday",e.Wednesday="wednesday",e.Thursday="thursday",e.Friday="friday",e.Saturday="saturday"}(N||(N={}));const T={[b.January]:1,[b.Febuary]:2,[b.March]:3,[b.April]:4,[b.May]:5,[b.June]:6,[b.July]:7,[b.August]:8,[b.September]:9,[b.October]:10,[b.November]:11,[b.December]:12}},465759:(e,t,n)=>{"use strict";n.d(t,{J:()=>a,L:()=>o});var i=n(455304);const a=e=>{const t=/^P.*T(?:([.,\d]+)H)?(?:([.,\d]+)M)?(?:([.,\d]+)S)?/.exec(e);function n(e){return t&&t[e]?Number(t[e].replace(",",".")):0}return n(3)+n(2)*i.JJ+n(1)*i.Yr},o=e=>{const t=e<0;e=Math.abs(e);const n=Math.floor(e/i.Yr),a=Math.floor((e-n*i.Yr)/i.JJ),o=e-n*i.Yr-a*i.JJ;return`${t?"-":""}${r(n,":",!0)}${r(a,":")}${r(o)}`},r=(e,t="",n=!1)=>0===e&&n?"":e<10?`0${e}${t}`:`${e}${t}`},180599:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});const i=e=>e instanceof Date&&!isNaN(e.getTime())},136497:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});var i=n(118824);function a(e,t,n=!1){const{deepLinkDomains:a,deepLinkPaths:o,supportHashDeeplinks:r}=t.get(i.J.Messaging);return l({url:e,deepLinkDomains:a||[],deepLinkPaths:n?[""]:o||[],supportHashDeeplinks:!!r,coreSettings:t})}const o=(e,t)=>{const{enableOriginValidationForIncomingIntents:n}=t.get(i.J.Core);if(!n||"null"!==e.origin)return e.origin;const a=e.searchParams.get("fqdn");return a?new URL(`https://${a}`).origin:void 0},r=(e,t,n,i)=>{const a=o(e,i);return!(a&&a!==t.origin||!e.pathname.startsWith(n))},s=(e,t,n)=>!(o(e,n)&&o(e,n)!==t.origin||!e.hash||"/_"!==e.pathname),l=({url:e,deepLinkDomains:t,deepLinkPaths:n,supportHashDeeplinks:i,coreSettings:a})=>{for(const o of t)for(const t of n){let n,l;try{n=new URL(e),l=new URL(t,o)}catch(e){return!1}if(r(n,l,t,a))return!0;if(i&&s(n,l,a))return!0}return!1}},153909:(e,t,n)=>{"use strict";n.d(t,{E6:()=>r,xn:()=>s,Q6:()=>l,tE:()=>c});var i=n(231191),a=n(281857),o=n(642115);const r=e=>{if(!e)return null;const{graphQLErrors:t}=e;return t&&t.length>0&&t[0]&&t[0].originalError?(0,o.Jn)(t[0].originalError,a.w5.Apollo,a.jK.ApolloError,"getOriginalError",{status:t[0].originalError.code}):null},s=e=>{var t,n;const i=null===(n=null===(t=e.graphQLErrors)||void 0===t?void 0:t[0])||void 0===n?void 0:n.extensions;return i?i.prevError&&"UNKNOWN"===i.code?(0,o.Jn)(new Error(e.graphQLErrors[0].message),i.prevError.context,i.prevError.code,i.prevError.subContext,i.prevError.reason):(0,o.Jn)(new Error(e.graphQLErrors[0].message),i.context,i.code,i.subContext,i.reason):null},l=e=>{const t=d(e);return!(!(0,o.Wc)(t)&&!(0,o.K3)(t.reason,t.context))},d=e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.graphQLErrors[0])||void 0===t?void 0:t.extensions)||void 0===n?void 0:n.prevError},c=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){if(!e)return null;let t=null;const{graphQLErrors:n,networkError:r}=e;var s;return r&&(t=u(r)),!t&&n&&n.length>0&&n[0].originalError&&(t=yield(s=n[0],(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var e,t,n;let i=null;try{if(i=s.originalError,!(null===(e=null==i?void 0:i.serverResponse)||void 0===e?void 0:e.body))return i;const a=null===(t=null==i?void 0:i.serverResponse)||void 0===t?void 0:t.status,o=yield null===(n=null==i?void 0:i.serverResponse)||void 0===n?void 0:n.body.json();if(!v(o))return i;i.reason={status:a,errorCode:o.errorCode,errorSubCode:o.errorSubCode}}catch(e){}return i})))),t||(t=n&&n.length>0&&n[0]&&n[0].originalError?(0,o.Jn)(n[0].originalError,a.w5.Apollo,a.jK.ApolloError,"getOriginalError",{status:n[0].originalError.code}):null),t})),u=e=>{let t=null;try{const n=JSON.parse(e.message);if(n){const i=JSON.parse(n.message);if(i){const n=JSON.parse(i.reason);n&&(t=Object.assign(Object.assign({},e),{reason:{status:p(n)?n.status:void 0,errorCode:v(n)?n.errorCode:void 0}}))}}}catch(n){t=m(e)}return t},m=e=>{var t;if(!e.serverResponse)return null;const n=Object.assign({},null==e?void 0:e.reason);return(0,o.Tr)(e.context,e.code,e.subContext?e.subContext:"",Object.assign({status:e.serverResponse.status,errorCode:null!==(t=n.errorCode)&&void 0!==t?t:void 0,reason:e.reason},n),e.message,e.serverResponse)},g=e=>"number"==typeof e,p=e=>!!e&&void 0!==e.status&&g(e.status),v=e=>!!e&&void 0!==e.errorCode&&g(e.errorCode)},642115:(e,t,n)=>{"use strict";n.d(t,{o7:()=>r,zg:()=>s,Tr:()=>l,Jn:()=>d,dK:()=>c,O$:()=>u,B9:()=>m,VK:()=>g,qZ:()=>p,Wc:()=>v,K3:()=>h,cm:()=>k,_S:()=>N,tJ:()=>T});var i=n(892891),a=n(281857),o=n(467757);function r(e,t=[]){return e>=500&&e<600&&-1===t.indexOf(e)}function s(e){return a.lX.get(e)||a.jK.Unknown}function l(e,t,n,i,a=`${e}::${n}::${t}`,o,r,s){const l=new Error(a);return Object.assign(l,{context:e,subContext:n,reason:i,code:t,serverResponse:o,isExpected:r,errorCode:s})}function d(e,t,n,i,a,o,r){const s=l(t,n,i,a,o,r);return s.reason=s.reason||{},s.reason.innerError=e,s}function c(e,t,n,a,o){return!(!(t||n||a||o)||!e)&&((void 0===t||e.context===t)&&(void 0===n||e.code===n)&&(void 0===a||!!e.reason&&(0,i.every)(a,((t,n)=>{const a=(null==e?void 0:e.reason)?e.reason[n]:null;return Array.isArray(t)?t.some((e=>(0,i.isEqual)(e,a))):(0,i.isEqual)(t,a)})))&&(void 0===o||e.subContext===o))}function u(e,t,n){return e&&e.reason&&void 0!==e.reason[t]?e.reason[t]:n}function m(e){return e&&e.message?e.message:e}function g(e,t=!0){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,y(f(t)))}catch(e){return"Stringifying error failed"}}function p(e){return e&&e.code?e.code:a.jK.Unknown}function v(e){var t,n,i,a,o,r;return!!((null==e?void 0:e.isExpected)||(null===(i=null===(n=null===(t=null==e?void 0:e.reason)||void 0===t?void 0:t.innerError)||void 0===n?void 0:n.response)||void 0===i?void 0:i.isExpected)||(null===(a=null==e?void 0:e.innerException)||void 0===a?void 0:a.isExpected)||(null===(r=null===(o=null==e?void 0:e.innerException)||void 0===o?void 0:o.reason)||void 0===r?void 0:r.isExpected))}function h(e,t){return e===o.A.RejectHttpError||t===o.A.RejectHttpError}const f=(e=!1)=>(t,n)=>n instanceof Error?Object.assign({name:n.name,message:n.message,stack:e?[]:("string"==typeof n.stack?n.stack:"").split("\n").map((e=>e.trim())).filter((e=>!!e))},n):n,y=e=>{const t=new WeakSet;return(n,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return e(n,i)}},k=()=>y(f()),S=new RegExp('("[^"]*[.]((doc[x]?)|(xls[x]?)|(ppt[x]?)|(pdf))[^"]*")',"g"),b=new RegExp("\\b[a-zA-Z0-9.!#$%&'*+\\/?^_`{|}~-]+(@|_(A|a)(T|t)_|%40)(?!(T|t)(H|h)(R|r)(E|e)(A|a)(D|d).(V|v)2)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*","g"),C=new RegExp("=+[a-zA-Z0-9.!#$%&'*+\\/?^_`{|}~-]+(@|_(A|a)(T|t)_|%40)(?!(T|t)(H|h)(R|r)(E|e)(A|a)(D|d).(V|v)2)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*","g"),w={file:S,email:b,ssn:new RegExp("(\\d{3}[-]\\d{2}[-]\\d{4})","g"),creditCard:new RegExp("(\\d{4}\\s\\d{4}\\s\\d{4}\\s\\d{4})","g")},N=e=>{if((0,i.isNil)(e)||!(0,i.isString)(e))return e;let t=e;return(0,i.keys)(w).forEach((e=>{t=t.replace(w[e],`${e}-euii`)})),t},T=e=>{if((0,i.isNil)(e)||!(0,i.isString)(e))return e;let t=e;return t=t.replace(C,"=email-euii"),t}},988306:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i=(e,t)=>{if(e&&t){const t=/^(.*); expires=(.*); path=\/$/,n=2,i=e.match(t);if(i){return new Date(i[n]).getTime()>Date.now()}}return!1}},695276:(e,t,n)=>{"use strict";n.d(t,{Fd:()=>r,s3:()=>l,HC:()=>d,wm:()=>c,LY:()=>u,Bj:()=>m});var i=n(892891),a=n(760083),o=n(907207);function r(e,t){try{const n=s(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,i.uniqBy)(t,(e=>e.toLowerCase()))){let t="";const i=e.split(".");for(let e=0;e<i.length;e++)t+=(e>0?"[.]":"")+i[e].replace("*","[^/^.]+");const a=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(n.match(a))return!0}}catch(e){return!1}return!1}const s=e=>new URL(e).href,l=(e,t)=>{let n="";if(!e.id||c(e.id))return n;switch(e.type){case a.p.extensions:try{n=JSON.parse(e.id).threadId}catch(t){n=e.id}break;case a.p.chats:n=e.id.replace("replyChainId","messageid");break;case a.p.communities:case a.p.channels:let i;try{i=JSON.parse(e.id).channelId}catch(t){i=e.id}n=t?`${i};messageid=${t}`:i;break;case a.p.shareformdialog:break;default:n=e.id}return n},d=e=>e&&e.replace(new RegExp(`^${o.at.BotPrefix}`),""),c=e=>"newchat"===e||(null==e?void 0:e.includes("preview")),u=(e,t=o.Cs.Call)=>t===o.Cs.Call&&/<partlist/.test(e)&&!m(e,t),m=(e,t=o.Cs.Call)=>t===o.Cs.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},179471:(e,t,n)=>{"use strict";n.d(t,{X:()=>i,si:()=>o,D:()=>r});const i="other";var a;function o(e){return!!a[e]}function r(){return Object.keys(a).filter((e=>isNaN(Number(e))))}!function(e){e[e["3mf"]=0]="3mf",e[e.cool=1]="cool",e[e.glb=2]="glb",e[e.gltf=3]="gltf",e[e.obj=4]="obj",e[e.stl=5]="stl",e[e.movie=6]="movie",e[e.pages=7]="pages",e[e.pict=8]="pict",e[e.sketch=9]="sketch",e[e.ai=10]="ai",e[e.pdf=11]="pdf",e[e.psb=12]="psb",e[e.psd=13]="psd",e[e["3g2"]=14]="3g2",e[e["3gp"]=15]="3gp",e[e.asf=16]="asf",e[e.bmp=17]="bmp",e[e.hevc=18]="hevc",e[e.m2ts=19]="m2ts",e[e.m4v=20]="m4v",e[e.mov=21]="mov",e[e.mp3=22]="mp3",e[e.mp4=23]="mp4",e[e.mp4v=24]="mp4v",e[e.mts=25]="mts",e[e.ts=26]="ts",e[e.wmv=27]="wmv",e[e.dwg=28]="dwg",e[e.fbx=29]="fbx",e[e.erf=30]="erf",e[e.zip=31]="zip",e[e["7z"]=32]="7z",e[e.z=33]="z",e[e.dcm=34]="dcm",e[e.dcm30=35]="dcm30",e[e.dicm=36]="dicm",e[e.dicom=37]="dicom",e[e.ply=38]="ply",e[e.hcp=39]="hcp",e[e.gif=40]="gif",e[e.heic=41]="heic",e[e.heif=42]="heif",e[e.jpeg=43]="jpeg",e[e.jpg=44]="jpg",e[e.jpe=45]="jpe",e[e.mef=46]="mef",e[e.mrw=47]="mrw",e[e.nef=48]="nef",e[e.nrw=49]="nrw",e[e.orf=50]="orf",e[e.pano=51]="pano",e[e.pef=52]="pef",e[e.png=53]="png",e[e.rw2=54]="rw2",e[e.spm=55]="spm",e[e.tif=56]="tif",e[e.tiff=57]="tiff",e[e.xbm=58]="xbm",e[e.xcf=59]="xcf",e[e.key=60]="key",e[e.csv=61]="csv",e[e.dic=62]="dic",e[e.doc=63]="doc",e[e.docm=64]="docm",e[e.docx=65]="docx",e[e.dot=66]="dot",e[e.dotm=67]="dotm",e[e.dotx=68]="dotx",e[e.pot=69]="pot",e[e.potm=70]="potm",e[e.potx=71]="potx",e[e.pps=72]="pps",e[e.ppsm=73]="ppsm",e[e.ppsx=74]="ppsx",e[e.ppt=75]="ppt",e[e.pptm=76]="pptm",e[e.pptx=77]="pptx",e[e.xd=78]="xd",e[e.xls=79]="xls",e[e.xlsb=80]="xlsb",e[e.xlsm=81]="xlsm",e[e.xlsx=82]="xlsx",e[e.sltx=83]="sltx",e[e.eml=84]="eml",e[e.msg=85]="msg",e[e.vsd=86]="vsd",e[e.vsdx=87]="vsdx",e[e.cur=88]="cur",e[e.ico=89]="ico",e[e.icon=90]="icon",e[e.epub=91]="epub",e[e.odp=92]="odp",e[e.ods=93]="ods",e[e.odt=94]="odt",e[e.arw=95]="arw",e[e.cr2=96]="cr2",e[e.crw=97]="crw",e[e.dng=98]="dng",e[e.rtf=99]="rtf",e[e.abap=100]="abap",e[e.ada=101]="ada",e[e.adp=102]="adp",e[e.ahk=103]="ahk",e[e.as=104]="as",e[e.as3=105]="as3",e[e.asc=106]="asc",e[e.ascx=107]="ascx",e[e.asm=108]="asm",e[e.asp=109]="asp",e[e.awk=110]="awk",e[e.bas=111]="bas",e[e.bash=112]="bash",e[e.bash_login=113]="bash_login",e[e.bash_logout=114]="bash_logout",e[e.bash_profile=115]="bash_profile",e[e.bashrc=116]="bashrc",e[e.bat=117]="bat",e[e.bib=118]="bib",e[e.bsh=119]="bsh",e[e.build=120]="build",e[e.builder=121]="builder",e[e.c=122]="c",e[e.capfile=123]="capfile",e[e.cbk=124]="cbk",e[e.cc=125]="cc",e[e.cfc=126]="cfc",e[e.cfm=127]="cfm",e[e.cfml=128]="cfml",e[e.cl=129]="cl",e[e.clj=130]="clj",e[e.cmake=131]="cmake",e[e.cmd=132]="cmd",e[e.coffee=133]="coffee",e[e.cpp=134]="cpp",e[e.cpt=135]="cpt",e[e.cpy=136]="cpy",e[e.cs=137]="cs",e[e.cshtml=138]="cshtml",e[e.cson=139]="cson",e[e.csproj=140]="csproj",e[e.css=141]="css",e[e.ctp=142]="ctp",e[e.cxx=143]="cxx",e[e.d=144]="d",e[e.ddl=145]="ddl",e[e.dif=146]="dif",e[e.diff=147]="diff",e[e.disco=148]="disco",e[e.dml=149]="dml",e[e.dtd=150]="dtd",e[e.dtml=151]="dtml",e[e.el=152]="el",e[e.emake=153]="emake",e[e.erb=154]="erb",e[e.erl=155]="erl",e[e.f90=156]="f90",e[e.f95=157]="f95",e[e.fluid=158]="fluid",e[e.fs=159]="fs",e[e.fsi=160]="fsi",e[e.fsscript=161]="fsscript",e[e.fsx=162]="fsx",e[e.gemfile=163]="gemfile",e[e.gemspec=164]="gemspec",e[e.gitconfig=165]="gitconfig",e[e.go=166]="go",e[e.groovy=167]="groovy",e[e.gvy=168]="gvy",e[e.h=169]="h",e[e.haml=170]="haml",e[e.handlebars=171]="handlebars",e[e.hbs=172]="hbs",e[e.hrl=173]="hrl",e[e.hs=174]="hs",e[e.htc=175]="htc",e[e.hxx=176]="hxx",e[e.idl=177]="idl",e[e.iim=178]="iim",e[e.inc=179]="inc",e[e.inf=180]="inf",e[e.ini=181]="ini",e[e.inl=182]="inl",e[e.ipp=183]="ipp",e[e.ipynb=184]="ipynb",e[e.irbrc=185]="irbrc",e[e.jade=186]="jade",e[e.jav=187]="jav",e[e.java=188]="java",e[e.jfif=189]="jfif",e[e.js=190]="js",e[e.json=191]="json",e[e.jsp=192]="jsp",e[e.jsx=193]="jsx",e[e.l=194]="l",e[e.less=195]="less",e[e.lhs=196]="lhs",e[e.lisp=197]="lisp",e[e.log=198]="log",e[e.lst=199]="lst",e[e.ltx=200]="ltx",e[e.lua=201]="lua",e[e.m=202]="m",e[e.make=203]="make",e[e.markdn=204]="markdn",e[e.mdown=205]="mdown",e[e.mkdn=206]="mkdn",e[e.ml=207]="ml",e[e.mli=208]="mli",e[e.mll=209]="mll",e[e.mly=210]="mly",e[e.mm=211]="mm",e[e.mud=212]="mud",e[e.nfo=213]="nfo",e[e.opml=214]="opml",e[e.osascript=215]="osascript",e[e.out=216]="out",e[e.p=217]="p",e[e.pas=218]="pas",e[e.patch=219]="patch",e[e.php=220]="php",e[e.php2=221]="php2",e[e.php3=222]="php3",e[e.php4=223]="php4",e[e.php5=224]="php5",e[e.pl=225]="pl",e[e.plist=226]="plist",e[e.pm=227]="pm",e[e.pod=228]="pod",e[e.pp=229]="pp",e[e.profile=230]="profile",e[e.properties=231]="properties",e[e.ps=232]="ps",e[e.ps1=233]="ps1",e[e.pt=234]="pt",e[e.py=235]="py",e[e.pyw=236]="pyw",e[e.r=237]="r",e[e.rake=238]="rake",e[e.rb=239]="rb",e[e.rbx=240]="rbx",e[e.rc=241]="rc",e[e.re=242]="re",e[e.readme=243]="readme",e[e.reg=244]="reg",e[e.rest=245]="rest",e[e.resw=246]="resw",e[e.resx=247]="resx",e[e.rhtml=248]="rhtml",e[e.rjs=249]="rjs",e[e.rprofile=250]="rprofile",e[e.rpy=251]="rpy",e[e.rss=252]="rss",e[e.rst=253]="rst",e[e.rxml=254]="rxml",e[e.s=255]="s",e[e.sass=256]="sass",e[e.scala=257]="scala",e[e.scm=258]="scm",e[e.sconscript=259]="sconscript",e[e.sconstruct=260]="sconstruct",e[e.script=261]="script",e[e.scss=262]="scss",e[e.sgml=263]="sgml",e[e.sh=264]="sh",e[e.shtml=265]="shtml",e[e.sml=266]="sml",e[e.sql=267]="sql",e[e.sty=268]="sty",e[e.tcl=269]="tcl",e[e.tex=270]="tex",e[e.text=271]="text",e[e.textile=272]="textile",e[e.tld=273]="tld",e[e.tli=274]="tli",e[e.tmpl=275]="tmpl",e[e.tpl=276]="tpl",e[e.txt=277]="txt",e[e.vb=278]="vb",e[e.vi=279]="vi",e[e.vim=280]="vim",e[e.wsdl=281]="wsdl",e[e.xaml=282]="xaml",e[e.xhtml=283]="xhtml",e[e.xoml=284]="xoml",e[e.xml=285]="xml",e[e.xsd=286]="xsd",e[e.xsl=287]="xsl",e[e.xslt=288]="xslt",e[e.yaml=289]="yaml",e[e.yaws=290]="yaws",e[e.yml=291]="yml",e[e.zsh=292]="zsh",e[e.htm=293]="htm",e[e.html=294]="html",e[e.markdown=295]="markdown",e[e.md=296]="md",e[e.url=297]="url",e[e.one=298]="one",e[e.note=299]="note"}(a||(a={}))},870003:(e,t,n)=>{"use strict";n.d(t,{le:()=>i,bx:()=>a,Np:()=>o,V_:()=>r,Ie:()=>s,Q4:()=>l});const i={filePickerSource:{upload_from_pc:"upload_from_pc",share_from_odb:{key:"share_from_odb",sourceName:"OneDrive",icon:"fluent-onedrive"}},telemetry:{errorCodes:{messageSentBeforeSyncLinkConversion:"MessageAlreadySent",asyncLinkConversionPretransformFailure:"PretransformRuntimeError",asyncLinkMultiplePretransform:"MultiplePretransform",fileSharingErrorBoundaryError:"FileSharingErrorBoundaryError",asyncImportFailed:"AsyncImportFailed",pickerLocaleLoadFailed:"PickerLocaleLoadFailed",itemsViewStringsNotPresentInWindow:"ItemsViewStringsNotPresentInWindow",siteInfoError:"SiteInfoError"},errors:{messageSentBeforeLinkConversion:"message_sent_before_link_conversion"},markers:{auth_token_call_start:"auth_token_call_start",auth_token_received:"auth_token_received",auth_token_empty:"auth_token_empty",auth_token_requested_with_claims_challenge:"auth_token_requested_with_claims_challenge",super_picker_initialisation_auth_token_start:"super_picker_initialisation_auth_token_start",super_picker_initialisation_auth_token_received:"super_picker_initialisation_auth_token_received",super_picker_render_auth_token_start:"super_picker_render_auth_token_start",super_picker_render_auth_token_end:"super_picker_render_auth_token_end",super_picker_render_third_party_providers:"super_picker_render_third_party_providers",render_third_party_providers_start:"render_third_party_providers_start",render_third_party_providers_end:"render_third_party_providers_end",render_third_party_provider_content_start:"render_third_party_provider_content_start",render_third_party_provider_with_provider_type:"render_third_party_provider_with_provider_type",render_third_party_provider_content_end:"render_third_party_provider_content_end",super_picker_render_auth_token_failed:"super_picker_render_auth_token_failed",auth_token_call_failed:"auth_token_call_failed",claims_challenge_auth_token_call_start:"claims_challenge_auth_token_call_start",claims_challenge_auth_token_received:"claims_challenge_auth_token_received",claims_challenge_auth_token_failed:"claims_challenge_auth_token_failed",claims_challenge_auth_token_empty:"claims_challenge_auth_token_empty",site_info_call_started:"site_info_call_started",site_info_data_received:"site_info_data_received",async_bundle_import_start:"async_bundle_import_start",async_bundle_import_complete:"async_bundle_import_complete",picker_locale_load_start:"locale_load_start",picker_locale_retry:"picker_locale_retry",picker_locale_load_end:"picker_locale_load_end",items_view_strings_loaded_on_host:"items_view_strings_loaded_on_host",items_view_strings_loaded_on_parent:"items_view_strings_loaded_on_parent"},reasons:{auth_token_call_failed:"auth_token_call_failed",personal_site_info_query_failed:"personal_site_info_query_failed",personal_site_info_query_empty:"personal_site_info_query_empty",invalid_site_info_data:"invalid_site_info_data",async_bundle_import_fail:"async_bundle_import_fail",picker_locale_load_fail:"picker_locale_load_fail",error_loading_component_package:"error_loading_component_package"}},localeRetries:1,asyncLinkToChicletConversionIdentifier:"unprocessed-filelink",odsp2013IllegalCharsRegex:/[~"#%&*:<>?/\\{|}\r?\n\r]/g,odspM365IllegalCharsRegex:/["*:<>?/\\|\r?\n\r]/g,odspIllegalWordRegex:/_vti_/gi,odspUnsupportedFilenameList:["con","prn","aux","nul","com0","com1","com2","com3","com4","com5","com6","com7","com8","com9","lpt0","lpt1","lpt2","lpt3","lpt4","lpt5","lpt6","lpt7","lpt8","lpt9"],odspUnsupportedFilenameWithExtList:[".lock","desktop.ini"]};var a,o;!function(e){e.Treatment="TEAMS-TREATMENT",e.Control="TEAMS-CONTROL"}(a||(a={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(o||(o={}));const r="Teams";var s,l;!function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB"}(s||(s={})),function(e){e.ODPicker="ODPicker",e.SharePointLink="SharePointLink",e.Slimpicker="Slimpicker",e.Superpicker="Superpicker"}(l||(l={}))},366785:(e,t,n)=>{"use strict";n.d(t,{gD:()=>u,fM:()=>m});var i=n(282457),a=n(86945);const o=new RegExp(a.yH.oneNoteTargetRegex),r=new RegExp(a.yH.oneNoteSectionRegex),s=e=>{const t=o.exec(e);let n="";return t&&(n=t[1]),n},l=e=>{const t=r.exec(e);let n="";return t&&(n=t[1]),n},d=new RegExp(a.yH.oneDriveFile),c=new RegExp(a.yH.sharePointFile),u=(e,t,n)=>{const o=(0,i.Q)(e),r=o?o.replace(a.yH.trailingSlashRegex,""):"";let s=null;if(d.test(e)){s={sourceTeamName:a.HV.personal,sourceChannelName:r.split("/").pop()}}else if(c.test(e)){const t=r.split("/").pop()||"",n=2;s={sourceTeamName:decodeURIComponent(t),sourceChannelName:decodeURIComponent(e.substring(r.length-1).split("/")[n])}}if(t===a.BY.extension&&-1!==(null==n?void 0:n.indexOf(a.BY.extensionWithDot))){const e=p(n);(null==e?void 0:e.sectionGroup)&&s&&(s.sourceChannelName=`${s.sourceChannelName} > ${e.sectionGroup}`),(null==e?void 0:e.section)&&s&&(s.sourceChannelName=`${s.sourceChannelName} > ${e.section}`)}return s},m=(e,t)=>{let n=null;const i=decodeURIComponent(e);let a=s(i),o=l(a),r="";if(o.includes("/")){const e=o.lastIndexOf("/");a=a.substring(e+1),o=o.substring(e+1)}o=g(o);const d=t;t=o;const c=a.indexOf("/");if(-1!==c){const e=a.lastIndexOf("|");let n=a.substring(c+1,e);n=g(n),t=n,r=o}return n={title:t,noteBook:d,section:r},n},g=e=>e.replace(/(?:\\(.))/g,"$1"),p=e=>{let t=null,n="",i="",a="";e&&(n=decodeURIComponent(e));let o=s(n),r=l(o);if(r.includes("/")){const e=r.lastIndexOf("/");if(a=r.substring(0,e),a){const e=a.split("/");let t="";e.forEach((e=>{t=""===t?e:`${t} > ${e}`})),a=t}o=o.substring(e+1),r=r.substring(e+1)}return-1!==o.indexOf("/")&&(i=r),t={sectionGroup:g(a),section:g(i)},t}},282457:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var i=n(86945);const a=new RegExp(i.yH.oneDriveFile),o=new RegExp(i.yH.sharePointFile),r=(e,t)=>{if(t){const n=t.replace(i.yH.leadingAndTrailingSlashesRegex,"").split("/");n.pop();const a=n.join("/");return`${new URL(e).origin}/${a}/`}if(o.test(e)){const t=e.match(o);return t?t[0]:null}if(a.test(e)){const t=e.match(a);return t?t[0]:null}return e}},20645:(e,t,n)=>{"use strict";n.d(t,{K3:()=>o,W$:()=>r,mD:()=>s,f_:()=>l});var i=n(892891),a=n(870003);const o=e=>{if(e){if(-1===e.indexOf("."))return e;{const t=/(.+)\.[^.]+$/.exec(e);if(null==t)return e;{const e=t[1];return void 0!==e?e:""}}}return""},r=e=>{const t=/\ \(([1-9]\d*)\)$/g;let n=1,i=o(e);const a=t.exec(i);if(a){const e=i.search(t);n=parseInt(a[1],10)+1,i=i.substring(0,e)}return`${i} (${n}).${s(e)}`},s=e=>{const t=new RegExp("(?:\\.([^.]+))?$").exec(e);return(0,i.toLower)(t&&t[1]?t[1]:"")},l=(e,t=-1,n=!0)=>{let i=o(e),a=e.substr(i.length);if(i=m(n,u(i)),a=m(n,u(a)),i&&t>-1&&(i=i.substr(0,t)),d(i))return;const r=a?`${i}${a}`:i;return c(r)?void 0:r},d=e=>!e||a.le.odspUnsupportedFilenameList.includes(e.toLowerCase()),c=e=>!e||a.le.odspUnsupportedFilenameWithExtList.includes(e.toLowerCase()),u=e=>e.replace(a.le.odspIllegalWordRegex,"vti"),m=(e,t)=>t.replace(e?a.le.odsp2013IllegalCharsRegex:a.le.odspM365IllegalCharsRegex,"").trim()},86945:(e,t,n)=>{"use strict";n.d(t,{as:()=>i,Ho:()=>a,HV:()=>o,Hr:()=>r,yH:()=>s,v$:()=>l,wg:()=>d,BY:()=>c,Y_:()=>u,Bx:()=>m,MI:()=>g,Aq:()=>p,N0:()=>v,BS:()=>h,Fk:()=>f,Z2:()=>y,Z$:()=>k,ov:()=>S,Mc:()=>b,p5:()=>C,xK:()=>w,_v:()=>N,JJ:()=>T});const i={url:{getDriveItemAndPermissions:"/_api/v2.0/shares/{shareID}",fetchShareInfo:"/_api/v2.0/shares/{shareID}/driveItem",getDriveItemWithId:"/_api/v2.0/sites/root/items/{fileId}/driveItem",defaultPermissionsWithFileId:"/_api/v2.0/sites/root/items/{fileID}/driveItem/commands",getLinkPermissions:"/_api/v2.0/shares/{shareID}/permission",fetchVideoInfoWithThumbnails:"/_api/v2.0/shares/{shareID}/driveItem?$expand=thumbnails",createLinkWithId:"/_api/v2.1/sites/root/items/{id}/driveItem/createLink",createLinkWithShareId:"/_api/v2.1/shares/{shareId}/driveItem/createLink",getSharingInformation:"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid",getSharingInformationByUrl:"_api/web/GetFileByUrl(@a1)/ListItemAllFields/GetSharingInformation?@a1="}},a={THREAD_ID_UPDATE_URL:"beta/teams/recent/files/backfillSpoIds?threadId={channelThreadId}",THREAD_ID_UPDATE_APINAME:"backfillSpoIds"},o={personal:"personal",teams:"teams"},r={bim:"bim",mw:"mw",ns:"ns"},s={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${o.personal}/[^/]*/`,sharePointFile:`.*/(${o.teams}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\\/\:\*\?\"\<\>\|\#\%\t]*$/},l={personal:"personal",sharePoint:"share-point"},d={states:{active:"active",deleted:"deleted",reference:"reference",removed:"removed"}},c={type:"oneNote",extension:"one",extensionWithDot:".one"},u={openInTeams:"OpenFileInTeamsViewer",editInTeams:"EditInTeams",openInOfficeOnline:"OpenInOfficeOnline",openInOfficeClient:"OpenInOfficeClient"},m={clientError:-1,ok:200,badRequest:400,unauthorizedAccess:401,forbidden:403,notFound:404,notAcceptable:406,conflict:409,locked:423,tooManyRequests:429,internalServerError:500,serviceUnavailable:503,notModified:304},g={uploadCancelled:"UPLOAD_CANCELLED",conflicted:"-2130575257",conflicted_v2:"-2147024816",conflicted_v3:"nameAlreadyExists",folderDoesNotExist:"-2147024893",locked:"-2147018894",spQuotaReached:"-2147023080",quotaLimitReached:"quotaLimitReached",fileNotFound:"-2130575338",itemNotFound:"itemNotFound",fileAccessDenied:"FileAccessDenied",sessionInProgress:"-2130575142",unauthorizedAccessException:"-2147024891",cobaltException:"-1, Cobalt.ErrorException",resourceLockedException:"-2147018887",audienceUriValidationFailedException:"Microsoft.IdentityModel.Tokens.AudienceUriValidationFailedException",unauthenticated:"unauthenticated",invalidAudienceUri:"invalidAudienceUri",siteRenameFailure:"-2147024809",notAllowed:"notAllowed",resourceLocked:"resourceLocked"};var p,v,h,f;!function(e){e.filePropertiesMissing="FILE_PROPERTIES_MISSING",e.maxFilesAttachment="MAX_FILES_ATTACHMENT",e.nullFiles="NULL_FILES",e.zeroSizeFile="ZERO_SIZE_FILE",e.titleContainSpecialCharacter="TITLE_CONTAIN_SPECIAL_CHARACTER",e.blacklistedFiletype="BLACK_LIST_FILE_TYPE",e.fileNameTooLong="FILE_NAME_TOO_LONG",e.siteInfoNotFound="SITE_INFO_NOT_FOUND",e.spQuotaReached="SP_QUOTA_REACHED",e.fileNotPresent="FILE_NOT_PRESENT",e.fileAccessDenied="FILE_ACCESS_DENIED",e.fileLocked="FILE_LOCKED",e.siteNotProvisioned="SITE_NOT_PROVISIONED",e.siteNotProvisionedSubtext="SITE_NOT_PROVISIONED_SUBTEXT",e.channelSiteNotProvisioned="CHANNEL_SITE_NOT_PROVISIONED",e.channelSiteNotProvisionedSubtext="CHANNEL_SITE_NOT_PROVISIONED_SUBTEXT",e.fileAlreadyAttachedInMessage="FILE_WITH_SAME_NAME_ALREADY_ATTACHED_IN_MESSAGE",e.audienceUriValidationFailed="INVALID_AUDIENCE_URI"}(p||(p={})),function(e){e.UNKNOWN_UPLOAD_ERROR="UNKNOWN_UPLOAD_ERROR"}(v||(v={})),function(e){e.InvalidRequest="invalidRequest",e.Unhandled="Unhandled"}(h||(h={})),function(e){e.ShareLinkCSL="files_messages_sharelink_csl",e.ShareLinkPSLWithoutIndividualAccess="files_messages_sharelink_psl_without_individual_access",e.ShareLinkPSLWithoutIndividualWrite="files_messages_sharelink_psl_without_individual_write_access",e.ShareLinkPSLWithoutFutureAccess="files_messages_sharelink_psl_without_future_access",e.ShareLinkPSLWithoutFullAndFutureAccess="files_messages_sharelink_psl_without_full_and_future_access",e.ShareLinkPSLWithoutWriteAndFutureAccess="files_messages_sharelink_psl_without_write_and_future_access",e.ShareLinkFederatedAndGuestCSL="files_messages_sharelink_federated_and_guest_csl",e.ShareLinkFederatedCSL="files_messages_sharelink_federated_csl",e.ShareLinkPSLWithoutFullAccess="files_messages_sharelink_psl_without_full_access",e.ShareLinkCSLXTenantSharedChannel="files_messages_sharelink_csl_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessInTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_intenant_sharedchannel"}(f||(f={}));const y=100,k=10485760,S=12e4,b=3e5,C=600;var w;!function(e){e.GRAPH_URL_KEY="@microsoft.graph.downloadUrl",e.CONTENT_URL_KEY="@content.downloadUrl"}(w||(w={}));const N="/_layouts/15/Doc.aspx?OR=teams&action=edit&sourcedoc=";var T;!function(e){e.InvalidURL="InvalidURL",e.InvalidURLProtocol="InvalidURLProtocol",e.Invalid3PURLDomain="Invalid3PURLDomain",e.InvalidSPOOrPersonalSiteDomain="InvalidSPOOrPersonalSiteDomain",e.DifferentURLDomains="DifferentURLDomains"}(T||(T={}))},314144:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var i=n(86945);const a=(e,t)=>{switch(e){case i.Bx.unauthorizedAccess:return!t||t!==i.MI.invalidAudienceUri;case i.Bx.clientError:case i.Bx.badRequest:case i.Bx.internalServerError:case i.Bx.serviceUnavailable:case i.Bx.tooManyRequests:return!0;default:return!1}}},162948:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var i=n(249412),a=n(314144),o=n(86945),r=n(642115);const s=(e,t,n)=>{const s=d(e),c=(0,r.O$)(e,i.z.internalErrorCode),u=(0,r.O$)(e,i.z.httpCode,(null==e?void 0:e.code)||c||""),m={errorMessage:s,serverRequestId:(0,r.O$)(e,i.z.correlationId)};t(s),(0,a.X)(parseInt(u||"",10))&&!l(parseInt(u||"",10),c)?n&&n.fail({errors:JSON.stringify(m),errorCode:`${u}`}):n&&n.incomplete({errors:JSON.stringify(m),errorCode:`${u||o.BS.Unhandled}`})},l=(e,t)=>e&&e===o.Bx.badRequest&&t&&t===o.BS.InvalidRequest,d=e=>{let t=(0,r.O$)(e,i.z.logErrorMessage,(null==e?void 0:e.message)||"");const n=(0,r.O$)(e,"innerError",{message:""});t=`${t}. ${n?n.message:""}`;const a={context:null==e?void 0:e.context,subContext:null==e?void 0:e.subContext};return t=`${t}. ${JSON.stringify(a)}`,t}},29809:(e,t,n)=>{"use strict";var i;n.d(t,{W:()=>i}),function(e){e.Calendar="Calendar",e.Contacts="Contacts"}(i||(i={}))},230570:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i,e:()=>o}),function(e){e.span="span",e.mention="mention",e.sematicObject="semantic-object",e.card="card",e.readonly="readonly",e.spacer="spacer",e.video="video",e.topic="topic"}(i||(i={}));const a=[i.mention,i.sematicObject,i.card,i.readonly,i.spacer,i.video,i.topic],o=["a","abbr","acronym","address","area","article","aside","b","bdi","bdo","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","img","img","ins","kbd","label","li","map","map","mark","menu","nav","ol","p","pre","q","rp","rp","rt","rt","ruby","s","samp","section","small",i.span,"strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","wbr",...a]},709521:(e,t,n)=>{"use strict";n.d(t,{P:()=>a});var i=n(38623);function a(e){const t=e.performance;let n,a,o;const r=null==t?void 0:t.memory;return r&&(n=(0,i.kl)(r.jsHeapSizeLimit),a=(0,i.kl)(r.totalJSHeapSize),o=(0,i.kl)(r.usedJSHeapSize)),{jsHeapSizeLimit:n,totalJSHeapSize:a,usedJSHeapSize:o}}},38623:(e,t,n)=>{"use strict";n.d(t,{tC:()=>a,Mv:()=>o,RQ:()=>r,kl:()=>s,ev:()=>l});var i=n(892891);function a(e){const t={},n=[...e];return m(t,"TelemetryWorker",f(n,"TelemetryWorker")),m(t,"CDLWorker",f(n,"CDLWorker")),m(t,"ServiceWorker",f(n,"ServiceWorker")),t.Perf_Total_NumberOfCDLWorkers=h(e,"CDLWorker"),t.Perf_Total_NumberOfServiceWorkers=h(e,"ServiceWorker"),t.Perf_Total_NumberOfTelemetryWorkers=h(e,"TelemetryWorker"),t.Perf_Total_NumberOfWorkers=e.length,t}function o(e,t,n){const i={},a=[...e];g(i,"GPU",v(a,["gpu-process","Gpu"]),t),g(i,"NativeShell",v(a,["nativeShell","NativeShell"]),t),g(i,"CrashpadHandler",v(a,"crashpad-handler"),t),g(i,"Browser",v(a,["browser","Browser"]),t);const o=v(a,["renderer","Renderer"]);i.Perf_Renderer_Count_Processes=o.length,g(i,"Renderer",o,t),g(i,"SlimCore",v(a,["NativeModuleProcess_SlimCore"]),t);const r=v(a,["utility","Utility"]);if(g(i,"Utility",r,t),i.Perf_Utility_Process=[...r],k(i,"NetworkService",y(r,"NetworkService")),k(i,"StorageService",y(r,"StorageService")),k(i,"AudioService",y(r,"AudioService")),g(i,"Total",e),i.Perf_Total_NumberOfProcesses=e.length,i.Perf_Unknown_Process=a,i.Perf_Unknown_NumberOfProcesses=a.length,i.Perf_Unknown_WorkingSet=c(a),i.Perf_Unknown_CommitSize=u(a),n){const a=e.find((e=>e.processId===n));a&&(i.Perf_MainRenderer_WorkingSet=c([a]),i.Perf_MainRenderer_CommitSize=u([a]),i.Perf_MainRenderer_PeakWorkingSet=null==t?void 0:t.get(n))}return i}function r(e,t){const n={},{totalJSHeapSize:i,jsHeapSizeLimit:a,usedJSHeapSize:o}=e;return i&&(n.Perf_JSHeap_TotalSize=i),a&&(n.Perf_JSHeap_LimitSize=a),o&&(n.Perf_JSHeap_UsedSize=o),t&&(n.Perf_Peak_UsedJSHeapSize=t),n}function s(e){return"number"!=typeof e||isNaN(e)?void 0:Math.round(e/1024)}const l=s;function d(e,t){const n=(0,i.sumBy)(e,(e=>{var n;return null!==(n=e[t])&&void 0!==n?n:NaN}));return 0===e.length||isNaN(n)?void 0:n}function c(e){return d(e,"workingSetSizeKB")}function u(e){return d(e,"commitSizeKB")}function m(e,t,n){e[`Perf_${t}_UsedSize`]=function(e){return d(e,"usedSizeKB")}(n),e[`Perf_${t}_TotalSize`]=function(e){return d(e,"totalSizeKB")}(n)}function g(e,t,n,i){if(e[`Perf_${t}_WorkingSet`]=c(n),e[`Perf_${t}_CommitSize`]=u(n),"Total"===t)e.Perf_Total_NumberOfProcesses=n.length;else{if(e[`Perf_${t}_Count_Processes`]=n.length,!i||!n.length)return;const a=Math.max(...n.map((e=>i.get(e.processId)||0)));a&&(e[`Perf_${t}_PeakWorkingSet`]=a)}}function p(e,t){let n;const i=[];for(;n=e.findIndex(t),-1!==n;)i.push(e.splice(n,1)[0]);return i}function v(e,t){const n="string"==typeof t?[t]:t;return p(e,(e=>n.includes(e.type)))}const h=(e,t)=>e.filter((e=>e.subType===t)).length;function f(e,t){return p(e,(e=>e.subType.includes(t)))}function y(e,t){return p(e,(e=>e.utilitySubType.includes(t)))}function k(e,t,n){e[`Perf_${t}_WorkingSet`]=c(n),e[`Perf_${t}_CommitSize`]=u(n),e[`Perf_${t}_Count_Processes`]=n.length}},9522:(e,t,n)=>{"use strict";n.d(t,{EG:()=>a,em:()=>o,of:()=>l,_7:()=>d,Ol:()=>c,DI:()=>u});var i=n(681911);const a=e=>Boolean(e&&e.startsWith(i.V.Pstn)),o=e=>!(!e||!e.startsWith(i.V.AcsUser)),r=/4:[^-_]*-[^-_]*-[^-_]*-[^-_]*-.*/,s=e=>e.indexOf("_"),l=e=>{if(!a(e))return!1;const t=e.slice(i.V.Pstn.length);return-1!==s(t)},d=(e,t)=>r.test(e)&&t,c=e=>{let t=e.slice(i.V.Pstn.length);const n=s(t);return-1!==n&&(t=t.slice(0,n)),t},u=e=>e?`4:${e.replace(/-/g,"").replace(/\s/g,"")}`:""},247170:(e,t,n)=>{"use strict";n.d(t,{G:()=>o});var i=n(632585),a=n(58646);const o=e=>e instanceof i.xQ?e.asObservable():e instanceof a.y?e:new a.y((t=>e.subscribe(t)))},389957:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var i=n(136295),a=n(226568),o=n(895725);const r=(e,t,n,r)=>(0,i.z)((0,a.R)(((n,i)=>Array.from(function*(e,t,n,i){const a=e[Symbol.iterator](),o=t[Symbol.iterator]();let r=a.next(),s=o.next();for(;!s.done||!r.done;)s.done||!r.done&&s.value.id>r.value[0].id?(i(r.value[1]),r=a.next()):r.done||s.value.id<r.value[0].id?(yield[s.value,n(s.value)],s=o.next()):(yield[s.value,r.value[1]],r=a.next(),s=o.next())}(n,Array.from(i).sort(((e,t)=>e.id.localeCompare(t.id))),(t=>{try{return{type:"value",value:e(t)}}catch(e){return r&&r(t,e),{type:"error",error:e}}}),(e=>{if("error"!==e.type)return t(e.value)})))),[]),(0,o.U)((e=>e.filter((e=>"value"===e[1].type)).map((e=>n(e[0],e[1].value))))))},845479:(e,t,n)=>{"use strict";var i;n.d(t,{Y:()=>i}),function(e){e.About="about",e.Accounts="accounts",e.Accessibility="accessibility",e.Calendar="calendar",e.Calls="calls",e.General="general",e.Notifications="notifications",e.People="people_setting",e.Privacy="privacy",e.Benefits="benefits",e.Transcription="captions_and_transcription",e.Devices="devices"}(i||(i={}))},896149:(e,t,n)=>{"use strict";n.d(t,{hN:()=>i,jE:()=>o,mo:()=>c,PI:()=>u,Xn:()=>m,BN:()=>v,Np:()=>h,zG:()=>y,cE:()=>k,cI:()=>C,t_:()=>w,gC:()=>I});var i,a,o,r=n(907207),s=n(870209),l=n(892891),d=n(142604);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(i||(i={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(a||(a={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(o||(o={}));const c=e=>!!(e&&e.coExistenceMode&&i[e.coExistenceMode]),u=e=>!(e!==i.TeamsOnly),m=e=>!(-1===[i.Islands,i.IslandsWithTempInterop,i.IslandsWithVoipDeepLinking].indexOf(e)),g=e=>!(-1===[i.SfBOnly,i.SfBWithTeamsCollab,i.SfBWithTeamsCollabAndMeetings].indexOf(e)),p=(e,t,n=!1)=>{const i=[r.Jq,r.Dr,r.iO,r.TO,r.pk,r.P_],a=e.split(":");return i.some((e=>{const i=a.findIndex((t=>t===e.slice(0,-1)));return i>=0&&(n?a.splice(i+1,1):a.splice(i+1,0,t.slice(0,-1)),!0)})),a.join(":")},v=e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.pW,e)&&e.includes(r.pW),h=e=>!e||v(e)?e:e.includes(r.at.SkypeSpacesUser)?p(e,r.pW):void 0,f=e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.m_,e)&&e.includes(r.m_),y=e=>!e||(e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.U0,e)&&e.includes(`:${r.U0}`))(e)?e:e.includes(r.at.SkypeSpacesUser)?p(e,r.U0):void 0,k=e=>!e||f(e)?e:e.includes(r.at.SkypeSpacesUser)?p(e,r.m_):void 0,S=e=>{if(e){if(v(e))return p(e,r.pW,!0);if(f(e))return p(e,r.m_,!0)}return e},b={isAllowed:!1},C=(e,t,n,i,a,o,r,s)=>{const l=r&&r.coExistenceMode,d=o&&o.coExistenceMode;if(!l||!d)return{isAllowed:!0};if(i){const i=((e,t,n,i,a,o,r)=>{const s=r.newLogger("sfb-interop");return o.isFederated?!i&&n?(s.log("Chat Disabled: current user is not provisioned on Sfb online"),b):o.coExistenceMode&&a.coExistenceMode?e&&n&&u(a.coExistenceMode)&&u(o.coExistenceMode)?{isAllowed:!1,mri:k(o.mri||"")}:n||t||!m(a.coExistenceMode)&&!m(o.coExistenceMode)?!n&&g(o.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:o.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:o.mri}:(s.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(s.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(o))})(e,t,n,a,o,r,s);if(!i.isAllowed)return i}else{const e=((e,t)=>t.coExistenceMode?e&&u(t.coExistenceMode)?{isAllowed:!1,mri:S(t.mri||"")}:!e&&g(t.coExistenceMode)?{isAllowed:!1,mri:h(t.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(n,r);if(!e.isAllowed)return e}return{isAllowed:!0}},w=e=>{const t=f(e);return N(e)||v(e)||t?t?e.replace(r.m_,""):e.replace(r.pW,"").replace(r.zt,""):e},N=e=>!!e&&!(0,l.startsWith)(r.at.SkypeSpacesUser+r.zt,e)&&e.includes(r.zt),T=(e,t,n,i)=>{const o=e.isFederated,r=(s=e.mri||"",(0,l.endsWith)(s,"@sfbonprem.unq.gbl.spaces"));var s;if(t&&o&&!r&&e.coExistenceMode){const t=a[e.coExistenceMode],o=n===a.TeamsOnly&&t===a.TeamsOnly;return o||i.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${a[n]} recipientCoexistenceMode:${a[t]}`),o}return i.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${t} isFederated:${o} isOnPremFederated:${r} coExistenceMode:${e.coExistenceMode}`),!1},I=(e,t,n,i,r,l)=>{if(!(e&&e.mri&&e.userType!==d.vf.guest&&e.type!==d.vf.skypeConsumer&&e.type!==d.vf.tflUser&&(0,s.eZ)(e.mri)))return n.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),o.Teams;if(e.isFederated)return n.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),T(e,r,l,n)?o.NativeFederated:o.Federated;const c=((e,t,n)=>{const i=e.coExistenceMode,r=a[i];if(n.log(`getCoexistenceChatMode - caller: ${t}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${a[r]}, MT coExistenceMode: ${i}`),a[r]!==i&&n.error(`getUserChatMode - Mapping error - coExistenceMode : ${a[r]}, MT coExistenceMode: ${i}`),r){const e=[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings],t=[a.TeamsOnly,a.Islands,a.IslandsWithVoipDeepLinking];if(e.includes(r))return o.SfB;if(t.includes(r))return o.Teams;n.warn(`getUserChatMode - unknown coExistenceMode ${a[r]}`)}else e.isShortProfile||n.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,t,n);if(c)return c;const u=v(e.mri),m=e.isSkypeTeamsUser,g=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return n.log(`getUserChatMode - caller: ${t}, mri: ${e.mri}, isSfbMri: ${u}, isTeamsChatEnabled: ${g}, hasLoggedInToTeams: ${m}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${i}`),!u&&m&&g||e.isSipDisabled||!i?o.Teams:o.SfB}},568539:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(75565);const a=(e,t)=>{try{return e.matchMedia(i.s0.ColorContrastOverride).matches?i.f8.Contrast:e.matchMedia(i.s0.Dark).matches?i.f8.Dark:i.f8.Light}catch(e){return void(null==t||t.log(`Couldn't resolve getOsTheme: ${e.message}`))}}},92293:(e,t,n)=>{"use strict";n.d(t,{R6:()=>r,FP:()=>l,sN:()=>d,u_:()=>c});var i=n(723373),a=n(75565),o=n(568539);const r=e=>({[a.f8.Light]:e===i.s.life?a.Q2.DefaultTfl:a.Q2.DefaultV2,[a.f8.Dark]:e===i.s.life?a.Q2.DarkTfl:a.Q2.DarkV2,[a.f8.Contrast]:a.Q2.HighContrast}),s=(e,t)=>t[e]||a.Q2.DefaultV2,l=()=>({[a.Q2.Default]:a.f8.Light,[a.Q2.DefaultV2]:a.f8.Light,[a.Q2.DefaultTfl]:a.f8.Light,[a.Q2.Dark]:a.f8.Dark,[a.Q2.DarkV2]:a.f8.Dark,[a.Q2.DarkTfl]:a.f8.Dark,[a.Q2.HighContrast]:a.f8.Contrast}),d=(e,t)=>t[e]||a.f8.Light,c=(e,t,n,i)=>{var r;const l=u(t);if(l)return l;const d=null!==(r=e.getPreferences("theme"))&&void 0!==r?r:{};if(d.followOsTheme){const e=(0,o.Z)(t,i);if(e)return s(e,n)}else if(d.userTheme)return s(d.userTheme,n);return a.Q2.DefaultV2},u=e=>{const t=new URLSearchParams(e.location.search).get("theme");if(t){const e=Object.keys(a.Q2).find((e=>e.toUpperCase()===t.toUpperCase()));return a.Q2[e]}}},29410:(e,t,n)=>{"use strict";n.d(t,{R2:()=>l,tl:()=>c,Hu:()=>u,VI:()=>m,cJ:()=>g,$N:()=>p,gj:()=>v,pw:()=>h,dp:()=>b,bR:()=>C,E:()=>w,Ry:()=>N});var i=n(465759);const a={landscape:400,portrait:200,square:250},o={landscape:225,portrait:355,square:250},r=1.7777778,s=.5625,l="Video-Clip",d=new RegExp("^[0-9]+/[1-9][0-9]+$"),c=(e,t)=>`${e}/${t}`,u=e=>{if(e<=0)throw new Error("convertDurationSecToISO8601:Failed, input durationInSec should be greater than 0");const t=(0,i.L)(e).split(":"),n=3===t.length,a={hour:0,minute:1,second:2};n||(a.hour=-1,a.minute=0,a.second=1);const o=n?+t[a.hour]:0,r=+t[a.minute],s=+t[a.second];let l="PT";return o&&(l+=`${o}H`),r&&(l+=`${r}M`),s&&(l+=`${s}S`),l},m=e=>({progress:+e.split("/")[0],total:+e.split("/")[1]}),g=e=>d.test(e),p=(e,t)=>`${e}v1/objects/${t}/views/video`,v=e=>{const t={height:void 0,width:void 0};if(e.width&&e.height)t.width=+e.width,t.height=+e.height;else if(e.style){e.style.split(";").forEach((e=>{const[n,i]=e.split(":"),a=null==n?void 0:n.trim();if("height"===a||"width"===a){const e=i&&parseInt(i.trim(),10);t[a]=e||void 0}}))}return t},h=(e,t)=>e&&t?e<t?f(e,t):e>t?y(e,t):k():S(),f=(e,t)=>{const n=a.portrait,i=o.portrait;return e/t<s?{width:e/t*i,height:i}:{width:n,height:t/e*n}},y=(e,t)=>{const n=a.landscape,i=o.landscape;return e/t<r?{width:e/t*i,height:i}:{width:n,height:t/e*n}},k=()=>({width:a.square,height:o.square}),S=()=>({width:a.landscape,height:o.landscape}),b={volume:1,muted:!1,captionOn:!1},C="tmp.onePlayerSettings",w="OnePlayer-TextTrack-Settings",N='{"showTextTrack":true,"preferredLanguage":"spokenLanguage"}'},204386:(e,t,n)=>{"use strict";n.d(t,{Sq:()=>i,wX:()=>a,hq:()=>o,ij:()=>r,OE:()=>s,ZU:()=>l,If:()=>d,cQ:()=>c,an:()=>u,JH:()=>m});const i="video-message",a="video-message-gc",o="Creation-Epoch",r="tmp.recorder-status",s=(e,t)=>{const n=parseInt(t||"",10);return isNaN(n)||e-n>144e5},l=(e,t)=>e-t>2592e5,d=e=>u(e,"videoBlob"),c=e=>u(e,"thumbnailBlob"),u=(e,t)=>`${i}?cacheId=${e}&type=${t}`,m=e=>{try{const t=new URL(e);if(t.pathname.slice(Math.max(0,t.pathname.length-i.length))!==i)return;const n=t.searchParams.get("cacheId"),a=t.searchParams.get("type"),o="videoBlob"===a||"thumbnailBlob"===a?a:void 0;return n&&o?{cacheId:n,type:o}:void 0}catch(e){return}}},668397:e=>{"use strict";e.exports=ITEMS_VIEW_STRINGS},214797:e=>{"use strict";if("undefined"==typeof componentsWebRecorderLoaderHVCV1Helper){var t=new Error("Cannot find module 'componentsWebRecorderLoaderHVCV1Helper'");throw t.code="MODULE_NOT_FOUND",t}e.exports=componentsWebRecorderLoaderHVCV1Helper},759455:e=>{"use strict";e.exports=JSON.parse('{"clientId":"5e3ce6c0-2b1f-4285-8d4b-75ee78787346","basePath":"multi-window","experienceName":"multi-window","fallbackLocale":"en-us","shouldFetchBootstrapData":true,"webAuth":{"cacheLocation":"localStorage","navigateToLoginRequestUrl":true,"top":{"popUp":true},"iframe":{"redirectPath":"auth"}},"ring":{"id":"ring0"},"cdnVersion":4,"enableDevTools":true,"windowType":"MW","lpcRegion":"df","isLPCEnabled":true,"preloadedI18nNamespaces":["avatar","breakoutRooms","framework","gallery","livePersonaCard","peoplePicker","recurrence","messaging","virtualEvents"],"postMessageConfig":["https://teams.microsoft.com","https://teams.microsoft.us","https://gov.teams.microsoft.us","https://dod.teams.microsoft.us","https://teams.eaglex.ic.gov","https://teams.microsoft.scloud","https://teams.microsoftonline.cn","https://teams.live.com"],"shouldTrackCoreInitTasks":true}')}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,dataWebpackPrefix,policy,loadStylesheet,installedCssChunks,chunkToChildrenMap;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},deferred=[],__webpack_require__.O=(e,t,n,i)=>{if(!t){var a=1/0;for(l=0;l<deferred.length;l++){for(var[t,n,i]=deferred[l],o=!0,r=0;r<t.length;r++)(!1&i||a>=i)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[r])))?t.splice(r--,1):(o=!1,i<a&&(a=i));if(o){deferred.splice(l--,1);var s=n();void 0!==s&&(e=s)}}return e}i=i||0;for(var l=deferred.length;l>0&&deferred[l-1][2]>i;l--)deferred[l]=deferred[l-1];deferred[l]=[t,n,i]},__webpack_require__.F={},__webpack_require__.E=e=>{Object.keys(__webpack_require__.F).map((t=>{__webpack_require__.F[t](e)}))},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);__webpack_require__.r(n);var i={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var a=2&t&&e;"object"==typeof a&&!~leafPrototypes.indexOf(a);a=getProto(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,__webpack_require__.d(n,i),n},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>(({9:"components-calendar-share-link-dialog",57:"calling-locale-mk-mk",75:"calendar-locale-et-ee",106:"school-locale-sq-al",132:"meeting-options-locale-ro-ro",140:"meeting-options-locale-es-es",145:"components-screen-recorder2",162:"InformationProtectionStrings48",183:"meeting-recap-locale-he-il",200:"InformationProtectionStrings3",211:"meeting-recap-locale-fr-ca",229:"data-resolvers-browser-share",240:"components-meeting-room-front-of-room-entry",245:"audience-view-dialog-locale-sl-si",253:"freemium-upgrade-locale-is-is",274:"video-message-locale-ru-ru",284:"search-locale-cs-cz",369:"message-escalate-dialog-locale-fil-ph",385:"extensibility-locale-ar-sa",397:"guardians-locale-vi-vn",470:"coach-report-locale-pt-br",471:"recurrence-locale-fil-ph",481:"sht-searchanswerteamsstrings_es-es-mx",488:"data-resolvers-browser-calls-screen",509:"calendar-locale-sv-se",551:"meeting-recap-locale-fil-ph",586:"meetingFlyout-locale-is-is",588:"data-resolvers-toast",598:"survey-locale-ro-ro",629:"meeting-analytics-locale-ar-sa",632:"virtualEvents-locale-zh-tw",637:"calling-locale-fr-fr",658:"meeting-room-console-locale-nl-nl",673:"search-locale-mk-mk",675:"services-io-connected-calendar",692:"pl-PL-UiStrings-json",741:"message-escalate-dialog-locale-de-de",749:"health-locale-sv-se",772:"survey-locale-ko-kr",809:"recurrence-locale-he-il",819:"coach-report-locale-lt-lt",822:"messaging-locale-ca-es-valencia",824:"calling-locale-id-id",826:"calendar-locale-da-dk",834:"virtualEvents-locale-uk-ua",866:"categories-hy-am-json",880:"sht-searchanswerteamsstrings_es-ms",902:"sht-cortextopictypeswebstrings_gu",906:"share-email-locale-ca-es-valencia",912:"otlang18",923:"services-distribution-list",926:"main-locale-lv-lv",950:"aRes18",987:"gallery-locale-lv-lv",1026:"fns36",1035:"services-io-browser-collab-cloud",1091:"sht-cortextopictypeswebstrings_ta",1129:"esp-locale-sq-al",1131:"en-gb-strings-jsonThinRes",1172:"services-voicemail",1199:"share-email-locale-el-gr",1215:"artifacts-platform-locale-it-it",1264:"components-calling-paywall-image-lazy",1281:"meeting-recap-locale-sv-se",1345:"video-capture-locale-el-gr",1351:"fns63",1375:"hostDefaultsStrings63",1383:"onecamera-locale-id",1387:"aRes43",1400:"search-locale-ca-es-valencia",1420:"data-resolvers-appbar",1421:"onecamera-locale-ms",1429:"coach-report-locale-ru-ru",1440:"breakoutRooms-locale-pl-pl",1474:"meeting-bot-locale-zh-cn",1496:"cast-locale-hu-hu",1498:"school-locale-pl-pl",1510:"onecamera-locale-it",1514:"sht-cortex-topics-bootstrapper-topics-sdk",1530:"categories-es-es-json",1551:"meeting-bot-locale-ka-ge",1555:"calls-app",1556:"cast-locale-nb-no",1573:"school-locale-gl-es",1583:"hostDefaultsStrings78",1595:"smart-device-locale-lv-lv",1612:"webinar-locale-sr-latn-rs",1638:"data-resolvers-browser-meet-for-work",1659:"people-targeting-locale-id-id",1741:"teams-compose-box",1753:"meeting-recap-locale-vi-vn",1811:"aRes41",1876:"school-locale-kk-kz",1924:"esp-locale-nl-nl",1966:"as-IN-UiStrings-json",1983:"main-locale-it-it",1989:"sht-cortextopictypeswebstrings_de",2016:"semantic-object-locale-kk-kz",2054:"core-essentials",2060:"meetingFlyout-locale-kk-kz",2066:"services-manage-tenant",2078:"services-substrate-meeting-recommendations",2090:"aRes50",2138:"smart-device-locale-en-gb",2147:"freemium-upgrade-locale-th-th",2148:"health-locale-hi-in",2168:"sht-cortextopictypeswebstrings_mi-nz",2219:"ariawrapper",2243:"aRes10",2297:"cy-GB-UiStrings-json",2308:"channels-locale-ko-kr",2376:"people-targeting-locale-ko-kr",2478:"lv-LV-comment-pane-strings-jsonOfficeOnlineStringResource",2479:"meeting-bot-locale-sq-al",2488:"people-targeting-locale-hu-hu",2514:"artifacts-platform-locale-pt-pt",2517:"odsp1PDiagnosticTool",2525:"recurrence-locale-en-us",2559:"gallery-locale-ka-ge",2600:"deferredcomponents",2653:"services-file-download-manager",2701:"main-locale-es-mx",2708:"extensibility-locale-id-id",2764:"channels-locale-cy-gb",2771:"esp-locale-pt-br",2774:"share-email-locale-fr-fr",2784:"meeting-recap-locale-el-gr",2800:"notesOfficeWebHost",2849:"channels-locale-id-id",2859:"sht-searchanswerteamsstrings_es-vi",2883:"search-locale-sk-sk",2893:"id-ID-UiStrings-json",2895:"m365chat-card-container",2936:"artifacts-platform-locale-uk-ua",2943:"coach-report-locale-es-es",2953:"hostDefaultsStrings46",2989:"uz-Latn-UZ-UiStrings-json",3034:"teams-and-channels-locale-sq-al",3035:"af-ZA-comment-pane-strings-jsonOfficeOnlineStringResource",3047:"fns8",3073:"message-escalate-dialog-locale-cy-gb",3137:"services-files",3184:"share-email-locale-et-ee",3220:"webrec2-language-it",3232:"extensibility-locale-ka-ge",3266:"video-message-locale-da-dk",3275:"transcript-content-app",3292:"teams-and-channels-locale-de-de",3301:"guardians-locale-it-it",3405:"calling-locale-sq-al",3420:"hostUxStrings6",3441:"data-resolvers-translation-settings",3460:"ms-strings-jsonThinRes",3461:"calendar-locale-zh-tw",3528:"otlang10",3568:"video-message-locale-lv-lv",3576:"hostUxStrings18",3584:"video-message-locale-nn-no",3626:"esp-locale-ca-es",3632:"wiki-locale-da-dk",3657:"wiki-locale-fr-ca",3683:"webinar-locale-fi-fi",3698:"components-calendar-peek",3743:"fil-ph-strings-jsonThinRes",3762:"components-screen-recorder64",3779:"meetingFlyout-locale-pt-pt",3813:"breakoutRooms-locale-fr-ca",3817:"broadcast-locale-id-id",3842:"breakout-rooms",3846:"main-locale-id-id",3891:"data-resolvers-browser-ddv",3908:"hostDefaultsStrings67",3940:"biometric-enrollment-locale-ru-ru",3941:"video-message-locale-cy-gb",3966:"semantic-object-locale-da-dk",3972:"meet-for-work-locale-hu-hu",3979:"people-targeting-locale-uk-ua",3982:"artifacts-platform-locale-sr-latn-rs",3983:"teams-and-channels-locale-ka-ge",3998:"services-guardians",4102:"meet-for-work-locale-de-de",4115:"sht-searchanswerteamsstrings_es-am",4120:"search-locale-da-dk",4128:"main-locale-nb-no",4171:"notifications-entry",4177:"components-screen-recorder84",4184:"coach-report-locale-uk-ua",4212:"InformationProtectionStrings75",4221:"hostDefaultsStrings20",4286:"fns23",4288:"semantic-object-locale-de-de",4289:"semantic-object-locale-ja-jp",4299:"guardians-locale-nn-no",4317:"semantic-object-locale-ar-sa",4340:"artifacts-platform-locale-pt-br",4346:"hostUxStrings32",4357:"health-locale-ka-ge",4411:"biometric-enrollment-locale-ka-ge",4452:"discover-surface-locale-pl-pl",4484:"message-escalate-dialog-locale-sq-al",4596:"data-resolvers-meeting-summary-qna-history",4601:"cast-locale-de-de",4609:"services-policies",4615:"main-locale-ja-jp",4620:"fns64",4631:"sht-searchanswerteamsstrings_es-af",4685:"recurrence-locale-bg-bg",4703:"categories-da-dk-json",4773:"smart-device-locale-tr-tr",4818:"meeting-room-console-locale-cs-cz",4822:"school-locale-nn-no",4858:"coach-report-locale-fr-fr",4881:"smart-device-locale-da-dk",4904:"semantic-object-locale-es-es",4918:"audience-view-dialog-locale-ca-es-valencia",4987:"meeting-recap-locale-nn-no",5023:"onecamera-locale-ga",5049:"webinar-locale-ro-ro",5053:"files-locale-lv-lv",5058:"meetingFlyout-locale-ro-ro",5082:"audience-view-dialog-locale-eu-es",5089:"cast-locale-he-il",5103:"video-capture-locale-it-it",5108:"virtual-events-app",5131:"otlang14",5164:"wiki-locale-fi-fi",5170:"survey-locale-es-es",5183:"coach-report-locale-da-dk",5188:"survey-locale-sl-si",5203:"services-apps-platform",5213:"coach-report-locale-ka-ge",5224:"otlang13",5235:"freemium-upgrade-locale-gl-es",5250:"collaborative-web-content",5271:"shell-app",5297:"webrec2-language-ko",5324:"school-locale-hu-hu",5351:"it-IT-comment-pane-strings-jsonOfficeOnlineStringResource",5353:"kk-KZ-comment-pane-strings-jsonOfficeOnlineStringResource",5363:"gallery-locale-ca-es",5390:"smart-device-locale-pt-br",5400:"broadcast-locale-ko-kr",5406:"esp-locale-az-latn-az",5421:"meeting-options-locale-ja-jp",5430:"otlang73",5440:"smart-device-locale-zh-cn",5443:"hostUxStrings10",5462:"teams-and-channels-locale-kk-kz",5543:"meet-for-work-locale-nb-no",5579:"meetingFlyout-locale-en-gb",5588:"discover-surface-locale-lt-lt",5589:"meetingFlyout-locale-it-it",5599:"messaging-locale-ca-es",5632:"data-resolvers-calendar",5667:"hostDefaultsStrings29",5688:"InformationProtectionStrings20",5724:"meetingFlyout-locale-bg-bg",5729:"meeting-room-all-in-one-entry-container",5750:"calling-locale-vi-vn",5752:"categories-ml-in-json",5754:"components-files-super-picker",5777:"discover-surface-locale-es-es",5784:"wiki-locale-sr-latn-rs",5794:"services-dynamics-marketing",5820:"video-message-locale-ja-jp",5851:"hostDefaultsStrings25",5875:"calling-locale-cy-gb",5880:"virtualEvents-locale-mk-mk",5887:"az-latn-az-strings-jsonThinRes",5895:"sht-teams-answerroutercontainer",5913:"discover-surface-locale-hu-hu",5954:"meeting-analytics-locale-gl-es",5992:"meet-for-work-locale-sl-si",6013:"categories-de-de-json",6020:"data-resolvers-calling",6023:"audience-view-dialog-locale-lt-lt",6055:"files-locale-lt-lt",6063:"meeting-options-locale-nl-nl",6066:"meeting-bot-locale-ko-kr",6091:"semantic-object-locale-vi-vn",6194:"meeting-analytics-locale-sl-si",6240:"containerMessageBanner",6279:"biometric-enrollment-locale-ca-es",6294:"freemium-upgrade-locale-nb-no",6312:"sht-searchanswerteamsstrings_es-en-us",6317:"adaptivecard",6336:"guardians-locale-hi-in",6355:"webinar-locale-hu-hu",6366:"hostUxStrings40",6373:"esp-locale-ja-jp",6389:"recurrence-locale-ru-ru",6396:"semantic-object-locale-en-gb",6408:"services-tpn-notice",6428:"webrec2-language-sq",6431:"hostUxStrings23",6457:"messaging-locale-fr-ca",6472:"messaging-locale-fi-fi",6488:"webrec2-language-fil-ph",6508:"meet-for-work-locale-ka-ge",6545:"services-refresh-site-url",6552:"meeting-analytics-locale-is-is",6582:"modal",6652:"services-dynamics-virtual-events",6659:"school-locale-bg-bg",6693:"data-client-calling",6702:"sht-cortextopictypeswebstrings_ne-np",6740:"virtualEvents-locale-de-de",6746:"InformationProtectionStrings63",6767:"guardians-locale-az-latn-az",6768:"extensibility-locale-sr-latn-rs",6841:"message-escalate-dialog-locale-eu-es",6854:"sre-root",6874:"sht-searchanswerteamsstrings_es-zh-hant",6886:"sht-searchanswerteamsstrings_es-hu",6929:"guardians-locale-nl-nl",6938:"fns59",6942:"broadcast-locale-gl-es",6966:"sht-searchanswerteamsstrings_es-kk",6990:"main-locale-da-dk",6994:"teams-post-compose-box",7004:"meeting-analytics-locale-da-dk",7015:"biometric-enrollment-locale-sl-si",7022:"messaging-locale-ru-ru",7040:"teachingMoment",7056:"main-locale-ca-es-valencia",7124:"message-escalate-dialog-locale-tr-tr",7169:"meetingFlyout-locale-nb-no",7178:"chat-screen-share-button",7191:"hostDefaultsStrings70",7205:"survey-locale-sv-se",7215:"gallery-locale-it-it",7290:"categories-fa-ir-json",7351:"webrec2-language-tr",7368:"semantic-object-locale-zh-cn",7378:"say-hi-with-a-wave",7407:"sr-Cyrl-BA-comment-pane-strings-jsonOfficeOnlineStringResource",7413:"webrec2-language-ga-ie",7447:"es-ES-comment-pane-strings-jsonOfficeOnlineStringResource",7514:"zh-hans-strings-jsonThinRes",7518:"aRes57",7523:"search-locale-ko-kr",7536:"esp-locale-cs-cz",7545:"survey-locale-hu-hu",7560:"data-resolvers-unified-consent",7598:"data-resolvers-search-suggestions",7620:"search-locale-is-is",7676:"meeting-room-console-locale-ro-ro",7696:"fns44",7718:"kk-strings-jsonThinRes",7723:"onecamera-locale-ja",7729:"hostUxStrings52",7761:"meeting-room-console-locale-en-us",7776:"breakoutRooms-locale-uk-ua",7783:"broadcast-locale-ja-jp",7813:"meeting-recap-locale-pt-br",7832:"sht-searchanswerteamsstrings_es-ro",7850:"meeting-analytics-locale-nl-nl",7897:"meeting-bot-locale-th-th",7932:"data-resolvers-notifications-engine",7949:"health-locale-en-gb",7950:"smart-device-locale-nb-no",7959:"fluid-component-renderer",8025:"categories-he-il-json",8049:"hostUxStrings2",8058:"coach-report-locale-el-gr",8063:"categories-gl-es-json",8074:"hi-IN-UiStrings-json",8094:"meet-for-work-locale-uk-ua",8108:"o365-connector-card",8111:"extensibility-locale-fr-ca",8118:"gallery-locale-nl-nl",8124:"messaging-locale-id-id",8174:"teams-and-channels-locale-lv-lv",8275:"recurrence-locale-es-mx",8376:"sht-searchanswerteamsstrings_es-te",8398:"ms-MY-UiStrings-json",8418:"video-capture-locale-sl-si",8438:"health-locale-ar-sa",8480:"wiki-locale-zh-tw",8521:"meeting-options-locale-pt-pt",8535:"hostUxStrings78",8568:"meetingFlyout-locale-hi-in",8609:"meeting-room-console-locale-hi-in",8631:"extensibility-locale-he-il",8632:"artifacts-platform-locale-ru-ru",8656:"meeting-options-locale-ar-sa",8687:"data-resolvers-meeting-analytics",8725:"components-files-personal-picker",8735:"meeting-options-locale-lt-lt",8743:"ug-CN-comment-pane-strings-jsonOfficeOnlineStringResource",8751:"ml-IN-UiStrings-json",8806:"data-resolvers-browser-ams",8819:"hostDefaultsStrings21",8897:"categories-nn-no-json",8954:"guardians-locale-zh-tw",8983:"global-auth",9014:"search-locale-lt-lt",9030:"sht-searchanswerteamsstrings_es-fr",9050:"webrec2-language-az-latn-az",9082:"extensibility-locale-mk-mk",9119:"af-ZA-UiStrings-json",9143:"meeting-recap-locale-ar-sa",9162:"video-message-locale-ro-ro",9170:"InformationProtectionStrings9",9193:"sht-cortextopictypeswebstrings_zh-hans",9252:"breakoutRooms-locale-vi-vn",9257:"webrec2-language-bg",9293:"meeting-room-console-locale-cy-gb",9339:"socketModule",9342:"services-io-data-smb-user-intent",9352:"fns40",9372:"calendar-locale-lv-lv",9436:"teams-and-channels-locale-hr-hr",9469:"hostUxStrings81",9495:"meeting-options-panel",9505:"hostUxStrings56",9545:"search-locale-de-de",9590:"otlang100",9592:"hostDefaultsStrings59",9675:"meetingFlyout-locale-sr-latn-rs",9679:"video-message-locale-sv-se",9691:"sht-cortextopictypeswebstrings_da",9735:"aRes46",9778:"hostUxStrings48",9820:"InformationProtectionStrings5",9823:"wiki-locale-es-mx",9837:"smart-device-locale-mk-mk",9902:"virtualEvents-locale-pt-pt",9940:"teams-and-channels-locale-vi-vn",9981:"gallery-locale-he-il",10016:"fns15",10035:"sht-searchanswerteamsstrings_es-zu-za",10047:"artifacts-platform-locale-he-il",10056:"meetingFlyout-locale-de-de",10066:"fluidxOdspDriver",10104:"data-resolvers-browser-live-stream-rendering",10122:"meeting-options-locale-cy-gb",10146:"audience-view-dialog-locale-vi-vn",10166:"school-locale-en-us",10183:"fluidxUtilities",10186:"health-locale-uk-ua",10190:"uk-strings-jsonThinRes",10203:"create-folder-wizard",10222:"ru-RU-UiStrings-json",10229:"hostDefaultsStrings43",10236:"InformationProtectionStrings56",10284:"calendar-locale-vi-vn",10318:"sht-searchanswerteamsstrings_es-uk",10319:"calling-locale-da-dk",10412:"broadcast-locale-ar-sa",10419:"nb-NO-UiStrings-json",10501:"survey-locale-es-mx",10542:"aRes14",10562:"main-locale-ka-ge",10567:"video-message-locale-sl-si",10589:"meeting-analytics-locale-hi-in",10642:"wiki-locale-ka-ge",10649:"extensibility-locale-pt-pt",10652:"meeting-analytics-locale-ca-es-valencia",10675:"sht-search-answer-strings",10683:"data-resolvers-activity",10728:"webinar-locale-th-th",10749:"meeting-options-locale-da-dk",10784:"cast-locale-hi-in",10787:"webrec2-language-kk",10812:"data-resolvers-ai-insights-sds",10828:"esp-locale-ar-sa",10880:"calling-umd-bundle",10942:"sht-cortextopictypeswebstrings_ga-ie",10970:"discover-surface-locale-gl-es",11048:"onecamera-locale-ru",11125:"files-locale-nn-no",11131:"cast-locale-nn-no",11136:"gallery-locale-es-mx",11141:"sht-cortextopictypeswebstrings_tt",11157:"messaging-locale-es-mx",11158:"video-capture-locale-zh-cn",11172:"freemium-upgrade-locale-de-de",11198:"meeting-room-front-row-chat",11205:"gl-ES-UiStrings-json",11265:"teams-and-channels-locale-el-gr",11286:"survey-form-entry",11290:"breakoutRooms-locale-fr-fr",11318:"keyboardShortcutsModal",11334:"aRes37",11368:"navigationPanel",11369:"video-message-locale-ko-kr",11382:"LPPLazy",11591:"teams-dashboard",11637:"meeting-analytics-locale-cs-cz",11645:"smart-device-locale-et-ee",11657:"onePlayer",11682:"components-screen-recorder74",11746:"gallery-locale-en-us",11763:"shakaengine",11779:"health-locale-sr-latn-rs",11827:"extensibility-locale-ja-jp",11846:"services-breakout-rooms",11847:"InformationProtectionStrings2",11849:"channels-locale-pl-pl",11908:"guardians-locale-lv-lv",11943:"calendar-locale-ko-kr",11957:"webinar-locale-he-il",11969:"webinar-locale-it-it",12002:"reactions-overlay-renderer",12083:"video-message-locale-en-us",12090:"calling-locale-sk-sk",12097:"categories-sv-se-json",12136:"data-resolvers-address-autosuggest",12159:"services-style-my-room",12190:"calling-roster",12243:"broadcast-locale-az-latn-az",12252:"artifacts-platform-locale-nb-no",12274:"communities-report-concern",12353:"data-resolvers-browser-broadcast-attendee",12359:"files-locale-pt-br",12374:"coach-report-locale-de-de",12389:"video-message-locale-hr-hr",12440:"freemium-upgrade-locale-sk-sk",12486:"hostUxStrings76",12502:"broadcast-locale-es-mx",12535:"hostDefaultsStrings65",12549:"services-broadcast-signalr",12610:"components-screen-recorder24",12629:"ml-IN-comment-pane-strings-jsonOfficeOnlineStringResource",12638:"pt-BR-UiStrings-json",12657:"school-locale-ko-kr",12664:"packageAnalyticsMainElement",12671:"broadcast-locale-hu-hu",12695:"sht-cortextopictypeswebstrings_sd-arab-pk",12704:"hostDefaultsStrings31",12764:"otlang7",12767:"data-resolvers-compose-language",12776:"share-email-locale-sq-al",12782:"school-locale-ja-jp",12850:"fns80",12882:"categories-et-ee-json",13168:"sr-Cyrl-RS-comment-pane-strings-jsonOfficeOnlineStringResource",13170:"fns76",13199:"meeting-recap-locale-hi-in",13271:"school-locale-nl-nl",13299:"meeting-recap-locale-cy-gb",13311:"hostDefaultsStrings57",13353:"meetingFlyout-locale-fi-fi",13354:"breakoutRooms-locale-sq-al",13386:"splash-screen-image",13392:"teams-and-channels-locale-sl-si",13411:"freemium-upgrade-locale-ru-ru",13418:"semantic-object-locale-pl-pl",13428:"meeting-room-console-locale-fil-ph",13478:"webinar-locale-ca-es-valencia",13484:"health-locale-el-gr",13507:"semantic-object-locale-is-is",13529:"freemium-upgrade-locale-nn-no",13549:"services-user-profile",13602:"virtualEvents-locale-el-gr",13609:"topics-sdk-loki-api",13652:"gallery-locale-pt-br",13666:"esp-locale-he-il",13680:"meeting-options-locale-pt-br",13692:"meeting-options-locale-is-is",13723:"az-Latn-AZ-comment-pane-strings-jsonOfficeOnlineStringResource",13737:"biometric-enrollment-locale-ro-ro",13739:"people-targeting-locale-fr-fr",13749:"survey-locale-gl-es",13750:"webinar-locale-et-ee",13752:"share-email-locale-th-th",13768:"discover-surface-locale-fr-ca",13769:"designer-full-dialog",13794:"biometric-enrollment-locale-pl-pl",13802:"artifacts-platform-locale-de-de",13832:"mt-MT-UiStrings-json",13838:"recurrence-locale-is-is",13847:"breakoutRooms-locale-ja-jp",13872:"meeting-room-console-locale-is-is",13909:"freemium-upgrade-locale-sr-latn-rs",13968:"guardians-locale-ro-ro",13980:"artifacts-platform-locale-da-dk",14044:"people-targeting-locale-cy-gb",14076:"sht-searchanswerteamsstrings_es-lt",14091:"fns34",14095:"biometric-enrollment-locale-it-it",14128:"virtualEvents-locale-nb-no",14151:"extensibility-locale-zh-cn",14166:"meeting-room-console-locale-ka-ge",14169:"data-resolvers-browser-style-my-room",14268:"share-email-locale-sl-si",14287:"survey-locale-zh-cn",14302:"virtualEvents-locale-sl-si",14309:"survey-locale-et-ee",14354:"message-escalate-dialog-locale-it-it",14368:"meeting-room-console-locale-mk-mk",14377:"channels-locale-de-de",14381:"cast-locale-ka-ge",14401:"meeting-recap-locale-hr-hr",14408:"services-live-stream-renderer",14421:"calling-meeting-options-form",14456:"freemium-upgrade-locale-cs-cz",14464:"meeting-options-locale-de-de",14474:"eu-ES-comment-pane-strings-jsonOfficeOnlineStringResource",14493:"sht-cortextopictypeswebstrings_pa-in",14512:"meet-for-work-locale-pt-br",14526:"cast-locale-da-dk",14533:"people-targeting-locale-da-dk",14542:"message-escalate-dialog-locale-ar-sa",14590:"breakoutRooms-locale-sl-si",14600:"wiki-locale-bg-bg",14609:"aRes42",14621:"room-remote",14629:"message-escalate-dialog-locale-ca-es",14634:"freemium-upgrade-locale-nl-nl",14644:"hy-AM-UiStrings-json",14646:"breakoutRooms-locale-ar-sa",14682:"global-error-boundary",14712:"audience-view-dialog-locale-de-de",14727:"biometric-enrollment-locale-hu-hu",14743:"main-locale-ru-ru",14748:"onecamera-locale-is",14787:"msal-service",14826:"services-url-preview",14834:"meeting-options-locale-nn-no",14927:"virtualEvents-locale-bg-bg",14988:"services-example",15061:"sht-searchanswerteamsstrings_es-he",15064:"aRes51",15066:"meeting-recap-locale-sq-al",15078:"people-targeting-locale-is-is",15120:"fns84",15195:"communities-add-member-dialog",15257:"audience-view-dialog-locale-pt-pt",15271:"categories-kok-in-json",15314:"audience-view-dialog-locale-hr-hr",15331:"sht-searchanswerteamsstrings_es-is",15340:"lazy-ppt-loader",15343:"freemium-upgrade-locale-sq-al",15369:"teams-gallery-app",15442:"coach-report-locale-nb-no",15450:"hostDefaultsStrings52",15463:"categories-lt-lt-json",15469:"meet-for-work-locale-ca-es",15522:"survey-locale-lt-lt",15523:"teams-and-channels-locale-ar-sa",15580:"esp-locale-es-mx",15633:"sht-searchanswerteamsstrings_es-bn-bd",15657:"meet-for-work-locale-ko-kr",15682:"video-message-locale-de-de",15750:"school-locale-ca-es-valencia",15783:"files-locale-nb-no",15793:"services-share",15798:"artifacts-platform-locale-fi-fi",15806:"fns81",15837:"audience-view-dialog-locale-uk-ua",15905:"meeting-bot-locale-hu-hu",15923:"platform-app-service",15943:"InformationProtectionStrings12",15953:"sht-cortextopictypeswebstrings_is",15999:"recurrence-locale-nl-nl",16014:"services-translate",16037:"sht-searchanswerteamsstrings_es-it",16045:"esp-locale-zh-tw",16089:"audience-view-dialog-locale-gl-es",16095:"hostUxStrings42",16147:"components-screen-recorder102",16151:"services-people",16205:"services-ai-insights-sds",16211:"main-locale-fi-fi",16266:"InformationProtectionStrings28",16267:"sht-cortextopictypeswebstrings_it",16290:"virtualEvents-locale-kk-kz",16312:"smart-device-locale-sl-si",16313:"services-people-picker",16316:"hostUxStrings53",16347:"calling-meeting-details-panel",16356:"fa-IR-comment-pane-strings-jsonOfficeOnlineStringResource",16366:"data-resolvers-chat",16419:"metaos-core",16436:"ko-strings-jsonThinRes",16478:"teams-and-channels-locale-sk-sk",16487:"calendar-locale-el-gr",16489:"sht-cortextopictypeswebstrings_sr-cyrl",16523:"otlang104",16571:"discover-surface-locale-pt-br",16611:"nn-np-strings-jsonThinRes",16622:"meetingFlyout-locale-vi-vn",16676:"semantic-object-locale-ca-es",16682:"virtualEvents-locale-lv-lv",16687:"otlang46",16702:"services-calling-service-adapters",16703:"meet-for-work-locale-eu-es",16705:"meeting-analytics-locale-ja-jp",16733:"P2PFilesListEmptyStateView",16734:"th-strings-jsonThinRes",16746:"gallery-locale-hr-hr",16791:"freemium-upgrade-locale-pt-pt",16804:"webinar-locale-az-latn-az",16877:"az-Latn-AZ-UiStrings-json",16907:"components-screen-recorder76",16918:"teams-and-channels-locale-uk-ua",16948:"create-team-view",16953:"categories-lv-lv-json",16981:"InformationProtectionStrings72",17002:"messaging-locale-ro-ro",17031:"otlang11",17044:"teams-and-channels-locale-da-dk",17097:"data-resolvers-azure-maps",17107:"summaryModule",17121:"breakoutRooms-locale-zh-cn",17124:"school-locale-tr-tr",17133:"camera-effects-panel",17142:"webrec2-language-sr-latn-rs",17220:"fns28",17233:"InformationProtectionStrings54",17253:"calendar-locale-eu-es",17263:"components-screen-recorder28",17270:"meeting-room-console-locale-ru-ru",17274:"video-capture-locale-da-dk",17285:"messaging-locale-nl-nl",17293:"recurrence-locale-pt-br",17297:"onecamera-locale-da",17298:"hostDefaultsStrings41",17341:"services-io-apps-monet",17342:"extensibility-locale-cs-cz",17400:"data-resolvers-meeting-options",17410:"sht-searchanswerteamsstrings_es-sq",17418:"recurrence-locale-ro-ro",17428:"meeting-room-console-locale-pt-pt",17434:"artifacts-platform-locale-hu-hu",17439:"otlang57",17475:"files-locale-ja-jp",17495:"onecamera-locale-sr-cyrl-rs",17502:"da-DK-comment-pane-strings-jsonOfficeOnlineStringResource",17530:"attendee-view-app",17542:"calling-locale-lv-lv",17557:"otlang53",17583:"sht-cortextopictypeswebstrings_nl",17589:"meeting-options-locale-ca-es",17601:"onecamera-locale-fr-ca",17624:"hostUxStrings62",17638:"semantic-object-locale-ca-es-valencia",17652:"files-locale-hr-hr",17662:"recurrence-locale-nn-no",17692:"video-message-locale-nb-no",17695:"breakoutRooms-locale-id-id",17704:"discover-surface-locale-ca-es",17706:"health-locale-fr-fr",17716:"fns24",17726:"meeting-room-console-locale-pt-br",17734:"biometric-enrollment-locale-cy-gb",17794:"broadcast-locale-fr-fr",17795:"message-escalate-dialog-locale-lt-lt",17797:"esp-locale-en-us",17805:"fns70",17828:"audience-view-dialog-locale-en-gb",17844:"webrec2-language-en-gb",17902:"data-resolvers-teams-meeting-policies",17957:"otlang2",17965:"services-instant-answers",17968:"extensibility-locale-fi-fi",17984:"esp-locale-it-it",17994:"sht-cortextopictypeswebstrings_as-in",18026:"search-locale-ka-ge",18035:"meeting-lock-back-image",18129:"diagnostics-panel-renderer",18130:"meeting-bot-locale-nl-nl",18143:"meeting-room-console-locale-zh-cn",18168:"notesComponentUx",18170:"categories-pt-pt-json",18185:"meet-for-work-locale-es-mx",18223:"document-creator",18228:"people-targeting-locale-gl-es",18254:"hostDefaultsStrings56",18344:"categories-nso-za-json",18364:"broadcast-locale-cy-gb",18404:"meeting-bot-locale-sk-sk",18418:"esp-locale-kk-kz",18436:"or-IN-comment-pane-strings-jsonOfficeOnlineStringResource",18484:"bg-strings-jsonThinRes",18491:"hostUxStrings21",18500:"chat-list-apollo",18529:"video-capture-locale-pt-br",18639:"connected-calendar-app",18642:"onecamera-locale-kk",18698:"mk-MK-UiStrings-json",18719:"categories-ca-es-json",18761:"meeting-bot-locale-pl-pl",18773:"message-escalate-dialog",18797:"ro-strings-jsonThinRes",18809:"meeting-bot-locale-uk-ua",18815:"data-resolvers-transcript-feedback",18846:"share-email-locale-sr-latn-rs",18884:"data-resolvers-implicit-contacts",18893:"video-capture-locale-nl-nl",18898:"lt-strings-jsonThinRes",18927:"channels-locale-lt-lt",18950:"hostDefaultsStrings1",18997:"virtualEvents-locale-sr-latn-rs",19002:"components-screen-recorder70",19050:"audience-view-dialog-locale-nl-nl",19078:"survey-locale-zh-tw",19098:"smart-device-locale-de-de",19109:"meeting-analytics-locale-zh-cn",19135:"teams-and-channels-locale-fr-ca",19161:"services-search-substrate",19163:"meet-for-work-locale-sq-al",19210:"InformationProtectionStrings1",19211:"services-transcript-settings-store",19212:"aRes48",19220:"audience-view-dialog-locale-hu-hu",19233:"message-escalate-dialog-locale-es-es",19237:"people-targeting-locale-zh-tw",19318:"data-resolvers-whats-new",19319:"emoji-one-service",19330:"hostUxStrings36",19353:"survey-locale-fi-fi",19371:"meet-for-work-locale-fi-fi",19374:"virtualEvents-locale-cs-cz",19389:"wiki-locale-he-il",19420:"fr-FR-UiStrings-json",19433:"sr-Cyrl-RS-UiStrings-json",19493:"school-locale-ro-ro",19495:"semantic-object-locale-zh-tw",19499:"otlang59",19521:"esp-locale-et-ee",19534:"broadcast-locale-lt-lt",19562:"audience-view-dialog-locale-bg-bg",19599:"meeting-options-locale-sr-latn-rs",19676:"categories-rw-rw-json",19707:"aRes40",19714:"smart-device-locale-uk-ua",19735:"meet-for-work-locale-sr-latn-rs",19753:"gallery-app",19778:"data-resolvers-esp",19825:"webrec2-language-hr",19853:"fns73",19856:"recurrence-locale-ko-kr",19870:"tr-strings-jsonThinRes",19908:"InformationProtectionStrings36",19974:"onecamera-locale-pt-pt",19997:"components-screen-recorder21",20012:"categories-ru-ru-json",20029:"channels-locale-az-latn-az",20047:"hostUxStrings71",20058:"data-resolvers-activity-settings",20132:"calendar-locale-cs-cz",20155:"hostDefaultsStrings42",20158:"broadcast-locale-nl-nl",20188:"services-broadcast-streaming-attendee",20267:"people-targeting-locale-ja-jp",20272:"categories-te-in-json",20274:"meeting-room-console-locale-bg-bg",20295:"health-locale-nb-no",20323:"main-locale-hu-hu",20351:"share-email-locale-fil-ph",20356:"hostDefaultsStrings72",20397:"webinar-locale-nl-nl",20401:"message-escalate-dialog-locale-hi-in",20406:"fns60",20427:"calling-app-prejoin-v1",20443:"people-targeting-locale-en-us",20464:"sharedServicesRest",20499:"otlang32",20516:"services-meeting-options",20538:"search-locale-en-us",20545:"biometric-enrollment-locale-ja-jp",20573:"semantic-object-locale-nb-no",20668:"meeting-room-console-locale-th-th",20672:"services-bots-platform",20702:"message-escalate-dialog-locale-id-id",20718:"content-bubble-container",20741:"gallery-locale-uk-ua",20749:"spaces",20756:"en-US-comment-pane-strings-jsonOfficeOnlineStringResource",20764:"InformationProtectionStrings25",20765:"components-screen-recorder110",20862:"uz-Latn-UZ-comment-pane-strings-jsonOfficeOnlineStringResource",20873:"sr-cyrl-rs-strings-jsonThinRes",20904:"recurrence-locale-pl-pl",20930:"gum-modal",20933:"communities-empty-state",20945:"health-locale-sl-si",20948:"gallery-locale-sq-al",20957:"broadcast-locale-et-ee",20965:"components-calendar-peek-view-attachments",20998:"webrec2-language-vi",21033:"broadcast-locale-es-es",21083:"semantic-object-locale-mk-mk",21103:"wiki-locale-ca-es",21112:"hostUxStrings25",21141:"categories-eu-es-json",21167:"extensibility-locale-nl-nl",21174:"services-esp",21181:"kn-IN-UiStrings-json",21209:"bridge-migration-components-calendar",21247:"webrec2-language-bs-latn-ba",21264:"hostUxStrings30",21311:"breakoutRooms-locale-kk-kz",21346:"survey-locale-fil-ph",21372:"webinar-locale-en-us",21477:"InformationProtectionStrings73",21514:"share-email-locale-de-de",21529:"components-screen-recorder88",21541:"pluginComment",21555:"smart-device-locale-es-mx",21558:"freemium-upgrade-locale-fr-fr",21571:"fns68",21590:"am-ET-comment-pane-strings-jsonOfficeOnlineStringResource",21632:"messaging-locale-az-latn-az",21647:"message-escalate-dialog-locale-en-gb",21672:"sht-searchanswerteamsstrings_es-lv",21689:"files-locale-da-dk",21705:"extensibility-locale-ca-es",21706:"data-schema-cdl",21777:"calendar-locale-he-il",21786:"gallery-locale-mk-mk",21822:"breakoutRooms-locale-el-gr",21833:"calling-locale-gl-es",21836:"services-address",21838:"cast-locale-et-ee",21868:"webrec2-language-cy-gb",21933:"cast-locale-zh-tw",21941:"health-locale-fi-fi",21978:"calendar-locale-mk-mk",21985:"InformationProtectionStrings62",21993:"meeting-analytics-locale-nb-no",22012:"files-locale-th-th",22042:"breakoutRooms-locale-en-gb",22064:"esp-locale-uk-ua",22099:"store-fre-modal",22121:"services-file-upload",22125:"calendar-locale-fi-fi",22194:"coach-report-locale-cs-cz",22312:"broadcast-locale-nb-no",22321:"wiki-locale-lv-lv",22348:"fns42",22410:"discover-surface-locale-th-th",22413:"teams-and-channels-locale-he-il",22423:"calendar-locale-ja-jp",22452:"InformationProtectionStrings51",22460:"flipcameralkg",22463:"platform-app-deeplink-to-sidepanel-execute",22479:"ot",22487:"fns10",22499:"fns46",22540:"data-resolvers-browser-lms-integration",22555:"cast-locale-hr-hr",22581:"services-lms-integration",22592:"sht-cortextopictypeswebstrings_mt-mt",22616:"data-resolvers-people-avatar",22628:"share-email-locale-pl-pl",22670:"meeting-bot-locale-ro-ro",22750:"meetingFlyout-locale-pl-pl",22764:"onecamera-locale-cy",22765:"deferredoperations",22767:"sht-cortextopictypeswebstrings_cs",22799:"guardians-locale-el-gr",22803:"files-locale-pl-pl",22842:"esp-locale-ka-ge",22857:"fns61",22928:"meetingFlyout-locale-fil-ph",22938:"vi-VN-comment-pane-strings-jsonOfficeOnlineStringResource",22991:"smart-device-locale-th-th",22999:"recurrence-locale-hi-in",23017:"onecamera-locale-fi",23020:"files-locale-fi-fi",23025:"search-locale-uk-ua",23035:"biometric-enrollment-locale-fi-fi",23041:"meet-for-work-locale-et-ee",23046:"breakoutRooms-locale-hu-hu",23063:"meeting-recap-locale-da-dk",23065:"search-locale-vi-vn",23088:"services-invite-links",23134:"sht-cortextopictypeswebstrings_vi",23169:"semantic-object-locale-ka-ge",23172:"chat-pane-image",23186:"freemium-upgrade-locale-ar-sa",23190:"main-locale-nn-no",23246:"guardians-locale-eu-es",23264:"health-locale-ca-es",23280:"recurrence-locale-da-dk",23283:"meet-for-work-locale-pl-pl",23293:"fns75",23308:"freemium-upgrade-locale-uk-ua",23363:"services-scis",23400:"messaging-locale-sq-al",23402:"esp-locale-is-is",23493:"broadcast-locale-th-th",23516:"messaging-locale-ka-ge",23540:"channels-locale-sk-sk",23552:"meeting-recap-locale-sl-si",23655:"freemium-upgrade-locale-eu-es",23675:"errorConverter",23747:"fns2",23762:"calling-locale-el-gr",23794:"search-locale-hi-in",23812:"share-email-locale-nn-no",23828:"webrec2-wasmcv",23859:"audience-view-dialog-locale-es-mx",23871:"artifacts-platform-locale-az-latn-az",23890:"hostUxStrings17",23891:"teams-and-channels-locale-ja-jp",23893:"breakoutRooms-locale-en-us",23921:"categories-si-lk-json",23924:"phone-number-service",23935:"services-developer-switchers",23954:"gallery-locale-ru-ru",23968:"survey-locale-is-is",23989:"data-resolvers-mru",24013:"recurrence-locale-sr-latn-rs",24014:"tt-RU-comment-pane-strings-jsonOfficeOnlineStringResource",24053:"otlang28",24073:"messaging-locale-sr-latn-rs",24092:"recurrence-locale-az-latn-az",24149:"guardians-locale-kk-kz",24179:"messaging-locale-cy-gb",24197:"fluid-compose-container",24251:"services-meeting-recap",24278:"main-locale-eu-es",24282:"sht-cortextopictypeswebstrings_lo-la",24333:"sht-searchanswerteamsstrings_es-be-by",24364:"audience-view-dialog-locale-nb-no",24417:"breakoutRooms-locale-cs-cz",24444:"teams-and-channels-locale-cy-gb",24473:"wiki-locale-sv-se",24489:"hostDefaultsStrings14",24493:"video-capture-locale-fr-ca",24516:"message-escalate-dialog-locale-sk-sk",24526:"callable-channels-app",24541:"components-screen-recorder100",24556:"categories-sr-Cyrl-RS-json",24572:"health-locale-it-it",24625:"fr-ca-strings-jsonThinRes",24632:"hostUxStrings7",24657:"school-locale-pt-br",24665:"recurrence-locale-tr-tr",24677:"people-targeting-locale-az-latn-az",24764:"artifacts-platform-locale-zh-cn",24820:"hostDefaultsStrings16",24823:"otlang41",24860:"channels-locale-uk-ua",24924:"id-ID-comment-pane-strings-jsonOfficeOnlineStringResource",24925:"config-gcc",24937:"main-locale-en-gb",24944:"meetingFlyout-locale-sq-al",25026:"channels-locale-lv-lv",25066:"fr-CA-UiStrings-json",25067:"calendar-meeting-recommendations",25110:"broadcast-locale-vi-vn",25121:"meeting-attendance-teams-app-wrapper",25145:"fluid-debugger",25175:"sht-searchanswerteamsstrings_es-gu",25181:"docxDocument",25256:"tk-TM-comment-pane-strings-jsonOfficeOnlineStringResource",25268:"wiki-locale-hu-hu",25270:"data-resolvers-store",25312:"recurrence-locale-it-it",25343:"sb-config",25350:"categories-th-th-json",25375:"data-resolvers-view-schema",25383:"smart-device-locale-ca-es",25409:"hostDefaultsStrings12",25442:"survey-locale-vi-vn",25447:"hostDefaultsStrings83",25459:"services-mesh-session",25471:"messaging-locale-nb-no",25502:"virtualEvents-locale-nn-no",25509:"search-locale-sl-si",25532:"share-email-locale-cs-cz",25570:"breakoutRooms-locale-hr-hr",25575:"fns37",25580:"video-capture-locale-he-il",25585:"data-resolvers-channel-info-pane",25604:"header-search-input-container",25606:"message-escalate-dialog-locale-th-th",25612:"zh-CN-UiStrings-json",25622:"main-locale-ar-sa",25659:"channel-dashboard",25700:"meeting-bot-locale-pt-br",25702:"InformationProtectionStrings80",25841:"components-screen-recorder106",25891:"sht-cortextopictypeswebstrings_zh-hant",25901:"InformationProtectionStrings64",25938:"aRes35",25970:"categories-sq-al-json",26025:"channels-locale-es-es",26124:"data-resolvers-browser-webinar",26192:"hy-AM-comment-pane-strings-jsonOfficeOnlineStringResource",26205:"hostUxStrings45",26263:"teams-and-channels-locale-cs-cz",26332:"survey-locale-nb-no",26340:"splash-screen",26354:"health-locale-id-id",26442:"pluginMeetingCatchup",26443:"InformationProtectionStrings76",26444:"video-message-locale-th-th",26445:"fns14",26447:"teams-and-channels-locale-ro-ro",26510:"broadcast-qna",26525:"sht-searchanswerteamsstrings_es-ca",26553:"InformationProtectionStrings26",26610:"sht-searchanswerteamsstrings_es-de",26717:"fns18",26756:"data-resolvers-browser-notifications-settings",26759:"data-resolvers-pstn",26811:"smart-device-locale-ko-kr",26816:"survey-locale-he-il",26819:"teams-and-channels-locale-en-us",26822:"files-locale-es-mx",26828:"files-locale-fr-ca",26841:"freemium-upgrade-locale-en-gb",26842:"core-services-settings-debug",26858:"messaging-locale-lv-lv",26884:"health-locale-de-de",26886:"video-message-locale-fi-fi",26916:"share-email-locale-eu-es",26917:"wiki-locale-hr-hr",26924:"ug-CN-UiStrings-json",26934:"services-discover-surface",26946:"video-message-locale-eu-es",26958:"cast-locale-uk-ua",26960:"sht-lpc",27005:"html2canvas",27006:"school-locale-el-gr",27013:"InformationProtectionStrings24",27029:"fr-CA-comment-pane-strings-jsonOfficeOnlineStringResource",27030:"meeting-options-locale-pl-pl",27075:"ar-SA-UiStrings-json",27109:"hostDefaultsStrings51",27112:"breakoutRooms-locale-lt-lt",27133:"data-resolvers-developer-switchers",27172:"search-locale-sq-al",27199:"main-locale-sk-sk",27202:"discover-surface-locale-lv-lv",27214:"teams-and-channels-locale-nn-no",27217:"meeting-options-locale-zh-cn",27245:"onecamera-locale-zh-hant",27246:"message-escalate-dialog-locale-zh-cn",27269:"recurrence-locale-hu-hu",27310:"coach-report-locale-et-ee",27386:"components-screen-recorder42",27455:"gallery-locale-zh-cn",27488:"discover-surface-entry-lazy",27490:"data-resolvers-browser-voicemail",27513:"sht-cortextopictypeswebstrings_ro",27521:"search-locale-zh-tw",27573:"config-ag08",27593:"health-locale-ja-jp",27639:"people-targeting-locale-ca-es",27648:"breakoutRooms-locale-ca-es",27662:"files-locale-en-gb",27782:"wiki-locale-cy-gb",27810:"video-capture-locale-nn-no",27853:"hostDefaultsStrings73",27910:"guardians-locale-hu-hu",27946:"aRes6",27947:"el-GR-UiStrings-json",27954:"survey-locale-ka-ge",27959:"artifacts-platform-locale-en-gb",27986:"sb-activated",28048:"fns50",28087:"meeting-options-locale-fr-fr",28135:"meeting-room-console-locale-hu-hu",28178:"discover-surface-locale-et-ee",28186:"sht-cortextopictypeswebstrings_fi",28205:"channels-locale-hr-hr",28224:"components-screen-recorder48",28242:"hostDefaultsStrings5",28254:"guardians-locale-ru-ru",28256:"meeting-options-locale-ka-ge",28281:"webrec2-language-ka",28299:"oneTranscriptPluginRoot",28394:"sht-searchanswerteamsstrings_es-uz",28395:"school-locale-sl-si",28400:"channels-locale-es-mx",28410:"freemium-upgrade-locale-sv-se",28420:"msal2-service",28433:"discover-surface-locale-en-us",28437:"teams-and-channels-locale-fi-fi",28443:"sht-searchanswerteamsstrings_es-fil",28457:"otlang90",28471:"otlang56",28488:"webinar-locale-bg-bg",28489:"breakoutRooms-locale-tr-tr",28497:"hostUxStrings79",28505:"freemium-upgrade-locale-lv-lv",28508:"pstn-dialog-manager",28549:"freemium-upgrade-locale-ca-es",28560:"services-broadcast-captions",28564:"et-EE-UiStrings-json",28582:"meet-for-work-locale-nn-no",28584:"sht-cortextopictypeswebstrings_fr",28673:"sht-searchanswerteamsstrings_es-tk-tm",28716:"extensibility-locale-th-th",28729:"share-form",28746:"audience-view-dialog-locale-zh-cn",28749:"video-message-locale-gl-es",28767:"sht-cortextopictypeswebstrings_lv",28812:"share-tray",28830:"wiki-locale-en-gb",28846:"quz-PE-UiStrings-json",28853:"video-message-locale-es-mx",28859:"meetingFlyout-locale-lt-lt",28862:"esp-locale-tr-tr",28992:"sht-cortextopictypeswebstrings_ru",29e3:"kok-IN-comment-pane-strings-jsonOfficeOnlineStringResource",29025:"sht-cortextopictypeswebstrings_pl",29046:"esp-locale-hi-in",29095:"categories-id-id-json",29117:"sht-cortextopictypeswebstrings_pt-pt",29118:"meeting-room-front-of-room-container",29122:"share-email-locale-mk-mk",29144:"categories-rm-ch-json",29180:"data-resolvers-browser-tenant-privacy",29188:"ka-strings-jsonThinRes",29290:"meeting-room-console-locale-eu-es",29323:"InformationProtectionStrings78",29357:"meeting-bot-locale-hr-hr",29367:"message-escalate-dialog-locale-hu-hu",29401:"people-targeting-locale-lt-lt",29405:"button-grid-overlay-renderer",29407:"artifacts-platform-locale-el-gr",29453:"artifacts-platform-locale-pl-pl",29475:"esp-locale-el-gr",29477:"cast-locale-el-gr",29497:"extensibility-locale-ko-kr",29533:"hostUxStrings38",29539:"sht-cortextopictypeswebstrings_el",29559:"meeting-room-console-locale-lt-lt",29569:"messaging-locale-lt-lt",29709:"config-ag09",29722:"data-resolvers-transcript",29731:"cast-locale-eu-es",29735:"uiManager",29741:"guardians-locale-pt-br",29780:"categories-tr-tr-json",29782:"channels-locale-ro-ro",29813:"meeting-analytics-locale-vi-vn",29837:"gallery-locale-is-is",29844:"webrec2-language-lt",29861:"guardians-app",29881:"InformationProtectionStrings46",29884:"categories-ig-ng-json",29922:"teams-and-channels-locale-hi-in",29942:"hostDefaultsStrings11",29945:"ca-Es-VALENCIA-comment-pane-strings-jsonOfficeOnlineStringResource",29955:"meet-for-work-locale-id-id",29959:"components-screen-recorder108",29961:"services-virtual-events",30005:"artifacts-platform-locale-zh-tw",30018:"school-locale-es-es",30038:"data-resolvers-browser-calendar",30040:"unified-bar-container-manager",30078:"search-locale-eu-es",30087:"data-resolvers-bots-platform",30092:"artifacts-platform-locale-mk-mk",30100:"meeting-recap-locale-uk-ua",30150:"sht-cortextopictypeswebstrings_pt",30168:"sht-searchanswerteamsstrings_es-fa",30174:"hostDefaultsStrings35",30185:"cast-locale-es-es",30191:"gallery-locale-ca-es-valencia",30206:"hostDefaultsStrings9",30216:"sht-cortextopictypeswebstrings_ms",30217:"health-locale-zh-tw",30235:"teams-and-channels-locale-bg-bg",30236:"school-locale-az-latn-az",30242:"teams-and-channels-locale-pt-br",30288:"services-sharepoint-share",30291:"calling-locale-zh-cn",30313:"InformationProtectionStrings70",30318:"hostDefaultsStrings27",30321:"sht-cortextopictypeswebstrings_quz-pe",30384:"ImmerES5Plugin",30420:"video-message-locale-sr-latn-rs",30480:"InformationProtectionStrings45",30588:"share-email-locale-cy-gb",30590:"recurrence-locale-de-de",30637:"webinar-locale-pt-br",30669:"virtualEvents-locale-fr-fr",30702:"hostUxStrings0",30748:"meetingFlyout-locale-eu-es",30778:"repIssue",30783:"teams-and-channels-locale-th-th",30817:"pluginAboutVideo",30864:"channels-locale-ja-jp",30922:"gallery-locale-hi-in",30972:"coach-report-locale-bg-bg",30977:"meeting-recap-locale-tr-tr",31e3:"sht-searchanswerteamsstrings_es-mk",31044:"es-mx-strings-jsonThinRes",31063:"components-screen-recorder66",31081:"otlang98",31167:"guardians-locale-sl-si",31192:"data-resolvers-dynamics-marketing",31210:"pluginShare",31245:"video-message-locale-is-is",31251:"file-hasher",31286:"meetingFlyout-locale-ar-sa",31304:"virtualEvents-locale-sv-se",31353:"audience-view-dialog-locale-tr-tr",31354:"channels-locale-tr-tr",31374:"calling-locale-sv-se",31402:"people-targeting-locale-ca-es-valencia",31433:"meet-for-work-locale-is-is",31503:"ne-NP-UiStrings-json",31506:"search-locale-zh-cn",31513:"school-locale-ar-sa",31527:"health-locale-pl-pl",31538:"InformationProtectionStrings22",31543:"meeting-bot-locale-cs-cz",31597:"breakoutRooms-locale-is-is",31624:"extensibility-locale-el-gr",31702:"nb-no-strings-jsonThinRes",31811:"biometric-enrollment-locale-ko-kr",31835:"pt-PT-comment-pane-strings-jsonOfficeOnlineStringResource",31908:"esp-locale-gl-es",31953:"audience-view-dialog-locale-fr-fr",31963:"calling-locale-th-th",31967:"sht-cortextopictypeswebstrings_bn-bd",31986:"hostUxStrings74",32022:"freemium-upgrade-locale-ka-ge",32023:"fns11",32034:"services-connected-accounts",32057:"viewimages",32071:"messaging-locale-en-gb",32076:"main-locale-cs-cz",32085:"people-targeting-locale-nl-nl",32093:"sht-cortextopictypeswebstrings_mn-mn",32106:"gallery-locale-de-de",32190:"video-message-locale-zh-tw",32226:"sht-cortextopictypeswebstrings_lt",32238:"sht-cortextopictypeswebstrings_es-mx",32240:"data-resolvers-app-suggestions",32241:"video-capture-locale-mk-mk",32323:"onecamera-locale-sl",32334:"react-virtualized-tree-list",32381:"freemium-upgrade-locale-hu-hu",32420:"virtualEvents-locale-ka-ge",32426:"biometric-enrollment-locale-sr-latn-rs",32521:"pa-IN-UiStrings-json",32528:"codemirror",32529:"data-resolvers-import-msa-contacts",32610:"meeting-recap-locale-pl-pl",32647:"is-IS-comment-pane-strings-jsonOfficeOnlineStringResource",32651:"survey-locale-ca-es",32653:"video-capture-locale-tr-tr",32673:"meeting-recap-locale-zh-cn",32719:"webinar-locale-ka-ge",32724:"health-locale-he-il",32751:"video-capture-locale-et-ee",32897:"esp-locale-nb-no",32966:"sht-cortextopictypeswebstrings_sq",32978:"data-resolvers-apps-usage",33014:"wiki-locale-az-latn-az",33025:"fns56",33075:"biometric-enrollment-locale-hr-hr",33097:"components-calendar-app-host",33105:"webinar-locale-en-gb",33112:"health-locale-zh-cn",33139:"artifacts-platform-locale-is-is",33172:"pluginChaptering",33176:"sht-searchanswerteamsstrings_es-prs",33181:"msteams/data-view-schema",33199:"meetingFlyout-locale-es-es",33206:"categories-kk-kz-json",33238:"health-locale-pt-pt",33282:"sht-searchanswerteamsstrings_es-bs-latn-ba",33346:"meeting-options-locale-nb-no",33371:"teams-and-channels-locale-zh-cn",33418:"video-capture-locale-pl-pl",33454:"webinar-locale-es-mx",33477:"coach-report-locale-zh-cn",33485:"channels-locale-nn-no",33488:"esp-locale-lt-lt",33526:"share-meeting-search",33560:"artifacts-platform-locale-bg-bg",33580:"calendar-locale-en-gb",33586:"apps-linkedin",33603:"gallery-locale-ja-jp",33611:"calling-locale-tr-tr",33637:"channels-locale-hu-hu",33642:"hostUxStrings3",33665:"esp-locale-eu-es",33684:"sht-searchanswerteamsstrings_es-bn-in",33738:"meeting-room-console-locale-ko-kr",33745:"data-resolvers-connectors",33754:"video-capture-locale-id-id",33772:"channels-locale-th-th",33829:"oneTranscriptSettings",33884:"biometric-enrollment-locale-da-dk",33885:"services-app-suggestions",33925:"recurrence-locale-el-gr",33981:"semantic-object-locale-gl-es",33987:"wiki-locale-gl-es",34e3:"hostDefaultsStrings0",34027:"school-locale-es-mx",34055:"messaging-locale-fil-ph",34067:"prs-af-strings-jsonThinRes",34096:"mi-NZ-comment-pane-strings-jsonOfficeOnlineStringResource",34125:"services-cloud-storage-folders",34179:"esp-locale-fr-fr",34249:"meeting-room-entry",34250:"biometric-enrollment-locale-uk-ua",34255:"webinar-locale-lv-lv",34257:"webinar-locale-gl-es",34258:"es-MX-comment-pane-strings-jsonOfficeOnlineStringResource",34279:"people-targeting-locale-nb-no",34287:"survey-locale-ar-sa",34322:"files-locale-vi-vn",34349:"calling-locale-hi-in",34379:"people-targeting-locale-th-th",34425:"messaging-locale-vi-vn",34496:"main-locale-gl-es",34508:"artifacts-platform-locale-ar-sa",34518:"categories-pl-pl-json",34526:"school-locale-ka-ge",34544:"webrec2-language-sv",34548:"extensibility-locale-sl-si",34595:"data-resolvers-sensitivity-label",34602:"components-screen-recorder37",34626:"health-locale-ca-es-valencia",34632:"discover-surface-locale-hi-in",34648:"coach-report-locale-ja-jp",34652:"main-locale-nl-nl",34653:"data-resolvers-callable-channel",34672:"meeting-room-console-locale-ar-sa",34692:"services-chat-endpoint-provider",34697:"sv-strings-jsonThinRes",34869:"biometric-enrollment-locale-lv-lv",34871:"hostDefaultsStrings64",34882:"data-schema",34884:"calendar-locale-id-id",34918:"virtualEvents-locale-ar-sa",34949:"services-implicit-contacts",34966:"meet-for-work-locale-fr-ca",35004:"channels-locale-fi-fi",35020:"meeting-analytics-locale-ca-es",35024:"webrec2-language-eu",35066:"onecamera-locale-gl",35106:"school-locale-hi-in",35108:"pluginOT",35110:"survey-locale-ja-jp",35132:"onecamera-locale-nn-no",35185:"meetingFlyout-locale-sv-se",35208:"lt-LT-UiStrings-json",35241:"data-resolvers-browser-teams",35255:"sr-Latn-RS-UiStrings-json",35346:"audience-view-dialog-locale-nn-no",35364:"InformationProtectionStrings39",35376:"message-escalate-dialog-locale-es-mx",35391:"wiki-locale-eu-es",35392:"biometric-enrollment-locale-tr-tr",35409:"channels-locale-pt-pt",35413:"components-stream-camera",35430:"services-external-accounts-response",35479:"virtualEvents-locale-sk-sk",35512:"data-resolvers-platform-tabs-state",35551:"recurrence-locale-lt-lt",35568:"recurrence-locale-kk-kz",35575:"onecamera-locale-en-gb",35577:"cast-locale-cs-cz",35587:"aRes31",35588:"calling-locale-sl-si",35592:"otlang54",35626:"share-email-locale-en-us",35668:"InformationProtectionStrings47",35677:"otlang76",35731:"breakoutRooms-locale-lv-lv",35795:"gl-strings-jsonThinRes",35805:"calendar-compose-box-v2",35821:"gallery-locale-tr-tr",35833:"people-targeting-locale-hi-in",35865:"fns29",35913:"webrec2-language-pt-br",35921:"main-locale-zh-tw",35940:"cast-locale-fr-ca",35964:"discover-surface-locale-de-de",36009:"components-screen-recorder16",36018:"meeting-recap-locale-bg-bg",36037:"webrec2-language-lv",36058:"InformationProtectionStrings31",36133:"otlang23",36142:"extensibility-locale-sk-sk",36153:"guardians-locale-es-es",36173:"hostDefaultsStrings32",36217:"calling-broadcast-container",36227:"broadcast-locale-hi-in",36279:"meetingFlyout-locale-zh-tw",36333:"school-locale-da-dk",36391:"ta-IN-comment-pane-strings-jsonOfficeOnlineStringResource",36397:"main-locale-de-de",36406:"calendar-locale-nl-nl",36416:"video-capture-locale-uk-ua",36447:"wiki-locale-is-is",36477:"azuremediaplayer",36537:"calendar-locale-en-us",36540:"video-capture-locale-ja-jp",36552:"components-screen-recorder10",36608:"virtualEvents-locale-hi-in",36644:"virtualEvents-locale-ru-ru",36665:"InformationProtectionStrings16",36688:"school-locale-is-is",36714:"fns74",36720:"breakoutRooms-locale-mk-mk",36730:"cy-GB-comment-pane-strings-jsonOfficeOnlineStringResource",36759:"onecamera-locale-hi",36783:"meetingFlyout-locale-el-gr",36794:"messaging-locale-mk-mk",36821:"meeting-options-locale-en-gb",36848:"sre-basics",36854:"virtualEvents-locale-pl-pl",36856:"broadcast-locale-sl-si",36980:"coach-report-locale-ro-ro",37025:"teams-and-channels-locale-zh-tw",37085:"sht-cortextopictypeswebstrings_hy",37102:"InformationProtectionStrings18",37106:"audience-view-dialog-locale-ru-ru",37123:"audience-view-dialog-locale-da-dk",37131:"semantic-object-locale-he-il",37209:"hostUxStrings77",37232:"guardians-locale-ca-es",37249:"biometric-enrollment-locale-fr-fr",37252:"audience-view-dialog-locale-en-us",37288:"sht-cortextopictypeswebstrings_et",37301:"data-resolvers-files",37310:"meet-for-work-locale-pt-pt",37342:"services-viva-insights",37364:"esp-locale-fi-fi",37378:"webinar-locale-uk-ua",37390:"recurrence-locale-en-gb",37398:"video-capture-locale-en-gb",37425:"InformationProtectionStrings17",37436:"meet-for-work-locale-cs-cz",37437:"cast-locale-id-id",37446:"biometric-enrollment-locale-pt-br",37458:"recurrence-locale-ja-jp",37472:"meeting-analytics-locale-sv-se",37481:"components-screen-recorder34",37514:"search-locale-tr-tr",37559:"onecamera-locale-fil",37572:"sht-searchanswerteamsstrings_es-gl",37589:"meeting-analytics-locale-hu-hu",37591:"hostDefaultsStrings69",37671:"sre-experimental",37673:"hostUxStrings44",37689:"meeting-analytics-locale-mk-mk",37693:"wiki-locale-lt-lt",37754:"calling-locale-ru-ru",37762:"messaging-locale-sk-sk",37784:"coach-report-locale-sq-al",37793:"fns19",37811:"cast-locale-fr-fr",37813:"sht-searchanswerteamsstrings_es-nn-no",37827:"communities-create-plus-dialogContent",37965:"esp-locale-th-th",38001:"discover-surface-locale-ko-kr",38002:"video-capture-locale-nb-no",38008:"discover-surface-locale-mk-mk",38021:"webinar-locale-sk-sk",38082:"wiki-locale-ar-sa",38090:"categories-ms-my-json",38174:"as-IN-comment-pane-strings-jsonOfficeOnlineStringResource",38195:"meetingFlyout-locale-fr-fr",38221:"school-locale-hr-hr",38257:"ga-IE-comment-pane-strings-jsonOfficeOnlineStringResource",38259:"categories-pt-br-json",38261:"webinar-locale-es-es",38299:"onecamera-locale-sk",38355:"biometric-enrollment-locale-zh-cn",38398:"noiseSuppressionMediaSettings",38430:"sv-SE-comment-pane-strings-jsonOfficeOnlineStringResource",38431:"services-suggestions",38437:"main-locale-mk-mk",38452:"categories-xh-za-json",38457:"channels-locale-ar-sa",38461:"esp-locale-sk-sk",38535:"sht-cortextopictypeswebstrings_ha-latn-ng",38542:"pluginChat",38552:"recurrence-locale-fr-fr",38564:"FluidFramework-HashFallback",38576:"hostDefaultsStrings74",38586:"categories-uk-ua-json",38652:"semantic-object-locale-bg-bg",38653:"broadcast-locale-ka-ge",38685:"survey-locale-sk-sk",38693:"webinar-locale-lt-lt",38694:"channels-locale-zh-tw",38699:"search-locale-nb-no",38746:"hu-HU-comment-pane-strings-jsonOfficeOnlineStringResource",38756:"meeting-room-console-locale-hr-hr",38783:"components-screen-recorder12",38806:"people-targeting-locale-sk-sk",38820:"artifacts-platform-locale-eu-es",38840:"message-escalate-dialog-locale-sr-latn-rs",38860:"webrec2-language-uk",38883:"es-strings-jsonThinRes",38885:"calendar-locale-es-mx",38957:"video-capture-locale-lv-lv",38968:"hostDefaultsStrings36",39007:"aRes0",39036:"search-locale-nl-nl",39079:"calling-locale-kk-kz",39090:"search-locale-fr-fr",39109:"smart-device-locale-fil-ph",39117:"gallery-locale-fi-fi",39262:"data-resolvers-smb-user-intent",39307:"meetingFlyout-locale-en-us",39308:"survey-locale-mk-mk",39363:"categories-af-za-json",39370:"share-email-locale-en-gb",39387:"search-locale-el-gr",39396:"onePlayerAmp",39410:"sht-searchanswerteamsstrings_es-gd-gb",39412:"hostUxStrings80",39435:"people-targeting-locale-ka-ge",39442:"sht-cortextopictypeswebstrings_sr",39541:"hostDefaultsStrings6",39613:"services-io-browser-consent-state",39650:"pre-assignment-entry-image",39706:"data-resolvers-tfl-meeting-links",39717:"data-resolvers-share-to-teams",39724:"onecamera-locale-ar",39730:"meet-for-work-locale-cy-gb",39818:"meeting-bot-locale-it-it",39840:"video-message-locale-sq-al",39845:"messaging-locale-ko-kr",39865:"virtual-events-list-container",39872:"onecamera-locale-sq",39874:"otlang43",39886:"esp-locale-en-gb",39888:"survey-locale-pt-pt",39974:"recurrence-locale-sl-si",40042:"share-email-locale-pt-pt",40060:"services-brb",40085:"communities-app",40114:"components-screen-recorder25",40125:"recurrence-locale-cy-gb",40150:"messaging-locale-sl-si",40177:"categories-bn-in-json",40191:"wiki-locale-ja-jp",40221:"search-locale-ja-jp",40238:"recurrence-locale-sk-sk",40285:"otlang44",40355:"hostDefaultsStrings13",40370:"files-locale-zh-tw",40416:"gallery-locale-bg-bg",40433:"meetingFlyout-locale-ca-es",40553:"meeting-options-locale-es-mx",40583:"extensibility-locale-vi-vn",40596:"hostDefaultsStrings48",40600:"artifacts-platform-locale-gl-es",40684:"nl-strings-jsonThinRes",40697:"coach-report-locale-zh-tw",40756:"artifacts-platform-locale-sq-al",40802:"tt-RU-UiStrings-json",40824:"people-targeting-locale-cs-cz",40826:"components-screen-recorder104",40840:"meet-for-work-locale-sk-sk",40857:"zh-TW-UiStrings-json",40866:"breakoutRooms-locale-th-th",40868:"data-resolvers-browser-floodgate",40879:"share-email-locale-sv-se",40953:"prs-AF-comment-pane-strings-jsonOfficeOnlineStringResource",41007:"hostUxStrings41",41032:"meeting-bot-locale-de-de",41064:"share-email-locale-hi-in",41071:"hostUxStrings63",41127:"webview2-service",41140:"meeting-bot-locale-nn-no",41143:"messaging-locale-en-us",41188:"files-locale-ru-ru",41193:"video-message-locale-ka-ge",41253:"meeting-recap-locale-pt-pt",41272:"hostDefaultsStrings3",41309:"channels-locale-en-us",41348:"sht-searchanswerteamsstrings_es-eu",41422:"meeting-room-console-locale-fr-ca",41445:"broadcast-locale-fil-ph",41480:"services-meeting-catchup",41491:"gallery-locale-sk-sk",41557:"platform-app-metaos-service",41627:"breakoutRooms-locale-gl-es",41676:"zh-CN-comment-pane-strings-jsonOfficeOnlineStringResource",41687:"message-escalate-dialog-locale-nb-no",41707:"message-escalate-dialog-locale-pt-br",41719:"fns62",41720:"files-locale-en-us",41746:"meeting-recap-locale-ka-ge",41787:"message-escalate-dialog-locale-fr-ca",41795:"guardians-locale-ar-sa",41799:"meeting-recap-locale-it-it",41895:"fns38",41897:"cast-locale-pt-pt",41992:"hostDefaultsStrings44",42044:"calling-locale-hr-hr",42049:"video-message-locale-et-ee",42061:"hostDefaultsStrings2",42065:"breakoutRooms-locale-pt-pt",42119:"broadcast-locale-mk-mk",42120:"channels-locale-fr-ca",42122:"categories-el-gr-json",42143:"calendar-locale-ar-sa",42182:"meeting-analytics-locale-th-th",42194:"sht-cortextopictypeswebstrings_af",42239:"broadcast-locale-uk-ua",42279:"video-effects-and-avatar-panel",42282:"extensibility-locale-fil-ph",42302:"video-message-locale-sk-sk",42325:"virtualEvents-locale-hr-hr",42330:"pluginHelp",42337:"calling-locale-ja-jp",42371:"itemsview-deferredactions",42388:"sht-cortextopictypeswebstrings_eu",42411:"sht-searchanswerteamsstrings_es-ka",42461:"services-petrol",42469:"guardians-locale-fr-fr",42477:"video-message-locale-kk-kz",42493:"smart-device-locale-it-it",42495:"pluginCustomOptions",42549:"survey-locale-en-gb",42558:"calling-locale-uk-ua",42575:"channels-locale-cs-cz",42595:"artifacts-platform-locale-fr-ca",42636:"categories-uz-latn-uz-json",42699:"meeting-room-console-locale-fr-fr",42705:"immersive-reader-service",42742:"main-locale-zh-cn",42754:"sht-cortextopictypeswebstrings_si-lk",42768:"meet-for-work-locale-tr-tr",42842:"message-escalate-dialog-locale-ro-ro",42849:"meeting-recap-locale-en-us",42869:"meeting-bot-locale-ar-sa",42917:"components-screen-recorder46",42919:"sht-searchanswerteamsstrings_es-fr-ca",42920:"coach-report-locale-sv-se",42931:"wiki-locale-nn-no",42941:"coach-report-locale-vi-vn",42944:"meeting-options-locale-tr-tr",42985:"biometric-enrollment-locale-cs-cz",43054:"fns85",43158:"meeting-recap-locale-cs-cz",43209:"smart-device-locale-fi-fi",43212:"guardians-locale-cs-cz",43214:"aRes55",43223:"otlang60",43338:"coach-report-locale-id-id",43342:"meeting-recap-locale-eu-es",43347:"webrec2-language-is",43364:"hostUxStrings19",43436:"meeting-recap-locale-fr-fr",43458:"search-lazy-chunk",43469:"cast-locale-gl-es",43505:"semantic-object-locale-lt-lt",43532:"school-locale-lt-lt",43535:"meet-for-work-locale-ro-ro",43577:"sht-cortextopictypeswebstrings_hi",43579:"hr-strings-jsonThinRes",43583:"InformationProtectionStrings30",43589:"esp-locale-sl-si",43597:"sht-cortextopictypeswebstrings_ca-es-valencia",43607:"services-ods",43642:"recurrence-locale-eu-es",43665:"files-locale-pt-pt",43695:"meeting-bot-locale-lt-lt",43743:"sht-cortextopictypeswebstrings_ur",43750:"virtualEvents-locale-fil-ph",43795:"files-locale-ro-ro",43890:"broadcast-locale-bg-bg",43927:"smart-device-locale-zh-tw",43950:"meeting-recap-locale-ko-kr",43970:"video-capture-locale-fr-fr",43983:"sht-cortextopictypeswebstrings_ka",44013:"meeting-bot-locale-hi-in",44047:"calling-locale-he-il",44126:"webinar-locale-ja-jp",44129:"InformationProtectionStrings61",44145:"calling-locale-nb-no",44178:"discover-surface-locale-fil-ph",44208:"sht-cortextopictypeswebstrings_sr-cyrl-ba",44264:"meetingFlyout-locale-mk-mk",44283:"aRes30",44284:"gallery-locale-en-gb",44292:"coach-report-locale-sr-latn-rs",44334:"closedCaptionsTeachingMoment",44357:"hostUxStrings33",44361:"video-message-locale-tr-tr",44386:"webinar-locale-tr-tr",44462:"data-resolvers-search-prefetch",44465:"people-targeting-locale-de-de",44470:"meeting-options-locale-sk-sk",44476:"aRes45",44480:"artifacts-platform-locale-tr-tr",44481:"CommentPluginComponent",44551:"webrec2-language-gl",44565:"esp-locale-sr-latn-rs",44570:"calling-locale-es-es",44584:"pl-PL-comment-pane-strings-jsonOfficeOnlineStringResource",44585:"breakoutRooms-locale-hi-in",44586:"messaging-locale-zh-cn",44596:"hostDefaultsStrings40",44634:"otlang118",44667:"biometric-enrollment-locale-en-us",44680:"da-DK-UiStrings-json",44690:"InformationProtectionStrings74",44696:"cast-locale-sk-sk",44699:"cast-locale-en-us",44706:"fns51",44731:"hostUxStrings75",44741:"webrec2-language-pt-pt",44746:"categories-tt-ru-json",44775:"ko-KR-UiStrings-json",44778:"calendar-locale-fr-fr",44871:"aRes32",44942:"otlang5",44949:"ams-video-player",44975:"people-targeting-locale-he-il",44999:"te-IN-comment-pane-strings-jsonOfficeOnlineStringResource",45005:"school-locale-vi-vn",45020:"sht-cortextopictypeswebstrings_hr",45024:"sht-cortextopictypeswebstrings_sk",45029:"data-resolvers-host-updates",45084:"video-message-locale-hu-hu",45130:"fns21",45138:"school-locale-pt-pt",45153:"search-locale-fil-ph",45157:"virtualEvents-locale-es-mx",45170:"files-locale-id-id",45196:"calendar-locale-ca-es",45241:"discover-surface-locale-uk-ua",45250:"fns66",45270:"people-targeting-locale-sv-se",45285:"main-locale-sr-latn-rs",45303:"video-capture-locale-en-us",45321:"extensibility-locale-tr-tr",45328:"school-locale-it-it",45362:"categories-sw-ke-json",45419:"InformationProtectionStrings77",45424:"coach-report-locale-fr-ca",45500:"sl-SI-comment-pane-strings-jsonOfficeOnlineStringResource",45560:"esp-locale-da-dk",45620:"categories-ps-af-json",45626:"services-meeting-artifacts",45665:"sht-searchanswerteamsstrings_es-ur",45702:"categories-hr-hr-json",45730:"meeting-analytics-locale-ru-ru",45742:"hostUxStrings43",45784:"semantic-object-locale-nl-nl",45801:"biometric-enrollment-locale-is-is",45804:"video-capture-locale-es-es",45805:"ga-ie-strings-jsonThinRes",45816:"otlang47",45871:"messaging-locale-da-dk",45877:"files-locale-is-is",45882:"cast-locale-ca-es",45885:"guardians-locale-sq-al",45898:"semantic-object-locale-et-ee",45906:"categories-yo-ng-json",45915:"meeting-options-locale-ca-es-valencia",45924:"cast-locale-ko-kr",45930:"messaging-locale-fr-fr",45933:"components-screen-recorder18",45965:"guardians-locale-id-id",45999:"calendar-locale-it-it",46067:"fns16",46082:"sht-searchanswerteamsstrings_es-az-latn-az",46089:"categories-pa-in-json",46118:"otlang37",46119:"cortana-popup",46149:"extensibility-locale-ca-es-valencia",46169:"gd-gb-UiStrings-json",46261:"otlang116",46266:"sht-topics-sdk-km-api",46310:"data-resolvers-browser-call-recording",46342:"sht-searchanswerteamsstrings_es-sk",46402:"share-email-locale-es-mx",46433:"onePlayerLoader",46436:"meeting-recap-locale-ro-ro",46453:"sht-searchanswerteamsstrings_es-si-lk",46462:"semantic-object-locale-sv-se",46477:"gallery-locale-es-es",46515:"discover-surface-locale-tr-tr",46532:"categories-bn-bd-json",46534:"webrec2-language-nb-no",46563:"messaging-locale-th-th",46581:"wiki-locale-en-us",46584:"esp-locale-vi-vn",46631:"audience-view-dialog-locale-is-is",46639:"categories-nl-nl-json",46657:"calling-locale-en-us",46697:"esp-locale-lv-lv",46712:"lb-LU-UiStrings-json",46713:"gallery-locale-fr-ca",46730:"is-IS-UiStrings-json",46736:"otlang112",46739:"cast-locale-th-th",46789:"hostUxStrings73",46804:"search-locale-pt-pt",46823:"otlang62",46838:"aRes34",46848:"components-screen-recorder96",46873:"broadcast-locale-is-is",46916:"otlang33",46918:"ha-Latn-NG-comment-pane-strings-jsonOfficeOnlineStringResource",46926:"video-capture-locale-sq-al",46943:"smart-device-locale-hr-hr",46949:"aRes4",46978:"calling-locale-et-ee",46979:"components-mesh-avatar-panel",46981:"search-locale-sv-se",47038:"meet-for-work-locale-es-es",47049:"artifacts-platform-locale-lt-lt",47112:"coach-report-locale-tr-tr",47140:"semantic-object-locale-sq-al",47162:"hostDefaultsStrings10",47280:"aRes38",47282:"survey-locale-lv-lv",47296:"message-escalate-dialog-locale-ko-kr",47331:"meeting-analytics-locale-es-mx",47339:"hostUxStrings11",47384:"notesHeaderTooltipHost",47400:"bs-Latn-BA-UiStrings-json",47423:"webrec2-language-mk",47461:"otlang52",47468:"extensibility-locale-es-es",47511:"extensibility-locale-it-it",47540:"InformationProtectionStrings42",47573:"recurrence-locale-fi-fi",47579:"fns69",47632:"pluginDebug",47639:"calendar-agenda-view",47663:"share-email-locale-fi-fi",47761:"audience-view-dialog-locale-pt-br",47794:"discover-surface-locale-fi-fi",47806:"data-resolvers-suggestions",47812:"meeting-recap-locale-mk-mk",47834:"hostDefaultsStrings82",47838:"meeting-options-locale-he-il",47861:"message-escalate-dialog-locale-fi-fi",47869:"meet-for-work-locale-vi-vn",47872:"video-capture-locale-sk-sk",47924:"video-message-locale-cs-cz",47953:"communities-invite-link-dialog",48003:"smart-device-locale-lt-lt",48025:"InformationProtectionStrings32",48032:"ru-RU-comment-pane-strings-jsonOfficeOnlineStringResource",48098:"biometric-enrollment-locale-fr-ca",48113:"cast-locale-en-gb",48117:"meeting-bot-locale-az-latn-az",48129:"data-resolvers-live-state-broadcast",48140:"aRes52",48147:"nova-sb-variant-teams",48156:"otlang72",48170:"discover-surface-locale-el-gr",48195:"data-resolvers-breakout-rooms",48219:"fi-strings-jsonThinRes",48226:"webinar-locale-nb-no",48283:"wiki-locale-fil-ph",48307:"compose-box-v2-renderer",48339:"smart-device-locale-gl-es",48370:"meeting-room-console-locale-sk-sk",48418:"sht-cortextopictypeswebstrings_fil",48421:"onecamera-locale-zh-hans",48447:"InformationProtectionStrings34",48451:"calendar-locale-th-th",48506:"artifacts-platform-locale-nl-nl",48522:"webrec2-language-th",48550:"meetingFlyout-locale-nl-nl",48557:"message-extension-flyout-popup-container",48588:"health-locale-en-us",48606:"sl-strings-jsonThinRes",48623:"sht-topics-sdk-loki-api",48627:"webrec2-language-en",48678:"InformationProtectionStrings83",48683:"recurrence-locale-lv-lv",48687:"data-resolvers-browser-communities",48693:"services-item-crud",48715:"hostUxStrings5",48735:"config-dod",48736:"health-locale-pt-br",48839:"ur-PK-UiStrings-json",48840:"data-resolvers-browser-logs-files",48853:"data-resolvers-conversations-reminder",48904:"aRes12",48906:"virtualEvents-locale-en-us",48923:"semantic-object-locale-it-it",48937:"freemium-upgrade-locale-es-mx",48943:"categories-mi-nz-json",49051:"smart-device-locale-id-id",49073:"data-resolvers-activity-bell-count",49087:"data-resolvers-loki",49120:"search-locale-he-il",49209:"lo-LA-comment-pane-strings-jsonOfficeOnlineStringResource",49241:"biometric-enrollment-locale-nn-no",49333:"files-locale-de-de",49346:"calling-end-screen",49378:"hostDefaultsStrings33",49394:"categories-en-us-json",49448:"virtualEvents-locale-ca-es",49567:"compose-add-ons",49576:"AshaUtils",49589:"meeting-bot-locale-en-gb",49590:"calendar-locale-gl-es",49619:"InformationProtectionStrings85",49663:"people-targeting-locale-sq-al",49672:"sht-searchanswerteamsstrings_es-km-kh",49721:"extensibility-locale-hu-hu",49736:"esp-dialog",49742:"categories-ha-latn-ng-json",49744:"audience-view-dialog-locale-he-il",49752:"extensibility-locale-pl-pl",49761:"InformationProtectionStrings21",49782:"webrec2-language-sk",49784:"meeting-room-front-of-room-home",49805:"freemium-upgrade-locale-he-il",49808:"files-locale-ca-es-valencia",49810:"search-locale-es-mx",49863:"sr-Cyrl-BA-UiStrings-json",49880:"services-MeetingRecapSwaservice",49902:"fns54",49974:"meet-for-work-locale-ar-sa",50013:"artifacts-platform-locale-vi-vn",50063:"categories-bs-latn-ba-json",50067:"hostDefaultsStrings26",50084:"fns82",50103:"video-capture-locale-kk-kz",50104:"services-msa-authentication",50138:"people-targeting-locale-et-ee",50142:"sht-searchanswerteamsstrings_es-id",50157:"es-MX-UiStrings-json",50175:"meeting-bot-locale-zh-tw",50206:"kn-IN-comment-pane-strings-jsonOfficeOnlineStringResource",50215:"broadcast-locale-sq-al",50218:"coach-report-locale-fil-ph",50238:"fns67",50241:"discover-surface-locale-nn-no",50284:"hostUxStrings16",50293:"share-email-locale-lt-lt",50366:"wiki-locale-id-id",50391:"meeting-options-locale-hu-hu",50399:"artifacts-platform-locale-et-ee",50439:"survey-locale-tr-tr",50480:"meeting-options-locale-ko-kr",50547:"ms-MY-comment-pane-strings-jsonOfficeOnlineStringResource",50615:"zh-hant-strings-jsonThinRes",50636:"calendar-locale-ru-ru",50718:"services-files-personal",50743:"sht-cortextopictypeswebstrings_uk",50747:"main-locale-bg-bg",50756:"locked-teams-activate-dialog",50770:"lazy-extensible-app-with-consent-container",50771:"InformationProtectionStrings11",50801:"otlang50",50839:"meeting-bot-locale-he-il",50890:"meeting-bot-locale-ru-ru",50899:"tfl-calendar-people-picker",50906:"main-locale-en-us",50912:"InformationProtectionStrings55",50926:"pulsar-api",50936:"survey-locale-cy-gb",50946:"meeting-room-console-locale-en-gb",50961:"hostDefaultsStrings18",50970:"school-locale-de-de",50992:"hr-HR-comment-pane-strings-jsonOfficeOnlineStringResource",51011:"sht-searchanswerteamsstrings_es-sv",51052:"coach-report-locale-az-latn-az",51060:"InformationProtectionStrings59",51070:"webrec2-language-pl",51072:"navigationPanelShimmer",51074:"services-locked-teams",51083:"sht-cortextopictypeswebstrings_be-by",51102:"meeting-recap-locale-id-id",51106:"esp-locale-pt-pt",51181:"message-escalate-dialog-locale-uk-ua",51246:"el-GR-comment-pane-strings-jsonOfficeOnlineStringResource",51254:"sht-searchanswerteamsstrings_es-el",51260:"categories-bg-bg-json",51292:"cast-locale-ca-es-valencia",51295:"extensibility-locale-sv-se",51303:"fns72",51309:"services-teams-and-channels",51312:"smart-device-locale-fr-ca",51317:"share-email-locale-lv-lv",51359:"breakoutRooms-locale-nb-no",51397:"webinar-locale-cs-cz",51403:"meeting-recap-locale-gl-es",51404:"InformationProtectionStrings52",51425:"services-fluid",51452:"webrec2-language-sl",51469:"data-resolvers-viva-insights",51507:"audience-view-dialog-locale-fil-ph",51534:"onecamera-locale-az",51539:"sht-searchanswerteamsstrings_es-ug-cn",51554:"main-locale-ro-ro",51566:"video-capture-locale-hu-hu",51570:"breakoutRooms-locale-es-mx",51582:"discover-surface-locale-sr-latn-rs",51594:"smart-device-locale-ca-es-valencia",51654:"fns12",51661:"data-resolvers-targeting-hierarchy",51667:"otlang102",51685:"audience-view-dialog-locale-cy-gb",51704:"people-targeting-locale-ar-sa",51710:"services-transcript",51744:"InformationProtectionStrings79",51748:"wiki-locale-th-th",51789:"video-message-locale-ar-sa",51792:"services-webinar",51796:"fns33",51803:"webrec2-webcv",51822:"main-locale-az-latn-az",51868:"meeting-bot-locale-ca-es-valencia",51914:"InformationProtectionStrings29",51921:"meet-for-work-locale-sv-se",51949:"data-resolvers-browser-mention",52102:"calling-custom-video-backgrounds-panel",52107:"mr-IN-comment-pane-strings-jsonOfficeOnlineStringResource",52144:"categories-tn-za-json",52157:"audience-view-dialog-locale-mk-mk",52177:"discover-surface-locale-sv-se",52241:"sht-searchanswerteamsstrings_es-tt",52254:"sht-cortextopictypeswebstrings_tk-tm",52281:"onecamera-locale-nb",52287:"calendar-locale-fr-ca",52318:"wiki-locale-uk-ua",52324:"components-screen-recorder90",52344:"main-locale-cy-gb",52354:"meeting-analytics-locale-sr-latn-rs",52425:"audience-view-dialog-locale-ka-ge",52433:"broadcast-locale-el-gr",52443:"meeting-room-console-locale-es-es",52534:"calling-locale-pt-pt",52567:"sht-searchanswerteamsstrings_es-sl",52574:"onecamera-locale-eu",52579:"categories-ky-kg-json",52648:"ka-GE-comment-pane-strings-jsonOfficeOnlineStringResource",52683:"people-targeting-locale-mk-mk",52708:"recurrence-locale-sq-al",52713:"components-screen-recorder86",52761:"services-targeting-hierarchy",52763:"fil-PH-UiStrings-json",52781:"files-locale-kk-kz",52793:"message-escalate-dialog-locale-ja-jp",52797:"hostDefaultsStrings55",52820:"sht-searchanswerteamsstrings_es-pa-in",52849:"components-screen-recorder80",52857:"otlang78",52866:"InformationProtectionStrings57",52876:"guardians-locale-da-dk",52933:"otlang58",52943:"data-resolvers-meet-for-work",52944:"extensibility-locale-de-de",52995:"channels-locale-ka-ge",53029:"categories-gd-gb-json",53046:"hostUxStrings84",53069:"meeting-analytics-locale-es-es",53075:"video-capture-locale-ca-es",53077:"freemium-upgrade-locale-pt-br",53084:"freemium-upgrade-locale-it-it",53119:"createNewModule",53120:"message-escalate-dialog-locale-bg-bg",53154:"webinar-locale-zh-cn",53188:"video-message-locale-fil-ph",53196:"virtualEvents-locale-he-il",53228:"share-email-locale-kk-kz",53236:"webrec2-language-he",53247:"calling-locale-lt-lt",53267:"people-targeting-locale-kk-kz",53277:"guardians-locale-mk-mk",53303:"discover-surface-locale-az-latn-az",53326:"hostUxStrings67",53356:"health-locale-cs-cz",53361:"fns7",53393:"webrec2-language-zh-cn",53460:"biometric-enrollment-locale-pt-pt",53484:"hi-strings-jsonThinRes",53578:"virtualEvents-locale-fr-ca",53592:"components-calendar-agenda-view-embed",53598:"fns3",53613:"calling-locale-ka-ge",53615:"calling-locale-cs-cz",53636:"zh-cn-strings-jsonThinRes",53637:"breakoutRooms-locale-nn-no",53681:"gu-IN-comment-pane-strings-jsonOfficeOnlineStringResource",53715:"search-locale-hu-hu",53802:"artifacts-platform-locale-fr-fr",53829:"smart-device-locale-nl-nl",53857:"otlang1",53871:"cs-CZ-comment-pane-strings-jsonOfficeOnlineStringResource",53909:"meetingFlyout-locale-gl-es",53971:"sht-cortextopictypeswebstrings_prs",53993:"main-locale-is-is",54009:"gallery-locale-cy-gb",54014:"sht-cortextopictypeswebstrings_mk",54018:"webrec2-language-sr-cyrl-rs",54022:"meeting-recap-locale-fi-fi",54039:"audience-view-dialog-locale-cs-cz",54067:"teams-and-channels-locale-fr-fr",54068:"esp-locale-sv-se",54069:"extensibility-locale-en-us",54122:"semantic-object-locale-ru-ru",54125:"breakoutRooms-locale-fi-fi",54165:"services-people-targeting",54166:"fns20",54167:"sb-plugins",54177:"files-locale-hu-hu",54180:"search-locale-ru-ru",54198:"components-compose-extensions",54212:"artifacts-platform-locale-hr-hr",54223:"gallery-locale-ko-kr",54270:"broadcast-locale-kk-kz",54281:"nb-strings-jsonThinRes",54309:"sht-cortextopictypeswebstrings_ca",54314:"artifacts-platform-locale-hi-in",54347:"meeting-room-console-locale-es-mx",54423:"share-email-locale-az-latn-az",54447:"components-screen-recorder56",54509:"video-message-locale-fr-fr",54515:"biometric-enrollment-locale-vi-vn",54541:"broadcast-locale-he-il",54548:"fns45",54556:"aRes7",54567:"fluid-calendar-meeting-notes",54569:"share-email-locale-nl-nl",54572:"onecamera-locale-hu",54573:"cast-locale-ja-jp",54578:"channels-locale-fr-fr",54594:"school-locale-nb-no",54603:"otlang34",54668:"config-gcchigh",54692:"services-toast-image",54722:"video-message-locale-pt-br",54730:"hostDefaultsStrings50",54739:"otlang36",54761:"broadcast-locale-zh-tw",54788:"calling-locale-bg-bg",54835:"webrec2-language-el",54866:"aRes29",54936:"webrec2-language-hu",54937:"webinar-registration-app",54948:"meeting-collaboration-container-panel",54964:"health-locale-et-ee",54980:"school-locale-cs-cz",55028:"calendar-mini-scheduling-assistant",55033:"sht-searchanswerteamsstrings_es-sw",55046:"components-screen-recorder54",55091:"hostDefaultsStrings71",55143:"components-file-sharing-dialog",55151:"onecamera-locale-uk",55192:"webinar-locale-kk-kz",55200:"semantic-object-locale-cy-gb",55204:"survey-locale-de-de",55206:"share-email-locale-ko-kr",55221:"data-resolvers-browser-files",55228:"meeting-options-locale-hr-hr",55264:"data-resolvers-collab-cloud",55279:"components-screen-recorder114",55306:"meet-for-work-locale-en-gb",55308:"bg-BG-UiStrings-json",55320:"webinar-locale-cy-gb",55340:"survey-locale-ru-ru",55393:"chat-reject-call-button",55402:"services-io-tfl-user",55439:"webrec2-language-ja",55503:"teams-and-channels-locale-id-id",55549:"InformationProtectionStrings23",55550:"gallery-locale-sv-se",55553:"freemium-upgrade-locale-mk-mk",55555:"sht-searchanswerteamsstrings_es-lb-lu",55579:"mediaSettingsEditEmptyState",55625:"calendar-locale-sl-si",55627:"components-screen-recorder60",55678:"hostDefaultsStrings76",55777:"discover-surface-locale-he-il",55875:"freemium-upgrade-locale-fr-ca",55919:"data-resolvers-user-preferences",55936:"categories-ja-jp-json",55989:"data-resolvers-mesh-audio",56010:"biometric-enrollment-locale-sv-se",56023:"freemium-upgrade-locale-ko-kr",56046:"en-GB-comment-pane-strings-jsonOfficeOnlineStringResource",56081:"lo-LA-UiStrings-json",56092:"discover-surface-locale-ru-ru",56097:"nn-NO-comment-pane-strings-jsonOfficeOnlineStringResource",56124:"freemium-upgrade-locale-fi-fi",56130:"meeting-bot-locale-fr-ca",56149:"biometric-enrollment-locale-es-mx",56166:"data-resolvers-browser-meeting-bot",56204:"meeting-recap-locale-de-de",56210:"coach-report-locale-es-mx",56244:"hostUxStrings9",56255:"services-biometric-enrollment",56272:"sht-cortextopictypeswebstrings_fa",56275:"guardians-locale-et-ee",56300:"sht-searchanswerteamsstrings_es-pt-pt",56312:"meeting-analytics-locale-hr-hr",56330:"hostDefaultsStrings66",56335:"sht-searchanswerteamsstrings_es-ga-ie",56343:"components-avatar-quick-picker",56354:"health-locale-es-es",56357:"meet-for-work-locale-kk-kz",56387:"InformationProtectionStrings65",56391:"video-message-locale-hi-in",56425:"fns83",56448:"data-resolvers-m365-links",56477:"share-email-locale-uk-ua",56481:"files-locale-ca-es",56532:"hostDefaultsStrings23",56564:"fns30",56633:"esp-locale-ro-ro",56641:"meeting-options-locale-ru-ru",56652:"people-targeting-locale-vi-vn",56654:"data-resolvers-esp-target",56679:"broadcast-locale-ro-ro",56693:"aRes8",56712:"extensibility-locale-ru-ru",56722:"calling-locale-ca-es-valencia",56737:"services-collab-object",56738:"share-email-locale-bg-bg",56774:"guardians-locale-fi-fi",56795:"extensibility-locale-ro-ro",56809:"onecamera-locale-et",56828:"meeting-bot-locale-es-es",56864:"meeting-options-locale-it-it",56867:"sht-cortextopictypeswebstrings_gd-gb",56904:"search-app",56923:"discover-surface-locale-vi-vn",56947:"aRes27",56970:"InformationProtectionStrings53",56992:"health-locale-tr-tr",57002:"school-locale-fil-ph",57020:"message-escalate-dialog-locale-da-dk",57048:"cast-locale-pl-pl",57052:"guardians-locale-de-de",57069:"calling-locale-fr-ca",57088:"InformationProtectionStrings15",57156:"sht-cortextopictypeswebstrings_sv",57164:"main-locale-fr-ca",57177:"ta-IN-UiStrings-json",57239:"th-TH-comment-pane-strings-jsonOfficeOnlineStringResource",57245:"hostDefaultsStrings75",57264:"services-io-mru",57298:"vi-strings-jsonThinRes",57302:"sk-SK-UiStrings-json",57312:"es-ES-UiStrings-json",57330:"message-escalate-dialog-locale-nl-nl",57368:"webrec2-language-fr-ca",57375:"data-resolvers-favorite-user",57405:"webinar-locale-ca-es",57426:"gallery-locale-da-dk",57441:"biometric-enrollment-locale-sk-sk",57449:"gallery-locale-gl-es",57495:"meeting-bot-locale-sr-latn-rs",57497:"health-locale-cy-gb",57510:"gallery-locale-fil-ph",57545:"cast-locale-az-latn-az",57549:"InformationProtectionStrings19",57561:"cast-locale-kk-kz",57610:"broadcast-locale-lv-lv",57621:"meeting-recap-locale-hu-hu",57625:"ca-strings-jsonThinRes",57628:"is-strings-jsonThinRes",57699:"calling-locale-es-mx",57711:"extensibility-locale-es-mx",57721:"people-targeting-locale-tr-tr",57746:"data-resolvers-immersive-reader",57760:"survey-locale-fr-ca",57787:"coach-report-locale-pl-pl",57796:"webrec2-language-nn-np",57824:"ro-RO-comment-pane-strings-jsonOfficeOnlineStringResource",57896:"nb-NO-comment-pane-strings-jsonOfficeOnlineStringResource",57900:"extensibility-locale-az-latn-az",57912:"InformationProtectionStrings7",57919:"meeting-bot-locale-bg-bg",57944:"teams-and-channels-locale-fil-ph",57960:"meeting-recap-app",57964:"onecamera-locale-es-mx",57969:"midgard-bootstrapper",57998:"health-locale-lt-lt",58004:"coach-report-locale-is-is",58035:"gallery-locale-fr-fr",58076:"meeting-room-console-entry-container",58137:"meet-for-work-locale-he-il",58142:"meeting-recap-locale-zh-tw",58146:"ko-KR-comment-pane-strings-jsonOfficeOnlineStringResource",58163:"apps-platform-service-enpoints",58188:"smart-device-locale-sv-se",58245:"categories-sk-sk-json",58259:"guardians-locale-en-us",58267:"webrec2-language-fi",58276:"recurrence-locale-es-es",58357:"discover-surface-locale-sk-sk",58359:"meeting-analytics-locale-et-ee",58377:"pa-IN-comment-pane-strings-jsonOfficeOnlineStringResource",58392:"people-targeting-locale-sl-si",58395:"de-DE-UiStrings-json",58410:"meeting-bot-locale-es-mx",58444:"search-locale-lv-lv",58466:"sht-searchanswerteamsstrings_es-hy",58485:"school-locale-mk-mk",58486:"cast-locale-sq-al",58512:"sht-cortextopictypeswebstrings_sl",58549:"InformationProtectionStrings67",58557:"extensibility-locale-kk-kz",58571:"audience-view-dialog-locale-ar-sa",58595:"virtualEvents-locale-es-es",58622:"messaging-locale-pt-br",58636:"fns47",58646:"discover-surface-locale-cs-cz",58670:"meeting-analytics-locale-lt-lt",58673:"artifacts-platform-locale-sk-sk",58686:"guardians-locale-es-mx",58712:"components-calendar-modal",58758:"meeting-room-console-locale-da-dk",58800:"smart-device-locale-he-il",58814:"meeting-room-console-locale-vi-vn",58820:"onecamera-locale-el",58877:"sht-searchanswerteamsstrings_es-hi",59010:"message-escalate-dialog-locale-sv-se",59019:"video-message-locale-mk-mk",59048:"esp-locale-de-de",59067:"platform-app",59082:"common-post-and-reply-types",59084:"sht-searchanswerteamsstrings_es-sr",59096:"communities-modal",59098:"services-store",59139:"apps-files",59151:"main-locale-sl-si",59166:"meeting-options-locale-cs-cz",59206:"common-post-types",59225:"fns13",59238:"InformationProtectionStrings71",59258:"share-email-locale-es-es",59266:"wiki-locale-sq-al",59286:"wiki-locale-et-ee",59323:"sharedCommentsLazy",59360:"people-targeting-locale-fr-ca",59362:"onecamera-locale-cs",59401:"meeting-options-locale-sl-si",59465:"categories-fi-fi-json",59508:"fns22",59514:"onecamera-locale-lt",59518:"channels-locale-sl-si",59529:"otlang25",59556:"coach-report-locale-ca-es-valencia",59571:"webrec2-language-cs",59616:"services-user-license",59663:"breakoutRooms-locale-az-latn-az",59667:"freemium-upgrade-locale-lt-lt",59746:"semantic-object-locale-tr-tr",59752:"freemium-upgrade-locale-hr-hr",59753:"hostUxStrings70",59764:"wiki-locale-vi-vn",59797:"coach-report-locale-hi-in",59818:"auth",59831:"components-screen-recorder30",59860:"search-locale-pl-pl",59923:"components-screen-recorder14",59930:"guardians-locale-uk-ua",59959:"hostDefaultsStrings79",59982:"esp-locale-cy-gb",59999:"discover-surface-locale-pt-pt",60005:"survey-locale-sq-al",60041:"bn-IN-UiStrings-json",60060:"channels-locale-hi-in",60088:"fr-strings-jsonThinRes",60100:"biometric-enrollment-locale-mk-mk",60111:"files-locale-tr-tr",60115:"data-resolvers-policies",60123:"hostUxStrings27",60148:"video-message-locale-nl-nl",60273:"guardians-locale-zh-cn",60295:"fns52",60319:"artifacts-platform-locale-cy-gb",60323:"discover-surface-locale-fr-fr",60325:"main-locale-fr-fr",60332:"onecamera-locale-de",60347:"broadcast-locale-fi-fi",60382:"otlang94",60390:"tr-TR-comment-pane-strings-jsonOfficeOnlineStringResource",60430:"sht-searchanswerteamsstrings_es-mt-mt",60479:"fns86",60494:"hostDefaultsStrings8",60500:"hostDefaultsStrings60",60506:"fluidxOfficeFluidTypes",60509:"InformationProtectionStrings43",60532:"data-resolvers-presence",60568:"esp-quickguide",60639:"calendar-locale-pl-pl",60667:"health-locale-sk-sk",60684:"biometric-enrollment-locale-eu-es",60695:"cypress-tests-only",60698:"selectmedia",60713:"gallery-locale-th-th",60744:"video-capture-locale-th-th",60767:"webinar-locale-nn-no",60778:"hostDefaultsStrings53",60785:"meeting-analytics-locale-fr-fr",60811:"team-dashboard",60818:"virtualEvents-locale-fi-fi",60848:"data-resolvers-search-meeting-summary",60863:"audience-view-dialog-locale-ko-kr",60941:"platform-app-rail",60982:"it-strings-jsonThinRes",60988:"recurrence-locale-zh-tw",61030:"artifacts-platform-locale-fil-ph",61031:"freemium-upgrade-locale-bg-bg",61033:"hostUxStrings24",61038:"share-email-locale-zh-cn",61045:"meeting-bot-locale-el-gr",61051:"create-folder-dialog",61074:"guardians-locale-pt-pt",61090:"teams-and-channels-locale-ru-ru",61118:"hostDefaultsStrings58",61145:"cast-locale-sv-se",61167:"topics-sdk-aria-sdk",61176:"meetingFlyout-locale-da-dk",61183:"share-email-locale-ro-ro",61203:"InformationProtectionStrings35",61204:"meeting-bot-locale-lv-lv",61235:"guardians-locale-fr-ca",61263:"meeting-bot-locale-vi-vn",61286:"hostUxStrings1",61300:"meet-for-work-locale-el-gr",61320:"meeting-options-locale-fil-ph",61330:"hostUxStrings8",61331:"main-locale-sq-al",61336:"artifacts-platform-locale-ca-es",61386:"meeting-analytics-locale-nn-no",61409:"categories-hi-in-json",61440:"services-meet-for-work",61459:"otlang30",61472:"meet-for-work-locale-lt-lt",61518:"aRes26",61537:"people-targeting-locale-it-it",61539:"semantic-object-locale-pt-pt",61543:"calendar-locale-sq-al",61605:"fns39",61627:"data-resolvers-contacts-sync-banner",61639:"video-capture-locale-sr-latn-rs",61701:"message-escalate-dialog-locale-lv-lv",61702:"freemium-upgrade-locale-az-latn-az",61747:"video-message-locale-zh-cn",61768:"audience-view-dialog-locale-et-ee",61784:"sht-cortextopictypeswebstrings_hu",61803:"video-capture-locale-az-latn-az",61844:"sht-cortextopictypeswebstrings_zu-za",61880:"meetingFlyout-locale-th-th",61922:"broadcast-locale-sv-se",62027:"guardians-post-type",62030:"teams-and-channels-app",62036:"guardians-locale-ja-jp",62050:"biometric-enrollment-locale-de-de",62058:"multi-window-dashboard-renderer",62066:"smart-device-locale-ja-jp",62108:"virtualEvents-locale-ro-ro",62115:"InformationProtectionStrings60",62136:"virtualEvents-locale-th-th",62139:"teams-and-channels-locale-tr-tr",62151:"calling-debug-participants",62153:"categories-kn-in-json",62198:"hostUxStrings28",62199:"nn-NO-UiStrings-json",62245:"calling-locale-pl-pl",62293:"qps-ploc-comment-pane-strings-jsonOfficeOnlineStringResource",62294:"guardians-locale-fil-ph",62315:"InformationProtectionStrings68",62329:"data-resolvers-mesh-spaces",62351:"broadcast-locale-pt-pt",62376:"config-prod",62382:"broadcast-locale-it-it",62387:"sht-searchanswerteamsstrings_es-th",62437:"services-tenant-membership",62457:"broadcast-locale-eu-es",62463:"sht-searchanswerteamsstrings_es-ru",62472:"breakoutRooms-locale-eu-es",62475:"fns17",62476:"calling-meeting-options-label-downgrade-dialog",62478:"data-resolvers-meeting-intelligence",62520:"uk-UA-comment-pane-strings-jsonOfficeOnlineStringResource",62531:"teams-and-channels-locale-pl-pl",62535:"communities-join-modal",62556:"channels-locale-bg-bg",62580:"meetingFlyout-locale-pt-br",62665:"components-screen-recorder82",62678:"aRes39",62713:"audience-view-dialog-locale-sr-latn-rs",62716:"biometric-enrollment-locale-ca-es-valencia",62763:"teams-and-channels-locale-ko-kr",62781:"calendar-locale-sk-sk",62793:"pluginAudioFiles",62851:"audience-view-dialog-locale-lv-lv",62860:"video-message-locale-lt-lt",62889:"wiki-locale-nl-nl",62929:"meeting-recap-locale-th-th",62939:"hostDefaultsStrings37",62985:"messaging-locale-he-il",62990:"gallery-locale-cs-cz",63007:"meeting-bot-locale-fi-fi",63009:"pluginAnalytics",63017:"meeting-room-console-locale-de-de",63054:"calendar-locale-nb-no",63140:"mi-NZ-UiStrings-json",63184:"hostUxStrings66",63185:"calendar-locale-pt-br",63199:"smart-device-locale-el-gr",63233:"messaging-locale-hu-hu",63235:"extensibility-locale-zh-tw",63237:"people-targeting-locale-bg-bg",63311:"bs-latn-ba-strings-jsonThinRes",63335:"audience-view-dialog-locale-hi-in",63337:"aRes3",63364:"he-IL-comment-pane-strings-jsonOfficeOnlineStringResource",63366:"fluid-picker-renderer",63402:"hostUxStrings57",63408:"cast-locale-ar-sa",63417:"meeting-recap-locale-ja-jp",63434:"message-escalate-dialog-locale-et-ee",63473:"services-smb-user-intent",63502:"meeting-bot-locale-cy-gb",63563:"AtMentionLazy",63616:"files-locale-el-gr",63627:"video-message-locale-pt-pt",63685:"services-broadcast-attendee",63686:"share-form-email-entry",63702:"sht-searchanswerteamsstrings_es-en-gb",63732:"biometric-enrollment-locale-zh-tw",63766:"smart-device-locale-pl-pl",63810:"wiki-locale-ro-ro",63823:"teams-and-channels-locale-en-gb",63825:"files-locale-fil-ph",63857:"artifacts-platform-locale-ca-es-valencia",63871:"school-locale-zh-tw",63903:"files-locale-sk-sk",63907:"sht-searchanswerteamsstrings_es-bg",63936:"meeting-apps-flyout-renderer",63950:"freemium-upgrade-locale-en-us",63957:"messaging-locale-et-ee",63959:"sp-filter-actions",63968:"data-resolvers-browser-meeting-catchup",64e3:"sht-cortextopictypeswebstrings_uz",64009:"broadcast-locale-da-dk",64010:"webinar-locale-is-is",64038:"people-targeting-locale-el-gr",64055:"bridge-migration-components-calendar-app-host",64056:"meet-for-work-locale-mk-mk",64068:"playbackRegion",64070:"categories-as-in-json",64078:"broadcast-locale-ca-es",64089:"InformationProtectionStrings44",64091:"video-capture-locale-ar-sa",64100:"data-resolvers-hosted-web-content-log",64108:"people-targeting-locale-nn-no",64110:"meeting-room-console-locale-az-latn-az",64139:"gl-ES-comment-pane-strings-jsonOfficeOnlineStringResource",64145:"hostDefaultsStrings85",64189:"sht-searchanswerteamsstrings_es-hr",64258:"sr-Latn-RS-comment-pane-strings-jsonOfficeOnlineStringResource",64270:"extensibility-locale-eu-es",64274:"wiki-locale-el-gr",64278:"data-resolvers-os-file-share",64279:"survey-locale-it-it",64381:"freemium-upgrade-locale-el-gr",64403:"semantic-object-locale-th-th",64422:"esp-locale-fil-ph",64423:"cast-locale-ro-ro",64466:"video-capture-locale-de-de",64479:"wiki-locale-sk-sk",64501:"sht-cortextopictypeswebstrings_ug-cn",64502:"hi-IN-comment-pane-strings-jsonOfficeOnlineStringResource",64574:"ca-ES-comment-pane-strings-jsonOfficeOnlineStringResource",64618:"main-locale-uk-ua",64620:"categories-lb-lu-json",64623:"communities-guidelines-banner",64642:"webrec2-language-ms",64729:"messageBar",64749:"cast-locale-tr-tr",64750:"InformationProtectionStrings58",64754:"extensibility-locale-bg-bg",64779:"sht-cortextopictypeswebstrings_he",64816:"fa-IR-UiStrings-json",64857:"communities-create-dialog",64876:"messaging-locale-is-is",64878:"calendar-locale-lt-lt",64880:"meet-for-work-locale-en-us",64897:"files-locale-fr-fr",64944:"km-KH-comment-pane-strings-jsonOfficeOnlineStringResource",64992:"health-locale-th-th",65025:"guardians-locale-ko-kr",65028:"mk-strings-jsonThinRes",65041:"gallery-locale-ro-ro",65054:"survey-locale-hi-in",65065:"webinar-locale-pt-pt",65110:"extensibility-locale-et-ee",65129:"ur-PK-comment-pane-strings-jsonOfficeOnlineStringResource",65151:"files-locale-mk-mk",65238:"webinar-locale-zh-tw",65240:"semantic-object-locale-sk-sk",65242:"fluid-message-container",65306:"team-settings",65365:"data-resolvers-teams",65378:"aRes49",65398:"data-resolvers-msa-authentication",65414:"bn-IN-comment-pane-strings-jsonOfficeOnlineStringResource",65446:"meet-for-work-locale-ru-ru",65466:"share-email-locale-he-il",65469:"meeting-analytics-locale-fi-fi",65471:"spaddondeferred",65477:"breakoutRooms-locale-ca-es-valencia",65486:"call-health-panel",65515:"artifacts-platform-locale-id-id",65518:"coach-report-locale-gl-es",65556:"channels-locale-fil-ph",65579:"he-IL-UiStrings-json",65630:"pt-pt-strings-jsonThinRes",65631:"message-escalate-dialog-locale-ka-ge",65641:"health-locale-bg-bg",65647:"channels-locale-is-is",65656:"shareDialog",65677:"hostDefaultsStrings77",65707:"lms-integration-image-default-export",65745:"discover-surface-locale-nl-nl",65748:"channels-locale-da-dk",65758:"people-targeting-locale-ru-ru",65785:"aRes16",65844:"share-email-locale-it-it",65851:"chr-Cher-US-comment-pane-strings-jsonOfficeOnlineStringResource",65870:"freemium-upgrade-locale-kk-kz",65947:"video-capture-locale-gl-es",66073:"meeting-options-locale-sv-se",66129:"school-locale-eu-es",66144:"gallery-locale-pl-pl",66152:"messaging-locale-uk-ua",66167:"school-locale-zh-cn",66178:"aRes23",66179:"virtualEvents-locale-az-latn-az",66186:"artifacts-platform-locale-nn-no",66204:"chat-call-button",66235:"meeting-analytics-locale-tr-tr",66263:"data-resolvers-fluid",66281:"fns26",66326:"otlang29",66424:"webrec2-language-hi",66433:"video-capture-locale-fi-fi",66435:"meeting-analytics-locale-pl-pl",66450:"sq-strings-jsonThinRes",66467:"recurrence-locale-hr-hr",66476:"sht-cortextopictypeswebstrings_en-gb",66482:"hostDefaultsStrings34",66493:"data-resolvers-browser-activity",66525:"search-locale-nn-no",66584:"wiki-locale-es-es",66610:"cast-locale-it-it",66613:"message-escalate-dialog-locale-zh-tw",66693:"meetingFlyout-locale-hu-hu",66694:"meeting-room-console-locale-id-id",66714:"meeting-bot-locale-id-id",66725:"esp-engine",66726:"meeting-bot-locale-da-dk",66736:"biometric-enrollment-locale-th-th",66761:"otlang66",66793:"virtualEvents-locale-nl-nl",66833:"breakoutRooms-locale-zh-tw",66846:"sht-cortextopictypeswebstrings_az-latn-az",66887:"discover-surface-locale-is-is",66894:"meeting-analytics-locale-pt-pt",66896:"fns31",66953:"survey-locale-el-gr",66962:"categories-ka-ge-json",66963:"qps-ploca-comment-pane-strings-jsonOfficeOnlineStringResource",67008:"people-targeting-locale-zh-cn",67017:"health-locale-fil-ph",67083:"calling-locale-fil-ph",67099:"hostDefaultsStrings84",67103:"gallery-locale-zh-tw",67131:"broadcast-locale-de-de",67142:"pt-br-strings-jsonThinRes",67228:"it-IT-UiStrings-json",67261:"video-message-locale-id-id",67288:"hostDefaultsStrings45",67326:"files-locale-it-it",67409:"meeting-room-console-locale-sq-al",67417:"call-blocking-service",67442:"semantic-object-locale-es-mx",67450:"meetingFlyout-locale-ja-jp",67526:"main-locale-ko-kr",67569:"survey-locale-en-us",67608:"artifacts-platform-locale-es-es",67629:"teams-and-channels-locale-it-it",67643:"user-avatar",67644:"ne-NP-comment-pane-strings-jsonOfficeOnlineStringResource",67650:"sht-cortextopictypeswebstrings_th",67658:"school-locale-et-ee",67676:"cast-locale-mk-mk",67681:"recurrence-locale-id-id",67738:"el-strings-jsonThinRes",67742:"files-locale-ko-kr",67767:"data-resolvers-distribution-list",67769:"meeting-room-console-locale-sr-latn-rs",67785:"data-resolvers-team-settings",67847:"broadcast-locale-fr-ca",67856:"am-ET-UiStrings-json",67883:"breakoutRooms-locale-fil-ph",67949:"webinar-locale-ko-kr",67953:"artifacts-platform-locale-cs-cz",67960:"meeting-analytics-locale-ko-kr",67973:"components-screen-recorder72",67977:"meeting-options-locale-lv-lv",67989:"audience-view-dialog-locale-th-th",67997:"meetingFlyout-locale-az-latn-az",68018:"otlang38",68036:"header-graphql-search-box-input-container",68057:"meet-for-work-locale-nl-nl",68074:"recurrence-locale-et-ee",68095:"data-resolvers-transcript-settings-store",68123:"meet-app",68286:"ga-IE-UiStrings-json",68299:"fns43",68304:"main-locale-et-ee",68312:"meeting-analytics-locale-lv-lv",68318:"shareCallout",68341:"hostUxStrings51",68400:"data-resolvers-mfu-contacts",68446:"hostDefaultsStrings80",68452:"InformationProtectionStrings33",68472:"webinar-locale-pl-pl",68507:"data-resolvers-missed-mtma-notifications",68557:"broadcast-app",68597:"biometric-enrollment-locale-kk-kz",68640:"cast-locale-pt-br",68677:"hostUxStrings59",68688:"freemium-upgrade-locale-ro-ro",68722:"messaging-locale-kk-kz",68734:"calendar-locale-de-de",68740:"calls-main-app",68748:"sd-Arab-PK-comment-pane-strings-jsonOfficeOnlineStringResource",68771:"otlang22",68778:"calendar-app",68781:"breakoutRooms-locale-he-il",68794:"smart-device-locale-en-us",68810:"mt-MT-comment-pane-strings-jsonOfficeOnlineStringResource",68858:"pluginBareBones",68880:"hostUxStrings55",68889:"onecamera-locale-sv",68935:"meeting-options-locale-vi-vn",68957:"artifacts-platform-locale-ko-kr",69006:"calendar-locale-sr-latn-rs",69081:"services-external-accounts",69085:"meeting-room-console-locale-it-it",69109:"freemium-upgrade-locale-et-ee",69120:"webinar-locale-sq-al",69144:"share-email-locale-pt-br",69177:"teams-and-channels-locale-mk-mk",69195:"categories-nb-no-json",69198:"InformationProtectionStrings69",69338:"biometric-enrollment-locale-hi-in",69375:"otlang108",69380:"people-targeting-locale-pt-pt",69417:"packageAnalyticsAssets",69482:"meeting-analytics-locale-az-latn-az",69541:"components-screen-recorder32",69545:"main-locale-vi-vn",69621:"webinar-locale-ar-sa",69622:"school-locale-he-il",69652:"wiki-locale-ca-es-valencia",69658:"coach-report-locale-it-it",69663:"pskin",69675:"categories-is-is-json",69706:"wiki-locale-it-it",69752:"categories-ga-ie-json",69790:"sht-searchanswerteamsstrings_es-kn",69891:"discover-surface-locale-zh-cn",69894:"meeting-bot-locale-nb-no",69907:"otlang114",69957:"aRes33",69971:"search-locale-gl-es",69982:"live-interpreter-promotion-dialog-container",69983:"aRes17",69990:"wiki-locale-pt-pt",70041:"cast-locale-bg-bg",70059:"otlang110",70094:"calendar-left-rail",70103:"video-capture-locale-lt-lt",70152:"tti-polyfill",70175:"guardians-locale-sv-se",70181:"meeting-bot-locale-ca-es",70182:"meetingFlyout-locale-cs-cz",70200:"recurrence-locale-gl-es",70225:"data-resolvers-shell",70245:"components-screen-recorder50",70246:"sht-searchanswerteamsstrings_es-cs",70265:"breakout-rooms-pre-assign-dialog",70266:"fns77",70279:"messaging-locale-gl-es",70293:"semantic-object-locale-az-latn-az",70326:"calling-app",70357:"data-resolvers-browser-url-preview",70409:"sv-SE-UiStrings-json",70410:"calling-devices-panel",70421:"components-screen-recorder58",70498:"freemium-upgrade-locale-zh-tw",70500:"aRes56",70542:"extensibility-locale-nb-no",70582:"otlang6",70602:"esp-locale-mk-mk",70676:"discover-surface-locale-hr-hr",70706:"survey-locale-ca-es-valencia",70716:"main-locale-hi-in",70723:"search-locale-hr-hr",70796:"virtualEvents-locale-gl-es",70822:"en-GB-UiStrings-json",70845:"notesHeaderTooltip",70849:"meeting-recap-locale-az-latn-az",70872:"hostDefaultsStrings17",70881:"share-email-locale-tr-tr",70898:"message-escalate-dialog-locale-pl-pl",70902:"message-escalate-dialog-locale-az-latn-az",70913:"calendar-locale-fil-ph",70918:"discover-surface-locale-ar-sa",70941:"long-lived-subscription-for-channels-app",70950:"sht-searchanswerteamsstrings_es-lo-la",70972:"services-import-msa-contacts",71021:"esp-locale-ru-ru",71023:"meeting-bot-locale-sl-si",71040:"fns41",71045:"health-locale-nn-no",71121:"broadcast-locale-nn-no",71136:"sht-cortextopictypeswebstrings_en-us",71154:"coach-report-app",71161:"aRes13",71216:"calendar-locale-hr-hr",71285:"virtualEvents-locale-vi-vn",71288:"message-escalate-dialog-locale-sl-si",71326:"video-message-locale-vi-vn",71383:"otlang106",71401:"services-async-media",71409:"people-targeting-locale-es-es",71451:"quz-PE-comment-pane-strings-jsonOfficeOnlineStringResource",71482:"meetingFlyout-locale-sl-si",71515:"guardians-locale-sk-sk",71592:"meet-for-work-locale-th-th",71599:"sht-cortextopictypeswebstrings_ml",71627:"sht-cortextopictypeswebstrings_es",71670:"smart-device-locale-az-latn-az",71678:"semantic-object-locale-hr-hr",71722:"sht-cortextopictypeswebstrings_sw",71726:"video-message",71761:"video-message-locale-uk-ua",71782:"otlang0",71805:"otlang15",71816:"wiki-locale-kk-kz",71835:"meetingFlyout-locale-lv-lv",71856:"InformationProtectionStrings84",71920:"biometric-enrollment-locale-fil-ph",71948:"wiki-locale-mk-mk",71980:"cy-gb-strings-jsonThinRes",71993:"meeting-options-locale-id-id",72001:"channels-locale-sr-latn-rs",72011:"meeting-recap-locale-sk-sk",72042:"services-io-sensitivity-label-policy-settings",72055:"audience-view-dialog-locale-id-id",72069:"si-LK-comment-pane-strings-jsonOfficeOnlineStringResource",72136:"hostDefaultsStrings54",72258:"smart-device-locale-ka-ge",72287:"sht-cortextopictypeswebstrings_cy",72297:"extensibility-locale-nn-no",72324:"calendar-locale-az-latn-az",72325:"virtualEvents-locale-hu-hu",72333:"meeting-options-locale-bg-bg",72346:"precompiled-shared-worker",72371:"InformationProtectionStrings41",72479:"survey-locale-az-latn-az",72484:"pt-PT-UiStrings-json",72487:"video-capture-locale-hi-in",72501:"semantic-object-locale-pt-br",72526:"sht-searchanswerteamsstrings_es-kok",72557:"services-tenant-service",72564:"config-life",72572:"otlang39",72638:"files-locale-es-es",72642:"sht-searchanswerteamsstrings_es-zh-hans",72744:"meeting-bot-locale-fil-ph",72767:"cast-locale-zh-cn",72842:"services-search-meeting-summary",72925:"sq-AL-comment-pane-strings-jsonOfficeOnlineStringResource",72936:"hostDefaultsStrings47",72944:"be-BY-comment-pane-strings-jsonOfficeOnlineStringResource",73047:"meeting-bot-locale-eu-es",73051:"survey-locale-nl-nl",73121:"teams-grid",73142:"recurrence-locale-nb-no",73166:"survey-locale-eu-es",73170:"survey-locale-id-id",73177:"video-message-locale-ca-es-valencia",73206:"officeFluidOneDsSink",73312:"calendar-locale-is-is",73321:"audience-view-dialog-locale-fr-ca",73339:"breakoutRooms-locale-es-es",73343:"sht-cortextopictypeswebstrings_ja",73349:"aRes15",73404:"ar-SA-comment-pane-strings-jsonOfficeOnlineStringResource",73432:"video-capture-locale-sv-se",73442:"otlang8",73460:"bs-Latn-BA-comment-pane-strings-jsonOfficeOnlineStringResource",73507:"virtualEvents-locale-ja-jp",73523:"people-targeting-locale-lv-lv",73533:"components-screen-recorder36",73540:"communities-onboarding",73649:"otlang31",73661:"hostDefaultsStrings22",73676:"data-resolvers-user",73680:"categories-zh-hk-json",73696:"semantic-object-locale-ro-ro",73698:"otlang35",73717:"extensibility-locale-da-dk",73736:"sht-searchanswerteamsstrings_es-et",73771:"meeting-recap-locale-ca-es-valencia",73773:"teams-and-channels-locale-es-es",73795:"cast-locale-sl-si",73804:"meeting-room-console-locale-ca-es",73806:"services-giphy",73824:"fns79",73825:"sht-cortextopictypeswebstrings_ky",73826:"share-email-locale-sk-sk",73836:"itemsettileslist",73851:"broadcast-locale-en-gb",73889:"video-message-locale-ca-es",73890:"onecamera-locale-pl",73956:"meetingFlyout-locale-es-mx",73969:"data-resolvers-browser-survey",73973:"mk-MK-comment-pane-strings-jsonOfficeOnlineStringResource",73985:"virtualEvents-locale-zh-cn",73998:"webrec2-language-ca",74006:"otlang51",74091:"calling-app-post-critical",74120:"share-email-locale-da-dk",74135:"meeting-room-console-locale-sv-se",74180:"hostDefaultsStrings4",74186:"InformationProtectionStrings0",74188:"files-locale-bg-bg",74217:"teams-and-channels-locale-pt-pt",74224:"gallery-locale-et-ee",74237:"meetingFlyout-locale-zh-cn",74249:"calendar-locale-pt-pt",74282:"extensibility-locale-uk-ua",74322:"channels-locale-nb-no",74361:"onecamera-locale-tr",74403:"teams-and-channels-locale-az-latn-az",74424:"sht-searchanswerteamsstrings_es-nl",74444:"wiki-locale-nb-no",74449:"meetingFlyout-locale-ca-es-valencia",74471:"biometric-enrollment-locale-lt-lt",74515:"calling-locale-ko-kr",74516:"mo-people-selection",74543:"categories-ne-np-json",74574:"files-locale-ar-sa",74580:"InformationProtectionStrings13",74590:"survey-locale-da-dk",74604:"guardians-locale-sr-latn-rs",74687:"guardians-locale-gl-es",74691:"sk-strings-jsonThinRes",74736:"closed-captions-settings-panel",74747:"onecamera-locale-ko",74750:"data-resolvers-ai-insights-feedback",74783:"meetingFlyout-locale-he-il",74786:"semantic-object-locale-nn-no",74801:"biometric-enrollment-locale-nl-nl",74833:"onecamera-locale-bs",74837:"esp-locale-ca-es-valencia",74847:"esp-locale-zh-cn",74853:"share-email-locale-ar-sa",74863:"hostUxStrings12",74896:"biometric-enrollment-locale-id-id",74906:"meeting-analytics-locale-uk-ua",74913:"pt-BR-comment-pane-strings-jsonOfficeOnlineStringResource",74917:"gallery-locale-ar-sa",74934:"hostUxStrings35",74972:"discover-surface-locale-kk-kz",75039:"categories-mt-mt-json",75041:"meeting-room-console-locale-tr-tr",75086:"meet-for-work-locale-hr-hr",75123:"recurrence-locale-fr-ca",75125:"aRes25",75141:"sht-searchanswerteamsstrings_es-mi-nz",75145:"data-resolvers-desktop-client-shortcuts",75174:"sht-searchanswerteamsstrings_es-ja",75229:"MeetingNotesComponent",75230:"data-resolvers-app-ratings-and-reviews",75238:"health-locale-nl-nl",75287:"otlang86",75292:"hostUxStrings4",75294:"school-locale-cy-gb",75363:"biometric-enrollment-locale-ar-sa",75402:"school-locale-ru-ru",75413:"broadcast-locale-pt-br",75447:"search-locale-sr-latn-rs",75499:"data-resolvers-coach-report",75504:"survey-locale-sr-latn-rs",75519:"survey-locale-pl-pl",75546:"files-locale-sl-si",75558:"meeting-options-app",75610:"basic-searchbox-2",75613:"files-locale-eu-es",75616:"categories-or-in-json",75667:"meeting-analytics-locale-de-de",75707:"otSearchFeedbackButton",75758:"msteams/components-hosted-web-content",75810:"calling-empty-notes-page",75818:"data-resolvers-browser-app-state",75833:"hostUxStrings37",75863:"nova-sb-variant-teams-exp",75873:"webrec2-language-ru",75895:"broadcast-locale-zh-cn",75925:"services-calling",75931:"wiki-app",75985:"webrec2-language-prs-af",76001:"teams-and-channels-locale-ca-es",76003:"data-resolvers-connected-calendar",76007:"onecamera-locale-ro",76023:"data-resolvers-browser-tpn",76025:"hu-strings-jsonThinRes",76049:"services-payment",76118:"guardians-locale-tr-tr",76130:"services-presence",76138:"data-resolvers-biometric-enrollment",76141:"webinar-locale-id-id",76153:"eu-ES-UiStrings-json",76179:"whiteboard-renderer",76194:"meet-for-work-locale-fil-ph",76197:"meeting-bot-locale-ja-jp",76205:"extensibility-locale-fr-fr",76211:"audience-view-dialog-locale-ja-jp",76240:"main-locale-th-th",76260:"data-resolvers-apps-monet",76274:"breakoutRooms-locale-ko-kr",76281:"discover-surface-locale-ka-ge",76293:"search-locale-it-it",76317:"semantic-object-locale-fil-ph",76327:"cast-locale-sr-latn-rs",76355:"channels-locale-et-ee",76370:"esp-locale-id-id",76378:"aRes21",76382:"flipcameraltst",76418:"meeting-recap-locale-es-es",76425:"notesFluidxSensitivityButton",76426:"files-locale-sr-latn-rs",76441:"fi-FI-comment-pane-strings-jsonOfficeOnlineStringResource",76445:"cortex-topics-bootstrapper-topics-sdk",76476:"webrec2-language-nl",76486:"sht-cortextopictypeswebstrings_ar",76504:"coach-report-locale-ko-kr",76513:"buttonCollection",76547:"discover-surface-locale-en-gb",76583:"audience-view-dialog-locale-es-es",76605:"esp-locale-es-es",76657:"cast-app",76710:"sht-cortextopictypeswebstrings_bg",76738:"hostUxStrings68",76803:"components-screen-recorder94",76807:"recurrence-locale-uk-ua",76808:"services-report-concern",76843:"onecamera-locale-bg",76896:"fns78",76902:"artifacts-platform-locale-es-mx",76912:"hostUxStrings31",76940:"channels-locale-mk-mk",76945:"data-resolvers-search-contextual",77060:"components-screen-recorder52",77067:"gallery-locale-nb-no",77078:"hostDefaultsStrings30",77090:"meet-for-work-locale-ja-jp",77093:"fi-FI-UiStrings-json",77122:"artifacts-platform-locale-ka-ge",77153:"broadcast-locale-sr-latn-rs",77159:"components-screen-recorder0",77174:"meeting-recap-locale-kk-kz",77183:"sht-searchanswerteamsstrings_es-sd-arab-pk",77209:"services-chat",77222:"files-locale-cs-cz",77233:"freemium-upgrade-notification",77285:"meeting-room-console-locale-ja-jp",77294:"precompiled-web-worker",77330:"virtualEvents-locale-lt-lt",77357:"recurrence-locale-zh-cn",77362:"sht-searchanswerteamsstrings_es-ta",77384:"discover-surface-locale-bg-bg",77397:"ru-strings-jsonThinRes",77412:"services-third-party-calendar",77414:"meet-for-work-locale-bg-bg",77455:"smart-device-locale-hi-in",77459:"InformationProtectionStrings6",77496:"virtualEvents-locale-is-is",77511:"sht-cortextopictypeswebstrings_bs-latn-ba",77527:"gallery-locale-hu-hu",77540:"wiki-locale-ko-kr",77550:"bn-BD-comment-pane-strings-jsonOfficeOnlineStringResource",77570:"pl-strings-jsonThinRes",77639:"ar-strings-jsonThinRes",77649:"components-screen-recorder68",77661:"calendar-locale-cy-gb",77677:"virtualEvents-locale-it-it",77697:"data-resolvers-browser-payment",77725:"sht-searchanswerteamsstrings_es-ar",77741:"hostDefaultsStrings49",77747:"people-targeting-locale-sr-latn-rs",77750:"channels-locale-sv-se",77771:"fns6",77772:"components-screen-recorder44",77793:"hostUxStrings64",77808:"aRes2",77847:"video-capture-locale-cy-gb",77869:"webinar-locale-hr-hr",77953:"meetingFlyout-locale-et-ee",77960:"video-capture-locale-zh-tw",78001:"data-resolvers-search-substrate",78013:"group-template-cta-container",78026:"sht-cortextopictypeswebstrings_km-kh",78052:"people-targeting-locale-ro-ro",78053:"services-search-prefetch",78066:"sht-searchanswerteamsstrings_es-pt",78092:"hostUxStrings85",78117:"InformationProtectionStrings49",78130:"semantic-object-locale-sl-si",78153:"coach-report-locale-cy-gb",78220:"calendar-locale-ca-es-valencia",78324:"freemium-upgrade-locale-hi-in",78334:"meeting-options-locale-mk-mk",78402:"meeting-room-console-locale-lv-lv",78408:"fns71",78432:"meeting-recap-locale-en-gb",78433:"recurrence-locale-pt-pt",78456:"main-locale-kk-kz",78516:"adaptivecard-react",78526:"video-capture-locale-ca-es-valencia",78537:"meeting-options-locale-sq-al",78580:"extensibility-locale-sq-al",78594:"data-resolvers-apps-platform",78609:"share-email-locale-hu-hu",78623:"fns25",78641:"calendar-locale-tr-tr",78713:"onecamera-locale-hr",78729:"hostUxStrings13",78746:"search-locale-fi-fi",78755:"webinar-locale-da-dk",78773:"school-locale-uk-ua",78778:"virtualEvents-locale-ko-kr",78792:"health-locale-sq-al",78800:"webinar-locale-fr-fr",78815:"services-meeting-bot",78832:"services-emoticon",78848:"designer-mini-popup",78857:"discover-surface-locale-it-it",78858:"files-locale-uk-ua",78864:"survey-locale-bg-bg",78866:"data-resolvers-team-gallery",78910:"InformationProtectionStrings82",78981:"broadcast-locale-ru-ru",78994:"breakoutRooms-locale-ro-ro",78996:"data-resolvers-meeting-templates",79010:"search-locale-ro-ro",79019:"meetingFlyout-locale-uk-ua",79071:"data-resolvers-artifacts-platform",79088:"cast-locale-fi-fi",79104:"cast-locale-ru-ru",79130:"smart-device-locale-ru-ru",79131:"artifacts-platform-locale-ja-jp",79156:"fns1",79188:"smart-device-login",79197:"services-external-calendar-email-address",79231:"smart-device-locale-vi-vn",79297:"meetingFlyout-locale-cy-gb",79307:"webrec2-language-es-mx",79316:"calling-locale-fi-fi",79355:"calling-locale-nn-no",79455:"data-resolvers-browser-virtual-events",79506:"services-search",79533:"otlang9",79537:"aRes20",79613:"sht-cortextopictypeswebstrings_fr-ca",79629:"hostUxStrings15",79659:"video-message-locale-he-il",79737:"hostUxStrings29",79753:"message-escalate-dialog-locale-nn-no",79754:"files-locale-et-ee",79786:"sht-searchanswerteamsstrings_es-quz-pe",79804:"freemium-upgrade-locale-cy-gb",79833:"fns65",79880:"video-capture-locale-cs-cz",79889:"fns27",79932:"data-resolvers-people-targeting",79957:"gallery-locale-vi-vn",79959:"message-escalate-dialog-locale-he-il",79984:"artifacts-platform-locale-lv-lv",79993:"sht-searchanswerteamsstrings_es-mr",80016:"search-locale-az-latn-az",80024:"lv-strings-jsonThinRes",80041:"compose-box-v1-renderer",80052:"chat-join-screen-share-button",80070:"categories-zh-cn-json",80093:"meeting-room-console-locale-fi-fi",80117:"main-locale-fil-ph",80126:"ja-JP-comment-pane-strings-jsonOfficeOnlineStringResource",80127:"share-email-locale-is-is",80129:"hostUxStrings82",80163:"fns53",80165:"video-capture-locale-pt-pt",80184:"main-locale-es-es",80243:"hostUxStrings47",80246:"wiki-locale-pt-br",80253:"search-locale-fr-ca",80262:"calendar-locale-hi-in",80275:"sht-searchanswerteamsstrings_es-mn-mn",80282:"school-locale-sr-latn-rs",80293:"semantic-object-locale-fi-fi",80319:"otlang27",80403:"lt-LT-comment-pane-strings-jsonOfficeOnlineStringResource",80414:"biometric-enrollment-entry",80473:"meeting-options-locale-fi-fi",80516:"freemium-upgrade-locale-zh-cn",80520:"health-locale-da-dk",80540:"meeting-room-console-locale-nb-no",80560:"fns4",80570:"meet-for-work-locale-it-it",80574:"data-resolvers-taskbar",80579:"data-resolvers-notifications",80584:"fns48",80648:"people-targeting-locale-en-gb",80664:"zh-tw-strings-jsonThinRes",80670:"freemium-upgrade-locale-pl-pl",80694:"categories-sl-si-json",80699:"semantic-object-locale-uk-ua",80707:"cs-strings-jsonThinRes",80735:"nl-NL-comment-pane-strings-jsonOfficeOnlineStringResource",80799:"smart-device-locale-nn-no",80809:"onecamera-locale-nl",80839:"broadcast-locale-sk-sk",80859:"smart-device-modal",80907:"InformationProtectionStrings66",80947:"freemium-upgrade-locale-id-id",80956:"survey-locale-th-th",81093:"video-capture-locale-ko-kr",81102:"recurrence-locale-mk-mk",81148:"deferred",81174:"view-schema",81205:"main-locale-lt-lt",81227:"health-locale-kk-kz",81239:"message-escalate-dialog-locale-fr-fr",81249:"webinar-locale-fil-ph",81288:"message-escalate-dialog-locale-ca-es-valencia",81293:"components-screen-recorder92",81381:"breakoutRooms-locale-ka-ge",81439:"hostUxStrings20",81481:"discover-surface-locale-ro-ro",81516:"webinar-locale-de-de",81529:"smart-device-locale-fr-fr",81550:"coach-report-locale-hr-hr",81565:"breakoutRooms-locale-sr-latn-rs",81578:"jszip",81641:"calendar-scheduling-form-app",81647:"chat-app",81682:"otlang82",81683:"school-locale-sv-se",81694:"data-resolvers-third-party-calendar",81698:"InformationProtectionStrings14",81706:"calling-locale-is-is",81735:"video-message-locale-en-gb",81783:"share-email-locale-zh-tw",81802:"otlang12",81844:"otlang45",81879:"semantic-object-locale-fr-ca",81897:"meeting-analytics-locale-eu-es",81900:"otlang55",81916:"InformationProtectionStrings4",81933:"otlang4",81939:"otlang42",81974:"discover-surface-locale-nb-no",82009:"onecamera-locale-ka",82023:"semantic-object-locale-eu-es",82033:"sht-searchanswerteamsstrings_es-tr",82080:"meeting-room-console-locale-sl-si",82098:"calling-locale-nl-nl",82110:"components-stage-view-entry",82117:"survey-locale-hr-hr",82118:"virtualEvents-locale-da-dk",82136:"freemium-upgrade-locale-da-dk",82175:"pluginInteractivity",82176:"wiki-locale-pl-pl",82196:"discover-surface-locale-ca-es-valencia",82222:"meeting-options-locale-fr-ca",82230:"wiki-locale-hi-in",82265:"tr-TR-UiStrings-json",82271:"react-diagnostics",82290:"broadcast-producer-screen",82329:"data-resolvers-platform-tabs",82366:"message-escalate-dialog-locale-is-is",82409:"webrec2-effects-backdrops",82415:"ro-RO-UiStrings-json",82418:"school-locale-id-id",82439:"coach-report-locale-sk-sk",82453:"aRes47",82522:"calling-locale-eu-es",82596:"hostDefaultsStrings61",82703:"teams-and-channels-locale-et-ee",82722:"messaging-locale-es-es",82749:"share-email-locale-hr-hr",82754:"meetingFlyout-locale-hr-hr",82786:"sht-searchanswerteamsstrings_es-or",82787:"aRes5",82789:"sht-teams-paaanswers",82831:"webinar-locale-fr-ca",82850:"onecamera-locale-mk",82856:"teams-and-channels-locale-es-mx",82870:"sht-cortextopictypeswebstrings_kk",82874:"categories-vi-vn-json",82880:"onecamera-locale-sr-latn-rs",82901:"meeting-room-console-locale-kk-kz",82922:"files-locale-gl-es",82927:"otlang24",82989:"search-locale-ar-sa",82991:"data-resolvers-channels",83005:"artifacts-platform-locale-en-us",83017:"calling-locale-ro-ro",83028:"data-resolvers-update-client-state",83059:"gallery-locale-id-id",83062:"main-locale-pl-pl",83107:"calendar-locale-ro-ro",83110:"files-locale-sv-se",83194:"core-services-cdl-worker-debug",83219:"freemium-upgrade-locale-fil-ph",83226:"meeting-analytics-locale-zh-tw",83240:"main-locale-ca-es",83254:"health-locale-is-is",83314:"aRes44",83393:"gallery-locale-eu-es",83400:"teams-and-channels-locale-sv-se",83423:"cast-locale-nl-nl",83438:"channels-locale-kk-kz",83483:"services-google-calendar-authentication",83498:"sht-searchanswerteamsstrings_es-ko",83527:"video-message-locale-fr-ca",83548:"services-meeting-questions-and-answers",83549:"messaging-locale-zh-tw",83593:"messaging-locale-sv-se",83607:"de-strings-jsonThinRes",83619:"channels-locale-ru-ru",83644:"cs-CZ-UiStrings-json",83650:"data-resolvers-cross-tenant-policies",83654:"broadcast-locale-hr-hr",83663:"components-screen-recorder62",83695:"meeting-options-locale-az-latn-az",83703:"te-IN-UiStrings-json",83748:"smart-device-locale-eu-es",83750:"onecamera-locale-vi",83772:"calendar-locale-kk-kz",83795:"school-locale-ca-es",83819:"components-screen-recorder112",83900:"dty-search-box-input-default",83906:"meeting-analytics-locale-sq-al",83992:"calendar-locale-es-es",83999:"discover-surface-locale-da-dk",84004:"components-calling-quality-feedback",84021:"meetingFlyout-locale-ru-ru",84037:"components-breakout-rooms-app",84042:"data-resolvers-brb",84057:"gd-gb-comment-pane-strings-jsonOfficeOnlineStringResource",84063:"audience-view-dialog-locale-sk-sk",84074:"otlang92",84091:"data-resolvers-invite-links",84100:"otlang88",84197:"guardians-locale-ka-ge",84224:"coach-report-locale-eu-es",84226:"data-resolvers-contacts-sync-settings",84265:"breakoutRooms-locale-bg-bg",84277:"otlang96",84299:"meeting-bot-locale-is-is",84335:"data-resolvers-user-license",84360:"freemium-upgrade-locale-es-es",84375:"calendar-meeting-artifacts-renderer",84399:"share-email-locale-vi-vn",84427:"data-resolvers-closed-captions",84434:"artifacts-platform-locale-th-th",84441:"broadcast-locale-ca-es-valencia",84497:"video-capture-locale-ka-ge",84517:"search-locale-id-id",84539:"onecamera-locale-he",84548:"components-screen-recorder8",84586:"holographic-canvas",84591:"nova-app-bar",84615:"services-call-recording",84671:"ja-JP-UiStrings-json",84713:"audience-view-dialog-locale-it-it",84765:"sht-cortextopictypeswebstrings_ko",84766:"main-locale-el-gr",84787:"channels-locale-he-il",84836:"calendar-locale-zh-cn",84843:"components-screen-recorder6",84858:"dty-search-box-input-v8",84860:"packageFileAnalytics",84862:"video-capture-locale-ru-ru",84870:"sht-cortextopictypeswebstrings_bn-in",84885:"school-locale-sk-sk",84910:"eu-strings-jsonThinRes",84926:"video-message-locale-pl-pl",84956:"sw-KE-comment-pane-strings-jsonOfficeOnlineStringResource",84964:"meeting-details-editor-area-v2",84975:"guardians-locale-bg-bg",84982:"meeting-recap-locale-nb-no",85077:"services-io-browser-calling-video-rendering",85108:"services-app-based-link",85197:"hu-HU-UiStrings-json",85260:"sht-searchanswerteamsstrings_es-sr-cyrl-ba",85299:"discover-surface-locale-zh-tw",85333:"main-locale-he-il",85340:"meeting-analytics-locale-fr-ca",85358:"messaging-locale-nn-no",85381:"esp-locale-fr-ca",85421:"gallery-locale-kk-kz",85446:"data-resolvers-discover-surface",85470:"gallery-locale-nn-no",85503:"guardians-locale-th-th",85538:"sht-cortextopictypeswebstrings_kok",85541:"discover-surface-locale-id-id",85550:"search-locale-th-th",85565:"breakoutRooms-locale-ru-ru",85608:"teams-and-channels-locale-hu-hu",85637:"coach-report-locale-ca-es",85653:"aRes36",85677:"meeting-bot-locale-gl-es",85716:"smart-device-locale-sk-sk",85783:"video-message-locale-es-es",85819:"webrec2-language-fr",85843:"school-locale-fi-fi",85869:"semantic-object-locale-cs-cz",85883:"entity-more-info-app",85976:"onecamera-locale-fr",85991:"meeting-room-console-locale-gl-es",85993:"sht-searchanswerteamsstrings_es-ha-latn-ng",85995:"something-went-wrong-empty-state",86007:"meetingFlyout-locale-sk-sk",86018:"extensibility-locale-lv-lv",86032:"health-locale-az-latn-az",86060:"data-resolvers-search",86090:"data-resolvers-example",86113:"video-message-locale-it-it",86142:"video-message-locale-el-gr",86146:"cast-locale-fil-ph",86155:"smart-device-locale-bg-bg",86183:"smart-device-locale-sq-al",86194:"meetingFlyout-locale-nn-no",86205:"data-resolvers-teams-and-channels",86262:"calendar-invite-expansion",86264:"bg-BG-comment-pane-strings-jsonOfficeOnlineStringResource",86272:"services-substrate-recommendations",86347:"calling-locale-zh-tw",86354:"onecamera-locale-th",86358:"meetingFlyout-locale-id-id",86380:"InformationProtectionStrings8",86395:"hostUxStrings22",86416:"artifacts-platform-locale-sl-si",86509:"sht-teams-externalanswers",86549:"search-locale-es-es",86608:"biometric-enrollment-locale-en-gb",86639:"data-resolvers-channel-messages",86657:"or-IN-UiStrings-json",86683:"virtualEvents-locale-id-id",86754:"discover-surface-locale-sl-si",86757:"meeting-bot-locale-sv-se",86793:"hostUxStrings83",86798:"files-locale-cy-gb",86824:"data-resolvers-tenant-analytics",86855:"guardians-locale-ca-es-valencia",86886:"categories-cy-gb-json",86892:"pluginWebAppAboutVideo",86910:"hostUxStrings34",86973:"kk-KZ-UiStrings-json",86989:"otlang70",87024:"channels-locale-ca-es",87034:"wiki-locale-fr-fr",87036:"coach-report-locale-th-th",87084:"smart-device-locale-sr-latn-rs",87110:"health-locale-fr-ca",87150:"otlang49",87173:"smart-device-locale-kk-kz",87191:"dty-clear-button-v8",87227:"data-resolvers-system-settings",87237:"recurrence-locale-ca-es",87254:"sht-cortextopictypeswebstrings_gl",87271:"smart-device-locale-hu-hu",87309:"reactions-overlay-webgl-renderer",87310:"calendar-locale-ka-ge",87311:"hostUxStrings39",87314:"data-resolvers-contacts-sync",87329:"webinar-locale-mk-mk",87384:"webrec2-language-et",87391:"data-resolvers-app-device-permission",87392:"data-resolvers-external-calendar-email-address",87408:"meeting-analytics-locale-fil-ph",87417:"biometric-enrollment-locale-bg-bg",87434:"virtualEvents-locale-en-gb",87452:"fns0",87480:"services-image-proxy",87547:"fns32",87562:"semantic-object-locale-en-us",87574:"coach-report-locale-sl-si",87584:"aRes28",87598:"files-locale-hi-in",87793:"ca-ES-UiStrings-json",87808:"files-locale-az-latn-az",87809:"aRes22",87811:"otlang68",87844:"survey-locale-fr-fr",87846:"health-locale-es-mx",87857:"freemium-upgrade-locale-ja-jp",87921:"esp-locale-bg-bg",87927:"services-io-azure-maps",88026:"calling-cdl",88029:"video-capture-locale-es-mx",88059:"messaging-locale-de-de",88094:"otlang48",88100:"components-search-contextual",88120:"otlang3",88137:"services-meeting-templates",88146:"gallery-locale-az-latn-az",88164:"search-locale-kk-kz",88207:"survey-locale-cs-cz",88216:"people-targeting-locale-eu-es",88262:"message-escalate-dialog-locale-ru-ru",88282:"broadcast-locale-pl-pl",88314:"data-resolvers-browser-chat",88338:"custom-audience-view-backgrounds-dialog",88357:"annotation-app",88360:"wiki-locale-ru-ru",88394:"mr-IN-UiStrings-json",88409:"cast-locale-cy-gb",88412:"otlang80",88437:"people-targeting-locale-pl-pl",88441:"breakoutRooms-locale-sk-sk",88453:"aRes9",88458:"calendar-locale-uk-ua",88466:"discover-surface-locale-es-mx",88475:"services-tenant-analytics",88478:"calling-locale-pt-br",88531:"semantic-object-locale-ko-kr",88534:"sht-teams-topicanswerchunk",88540:"data-resolvers-tenant-membership",88541:"wiki-locale-tr-tr",88542:"data-resolvers-external-accounts",88553:"audience-view-dialog-locale-az-latn-az",88558:"teams-and-channels-locale-gl-es",88582:"video-capture-locale-vi-vn",88664:"guardians-locale-en-gb",88681:"main-locale-sv-se",88725:"webinar-locale-sl-si",88729:"components-screen-recorder98",88771:"InformationProtectionStrings50",88777:"freemium-upgrade-locale-sl-si",88787:"meeting-options-locale-gl-es",88811:"broadcast-locale-en-us",88861:"coach-report-locale-hu-hu",88864:"meeting-recap-locale-ca-es",88876:"meeting-room-console-locale-ca-es-valencia",88890:"meet-for-work-locale-fr-fr",88891:"InformationProtectionStrings27",88901:"semantic-object-locale-lv-lv",88909:"channels-locale-zh-cn",88910:"esp-locale-hr-hr",88919:"platform-modal",88927:"school-locale-th-th",88951:"InformationProtectionStrings38",88975:"services-logs-files",89010:"de-DE-comment-pane-strings-jsonOfficeOnlineStringResource",89043:"survey-locale-kk-kz",89080:"wiki-locale-zh-cn",89086:"otlang16",89104:"otlang21",89107:"categories-ar-sa-json",89109:"main-locale-hr-hr",89118:"guardians-locale-hr-hr",89131:"live-interpretation-join-dialog-container",89139:"esp-locale-pl-pl",89142:"otlang64",89167:"people-targeting-locale-hr-hr",89183:"meeting-options-locale-zh-tw",89220:"fr-FR-comment-pane-strings-jsonOfficeOnlineStringResource",89275:"channels-locale-ca-es-valencia",89430:"cast-locale-is-is",89465:"sht-searchanswerteamsstrings_es-pl",89483:"messaging-locale-tr-tr",89499:"aRes1",89509:"share-email-locale-id-id",89525:"coach-report-locale-he-il",89526:"hostDefaultsStrings81",89537:"hostDefaultsStrings7",89544:"messaging-locale-hr-hr",89560:"message-escalate-dialog-locale-vi-vn",89589:"categories-ta-in-json",89591:"meet-for-work-locale-ca-es-valencia",89649:"messaging-locale-ar-sa",89676:"semantic-object-locale-id-id",89683:"messaging-locale-eu-es",89689:"data-resolvers-guardians",89711:"video-message-locale-bg-bg",89733:"onecamera-locale-lv",89755:"lv-LV-UiStrings-json",89798:"meet-for-work-locale-lv-lv",89829:"services-loki",89847:"breakoutRooms-locale-pt-br",89869:"audience-view-dialog-locale-pl-pl",89903:"guardians-locale-pl-pl",89905:"gallery-locale-sl-si",89907:"breakoutRooms-locale-et-ee",89910:"video-capture-locale-ro-ro",89931:"otlang84",89961:"fns55",89979:"et-EE-comment-pane-strings-jsonOfficeOnlineStringResource",89980:"coach-report-locale-nn-no",89997:"meeting-recap-locale-sr-latn-rs",90045:"smart-device-locale-ar-sa",90080:"InformationProtectionStrings37",90082:"aRes11",90094:"wiki-locale-de-de",90109:"artifacts-platform-locale-sv-se",90134:"webrec2-language-ro",90166:"meeting-options-locale-uk-ua",90189:"survey-locale-nn-no",90224:"categories-ko-kr-json",90237:"wiki-locale-sl-si",90250:"onecamera-locale-ca",90265:"gallery-locale-el-gr",90378:"data-resolvers-external-accounts-response",90477:"extensibility-locale-gl-es",90500:"hostDefaultsStrings28",90514:"coach-report-locale-ar-sa",90531:"video-capture-locale-fil-ph",90533:"categories-az-latn-az-json",90534:"InformationProtectionStrings81",90565:"recurrence-locale-sv-se",90579:"services-discover-surface-feedback",90580:"breakoutRooms-locale-nl-nl",90606:"discover-surface-locale-ja-jp",90625:"coach-report-locale-nl-nl",90631:"meeting-analytics-locale-en-us",90658:"meeting-room-console-locale-nn-no",90684:"categories-cs-cz-json",90720:"meetingFlyout-locale-ko-kr",90750:"discover-surface-lazy",90752:"sht-cortextopictypeswebstrings_kn",90766:"message-escalate-dialog-locale-gl-es",90773:"smart-device-locale-es-es",90842:"meeting-recap-locale-lv-lv",90928:"main-locale-pt-br",90963:"data-resolvers-browser-audience",90972:"coach-report-teams-app-wrapper",90999:"download-the-latest-desktop-app",91025:"calling-meeting-info-panel",91029:"data-resolvers-browser-meeting-artifacts",91036:"teams-search-prefetch-configs",91041:"meeting-analytics-locale-cy-gb",91068:"meeting-analytics-locale-it-it",91086:"fns58",91135:"meet-for-work-locale-hi-in",91138:"calendar-locale-nn-no",91139:"meet-for-work-locale-zh-tw",91143:"messaging-locale-it-it",91195:"meeting-recap-locale-is-is",91234:"meeting-bot-locale-fr-fr",91282:"channels-locale-sq-al",91291:"accessibility-settings-panel",91443:"data-resolvers-cypress-only",91457:"data-resolvers-tfl-user",91487:"messaging-locale-ja-jp",91494:"services-atp-safelinks",91496:"webinar-locale-vi-vn",91504:"meeting-analytics-locale-ka-ge",91510:"channels-locale-vi-vn",91546:"otlang40",91549:"uk-UA-UiStrings-json",91596:"school-locale-fr-fr",91600:"otlang20",91643:"recurrence-locale-ca-es-valencia",91679:"gu-IN-UiStrings-json",91716:"messaging-locale-pl-pl",91736:"meeting-analytics-locale-pt-br",91759:"audience-view-dialog-locale-sq-al",91761:"categories-zu-za-json",91773:"sht-searchanswerteamsstrings_es-es",91789:"calling",91829:"meet-for-work-locale-az-latn-az",91838:"post-echo-bot-screen",91910:"files-locale-zh-cn",91920:"sb-stream-policy",91941:"meeting-room-console-locale-he-il",91952:"components-meeting-artifacts",92029:"sht-searchanswerteamsstrings_es-ca-es-valencia",92037:"onecamera-locale-pt-br",92044:"discover-surface-locale-cy-gb",92102:"freemium-upgrade-locale-tr-tr",92151:"data-apollo-broadcast-streaming-attendee",92168:"mn-MN-comment-pane-strings-jsonOfficeOnlineStringResource",92186:"biometric-enrollment-locale-el-gr",92193:"audience-view-dialog-locale-ca-es",92235:"video-capture-locale-bg-bg",92278:"gallery-locale-pt-pt",92313:"hr-HR-UiStrings-json",92326:"hostUxStrings46",92338:"smart-device-agenda-page",92444:"teams-and-channels-locale-lt-lt",92480:"message-escalate-dialog-locale-cs-cz",92481:"smart-device-locale-is-is",92521:"semantic-object-locale-el-gr",92525:"calling-locale-sr-latn-rs",92567:"sht-cortextopictypeswebstrings_te",92574:"main-locale-tr-tr",92584:"video-message-locale-az-latn-az",92617:"categories-ro-ro-json",92621:"aRes24",92650:"files-locale-he-il",92680:"webinar-locale-eu-es",92712:"calendar-locale-bg-bg",92722:"artifacts-platform-locale-kk-kz",92729:"hostUxStrings54",92784:"esp-locale-nn-no",92796:"meet-for-work-locale-da-dk",92819:"meeting-options-locale-en-us",92876:"services-signals",92942:"sht-cortextopictypeswebstrings_mr",92966:"share-email-locale-fr-ca",93007:"files-locale-ka-ge",93048:"channels-locale-en-gb",93050:"search-locale-bg-bg",93088:"et-strings-jsonThinRes",93098:"wiki-locale-cs-cz",93121:"meeting-room-console-locale-zh-tw",93145:"meeting-bot-locale-pt-pt",93186:"hostUxStrings58",93196:"AboutVideoRichTextEditor",93200:"share-email-locale-gl-es",93202:"meeting-room-console-locale-pl-pl",93207:"message-escalate-dialog-locale-el-gr",93241:"breakoutRooms-locale-it-it",93258:"webrec2-language-ar",93288:"webinar-locale-hi-in",93295:"messaging-locale-hi-in",93300:"meetingFlyout-locale-fr-ca",93305:"health-locale-eu-es",93332:"freemium-upgrade-locale-vi-vn",93334:"config-gallatin",93337:"meeting-options-locale-hi-in",93348:"meeting-bot-locale-en-us",93352:"topics-sdk-km-api",93371:"otlang26",93376:"services-io-calendar",93393:"services-pstn",93400:"teams-and-channels-locale-is-is",93413:"virtualEvents-locale-pt-br",93446:"meetingFlyout-locale-tr-tr",93467:"gallery-locale-lt-lt",93477:"sht-searchanswerteamsstrings_es-as-in",93497:"categories-mr-in-json",93553:"data-resolvers-browser-settings",93564:"webrec2-language-da",93594:"coach-report-locale-lv-lv",93597:"discover-surface-locale-sq-al",93653:"video-attachment-light",93718:"hostDefaultsStrings39",93740:"services-cmd-meeting-intelligence",93760:"message-escalate-dialog-locale-en-us",93762:"health-locale-gl-es",93774:"smart-device-locale-pt-pt",93786:"video-capture-locale-eu-es",93800:"he-strings-jsonThinRes",93820:"search-locale-en-gb",93841:"sht-searchanswerteamsstrings_es-ky",93844:"data-resolvers-people-picker",93870:"semantic-object-locale-fr-fr",93902:"data-resolvers-privacy-settings",93916:"virtualEvents-locale-eu-es",93944:"video-capture-locale-hr-hr",94009:"sht-searchanswerteamsstrings_es-cy",94057:"calling-locale-en-gb",94061:"channels-locale-it-it",94087:"fns9",94101:"agenda-page-app",94119:"aRes19",94122:"audience-view-dialog-locale-fi-fi",94125:"onecamera-locale-es",94155:"virtualEvents-locale-et-ee",94157:"web_recorder_v2",94159:"hostUxStrings65",94166:"services-floodgate",94170:"categories-wo-sn-json",94217:"sht-cortextopictypeswebstrings_or",94219:"channels-locale-nl-nl",94236:"calling-debug",94248:"services-gallery",94253:"files-locale-sq-al",94259:"share-email-locale-ka-ge",94263:"data-resolvers-communities",94267:"sht-cortextopictypeswebstrings_nn-no",94341:"webrec2-language-de",94411:"broadcast-locale-tr-tr",94421:"addon-sp-deferredactions",94444:"semantic-object-locale-sr-latn-rs",94451:"sht-cortextopictypeswebstrings_id",94462:"spaddondataonlydeferred",94476:"guardians-locale-cy-gb",94535:"virtualEvents-locale-tr-tr",94543:"people-targeting-locale-es-mx",94548:"categories-mk-mk-json",94598:"breakoutRooms-locale-da-dk",94601:"call-transcript-panel",94623:"hostDefaultsStrings62",94637:"callable-channel-calls-app",94658:"esp-locale-ko-kr",94761:"nl-NL-UiStrings-json",94766:"channels-locale-gl-es",94772:"share-email-locale-ca-es",94779:"school-locale-lv-lv",94810:"fns35",94819:"search-locale-et-ee",94844:"meeting-bot-locale-kk-kz",94945:"services-meeting-intelligence",94954:"meeting-recap-locale-lt-lt",94965:"zh-TW-comment-pane-strings-jsonOfficeOnlineStringResource",94973:"discover-surface-locale-eu-es",95002:"meeting-options-locale-el-gr",95014:"workflow-flyout-container",95019:"ai-insights-app",95037:"files-viewer-oneup",95049:"categories-it-it-json",95052:"teams-and-channels-locale-nl-nl",95121:"survey-locale-uk-ua",95146:"artifacts-platform-locale-ro-ro",95195:"qps-plocm-comment-pane-strings-jsonOfficeOnlineStringResource",95268:"messaging-locale-el-gr",95320:"sht-cortextopictypeswebstrings_tr",95322:"pluginMeetingNotes",95339:"channels-locale-pt-br",95341:"hostUxStrings26",95378:"fluidxInfProtection",95417:"ca-Es-VALENCIA-UiStrings-json",95422:"smart-device-locale-ro-ro",95444:"sht-cortextopictypeswebstrings_lb-lu",95447:"health-locale-mk-mk",95465:"sl-SI-UiStrings-json",95468:"otlang17",95487:"channels-locale-eu-es",95518:"categories-ur-pk-json",95571:"meeting-options-locale-th-th",95584:"message-escalate-dialog-locale-pt-pt",95589:"teams-and-channels-locale-ca-es-valencia",95669:"meet-for-work-locale-zh-cn",95683:"coach-report-locale-en-gb",95691:"teams-and-channels-locale-eu-es",95746:"da-strings-jsonThinRes",95768:"people-targeting-locale-pt-br",95772:"files-locale-nl-nl",95787:"gallery-locale-sr-latn-rs",95797:"km-KH-UiStrings-json",95830:"channels-locale-el-gr",95834:"sht-searchanswerteamsstrings_es-fi",95844:"broadcast-locale-cs-cz",95847:"fns5",95859:"biometric-enrollment-locale-es-es",95862:"InformationProtectionStrings10",95875:"hostDefaultsStrings24",95885:"coach-report-locale-kk-kz",95939:"health-locale-ro-ro",95954:"fluentMtc",95972:"meeting-room-console-locale-el-gr",96007:"meeting-options-locale-et-ee",96008:"hostUxStrings14",96046:"health-locale-hr-hr",96057:"biometric-enrollment-locale-gl-es",96078:"hostDefaultsStrings68",96079:"calling-locale-ca-es",96105:"meeting-analytics-locale-el-gr",96106:"auth_v2",96137:"meeting-analytics-locale-ro-ro",96148:"biometric-enrollment-locale-et-ee",96149:"meeting-room-console-locale-et-ee",96269:"health-locale-hu-hu",96317:"audience-view-dialog-locale-kk-kz",96334:"share-email-locale-ru-ru",96357:"message-escalate-dialog-locale-hr-hr",96362:"recurrence-locale-ar-sa",96380:"people-targeting-locale-fi-fi",96386:"data-resolvers-bots-platform-worker",96387:"recurrence-locale-vi-vn",96435:"health-locale-ko-kr",96449:"esp-locale-hu-hu",96488:"sht-searchanswerteamsstrings_es-no",96532:"meeting-collab-ufd-control",96540:"sq-AL-UiStrings-json",96555:"biometric-enrollment-locale-az-latn-az",96583:"discover-surface-app",96601:"health-locale-lv-lv",96624:"calling-locale-ar-sa",96650:"recurrence-locale-th-th",96656:"components-screen-recorder4",96696:"teams-and-channels-locale-sr-latn-rs",96698:"esp-coachmark",96708:"msteams/components-meet-now-panel",96710:"sht-searchanswerteamsstrings_es-ml",96728:"hostUxStrings50",96736:"meeting-bot-locale-tr-tr",96793:"guardians-locale-nb-no",96802:"webinar-locale-ru-ru",96836:"webinar-locale-sv-se",96848:"cast-locale-lt-lt",96893:"breakoutRooms-locale-de-de",96968:"health-locale-vi-vn",96978:"services-live-state-broadcast",96980:"smart-device-locale-cy-gb",97014:"meeting-options-locale-kk-kz",97016:"cast-locale-es-mx",97071:"meeting-recap-locale-ru-ru",97083:"categories-gu-in-json",97085:"categories-fr-fr-json",97119:"calling-locale-it-it",97125:"meeting-recap-locale-nl-nl",97130:"store-app",97146:"audience-view-dialog-locale-el-gr",97153:"webrec2-language-zh-tw",97202:"guardians-locale-he-il",97203:"message-escalate-dialog-locale-kk-kz",97206:"coach-report-locale-en-us",97213:"ja-strings-jsonThinRes",97225:"video-capture-locale-is-is",97265:"InformationProtectionStrings40",97267:"fns57",97282:"meeting-analytics-locale-kk-kz",97323:"data-resolvers-gallery",97327:"virtualEvents-locale-sq-al",97378:"docx",97399:"sht-searchanswerteamsstrings_es-ne-np",97423:"fluid-paste-container",97431:"hostDefaultsStrings19",97436:"messaging-locale-bg-bg",97437:"aRes53",97494:"message-escalate-dialog-locale-mk-mk",97507:"calling-locale-de-de",97526:"mw-shell-app",97548:"share-email-locale-nb-no",97550:"breakoutRooms-locale-sv-se",97554:"school-locale-fr-ca",97596:"guardians-locale-is-is",97606:"semantic-object-locale-hi-in",97620:"meeting-analytics-locale-id-id",97686:"calling-locale-az-latn-az",97704:"biometric-enrollment-locale-nb-no",97758:"extensibility-locale-hi-in",97778:"messaging-locale-pt-pt",97782:"meeting-options-locale-eu-es",97783:"ka-GE-UiStrings-json",97810:"ky-KG-comment-pane-strings-jsonOfficeOnlineStringResource",97816:"sht-searchanswerteamsstrings_es-da",97822:"meeting-recap-locale-et-ee",97828:"main-locale-pt-pt",97895:"audience-view-dialog-locale-sv-se",97962:"hostDefaultsStrings15",97979:"hostDefaultsStrings38",98050:"data-resolvers-phonelink-sms",98068:"holographic-toolbar",98080:"sht-searchanswerteamsstrings_es-sr-cyrl",98091:"webrec2-language-es",98156:"webrec2-language-id",98163:"components-screen-recorder78",98167:"meeting-analytics-locale-sk-sk",98170:"messaging-locale-cs-cz",98176:"hostUxStrings61",98217:"extensibility-locale-en-gb",98261:"meeting-analytics-locale-he-il",98269:"freemium-upgrade-locale-ca-es-valencia",98278:"hostUxStrings72",98289:"meeting-recap-locale-es-mx",98368:"meeting-analytics-app",98436:"meetingFlyout-locale-ka-ge",98471:"sht-cortextopictypeswebstrings_am",98487:"lb-LU-comment-pane-strings-jsonOfficeOnlineStringResource",98498:"hostUxStrings69",98523:"fil-PH-comment-pane-strings-jsonOfficeOnlineStringResource",98529:"meet-for-work-locale-gl-es",98629:"breakoutRooms-locale-cy-gb",98635:"coach-report-locale-pt-pt",98654:"webinar-locale-el-gr",98687:"categories-hu-hu-json",98696:"meeting-analytics-locale-bg-bg",98701:"coach-report-locale-mk-mk",98720:"notesHeaderOrganizerPersona",98722:"data-resolvers-browser-core",98725:"coach-report-locale-fi-fi",98750:"cast-locale-vi-vn",98787:"cast-locale-lv-lv",98790:"categories-sr-latn-rs-json",98805:"calendar-locale-hu-hu",98813:"virtualEvents-locale-cy-gb",98842:"search-locale-cy-gb",98846:"vi-VN-UiStrings-json",98857:"recurrence-locale-cs-cz",98865:"extensibility-locale-pt-br",98872:"recurrence-locale-ka-ge",98889:"extensibility-locale-is-is",98929:"audience-view-dialog-locale-ro-ro",98972:"survey-locale-pt-br",98993:"semantic-object-locale-hu-hu",99017:"otlang19",99030:"biometric-enrollment-locale-sq-al",99112:"audience-view-dialog-locale-zh-tw",99114:"health-locale-ru-ru",99164:"services-sharepoint-client",99173:"data-resolvers-reply-chains",99182:"extensibility-locale-lt-lt",99200:"fns49",99240:"hostUxStrings49",99290:"meeting-analytics-locale-en-gb",99306:"hostUxStrings60",99323:"kok-IN-UiStrings-json",99327:"search-locale-pt-br",99329:"school-locale-en-gb",99334:"extensibility-locale-cy-gb",99367:"data-resolvers-manage-tenant",99433:"people-targeting-locale-fil-ph",99442:"meeting-bot-locale-mk-mk",99458:"virtualEvents-locale-ca-es-valencia",99563:"meeting-bot-locale-et-ee",99592:"calling-locale-hu-hu",99598:"biometric-enrollment-locale-he-il",99617:"teams-and-channels-locale-nb-no",99641:"sr-latn-rs-strings-jsonThinRes",99648:"search-locale-ca-es",99650:"smart-device-locale-cs-cz",99666:"id-strings-jsonThinRes",99684:"calendar-fluent-surface",99710:"guardians-locale-lt-lt",99728:"sk-SK-comment-pane-strings-jsonOfficeOnlineStringResource",99793:"components-screen-recorder20",99808:"sht-cortextopictypeswebstrings_no",99837:"th-TH-UiStrings-json",99856:"apps-platform-data.mock",99918:"aRes54",99927:"extensibility-locale-hr-hr",99928:"components-screen-recorder40",99948:"nextGenEngine",99951:"share-email-locale-ja-jp",99981:"meeting-room-console-locale-uk-ua"}[e]||e)+"-"+{9:"cfc553d12cb3e202",22:"4017da55c0d00bcc",46:"db18cf75de04c14f",57:"d0128d99a4169177",75:"854f14df4aa104a6",106:"6f0447adc6053fe8",126:"52355782b9a2972f",132:"5e3a46bb2ee29a48",140:"d09c3f12d1f0ec89",145:"95611406f248f822",162:"ae2dd2619df8d6bc",183:"52e39fc06ee9fc39",199:"19bb51650ff172e3",200:"6f7547eb6c224dfe",211:"2061a4aa022bfccc",227:"b2a0854e4e463676",229:"ca33127774221d48",240:"bdbcd372522d0d03",245:"7da6cc1da4bff837",253:"a365aa82ad740e0c",274:"07f6dc188f42ec0b",284:"64f0dee1c1efaac9",287:"643b5d895a850fa0",369:"0a8fb8dacb6b71ea",385:"14d175d9fd106597",397:"a2575a55b5cc605e",470:"19583ddbcdff7859",471:"4e4856c2949b6fd6",481:"d65b2904c5d4e517",488:"d924635af4e4156f",509:"bc71a16865d89fdf",551:"9579897241688e34",586:"5a528b20db63e3a6",588:"6a72f8136ec3160e",598:"72db6461b8add6c5",629:"96d2bbc98502df33",632:"445f94bcdbe30845",637:"47f3b2edae442532",658:"1dc444d009fbc615",673:"5e8a4aa6a84064e8",675:"8b387a44307acfc2",692:"5c4981c673ae0762",741:"d3b302ca8d39e4e0",749:"6d998a1b6132b479",772:"7fb876af2ad9ebfa",809:"8baf97cea9d00afd",819:"04f62b5ce4fb8a4b",822:"3eaf84d27d8f73da",824:"4c98690fbd17a298",826:"770ee35015b68397",834:"1b1e3b010effb1f5",866:"ca1c97c77757232d",880:"6111392dad115b50",896:"b0f76d0ff3d69d06",902:"545d8d8b7314430e",906:"e65bfc31cc378c29",912:"47e1c7b2401404d2",923:"b7875c03cac814bb",926:"2d745c81914fcf4f",950:"1b79e2d032b7befb",987:"7598850dac72ca76",1026:"80a52c55bcf5cd55",1035:"508cdc1f122f30ab",1091:"29968e858893e6db",1122:"97be78353a50169b",1129:"c55cbe6dac9836f8",1131:"244b1338ccab96af",1172:"6100837e7f54b35c",1199:"4d6fada17790ef80",1215:"1a23ebb7efbfbc60",1246:"54a7a60a847420fa",1264:"3c8676e80bf5dee4",1281:"f1400fc625e6d405",1345:"252a242ed888430c",1351:"02ef6016c7395547",1368:"9dfb3870ea3fc249",1375:"24d3cd3130d8446f",1383:"a80518d2c6872040",1387:"bf2f4348fe274de5",1400:"fac2a7cea84cb1aa",1420:"53de43da22e09f35",1421:"04c621b919262603",1422:"66efc86335760aba",1429:"d967d5f9e33fbe39",1440:"e36778abe9511a06",1461:"7ee10f3fe915e147",1474:"cc1df695bb754853",1496:"046aa3c1a55f7df8",1498:"fd2e699c172945d0",1510:"4b51b8c1281dc946",1514:"6bc7ef86d66fce57",1530:"6f08d62c2285fc64",1551:"ea6e2803a2b424ea",1555:"fd4999d129768c29",1556:"45c7cc567c7e5777",1573:"e5a89b99400d18a7",1583:"8927203d551134c7",1585:"6d3c47ed306f0181",1595:"e65e1ff28590bd96",1608:"95e3faae9acf6b34",1612:"f40ff31b00f14578",1638:"07eeb228bcf66100",1659:"c59573321f87e386",1741:"d44bef0088b4c7a1",1753:"22603cc3f1bc7b71",1811:"db5d54d372403841",1839:"d5b4ca05633194ee",1876:"a2dd877449d3fe0d",1910:"9ebbf29c8f06c483",1924:"c01805187ee82dff",1966:"f786749d157ffdd9",1983:"905261717449b01b",1989:"22220c533ba7b57a",2016:"eefdb1d86153bf80",2026:"eaeb51ed52d08d71",2054:"f1a7b30b6978e4d4",2060:"47b2e027e2157954",2066:"8e89d08dc30dceaf",2078:"19e004a8fc5763d8",2090:"d74fdd166ccb489e",2116:"78be1a7f56319992",2138:"aaa4207a337caeb9",2147:"badfbb6219b7cbab",2148:"46ef76f0e07351c3",2168:"aa03c9968c37f6ec",2205:"a456ebdfa8d2dbba",2213:"47fd754e41059b8c",2219:"a45039233f9ad1a3",2243:"50c470601a719937",2297:"a9aa60e85f8e2acc",2308:"b629929bfa6e0c6c",2329:"896f7c8d7a3021a0",2372:"c5751916c1d3a190",2376:"b1469e15cbc6c927",2396:"25684699d0e77ddc",2423:"b03958c1f598d639",2478:"d81136015374a45e",2479:"79d3eb69c8a1a607",2488:"1fe7bdd36a461a3b",2514:"06ec3b808888cb26",2517:"826c8d03972f34fa",2525:"2d1b69e9ffdb8da8",2536:"efa4df47397e35cc",2555:"41cae07a9055b44b",2559:"1d39e7f300ce046e",2600:"ea7f781606ce46a8",2653:"b143b0b5f1ecd9d0",2701:"cec45a62660636f9",2708:"f0fb37378dca769c",2720:"ba8401a087a6db65",2764:"bd2900c5f9ee5dc8",2765:"9e2344b432933e80",2771:"74870223045838ce",2774:"fb5e49a08606184a",2784:"7ad4ae1b318ee0b9",2800:"f8140770f1a99c91",2849:"b8b8ad5a59f746da",2859:"45d84505946639fa",2883:"b345181a3ab22338",2893:"409ccfeb4488001f",2895:"aba1078bf3a960e4",2936:"313e4644da6dd0c6",2943:"6b7689746eee9375",2953:"05994c6a561f42bb",2989:"9e292219714e543e",3034:"9ae3239bb31a029e",3035:"b6f6de43d877dd57",3047:"3163ffcf09fc78d3",3073:"647ca9928ef7ffb7",3137:"77549a29c8cf5114",3184:"1a4d3610851642fe",3220:"d359c8211a6c9b25",3232:"e5bac521586cbada",3266:"a350c36ca09f8da1",3273:"e4022448cc8ed531",3275:"0921cabf1e4123d7",3277:"4acded341c8e8786",3292:"b6dcbfd448061ae4",3301:"a49ae29132b21d5f",3405:"e6ad349d0b01bd9d",3420:"440081be3f36dab8",3441:"0e62113c49125622",3460:"07ab996605be8805",3461:"c80d6475b25524c8",3528:"5bdb5c8c12eb840b",3568:"e7ce4979f18ea896",3576:"06c46ad52241a7b2",3584:"ab29a1f5fb0c3a17",3626:"fd72fb822f79f7d1",3632:"d598186c0264aced",3657:"8488e65a753f7915",3683:"0af9978a84faa16c",3698:"f8c7ef0d3a6d4a38",3743:"28c60db839c09bfd",3762:"afcb41d92a06dbd0",3779:"02d34cf9feacc2c4",3813:"f9e56960ea36ffa3",3817:"22ea68691b6d0a6e",3842:"c6b05120d9e3f4ee",3846:"44b0ce37890ab9ad",3877:"d8a613d2428fa4b4",3891:"adea35c945fdac03",3908:"98d68740ba13d22c",3940:"48631a2775fdd5b5",3941:"fe067bb154e5a919",3966:"a12c0d5984020c7b",3972:"6103bcfc2aab130d",3979:"523b7055917d33f1",3982:"9afdcef5932e12b4",3983:"af394835e74cf71e",3985:"7983ddea0235b18f",3998:"fca832485c6a6df5",4102:"ecec095c4a0d5f0c",4115:"f5233bb14236040c",4120:"8b52fcd1d8780323",4128:"1b73ef550cc11ea0",4148:"6a9ed84a0cb698c0",4171:"6fc8361ec0b61fbd",4177:"841b4a0e4da03f87",4184:"63c8919c4b9b3c19",4212:"9ddfda20e98f86c6",4221:"e2c4f1034195b7c7",4286:"bf9ec707b8c10d80",4288:"b5d256a0ff3877f7",4289:"6d7a427627db0c53",4299:"c8dca457ff96ee0e",4317:"cf5850e4dcdbea28",4340:"797f5b973525f7ae",4346:"b28c6d26f4bc8de2",4357:"eb23886d2bc61380",4411:"ceb0c27f5f42fc13",4452:"24aef604a6564a88",4484:"c44125575a04fa09",4573:"d32609987f0cf3b2",4596:"fda1b5c4985fce4f",4601:"1856e99704b6be50",4609:"44e91f0791e5e576",4615:"23f7232894eaf0e9",4620:"19dd40ceb9095ddb",4631:"bb946a06c52decd3",4685:"a342068841c38f5f",4703:"9849b0c1f1701a4b",4759:"bb22bb5beac96c98",4773:"9082b09b2ee05427",4788:"8af931bb22349a5a",4793:"e99f15fb6f74ef50",4818:"96258a4fbc392e55",4822:"9dd2aace552557c7",4858:"d234990c5d2edcd0",4867:"769457d73d55dad9",4881:"b914e62670cc5002",4904:"73a03c384ddf0730",4918:"382867e06812a4d4",4987:"f85a7a730ae3bf9e",5023:"a0b8202abb0156de",5049:"303adc07c90479c3",5053:"2fba46f7cfb87a14",5058:"57e16bd1f8347d33",5082:"3782d664d9a5b85d",5089:"83825b8776ff658f",5103:"b6a61d5350fb1aea",5108:"29c196463a9a47db",5131:"2d409a3ad6f383dc",5164:"e9518db910b79e75",5170:"c6b18ca64794fa35",5183:"0046649f72f48697",5188:"98d5bbeaabd85099",5203:"7a31e074e3c9e14a",5213:"b43cf1fb3f3a2fd6",5224:"9de7528f6b5b8a8c",5227:"56e8aebb5cf07f0f",5235:"72fee29fa674ec6e",5250:"6130edecd86d120d",5271:"f1234eb385666bbc",5297:"7b10f4fb1bfcb2eb",5324:"32f5bc94e2262a07",5348:"83c386d229f4faf5",5351:"1a3694134ceeb4fd",5353:"701117d06a9a0ef3",5363:"cbe0c891aad4164b",5390:"682930545e2e72c9",5400:"2cd6f17f29e53ec5",5406:"32dd3daff283e4d9",5421:"2cc153c12a86d40e",5430:"7d38085e1a5f40ed",5440:"58270952540b205a",5443:"cbe88464b18aa9f6",5462:"f6cb386c8223707c",5543:"26f3aca056c1ab67",5547:"7d94dacb7beb4c25",5576:"37959aa0072fd06d",5579:"16f2a8f95aa19e7e",5588:"416c9e101a3dcf15",5589:"9fe10509e340eae1",5592:"a199b35d754d86f7",5599:"7fc0cb9869bea93f",5612:"a7cf8fe8a9c44c87",5632:"aed677dd4858a4c7",5667:"98e5e9fc8671c01b",5688:"1125d340db6110e0",5724:"ab35a32c6fea2dd1",5729:"69feca7257da637b",5750:"b40d188e69886b76",5752:"ceaa7f9cde27f79f",5754:"8f24d2e1403b8c27",5777:"da0b8a5aa6f63cc5",5784:"4690f25d07c3f3c5",5794:"035b265734229189",5820:"11ca4129cdb684e3",5851:"4e542b96457f1694",5875:"b4996b49a2b18ca3",5880:"d7409ead9862ab00",5887:"75036a7714f78935",5892:"46ef6d5d97fc0235",5895:"bb32f6c5d8107609",5911:"499e61a1e63e305c",5913:"99594ddae742b48b",5924:"f439fb01a02d78c6",5954:"4043d9b308b5f1e8",5992:"dd401539de35500e",6013:"19a8e6d5c0c84f8e",6020:"030b0edc9d9ffc0e",6023:"34cc56f092fd259b",6055:"ce7c973e2292c461",6063:"c593cf739126ba03",6066:"66136e0bdcbf7a2f",6075:"bec9b6f41811861d",6089:"f419f8e5326c3058",6091:"344d93a1dda32e9c",6194:"8313dac53e64d744",6240:"b009ac26be24443f",6279:"5e2a4bb673b8cfed",6294:"76d387dcbee4ea0b",6312:"5bbc3be35ad6adcd",6317:"ad768a22a4592d88",6336:"992965ed6a5c36f4",6355:"74f60a387d093757",6366:"dd03b9bd4e85a5a8",6373:"d8f2bc458609b055",6389:"68343c1b95eff07c",6396:"87c6e64fe6c53d27",6408:"3124ee85367b2e18",6428:"3f05ec0eb3cce206",6431:"5ba474fe86a64aa5",6434:"12995cc8a05c9820",6457:"9cb12c411e62e499",6472:"88e418f21b67b772",6482:"d890eaf85974c2b3",6488:"a541fdb16151f72f",6508:"9378f2b165faeeb4",6523:"9bb89ba474efbfd6",6545:"7ae761ac76b62b73",6552:"f1c0cfc39ab26872",6582:"b76c0768eb57d210",6652:"59a4dd937023a0b3",6659:"eaab491c0c4a990a",6693:"2af93fa20ac1c844",6702:"15cadfdcf1a84b0b",6740:"1887e486c3042f5f",6746:"a11c932d9c8a9a43",6749:"9ed415f00c1c95ad",6767:"4e1e094d5ae40a91",6768:"f61d43512176f290",6841:"e0fcb5ebc5a418a7",6854:"790ca65b6eac8343",6874:"2079c1f3ba5632ac",6886:"f20590858ea573d1",6929:"1a9e1fa6caeb77c1",6938:"349a827e950ddf9c",6942:"7dd4eee0e6a415a7",6966:"71fd6f492c8bfe25",6990:"c25b9da0e4527c8c",6994:"7d837fef34c1386b",7004:"b75326485242842b",7015:"3b5eb5e45426b443",7017:"427bc5680b0eab93",7022:"b2c630d37f9d819c",7040:"e7746d6041e640cf",7056:"1e3226bcb7bc3bb3",7124:"896c854cdb9e88ea",7139:"00cb390e223acb52",7143:"e3df6ca9f74173ff",7169:"e02cc5c001f38971",7178:"dd1aa4f529f2e9e5",7191:"78bfbc5e2db6ffa6",7205:"8ed7f33dc3f5cc2b",7214:"c9a6de78a4114cbc",7215:"d5c9268a88d890a0",7290:"c745304c5e2a606a",7351:"a0e693e7e9a59c7a",7368:"9fcaafbbfdec0855",7378:"8a047e219ffa82fa",7407:"eb5664231ba8977d",7413:"63d9b52ceaf546fb",7447:"f6f46d09c405e9ae",7514:"2a113b38e86e3c95",7518:"ecad9b4b3e73c08b",7520:"b598cebbd7502fc7",7523:"89d2fac1cb0df487",7536:"4ee71f475c662e9e",7545:"ce52e54035d48780",7560:"1ccc85b143ee76b3",7598:"b953028169f16359",7620:"a521f4fea62ebe97",7676:"2af9a7f8d753be11",7696:"b26bdef154b37270",7718:"d261b3a8cf6365b6",7723:"662a16ee155f5754",7729:"43db940832841267",7761:"902c71b7d79cc072",7776:"2e82eebfee5a3f1e",7783:"6980aeb1bab622c8",7813:"bb20af4c10fd4984",7832:"0f7c6603382bcaff",7850:"0df09bce9148e0ea",7897:"fe94bc98d85a1d81",7932:"e3e0584e3328ce4c",7949:"d22e8f3b6fd987d9",7950:"0d514e1fdfa377ac",7959:"8ca559dfbcf539ba",7983:"c6f8ba94002cbf27",8025:"0b127a9061e4e1d9",8049:"5672c034fbb0da4b",8058:"45d6076d3531dfed",8063:"946009492d594c94",8074:"c695aacda7060a15",8075:"5190bf65d8078a28",8094:"3716cf9fd348ec9a",8108:"4b95bdf4e71a38a1",8111:"5a0d3bc1edb851a2",8118:"15dc0635c2ee6838",8124:"1c940c35bbf53143",8126:"930f678b12acb1b5",8168:"6641114194a276bc",8174:"07ae5b5aac872aa8",8207:"a5cc6e778ee671c9",8275:"4bc8cd70131ffa3c",8376:"acd2401880f76d21",8398:"ff08603bb8ca4f9f",8418:"c95724efe53a16ee",8438:"2bb3a543aabde603",8480:"a3f90b3f09488817",8521:"166b37b1a3cb847a",8523:"ed55113a4a025178",8528:"df99d2a03224e820",8535:"92b388696a03d518",8568:"5f2871542502b769",8598:"3ff61dd6f97a2ce4",8609:"3a8c00a32e409a37",8631:"7f0dccf32c9d577b",8632:"19efd9ce97a0b5ee",8656:"509e2086bc6c8ea9",8687:"1eb832a7b49aa015",8725:"a55aa431e9f04fe3",8735:"67c8d23b34f407fb",8743:"7ab28b09ded8e231",8751:"0114730f6877ecde",8806:"18470b4368f0d26b",8819:"d90a9d897d53d36f",8892:"f7effb25b5c45a5a",8897:"10b3ac80d790ca8b",8908:"bb23c7bafaa1bc2f",8914:"99c725aca8012ee4",8954:"b1c7e5faa90ea75d",8983:"e9cd6e3fb61dac83",9014:"922268621f4b1926",9030:"d55cd4a485e90776",9050:"8a53a347e32d8bcb",9078:"ec584f232d8a5716",9082:"f3e63cbe3dd5ebfb",9119:"09a5b96b4da9f225",9129:"d5d713420b9a202b",9143:"915c34f5aa320d57",9162:"71f1af70bf63b4ff",9170:"c500ee3c11dcf9e0",9193:"d45a9116335336ba",9252:"add8b64fefb7727d",9257:"74af825a01342797",9268:"bb7e2ff406701590",9293:"616895d52468728c",9339:"6721ddbc28bb73a0",9342:"bcd3e89331be1ed4",9352:"e140317084cc894a",9372:"bc55e787af6d6e84",9436:"260cbdd1d91bf676",9469:"13d361cb235a2305",9486:"6971f962440c4c93",9495:"8d74ab61616781da",9505:"26cbaf28e28141ce",9545:"8d5d5caab08e0426",9590:"4ad629119218e1fa",9592:"72ea2a61d4afae25",9675:"d080f42a9d41c701",9679:"35790ec6c2ba68c7",9691:"0195f7823b0e3ae0",9699:"512e0ff15014e2fc",9735:"c1cce9fb7fd91420",9778:"7c4bf66a0709ad1a",9820:"f08ebedaef3e8740",9823:"fe71059510720de6",9837:"ff5f3f7478ae1158",9902:"2f9130d5ca069615",9940:"aeff7c322988c682",9981:"f2e62ff0225fa44f",10016:"1b13a34293ba7324",10035:"325ff24800930db2",10047:"61f93946cedb4ef6",10056:"83c14a10c6aee70c",10066:"0610ba336a021ceb",10104:"a6a80a9023a0f700",10122:"8378e2c0213585f3",10146:"d08dda1addd34445",10166:"7b41fe8c2b4fe065",10183:"651e6fe9eebd5cd1",10186:"2bbb39cc2d5a954c",10190:"74f76e5872c72898",10203:"768b175f4eefe083",10222:"10ed9ca8ece76261",10229:"81a85d73fb8c36b6",10236:"0246997e0d6697c2",10284:"2d9729f587cb8261",10287:"bb1e0e8b2dbd571d",10297:"09155d4e8e87b7c7",10318:"1361d6460338ece6",10319:"5cbd8cbbe8103413",10337:"85efa4b5baec9cf2",10344:"6215b7739d04a643",10412:"b4528cd92b0feaf7",10419:"a7b14177124fa0d6",10440:"9efbd6149eaa1467",10501:"6f41c1c101fa435a",10523:"a655c27618f4d3b8",10542:"da11a6d7ce13fc74",10562:"a08e984ac002940a",10567:"49f17dc8a280595a",10589:"b9a34be4b3a1d4be",10591:"82d7acb2ac76290a",10642:"1fa178b4bc26af92",10649:"12d1efa787e455ba",10652:"2838ac41ebaa4762",10675:"34bb8e8a739fc84b",10683:"672bcd4b43f960a5",10728:"30ad57639bd74c72",10749:"8b643ed4ac759a73",10751:"645bf39599acd2cf",10784:"e3bedcec158159ba",10787:"85f240c64ff0f82d",10812:"3d697d121198e473",10828:"11463f36426413ed",10880:"d5a76ee3ad8b0336",10942:"18531792e8dfc428",10970:"1eb2bd6c7f4c0a82",11023:"61d8cd7429e619a8",11048:"fc9407d5a335b458",11064:"0310e724b6fa263c",11095:"b04b0143ef89abdb",11125:"7c848f9eeb243517",11131:"9ae4272a192893d5",11136:"a98e63441573ca26",11141:"1fad163bd1006ba8",11157:"8419c86341ae5dee",11158:"f1e612a9634795fe",11172:"4e7b11bf206fbfa4",11198:"2dc51bcf5c46ab05",11205:"61a7a44045ca155b",11265:"b19d6cbb3eea00e9",11286:"3fdec0b70fca1088",11290:"b7aa2d685b78263f",11318:"b60fdb974e7dfdfb",11334:"e62c744b2f860c49",11368:"29222c757f78dcfa",11369:"cdd83355a2c51427",11382:"18b6745b5d0c3090",11591:"ba21f74f96f80b15",11637:"231bbb49041dab15",11645:"519f8e2c61ad08e7",11657:"4d3610b5db37ef78",11682:"39dd87529c64e8d7",11746:"44a82e8090ab3cbe",11763:"bf45886c1ed24a5c",11779:"9653749358c04af6",11780:"7f3daddc8ddcbe25",11827:"7bd0e8968e57271f",11846:"40e8a2aae0b4137d",11847:"a29d5d5b8d480d19",11849:"6ea846667321d62e",11908:"ff094f5ccbfc9859",11943:"adcd5d0fec425a16",11957:"0e0c7bee748d9d5a",11965:"99ea4dc9b272d365",11969:"594f4f8fbf01c9cf",12002:"d057dd844a256a1f",12083:"e2f007b9f6010d75",12084:"5aab56f79de4f47f",12090:"ab8a1469a813a067",12097:"810f3641c12afd8f",12125:"db8bb6c09a1cf79e",12136:"a4123a41122ec1bd",12159:"e4d59a489c9ea3ca",12190:"23971653e5d8c026",12243:"7ac2c3e75deac272",12252:"30e167b0b23c4b66",12274:"1ab55e3761e856bd",12284:"9a7e3b11096184f0",12353:"de218a7088a89ea5",12359:"dd3efc81a60d3927",12374:"c9d18b4884b54d28",12389:"dd7749a36ff61ff6",12440:"45e461ed57a5baea",12486:"4d869197566e879b",12502:"484422fa7d81726c",12535:"339a6f2d24164daa",12549:"4069e29b3b4ed539",12610:"e5c43ae5eaf7d96b",12629:"9b1597a33d03d972",12638:"ebdc58f73a40afc7",12657:"bf221eb49cbed5e4",12664:"a65627eb30a37cdd",12671:"8f250a23e28a5b58",12695:"154caf0fe0edda6e",12704:"67286c0d8fd4d18e",12724:"6327407378eae3ab",12764:"4e3f1f4dd8632551",12767:"a5e5251b4fc75c2e",12776:"7ff0affbe3e64b6f",12782:"eefe451021c398ef",12850:"91fcdfea0739e13d",12882:"c9f7f2df34c65968",12914:"14802372ef70eef7",12925:"f327302637197e15",12971:"507c11e1d39bca91",13163:"afa7a0ccae4a5264",13168:"34ec6b83d7396a0a",13170:"0fe23629b31ff6f2",13199:"b54379d5fb379bca",13228:"21c6975ddddc6cca",13271:"2ef0f0e827b69234",13299:"54c6ea6b1073e44a",13311:"3d4998735ea6737c",13353:"0db33c7816ec1773",13354:"3dc0315f93213eef",13386:"6c40b9f017df301a",13392:"55c6a8d0efb856e3",13411:"725d47e6658d7c6f",13418:"911da33ab0a0aacf",13428:"026b9a127fda2519",13465:"9905c1d03876b65f",13478:"6f0a313b18860473",13484:"0ecdc94fb74dee4f",13500:"14c0b95c17d325b7",13507:"97f26414b3d648a6",13529:"8825ddc20e3292a2",13549:"7000e199b813c92f",13602:"c75111513bdfc4fa",13609:"3b2461dc42cef33d",13652:"9429d4969097b18e",13666:"09b70336dae6d243",13680:"86c3a47ae4fe34e0",13692:"e68f6b1ee1cf5bb2",13723:"d715c85652eda7a3",13737:"569ec03d06cabd64",13739:"828e338d0f0d1d15",13749:"b38abefda94d4f39",13750:"615187cc96944bb8",13752:"8cfe8659ff132d85",13768:"cc30b02a7f903354",13769:"2e941e24c9ba9956",13794:"48dd5db65bfe0361",13802:"b3a7d08241afa4a8",13832:"563e70a4e46526fa",13835:"6e5f912cb8d89e96",13838:"ca63a48df3e8c582",13847:"93c39afcf6194ba9",13872:"5ca0defb6d3916a8",13909:"92ab05d900c679fd",13968:"1853b226ceb75247",13980:"7faf445dd28eb600",14044:"8d3d158820361f6b",14076:"e3267040491928ba",14085:"a3e20dd7c62b08ba",14091:"1c3a7facc0a2bb1c",14095:"7fdde95ea4063f68",14128:"b90368253686be2f",14151:"0851288c8324170d",14166:"e0dd1ea94130c40a",14169:"cf6bdb7ba6e5830d",14268:"5a62186aded28618",14284:"69e4c87fdf87dfdc",14287:"d63c853af99cab66",14295:"8b6cc1ea525358a4",14302:"0eee5e24635ce14b",14309:"b60abda78bf87688",14324:"a9b54f198fc39b82",14354:"69a3bd72d62f3179",14368:"e884ac89afa1af81",14377:"eec1d3bb800d166f",14381:"c8edc6c6579bec95",14401:"5de7d0a6b2eeacd5",14408:"c0dee5fe296a387f",14421:"b7ea23bea9f3cb09",14456:"b3ba9080dbbf81e6",14464:"14f7eb6655e19a6c",14474:"693cc9316c9a7b38",14493:"28ed4bdf5045397b",14512:"654bac3d9f932e81",14526:"24993e8084741e57",14533:"fa19e1e59156e784",14542:"ed47bf3ef725fb02",14576:"a7816d31b5740eac",14590:"de5fe93f9ec635a5",14600:"997a561025d0eb19",14609:"b450d55276a8b2c8",14621:"754dbce4234e093b",14629:"b2a5a9831d45bb3d",14634:"01d8240f4b109233",14644:"caa840d95d7481e2",14646:"298d492f3e509710",14682:"5d916b9d4b8cb19b",14712:"b5446a554b39c806",14722:"bcde366a4df980b4",14727:"b9cf6d9249a810f7",14743:"06dd1745967a6634",14748:"b1fd96533c13af6f",14768:"e5930d532107a07b",14787:"496665a7f21f196e",14826:"f6f7c1364d4ae922",14834:"e88076f734ddb749",14927:"e92f32dd626da0d0",14974:"f212890635ece22a",14988:"abc9f3c02d260dbf",15061:"aaf4143d5d0f3118",15064:"718c1654e26add7c",15066:"9e3c6a03807a174c",15078:"e052e04011e8d794",15120:"6f07f81f39131c8a",15195:"a22b5a68d301f35c",15257:"2a3dd32d2ddb2c5a",15271:"0927f272c321ffae",15314:"22875c5efe548d7a",15331:"d232c777dda2c4a7",15340:"69ca95c9ead06843",15343:"6162791180a8a8d3",15369:"5a1aae8d1e52bfbb",15370:"a91d04f85b28608a",15442:"36ff3e12b360b541",15450:"16ef1c7906f7990b",15463:"249d83ff679e88ee",15469:"7715ec9130fae021",15522:"d72f04f3483b7fcd",15523:"cb33fae3e2222aef",15580:"57fb185d98695646",15633:"bfbc44c1c2e489d8",15657:"2ec2bfd9698711b0",15682:"20b0aeb386e7ba0b",15691:"6966f83c4f7a2d46",15750:"d1d5ed61dea6096e",15783:"fe732dc3ac60a11e",15793:"a067a8ae882f63f3",15798:"bd54d331f83d93e5",15803:"1f2f35ab3d0fe750",15806:"2ad6a92f9d07914d",15813:"8a2e4c15f2fde098",15837:"27448e2118c16d26",15905:"aadfe4edf99e1a6c",15923:"53f56ef049b556da",15943:"139d2635f8342389",15953:"8b87c39293b25d88",15999:"c899c31d39895b08",16014:"7dfd7b1df9769496",16037:"25a697b5900400cf",16045:"f6c2e480f233481b",16087:"947657c544b72bfb",16089:"898c954c28be2ed2",16095:"e1cc7099d7d9a7f2",16147:"d0edbc63d82fddb9",16151:"f0beee95f020eaab",16171:"5c9480f4a1a87e4c",16181:"b18ebbaa72fa59f2",16205:"a4487c9144e353d3",16211:"d013c4cd2dfe8240",16266:"7661873306137056",16267:"223cfe6927b43ba7",16290:"94be4b9a01629a25",16312:"e378c8485a0a7c8d",16313:"61cb888111aaffa3",16316:"4bb2ffb494cc4f8a",16347:"2f5a78cdd7a75512",16356:"405664a54eabb4cd",16366:"e38d4ba4045efe42",16419:"38e9a8164ac9271a",16436:"a0826bf593ecb1c1",16478:"aee94c2a515549f6",16487:"1d5dc3a2dabf5f89",16489:"7242fbbee2ba3809",16523:"58601d92b3c0f506",16550:"91450118bce54e03",16571:"7e098a416b947eb5",16611:"fdc1c81bb5b6109a",16622:"26d418475f393f50",16654:"4078778cb4d6eb82",16676:"e41012e6e4ba3330",16682:"d1e26b7bbcba75b7",16687:"03e42a4b351ee48c",16702:"9d6c27722493ff4e",16703:"79f31563d8ba137a",16705:"e7b73f31d8abd4af",16733:"2223da6ac6b56fa7",16734:"2659cd62fa8bf513",16737:"e08f90570b399961",16746:"a6150cd9b58b78e3",16747:"e27033de2a167860",16791:"9298d7d8ad09e835",16804:"14d327000482806c",16851:"c8a7367561967d8d",16877:"c240daebe4ae7aba",16907:"7f2bdf049aeace67",16918:"ce88cf9ae4beeb82",16942:"d5eba2384458feea",16948:"332230ea09273d26",16953:"3ee2812676692817",16981:"95841e691aeba166",17002:"e2dafd7854400db9",17027:"6c6d4415cb0843a7",17031:"671f353ab9c417b6",17044:"6fa1f374a8f4ca5d",17097:"2f458f297e1b963b",17107:"c2928297b666e59b",17121:"b8d0c377eb59c878",17124:"8ad61c1a0f1d0c8b",17133:"de7bcebcb1385ab3",17134:"618520d61b8221da",17142:"01c50e52aebf1081",17146:"26ac90a68b6d340e",17220:"129e771442babc30",17226:"439b1f42a645d17f",17233:"3bc0f46cba58bdb7",17253:"fe01011e8e2504f8",17263:"42b42cbdbdbbb71d",17270:"3cdbcdc8e259a489",17274:"20f9fd8e6cc7d8bc",17285:"33b1009ae8339b60",17293:"d4c24aa28a5cdf6e",17297:"60d8d85dcbc9987d",17298:"8351094e1d929952",17341:"9736c96ee7307e70",17342:"2670eccf841af3a6",17353:"0c0c4828b6b214f6",17400:"659454022909b284",17410:"4b412d18a82a5b04",17418:"17a76d5e7270f5d0",17428:"a82d7050ce0261b9",17434:"b92b40cd453928e7",17439:"66177674b5a141e3",17447:"836712ef8b9b31b8",17475:"6170c93f89756050",17495:"b41f23cda67f3dd0",17502:"629de883d665be70",17512:"8d341273227b3a78",17530:"a5397a6169586cf8",17542:"3c0b1b41da7901a3",17557:"981e3c75f429ed6f",17583:"87b305399aba37a8",17589:"e79026b1a8c35ce6",17601:"e24aab93eda86504",17624:"101b26efa68a3c52",17638:"6d52cb961ef30859",17652:"566d29383efca551",17662:"ef5c852ec8910ef5",17692:"fe5db64c2928a716",17695:"05f9f4c7923834b0",17704:"53ba870d41ae45b8",17706:"e64fc584dcd2e52f",17716:"f4b7a953c18f11b7",17726:"4b8e4171f8e0dbd0",17734:"4e82bbb271832109",17794:"86a4df36a8c03bdd",17795:"17fea987008f3a83",17797:"359805af10e1823d",17805:"5e35059e27da1141",17828:"69c534c7ddfddf1e",17844:"748721d304b8c741",17896:"7e3cbbbb1d7b4cc2",17902:"c46ba0033e51f087",17957:"1fc32226f6a3fdc0",17965:"9e17d50dbe5937df",17968:"44ced7eb0ead6138",17984:"a8bd69020cdbe5ec",17994:"9919afa33236ce86",18026:"df5293dcec4bf528",18035:"92334f5f7dff8fe2",18129:"417d59fbbc994111",18130:"b609417090ab0762",18143:"33a96d7fc6071a16",18168:"401a5ab5a923d97c",18170:"e2710c986740e6be",18185:"204d70a622e2ebf0",18223:"62cbe0c2dc5e0740",18228:"180e7d7130f36a7e",18254:"5845963d5230dc9b",18315:"99d7f66f8006a6f2",18344:"66f880eae5b654f0",18364:"0afbcb1337b52ede",18404:"b68db78eee0dc1c2",18418:"049fa57010d36499",18436:"03d05a1b935ad5b6",18484:"31601edb353bb531",18491:"8f8a800abccf847d",18500:"6d3e523bfc773cd9",18524:"ddb2ccb44c792dba",18529:"2800bc21fddaaf8f",18639:"d6a2439d9c26df7b",18642:"de895b627e96d2f0",18669:"727807365606168d",18698:"3bea9e37390742f7",18719:"6de8f055a72bb9a8",18761:"f9414a016b747d65",18773:"e4c4fe86090a53a2",18797:"68f4f1002714625b",18809:"fc99372541ad4b5f",18815:"347f660430f26277",18846:"58303ced13851cb8",18861:"aa9560b74a840e4d",18876:"8ab7087bdce565c3",18884:"f605a49424787e09",18893:"1eab55e3f0875ad2",18898:"0a7813beea88f6d8",18927:"7db61b96de217978",18931:"2c30383152a1ab0f",18950:"8a948d18b566ae31",18997:"306b0e5a0dcdfc44",19002:"29c03ffe39ff5d33",19050:"c44c989910bfa305",19078:"ae23ac77aef37b90",19098:"f7751fd85ad2a7b0",19109:"4fe2a61bc2450337",19135:"635742acdda1eb46",19161:"32747dbb1bc92a3a",19163:"d7a422256228c87a",19210:"0e813df043f4b8b9",19211:"6547aed3ebe27919",19212:"f742e4db17ad7185",19215:"5c836761048bcf85",19220:"ae85df030c4eb33e",19233:"682384eede50778f",19237:"5112c87d5f04224c",19312:"f875d3ae3d6f69cb",19318:"160a6a5cb2101b9e",19319:"f7c6ac1e03ea1112",19330:"0d9ca70d9b622505",19335:"684b58037afe44d7",19351:"749afd7985e8d83d",19353:"02e02db3c62a90d3",19360:"bcdc0cf9572b1b28",19371:"51020007d4c2cc4c",19374:"b7d99045bce947ed",19389:"62a5a23661482a65",19420:"adda0ff3ddb184fd",19432:"f79174739581aebc",19433:"1d0f6e1d64c03077",19482:"ff8def2c7dff58fd",19493:"0234f1f569261a0b",19495:"a3c0117b690a46ba",19499:"f9e99d1aeb55b203",19521:"5dc99d26dd4029fc",19534:"b2d2e87386cfb5af",19562:"39609ab7f3aef0d8",19570:"fec3e66f36558cd4",19599:"1e6c19977f2819f1",19627:"06d281e43f0dbb0f",19676:"1fdfcec583e01ad9",19707:"5f6c3ccecffd9624",19714:"18ade903d66a3b4f",19715:"b61d8f5d26c4b83c",19735:"9348eecc643a9b89",19753:"6f80ee535dcfab69",19778:"58e9226018439ab9",19825:"da35ef072711e797",19853:"cff6308ff5f58998",19856:"504427bd489d93a3",19870:"58ca1aad27084188",19908:"54af52ab5a7fb5d3",19969:"5f769b3c85519fc9",19974:"d0f5c0ef7e1c5e09",19997:"de8dd87bf7e8c8d1",20012:"45e7457f4e6092d2",20029:"f5a7f5c738d3d416",20047:"c587ee5c30c28490",20058:"8de9654600c6d663",20083:"a79395b2760256e3",20132:"e571a114fa3e6eb0",20155:"9a29dfa92af4e5a2",20158:"04957dca5b21d279",20188:"3a98b922af11db27",20267:"01d6d3b14403c897",20272:"25a07ad8a02c0727",20274:"62a1a3744b0f2e97",20295:"98807934418b8869",20323:"3cd3f1f54762397f",20351:"103061319cae8a21",20356:"25dd9d8aeb7b6b95",20397:"0df65806b9d0eb5a",20401:"e9e9a3e82e00d72f",20406:"40492f5b3fabdc19",20427:"311d821f22cfedc3",20443:"74f986b9d27de7b6",20464:"66180a323bcd779e",20499:"43dca2ca8f6a6392",20516:"75735e7c891af699",20532:"79cfe6975364330a",20538:"6c0a760487dc4ca4",20545:"68d8cf0c7e9f3322",20573:"46d4e034a22e6fd2",20668:"3e83dfbb78e78340",20672:"5f859d315562e085",20702:"6ceae983e5404744",20718:"92b0bd95e240a86c",20741:"49fbf14eb4e654b5",20749:"6c65c6e260c106e1",20756:"9994342d23c3fd38",20764:"8fd32d43a37093fb",20765:"09475974ab9f01bc",20862:"d01362affe2d062e",20873:"23dbd989efe81b9a",20904:"4031a8b7b11b1a37",20930:"ba62733fed6187f0",20933:"cd5974a54a69edf8",20945:"c4971046c7f892e4",20948:"df2444ef1e3e1e7c",20957:"0afa8ac22503f43e",20965:"570caec619620ff7",20998:"fe287fee4b909331",21033:"72a140e38fce83b2",21055:"3da52c29ace81db4",21065:"2040f7de2a7f88e9",21083:"a7b3e9598282725e",21103:"71e66a63e07dc8c7",21112:"f11831337b02be92",21141:"ad5842e9ee172f58",21167:"eb57dbd1de699a30",21174:"7d5ce2f82a164d97",21181:"5d113e296e61e309",21209:"aa06fb0bad73dec8",21247:"c7ec6c0655ed1edb",21264:"2e5207b61bf49949",21311:"14e6d61c5354fa03",21346:"80ff5617887ab230",21372:"95efac6f57fd5fba",21439:"7ad6d6de1bef9635",21477:"910d8c93892c1491",21514:"aba808d58f0482ba",21529:"b5c1bfcbc9568b44",21541:"4a2d44ff61bcef5f",21555:"bd082f569dfc219a",21558:"b6122bd52caecdae",21571:"3512fad2a89795f4",21590:"be9c537fda1e8dff",21632:"e78215d92b89680e",21647:"3e6600397d08b22b",21672:"afd097c1f7eae2dc",21689:"065d30ee3f52d00f",21705:"705de85af0689fe1",21706:"8e9eb1c7d62836b1",21767:"88d1e3d0ee051218",21777:"680c725a69bfad45",21786:"634f8d31a43a77d7",21792:"5c1489ed7adfe0a8",21822:"1253a9d56e5ce798",21833:"075e3811f48addcf",21836:"f5cd291ef57059a8",21838:"cfc56174015ec8a3",21868:"526fe45670855dd3",21933:"40069323b3d65ed4",21941:"054bec20dae03ae8",21978:"98d55962aa196ca6",21985:"b28d95c781bd7ecb",21993:"65c01a235130afa4",22012:"7daafbe36bfe5775",22042:"282a378a09fd347d",22064:"d1750a6bf3b3ab0e",22099:"fd92cc23a1b695a5",22121:"4d5fda4429e71d72",22125:"5288db224fb6b53d",22194:"1b0da34e4760a0a7",22272:"720faf1011f15a49",22312:"f5c2c6f00432cd00",22321:"fa3b9822c4b4b6a3",22348:"a994d6caa0a2a59c",22410:"9997b123a41618f0",22413:"2fae32e5ebb08e37",22423:"26cbcd2bd68278da",22452:"a01e074e85f3ee07",22460:"37babbb0c4ec2e76",22463:"8afe3a1f77db2895",22479:"d20be41a4973c676",22487:"bebf51dd85530fe8",22499:"c6bddcae548a51f2",22540:"77a147a1a81b71f7",22555:"3145f8f6eb49066a",22568:"9144dcf71e25ab5a",22581:"0e263c190127bb4c",22592:"7ff33c527a2e863d",22616:"b1f2428ceb70c0d1",22628:"560ba3241a31ca9b",22670:"489f6e263013d699",22681:"06ef8eab200f9306",22750:"61815b64805d5b8c",22764:"383a6eec503ed1bf",22765:"780e00811c459265",22767:"4b7bc87c013cda04",22799:"331221564df5e064",22803:"3b2e27ef2bd2f6dd",22842:"fdfc769bdd5c849d",22857:"722e0118756e7ca4",22913:"bb224ae3d21363bc",22928:"48aea281e577c849",22938:"fcc33e78d6b1b89a",22991:"285fd41f0b20dab1",22999:"eb8d800f924990d9",23006:"f60bec9bdea862c2",23017:"92a8ed345bb59861",23020:"8ce5271ee94ad5c5",23025:"7f9cbac38b473664",23035:"aa2f206e473a6521",23041:"6eb5d71e7285d6d9",23046:"35102f62720280d2",23054:"c092da9cc8f1ccfc",23063:"63276bdbfa6ba76c",23065:"69b492469ee2431d",23088:"285870347a68aa9d",23102:"18d5a1ae2b9e791a",23106:"62e5ddb15ba80645",23134:"bad134c5356ab847",23169:"82e8707cec061fd4",23172:"31a855e5528ca971",23183:"126f15d37a2ea407",23186:"aea2a8db855a5f21",23190:"08be966737da1e93",23246:"beb27bb5e88aa681",23264:"7c8b259b0a46c9c3",23280:"650f7b1700c77925",23283:"309f81a748904f35",23293:"ca13112cf75e0c19",23308:"59292380030ca82f",23363:"ae01739d9379d289",23400:"141dbd6d4c822062",23402:"a68e464590a30429",23493:"0c0dc8fdcaf44835",23494:"ddafc19ed46e35db",23516:"c69dee1a756ab587",23540:"a9e2aad7d5774806",23552:"eea082bae486284b",23594:"5e562e4ccc7a83cf",23601:"ee7cdb3e75fcb532",23655:"a39cac3b58da6df7",23675:"dac5466308797a38",23728:"a9df72b91711f565",23747:"6e53de75cdfc8689",23762:"327061499f89c564",23794:"0a0a6fed32f921e5",23797:"5d4241b12c698fd5",23810:"b79cbac015f93b94",23812:"dd1cbb5ff926f710",23828:"9d403531a22a41d4",23859:"e17176949e2d4c21",23871:"b29f09620c2955e4",23890:"449836ead013048f",23891:"9a03ffb318753749",23893:"4a8d0d804e4ff13b",23921:"3f23abfd2a63d1c8",23924:"79e5e8362757da6e",23935:"503494273596e22a",23948:"5ada427cc1f5f3ff",23954:"350042ce3e137c56",23956:"74805bdde6ea5749",23968:"052a6c03b5405192",23970:"0fe8221b5015f2b6",23989:"cc6fd0bd6714526b",24013:"768bc06f43791fa5",24014:"4e5e89fb267aa843",24053:"9066cc2891c91fe6",24073:"cd5f94fad23964b6",24092:"b6480386a3ebaa87",24149:"9cecbcf5143cb05a",24179:"c785752098e2fad9",24197:"ec3e3cc8f279747b",24251:"aaad9055b303b8d9",24278:"782db309201710a9",24282:"84352c72b96df36f",24333:"06869323542fc72e",24364:"b1114ed2fb835e3e",24376:"d6e368a5fd429ebd",24417:"f97bfedafd56fa79",24444:"44cdb03a3170d8f2",24473:"8b8a9de7543b375c",24489:"6d1b143336452c46",24493:"009eae4f772dfe1f",24516:"43ab6f181169cc85",24526:"6e1ec26eba662041",24541:"3b04bf9c77507d2f",24548:"baf7ce2920281f93",24556:"90aec4f3282f0213",24572:"d7ab9c39a35e5b0c",24625:"529da3517936949c",24632:"f291ae18eb3aa3d7",24657:"6c890c67fe5388ee",24665:"e5fed0e99a0ecbaf",24672:"6cdd44085fb9cf3a",24677:"07541c6b04915c8e",24764:"bf79f3e42a128ad1",24820:"e02b3e943ba76c12",24823:"266221d3cc9eebd1",24860:"28572d6eb98b01ba",24924:"a4dcba432e3e1bb4",24925:"14b4a9a6011cb8af",24933:"5765bd30987341bd",24937:"c98a060b87000dfe",24944:"b821a2c20199a088",24974:"0cb12ccd6a316db2",24998:"7ee3d154338d721d",25026:"c958050c3db06657",25066:"5b17ddca1bb05ac2",25067:"229d902c91264ebf",25110:"2945b164dfec3946",25121:"ed19b2042bc9b102",25143:"1cfd3fddb752619a",25145:"61388de9ea22d755",25155:"1462fd821b1ef9be",25175:"ef1bd292cb44c880",25181:"7cd72624aef208f3",25256:"28130af4162716c6",25268:"02bb942b2d84013f",25269:"4dfddde6e955581f",25270:"bca5227b7591d380",25312:"c6603b993ba7a868",25343:"dbf8b6e8f3447684",25350:"49a901da97684c2a",25375:"46e95591ec2e1db3",25383:"3d168b1521dd392e",25409:"1dfd97640dc6dae7",25430:"4564251bab3b6aca",25442:"1ec9e55887defc96",25443:"c3af4fbb21e040f6",25446:"bf2fce83f184aaf4",25447:"03905633b2fc6fea",25459:"4da4ff297245ef92",25471:"a3d7299ee86ea27a",25502:"e70be905c9a8cd24",25509:"336cfe013a842754",25532:"90fb31a411c9a3ac",25570:"a5003386d6a17a3f",25575:"a1ba7bed98d1b416",25580:"0b10d00893e1855e",25585:"9aeff2be91e710d7",25604:"6550964e88f43a7f",25606:"487a3ff6914136e9",25612:"19c2381565380432",25622:"6d6fbb8489780d59",25624:"02ab39f155ad5ba2",25659:"adb3b0f5785bd4d0",25670:"f50856f79f07ce55",25700:"3b552550a0ded3b3",25702:"02600a5f0fcd3d50",25721:"d8d019a9fc6c617c",25814:"74ff13d0171b1398",25841:"69ada479da727a91",25891:"7aa44cc2fea94821",25901:"505d209bb7891176",25938:"36ab4822e68bb312",25970:"7a72cd6e696f52e9",26025:"ee81544766b9ecc2",26124:"348fa4355abb52fd",26155:"0fc61f2de891db6a",26192:"8b288535781659d9",26205:"ab453ee5e58a2813",26263:"848e4eb4e253b51f",26332:"6a99087b5aa52644",26340:"7f777f03e7874bf1",26354:"fdd4b6dda1e4ad9a",26442:"9aa114aa2a1aa8da",26443:"b3305af3257a75b0",26444:"e7ef8ba54894fcb7",26445:"934de9feb00facea",26447:"09433c2992b90aa2",26510:"a2f5f4cd8a782e14",26525:"216ec9768b1e8433",26553:"8926284c4cc8a78f",26589:"be46f27ff8588d04",26599:"c6571be504c43eb7",26610:"b952bbbcc8f27bed",26717:"091c428928a2e52a",26756:"033762e367d2322c",26759:"19b4d2e8a85cacb3",26811:"297d374b486e8b97",26816:"385a321a51f18fb9",26819:"c48c0ab2c23dcbef",26822:"de9f9a603b54f651",26828:"1cec6dfa83eb35a7",26841:"445d761b4181ed26",26842:"59d0e4cb8782cad2",26858:"a296fdcc1c45454c",26884:"62ac75cf9c580ad0",26886:"02b39c28dca54d3e",26891:"dc927559ce02536b",26916:"7b7bfe1e4d4a3f15",26917:"6a08d2a98be2ac11",26924:"b6f8936c7018c42b",26934:"a44b32ae962e161f",26946:"37180023225d64fc",26958:"ce36dc156fe2039b",26960:"3eefe385ed21f9ec",26978:"1f905ab4c49c9ae5",27005:"2d38d37dc45ade1a",27006:"af55af3028a3b575",27013:"38c9abe1f6c33833",27029:"7d4b443ed981ed9a",27030:"a3bb7ceabf5e15de",27075:"5754c7553c06269d",27109:"0f83e7035e2ddd86",27112:"c80e0575cac48a09",27133:"fa0cac812d45de72",27172:"fbf7b1392fbe9783",27178:"0e8a4cacd407d499",27183:"39f5a5be83527d6a",27199:"16bbbfce3a941c68",27202:"b29a8d283cec7561",27214:"1fa75108855b2de4",27217:"520f0bafd8cac992",27245:"785be8332e4e7079",27246:"fc1cd2116cc5d54e",27269:"e30af085fa05853e",27284:"f5133b1da3c01035",27310:"4a758c7f13a20611",27386:"7ef7de5cb4910d5b",27455:"7e6fd94757de7e0d",27488:"d499a525fb2c4b57",27490:"4dece57bd787ef31",27513:"028362f758dde9ba",27521:"a2a014cbae259fb4",27573:"626a1832dbb5c8e4",27593:"a5095b6b9b935387",27631:"117c1b1c024f3def",27639:"fcb59c10b07d8136",27648:"f2cdda2266ec3a89",27662:"7b8a13f8e58873e8",27782:"1f43a3cda93728db",27810:"ee645aa0abf659aa",27853:"91e54629488babba",27910:"0e98f21f811ef69c",27946:"aa5af988d4d873a0",27947:"1da252459774692b",27954:"e4303d573cf1a053",27959:"bdeea285d91a20bd",27986:"b40adb717c991462",28030:"ad8c978424af84b0",28048:"4e36c6a63f32177b",28087:"c25f29df307b1c4c",28135:"df127a03dce543f6",28178:"b97d7840c3578f93",28186:"6f6f56282d172210",28205:"b7b80fc09cb1058d",28224:"38111dc4fcf90726",28242:"18f630dbe011ad19",28254:"bd0cf470350854bc",28256:"3a897bf0c5b63316",28281:"1f2630ec59759d3b",28299:"28291078efacb98c",28394:"d0a15742b6046577",28395:"d9ab61926a3cb4ff",28400:"02775d8192bfaef9",28410:"d67895a4ece5e5c4",28420:"f1c54c9717c73d97",28430:"65718d5a75350907",28433:"77e5809d52bd9faf",28437:"809ca3fcf86c6820",28441:"92fea4a6e82dfc16",28443:"6238f071b3d1e4cb",28457:"793ba0b2621106cd",28471:"68df516c1b3e2b72",28488:"9549ae082c722edc",28489:"481d5f86943e3705",28497:"27a44cabbd121520",28505:"b518a53b5b588f7a",28508:"37429e7b79cdfb23",28549:"d44419fdc9115204",28560:"62cb0eaba08680ef",28564:"e35d832336dbc3db",28582:"a8f9c416fc40327d",28584:"ca171e2d2467434c",28658:"d04cc1d02a433e5b",28673:"709619f4b4dfd371",28716:"1101b1bbcad315b6",28729:"802bbb50b9bbe72a",28746:"662d78fd52964c6f",28749:"49fac0bc92fa3bca",28767:"c26899d80b35b05e",28812:"63139e64b740b148",28830:"bc48ea597d48efdf",28846:"85c288867e7d6486",28853:"23a33be96fe6f4a1",28859:"d7062e16bdf092a4",28862:"2cff1ebe6edcf810",28974:"cb581657babe1791",28992:"97a25ac77a47f0be",29e3:"0a21deedc2a8b565",29025:"5d5335dc6e02f83f",29046:"00e5d5fdbf892c27",29095:"69f50f1eee909662",29117:"e73b7de7c9268cd3",29118:"9ebf5bdf53507ef7",29122:"5c20cfbc3327d74f",29144:"092708aa7b297668",29180:"5839b5805c8309ea",29188:"abb048a7bf222429",29266:"e43db32f0f785b80",29290:"f821fd76c9f75890",29323:"30e3d5d438624617",29357:"544188ee52616734",29367:"3855447da4697bae",29401:"4b47e13153cbc614",29405:"4351232421f3d8cb",29407:"079e380597d63cf4",29453:"895eb739e8a48478",29475:"747dafd32fb43bdc",29477:"5d9c89ab5c44507e",29497:"db77bfc60fc9c8aa",29518:"b1d7b062b42bbc76",29533:"8cee80218b04c3a1",29539:"65e46fe1ae12156c",29559:"418c4ad23d3ff322",29569:"b4dd13d469f76e08",29709:"225ac4b9c8503f6d",29722:"0aa6aa502f8c12fe",29731:"2bdc266042812218",29735:"c35e143eef5f07ac",29741:"ba840aea4e0e9dae",29780:"8a50fc568003e057",29782:"6b8c313a0be9c71e",29813:"a72e9035578d7f19",29837:"177378c58e77d0e9",29844:"d7f3c631c1a37523",29861:"1c07d268cef8cfdc",29881:"c9039c8f1ea6cd75",29884:"7ee79fd621a58d67",29922:"ab75dae90eedcd06",29942:"b1ab5adf8dbc89b2",29945:"1ce25db543a5b880",29955:"3ec84bbb14090f43",29959:"322223edc6682b87",29961:"7ebf1ca34aa6f614",30003:"4d2b52694a4e5c4a",30005:"3eedafdeaf296e51",30018:"43da58ed08207210",30038:"7bd18d64a82bdbc5",30040:"4d6bf16b45d985a1",30077:"83215b06b1d6a6e2",30078:"6939605424ca39ed",30087:"5d3b7c7f6459710a",30092:"0707e2c4403f03f9",30100:"48a729b03e498491",30141:"72982a43bbfa7fb1",30150:"3fc85a8f3110e344",30168:"7a3ce158c9fc71cb",30174:"efb5ac02a8ccd4e7",30185:"1a1fb507ebe04c7d",30191:"20547d952a286576",30197:"8d110f72efec09ef",30206:"768f50ffc46a2c5f",30216:"ef287b7cdfe5a9b1",30217:"8246ec02066b94dd",30235:"619343ad5fedcc76",30236:"db459e5d765abbb8",30242:"3b8f4e7ae174b27f",30288:"48228239a5cbf46d",30291:"d7a82508dfebf8c7",30313:"089d10c836198075",30318:"baeb7eb49bc059f9",30321:"a67b31219192f051",30384:"472d0fabfb7293fa",30420:"e88fdb5b50af0a55",30480:"430df010e53bb579",30509:"b8a76cd1b15be705",30585:"b9325f848ddd5293",30588:"ec7063bfb0a57d96",30590:"35a480ce1acc3bcc",30637:"eaf93f83322d4794",30669:"94c1c5207dcf436b",30702:"4b3b937e1277ef6b",30748:"8b4bd796de34e74b",30778:"7019075b41adac2a",30783:"3e9856bb8a473a33",30817:"c8b462e3ff76be63",30864:"1021f2d5fdc2c875",30879:"5fcac3565e7868b1",30909:"c2d83d0bf73b06bd",30922:"0bed3b84142a6ae3",30972:"8310751fa50b930c",30977:"58565c2a53ff4902",31e3:"5eadba02e7786ea5",31044:"9a13c5891af13c7e",31057:"9e2f422352928eda",31063:"1211046a32e150e1",31081:"5822350b5bcbdb0e",31142:"c41f8fb63fcffe9c",31167:"7274735631e6f4dd",31192:"d49aeee13fb31ad1",31210:"a1a875ba6132bc8e",31245:"cf8158b6b9cd5ce6",31248:"d933bc56609a70d1",31251:"bee44bddb939be20",31286:"77a90f3a613963b1",31304:"36aa5aa186b10931",31353:"ecdcfa8a927ae492",31354:"967fd7061bc0763d",31374:"83d71b4c64fc44c2",31402:"897dc0df0b8bafb3",31433:"2d05e95297a536d9",31503:"baa97472306ae823",31506:"ecdbb55e91d3fa07",31513:"d91bd3f9e3bbb230",31527:"9cd6ae9a243b5af1",31538:"a83affdc947f2475",31543:"ea264e95ce1097a2",31597:"1b2193e87953a8ff",31624:"d541937bf6b367d3",31625:"d623096619f1c4a8",31693:"e701fb20c917b383",31702:"9f28d419b928b1af",31810:"0370b748efc30659",31811:"2dc063b60d5e7e96",31835:"19e1e276e6a19029",31908:"942f12d5fe0a0a37",31911:"4bd9f6f0938297e3",31953:"c1024f53f7aedebc",31963:"389c17529fdbf346",31967:"487a0b79739fd4a4",31986:"ad0d88be4764203b",32021:"1334037fbf34c64b",32022:"cb991c832bc99b23",32023:"1c758fab586fc336",32034:"5e72847c64574a7e",32057:"703896934fc2ceae",32071:"9e3ff523e9c7fde1",32076:"6badbe42a3a5aa89",32085:"93b3742e2d6f704c",32093:"2a9a35e540c5b9dd",32094:"bf9f569b2e704a7e",32106:"bfb25977a022d483",32190:"c1b0c583dbb5a332",32226:"ccb1400fcf94ea1b",32238:"d4f4afd4446ac5a9",32240:"1cf593ec801d2874",32241:"f61c9f591b7f7a10",32276:"4508b8b6a806ffb2",32323:"a537855acc3e4e0d",32334:"f4db42f3f3a8aa0f",32381:"5bd7f6e3f518d01f",32398:"b6d8f5130689cda5",32420:"888b15d446133430",32426:"c5a83da656757ee0",32521:"6de0ac991c7a87c2",32528:"936880966f1d84bf",32529:"7c9a1f7edc3c8492",32610:"d461be6c14fcdd46",32647:"242f7fda389d6278",32651:"7d24261e1f35cc93",32653:"49e3b92a3dcb5aa8",32661:"1cf9f77353093e13",32665:"0275a97dec0564e4",32673:"7ff86521a58d4dcd",32719:"6cdd43c806b3b252",32724:"b498668283c18a6c",32731:"72f4d0435ef9c6c4",32751:"36c17a76a7557a97",32897:"d5636c2c9c509c93",32966:"82717cb6e69333d3",32978:"8c52aef2296936f8",33014:"c0c080394e62134c",33025:"407891edc4d9dd67",33075:"8cce717bdc30d38b",33097:"1b4ae5155cf2341a",33105:"bf6a9a5bfac51123",33112:"101b1de2e61ffe38",33139:"8288e845165ec5ac",33172:"e0a45d478af1c5d1",33176:"6dd56fab9080406a",33181:"dd2c455bffad4a4a",33199:"72be2c4832b767f3",33206:"39005711a35ef0bf",33235:"360cd35537b7608d",33238:"5db3de9cfdb36d27",33282:"7f3b363f09600fbe",33346:"b07eae798ec56e90",33371:"0ac4f6eaed7fb3d5",33418:"149094f263658713",33454:"b106d52fc46488b0",33477:"b392907865417514",33485:"ce836dd25de84554",33488:"984ba3c9522317ea",33493:"f12aa7ebba06a5ed",33526:"9a427529959c0912",33560:"7e38ed8224a56c50",33580:"6a514a2d0e10ba2c",33586:"cbf9e677195d5d67",33603:"2a86b3badd66ab3e",33611:"882d010cb0eb960d",33637:"fe4d6c3fced81402",33642:"d5cbe603029d7b6d",33665:"fb371923d942d142",33684:"5db6830b81447d60",33738:"759869426c892cad",33745:"7a2fb0a074245ec8",33754:"8173eb542de93237",33772:"14793fb9bdef3a47",33829:"5bf30b769ba8d3e4",33876:"6f73095b5a27df38",33884:"d8fa8cf0b85903e7",33885:"f324cbad74b1cbf1",33903:"f2ff8eda5a2e5492",33925:"899cc2d93104b249",33937:"93252d0ee154452a",33944:"cf8dfac47c4a125f",33959:"bf2ec9f376ae22f3",33981:"f3921c85ebd529d0",33987:"5254e8ff93e6625f",33994:"90538f0807e81830",34e3:"6968d93ece875519",34027:"e67ba6a49ec434d9",34055:"6e3924006cc2dc3f",34067:"14f068b2c69babb0",34096:"6a624348a1e03205",34125:"2c5eb1bf077b7733",34179:"c0c560c3d533742e",34249:"7575890298ea1d84",34250:"548926de59fab561",34255:"eb7cf8cddd446417",34257:"ae5e3e6b53cc02e0",34258:"d082f699ba792678",34279:"c7eba4136be68dad",34287:"6faa62e6f7bc2664",34322:"f9959248ed490586",34349:"c22a1a2a070f0d11",34379:"7d6f67d2799c77fd",34425:"d40209bb303fceec",34487:"5a946423982284bb",34496:"261d7bd22184c9c7",34508:"ccbb98a0de0d0fbc",34518:"2983991e54e1dff9",34526:"ac18199ee534af7c",34536:"9e6145150710bebd",34544:"5ecf5f63f0f78ef9",34548:"5c6f39312814a0e2",34554:"57a0d0db7ed14725",34595:"974c2c1bd9cc0573",34602:"dc93ce3c10e958cc",34626:"91795f91d963a592",34632:"86e38b24cdadcc13",34648:"39636c564a168453",34652:"6e4cbf0f062c97ed",34653:"9ce9e6a2e3583849",34672:"ab1105ec4c451976",34692:"fc885536d5530c57",34697:"d65897a2c4e136bb",34801:"aa575c4793772904",34814:"a8fed5adfb53e0cd",34869:"e158e0fa36646eaf",34871:"d774cc368d103962",34882:"7c1bad3402e24a7e",34884:"af0c245b4be2755f",34918:"5712e61916c9d95f",34945:"ae9acb9276f371fe",34949:"c0a76c124d094cdc",34966:"5472bf4dcdc756a2",34983:"4359f0764613c778",35004:"0a791b1ae5f3e5c2",35020:"7a90c5643f96d839",35024:"603e9920402dfc12",35066:"2f39f6b36eda342c",35106:"5ac566f020a146e4",35108:"0acf52abf792cf0c",35110:"1428366434598cff",35132:"f4e4141aa1a41c36",35160:"c187e1469c252c2e",35166:"02e87837b73798a8",35185:"7acbb5baf25eea25",35208:"5d1b2138bdbfa077",35235:"f50f16c47620ce45",35241:"5b5fc36bc0af6625",35255:"3187de8201fd930c",35346:"604a2f9755f23955",35364:"56de6e7aa83af3f2",35376:"9db7bd9ae963b74b",35391:"6a25e5072cd756ac",35392:"7027fccf034f11ac",35409:"bb3da789a2668a82",35413:"c7f46c6ff478605a",35430:"9afc2f4a98d7855b",35444:"80bc294080b7b0a0",35479:"ccbb398bcc0f1063",35512:"953f4c3fa72170a9",35540:"18efc6a159ac4326",35551:"d038168496a4d9a6",35568:"d3c4233ce9df7845",35575:"e0565fbf654d05dc",35577:"bdb99ca1aa81431e",35587:"3324fb5192eeebc7",35588:"c4fea9bb20a4c026",35592:"e24e3d1079c0aba5",35626:"d007287ee85d5987",35668:"785da46b0e3c077a",35677:"f966e8907dd6f7da",35731:"f6de524324bd41d2",35795:"9eb2502c072da173",35799:"f081e12598865bb2",35801:"15a1eb8ff7f6cd01",35805:"749395e63d3074c8",35821:"f27c28fff58434ff",35833:"941fa2246e26ff51",35865:"8eb8cb87eee63c8e",35874:"dc066c4004cf1372",35913:"1211c686216bbfdc",35921:"6dbca99ab7590446",35922:"14a78b0452b08ba1",35940:"b8ae4357463c8db9",35964:"199a8a85311d82bf",36009:"d6968a58c4dc6b41",36018:"a3afd5ab2d1e31e8",36037:"61f73570a50fd351",36058:"5c7de73f0fc848e4",36133:"698e294831fb0a3d",36142:"24de33228de7f67a",36153:"c0065728554d5d83",36173:"b118df9ae9992b3e",36217:"bdfdae0fb42490a4",36227:"b14778963bd6b28a",36229:"4b6f02ee33b627c3",36279:"adf79e315f9799c1",36333:"820eaedb1e7338e9",36391:"87649218a2a280ba",36397:"de217880729ba7cc",36406:"b866dbb36d680b94",36416:"495327cad1ed65aa",36447:"6ad6def249f6dc29",36477:"021fe16289d451f9",36537:"0fb52050f8d8a924",36540:"327d0f72685a7b75",36552:"381f5dbffd6f5bd7",36578:"caf16d08baae0128",36608:"db25feb19279f202",36625:"a464225775b59c99",36644:"48515bd696ca2171",36665:"2c6c3b3b980fa1de",36688:"d51e8e53560be978",36714:"2f42bd27ca8dc3e0",36720:"d005aa4d009caaff",36730:"92c9c6e12bb2cc59",36759:"8022bd19630e8989",36783:"a8fcdf76a1dda7e9",36794:"3b668eb8aed77835",36821:"23c0246c6b3c1114",36848:"f4a95d4d8d693855",36854:"823b8bd313dbc5b1",36856:"3cafaf338dc79b3f",36886:"9c0bb93f4b8149b7",36980:"a918be51af47edaf",37025:"3007add311f8e43a",37085:"37834df8dd906963",37102:"0327f21e6d275d63",37106:"5c5d7027e3aa96b5",37114:"90c062ae4ff451ab",37123:"89e9bc0caae9b469",37131:"71206d6e95a4e9a7",37209:"2fe8e559acd5d1e0",37232:"b6af05288f4b4de6",37249:"ac27dd994d104d9e",37252:"cef7099e41672bf4",37272:"b431ef2e5eac3266",37288:"44869cc7648bf1c6",37301:"b7c2bef8d29d7cc8",37310:"d0650fe04167a17a",37342:"c07bb49a49fe2c17",37364:"0debf2905523c8b2",37378:"79a9e4aa2c2a4d5e",37390:"2bf59985ec73a199",37398:"1337eb5abf02916c",37425:"7f536ad7a4abc4e5",37436:"530449f425bc397d",37437:"5440440022478f5a",37446:"e0b8c159ddd66c9a",37458:"c86af7267ab677b2",37472:"482e4fdb893267ed",37481:"1a1f8d9f431728c2",37514:"565be7ce17a7cd1e",37559:"cd2bfa22f709b0d3",37572:"d017c1e98e418bdb",37589:"e7a8b8d7bd7fe0da",37591:"cd1cfb70716e2702",37671:"3226a726a6f1fe78",37673:"ae155d82acc02d5f",37681:"a957caf8b5cba181",37684:"10bf39c72c609f28",37689:"e262c4c361a7d0f9",37693:"d4fcdc63960da75f",37726:"656cb73846d535b4",37754:"3939828938854b2a",37762:"2d98fd83b3f97c73",37767:"c2c567e0dd722734",37784:"3eea681b9d3a025c",37793:"5353d1e1f29caee7",37811:"98eb686e30414584",37813:"69f103b975232e15",37814:"4bcf1588c20d277d",37827:"41f62dd2e1a8cc40",37889:"f7b4ad25441b01fb",37908:"27688d76829586b5",37965:"f57691dc42742931",38001:"973e43498b710714",38002:"5d50e31df6110ac8",38008:"773f28f7b0cf59ed",38021:"7ff305f882bf944e",38082:"251856b6567be988",38090:"b1db032881f417d6",38174:"66b40560b707b32c",38195:"14085b1d96cccaf1",38221:"eb04baec7bf07c35",38227:"7089ca0d96c35569",38257:"150139dbabfef849",38259:"e29e6f0e223e584b",38261:"6b5455f15d24326c",38299:"70383dea89b0d70f",38355:"415523030beb2edf",38393:"59a95d0f435fc8de",38398:"33348d022e8e3f15",38430:"9fe454c8e5ce1087",38431:"3277df32be525548",38437:"421f6f1d40cbf597",38452:"a0a0f672f188ec42",38457:"6e161b5b83762eb8",38461:"5cd7881be56bedae",38535:"28f730c845b2e95b",38542:"323e78ce0e4befdb",38552:"76c27b5cb1e26f70",38564:"0ffcc3ba720d5d03",38576:"0c71a2ee21896a47",38586:"8fb4c7dd07844215",38652:"09055d28758f86d7",38653:"96e58fc70e5b10f5",38685:"01f3761d2658f3fd",38693:"2f5d28ef328bf427",38694:"37948e965124fdca",38699:"65ef1742b4b3643e",38746:"0c650c32b9b04697",38756:"43062e8a2c880cc6",38783:"e710ea4719713bcb",38806:"dd105d65909cf91a",38820:"e8649c82921fa26d",38836:"f3e384003c310f1a",38840:"43294762774c973a",38860:"1af69afa6a181a7d",38883:"a601c1d3f68962d2",38885:"19d7d19fc4dd408c",38957:"838fe5a211b8736c",38968:"d050768d065727c6",39007:"18a7d1d5dca54407",39036:"518fe196d295c026",39074:"e1cfdfb8a91ad6ea",39079:"aaebb80bff661bcb",39090:"949aa80add749d59",39109:"1c6ee2bd0e8d3cb8",39117:"1c982235a7754f28",39262:"4bb165b862309bc3",39307:"ac0ad68cd3edab62",39308:"78b88f1f9f23b495",39319:"418722fd429fc88a",39341:"ecaf1a14b296a6f3",39363:"55c0f080b9f89bff",39370:"c71308c090fa227d",39387:"10e8c3cb5e531d21",39396:"4ad1cfd71d7ecc6e",39410:"75559aa1b73a03d0",39412:"4a32b068bdc9b0d5",39435:"ebd6f73d02ce129d",39442:"b604a60253f48ce2",39541:"0d221e6b84f6b144",39613:"6c4d3c7ff281d208",39650:"5ae91bc45f558681",39706:"6733b39d311364b2",39717:"7c9e8119ae6f840c",39724:"7aac64cd126da232",39730:"c6861ce710516293",39818:"3e7128a25b670bc4",39840:"69d46e5eac805173",39845:"cd38543fced31aca",39865:"385d8b6203c25862",39872:"caa24bc10dc4a7b6",39874:"6f24e7df84b588ab",39886:"01f7d40bcc860f40",39888:"87b36bab446ea479",39974:"f3f9716425f9ac20",40042:"d18e37f1cc44fe46",40043:"729bc15eabb34cbe",40060:"319d3ead8cb510c1",40062:"2a8277e52a66a387",40085:"63d09d6a82b95906",40114:"970da419d2a31b5e",40125:"6f7173f2955ec24d",40150:"76c61e2401230f78",40177:"a10e917e19b109b6",40191:"6a84bcd22b1b89b5",40221:"992693c882aba1c4",40238:"1cfcd1c6806a132f",40285:"97c04c68d492966d",40355:"45d6ba0b15e119ee",40370:"2018d463d978ffab",40416:"b7bc5e807b869c3c",40433:"9f1e22491376206b",40553:"f76927848b5c854c",40583:"0a0954a62b4c2430",40596:"bb07aa06519b57a6",40600:"32231d34cdaa9bd5",40684:"fe5317549747fb6a",40697:"9654352e9c5a70ea",40705:"76dbe76c3a0c19d1",40756:"e5627a97a391dd48",40802:"55ca8526286c0948",40824:"9199cb5b9bfb0efd",40826:"0be0110f87b77148",40840:"9005f2583c01ebde",40857:"829456e11532a46d",40866:"9327e7f51c70d7a7",40868:"089ddaa46c3a9844",40879:"ece461672be06439",40953:"d011c2f55d34759e",40963:"0fb388e84b7c0ef0",41007:"9fe9d7e53c6010ae",41032:"a685ab8e920c4ee7",41064:"1cd1ad60917be906",41071:"209a25830e41507e",41127:"8d83690e026bfced",41140:"5a0bafb419f68033",41143:"205c3fb86caf9893",41188:"aee27c8b2696b60f",41193:"06b3aa38e1e89c6f",41219:"1f5763efe25c2941",41253:"75dbf9203f522f8f",41272:"4f33e2cb14048f96",41309:"5667df7a2f5e9ef7",41348:"215efedfe59528a9",41394:"d50ee421be0c2177",41422:"d7b9abe9c425857c",41445:"3b34246ca59fb614",41480:"ecfebea6f4e58257",41491:"490240acab6efec3",41520:"be229ec5ed895daf",41557:"548b2f9d89a80ed1",41627:"7f9f1a234b6db222",41676:"7cb840706af0b4eb",41687:"416a283a0095a8ad",41707:"69a36fb7905e5757",41719:"d3adc4171b415b9d",41720:"83884d61b75d22d4",41730:"a8452d60c49c9036",41746:"bae36326f577342a",41787:"20f6f087d5ea7bb9",41795:"cbb8e6ff4e65b666",41799:"fd2b48ed9d6af38b",41810:"38a5b6344de4ac90",41883:"8e5e40703402e22f",41895:"ad5e304a12cee4dc",41897:"d2c2e641104dd2ee",41992:"77017682e69d61e3",42044:"76d5b189537c3ead",42049:"f8209cead88dacc8",42061:"d3c8e33bd08e6419",42065:"70edc917d1e2f873",42119:"56e28de57a091c3b",42120:"0b12f0e0a0878e5b",42122:"139966d25414a0a7",42143:"6425fd1995198b77",42178:"b1fd5099fd7cf4e3",42182:"8ead387063bf12be",42194:"f543576e9e66c0a9",42239:"baafeb85f627cc49",42256:"4c2ca3624fc49b2a",42279:"e3cb77559e926005",42282:"e8e9a4a435f95d2d",42302:"1c22b606305a1810",42325:"083280b706d0e173",42330:"82e44881bb1a49d2",42337:"aa33c892566588e8",42371:"c6d67c95b7a79057",42388:"f83aeb65bff411ef",42402:"61790ddb907c7de8",42411:"d07f8a167939e330",42461:"960e1f434be1bf64",42469:"b4be35d1a8500d62",42477:"5436073e3158cda7",42493:"b863df3ed552a9f0",42495:"d7d1c15d78d9e17a",42549:"5870ddb55539ccc6",42558:"cdaa92cac85518e9",42575:"a8b9c8fa09784a0d",42595:"1d9f0a08e83a3037",42636:"2534e18d5aa156da",42699:"e5228d14163660c1",42705:"406c26ab7145b6b7",42742:"3b1ba1c30f41bf0a",42754:"ae786c4039600041",42768:"de24a9505ef7115b",42812:"c750cb80aa4dc3a2",42842:"373c7e8bfc13cbf0",42849:"81b0d78cea23080d",42869:"70c352861ac20a79",42893:"f5356b4d20d8a5d1",42917:"632ca29cd6c06f33",42919:"9a28c49869c780e2",42920:"b24026f89bc6d48b",42931:"f538fd257ee05765",42941:"210b359c867c2fa0",42944:"ce9403fd940d224f",42961:"7fc9ff7c436102e3",42985:"5f4743989de85985",43054:"d9dc5e4ffec81b93",43130:"c1c2b0708b331271",43135:"b9cc7b79d9d4a065",43158:"e9b361ab549de80b",43164:"d9784ed730516593",43209:"fc13e6e3371c21df",43212:"a47a0fe95a2ce2f6",43214:"1a2d21ad3639579a",43223:"64a716e01658e1ca",43298:"2cb0cad437064cc5",43338:"bf22995936f887a4",43342:"aa5981e78e26fc09",43347:"c46f6258b2e5c0f6",43364:"442982ae127ae862",43436:"5e9b927f8e99f66b",43458:"b5fc6d31a8a69ba0",43469:"f5db65cfb8530a53",43493:"e5e0b4f1f7cbe021",43505:"e0586452dfc75dff",43532:"08c4cbc394f50b26",43535:"28a88efe20b337a5",43577:"c0f2854f4f9616a7",43579:"23b0281176768d9a",43583:"1e0fbdafcf029cb7",43589:"3aa39d423e2a5b5a",43597:"7e0717de50ca572b",43607:"10b8f8e7ccc631ee",43642:"08dd641d10f161b6",43653:"134cf5b09674c61e",43665:"b884f54f4e257a44",43695:"b93c33d58298de93",43743:"d89a1435c0e7c1f1",43750:"1836dadd2e7d33e9",43780:"709052f3a15b6faf",43795:"5ea60eb9b6077e26",43806:"57d074f6d91f68f2",43890:"cbba62688b2961ba",43927:"6fb78545940dc920",43950:"a6b70930bfcefb38",43970:"46cf4b883ef2613a",43983:"e3d0755c901b19ea",43990:"5b75f9de87bea019",44013:"bfd6c3743080c32b",44047:"cf930691d6455ed7",44126:"2dd98cef5d8fe32d",44129:"cb57686f1d821361",44145:"6757b4abf75391f8",44162:"ba90ccc8edfda623",44178:"1faef3ef6b5c4f11",44208:"04ca024f7015498d",44240:"5aff45dfb8cdb4f3",44264:"7f7d703b54b0c7b7",44283:"88da9fbaeb33927c",44284:"673cf57da3393cc9",44292:"9744462b71edf17a",44334:"da0174f794683f5e",44346:"05413e8ab8d41cec",44357:"56090916617cf1f9",44361:"8eca7a6e05f91790",44386:"ffb30c4552083d92",44413:"263e2b496877a7f0",44462:"8f04121e8daa5c51",44465:"7dca32bfad240142",44470:"3c704e42a7a0083c",44476:"c1df919c8ae9f849",44480:"2bc1ac55ea27eb0d",44481:"705a7b7d29d64c32",44551:"0d9d8d47c0cb6f9f",44565:"3eda4279ffa6fafb",44570:"b790879da9f95c4b",44573:"a026f41525ecc33e",44584:"e31b70011e44eb37",44585:"1f58d249743156d8",44586:"e6d3801c1c56313d",44596:"0233115757e7f3fb",44634:"f3728afa1f33b427",44667:"c367fffa29fe8b13",44669:"e7a01d900571b735",44680:"6501fa02aff623e2",44690:"53df3962faa53305",44696:"ebd1a9db956df095",44699:"9966eedc7a5ba080",44706:"02f29e0b4f04ad57",44727:"8eb86fe93a3554d4",44731:"83c4d0e586c45621",44741:"041717d7ec6894ff",44746:"f0dc1097ae2ee50c",44775:"bcea922ad8c30256",44778:"8a3a47d42affcd47",44781:"f8091d8860dfd039",44871:"2c5ab146e3f3f6f1",44888:"713d6169c884bbed",44942:"0976f40db919e55e",44949:"cc6b26ab313d6946",44975:"97b63a1f0f92b175",44999:"1c6c6dc986bfea5a",45005:"80bc58fad063b03e",45020:"3cb62ecd4476946f",45024:"a64de8f180f7840b",45029:"e9ca053b810de3ee",45084:"af6fd32562d414bb",45129:"c603c3a626120e70",45130:"6413e11a4d1fbd5f",45138:"d7e9c8dc2552a85e",45153:"095a372ea6ae35dc",45157:"b54f9cb1f96aa707",45170:"b628608c18bb522b",45178:"bb4f67e04cc278f9",45196:"bf7872725dec8e68",45241:"69dd89c0b208e6e6",45250:"d06e14c516ccea98",45270:"edb3ae8d10c3d90f",45285:"25a87c52b567304a",45286:"08922d41dcd548e4",45303:"48c445125bd31fe4",45321:"ff6c8acbd089651f",45328:"11700ee151e33719",45362:"8daf8f854a9bb193",45411:"c53dce14ea847ce1",45419:"b7a133268a376a78",45424:"927d8ac1f9712452",45470:"c504df7d4c28448b",45500:"8b3350ed8c64dab5",45560:"5fca706d240b8fd8",45620:"ca1c32e9e33f265b",45626:"afeed4ee4e1cbbb3",45665:"7d9bf5118b4a80e3",45702:"2db06e72578db394",45730:"48ca82dd5aa59c25",45742:"b6664aeffb637ee6",45746:"35809a821e1d333b",45784:"322b6066a056ef8a",45801:"a00a7f6a1bc19ae8",45804:"688995e0c545cee0",45805:"4f60e6b8884f0832",45816:"9249ae8b8965cc9d",45871:"84964e8d8cb318af",45877:"32b7b4c1a89269fe",45882:"10a238557a6b70eb",45885:"ac463635f5911657",45898:"351f8965ce7dfe85",45906:"de0220d6dcc1e1fe",45915:"fabd17140cc9fe28",45924:"bc0a4ab01f8b4c68",45930:"67c1a3049c8bf608",45933:"3b455cc1ebe5218a",45965:"dd9e94a488cf3015",45999:"9249f376b4aaa045",46031:"ddc9a6fb6c161bec",46067:"901610e02742ce75",46082:"8ae975b1bc00e887",46089:"564b9e1da1b57468",46118:"94a1cb42165ba798",46119:"d230660d39e6a78f",46149:"a3a42e049ca7025c",46163:"e580509f10f9e1da",46169:"eed9940c3592e0ba",46261:"14a80e84c2840d7c",46263:"301ebc63132db935",46266:"3e7955485aa7eff5",46274:"10abd26cc5d9aad8",46310:"9fda5fe0fdf8f78d",46342:"fca5587b2f99a253",46397:"8460c9f519fbe83f",46402:"6d3437ab142854a2",46433:"9b5f1647c5f72ff2",46436:"07c6e46a0424083c",46453:"74e81220292554ea",46462:"11b95ed905306b8a",46477:"7bbbea3afe312559",46515:"d2155c9c6f47043e",46532:"64ab5cf132821da9",46534:"41bbfaa883e4e410",46563:"9ef22f7390a4f011",46581:"5b38c84f7119c0bf",46584:"adae94ba19aa3450",46631:"69caccab1b33ef3a",46639:"5aff7c728099c46c",46657:"bf4f4135f005bcb1",46697:"9bec0237c3fd0761",46712:"2369fcf681ccda9a",46713:"f787d768fffe8f5d",46730:"d0a96e6c3b0421ad",46736:"2655bdf2b9947f9b",46739:"9d34def2e3ecbbb4",46782:"bddb29489ca014f1",46789:"e3d7c1786e4d674e",46804:"4aeb6c4aa521e5d1",46823:"e335d2b851f13353",46838:"ec7a0d2acbadf833",46848:"df371fa4084f5cad",46873:"0d46773f3bed8ef4",46916:"e1abe82c821666f5",46918:"0a1dd43c4300a271",46926:"941134c3a2927297",46943:"196d133a09047636",46949:"953cfb3c0315365f",46978:"20b586bf4964ec0b",46979:"c627eda187f786be",46981:"7b8b549e5f8117be",47038:"7ced5df81770af35",47049:"09e6e4f9983997ae",47081:"4dfce5068a8f573b",47112:"607416079a1ca44e",47113:"55b3863a729a93a8",47140:"24daafdec3a64573",47162:"7f692641371c2872",47222:"d97d41260da06d40",47280:"8da7e337f1ffcc5c",47282:"27d5128f73db0579",47296:"202d1c615849cf8b",47331:"23d3e0f016069ba8",47333:"8d83fc8e260e3de8",47339:"e2f30b352fa63c21",47363:"7559d6721b65da4f",47384:"10c921eef4eb44ad",47400:"6bf20569ebc56718",47423:"8364919dc689a3ec",47459:"d12545a7f5a576cc",47461:"5c4eafcdc8d48dc6",47468:"5c4114aba392bbed",47511:"7053817412473487",47540:"9ed3bc0d7f08845d",47572:"222d40c4eb6760f5",47573:"f5568c0eadd1fb51",47579:"d2ccbb237cff2f85",47632:"72a1273c3bd5d843",47639:"900472ee17ba7d67",47663:"c3e01d3d910de7f9",47757:"054c0e8fa84c012c",47761:"5b6beff56f964970",47794:"2f95a3ffb43b5139",47806:"1de024731fb69715",47812:"4742f71bf926894b",47834:"1e96806659b7c170",47838:"c251c38b9a32eab9",47844:"641e4ba1129b1368",47861:"178719d113c56569",47869:"ca7946c739d586b7",47872:"8d278276057dec3f",47924:"1a4436959496b12f",47933:"10f9d951edb970e7",47936:"fdb561d248dedfc0",47953:"55904715f392c420",48003:"c5e0165ac9d5a2b3",48025:"842f01ecc6078149",48032:"302a53f329efdca1",48098:"b01fefbc69da88a8",48113:"43ce64e6ac99961e",48117:"7257c8c3b435c7e6",48127:"03eac89f355c6027",48129:"878869067cb2ab20",48140:"8164173681d5ece8",48147:"636a5bc6656b501d",48156:"78a28b5a89d718cc",48170:"b1351fb7e6232bd3",48177:"1eda1fa201a8e77c",48195:"d9e3030a1f7d8bc8",48219:"fcec0325e00878f7",48226:"c14951278265cc5a",48283:"9030acf032c2d95d",48307:"d75b500c8c25b416",48339:"28ce75bb261dac6d",48370:"c92a1364c283df7e",48418:"34f260184777f48f",48421:"25876025a0cc9ebb",48447:"be5765c85607ce4e",48451:"dc571454937706d9",48506:"61fe200c0b98ba58",48522:"c095678325d2ecca",48550:"74c9f8c5659b2b4c",48557:"543821b7fdde0bf7",48588:"864d1164071f0f59",48606:"443e3cc2dc2efbc7",48623:"a2da578dfafabd4b",48627:"0059a3ab532a01e4",48678:"3e65e839c484c9fd",48683:"8e1d50c3d61acc16",48687:"fa3c17b54b21210c",48693:"b5a51a4e48fa324a",48715:"356b1841fac46ef2",48735:"6aa30a20f01992f1",48736:"220418853672bc57",48753:"3d21e5aabc7b7f6a",48807:"33121d1dc4809359",48839:"81b14d26153ffdd4",48840:"07d08871ed9dbf59",48853:"f90868f7355e0497",48892:"60b74b90f1e3278c",48904:"3eb462ba1bed0b24",48906:"ffde8fd6e34f02fc",48923:"862721b400704d39",48937:"5d1512ff6c781d51",48943:"eb6695aae1a31e50",49051:"17c481ec1714d134",49073:"b00e4c3debd9ff1f",49087:"5627bcddd4bb6c58",49095:"5b377b3adcdea6cf",49120:"cd48ba2f6635920a",49209:"36f06e5414af7e7d",49241:"1f5b3ad8879b14b8",49333:"a2210c6818ed9892",49346:"ea9adeff9c025de6",49378:"e4bcfc281b94ce85",49389:"efdce4c89daf75b5",49394:"6a9cd4c8283f9649",49429:"dfde76a1ba9c152d",49448:"d6b6748741dbde68",49567:"6833bea51eca9c2d",49576:"9fa9614852d26655",49589:"5d785832fe651b96",49590:"cc42d69c64e61f21",49619:"c5be9de5bde521bd",49626:"eb817096d6f15520",49663:"1bc4235c2a2e62ab",49672:"4fc5693c559dc246",49721:"3b9114c8f4532437",49736:"d39713fcfa6da60d",49742:"94b2094c5eb1ee0b",49744:"877f626dd803c6bd",49752:"84d293f2a54abaf1",49761:"ebf631598bab5917",49782:"2a88ad75fcefa024",49784:"e00bd0906c6c86e5",49805:"9e99a520cb9672b4",49808:"270f722cc5a148f3",49810:"7be135b29f2e92e3",49863:"20e5df55b5b30562",49880:"8c5c2a8082b92ba5",49902:"24603db577d286f2",49947:"94172081fc9859f0",49974:"64e4253ce2cb37ec",50013:"57d4e42438759e30",50025:"f8c930aa1e24f235",50063:"03262a649f371b09",50064:"be3ba0fa200baa4b",50067:"5f90ae52dffe7dfa",50084:"1d8a70e876afb103",50103:"de1d73fef4ad5610",50104:"9e10525cb7562a6e",50138:"ae374cfcd7f11b75",50142:"212ecda52b35bb01",50153:"e199dde9da40c226",50157:"f3240c2fdf818b91",50171:"8771cc12a78ded65",50175:"91d84611b8fc3eb7",50206:"61792191e3fe0390",50215:"ce7eb215ec9aa850",50218:"ea496e0407116020",50238:"2bc5061fa705e743",50241:"d3f5c01be863cca7",50284:"fbb7e971ec246c5c",50293:"69b51f7733f365ac",50295:"7dbdfc2d86424fd9",50352:"27956467e4d59ba5",50362:"c0becfd7ae5460c2",50366:"ddf5b94b0ea3d73c",50391:"d07f8bf0deff94dc",50399:"9c5ef52469949e9d",50439:"72b6d0603c8806f4",50468:"6aed0686a2b70397",50480:"8d2b705c54917282",50547:"f616050e5d8167c6",50611:"c9aa46da8a0226ff",50615:"7f31bc8bb032d593",50633:"cf1564c002312b84",50636:"d96b351f67f610d8",50718:"62314fbf2743ffd3",50731:"6c2c7a3d871d4726",50743:"7c3e47516dcad9e5",50747:"69eefd71ce2152ff",50756:"04bfce8e2a49830f",50770:"2f6c0ae47c56894b",50771:"b339b9a91c3af0e8",50789:"83afe73220ee774f",50801:"eecaf7344cdc2910",50839:"85260005f442c67a",50840:"0a8b9acfcfcb14f7",50890:"4b411361e5acd54f",50899:"c169d32f36dd74f7",50906:"a6d211d5908e54a1",50912:"6cebddfd38114850",50926:"33f777e6bbd1e929",50936:"05b3362db5772bf5",50946:"c03d54d9c8b1ae1e",50961:"27dc89f6406aae80",50970:"f0bd5fe302f92a73",50992:"3142653f5bf38b6f",51011:"8e4f2f883b17802c",51052:"a79bcd64cb75d86e",51060:"fe2bde60992cc642",51069:"ae5dd96f753b2445",51070:"ef1fc330ba38a772",51072:"2ae469581a7a766a",51074:"5f4b413d2f5de334",51080:"213a59bfd8fe5942",51083:"c27dbfc58aa8971a",51102:"ec86f913409d1872",51106:"a6a6018b578a831f",51143:"cf21334185ca7fb1",51150:"98fff61d0dcea47e",51181:"3900e1d38fbb14f1",51246:"7f4922dc01bb097a",51254:"16472025a6753887",51260:"e6f2d4cead0c12c8",51292:"33337a8f8067ad96",51295:"04a7b07a0f4a3672",51303:"68cb94dfd6c175fd",51305:"ded6a8845c6acfec",51309:"70533e1a8bdd202d",51312:"d245a06e00157e84",51317:"3de6a7470b4ce8e8",51359:"8851f38d3adef291",51397:"115b3194f8163e18",51403:"a5218c33fc1fddd8",51404:"bf236e23e2a102bb",51425:"ecca34fa0c31db24",51452:"e0fedf5542447a06",51469:"71e8e0a023b9a0a4",51494:"8add05cea2b2e376",51507:"649cf1d816f54bfc",51534:"33b9c876a8266e98",51539:"56c6f99edfaa6709",51554:"3909d1126d69ff1c",51566:"91c6b459215a335d",51570:"421f2b6d7444d723",51582:"dc951c822cf295a8",51594:"75d28de352d13ca5",51654:"85c5c129d92db2bb",51661:"a69d126fa0a58426",51667:"e6c357f1cfcbddd5",51685:"72fd1ab99965ab80",51704:"900c9478a8c11b1e",51710:"fb0534ed64b5d05f",51729:"7281e40576433784",51744:"b71ed0581938c0cd",51748:"24d481fab6e4c81c",51778:"73d83f3f06b2882c",51789:"39f61270602707a4",51792:"61e794d65a0a4ab5",51796:"81158d404c10f840",51803:"1dd2e483338598af",51822:"febf9d45dbd44254",51868:"bb5f360c593ae749",51909:"2917fd7aabf93cd0",51914:"54368ee19ff50135",51921:"431554b922de9aeb",51949:"5129da7717a9472d",51951:"d6de45a6ba72a300",51959:"4dc06f278e25c782",52102:"65225e3c68c645b2",52107:"716458890ed60443",52144:"5d622188dfd96f14",52157:"3a55b8998495e63a",52177:"1732a9cb9b82cd90",52241:"a89e70ae545ed059",52249:"457df44e354fca7d",52254:"8c569874528b38ca",52281:"14960c9d5ec38b77",52287:"d3a02a881d5cad02",52318:"ad7a389e32d22047",52324:"f11145c2354a6df0",52344:"1946f680964ffe0a",52354:"28cdc5b11952fca5",52425:"4d5dd27011d6b38a",52433:"46771d7ff22a9656",52443:"cc8fff7d3e24f66e",52534:"f391bee0cb236c51",52567:"21b5c35fb25b5db6",52574:"5448e5e1c10d26f6",52579:"9fb478dc7215fd28",52596:"7ad67c0df6a0b53b",52648:"143f263b7b89ec8f",52683:"5ea6f50645ef86e3",52684:"4e9e7d61fc5bdbed",52708:"b7095676fa7d9524",52713:"1d06043ce5a0b426",52761:"6684baee5a8ce434",52763:"4fc09e3b8411c1d3",52781:"ed5e58e8d003ed55",52793:"6b2f24371923fcd5",52797:"5b5151793770bd68",52820:"01780e5c36ab0900",52849:"ff8b13e633518995",52857:"a2293617c6453fa9",52866:"bb7172017f3451dc",52876:"a18e2b612ce92326",52933:"3ce908f6e36156ef",52943:"d04d414ef5c30ebe",52944:"e9f8e61530e030b2",52995:"96537bf5544d62d6",53029:"a7d47bd90a807d99",53046:"7386e62863de5b41",53069:"a46115924cb78e4a",53075:"96113238d868fb73",53077:"1fbd680adfd66cbb",53084:"3ccf7e6235457d28",53119:"75c496fdbe4e0718",53120:"14d38cdea164b662",53154:"86985bd1145f666c",53188:"06809ffb1ca7bb8f",53196:"8f042f0b08ad2a8f",53198:"75909babb3d970bf",53228:"8d16ecf70860b1f6",53236:"cc5d8273faeb3436",53247:"3a5c5ddd2f438ed7",53267:"749dee536cc382f4",53277:"1368e0cafff3a04e",53303:"07184f879a19f08e",53326:"2b5c96ad57851906",53356:"c352c28a9cd40f0e",53361:"88bb40e33ea99415",53386:"374c83bcb88b9c9c",53393:"b4cbc9548a7c5a9d",53460:"fa452a054c46ae94",53484:"1134225d1a313657",53543:"0344839e030633f3",53578:"1c42a3a62cd5fc0c",53592:"b02f7331d785aaab",53598:"c9c8f9e4bd7258ff",53613:"3c1e52b9d0240384",53615:"3d819d9661d862a5",53636:"ebcc5ff2f3ad6d3c",53637:"0371e05a6daeef00",53681:"b2d288232f0d664b",53706:"86a56e1ebd84bf6d",53715:"2918a72acd812bb5",53802:"29f9540753d1f626",53829:"8ce640d1f5775ac6",53857:"3d4229e1a5f349f7",53871:"57071478fbf996c5",53909:"43289c7b5681ebc1",53971:"a60342117aeb8c16",53993:"b0a4c14bb9f92fcc",54009:"bb8f88fd48b6fb0d",54014:"52476e34f8deb6c1",54018:"01ca9a73315f02b0",54022:"11808feed5e2e3a1",54039:"55c85a34dbf9c8a4",54067:"b462cac28e715b85",54068:"0699f273ad4b7e11",54069:"ef51d96cdb313ea6",54075:"e81548115176c6d1",54122:"0463f8ad06d2f9a5",54125:"202bc87a551807bb",54134:"bdeb7a566eb9cdd2",54165:"d0a25651419deec9",54166:"a09fafb052883409",54167:"f19ad124fed85cd3",54177:"23b90bf287d0e643",54180:"43ec3b0dd6ca7c98",54198:"a7e45a664101d817",54212:"dc0ec5fad02b433d",54223:"61e5c99070958b59",54226:"6b2a98a98036e6b5",54270:"e80b43084bc35a7d",54281:"6f715648da4f5d15",54283:"55e121658a6f4f2c",54309:"ae86f73cdf637fef",54314:"77f773e1e4f92218",54347:"bffcb0aa77d7ca23",54373:"6fde433ff383c7d9",54423:"24a1d25a407767d5",54447:"e188a8af18e3d556",54457:"e036374c5502e68a",54489:"32098f3753ef9e4f",54509:"6a2cee58249ebb18",54515:"39c47c52fc6f9fe1",54541:"91a64bd200d74e3a",54548:"65973a7097075a01",54556:"06d91afb5e188c88",54567:"50d588013e7327af",54569:"a5f708854d19df7d",54572:"b95f05f92b08c472",54573:"e255fd844f06bb6f",54578:"f6d80882097c7cc9",54594:"0c3da6e0e36b99bd",54603:"c61acf7493df873e",54668:"5bf4a8ca4a73bd4a",54684:"1c25d5b292f33ba7",54692:"c521b59c19c1e042",54722:"198053d344853693",54724:"be82c8bf81f8f2ba",54730:"75eedb462bb464f6",54734:"2c84f61111663864",54739:"6109a1ea2da1b1b1",54761:"0168ee1801d5e201",54788:"9a0c6dfb786db2a7",54835:"6c048c374269ee29",54866:"5c871475e737194c",54936:"22e7778699de0b51",54937:"d6a601ce0b3bf0c0",54948:"1c5f37130bd5623a",54964:"203f7930e7961653",54980:"9166f9e1f34b1ab7",55028:"658bce87d0b6e3ec",55033:"7ec998f0c1892101",55039:"f90eac765424cde2",55046:"6de1f491eb8e8fd5",55091:"704e56856f9ca418",55143:"d5016972ddda75ab",55151:"07f8d7d3ffb81181",55192:"bf2b871649948bdd",55200:"f9e34b10de1009c3",55204:"dc197e9a0cd368a9",55206:"6a241c9731d5a240",55221:"9ceb0331f765f3f7",55228:"2ebee91710458b78",55238:"89033792b2012c1f",55264:"800240f373a5bc5d",55279:"6906a17198d6ba34",55306:"d788c09832aade53",55308:"cea6325b89abb7ce",55320:"e04cb91929cf6741",55340:"4ed9b9450507caa7",55374:"f54372a3e527d14f",55393:"6d417f3cccdb6d65",55402:"5dad14ee36a7a5e5",55439:"29bd6ba53f789676",55503:"cb2d89402a770ed7",55549:"0e8d2ab86afade3a",55550:"30c7eb4a205b5ac8",55553:"d2366cb6ca4d494b",55555:"51a1713d86d50e5f",55575:"97987c3221e53838",55579:"0bf6dc809b2a2d16",55625:"8e233736e0b79caf",55627:"a767351e013dd936",55669:"a0f92850805dccc2",55678:"74a446ae4f6d8b55",55777:"2d3900181ea7bf92",55867:"e1d288b27023cda2",55875:"28b4eae403dbb81d",55919:"cd8521742a17ec88",55936:"074f38e29f1ca4f5",55958:"a01ff1dadadbec87",55965:"7dfdb4a9b15c8d1a",55989:"baf278270484612a",55999:"79180f3ea092dd5a",56010:"6d98eac3110826f9",56023:"a908698e642c12c1",56046:"acc78004dcc454cf",56081:"d1e1077b3a98ad7d",56092:"97e24f09b7acdc37",56097:"9ec4fba6922ba0bf",56124:"e6c6c5f716598014",56130:"6d230ac46b7685a2",56149:"510738e1af65df69",56166:"860764858927b44a",56186:"293d27fae7e95332",56193:"ce7d9466e10fe59b",56204:"80b6d5288295cd58",56210:"f6a160eefb699518",56244:"4d18b5eea48dcde8",56255:"c7d14f58140b84d4",56272:"32f1e48669e0d90f",56275:"9c5842b116bd17a7",56300:"f70ce7668b343c0e",56312:"229b9c4ccdaf8fe6",56330:"8ddec27df814fb74",56335:"90c721d7a3981997",56343:"be2c82dd96561d5f",56354:"0fa2189a279a3789",56357:"c53e4844401c395f",56369:"79594c92759399b2",56387:"8a9aa3e1df230a7f",56391:"fe096cd147eefd11",56425:"749367868fde1e4b",56448:"29c06e6967c90190",56477:"433f6ef2b0d02a4f",56481:"3dd9b0b5f652d2f4",56532:"765ad55f9255a696",56564:"11ea02c1df55338e",56615:"b5356da6490674e3",56633:"b019c7669829df47",56641:"37e79dc051129c9b",56652:"96d741f827448a1f",56654:"c7c85378b1b2d453",56679:"129c31aad31c6daf",56693:"8520a11571bec19a",56712:"16dc68820fa2cc58",56722:"2c72b43c70740794",56737:"9502d2e4b65ee592",56738:"cc79871e6a590d5e",56774:"d13040d7a359219a",56795:"1a6517c4bd68494c",56809:"86930179d0acfd53",56828:"384e6d6f92c39bf3",56845:"7bfc28706a583ea7",56864:"5113cde11bff5bba",56867:"c808b8ff541bede6",56904:"b5ae370469581c7d",56923:"445c70841a66cfb7",56947:"42aa63b0bb177dcd",56970:"7db7cc1fa275fa55",56992:"d8290625abcbb31a",57002:"5478e663b1e8835a",57020:"32979b506e604c43",57048:"cb9c47857d0b54b7",57052:"f9b2eebba6871668",57069:"972e0ae939d7103f",57088:"1ae99a85507f5022",57156:"e9d8245327e60e15",57164:"2c9efe7f7ffbf513",57177:"d2b2a2aa334f2054",57184:"5463d05c76bafbf0",57239:"c7cd4dd8b0120717",57245:"3b2821ff43865347",57264:"cc178f38252d9549",57298:"bde52e8365a5ef02",57302:"ba442e935f1da8f7",57312:"bcb4fe6118b588b2",57330:"297d8b1e9caaf5b4",57368:"74f8c5d0293da974",57375:"a38bbe8ce29ed9fc",57405:"02003ae3baf49019",57426:"0af3b79e21174a1b",57441:"a9809a3c82a4a4eb",57449:"975530411365c31a",57495:"268a1e35f9e3ce32",57497:"4c94685d23a59a7f",57510:"6777c0f942ae7f81",57526:"99b0ff6f3fd988a2",57545:"fb295e00451cdde9",57549:"4be1cab7d7b09700",57560:"e50340919309619b",57561:"33656706e80f8523",57610:"ae242c1ab46a96f6",57621:"c0cda7f771d58f46",57625:"1cb58a4c1e993516",57628:"3ded1d07452a66c3",57699:"3a380c21dc64e01a",57711:"751abce30d54cb15",57721:"43c5d4e04595e1e8",57746:"9632eb2825327fe2",57760:"bf533608c4e15591",57787:"53f3dbc385b4e058",57796:"3fff6b9e55cbf84c",57824:"ebf52375525deb81",57896:"a7937aba27a0fad7",57900:"96260902a3892b57",57912:"ec82f2cb9851ec2e",57919:"f52efbb3e588e5fe",57944:"0ed2f765f206e2a9",57948:"0c11f851c80c8085",57960:"42847f5c30213f9e",57964:"c8adb3bb7f317871",57969:"4e941219b4bd7ea3",57990:"600a274c429edbe5",57998:"2703cb4ceb9021ef",58004:"e0b3a8b5fe3b7ac7",58016:"37d076f1331fa085",58035:"0bfe0800beb6bf17",58076:"d3d853cfe2a3a917",58137:"6f200b5b5e3e997f",58142:"ee6dd0ffde374572",58146:"66ffaaa80b1401b4",58163:"80cdebb96bd4cfca",58188:"5e39e370d9a3bcbf",58213:"62705d949091c748",58245:"3ab3d2d267f4defe",58257:"67dc8bcebc6d6d10",58259:"ec25679486c84f99",58267:"403ff90ee9288459",58276:"dc366f065a4c1654",58278:"c8cb1fa5ad9f2953",58357:"2609b5c55e2948cc",58359:"9f502e2cd2305a64",58377:"016d88d94bb277da",58392:"20d75f7f56ad9b23",58395:"02d19120ad7d4c02",58410:"3ed07f4d3133b93d",58444:"98ee204ce791f6a0",58466:"224582a6004b97de",58485:"603ecb0d9dd0417b",58486:"1975fff55d3a9c01",58512:"ee243d7a5ca9bb4c",58549:"6bef280e52358759",58557:"900e3de6445f7851",58571:"61bf8ed6750de8f2",58595:"8f1263929403f1e3",58622:"a10ccdeece48e8bd",58636:"7a2436af4456aedd",58646:"13c0bfa99b5e0f52",58670:"9ab1630d58b7ca46",58673:"8faf48387960d523",58686:"d0135702e5698b5b",58712:"74468d1142322388",58758:"4897c1fa6f9a3c87",58766:"03228431c0f2c38f",58800:"c69287ab3ddf4ee5",58814:"16e448a75c651fee",58820:"ee83fcbab9a87da9",58877:"2b24b4a77b79e24e",58891:"37d6985121f2b99f",59001:"5d5fd95f3a13fd42",59010:"c98c39b8d1a6bc1b",59019:"cf9174770efa1482",59048:"bd35433f8ff8758e",59067:"244b4e6ae62bebf2",59082:"30bc540feca94fd3",59084:"20a744a4a8691074",59096:"2a5ffabc9e90d3ba",59098:"8a502f1c36485ad2",59139:"66544550eb13392a",59151:"e6ee9d7942ff512a",59166:"841022db301f9a2a",59206:"e94cd2d735a0ec42",59225:"27197befa9a68900",59238:"247dc549e31886dd",59250:"19d6689d2b12d208",59258:"fee937bd27b6a334",59266:"d36c1c79801ac8aa",59286:"2f59cccb520a88ba",59288:"7c259be36db9f384",59323:"da3d4696efd4c7a5",59360:"35081571af47bd29",59362:"c2792b61370009e7",59369:"55b90ea531891acc",59401:"cbdc64c7c1757467",59407:"f65557761b9aaabd",59465:"491667b7202b5426",59508:"8058379bc98fb2b0",59514:"c50ebfa454112409",59518:"704757c8c9a51c10",59529:"35b682a6a7a92def",59541:"8443af5d55d899b3",59556:"28a46709fbb94194",59571:"21e5bd4959aeb041",59616:"4689fa9127e4c7ce",59663:"f4fa728192e785ce",59667:"e49c276c293f1891",59746:"8b90d54bb7a5a689",59752:"722691dabbe87c73",59753:"71d1a2a77bb4da72",59764:"789cbe3e5ec095a7",59797:"401babc2ef5f84c1",59818:"4ec3726c58df18e0",59831:"4570156fb8bfe10e",59860:"9f6e3c9eaffbee0d",59883:"7e3d0b7c198c4d4c",59885:"3140c58e1c236719",59923:"dd38e49db0106620",59930:"b99e325296dd8217",59959:"53fc974f151bb9ec",59982:"b3db67b5052fc3d3",59999:"092615015d5ea141",60005:"464458fefbebf763",60041:"dd50b2b87a38eea2",60060:"eefeb36fed5917d7",60088:"c41aa5bb3b8ac81a",60100:"a07d79ec93a60575",60111:"30be83872a97fa38",60115:"9414019b2f077b8c",60123:"5aa50c898d19089f",60148:"be32d6d00cabfbc1",60214:"17472a3931d6862a",60273:"8f684db070e3922b",60295:"4810e6d279e10016",60319:"18d08b1dd9152b43",60323:"baf305b74f8d6cd8",60325:"e515d62d9d7aa3f2",60332:"7443efa066576bdf",60347:"b319e2828c021ac2",60382:"14b35a6260f4902e",60390:"3ac626ed8c2fa362",60430:"025b7b2c81927464",60479:"138f60cb149ace57",60494:"47bd07f94512a040",60500:"bff48f0120dd6d44",60506:"ec542b18f6da29af",60509:"62e0012ab33d1969",60532:"a731d81a78886493",60567:"29ad493ff44370cc",60568:"bf5cebff993a5d42",60639:"3e77e8cd0eec40eb",60667:"6ec6431949b195a6",60684:"9b4ed44874e468f0",60695:"3f69eb894df5b056",60698:"e67c67ca8f16f652",60713:"f0c327b60e8935ff",60739:"2a7faabd7cf48585",60744:"5be161bf33d066ca",60767:"68fec84ae7a05ed8",60778:"b880e9cf3dcc367f",60785:"eee815c9248990bd",60811:"631ab276b93331a7",60818:"983e2f30a0815744",60848:"d9dfd28ecc1a3d81",60863:"b77638f3e6fc6dea",60941:"a1a43e7245c32d13",60982:"68239111c467ac7c",60987:"c21ce36caba1d8cf",60988:"2ca9a8234c436898",61030:"3089372997fca4d8",61031:"8a7a2751831a3d35",61033:"f9db66b4a3f9f870",61038:"5ea9f150435d4f66",61045:"f5fa1148b6d4e8c8",61051:"0d3126971a8adde3",61065:"8548550ae7888ba5",61074:"7a959c142a638466",61090:"15e7a2a375836d00",61118:"542b7fe3bf07cfda",61130:"7f9fe405027a603d",61145:"09f1dcceef01bd27",61167:"9e8421e1592e3d7e",61176:"ce1e1179061ba04b",61183:"c7c3fc5000420da1",61203:"5b64367f0e4945c3",61204:"1a6cebada38a0eb3",61235:"1a466933beaff0b5",61263:"75b55020ffd76bfb",61286:"b09158e5e7486521",61300:"a83efa89a0a3cd41",61302:"916771452d5a2967",61308:"15139b83d556b976",61320:"7f679e4a492d41ba",61330:"0b58d3c412b5e5a9",61331:"176913c8a324a8c7",61333:"cbc9b3af418a2302",61336:"3e7e3f69b99da7a7",61386:"06d99ef6cf142cb6",61409:"7a0ed675bd895acf",61440:"91f3e0d71d6abc4b",61459:"64d97a4eb7f3f67a",61472:"e1e75289a36c0f6e",61518:"1168aaeef442046c",61537:"b0c182f43c5d4633",61539:"59c4c36226029538",61543:"c9701bada92d6b80",61605:"e6f1662788b56cde",61627:"26c75f8255202bfc",61639:"7a297d1c58dcdfb0",61701:"b1b66688ea5ec420",61702:"1c26a5f2c6d53bd4",61724:"9f34ba5fba3e50d1",61747:"7cb66d3036d6e77b",61768:"57b22252f3e01a6a",61776:"6c218a29e7f00484",61784:"13d92149e4ac1bde",61803:"78c73a0d66ff67ee",61844:"318dd6e6e5d53689",61880:"b18bb9b86b130e1e",61922:"377db55e2818d6f1",62005:"82fd7f1285072381",62027:"78ec1ab72afd0df7",62030:"93920b18205acd2d",62036:"9f46e4c2fd8d9212",62050:"8ac5128915fbc970",62058:"39e6936166ebe057",62066:"fff66110f3e7e279",62108:"cddaf58007246ab8",62115:"82486000635ddd90",62136:"2d9366dba7022f7c",62139:"1f5812b40f762095",62151:"6b8f23217f502ec4",62153:"d149c50966442c6b",62198:"493a29419d8f65f9",62199:"dfee8bfbe52e38ca",62223:"0f6a765c338e0edc",62245:"b954e723c85d2e4d",62293:"df0f74fe3692554e",62294:"acb47e06a68e4dda",62315:"0b42d380574b60f9",62329:"72f529e30d8d9db8",62351:"bc50650d6bc3e14b",62376:"fda1cb44c71a1833",62382:"a89a67f7970267da",62387:"c4b9c80214a6a2b7",62437:"1719358d32b1d5ea",62457:"922d512ce16febb7",62463:"8f6a8812963093fa",62472:"ee50077ebd6c01ab",62475:"c0f796b5e3eb7e9b",62476:"a1d7e3ef0fa766ad",62478:"a4b5534ea9eff102",62514:"9bc43bd2b9eaee5e",62520:"1e8cce75ea27d365",62531:"1096721a2c5517a0",62535:"b7fa6469b9b8febb",62541:"cbb185516328caf2",62556:"1a13d9f357f839b1",62580:"1b2aad4baf9a2aba",62665:"b21378294f673323",62678:"690a139d15df0d78",62713:"b45935a45efc43f0",62716:"53c31fa9e6d531b8",62763:"8b85e0c02a8883d4",62781:"7468eec96f7ab771",62793:"3f05bac7ae3444f8",62795:"d2779d28160c7277",62808:"f5ec75126b5a7e15",62833:"da8ecae7267cacf4",62851:"b13224ea37936cf4",62860:"6f827dec3c647c3e",62889:"f080db392f4f7a36",62929:"8cc7c55f664a977b",62939:"4f587482ec3ba8b3",62985:"75abb2627ed4d2f7",62990:"e3f06014da4c2a27",63007:"a95e98d74031401e",63009:"d0cc328965c882d8",63017:"5fa3b45f843e834b",63027:"c1069b3c1103ad6c",63054:"95e63fcb26ed57e0",63140:"cf2ac931d8dfe76d",63167:"073282c1c1168baf",63184:"3fb897165ccf29bc",63185:"b35f6b10884668b3",63199:"0b22e049a8846c93",63233:"653622ae78349ee5",63235:"48f4b0e3f0891902",63237:"24c4eff86655a922",63311:"f52f304473aa4f5c",63335:"de55955a4ece93c9",63337:"2cd870560be6c488",63364:"a8fd66a916637eab",63366:"2d4bcaf8c6770e43",63402:"0e7579acce6ae3ce",63408:"7ca2855c69c67b2d",63417:"ad7b79a2af868a71",63434:"efe7b548bf2f2923",63473:"179fe3fb17d79833",63481:"17424f105dd3f12a",63502:"bc3820e49f7cc838",63535:"101de464e1f1eb13",63563:"3d225ef5c64cc84d",63616:"8d75bfd4894079ed",63627:"fd8d180a42d1c0d9",63673:"3f3ee70733532b4e",63685:"26221a2342ea1c73",63686:"918c51433fc01edf",63702:"c9bf9861e7f17afe",63732:"1eef220de29f5231",63735:"4700698f78569f9f",63766:"872c08113f86320f",63810:"c081653fdf2af942",63823:"ee15cec5864e2c2b",63825:"8e43ccfeeeccc7ab",63857:"7d4d74288d8253c8",63871:"fbfa96c2f585d51c",63903:"9743a19500e440fe",63907:"71ad238870bac8c4",63936:"50b1e7be16a4eec8",63950:"801a452f2547c72c",63957:"a20d9413e22fe5be",63959:"0efc23c6c8d9ab2d",63966:"5aa8e4fc6075e466",63968:"73b2f9b5d4d197eb",64e3:"e74724a7388a187e",64009:"42a7556230939a67",64010:"72cbeb12dd7e1692",64038:"092be5bbde2b99cf",64055:"e7ae2b4606359d93",64056:"3397ffabf6d9d26e",64068:"807bf54052ea658c",64070:"89467e8675978b7c",64078:"d48065e232828138",64089:"2a697499aa8f654a",64091:"35d91b62018dab96",64100:"d603181785c26896",64108:"b30af776e75b9de7",64110:"fd4cbffb272b6172",64139:"85cbf49ca28d4636",64145:"c8dc63b0ce7f25bb",64146:"280b45fc38c4ea30",64189:"0e37c0b405af549b",64258:"5986ebbf69055ace",64270:"63569f50cad3518b",64274:"7d251766667fc936",64278:"a369458a5a4c6179",64279:"4714f842dab20cc3",64380:"d22d2f663c9cac64",64381:"2489975d44333002",64403:"84c2afb48011943b",64422:"275108f47dfb2d16",64423:"685c938539022633",64466:"61d3840c5e9dec67",64479:"186679ccdcbdeee1",64501:"412ca1deb6d8fcf6",64502:"c182b24c41c0f57e",64511:"9ce69eb95c1ccc4d",64574:"4a41c9f123243b84",64618:"6fd2d64d942c9e24",64620:"920e8c412eb98cae",64623:"1cec99c7cebaf164",64642:"39a44e55d4a6d3f4",64729:"485694c1ad6cd37d",64749:"01451b89a8df05d8",64750:"ea8b14168404486b",64754:"fcd4aa0b3926d944",64779:"92fa83db0881aae2",64816:"e81ef2ab5e66e27a",64857:"42b3108081e92626",64876:"5a729d6a38f6c3c4",64878:"6895a9f7ca8764e9",64880:"3a177711d9f62160",64891:"35fee6bd0203752d",64897:"1c109f93e67cb5de",64944:"5003a4204418990c",64992:"37d71af58f34ac80",65025:"fe60ec47c0779245",65028:"043942dbc3981e10",65041:"f91fc310af09078a",65054:"927eb38b794a2514",65065:"e0da0ac52aab46fe",65110:"a104827b06b578d8",65129:"bf7c682bfe5b50fe",65151:"04d000f39b18fad7",65162:"42262a2433913a11",65164:"b09c8bc3cbd927b0",65238:"e2d7785b922d3c86",65240:"6b5b993c2a373e80",65242:"13f81e8b938ab699",65306:"12cbee1fdfcfc7ba",65365:"76bb26b179a32daf",65378:"3d673017dc7f6fc1",65398:"a8d879be3e11a72c",65414:"1484e5c1a41d09a1",65446:"ac3dbe17f793bea4",65466:"1b03c52676269437",65469:"c83d9b453ba2256b",65471:"42da4d6d360409cb",65477:"8c9e5b74110bfcc5",65486:"2b8a4bedfbd9c620",65492:"d8e4aed3b59e4fa2",65515:"7140890ce8bef77d",65518:"492fc0261cad7e75",65556:"4b8eee9cfe1c692f",65579:"23b38af3fd2d1c81",65599:"b4a779137b463ba5",65630:"a2af0213facc3573",65631:"cfa9ad26f3c3ed12",65641:"051fbce5f4591038",65647:"5cd23a4f9cc0d232",65656:"1cc882e6bc34c6c9",65677:"a87fb64fa4339f7c",65707:"3612b71c8e24f163",65715:"b5bfded42dec4514",65745:"3c81a533183700f1",65748:"625080bd58a5fad9",65758:"87d90455614d7b8b",65785:"fe7c40e8856b997d",65844:"70a118b93fd5e947",65851:"b59864aa5ceecc86",65870:"b5165644540ab17d",65947:"98fcb83b3e2b0275",66073:"522b1b4f91dfa133",66075:"1b9c0059c645a2d8",66129:"d571ac2c93a3c271",66144:"c44460ac4ade48f9",66147:"d389a87066e36c30",66152:"37d02ad0bc9d992a",66167:"64d8559aa5bf36ea",66178:"092e1d6c0c8839e5",66179:"40ecdf09ee4587af",66186:"f3e497ef07cd2d7f",66204:"0ffd29e510860eaa",66235:"354015fd56e5e1f8",66263:"e9840a2067b83d6b",66281:"b48e25a89efc4a23",66326:"b9b86c8446259b6f",66424:"f841754661b812e5",66433:"331f6dec40e7f770",66435:"76ba3282031808d8",66446:"e19b15237258a821",66450:"67de39b835ed3fe9",66467:"9cdf47276f224a91",66475:"708644f15179a5d8",66476:"dc75f845b886dda5",66482:"afa4056f670cd0bc",66493:"09b920dddbf9cd4a",66525:"d544a1abcbe53f82",66584:"393ad3cb017567df",66610:"71505c1afbc288ba",66613:"f8c06dad216a2363",66693:"bbf144beb7bdbf14",66694:"ee1a6a19012becbe",66714:"1c5d5f026d8602d1",66725:"7af4743d05a7bd5c",66726:"b7b9998d9527386e",66736:"2441cb6af9b0142f",66761:"d6121deb8ba23793",66787:"c296eba6e68c2d0d",66793:"fa8c08ad2e1f7a62",66833:"a950b4bd18b3f5b9",66846:"c1c44d26f23df95f",66850:"f2b6f73255d67dc8",66887:"9c51975d9bfb8225",66894:"6b4a907228f29447",66896:"1929129d71c5fab8",66953:"92e907a54521ccb9",66962:"3252425de98216bc",66963:"126a043f9d9cc355",67008:"f4bea5dc5238ec8b",67017:"7429f4c4c748c941",67083:"af7410f2a492da6e",67090:"7a202ad93d6c0087",67099:"5cdd5ca91438a680",67103:"e2de4f641d16b5a8",67131:"67de97b8b72015a8",67142:"9f72942eafc6b18e",67215:"8e9d4176cac18ff2",67228:"cd5c1c6f17ed3840",67261:"b115e620c6c1c723",67288:"e7fe22e5ec7b29aa",67326:"77d80df3f9c3e83a",67403:"cd2b810a0cc77aad",67409:"ff49e8f4b6af3342",67417:"464469bd9c201466",67442:"70d9f5e45f40c915",67450:"2125462c8f576909",67526:"498d8450f0bf0f3f",67569:"41fc5c735e79ce70",67590:"b73a306602306893",67608:"208e0beb49812a7b",67611:"d767dacfe98f338d",67612:"1be1421015bd6be6",67629:"862476707bc69128",67638:"454a45ffe0187dbb",67643:"5e10319d65fc7553",67644:"557d202d50bfb2a7",67650:"714237f5a5961503",67658:"ab8a3dcf6db4650c",67676:"a1eab1f7ac6f0f73",67681:"4a311f94089fcac0",67738:"6f9f2dd8cffc18d8",67742:"a25211f5e10fba54",67767:"6af18c732ef1c6b2",67769:"1f1ab1c742affa16",67785:"ddd068282366ef2f",67847:"2ee723aaafbf9555",67856:"98ffba4b43451e8e",67883:"dcc5c2d5344ef993",67949:"fde319d85f0f7d29",67953:"71c917888c2e5425",67960:"425c6ae7471efc33",67973:"a3353e68076f679b",67975:"7e86748347b860ba",67977:"b350b182329abed5",67989:"fb858ce3f6d37545",67997:"7ea1052a02991e5f",68018:"027755d0879af87e",68036:"9b1ea7fe1d37fb50",68057:"26da0ebb1b2bb7d1",68074:"4bdcf812d57b4d4e",68095:"408386585f4493ad",68123:"c7cb7eb668214bfa",68227:"b52c21dd667e34f1",68286:"450db6442d6aa8bd",68299:"546e7c84bac838b5",68303:"079132a2861b8cbb",68304:"a1b5571969b1e04c",68312:"4cc5d140610de560",68318:"ba8938da4dead612",68341:"9d535ad7b890a5a0",68396:"a8b122624326bdfc",68400:"fced96b69b89a2f8",68413:"6cc7d9d9a2c9ecd0",68446:"686f1d80ffcb7fd1",68452:"aee69157e89961d1",68472:"baf94a1f9a4a1865",68507:"8bc33487e42d047c",68557:"69721fbea1ecc778",68597:"b07bf4274ddc5a7f",68640:"025d394a716ca081",68677:"338c5e1febaba08c",68688:"c7db5b3d47e619c0",68719:"fa7374ed6ecebe23",68722:"ba829abd6f9abc20",68734:"cce4ab0127c71fa6",68740:"af19010de0aac6f2",68748:"9bf7ffff4c25ee02",68771:"63399243ab50177e",68778:"e8ec55cae56a069e",68781:"c72f6324d08533ef",68794:"503fa6392f3b2b4e",68810:"792087e244eafe69",68858:"8f38fcc4d9efa799",68865:"c818d07d74c82641",68880:"4df14dffa72b6b57",68889:"314c9b8d949a11fb",68935:"16fadebae50dfeff",68957:"71408a655e8484a8",69006:"fe7d21edf414acd6",69081:"4c494a17285f922f",69085:"f2600162b7b31b9e",69109:"9215e74dea53076c",69120:"488d7779b5565dcd",69144:"8a1a7640b145c4e1",69177:"db9a23917740da4b",69195:"0b7f4527ddf7a79e",69198:"bf260d60eef4e33d",69338:"e980dd508b47da90",69375:"7ce44e72f31ac35a",69380:"935c9fddca31bd65",69417:"277cb6e304428c43",69458:"241853003885b568",69482:"0f63ca38cacf1497",69525:"663ffab6f8ce44e3",69541:"c2198c3039cfc9aa",69545:"d949774670d208fb",69555:"51020272730afc79",69566:"8b0a5eeaa75f1176",69607:"4fed121b677bcb52",69621:"f9709d668a344cac",69622:"8d7ba97e70915bfb",69652:"073712fdf344c1ce",69658:"70909777e97ac70d",69663:"90aba24bf73209f1",69675:"9269f52abe2346b9",69706:"00193d82f577c874",69752:"f436ee56b9018c01",69790:"c9908339c084d798",69816:"d3cdd2a10245f32c",69827:"1678c207e73c9068",69891:"7eebe03875c2fcd8",69894:"6f8537d0dcc7d5c3",69907:"02637ef7f81914c6",69957:"04969e3e0530389d",69970:"85a6479b53ec3a9a",69971:"2136b796fb6df041",69982:"30912bfb4d7098e1",69983:"1470adbc4044e291",69990:"c31e67304349033e",70041:"5b43af65ca7bb99e",70059:"bf1ad016b6d4348b",70094:"36681a9b1347c540",70103:"84c2fabb6116ff52",70113:"c84fa65dfcd4f6a4",70152:"673dcbadb679fa34",70175:"a3afb65ee359ae42",70181:"409360188728cec5",70182:"f0b469dcb4ea0590",70197:"9ad67cacc7272763",70200:"43f594e89731535b",70225:"fa287177412d6a0f",70245:"e363a425d4858efa",70246:"0e5e740f497f7466",70265:"be59b736687ba375",70266:"0160c57bfe955e8c",70279:"6c90f43ff899e0c8",70293:"fd9d675b81e57714",70326:"788a303e29571efc",70357:"35374f708bee7ceb",70409:"d71a4dd8c79b0262",70410:"74ef37acd1290683",70421:"82ce36645d867525",70450:"9d6ade95e0795cc8",70498:"93b958f5cd0cc919",70500:"f1e5c04eba2c5d8d",70542:"05c38a748e0dc96a",70582:"35bbf44ca1e6d249",70602:"1a20fda2da179509",70676:"27d394c97eb4b972",70706:"5f6e91d2764f1f65",70716:"d7dcc5b252facae6",70723:"65fe6ad7254b1de0",70724:"3cd2ac1858ad7c83",70774:"31a28c22a40d7b11",70796:"666416f5b56866bb",70822:"835280809a797f4b",70845:"c2837ba0a84a8ca4",70849:"e6202bde92ff850e",70872:"cb03098560c6308d",70881:"9ebf60744d2d7fae",70898:"80f88c38ed29d1c0",70902:"56bbbf065455a773",70913:"68e6538a1d55f471",70918:"b4e22636135985b6",70941:"bbd86580d9d081f3",70946:"1059961558d1170d",70950:"71581fde7244e7ad",70971:"9b3a1f494a2ee506",70972:"ddbc146a18b8dd1d",71021:"cf271423b638a153",71023:"e5fadbd0f3ff9405",71040:"a9e5efd34d05d9e1",71045:"3030eaeaf965cd63",71113:"7bf8c3383e227b00",71121:"fd07de9562fdecec",71136:"d24c8c1713503082",71154:"4be7df24ac0227d3",71161:"1e38f11939068f57",71216:"2aa610e178fcbf11",71285:"ce836a6e6c405710",71288:"b55411e1e78f1da2",71326:"2e5d92122107e1b9",71383:"9310c1c69c6831a3",71401:"fa78721df4553255",71409:"5e0ccbacf6431073",71451:"cd7b497286721b07",71482:"4f957c56bd3a3d81",71515:"015e4a74c0dc7434",71592:"b82696fb343525c1",71599:"568cf473238c87e1",71626:"f469b6ee45047617",71627:"fbdd9109cafe5afd",71670:"8a7e1cb044ad6ae6",71678:"a338a61fe82a37f2",71722:"e4d116bdf0dffb18",71726:"6d07e282acb8429d",71734:"efe5fd1be66bbaf9",71761:"f2a5dd6e7f456658",71782:"8c29640e169a3bf7",71805:"906827ec1e301727",71816:"6896c87119680d23",71835:"5a307c8527aa1677",71856:"1f97e68ba4424760",71920:"781e8868ed23860f",71948:"cf32e61dfbf92cad",71980:"8a3a5aa21c5b0896",71993:"b6a79f292fa053f7",72001:"d461fb119897ebb2",72011:"68bffaf176bc326e",72042:"9fdc436a7c441fc1",72055:"91c51ea5af7a3007",72069:"2e52a5b77229a4c6",72136:"f504b12e6b37689b",72222:"67950b3a1f83a37c",72256:"bf2081a9621d134a",72258:"75941d981663e5de",72287:"f83104caec279334",72297:"649d4c36d9a09c1e",72324:"63aed5dc81f5001e",72325:"0b83305f2218ce17",72333:"082279493a96e2c3",72346:"177e805bf80586bf",72371:"0dd7a50f459c60d6",72418:"7910dd436a172feb",72467:"e99d4bd215e3b1c6",72479:"aa47f3ec59fc5f92",72484:"2bd5abe3c6ed9891",72487:"380c441617a042d5",72501:"303120e9ca49ed93",72526:"ef23ae8bf8216aa9",72557:"a13159055c791e7a",72564:"defd39b89302ca4a",72572:"0de81f38eaaaf29c",72578:"35979a8814bb3948",72638:"901ef0e0afbdfce6",72642:"e23535e86802fa25",72660:"2edd9b0a49d7e724",72744:"e08aa76534bac787",72767:"043bcfa4dcb8dbf2",72780:"00ede0bc2ae98a75",72842:"9fc3a7672343691d",72865:"474fa5aa570d128a",72925:"c928f584357e7b22",72932:"8bd8fdc605627214",72936:"c70fbea2184fe94d",72944:"1ebd39374e051ca7",73047:"becac2bb8d6b88ae",73051:"0dedbe8d2f289d2e",73121:"1becf4d4753b2a1a",73136:"13dd051cd7961a11",73142:"4f717b5bdb9f759b",73166:"1e7e27ec51cf0ef8",73170:"a88a93a8932a9bad",73177:"6fbc60979e17b9c1",73198:"d59169abd9fb395b",73206:"bdcc934dac764ec1",73208:"81eb8ef2831fd568",73312:"d92ea38a075cd890",73321:"1ccd2032a3432dcb",73339:"e4723a47f5ae64ba",73343:"1bc181067a924ecf",73349:"f184c1f2d619669a",73404:"5fa2d952d6627b09",73432:"f2573aaaefc2eba9",73442:"1a70ffe4cfbc59ec",73460:"af7f60fe35f4c957",73507:"218e73a456d648a2",73523:"7c68939e4d154a92",73533:"b588bbc243ae0ec4",73540:"e43c3f56c7fe70e6",73649:"62df8391421f31cc",73661:"2dd0677bf002138e",73676:"f20745b1b2e5db7a",73680:"c4be70c7c53ac5d8",73696:"9d54519a8763603c",73698:"9821719e536d1dba",73717:"fb47cccc04014797",73736:"2e6ef0021be060c2",73771:"02b6277e59751e24",73773:"a80ed91743efd415",73792:"e0a0830d27c978d2",73795:"56bddf9e72df46c3",73804:"3fbc7c6d5cba5288",73806:"307988c20a9bfa96",73824:"90689adcbe0b163c",73825:"d97cff42be88318c",73826:"85e319fb5c0fa8aa",73836:"a2a715535fdf7f31",73840:"cf215d59180f0ebb",73851:"5fb99c2c363293d3",73889:"88441e14a5cfa059",73890:"d7d766e13dcb8dcf",73915:"87caf57678ccc196",73956:"10eaa93c6cd15c28",73969:"8367789c98fcee49",73973:"89e36ed44ef68f8d",73985:"ef0f86bd95163323",73998:"1ff34521f93f250a",74006:"66c509a865a8f3e2",74091:"403bdfc53a9d2190",74120:"9ddc9d1c9334baab",74135:"a1bd498050b22a2d",74180:"d4714f57326faf6d",74186:"b2ced6a0b74eb18d",74188:"d7cb3b0dde032d5c",74217:"b430d7308490085c",74224:"b013486830c2e10c",74227:"9680c57013f554ad",74237:"c0c0d019eeec91a8",74242:"48a3c11196c03d05",74249:"fd6544dadc44ad25",74282:"5ee0aba4e092dfa0",74322:"754ff6f124268e02",74361:"fa2e89a368478e5f",74394:"6bbb7ef48109d8f2",74403:"50a5065679b80f71",74424:"40f94924c49b91fe",74444:"ccf656ed7fedf15e",74449:"fb125afbf8aa107d",74471:"971d36bba0f530a5",74504:"595543f58fbaf2f6",74515:"e43596bc470f88b2",74516:"3804c8998205c419",74543:"96808d8331df5761",74574:"401a16efb66882d2",74580:"f773309c26a49100",74590:"cc63b5f1677b486d",74604:"6a86e7ed0a827c75",74632:"619346fefc58d0de",74687:"0e554995cb52587d",74691:"0a35664ba02e2a93",74736:"c6dbd5f6f80b841e",74747:"38dabede751adf01",74750:"24ff16689527103e",74783:"dc5e81d89ded1146",74786:"d4c49832a753fe85",74801:"60439e79f753b424",74821:"26c2805af507fe2c",74833:"ea113d60330ee2fa",74837:"566e0dfd86cb723f",74847:"f9d05a1d86f7a509",74853:"7361881e0a62a574",74863:"f9aa8f9817abb03d",74896:"4c2195e6a3c01932",74906:"a15f1ba31c8a1020",74913:"2c5803566ddaf3c3",74917:"208a4bcd41f61bde",74934:"4465f7b7f336131c",74972:"22c3c12ec5a9cd1b",75039:"6a092c525d3bef1b",75041:"12fc499dd556d650",75086:"e25f29b851ecdb7a",75123:"ad830d3da988504c",75125:"7c4a55104a52029a",75141:"fd26228d33d42351",75145:"bc6e82bcb283a42c",75171:"abc37a23b34e6307",75174:"78fefd28a3817f96",75229:"ec4b9995eb29cc82",75230:"2b72538a2e208264",75238:"bcd770aba6225d04",75287:"1b1c7f017867fab3",75292:"a559c3747613d735",75294:"4f33130682f76c54",75363:"9daa1a5bd365e1c9",75402:"196863f6a7d8c07e",75413:"39740a1c3d72bc57",75447:"68f534fdd85b0d6b",75499:"254f1b55dd02ede7",75504:"bd36775984136546",75519:"96c82c6ce4addb92",75546:"b6b68a36dc9aacf5",75558:"02489777247b4efc",75559:"386638eff6c05191",75610:"dae6c7412ecfa6d0",75613:"bd7973cfed7dfee2",75616:"0a3f7f0536dd58d5",75667:"736e5df5d990ad35",75707:"92c9f43e69d16d11",75758:"6f1ded2b51ebfac0",75810:"018394e2ad0be0ad",75818:"5935c0c791cab2eb",75833:"0749ec294254f518",75863:"95bab0d51af594bb",75873:"0950338bcfdd16cd",75895:"be143a89ca6461a3",75912:"189a537e45326e56",75916:"ee10cf2b3419b692",75925:"0e86f17ff2fd8f56",75931:"8c462cd1a440510f",75934:"0fe52336df2ce734",75985:"59633e056a4b52de",75988:"77a03807dcac939e",76001:"42525fc4c20d9d75",76003:"48627e1ee267b631",76007:"8768931a5564d16e",76022:"88aee3bad08d7915",76023:"d997e9771c4d5e06",76025:"99a5e35b1f54b07c",76049:"d99ed4e771f07ba0",76118:"9a3a9ff01f0de39a",76130:"3560dcc7fa9eb4b5",76138:"b49f11bf7f885c21",76141:"d2de55a175c6cc7f",76153:"91a2c9df768b6f4f",76179:"811eae1cc5142f5d",76194:"d83725329d40e9e2",76197:"fda5be175c6bc7ae",76205:"43edad177d1ab16a",76211:"a65cf2bcd9714567",76240:"17465da4666c86e6",76260:"62edd85c2e094429",76274:"1df3c444b12d217a",76281:"9d9ab95d37513e81",76289:"7dcfd6cffe6cd885",76293:"dafe1df95581bce3",76317:"5f84cccb9d0384ff",76327:"6b652512aced0e64",76355:"0061953a3269fa97",76370:"34222d1f55e2c235",76378:"c0d7f8d9fdb7dfa9",76382:"377424543736c225",76418:"a0d959a3d4a97ceb",76420:"52cf8e8fdfff23e0",76425:"56e682980a4db503",76426:"cc4d408dd50e7f53",76441:"72fe4072df549537",76445:"c59b0c14b5559f57",76476:"fa75e4c9fafaeaed",76486:"d72986d051afd840",76504:"c2aa5e193f180471",76513:"9c084e6a763c6878",76541:"8075bf72ed8d7db7",76542:"ab1922cb2550ae18",76547:"b47d08a4fa6e53aa",76583:"3eb1c336b2598da1",76605:"e27971fd3f2422ca",76657:"f473b6abc0928f18",76710:"709e8a44f58ebd25",76738:"94ead8a511a2b8ad",76803:"fb02bda8b58b9370",76804:"1f6a4af67f2a4b30",76807:"e404743b67c8c9a3",76808:"7da0d9aa7fa598eb",76843:"0384b5843d43e327",76896:"dabb73cace8bc505",76902:"c9eada2de29d502c",76912:"bcee80e054ae9ad6",76940:"4ed74fcde251e826",76945:"1d756a9d6133e035",76950:"177c650decd444fe",76983:"0fe2c5581b83e1b6",77060:"862b3fdd030ba3d3",77067:"3666fa39b0f8253a",77078:"b58a724d311be778",77090:"9d682308a02e8133",77093:"735b4f32209fade2",77122:"f933b627cf1b7ed1",77153:"faac1070387c5b3e",77159:"8f1218f56c1b5101",77174:"f814f1cb3c503896",77183:"c60b44c04cae5d8a",77209:"bb4f8b45206059ff",77222:"6dc847a644c221c0",77233:"e1bcc953b90ace46",77273:"cb5575df1a73bfda",77285:"c62c6eb781b84453",77294:"62474a16e7401006",77330:"f30821a30ad130ec",77357:"e94c52afcf3e56e4",77362:"4be09a64daad1c5c",77384:"486d5f52fa0fd09d",77397:"f4dcafbe6f27b200",77412:"6c6dbffe4efe67a7",77414:"4615eb48f2fe4193",77455:"fd9f6a042c684528",77459:"4c105491e088f4de",77496:"2cc5c624e2c8b1fa",77511:"cef5cb24db158893",77527:"b457c85433ae698f",77540:"98afc01cf0c5e86d",77550:"e947421e01c021ae",77570:"9214f9a19cb34815",77639:"dc5847cbc16cb3dc",77649:"9b7e751a659f763d",77661:"6f91ea98afa325e0",77677:"e23c67877c7152de",77697:"392d8d30fda03b8b",77725:"3d6d0c0073c4cd59",77741:"4dc7099c3a91ba0b",77747:"d95bdd2c423b9ee5",77750:"4bb3d83cc3d510a8",77771:"a8de248c4aaff7ac",77772:"c9fcdde2edfd171f",77777:"b2ff41a74dce1295",77793:"1ff092b07f01c34e",77808:"306ef73a6472c7e4",77847:"2cf5a1565f4fce52",77869:"6f87ea93ca82096e",77953:"dd757053c7f61050",77960:"a1dddefe2dc6a1e0",78001:"2efde52d7c79bafc",78013:"dd853b86d53bfbfc",78026:"44a31a094294419f",78052:"b3e55d31d239592b",78053:"f74eb331be78b0c7",78066:"23d769d39eab39eb",78092:"32b5d4159c5d9190",78117:"e2a639afdee47bf5",78130:"337cf5be046e736b",78153:"624061dd06c6861a",78220:"be02d1eda6906217",78290:"b518dd64ea2ba9ed",78324:"b6ec3a14eb03db7d",78334:"c740723f8cb659da",78402:"2518dc423868c2a7",78408:"0be4bbc3e0a82970",78432:"e5f2f14ab8a8cd63",78433:"38e33890d62b011f",78456:"599ea537bbf8412b",78516:"55f5eebc63386640",78526:"343c02ee65a87f9c",78537:"9a3e59b6a5544869",78580:"5ba7e51b1feb951e",78594:"4f7f8b776a1843de",78609:"9893030994b7149f",78623:"37e9701c3015d7f4",78641:"e352066992d93663",78684:"18be655439e6b750",78713:"6b9501a6e025e413",78719:"ca0f19bde3719a64",78729:"4d7de72f0b0ca811",78746:"b4528115ffe34121",78755:"f6176c2f6660fe8d",78760:"81c2ee1a792a2c14",78773:"29f5ce3d65c0c920",78778:"d19945413fd5b12d",78792:"87032dd9e406cc79",78800:"1dda704b376d8377",78802:"1749c791fdee7361",78815:"8aeb71dd53914265",78832:"211ca378f6950f73",78848:"ca4a330692585134",78857:"ca8923a743d89712",78858:"14decf7dd30bb3be",78864:"fd4f198d62fb4f95",78866:"7ede3dbff191c765",78910:"d6f6caa6a12c9b23",78981:"b359d8151ed571a2",78994:"30ced2bc2bb44822",78996:"d39382bfae5bce38",78998:"b2c7f5790d94e13e",79e3:"d9ddd9f03cac2e9b",79010:"97dd4390fecf5d1d",79019:"e1bf815e65e64072",79058:"fd6c33e414c7ee0a",79071:"d81dc8870b2b6234",79088:"d049ae6d50ac77fc",79104:"03f84ea10e410be2",79130:"31e7ac6330488ebe",79131:"9de0344de0ed93f1",79156:"f47e06acc1bc10ff",79188:"cab364b7f8f9030f",79197:"95cead6dd6160c40",79231:"5be9d4a5563c210c",79297:"97cc9d5a2467bb19",79307:"0b21f6e02f6d8783",79316:"024bcb4151556f0c",79355:"637cbf484d7d88e8",79455:"62d45c567b1f6d5a",79506:"b93bd0d4bc445242",79533:"fc4a93b4e6aaf612",79537:"781ebf64a2799266",79585:"d9f7accaa9c09899",79613:"3593778fc60c68b9",79629:"c600693e60adf987",79659:"20d0e3ed5fdc8ffe",79737:"ff04d49e7d81cc34",79753:"f74bb9cd989b269e",79754:"4e02d8538d5a8c36",79786:"27a410c93912084b",79804:"0dbe7b3de3f18498",79825:"63d0ac5f00854f92",79833:"e6188e2bb600f2c0",79850:"6033d8b0ec2bf010",79880:"5a9ef5450cef1b37",79889:"0930dfcb1089b1c4",79932:"9533d50498ed2f96",79957:"9eb6cffa8541d684",79959:"3b85367095bdb1ec",79984:"521808c954764658",79993:"7d5f789a434d65ce",80013:"acac7db01c667c16",80016:"4314da28b0bdf7fa",80024:"ce7a947fd3c13d9e",80041:"2fe1760a414661f1",80052:"e3790d3f4f7908b5",80070:"25f3fbc448251845",80093:"b1607c7736ebe7e5",80097:"4bc8f67cdb804484",80117:"0d3e98af8aaafe76",80126:"fe1187aa140f98d3",80127:"8e8d0588ddd41646",80129:"0496defa4777ad90",80163:"649e5fa7107dbdf1",80165:"3911babd57921e0e",80184:"3ff974daf882451b",80190:"734e10163fb09f9a",80243:"45802df7c24e1dd6",80246:"63651dace8abaedd",80253:"5194ff5a58634b47",80262:"c855ea5661900012",80275:"310efca51ef7c412",80282:"bdae8971902127ac",80293:"61a01cebc993b05a",80319:"c343e203b75ae67d",80337:"c9c6900a3d9778eb",80403:"29065d6c83231efb",80414:"93a34aadf72a9e5f",80445:"12832cddb1f1b774",80473:"77ef62f19f9b1dc6",80516:"4e0d5735cbbcc339",80520:"42e545d7e653963f",80532:"0e5f195f14b702e8",80540:"c3a9d980db13c72b",80560:"f5377273f0261e26",80570:"b317d8256bc3a9be",80574:"29dbaf81f39b1ff1",80579:"9a85b90a4968b28c",80584:"73bc6eb5b06edea2",80648:"795d3dd0570e4180",80664:"89533217f02ff875",80670:"84cb15513dc69b51",80694:"61a8bee30539d7af",80699:"574862bc1401085f",80707:"eb4c29d7dbebc49f",80735:"b6a4282e1f659a87",80764:"1185853453c2ec4d",80799:"e5ed67f6718fc11b",80809:"a98613175c626738",80839:"07a99ba9454bb41f",80859:"416f60ca5c1afb6f",80907:"108e0409fcb0295d",80941:"c94e299425640a23",80947:"7aa5923f47fc8164",80956:"718d525f02c81ead",81e3:"5a626d4ec289dc52",81093:"08d889192ac08dcb",81102:"f1c264810e430658",81148:"f08a9eb5b2b36836",81174:"57b907d494334d71",81205:"3947741d0562bb64",81227:"a1ed9f21a7f8fd1f",81239:"839a107f4dcf7ae5",81249:"655e9b590258b2f1",81288:"369d8767ee04d53d",81293:"c9cca96f1edfb96b",81381:"f3c605862cc3a779",81406:"6ad96fcb0dafa720",81433:"fe8bad8414e8f2c4",81439:"53d18f55e5a4510d",81481:"b66ff5ef9b7fd808",81516:"74977bf09d8cbcfc",81529:"bd462e7ad828ea1a",81550:"1f175d3a816ad15c",81565:"0ba3569ae3e45136",81578:"5239985819b1191e",81641:"e1483f4ac7bdbe3a",81647:"41cc9f427c02f28f",81682:"c5acd9060ac79531",81683:"7b25f8dc790f3be4",81694:"1a8531458a1a7ef7",81698:"79d918ebbb63652c",81706:"58e663bbad2e5c77",81709:"bb72b9143a546a49",81735:"4579572e21b1c40f",81783:"6f9bee42cda1bded",81802:"8274d4368c0a0c73",81842:"ef233e61203e5f91",81844:"8e034fdb80378a37",81879:"4b99d63cac8c5eef",81897:"886453b5355ffb74",81900:"97558b1375203ba0",81916:"7aec1cd8a8760186",81933:"4626e95f010d508e",81939:"3873d7e1eeb6ddda",81974:"55934a71c30d82ed",82009:"46c7b8c850b96d90",82023:"7d50277ad9c11590",82025:"eacf4d42880fe38e",82033:"9daea83754cd74c1",82080:"eb0ee9b541f91a21",82098:"b30d0383675a4468",82110:"38d457a69187eef3",82117:"29a3838e0ce246e1",82118:"d9de11f2c0c04996",82136:"b61cf8528c964fcd",82175:"458dc49ab0ae41f4",82176:"9fc819fce4a4d8ca",82196:"63a664b05c161d74",82222:"d2cd7f8cd1ecc2d3",82230:"cf5feb4d3b3e7a85",82265:"5a94c7d74d289020",82271:"1c57b48374ddfe8b",82290:"0f4a7de53bb90e00",82329:"17771fb5d5905952",82366:"e6afa916ef390b5a",82382:"ca495b6bba545e52",82409:"5bf89e3a69990d70",82415:"ba25bb55a6c6ce4d",82418:"504199b56da5b90b",82419:"8683b78cf59607c2",82439:"8189c2f8860e9a30",82453:"10091142f74d0dd2",82472:"968bcdfd2afdefc8",82522:"ebf21158f6a10e1c",82564:"05abb0f2cc103c1c",82596:"0b58073c429f20b4",82703:"9d1e953f53a9719e",82722:"20bfd63481b5898a",82749:"05fe44970a5c5fa4",82754:"8146352f416f0a80",82786:"062c15d2a17e5375",82787:"168bbeadfbaaa63c",82789:"a15fdc3fb204e16c",82831:"0b2a8962931c2e2f",82850:"63e4b74969c7562a",82856:"886839e680f4987f",82870:"a505caa4c70788ea",82874:"de9e83597b2f536f",82880:"d2df7db37246ca54",82901:"bd7a19edfa1f05e2",82922:"c3890cb3864d34a7",82927:"d5092f7db94c1c8b",82989:"d01010e411ffab3e",82991:"2d29906eef63b5be",82998:"707b4260c67086ff",83005:"174dd12781ce6a59",83017:"e1385b54c0f9344f",83028:"467c94f652301f40",83059:"6830113c9757736b",83062:"dca369ca08805840",83096:"da2e8fbbb7dff5ec",83107:"6e938b20dc8a63c6",83110:"37ebb257f7616ea1",83186:"6cd86c1ba6eac07f",83194:"3b56b663e7e0836e",83219:"3997e9adf0247a26",83226:"6e1c6b99e8ca8a0c",83240:"0e0219c9ba8fef1c",83254:"8334152c2c52bd4a",83306:"a485c2d339fa17d7",83314:"2e2e7525d08da8ec",83393:"e23eefd238c39b62",83400:"4e9564425fe76c57",83423:"0aa9f2142e40ebe0",83438:"288d679a7256264b",83483:"2fbf06b5b7e78c79",83498:"5fac90833827c377",83505:"e2c423ce1b26cc65",83527:"e5455edf7a604fed",83548:"b3e256b564b61eb8",83549:"ed1139cbbe592dc5",83593:"51415f40c375a227",83594:"4ad17579c3929b5a",83607:"a0eb7989ff7d429c",83619:"2edc2938a12cfec3",83644:"cc31728d3804404d",83650:"464f1ae4b7a852fd",83654:"77546f2c62e35717",83663:"c872bff054cd6785",83695:"ee24344d04a3925a",83703:"87718c457a73c02c",83744:"cececce2dc0bc633",83748:"61705832bec16774",83750:"1768be46ff2b9cdb",83772:"9fd7df7f9eb55c91",83795:"8dc2c1c14a38a590",83817:"6c77887b4cdc2f01",83819:"0cc0be2f0e34a1d6",83836:"368a1c34d952f24e",83900:"9314d45368904845",83906:"efa34a258db6e60a",83989:"9c1b9dbebb1c8e97",83992:"28e7ac55e9f8be8a",83999:"2bab00edb0e296b0",84004:"d4944063a9b9d6df",84005:"9abd65f26f426816",84021:"03ed2d63cce1e071",84029:"2eb10582c27a07f3",84037:"09417e582f9bac1c",84042:"07bb58de5fa96758",84057:"85a05a8ae7752e7f",84063:"7f59c9de63d0d837",84074:"f477d6a5f2a380d5",84091:"cfb3ad7d31e04bff",84100:"46c17a8dd8463107",84197:"b3ac3c2269783be5",84203:"60a333b48cfeb8c2",84224:"cbb71ebd0d269f05",84226:"70a083b18757cbbe",84265:"8c06aa598f134ba2",84277:"8830eb28117c0a2d",84299:"f3973566f98520f5",84335:"f9ef761bffdab5ac",84360:"31ef52a176187aef",84375:"0c1189431ac2a6be",84395:"10d28e45657a2b42",84399:"a6bce3c30e3b357c",84411:"c97c890ec0d8bb6b",84427:"f48e554e67764490",84434:"bdb3f42113f8b86a",84441:"262816724f528068",84460:"e621a0347ffb34f0",84497:"fcc9bde47810c270",84517:"758df9a42347fa11",84539:"ab402380241bacee",84548:"8e3d47bdadc247de",84577:"7559b56ad95dea8b",84586:"90e71b1a740e63ef",84591:"81966ce43fe60953",84615:"a4cc33a2a6bbcb07",84616:"8ef8534d7b255e47",84671:"96ccdc24752e8460",84713:"51ed732995792ea9",84728:"25787d87217b641f",84733:"008d043a7dd8cb4a",84765:"9648efd31eb24633",84766:"6d7f75fb24c15cad",84787:"371dd0a81be94489",84836:"3db97220f7403d16",84843:"41598456c50b0b6a",84858:"2b2b70ca8531c8d6",84860:"fc077489b3d5f170",84862:"145d723645458de0",84870:"917789fbb289f644",84885:"10d64b70de69739a",84910:"df61c2bd83a0d715",84926:"95f5a0c77ba14d13",84956:"065c9617c65fd320",84964:"8fee3fe085507efc",84975:"e4507b5ee647d18f",84982:"e691a7765e9cf9d3",85077:"a6c17dc769b4218d",85108:"fc93c64bc9398089",85182:"94ccaca46dc5b576",85197:"56eb4f5f8022c2a1",85260:"341a1ebf35e97fb9",85299:"a9fa2699b1b49adb",85333:"841652d26f691f9f",85340:"ac9daac1b9ca696d",85358:"15a83890b3303948",85370:"7b9bea2aaa51644b",85381:"d5a4d2bf14f52784",85421:"79cf0921b3797d1b",85446:"8b7305f45df366a6",85470:"3ceb1078abc66cf1",85474:"55a983839c615fbf",85503:"3ff0ebd5e3c87212",85538:"15448f596185a5ed",85541:"191b9579a34b9efc",85550:"bdb1e6f4620c93b1",85565:"888125b815c27d3b",85608:"7d30be9ec8acf1b8",85637:"943c05a5298e672b",85653:"15c4d7762de5da36",85677:"c017bc96f5fe3767",85716:"b7c03268dd1cd89a",85783:"bf87764a79894931",85819:"d611c00918bad573",85843:"9f28f865555c5f6d",85869:"4e28e4637633da34",85883:"817ab9f167f0b8ca",85894:"ad1cec89b500c258",85976:"2face4c662ec3e39",85991:"be5db5c757c1e8c1",85993:"5e0bfad3746cfee7",85995:"767ec4309c124f8b",86007:"5e8bdaa6a0489acd",86018:"754a1ecf5d38395d",86032:"996e2d10ca47279c",86034:"4963dd4c9e277f69",86060:"3969ef853648baa9",86090:"64e395f6317326ad",86113:"a8022217670ce9d6",86142:"6076498f7cf7d319",86146:"069f8deb40e2deee",86155:"630ed3c361120edd",86183:"31d4812b6c07a5cd",86191:"f05bfe778c4621be",86194:"a168e48e067476a0",86205:"942648af8dfb3ea7",86242:"42b301daebfd0dbf",86262:"cd622a0584d043d7",86264:"2c05aa40d89a577d",86272:"29db6cc26863624f",86347:"c6e0a709c3841e6f",86354:"cb0227a7a42c980f",86358:"87b5f9cce15727c4",86363:"3b53e9fd3a89ffb6",86380:"4249bd73961fa7a5",86382:"e8bc6f30d577d387",86395:"5d3ca687278768a7",86416:"b3503c45cd33cce9",86509:"dcdbeb1890a5a1ce",86549:"43ca8aa1689deae5",86608:"92835fb108a33cc9",86611:"865a1463d88d5c63",86639:"e996dde036c3f111",86657:"736457d72f29bf10",86683:"fd1e57934fd5ac9c",86754:"56e167f988f83a14",86757:"0c176d377cb093cf",86793:"437250074e911bf2",86798:"e07097dfa7f6f1a4",86824:"f188fa58a0e09b20",86854:"dd4b8aa5f71b5c85",86855:"bf20d8be2ef25316",86886:"341bca98dcc56d41",86892:"7ce535e859948918",86910:"739950a2f88b3aca",86973:"a16207d1d3ac197a",86989:"7af36747af82fd3c",87024:"05fc4c18163da658",87034:"7306390ec3ce9bd6",87036:"0ebb81d66010078a",87084:"65e324b9072dbd5a",87110:"625b106f1c20f0b3",87150:"08eefdd9e3b4ac35",87173:"53cdc1d0af8b5129",87191:"2107785ae7effb07",87227:"315838ac302760da",87237:"f5cab965e05edbe5",87254:"223700adf4ecdad7",87271:"6b6a51b64f965b38",87273:"11bbe1659ca43399",87302:"fc054481e061cb88",87309:"84919006e2dbea3f",87310:"75bdd7a693036698",87311:"edea0620acc1288a",87314:"f7bcc1d82241c266",87329:"93f1145272ef0805",87384:"cad45eb4bcb457a5",87391:"48d6bab94f035fa6",87392:"df0b9bf555814d67",87408:"7461b2ceb6195589",87417:"3f2d854a1ec4f48c",87434:"bb841e17b80db03d",87452:"ddec5830ff67a512",87480:"eaee77a0d50b2fbb",87547:"d37263a3f1bc6dbd",87562:"9fe82879a8478e4a",87568:"a965298af4b81fe7",87574:"34f1705cb3491560",87584:"cf422bdf1503cba7",87598:"ebc4b3611e09d0af",87793:"26abba2ac13d257b",87808:"015286233947f824",87809:"18a76a4ad81f5727",87811:"b0ba3863ee891511",87844:"2ff0c03212f5bc6a",87846:"a6b5fe1fc0fb7797",87857:"06fbe360c2a085db",87921:"8975e9baa5414f8f",87927:"3eca0b4ab9ae9796",88026:"d2914fa49a9ac17f",88029:"98b9f7f255f9c45a",88059:"654761f63f800151",88094:"056f975d3e832218",88100:"3adfeb7e46395398",88120:"65f50ec36bffe4f2",88137:"7afcaaf95d423917",88146:"f7acc053ec8a91e1",88164:"ed3910dbd5f54fd8",88204:"0a64253552d7ea83",88207:"706ae3ba2383792b",88216:"995b5803d54b857e",88262:"1744df5b0bfddf2f",88282:"36a106187d8cdf3f",88314:"16ca7849065551a1",88329:"5373a19ec14be634",88338:"3a958cea03d93091",88357:"5f5c20017f6f3bd8",88360:"43c7659c836db6ad",88365:"c242221b76db6371",88369:"4b7156ecb3587f94",88394:"21e98d5821e7b691",88409:"4e493a7644b23686",88412:"f87508de292957c1",88437:"3c51db0218304b6f",88441:"e3f196b9923e0904",88450:"e63935c2172d63e8",88453:"57dbbe7d2feda049",88458:"aa048b369224e7d1",88466:"c7c2b15a4b6b93ff",88475:"18b3ef49b02c6572",88478:"74b68e764af7d82b",88531:"2b4681a3f05ea1f0",88534:"149ebe49e26df143",88540:"7b6e27fb8303fbf7",88541:"02ddac6ac682cafa",88542:"cc1568f66ffd572f",88553:"acc3d42d4daf2af1",88558:"8fa62fdfa8a08711",88582:"948875fda68c4c39",88591:"ba9f8a04af2b2576",88664:"5579835fdb6bdedb",88681:"5cf6a6afcaab329f",88725:"8721566b30f314f1",88729:"cc4b893dc4d42f1d",88751:"656783ac4c7b8808",88771:"f384c8e574ea9a96",88777:"e0c8dc9476005996",88787:"0e92f0043c342903",88811:"32f6aa50075d474a",88821:"652b04f770ba51a3",88861:"3e00842e84825a75",88864:"dba6a5bdaafe4262",88876:"c88a59ce05331c5e",88890:"ccb66bff653569bd",88891:"35ff051ee57f7bb9",88901:"7269126741ec1732",88909:"1393a0f5cb85ccfd",88910:"8bc218ee5db62f51",88919:"2eba182ff5fcd826",88927:"eb62e1dae01b7dd3",88951:"dc87a59ec4078f8c",88972:"1e3d06e0c0fc9c45",88975:"24233306321ed3be",88978:"f4e50728613ec4b3",89010:"821abd8ede924985",89043:"6bbabe4ea66b67d3",89080:"326cfba6ef00ce89",89086:"9fcdef7eae090d39",89093:"4a15d022b5fa91fd",89104:"64d67dff0b695023",89107:"c57ac289f2fc9419",89109:"ab1163e503aec5f1",89118:"e90d74892c75d66c",89131:"8608b7d47066e2a4",89139:"5f32e2152f10bb0b",89142:"ddcd5dc2922aeb04",89167:"2a63998d62683ab8",89183:"94d53ff3eae809f2",89220:"4a7106129e1a7c06",89275:"c586a56be017891e",89339:"736f84eb8bad400d",89386:"9caae81cdf335dc9",89407:"10b00b0a2db01432",89430:"3c54dc5699b0fbbc",89465:"0da4ec5ad197e1ec",89483:"5d04e9c5f1096976",89499:"a244b0009c7fc666",89509:"0fe122d650cc3727",89525:"80645edf10cfff01",89526:"d8811b2b59135c26",89537:"517e8310b9851a4d",89544:"2d12ad01b635f464",89560:"411438c3bef3a746",89569:"53874f1df2eca618",89589:"e7d84963cd7c127a",89591:"b6ff2134e2ffa333",89649:"2d3c7f555d0cfdc5",89676:"13c6767b60124021",89683:"4ca61b485560196c",89689:"66323bc03eac64bf",89711:"5a82ded2319a72d6",89733:"4b8181c21b8e4209",89755:"b0d1a38c718e79ab",89760:"a6574ee0aa7fe7d2",89768:"6ac30950e2688e30",89798:"f048d1683e05b571",89829:"707c3bae51cbbc40",89847:"afbcb7d4a853515e",89869:"7e226219885350b8",89903:"dba89154112880e6",89905:"3999bd923606fb09",89907:"a04b2ed83e931526",89910:"9316e5ec78b436ac",89931:"79ec754e756b65fa",89961:"d481eafd5e27399b",89962:"67a9721103adbcd3",89979:"814d7edc81c33c10",89980:"96ba8a0153458560",89997:"b7e2f0376ade982c",90045:"6223872f6f7bfbde",90080:"c5c76dc24dbc73da",90081:"c1976e8d44776569",90082:"197d4eb844442467",90094:"e2c0b5fcc0592972",90109:"ca6734ad6c98475f",90134:"a008b8df8807305c",90166:"64235207e5a49a8a",90189:"5703f43bba256a97",90224:"eb120e1031761ec5",90237:"5d0b0b1eab66698d",90250:"e9373f3e7b63232a",90265:"13c300a0b0d29a82",90378:"1d0cdf6a3171bbd5",90429:"4ab8bc5a40cb81dc",90434:"1edf05b9249aa3d3",90469:"61b713399815f774",90477:"7af46d79efc3f520",90500:"36c239556d65a14e",90514:"9e62603339a1b6c7",90531:"625d6a712d3faf10",90533:"f7aae2235039d258",90534:"d4a13cc50f07549a",90559:"780f5f6a5701f14e",90565:"572da7a08a8ea20e",90579:"df0ea676145d75ba",90580:"48a243182ba3b1f1",90606:"58ff6cd6a73ee139",90625:"17fd4c96db436166",90631:"e9c81c96c8ce276d",90658:"993f13005386d0f7",90684:"515dc79f9159198c",90720:"725e315da708f893",90750:"ac1076105fa3e180",90752:"98514b24fabb3473",90766:"5d310a33299a69b3",90773:"214c219b5f628250",90799:"516bfcafb127cc04",90842:"d9a8faa74c516c47",90883:"fd68421ed75ca40d",90928:"ef3d3a1c7c045a94",90963:"04fb1815dadf0c5e",90972:"9d4af6716e9b0edf",90999:"fa32967ac0e2caa5",91025:"6dd9a381bb0254d4",91029:"82c83ee65aba2b93",91036:"cbf6e380d8cf99d4",91041:"bfac193a1283755e",91068:"7cb988925b149b53",91086:"bce75cadb3ce4c88",91104:"637a522c59d03d86",91108:"7ed5fcd28b2c81ed",91129:"1c5788e44480745c",91135:"5a42481ae04dac45",91138:"688388558d287bab",91139:"524ddb9a769659e2",91143:"c3f7a3a3a1a98f79",91195:"a9d8ab863dc61759",91234:"cca1acdf42fb479d",91282:"fe275897948e5f6d",91291:"352bf608d5eaba72",91384:"6515d16aeecfe2a9",91443:"ba29b9b0569dafe8",91455:"e65cc797166c7644",91457:"333cc81163d40960",91487:"8feedca909bef86d",91494:"55281ca2c2177b67",91496:"8f7929d8c11673fa",91504:"703577e804e2a156",91510:"ccf4ce6a92ccb3de",91546:"1573273bfc88154f",91549:"500d5ea9daba06e9",91596:"ddbf0db29251f799",91600:"9e6784f8d00d6e42",91643:"53606386291325cb",91679:"b499409d6c7fa2e2",91683:"85b17ef342f5995f",91716:"b544bcdc8c75ce1d",91736:"6f5f082c3d2ba519",91759:"ff9f5d14a4cb56cc",91761:"d8bfd86c57e330c9",91768:"1433407632536cbb",91773:"40adeddb10256ed6",91789:"182e7584cf713c38",91829:"15922072ff3ee1fa",91838:"8a404bbd71f126d5",91856:"fe52a72087f944a5",91910:"594127c6aa46c013",91920:"36253bfe17c4f0c1",91941:"9a25f126a14a0771",91952:"cf957169bb7a3d7e",92029:"287b6a48fbdd0fad",92037:"37fc7232d35b2a1f",92039:"ae342b8ec0b56907",92044:"7f781a0fd78ff29b",92102:"9013089e47fa71b4",92151:"fe79ab944829b44c",92168:"1f47d68dc06ecd7e",92186:"9a042d994ef90aba",92193:"63de920c6b61bdca",92235:"85406e4dcf2f25c7",92239:"8a5d9a49f67bc84e",92249:"cb9cb9f5e67e2a46",92278:"5db532813a0d4447",92313:"fde8ac73392d16aa",92326:"aa0e0e2b899a61c3",92338:"874ab759c3023abc",92444:"2304c596049284eb",92473:"66074a7728df5936",92480:"9c91e76d15b97ef9",92481:"54bd05a3a4b0b013",92521:"a47d0c65c2b971b1",92525:"2f9fe99f55f11f7f",92549:"1ef9bab25b87ae90",92567:"3a3cf7b305c17045",92574:"99cea2c77031277f",92584:"4adb7b12c8e8bc8d",92617:"ebefce275b4254fb",92621:"a79340626497cbf7",92650:"b45325e800716770",92677:"eb438a3f9a36b4e6",92680:"b774c0fdf5bd34fd",92712:"ab630d3fb56ba111",92722:"643330aa47a6a675",92729:"eb6b2b106e677298",92784:"80510855decd52b1",92796:"8a92f15c91568789",92819:"00de1d34f70de3b6",92876:"d1ebd7f04903993c",92942:"acafcd2cf5f20ef8",92966:"7b0d6935da759cfc",92983:"d92ab05e53b0bbcb",93007:"77eac2e6dab6c7ae",93048:"153cb18b98a775f4",93050:"f3d0f5cbb6932773",93088:"20c0f6a293912122",93098:"0cac37d1da8c7b11",93121:"7191e1d64088c69e",93145:"918b18fb1d5e584f",93186:"9fc4cbc228e15a63",93196:"6140fdfcee431182",93200:"0c772ca12df46448",93202:"6499feaf712f2464",93207:"03c1e547c7d0ef13",93215:"847ef5eea150ba75",93241:"8e518576ab233d1a",93258:"1b03823021eaaefe",93288:"f0e7c20c8c13c763",93295:"384c41af0bbe1ea4",93300:"7c15a41928838adf",93305:"171b9031f7b496ed",93332:"409fa268497a8cd4",93334:"eb68dc69e5c80b03",93337:"2b847043c59e31ce",93348:"5032759e9b7d43a8",93352:"a4c62b20a505f54d",93371:"1748751acc26fb56",93376:"71b60399e87a18e0",93393:"3fcac7c1dd5f0c8a",93400:"3e10b976603fa9a5",93413:"626772f1f53d40e6",93446:"ba6809fba350c8f0",93467:"4e29d6cdce40c8dc",93477:"36919f850b86f90d",93497:"573462a4d94c5484",93545:"c25b4119b16d5ef4",93553:"ca2a5a70f0ce9b88",93564:"5977bd79d1243a89",93594:"e7272eddaa20ba00",93597:"9fff287ac5cec6ae",93653:"152f59463cfdce5a",93718:"971da504d60ebb04",93740:"2c7e0142d00a3cdd",93760:"cc5d6b328a1a8f6f",93762:"ac1ae2c26eb7c7b1",93774:"5036d9120cc33a3c",93786:"857725e6a254483d",93800:"b623bc017b127f4b",93820:"b3a1674024c69506",93841:"9d9d559151b6758f",93844:"cc9e8752d11bf100",93870:"53a1dd966ddf2fd1",93880:"042aaa99ab349f74",93902:"278978b25ffb6647",93916:"a2cee252835557b6",93944:"36f366c9aa769948",94009:"6df9895470ee5084",94057:"d77d07e8c395047f",94061:"aa623e1d6868906b",94087:"a563bd6683f25f9f",94101:"5d9f4b4f0ff84470",94119:"c91233b118bdc6ca",94122:"82807a50f1d6a7c2",94125:"f64accc164842c8a",94155:"9a1efc4d36223668",94157:"4e1e44996f272109",94159:"e7bde0b93d066d5c",94166:"ed7388eca06c1634",94170:"05d258b4cb1e316f",94217:"5d2e695a9a29a2ce",94219:"f2585247f77799c0",94236:"59f464817334f2da",94248:"a89cfa51ad9b81de",94253:"5cc1e8bc884eb813",94259:"2adc9d5751e88717",94263:"3e0ebc5fdeba1b1e",94265:"116d1481e940d749",94267:"8dc55dce1e93c744",94300:"a85a378c2f2383a8",94333:"6d3e326bbec9b95e",94339:"0a64874fe5122e75",94341:"9abb3bc47f69993c",94411:"0e97204e854b7708",94421:"1f41580fa63211d3",94444:"2923ff2b28eb5159",94451:"a49f51f4eceabfac",94457:"31a8fb7b20fecb11",94462:"068060f6ec6c802a",94476:"a7dc727390dff435",94535:"62a3512e53b9bde4",94543:"628b60f50a350098",94548:"152a0639ea85982b",94563:"6b273fe626c4210a",94598:"e0d2c3902b60100f",94601:"e8ea3e819943b810",94623:"4d7c1d9bacdd7c69",94637:"7ffc20820d16bb8a",94658:"2aef279a078c006d",94673:"00b381661967b212",94761:"f9b3039df013d309",94766:"fb833d3486f218cb",94772:"1675bc9dc4641706",94779:"66e58e8d728c551e",94795:"9487f5d94207af68",94810:"bd118a9e796a9e81",94819:"e26e6600dd2082e8",94844:"b6b3eb48a89941cc",94864:"247f92c894f2c79f",94945:"c45e2596f02a55b7",94954:"2a0e7d7b1edda09d",94965:"1feb06fcb135b979",94973:"d46bdf8fbdeac263",95002:"ddbb8321720f4629",95014:"f7b052d21e2131a7",95019:"266e713a9d7510a9",95037:"a584515e36e7658f",95049:"ed78f3083757e9c4",95052:"6e23035dcfb42e75",95121:"b5f5e36fe4c47df9",95138:"3a16fe724127aa46",95146:"6970ee0d19117a57",95195:"cc3d698f49adfd7d",95268:"8021b059ec075bd6",95281:"81b705b40d4c86de",95320:"800bab1f7ee8fdd9",95322:"8c4823af37a537e7",95339:"d62be093531c4b2e",95341:"dfbfc4accf62db14",95378:"f0f7363c00df9323",95417:"a5cba668f859a14b",95422:"237f03ff1266b14e",95444:"ac675c7713ed79ee",95447:"e3af619fa06ea6e9",95465:"8fbd629c371b6f97",95468:"111caa652e36e9bd",95487:"f942539067d5f07f",95518:"d595f5b8388e7d18",95544:"8605e67d18bebcf0",95571:"21367f3af48174be",95584:"be943ef27c4f59bb",95589:"10a1a70f7cab295e",95630:"f583c0b64e2a509a",95669:"720b6ea62b1bb6ee",95683:"806c8e1feffc9953",95691:"a0472c9701f4223a",95746:"7b775f6c4ab5b0fa",95768:"eca558705aca9363",95772:"3e2edcbceed493ba",95787:"335a55bb29f168a2",95797:"e22ab5e7c89f17d0",95830:"6892741649a43d57",95834:"5e14adfb052316e9",95844:"1ad2df3577868437",95847:"d47f791eae45fb26",95859:"4c2f25067c91f7df",95862:"49cbbcb395dbe627",95875:"374fde2f0e48bb3a",95885:"79fc96f78722ea79",95939:"d3567fde1e52c17d",95954:"92d81e6574e7c232",95972:"e5448b835ce34097",96007:"98457e2d1b690b56",96008:"5ddf61471e053ddc",96046:"1c66523fd0b6917a",96057:"b5ff3242df5ffbcc",96078:"99df74c208411388",96079:"79885858234b5104",96105:"64ed650dff767632",96106:"f901ad2e66c5283d",96137:"d6fa20003eebc413",96147:"65031cf8737def5f",96148:"c534e0d0d690c01b",96149:"4069bf73c102685f",96269:"2964d725692546a1",96271:"7b7c499615bf3c4d",96317:"df8a7b7ce6c6ae6f",96334:"a6883dee886a406b",96357:"6e0aff3c9a12d98f",96362:"13c4b7439bec5540",96380:"7a640a7cc1fbe38f",96386:"2fbd5d57fcf19e70",96387:"3515ed5250be8395",96418:"cfb369261fbeb558",96421:"c9211f908f25a6a2",96435:"2c1936650343429f",96449:"9bbc0ca12b9f0224",96488:"0dcf3a7e6fd1f406",96532:"42a33b73cbb20b37",96540:"1641a3a19947708d",96555:"98fd5a8524f7e2cb",96583:"77673a0665a2a595",96601:"240368a42ae6673c",96624:"71252087d5b9e4ec",96650:"1c3c0ed70b1c4aab",96656:"36da3100edf4228b",96696:"47f8adf2cae1d878",96698:"2482cf37de778f2c",96708:"70696ccc816c7a1a",96710:"0f57045d4dbf0065",96728:"3c349dbf68f5f8d3",96736:"8d7c51c084dacb42",96793:"4b75cff5484f424d",96802:"94b60a9c48cfedd2",96836:"287a03d309f6f705",96837:"ac445757a9f44cac",96848:"6f780fa2ff24332e",96893:"db2633a6cfa005c1",96968:"4ade50a02ee13117",96973:"e61cac4c743c9819",96978:"2487ee4434daa89a",96980:"d13a92c705ad51ab",97014:"9a0c3f56c7ad46a1",97016:"e2ae560d3db808f4",97071:"f9b2281930a75682",97083:"ce53c3338e3c3902",97085:"9dc010165e58c129",97087:"ba8a79e4366e52c0",97119:"a18dc88d88d2f5c7",97125:"d32675952db6e0d2",97130:"e8a9579af3a09468",97146:"23d7883235229c01",97153:"aad423f950b49ce4",97191:"46e98f14651ac617",97202:"6cdfd183dc9b699a",97203:"15c5764c08e5d6cd",97206:"c139a525c22d7d75",97213:"9747692f044a29ae",97225:"e475965a2c6f0162",97265:"a729a905a7af4b6d",97267:"b65bbac6722e7bdb",97282:"8838c7a61f6da54c",97299:"feb987ea0363fd84",97323:"950618d8b1e03351",97327:"86d19e682200f015",97378:"87a13eee79ad9cea",97399:"8ae3f2602ab53999",97423:"84f3a08e030195ff",97424:"4df4e64ab564e7ab",97431:"55590d45a7b5a431",97436:"53c121592eb3ba8a",97437:"67555a7394f2b9ab",97494:"e977de5b4246a57d",97507:"86199560cb57153a",97526:"9f16666def5af5a4",97548:"e58d244577fd692a",97550:"c947032325133f93",97554:"4270b5ea756ee6b0",97578:"b2ecc32b603d2484",97596:"d5602a11d55f44e6",97606:"20b28a1a62a29e4a",97620:"e7efa219db7e6761",97686:"ccc480aa0cf2392f",97704:"ff7344963af4fd51",97757:"09893b08df2a472a",97758:"4b065d6f3787f0c9",97778:"6a1c2225c817ccea",97782:"6ce611e4326a0536",97783:"34798089f8a886a7",97810:"e75d87b2a7ef6c02",97816:"6fe50c7fc537d2f7",97822:"d2a088299dde5698",97828:"dd7f8697c64440dd",97895:"2e5224954333ddbc",97901:"a38626a6e5aaadd2",97962:"43723a1c44c0ccea",97979:"d218e90560b39df9",98050:"5fe9a50986300d21",98068:"f6fe5e5415764edf",98080:"d0465ea7db73ec4a",98091:"b085350fac3c4360",98156:"491efd186e42cdd6",98163:"fdbf89f5a6cca65e",98167:"833d8e669f9f3e14",98170:"76bf8c8f6ecef87b",98176:"39e1efdd27d7a0f2",98217:"b09eb440e53df95f",98234:"6d1819495bd4e072",98261:"a6e882db149b7ee4",98269:"72286059c14b426d",98278:"805755bb4f01915a",98289:"e51a8231f02e20c1",98368:"3dd8c7cb657dc38f",98436:"69747c5555293a72",98471:"f163275239f6e9a8",98487:"a244b79fad66b79d",98495:"185f765cf2afa8f5",98498:"f54544cf778802a8",98523:"f179220b902b9fe1",98529:"c3918f2dad8e2b0d",98557:"8e1ffe11477899cc",98599:"d05ea09221d85c3e",98629:"f21dfa1bfe2a6eec",98635:"17460f64090c594c",98654:"0f61568ffcf5f33e",98687:"a01adeaeae701717",98696:"974886ee79b35b12",98701:"65994b0b624bdbdf",98720:"d24a68d843aa425e",98722:"f9e78f02ebdabec2",98725:"9ebc5162879bdbe3",98750:"698bff1b115faef8",98787:"03af12fb6b35d743",98790:"143cce0e0be4ff73",98805:"e61061f0f6c89651",98813:"19a514ac4aaac6c3",98842:"ad84cbd058d2ed98",98846:"a3d460bd1b019f10",98857:"82569b0011a60a30",98865:"2ee3917974e2d125",98872:"68149a8b58c7e376",98889:"6aa7631876e7bcfc",98929:"7adee38ee2308e83",98935:"4d51f72fee31d6a1",98972:"f3389cdb112c67b8",98993:"907568c23c1177ff",98998:"b35266bbfb25f241",99017:"466588d40da4fe90",99030:"47dfeb972718fafd",99110:"c2e38d7177d1894b",99112:"2265719995209d83",99114:"dae09d955cd715d3",99126:"66c57227bee8f840",99149:"518c8dae99ce13d9",99164:"29097b6fa52b4b9e",99173:"8a14ad2f9b91e8c8",99182:"c5c474f2be2e8ff8",99200:"813988487ccbfa80",99203:"e254719a328b5c71",99240:"fa63903467c23e1f",99290:"61e31dd1556de8e2",99306:"c4f9d9e94221e01e",99323:"837492d1c780fb5d",99327:"a0feb50ca51fc071",99329:"8eac482f8ad54616",99334:"1addb459f19d8582",99352:"7b6cd465bd683192",99367:"7f04aa5aad8b511a",99433:"ef280579a2a91aa1",99442:"f50ced43a14d38b9",99458:"7f194ab8607bdb18",99563:"fb81e5cbcf6c758b",99592:"612b2af5a6feaf4d",99598:"916e77bdf660ce6f",99617:"a8ac9eb403a0979a",99641:"d4049927da6910b8",99648:"f068e54e6bb9d90c",99650:"619fbf93971c7697",99666:"5c77182ab8e377ae",99684:"bddf5d50e3dd1598",99710:"92fb03c3adaec9d9",99728:"d6254ed60df61e89",99793:"72609a5d5ae5317a",99808:"c98e47d7ac2cebde",99826:"65889523001cd143",99834:"87935a9d94028aa7",99837:"1d9c3195faa9301f",99856:"1c71ab5c5d374e27",99918:"733aa2625a6cfba1",99927:"d10d3aa4fccc6cce",99928:"6548d38485fbebcd",99948:"50abd9caf8c7f2c9",99951:"bfea675ef0b4cb51",99981:"f83250f1ab30b3cc",99984:"19735702dd4fc620"}[e]+".js"),__webpack_require__.miniCssF=e=>({69663:"pskin",94157:"web_recorder_v2",95954:"fluentMtc"}[e]+"-"+{69663:"17cfde5df911a0a3",94157:"82930b67abc5d30b",95954:"2e357dd9b4a1116d"}[e]+".css"),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="@msteams/multi-window:",__webpack_require__.l=(e,t,n,i)=>{if(inProgress[e])inProgress[e].push(t);else{var a,o;if(void 0!==n)for(var r=document.getElementsByTagName("script"),s=0;s<r.length;s++){var l=r[s];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==dataWebpackPrefix+n){a=l;break}}a||(o=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=60,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack",dataWebpackPrefix+n),a.src=__webpack_require__.tu(e),0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous")),inProgress[e]=[t];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(c);var i=inProgress[e];if(delete inProgress[e],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},c=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),6e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),o&&document.head.appendChild(a)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.j=40179,__webpack_require__.tu=e=>(void 0===policy&&(policy={createScriptURL:e=>e},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(policy=trustedTypes.createPolicy("@msteams/multi-window",policy))),policy.createScriptURL(e)),__webpack_require__.p="https://statics.teams.cdn.office.net/teams-modular-packages/hashed-assets/",(()=>{if(void 0!==__webpack_require__){var e=__webpack_require__.u,t=__webpack_require__.e,n=new Map,i=new Map;__webpack_require__.u=function(t){return e(t)+(n.has(t)?"?"+n.get(t):"")},__webpack_require__.e=function(a){return t(a).catch((function(t){var o=i.has(a)?i.get(a):1;if(o<1){var r=e(a);throw t.message="Loading chunk "+a+" failed after 1 retries.\n("+r+")",t.request=r,t}var s="ts="+Date.now();return n.set(a,s),i.set(a,o-1),__webpack_require__.e(a)}))}}})(),void 0!==__webpack_require__&&(__webpack_require__.p=__webpack_require__.g&&__webpack_require__.g.__webpack_public_path__||__webpack_require__.p),loadStylesheet=e=>new Promise(((t,n)=>{var i=__webpack_require__.miniCssF(e),a=__webpack_require__.p+i;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),i=0;i<n.length;i++){var a=(r=n[i]).getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(a===e||a===t))return r}var o=document.getElementsByTagName("style");for(i=0;i<o.length;i++){var r;if((a=(r=o[i]).getAttribute("data-href"))===e||a===t)return r}})(i,a))return t();((e,t,n,i)=>{var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.onerror=a.onload=o=>{if(a.onerror=a.onload=null,"load"===o.type)n();else{var r=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=r,l.request=s,a.parentNode.removeChild(a),i(l)}},a.href=t,0!==a.href.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous"),document.head.appendChild(a)})(e,a,t,n)})),installedCssChunks={40179:0},__webpack_require__.f.miniCss=(e,t)=>{installedCssChunks[e]?t.push(installedCssChunks[e]):0!==installedCssChunks[e]&&{69663:1,94157:1,95954:1}[e]&&t.push(installedCssChunks[e]=loadStylesheet(e).then((()=>{installedCssChunks[e]=0}),(t=>{throw delete installedCssChunks[e],t})))},(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={40179:0};__webpack_require__.f.j=(t,n)=>{var i=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else if(95954!=t){var a=new Promise(((n,a)=>i=e[t]=[n,a]));n.push(i[2]=a);var o=__webpack_require__.p+__webpack_require__.u(t),r=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",r.name="ChunkLoadError",r.type=a,r.request=o,i[1](r)}}),"chunk-"+t,t)}else e[t]=0},__webpack_require__.F.j=t=>{if((!__webpack_require__.o(e,t)||void 0===e[t])&&95954!=t){e[t]=null;var n=document.createElement("link");n.crossOrigin="anonymous",__webpack_require__.nc&&n.setAttribute("nonce",__webpack_require__.nc),n.rel="prefetch",n.as="script",n.href=__webpack_require__.p+__webpack_require__.u(t),document.head.appendChild(n)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,[o,r,s]=n,l=0;if(o.some((t=>0!==e[t]))){for(i in r)__webpack_require__.o(r,i)&&(__webpack_require__.m[i]=r[i]);if(s)var d=s(__webpack_require__)}for(t&&t(n);l<o.length;l++)a=o[l],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(d)},n=this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),chunkToChildrenMap={7959:[6240],24197:[6240],56904:[75916,75912,61130,93545,86611,52684,55999,6523,54226,30003,126,43458],62030:[88100],65242:[6240],81647:[88100],89407:[89760,65164,51080,18315,8075,92039,54373,50789,49429,65656,94457,68318],97423:[6240]},__webpack_require__.f.prefetch=(e,t)=>Promise.all(t).then((()=>{var t=chunkToChildrenMap[e];Array.isArray(t)&&t.map(__webpack_require__.E)}));var __webpack_exports__=__webpack_require__.O(void 0,[92891,26719,11540,26397,28539,99309,490,94625,62069],(()=>__webpack_require__(285648)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/main-b91797a9edde88c3.js.map